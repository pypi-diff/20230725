# Comparing `tmp/flywheel_migration-13.7.0-py2.py3-none-any.whl.zip` & `tmp/flywheel_migration-13.7.1rc0-py2.py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,34 +1,34 @@
-Zip file size: 70298 bytes, number of entries: 32
--rw-r--r--  2.0 unx      328 b- defN 23-Jul-19 23:32 flywheel_migration/__init__.py
--rw-r--r--  2.0 unx     3963 b- defN 23-Jul-19 23:32 flywheel_migration/bruker.py
--rw-r--r--  2.0 unx    11451 b- defN 23-Jul-19 23:32 flywheel_migration/dcm.py
--rw-r--r--  2.0 unx     1928 b- defN 23-Jul-19 23:32 flywheel_migration/parrec.py
--rw-r--r--  2.0 unx     4198 b- defN 23-Jul-19 23:32 flywheel_migration/parrec_headers.py
--rw-r--r--  2.0 unx    10284 b- defN 23-Jul-19 23:32 flywheel_migration/pfile.py
--rw-r--r--  2.0 unx    12909 b- defN 23-Jul-19 23:32 flywheel_migration/util.py
--rw-r--r--  2.0 unx     2656 b- defN 23-Jul-19 23:32 flywheel_migration/deidentify/__init__.py
--rw-r--r--  2.0 unx     3930 b- defN 23-Jul-19 23:32 flywheel_migration/deidentify/csv_subject_map.py
--rw-rw-rw-  2.0 unx      299 b- defN 23-Jul-19 23:32 flywheel_migration/deidentify/deid-profiles.yml
--rw-r--r--  2.0 unx    28394 b- defN 23-Jul-19 23:32 flywheel_migration/deidentify/deid_field.py
--rw-r--r--  2.0 unx     2282 b- defN 23-Jul-19 23:32 flywheel_migration/deidentify/deid_log.py
--rw-r--r--  2.0 unx     4510 b- defN 23-Jul-19 23:32 flywheel_migration/deidentify/deid_profile.py
--rw-r--r--  2.0 unx    48837 b- defN 23-Jul-19 23:32 flywheel_migration/deidentify/dicom_file_profile.py
--rw-r--r--  2.0 unx      595 b- defN 23-Jul-19 23:32 flywheel_migration/deidentify/exceptions.py
--rw-r--r--  2.0 unx     1011 b- defN 23-Jul-19 23:32 flywheel_migration/deidentify/factory.py
--rw-r--r--  2.0 unx    24486 b- defN 23-Jul-19 23:32 flywheel_migration/deidentify/file_profile.py
--rw-r--r--  2.0 unx     3482 b- defN 23-Jul-19 23:32 flywheel_migration/deidentify/filename_file_profile.py
--rw-r--r--  2.0 unx     9392 b- defN 23-Jul-19 23:32 flywheel_migration/deidentify/jpg_file_profile.py
--rw-r--r--  2.0 unx     7283 b- defN 23-Jul-19 23:32 flywheel_migration/deidentify/json_file_profile.py
--rw-r--r--  2.0 unx     8344 b- defN 23-Jul-19 23:32 flywheel_migration/deidentify/key_value_text_file_profile.py
--rw-r--r--  2.0 unx     7343 b- defN 23-Jul-19 23:32 flywheel_migration/deidentify/png_file_profile.py
--rw-r--r--  2.0 unx     3479 b- defN 23-Jul-19 23:32 flywheel_migration/deidentify/subject_map.py
--rw-r--r--  2.0 unx     5359 b- defN 23-Jul-19 23:32 flywheel_migration/deidentify/table_file_profile.py
--rw-r--r--  2.0 unx     6757 b- defN 23-Jul-19 23:32 flywheel_migration/deidentify/tiff_file_profile.py
--rw-r--r--  2.0 unx     3739 b- defN 23-Jul-19 23:32 flywheel_migration/deidentify/validation.py
--rw-r--r--  2.0 unx     6935 b- defN 23-Jul-19 23:32 flywheel_migration/deidentify/xml_file_profile.py
--rw-rw-rw-  2.0 unx     1079 b- defN 23-Jul-19 23:32 flywheel_migration-13.7.0.dist-info/LICENSE
--rw-r--r--  2.0 unx     1613 b- defN 23-Jul-19 23:32 flywheel_migration-13.7.0.dist-info/METADATA
--rw-r--r--  2.0 unx      110 b- defN 23-Jul-19 23:32 flywheel_migration-13.7.0.dist-info/WHEEL
--rw-r--r--  2.0 unx       19 b- defN 23-Jul-19 23:32 flywheel_migration-13.7.0.dist-info/top_level.txt
--rw-rw-r--  2.0 unx     3132 b- defN 23-Jul-19 23:32 flywheel_migration-13.7.0.dist-info/RECORD
-32 files, 230127 bytes uncompressed, 65120 bytes compressed:  71.7%
+Zip file size: 70714 bytes, number of entries: 32
+-rw-r--r--  2.0 unx      328 b- defN 23-Jul-25 18:13 flywheel_migration/__init__.py
+-rw-r--r--  2.0 unx     3963 b- defN 23-Jul-25 18:13 flywheel_migration/bruker.py
+-rw-r--r--  2.0 unx    11451 b- defN 23-Jul-25 18:13 flywheel_migration/dcm.py
+-rw-r--r--  2.0 unx     1928 b- defN 23-Jul-25 18:13 flywheel_migration/parrec.py
+-rw-r--r--  2.0 unx     4198 b- defN 23-Jul-25 18:13 flywheel_migration/parrec_headers.py
+-rw-r--r--  2.0 unx    10284 b- defN 23-Jul-25 18:13 flywheel_migration/pfile.py
+-rw-r--r--  2.0 unx    12909 b- defN 23-Jul-25 18:13 flywheel_migration/util.py
+-rw-r--r--  2.0 unx     2656 b- defN 23-Jul-25 18:13 flywheel_migration/deidentify/__init__.py
+-rw-r--r--  2.0 unx     3930 b- defN 23-Jul-25 18:13 flywheel_migration/deidentify/csv_subject_map.py
+-rw-rw-rw-  2.0 unx      299 b- defN 23-Jul-25 18:13 flywheel_migration/deidentify/deid-profiles.yml
+-rw-r--r--  2.0 unx    28394 b- defN 23-Jul-25 18:13 flywheel_migration/deidentify/deid_field.py
+-rw-r--r--  2.0 unx     2282 b- defN 23-Jul-25 18:13 flywheel_migration/deidentify/deid_log.py
+-rw-r--r--  2.0 unx     4510 b- defN 23-Jul-25 18:13 flywheel_migration/deidentify/deid_profile.py
+-rw-r--r--  2.0 unx    49447 b- defN 23-Jul-25 18:13 flywheel_migration/deidentify/dicom_file_profile.py
+-rw-r--r--  2.0 unx      595 b- defN 23-Jul-25 18:13 flywheel_migration/deidentify/exceptions.py
+-rw-r--r--  2.0 unx     1011 b- defN 23-Jul-25 18:13 flywheel_migration/deidentify/factory.py
+-rw-r--r--  2.0 unx    24487 b- defN 23-Jul-25 18:13 flywheel_migration/deidentify/file_profile.py
+-rw-r--r--  2.0 unx     3482 b- defN 23-Jul-25 18:13 flywheel_migration/deidentify/filename_file_profile.py
+-rw-r--r--  2.0 unx     9392 b- defN 23-Jul-25 18:13 flywheel_migration/deidentify/jpg_file_profile.py
+-rw-r--r--  2.0 unx     7379 b- defN 23-Jul-25 18:13 flywheel_migration/deidentify/json_file_profile.py
+-rw-r--r--  2.0 unx     8344 b- defN 23-Jul-25 18:13 flywheel_migration/deidentify/key_value_text_file_profile.py
+-rw-r--r--  2.0 unx     7343 b- defN 23-Jul-25 18:13 flywheel_migration/deidentify/png_file_profile.py
+-rw-r--r--  2.0 unx     3479 b- defN 23-Jul-25 18:13 flywheel_migration/deidentify/subject_map.py
+-rw-r--r--  2.0 unx     5609 b- defN 23-Jul-25 18:13 flywheel_migration/deidentify/table_file_profile.py
+-rw-r--r--  2.0 unx     6757 b- defN 23-Jul-25 18:13 flywheel_migration/deidentify/tiff_file_profile.py
+-rw-r--r--  2.0 unx     3739 b- defN 23-Jul-25 18:13 flywheel_migration/deidentify/validation.py
+-rw-r--r--  2.0 unx     6935 b- defN 23-Jul-25 18:13 flywheel_migration/deidentify/xml_file_profile.py
+-rw-rw-rw-  2.0 unx     1079 b- defN 23-Jul-25 18:13 flywheel_migration-13.7.1rc0.dist-info/LICENSE
+-rw-r--r--  2.0 unx     1657 b- defN 23-Jul-25 18:13 flywheel_migration-13.7.1rc0.dist-info/METADATA
+-rw-r--r--  2.0 unx      110 b- defN 23-Jul-25 18:13 flywheel_migration-13.7.1rc0.dist-info/WHEEL
+-rw-r--r--  2.0 unx       19 b- defN 23-Jul-25 18:13 flywheel_migration-13.7.1rc0.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     3147 b- defN 23-Jul-25 18:13 flywheel_migration-13.7.1rc0.dist-info/RECORD
+32 files, 231143 bytes uncompressed, 65506 bytes compressed:  71.7%
```

## zipnote {}

```diff
@@ -75,23 +75,23 @@
 
 Filename: flywheel_migration/deidentify/validation.py
 Comment: 
 
 Filename: flywheel_migration/deidentify/xml_file_profile.py
 Comment: 
 
-Filename: flywheel_migration-13.7.0.dist-info/LICENSE
+Filename: flywheel_migration-13.7.1rc0.dist-info/LICENSE
 Comment: 
 
-Filename: flywheel_migration-13.7.0.dist-info/METADATA
+Filename: flywheel_migration-13.7.1rc0.dist-info/METADATA
 Comment: 
 
-Filename: flywheel_migration-13.7.0.dist-info/WHEEL
+Filename: flywheel_migration-13.7.1rc0.dist-info/WHEEL
 Comment: 
 
-Filename: flywheel_migration-13.7.0.dist-info/top_level.txt
+Filename: flywheel_migration-13.7.1rc0.dist-info/top_level.txt
 Comment: 
 
-Filename: flywheel_migration-13.7.0.dist-info/RECORD
+Filename: flywheel_migration-13.7.1rc0.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## flywheel_migration/deidentify/dicom_file_profile.py

```diff
@@ -23,30 +23,39 @@
 from pydicom.filebase import DicomBytesIO
 from pydicom.data import get_testdata_files
 import six
 from fs.osfs import OSFS
 from flywheel_metadata.file.dicom.fixer import fw_pydicom_config
 from flywheel_metadata.file.dicom import extend_private_dictionaries
 
-from deid.dicom import DicomCleaner
-from deid.config.utils import load_deid
-
 from flywheel_migration.util import (
     date_delta,
     is_dicom,
     dict_paths,
     walk_dicom_wild_sequence,
     get_dicom_data_elements_hex_path,
     get_dicom_data_elements_keyword_path,
 )
 from flywheel_migration.deidentify.file_profile import FileProfile
 from flywheel_migration.deidentify.deid_field import DeIdField, DeIdFieldMixin
 
 log = logging.getLogger(__name__)
 
+try:  # conditional import
+    # deid relies on C-extension to read PixelData (e.g. bound to numpy) that
+    # Flywheel python-cli build is not currently supporting.
+    # see https://flywheelio.atlassian.net/browse/FLYW-19105
+    from deid.dicom import DicomCleaner
+    from deid.config.utils import load_deid
+
+    DEID_PACKAGE_FOUND = True
+except (ImportError, ModuleNotFoundError):
+    log.warning("deid module not found. Dicom 'alter_pixels' action is not available")
+    DEID_PACKAGE_FOUND = False
+
 # extend pydicom dictionaries
 extend_private_dictionaries()
 
 # match name of type hex, e.g. 0x00100020 or 00100020
 DICOM_TAG_HEX_RE = re.compile(r"^(0x)?[0-9a-fA-F]{8}$")
 # match name of type tuple, e.g. (0010, 0020)
 DICOM_TAG_TUPLE_RE = re.compile(r"\(\s*([0-9a-fA-F]{4})\s*,\s*([0-9a-fA-F]{4})\s*\)")
@@ -1111,14 +1120,19 @@
         """
 
         errors = super(DicomFileProfile, self).validate()
 
         if self.filenames:
             self.validate_filenames(errors)
 
+        if self.pixel_actions and not DEID_PACKAGE_FOUND:
+            errors.append(
+                "Pixel actions requires pydicom deid package which was not found."
+            )
+
         for field in self.fields:
             if field.fieldname.startswith(self.filename_field_prefix):
                 continue
 
             # check that no actions on SQ tags is defined with recurse_sequence
             if self.recurse_sequence:
                 if field.fieldname.dicom_tag and field.fieldname.is_sequence:
```

## flywheel_migration/deidentify/file_profile.py

```diff
@@ -239,15 +239,15 @@
         """Read configuration from a dictionary"""
         # Sort fields
         config["fields"] = self.sort_fields(config.get("fields", []))
         # Read fields
         for field in config.get("fields", []):
             self.add_field(DeIdField.factory(field, mixin=self.deidfield_mixin))
 
-        # Read pixels defintion
+        # Read pixels definition
         self.pixel_actions = config.get("alter_pixels", {}).get("pixels")
         self.detect = config.get("alter_pixels", {}).get("detect")
 
         # Read file_filter
         self.file_filter = config.get("file-filter", self.file_filter)
 
         # Read action configuration
```

## flywheel_migration/deidentify/json_file_profile.py

```diff
@@ -36,15 +36,15 @@
         except KeyError:  # looking for attribute on record (e.g. filename attribute)
             return getattr(self, key)
 
     def __setitem__(self, key, value):
         self._metadata[key] = value
 
     def __delitem__(self, key):
-        self._metadata.pop(key)
+        del self._metadata[key]
 
     def __len__(self):
         return len(self._metadata)
 
     @property
     def separator(self):
         """Returns separator used in Dotty"""
@@ -166,16 +166,17 @@
             """"""
             # Replicate field
             attrs = record.get_all_dotty_paths()
             reg = re.compile(field.fieldname)
             for attr in attrs:
                 match = reg.match(attr)
                 if match:
+                    conf = {k: v for k, v in field.to_config().items() if k != "regex"}
                     tmp_field = DeIdField.factory(
-                        {"name": attr, field.key: getattr(field, "value", True)}
+                        {"name": attr, field.key: getattr(field, "value", True), **conf}
                     )
                     tmp_field.deidentify(profile, state, record)
 
         # Patch field.deidentify if fieldname is regexp
         if getattr(field, "_is_regex", None):
             field.deidentify = types.MethodType(deidentify_regex_field, field)
```

## flywheel_migration/deidentify/table_file_profile.py

```diff
@@ -29,16 +29,19 @@
     def __getitem__(self, key):
         # e.g. to get filename attributes on record
         return getattr(self, key)
 
     def __delitem__(self, key):
         if key in self.df.columns:
             self.df.drop(labels=[key], axis=1, inplace=True)
-        else:
+        elif hasattr(self, key):
             delattr(self, key)
+        else:
+            # NOOP if key is not in DF.
+            return
 
     def __len__(self):
         return len(self.df)
 
     def save_as(self, fp, to=None):
         """Save record to file buffer"""
         if to:
@@ -84,14 +87,17 @@
         if self.delimiter != self.__class__.delimiter:
             results["delimiter"] = self.delimiter
         return results
 
     def add_field(self, field):
         def deidentify_by_series(field, profile, state, record):
             """De-identify dataframe series wise"""
+            # NOTE: Don't need to deidentify series-wise if key is not in DF.
+            if field.fieldname not in record.df.columns:
+                return
             tmp_field = DeIdField.factory(field.to_config())
             for idx, series in record.df.iterrows():
                 tmp_field.deidentify(profile, state, series)
                 record.df.loc[idx] = series
 
         # remove action, remove the column and we don't want to patch filename
         # fields
```

## Comparing `flywheel_migration-13.7.0.dist-info/LICENSE` & `flywheel_migration-13.7.1rc0.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `flywheel_migration-13.7.0.dist-info/METADATA` & `flywheel_migration-13.7.1rc0.dist-info/METADATA`

 * *Files 8% similar despite different names*

```diff
@@ -1,20 +1,19 @@
 Metadata-Version: 2.1
 Name: flywheel-migration
-Version: 13.7.0
+Version: 13.7.1rc0
 Summary: Flywheel Migration Toolkit
 Home-page: https://gitlab.com/flywheel-io/public/migration-toolkit
 Author-email: support@flywheel.io
 License: MIT
 Project-URL: Source, https://gitlab.com/flywheel-io/public/migration-toolkit
 Keywords: Flywheel,flywheel,data,migration,toolkit
 Platform: UNKNOWN
 License-File: LICENSE
 Requires-Dist: fs (>=2.4.0)
-Requires-Dist: deid (>=0.2.29)
 Requires-Dist: pydicom (<2.2.0,>=2.1.0)
 Requires-Dist: pytz
 Requires-Dist: ruamel.yaml (>=0.16.7)
 Requires-Dist: python-dateutil (>=2.7.0)
 Requires-Dist: tzlocal (>=2.1)
 Requires-Dist: pillow (<10.0.0,>=8.2)
 Requires-Dist: lxml (>=4.5.0)
@@ -31,14 +30,16 @@
 Requires-Dist: pytest (>=5.0.0) ; extra == 'dev'
 Requires-Dist: pytest-cov (>=2.0.0) ; extra == 'dev'
 Requires-Dist: pytest-mock (>=3.0.0) ; extra == 'dev'
 Requires-Dist: pygments (>=2.6.1) ; extra == 'dev'
 Requires-Dist: sphinx (>=3.2.1) ; extra == 'dev'
 Requires-Dist: sphinx-rtd-theme (>=0.5.0) ; extra == 'dev'
 Requires-Dist: ipython ; extra == 'dev'
+Provides-Extra: pixel
+Requires-Dist: deid (>=0.2.29) ; extra == 'pixel'
 
 
 Flywheel Migration Toolkit
 ==========================
 
 A Toolkit for parsing and de-identifying data.
```

## Comparing `flywheel_migration-13.7.0.dist-info/RECORD` & `flywheel_migration-13.7.1rc0.dist-info/RECORD`

 * *Files 8% similar despite different names*

```diff
@@ -7,26 +7,26 @@
 flywheel_migration/util.py,sha256=FAMd-uZ-VogifDP3v1p68rUomXC9nxDgSV4WYZYR6Ew,12909
 flywheel_migration/deidentify/__init__.py,sha256=_qaznYb20wMDRfeUd-7RcLQ4a3X9CMqYg95yNKJ6b8c,2656
 flywheel_migration/deidentify/csv_subject_map.py,sha256=2GwOQGLMNIQOz5c7FtjlDAd6oxzb4a8yqSbQyGd-QT0,3930
 flywheel_migration/deidentify/deid-profiles.yml,sha256=-7IPdHJyT01yHoEDusSxdhlMZ5a9j65Tc_3iukm-k0o,299
 flywheel_migration/deidentify/deid_field.py,sha256=M6HHix8J2fE_xYekyFj3zWVUdFd3lvfHGNh3g0VUT38,28394
 flywheel_migration/deidentify/deid_log.py,sha256=_zDZ3XiwLB9N7N9p3zZdNqWBKtsrgLmD42f7QkLIcQw,2282
 flywheel_migration/deidentify/deid_profile.py,sha256=LkOccw41UX75eatOtjHuKi0LhTf5ozCn3zkYT9_eu34,4510
-flywheel_migration/deidentify/dicom_file_profile.py,sha256=-0bONYBRm5PdsOEGJylMlOJQJu957RFuWR7lnNiJaDg,48837
+flywheel_migration/deidentify/dicom_file_profile.py,sha256=8UM-iXywf4VPM5EtcjsUvoTnrt3aifhEnbKCFMRAtb0,49447
 flywheel_migration/deidentify/exceptions.py,sha256=C1VV9CxM_6dKGwTc4__kiT7NO967h0x0S008wMcKjJM,595
 flywheel_migration/deidentify/factory.py,sha256=u3kkvCpVLtfd1S7vG_SUVjtZvF8wVOOZ0ERq_FOkd0c,1011
-flywheel_migration/deidentify/file_profile.py,sha256=pd-syCbzkx4kiToRhhGp3NwqXQrZfJiYDfb4r0sB7NY,24486
+flywheel_migration/deidentify/file_profile.py,sha256=rbKc0pRXsRbTJWAYYHPuFPGYyM1KwCzJxEQItozS-MM,24487
 flywheel_migration/deidentify/filename_file_profile.py,sha256=QztKXqLv28jiqSup6Qsysv7xz2MmkNCyCs44P8A-CDo,3482
 flywheel_migration/deidentify/jpg_file_profile.py,sha256=Kcr3DrPbiPAhgK9oh_hBhn9KpynHABE5xWIkp1TTUmA,9392
-flywheel_migration/deidentify/json_file_profile.py,sha256=U07M7m3O-87lWNSVSfcV93g6cBuuu7PgVRbbXdWwCnI,7283
+flywheel_migration/deidentify/json_file_profile.py,sha256=zub5LBqUxKSKbQxZ09gdKBqlZ5CZVPiziyCDpFJo-CY,7379
 flywheel_migration/deidentify/key_value_text_file_profile.py,sha256=OTIObeltZzvZxaRawVPw1_hX9qYhlAGPp1fZ46z6tnU,8344
 flywheel_migration/deidentify/png_file_profile.py,sha256=8LyPetGpkWlmwSzWd7sAltkppwFC8O89uw1K1ancvCA,7343
 flywheel_migration/deidentify/subject_map.py,sha256=-uI7rqoH78lp7V5TlfyljXYIa3n5q6ADRZ281gnw3kU,3479
-flywheel_migration/deidentify/table_file_profile.py,sha256=cPbn1ownmWdeApVd1XG41ZmiW2iD4cwIr5TRJLA1DYA,5359
+flywheel_migration/deidentify/table_file_profile.py,sha256=CPCYaiQ74f8Je-WlQgm4OrNZo9G3S4KGLnYdwLEiRyY,5609
 flywheel_migration/deidentify/tiff_file_profile.py,sha256=o2MWYfH-GDCX5YJGRehVRxl7cxbPhakblw7e9XXjxzI,6757
 flywheel_migration/deidentify/validation.py,sha256=iQn07ImNVT7WXW8zECo3SYnM3_QCqe4CkGy7bm_B75k,3739
 flywheel_migration/deidentify/xml_file_profile.py,sha256=H4f4Y9f_ZwJXZOxTOnjcDinhCrIrsXuwo2TMZcdzIyY,6935
-flywheel_migration-13.7.0.dist-info/LICENSE,sha256=g8FHmJhCi2s7ED_CkJTem8yk0SWJZRzHFPkgvwgGRL8,1079
-flywheel_migration-13.7.0.dist-info/METADATA,sha256=Gykvso7MYfF81X7C_L8cZM5NLf8E9LhFMnI0YtVVZj8,1613
-flywheel_migration-13.7.0.dist-info/WHEEL,sha256=a-zpFRIJzOq5QfuhBzbhiA1eHTzNCJn8OdRvhdNX0Rk,110
-flywheel_migration-13.7.0.dist-info/top_level.txt,sha256=mYtDTPS_OVmuhe90Re9s2V1AA66q2MW3X6BbhHSo_Yk,19
-flywheel_migration-13.7.0.dist-info/RECORD,,
+flywheel_migration-13.7.1rc0.dist-info/LICENSE,sha256=g8FHmJhCi2s7ED_CkJTem8yk0SWJZRzHFPkgvwgGRL8,1079
+flywheel_migration-13.7.1rc0.dist-info/METADATA,sha256=OMfuLLVOGL490LIfGwdHAIp8-HkOkvkCuLHubqv3DDs,1657
+flywheel_migration-13.7.1rc0.dist-info/WHEEL,sha256=a-zpFRIJzOq5QfuhBzbhiA1eHTzNCJn8OdRvhdNX0Rk,110
+flywheel_migration-13.7.1rc0.dist-info/top_level.txt,sha256=mYtDTPS_OVmuhe90Re9s2V1AA66q2MW3X6BbhHSo_Yk,19
+flywheel_migration-13.7.1rc0.dist-info/RECORD,,
```

