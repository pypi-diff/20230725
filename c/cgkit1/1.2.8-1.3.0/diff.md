# Comparing `tmp/cgkit1-1.2.8.tar.gz` & `tmp/cgkit1-1.3.0.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "cgkit1-1.2.8.tar", last modified: Wed Jul 19 08:13:38 2023, max compression
+gzip compressed data, was "cgkit1-1.3.0.tar", last modified: Tue Jul 25 06:43:02 2023, max compression
```

## Comparing `cgkit1-1.2.8.tar` & `cgkit1-1.3.0.tar`

### file list

```diff
@@ -1,21 +1,15 @@
-drwxr-xr-x   0 andrew     (504) staff       (20)        0 2023-07-19 08:13:38.570569 cgkit1-1.2.8/
--rw-r--r--   0 andrew     (504) staff       (20)       38 2020-04-07 09:07:49.000000 cgkit1-1.2.8/MANIFEST.in
--rw-r--r--   0 andrew     (504) staff       (20)     4109 2023-07-19 08:13:38.570405 cgkit1-1.2.8/PKG-INFO
--rw-r--r--   0 andrew     (504) staff       (20)     2116 2020-06-16 21:54:15.000000 cgkit1-1.2.8/README.md
-drwxr-xr-x   0 andrew     (504) staff       (20)        0 2023-07-19 08:13:38.567942 cgkit1-1.2.8/cgkit1.egg-info/
--rw-r--r--   0 andrew     (504) staff       (20)     4109 2023-07-19 08:13:38.000000 cgkit1-1.2.8/cgkit1.egg-info/PKG-INFO
--rw-r--r--   0 andrew     (504) staff       (20)      301 2023-07-19 08:13:38.000000 cgkit1-1.2.8/cgkit1.egg-info/SOURCES.txt
--rw-r--r--   0 andrew     (504) staff       (20)        1 2023-07-19 08:13:38.000000 cgkit1-1.2.8/cgkit1.egg-info/dependency_links.txt
--rw-r--r--   0 andrew     (504) staff       (20)       18 2023-07-19 08:13:38.000000 cgkit1-1.2.8/cgkit1.egg-info/top_level.txt
--rw-r--r--   0 andrew     (504) staff       (20)   147017 2023-07-19 07:05:50.000000 cgkit1-1.2.8/cgtypes.pyx
--rw-r--r--   0 andrew     (504) staff       (20)     1468 2002-04-29 17:15:36.000000 cgkit1-1.2.8/license.txt
-drwxr-xr-x   0 andrew     (504) staff       (20)        0 2023-07-19 08:13:38.570011 cgkit1-1.2.8/pycgtypes/
--rw-r--r--   0 andrew     (504) staff       (20)      467 2020-04-06 21:43:42.000000 cgkit1-1.2.8/pycgtypes/__init__.py
--rw-r--r--   0 andrew     (504) staff       (20)    13495 2020-04-06 21:43:42.000000 cgkit1-1.2.8/pycgtypes/mat3.py
--rw-r--r--   0 andrew     (504) staff       (20)    23619 2020-04-06 21:43:42.000000 cgkit1-1.2.8/pycgtypes/mat4.py
--rw-r--r--   0 andrew     (504) staff       (20)    11436 2020-04-06 21:43:42.000000 cgkit1-1.2.8/pycgtypes/quat.py
--rw-r--r--   0 andrew     (504) staff       (20)    13820 2020-04-06 21:43:42.000000 cgkit1-1.2.8/pycgtypes/vec3.py
--rw-r--r--   0 andrew     (504) staff       (20)    12180 2020-04-06 21:43:42.000000 cgkit1-1.2.8/pycgtypes/vec4.py
--rw-r--r--   0 andrew     (504) staff       (20)      668 2023-07-19 07:13:21.000000 cgkit1-1.2.8/pyproject.toml
--rw-r--r--   0 andrew     (504) staff       (20)       38 2023-07-19 08:13:38.570618 cgkit1-1.2.8/setup.cfg
--rw-r--r--   0 andrew     (504) staff       (20)      578 2023-07-19 07:12:31.000000 cgkit1-1.2.8/setup.py
+drwxrwxr-x   0 astraw    (1000) astraw    (1000)        0 2023-07-25 06:43:02.220948 cgkit1-1.3.0/
+-rw-rw-r--   0 astraw    (1000) astraw    (1000)       38 2023-07-22 07:11:55.000000 cgkit1-1.3.0/MANIFEST.in
+-rw-rw-r--   0 astraw    (1000) astraw    (1000)     3190 2023-07-25 06:43:02.220948 cgkit1-1.3.0/PKG-INFO
+-rw-rw-r--   0 astraw    (1000) astraw    (1000)     1197 2023-07-22 07:11:55.000000 cgkit1-1.3.0/README.md
+drwxrwxr-x   0 astraw    (1000) astraw    (1000)        0 2023-07-25 06:43:02.220948 cgkit1-1.3.0/cgkit1.egg-info/
+-rw-rw-r--   0 astraw    (1000) astraw    (1000)     3190 2023-07-25 06:43:02.000000 cgkit1-1.3.0/cgkit1.egg-info/PKG-INFO
+-rw-rw-r--   0 astraw    (1000) astraw    (1000)      202 2023-07-25 06:43:02.000000 cgkit1-1.3.0/cgkit1.egg-info/SOURCES.txt
+-rw-rw-r--   0 astraw    (1000) astraw    (1000)        1 2023-07-25 06:43:02.000000 cgkit1-1.3.0/cgkit1.egg-info/dependency_links.txt
+-rw-rw-r--   0 astraw    (1000) astraw    (1000)       18 2023-07-25 06:43:02.000000 cgkit1-1.3.0/cgkit1.egg-info/top_level.txt
+-rw-rw-r--   0 astraw    (1000) astraw    (1000)      422 2023-07-25 06:41:02.000000 cgkit1-1.3.0/cgkitinfo.py
+-rw-rw-r--   0 astraw    (1000) astraw    (1000)   147107 2023-07-25 06:39:38.000000 cgkit1-1.3.0/cgtypes.pyx
+-rw-rw-r--   0 astraw    (1000) astraw    (1000)     1468 2023-07-22 07:11:55.000000 cgkit1-1.3.0/license.txt
+-rw-rw-r--   0 astraw    (1000) astraw    (1000)      617 2023-07-25 06:40:51.000000 cgkit1-1.3.0/pyproject.toml
+-rw-rw-r--   0 astraw    (1000) astraw    (1000)       38 2023-07-25 06:43:02.220948 cgkit1-1.3.0/setup.cfg
+-rw-rw-r--   0 astraw    (1000) astraw    (1000)      578 2023-07-22 07:11:55.000000 cgkit1-1.3.0/setup.py
```

### Comparing `cgkit1-1.2.8/PKG-INFO` & `cgkit1-1.3.0/PKG-INFO`

 * *Files 19% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: cgkit1
-Version: 1.2.8
+Version: 1.3.0
 Summary: Python Computer Graphics Kit v1
 Author-email: Matthias Bass <baas@ira.uka.de>
 Maintainer-email: Andrew Straw <strawman@astraw.com>
 License: Copyright (c) 2002, Matthias Baas
         All rights reserved.
         
         Redistribution and use in source and binary forms, with or without
@@ -41,16 +41,16 @@
 # cgkit1
 
 [![build](https://github.com/strawlab/cgkit1/workflows/build-and-test/badge.svg?branch=master)](https://github.com/strawlab/cgkit1/actions?query=branch%3Amaster)
 [![PyPI version](https://badge.fury.io/py/cgkit1.svg)](https://badge.fury.io/py/cgkit1)
 
 This is a fork of Matthias Bass's python-cgkit v1.2.0.
 
-It has been updated to be compatible with Python 2 and 3 and has the
-renderman and noise generation code removed.
+It has been updated to be compatible with Python 3 and has the renderman and
+noise generation code removed.
 
 <hr>
 Python Computer Graphics Kit v1.2.0
 
 Copyright (C) 2002, Matthias Baas (see license.txt)
 <hr>
 
@@ -58,40 +58,19 @@
 that contain the basic types and functions to be able to create 3D
 computer graphics images. The kit mainly focuses on Pixar's RenderMan
 interface, but some modules can also be used for OpenGL programs or
 non-RenderMan compliant renderers like POV-Ray, for example.
 
 ## Installing the package
 
-The package uses the Python distutils, so compiling and installing
-looks the same on every platform, you simply have to call:
+The package uses the Python
+[build](https://pypa-build.readthedocs.io/en/stable/), so compiling and
+installing looks the same on every platform, you simply have to call:
 
 ```
-python setup.py install
+python -m build
 ```
 
 This will compile the C-modules and install everything in the standard
-location. See the distutils documentation that are coming with Python
-if you have to install somewhere else.
-If you've updated the sources for cgkit I recommend to delete the "build"
-directory before compiling so that all the old code is out of the way.
-
-The cgtypes module uses Pyrex (v0.9 or higher required) to generate
-the C source file. The generated C file is included in the source
-package, so you only need Pyrex if you want to modify the cgtypes module.
-
-Once installed you can check the examples in the examples directory.
-
-IMPORTANT:
-
-If you've installed a version before v1.0beta3 you have to remove
-the directory Lib/site-packages/cgtypes in your Python distribution.
-Otherwise Python will access the old Python types instead of the
-new C types (which are located directly in Lib/site-packages).
-
-## Documentation
-
-The documentation has to be downloaded separatly or you can browse
-it online. Whatever you prefer, you should point your browser to:
-
-http://cgkit.sourceforge.net
+location.
 
+The cgtypes module uses Cython.
```

### Comparing `cgkit1-1.2.8/README.md` & `cgkit1-1.3.0/README.md`

 * *Files 26% similar despite different names*

```diff
@@ -1,16 +1,16 @@
 # cgkit1
 
 [![build](https://github.com/strawlab/cgkit1/workflows/build-and-test/badge.svg?branch=master)](https://github.com/strawlab/cgkit1/actions?query=branch%3Amaster)
 [![PyPI version](https://badge.fury.io/py/cgkit1.svg)](https://badge.fury.io/py/cgkit1)
 
 This is a fork of Matthias Bass's python-cgkit v1.2.0.
 
-It has been updated to be compatible with Python 2 and 3 and has the
-renderman and noise generation code removed.
+It has been updated to be compatible with Python 3 and has the renderman and
+noise generation code removed.
 
 <hr>
 Python Computer Graphics Kit v1.2.0
 
 Copyright (C) 2002, Matthias Baas (see license.txt)
 <hr>
 
@@ -18,40 +18,19 @@
 that contain the basic types and functions to be able to create 3D
 computer graphics images. The kit mainly focuses on Pixar's RenderMan
 interface, but some modules can also be used for OpenGL programs or
 non-RenderMan compliant renderers like POV-Ray, for example.
 
 ## Installing the package
 
-The package uses the Python distutils, so compiling and installing
-looks the same on every platform, you simply have to call:
+The package uses the Python
+[build](https://pypa-build.readthedocs.io/en/stable/), so compiling and
+installing looks the same on every platform, you simply have to call:
 
 ```
-python setup.py install
+python -m build
 ```
 
 This will compile the C-modules and install everything in the standard
-location. See the distutils documentation that are coming with Python
-if you have to install somewhere else.
-If you've updated the sources for cgkit I recommend to delete the "build"
-directory before compiling so that all the old code is out of the way.
-
-The cgtypes module uses Pyrex (v0.9 or higher required) to generate
-the C source file. The generated C file is included in the source
-package, so you only need Pyrex if you want to modify the cgtypes module.
-
-Once installed you can check the examples in the examples directory.
-
-IMPORTANT:
-
-If you've installed a version before v1.0beta3 you have to remove
-the directory Lib/site-packages/cgtypes in your Python distribution.
-Otherwise Python will access the old Python types instead of the
-new C types (which are located directly in Lib/site-packages).
-
-## Documentation
-
-The documentation has to be downloaded separatly or you can browse
-it online. Whatever you prefer, you should point your browser to:
-
-http://cgkit.sourceforge.net
+location.
 
+The cgtypes module uses Cython.
```

### Comparing `cgkit1-1.2.8/cgkit1.egg-info/PKG-INFO` & `cgkit1-1.3.0/cgkit1.egg-info/PKG-INFO`

 * *Files 19% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: cgkit1
-Version: 1.2.8
+Version: 1.3.0
 Summary: Python Computer Graphics Kit v1
 Author-email: Matthias Bass <baas@ira.uka.de>
 Maintainer-email: Andrew Straw <strawman@astraw.com>
 License: Copyright (c) 2002, Matthias Baas
         All rights reserved.
         
         Redistribution and use in source and binary forms, with or without
@@ -41,16 +41,16 @@
 # cgkit1
 
 [![build](https://github.com/strawlab/cgkit1/workflows/build-and-test/badge.svg?branch=master)](https://github.com/strawlab/cgkit1/actions?query=branch%3Amaster)
 [![PyPI version](https://badge.fury.io/py/cgkit1.svg)](https://badge.fury.io/py/cgkit1)
 
 This is a fork of Matthias Bass's python-cgkit v1.2.0.
 
-It has been updated to be compatible with Python 2 and 3 and has the
-renderman and noise generation code removed.
+It has been updated to be compatible with Python 3 and has the renderman and
+noise generation code removed.
 
 <hr>
 Python Computer Graphics Kit v1.2.0
 
 Copyright (C) 2002, Matthias Baas (see license.txt)
 <hr>
 
@@ -58,40 +58,19 @@
 that contain the basic types and functions to be able to create 3D
 computer graphics images. The kit mainly focuses on Pixar's RenderMan
 interface, but some modules can also be used for OpenGL programs or
 non-RenderMan compliant renderers like POV-Ray, for example.
 
 ## Installing the package
 
-The package uses the Python distutils, so compiling and installing
-looks the same on every platform, you simply have to call:
+The package uses the Python
+[build](https://pypa-build.readthedocs.io/en/stable/), so compiling and
+installing looks the same on every platform, you simply have to call:
 
 ```
-python setup.py install
+python -m build
 ```
 
 This will compile the C-modules and install everything in the standard
-location. See the distutils documentation that are coming with Python
-if you have to install somewhere else.
-If you've updated the sources for cgkit I recommend to delete the "build"
-directory before compiling so that all the old code is out of the way.
-
-The cgtypes module uses Pyrex (v0.9 or higher required) to generate
-the C source file. The generated C file is included in the source
-package, so you only need Pyrex if you want to modify the cgtypes module.
-
-Once installed you can check the examples in the examples directory.
-
-IMPORTANT:
-
-If you've installed a version before v1.0beta3 you have to remove
-the directory Lib/site-packages/cgtypes in your Python distribution.
-Otherwise Python will access the old Python types instead of the
-new C types (which are located directly in Lib/site-packages).
-
-## Documentation
-
-The documentation has to be downloaded separatly or you can browse
-it online. Whatever you prefer, you should point your browser to:
-
-http://cgkit.sourceforge.net
+location.
 
+The cgtypes module uses Cython.
```

### Comparing `cgkit1-1.2.8/cgtypes.pyx` & `cgkit1-1.3.0/cgtypes.pyx`

 * *Files 1% similar despite different names*

```diff
@@ -1,9189 +1,9195 @@
 00000000: 2320 2d2a 2d20 636f 6469 6e67 3a20 7574  # -*- coding: ut
 00000010: 662d 3820 2d2a 2d0a 2320 6379 7468 6f6e  f-8 -*-.# cython
-00000020: 3a20 6c61 6e67 7561 6765 5f6c 6576 656c  : language_level
-00000030: 3d32 0a23 2323 2323 2323 2323 2323 2323  =2.#############
+00000020: 3a20 635f 6170 695f 6269 6e6f 705f 6d65  : c_api_binop_me
+00000030: 7468 6f64 733d 5472 7565 0a23 2323 2323  thods=True.#####
 00000040: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00000050: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00000060: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00000070: 2323 2323 2323 2323 230a 2320 6367 7479  #########.# cgty
-00000080: 7065 7320 2d20 7665 6333 2c20 7665 6334  pes - vec3, vec4
-00000090: 2c20 6d61 7433 2c20 6d61 7434 2c20 7175  , mat3, mat4, qu
-000000a0: 6174 0a23 0a23 2043 6f70 7972 6967 6874  at.#.# Copyright
-000000b0: 2028 4329 2032 3030 322c 204d 6174 7468   (C) 2002, Matth
-000000c0: 6961 7320 4261 6173 2028 6261 6173 4069  ias Baas (baas@i
-000000d0: 7261 2e75 6b61 2e64 6529 0a23 0a23 2068  ra.uka.de).#.# h
-000000e0: 7474 703a 2f2f 6367 6b69 742e 736f 7572  ttp://cgkit.sour
-000000f0: 6365 666f 7267 652e 6e65 740a 230a 2320  ceforge.net.#.# 
-00000100: 596f 7520 6d61 7920 6469 7374 7269 6275  You may distribu
-00000110: 7465 2075 6e64 6572 2074 6865 2074 6572  te under the ter
-00000120: 6d73 206f 6620 7468 6520 4253 4420 6c69  ms of the BSD li
-00000130: 6365 6e73 652c 2061 730a 2320 7370 6563  cense, as.# spec
-00000140: 6966 6965 6420 696e 2074 6865 2066 696c  ified in the fil
-00000150: 6520 6c69 6365 6e73 652e 7478 742e 0a23  e license.txt..#
-00000160: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00000070: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00000080: 230a 2320 6367 7479 7065 7320 2d20 7665  #.# cgtypes - ve
+00000090: 6333 2c20 7665 6334 2c20 6d61 7433 2c20  c3, vec4, mat3, 
+000000a0: 6d61 7434 2c20 7175 6174 0a23 0a23 2043  mat4, quat.#.# C
+000000b0: 6f70 7972 6967 6874 2028 4329 2032 3030  opyright (C) 200
+000000c0: 322c 204d 6174 7468 6961 7320 4261 6173  2, Matthias Baas
+000000d0: 2028 6261 6173 4069 7261 2e75 6b61 2e64   (baas@ira.uka.d
+000000e0: 6529 0a23 0a23 2068 7474 703a 2f2f 6367  e).#.# http://cg
+000000f0: 6b69 742e 736f 7572 6365 666f 7267 652e  kit.sourceforge.
+00000100: 6e65 740a 230a 2320 596f 7520 6d61 7920  net.#.# You may 
+00000110: 6469 7374 7269 6275 7465 2075 6e64 6572  distribute under
+00000120: 2074 6865 2074 6572 6d73 206f 6620 7468   the terms of th
+00000130: 6520 4253 4420 6c69 6365 6e73 652c 2061  e BSD license, a
+00000140: 730a 2320 7370 6563 6966 6965 6420 696e  s.# specified in
+00000150: 2074 6865 2066 696c 6520 6c69 6365 6e73   the file licens
+00000160: 652e 7478 742e 0a23 2323 2323 2323 2323  e.txt..#########
 00000170: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00000180: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00000190: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000001a0: 2323 230a 0a23 2053 6f6d 6520 6d61 7468  ###..# Some math
-000001b0: 2066 756e 6374 696f 6e73 0a66 726f 6d20   functions.from 
-000001c0: 6c69 6263 2e6d 6174 6820 6369 6d70 6f72  libc.math cimpor
-000001d0: 7420 7371 7274 2c20 6661 6273 2c20 7369  t sqrt, fabs, si
-000001e0: 6e2c 2063 6f73 2c20 7461 6e2c 2061 636f  n, cos, tan, aco
-000001f0: 732c 2065 7870 2c20 6c6f 672c 2061 7461  s, exp, log, ata
-00000200: 6e32 0a0a 2320 5468 7265 7368 6f6c 6420  n2..# Threshold 
-00000210: 666f 7220 636f 6d70 6172 6973 6f6e 730a  for comparisons.
-00000220: 6364 6566 2064 6f75 626c 6520 6570 730a  cdef double eps.
-00000230: 6570 7320 3d20 3145 2d31 360a 0a23 2323  eps = 1E-16..###
-00000240: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000001a0: 2323 2323 2323 2323 2323 230a 0a23 2053  ###########..# S
+000001b0: 6f6d 6520 6d61 7468 2066 756e 6374 696f  ome math functio
+000001c0: 6e73 0a66 726f 6d20 6c69 6263 2e6d 6174  ns.from libc.mat
+000001d0: 6820 6369 6d70 6f72 7420 7371 7274 2c20  h cimport sqrt, 
+000001e0: 6661 6273 2c20 7369 6e2c 2063 6f73 2c20  fabs, sin, cos, 
+000001f0: 7461 6e2c 2061 636f 732c 2065 7870 2c20  tan, acos, exp, 
+00000200: 6c6f 672c 2061 7461 6e32 0a0a 2320 5468  log, atan2..# Th
+00000210: 7265 7368 6f6c 6420 666f 7220 636f 6d70  reshold for comp
+00000220: 6172 6973 6f6e 730a 6364 6566 2064 6f75  arisons.cdef dou
+00000230: 626c 6520 6570 730a 6570 7320 3d20 3145  ble eps.eps = 1E
+00000240: 2d31 360a 0a23 2323 2323 2323 2323 2323  -16..###########
 00000250: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00000260: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00000270: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00000280: 2323 230a 0a23 205f 666d 6f64 3a20 4120  ###..# _fmod: A 
-00000290: 6d6f 6475 6c6f 2066 756e 6374 696f 6e20  modulo function 
-000002a0: 7468 6174 2061 6c73 6f20 776f 726b 7320  that also works 
-000002b0: 7769 7468 206e 6567 6174 6976 6520 610a  with negative a.
-000002c0: 6364 6566 2064 6f75 626c 6520 5f66 6d6f  cdef double _fmo
-000002d0: 6428 646f 7562 6c65 2061 2c20 646f 7562  d(double a, doub
-000002e0: 6c65 2062 293a 0a20 2020 2063 6465 6620  le b):.    cdef 
-000002f0: 696e 7420 6e0a 2020 2020 6e20 3d20 3c69  int n.    n = <i
-00000300: 6e74 3e28 612f 6229 0a20 2020 2061 203d  nt>(a/b).    a =
-00000310: 2061 2d6e 2a62 0a20 2020 2069 6620 613c   a-n*b.    if a<
-00000320: 303a 0a20 2020 2020 2020 2061 3d61 2b62  0:.        a=a+b
-00000330: 0a20 2020 2072 6574 7572 6e20 610a 0a23  .    return a..#
-00000340: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00000280: 2323 2323 2323 2323 2323 230a 0a23 205f  ###########..# _
+00000290: 666d 6f64 3a20 4120 6d6f 6475 6c6f 2066  fmod: A modulo f
+000002a0: 756e 6374 696f 6e20 7468 6174 2061 6c73  unction that als
+000002b0: 6f20 776f 726b 7320 7769 7468 206e 6567  o works with neg
+000002c0: 6174 6976 6520 610a 6364 6566 2064 6f75  ative a.cdef dou
+000002d0: 626c 6520 5f66 6d6f 6428 646f 7562 6c65  ble _fmod(double
+000002e0: 2061 2c20 646f 7562 6c65 2062 293a 0a20   a, double b):. 
+000002f0: 2020 2063 6465 6620 696e 7420 6e0a 2020     cdef int n.  
+00000300: 2020 6e20 3d20 3c69 6e74 3e28 612f 6229    n = <int>(a/b)
+00000310: 0a20 2020 2061 203d 2061 2d6e 2a62 0a20  .    a = a-n*b. 
+00000320: 2020 2069 6620 613c 303a 0a20 2020 2020     if a<0:.     
+00000330: 2020 2061 3d61 2b62 0a20 2020 2072 6574     a=a+b.    ret
+00000340: 7572 6e20 610a 0a23 2323 2323 2323 2323  urn a..#########
 00000350: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00000360: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00000370: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00000380: 2323 2323 230a 0a23 2073 6574 4570 7369  #####..# setEpsi
-00000390: 6c6f 6e0a 6465 6620 7365 7445 7073 696c  lon.def setEpsil
-000003a0: 6f6e 2865 293a 0a20 2020 2022 2222 5365  on(e):.    """Se
-000003b0: 7473 2061 206e 6577 2065 7073 696c 6f6e  ts a new epsilon
-000003c0: 2074 6872 6573 686f 6c64 2076 616c 7565   threshold value
-000003d0: 2e0a 0a20 2020 2053 6574 7320 6120 6e65  ...    Sets a ne
-000003e0: 7720 6570 7369 6c6f 6e20 7468 7265 7368  w epsilon thresh
-000003f0: 6f6c 6420 7661 6c75 6520 616e 6420 7265  old value and re
-00000400: 7475 726e 7320 7468 6520 7072 6576 696f  turns the previo
-00000410: 7573 6c79 2073 6574 0a20 2020 2076 616c  usly set.    val
-00000420: 7565 2e20 5477 6f20 7661 6c75 6573 2061  ue. Two values a
-00000430: 7265 2063 6f6e 7369 6465 7265 6420 746f  re considered to
-00000440: 2062 6520 6571 7561 6c20 6966 2074 6865   be equal if the
-00000450: 6972 2061 6273 6f6c 7574 650a 2020 2020  ir absolute.    
-00000460: 6469 6666 6572 656e 6365 2069 7320 6c65  difference is le
-00000470: 7373 2074 6861 6e20 6f72 2065 7175 616c  ss than or equal
-00000480: 2074 6f20 6570 7369 6c6f 6e2e 2222 220a   to epsilon.""".
-00000490: 2020 2020 676c 6f62 616c 2065 7073 0a20      global eps. 
-000004a0: 2020 2072 6573 203d 2065 7073 0a20 2020     res = eps.   
-000004b0: 2065 7073 203d 2065 0a20 2020 2072 6574   eps = e.    ret
-000004c0: 7572 6e20 7265 730a 0a23 2067 6574 4570  urn res..# getEp
-000004d0: 7369 6c6f 6e0a 6465 6620 6765 7445 7073  silon.def getEps
-000004e0: 696c 6f6e 2829 3a0a 2020 2020 2222 2252  ilon():.    """R
-000004f0: 6574 7572 6e20 7468 6520 6570 7369 6c6f  eturn the epsilo
-00000500: 6e20 7468 7265 7368 6f6c 6420 7768 6963  n threshold whic
-00000510: 6820 6973 2075 7365 6420 666f 7220 646f  h is used for do
-00000520: 696e 6720 636f 6d70 6172 6973 6f6e 732e  ing comparisons.
-00000530: 2222 220a 2020 2020 7265 7475 726e 2065  """.    return e
-00000540: 7073 0a0a 0a23 2323 2323 2323 2323 2323  ps...###########
+00000380: 2323 2323 2323 2323 2323 2323 230a 0a23  #############..#
+00000390: 2073 6574 4570 7369 6c6f 6e0a 6465 6620   setEpsilon.def 
+000003a0: 7365 7445 7073 696c 6f6e 2865 293a 0a20  setEpsilon(e):. 
+000003b0: 2020 2022 2222 5365 7473 2061 206e 6577     """Sets a new
+000003c0: 2065 7073 696c 6f6e 2074 6872 6573 686f   epsilon thresho
+000003d0: 6c64 2076 616c 7565 2e0a 0a20 2020 2053  ld value...    S
+000003e0: 6574 7320 6120 6e65 7720 6570 7369 6c6f  ets a new epsilo
+000003f0: 6e20 7468 7265 7368 6f6c 6420 7661 6c75  n threshold valu
+00000400: 6520 616e 6420 7265 7475 726e 7320 7468  e and returns th
+00000410: 6520 7072 6576 696f 7573 6c79 2073 6574  e previously set
+00000420: 0a20 2020 2076 616c 7565 2e20 5477 6f20  .    value. Two 
+00000430: 7661 6c75 6573 2061 7265 2063 6f6e 7369  values are consi
+00000440: 6465 7265 6420 746f 2062 6520 6571 7561  dered to be equa
+00000450: 6c20 6966 2074 6865 6972 2061 6273 6f6c  l if their absol
+00000460: 7574 650a 2020 2020 6469 6666 6572 656e  ute.    differen
+00000470: 6365 2069 7320 6c65 7373 2074 6861 6e20  ce is less than 
+00000480: 6f72 2065 7175 616c 2074 6f20 6570 7369  or equal to epsi
+00000490: 6c6f 6e2e 2222 220a 2020 2020 676c 6f62  lon.""".    glob
+000004a0: 616c 2065 7073 0a20 2020 2072 6573 203d  al eps.    res =
+000004b0: 2065 7073 0a20 2020 2065 7073 203d 2065   eps.    eps = e
+000004c0: 0a20 2020 2072 6574 7572 6e20 7265 730a  .    return res.
+000004d0: 0a23 2067 6574 4570 7369 6c6f 6e0a 6465  .# getEpsilon.de
+000004e0: 6620 6765 7445 7073 696c 6f6e 2829 3a0a  f getEpsilon():.
+000004f0: 2020 2020 2222 2252 6574 7572 6e20 7468      """Return th
+00000500: 6520 6570 7369 6c6f 6e20 7468 7265 7368  e epsilon thresh
+00000510: 6f6c 6420 7768 6963 6820 6973 2075 7365  old which is use
+00000520: 6420 666f 7220 646f 696e 6720 636f 6d70  d for doing comp
+00000530: 6172 6973 6f6e 732e 2222 220a 2020 2020  arisons.""".    
+00000540: 7265 7475 726e 2065 7073 0a0a 0a23 2323  return eps...###
 00000550: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00000560: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00000570: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00000580: 2323 2323 2323 2323 2323 230a 0a0a 2320  ###########...# 
-00000590: 7665 6333 6974 6572 0a63 6465 6620 636c  vec3iter.cdef cl
-000005a0: 6173 7320 7665 6333 6974 6572 3a0a 2020  ass vec3iter:.  
-000005b0: 2020 2222 2276 6563 3320 6974 6572 6174    """vec3 iterat
-000005c0: 6f72 2e22 2222 0a20 2020 2063 6465 6620  or.""".    cdef 
-000005d0: 696e 7420 6964 780a 2020 2020 6364 6566  int idx.    cdef
-000005e0: 206f 626a 6563 7420 760a 0a20 2020 2064   object v..    d
-000005f0: 6566 205f 5f63 696e 6974 5f5f 2873 656c  ef __cinit__(sel
-00000600: 662c 2076 293a 0a20 2020 2020 2020 2073  f, v):.        s
-00000610: 656c 662e 6964 7820 3d20 300a 2020 2020  elf.idx = 0.    
-00000620: 2020 2020 7365 6c66 2e76 2020 203d 2076      self.v   = v
-00000630: 0a0a 2020 2020 6465 6620 5f5f 6974 6572  ..    def __iter
-00000640: 5f5f 2873 656c 6629 3a0a 2020 2020 2020  __(self):.      
-00000650: 2020 7265 7475 726e 2073 656c 660a 0a20    return self.. 
-00000660: 2020 2064 6566 205f 5f6e 6578 745f 5f28     def __next__(
-00000670: 7365 6c66 293a 0a20 2020 2020 2020 2069  self):.        i
-00000680: 6620 7365 6c66 2e69 6478 3d3d 303a 0a20  f self.idx==0:. 
-00000690: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-000006a0: 6964 783d 310a 2020 2020 2020 2020 2020  idx=1.          
-000006b0: 2020 7265 7475 726e 2073 656c 662e 762e    return self.v.
-000006c0: 780a 2020 2020 2020 2020 656c 6966 2073  x.        elif s
-000006d0: 656c 662e 6964 783d 3d31 3a0a 2020 2020  elf.idx==1:.    
-000006e0: 2020 2020 2020 2020 7365 6c66 2e69 6478          self.idx
-000006f0: 3d32 0a20 2020 2020 2020 2020 2020 2072  =2.            r
-00000700: 6574 7572 6e20 7365 6c66 2e76 2e79 0a20  eturn self.v.y. 
-00000710: 2020 2020 2020 2065 6c69 6620 7365 6c66         elif self
-00000720: 2e69 6478 3d3d 323a 0a20 2020 2020 2020  .idx==2:.       
-00000730: 2020 2020 2073 656c 662e 6964 783d 330a       self.idx=3.
-00000740: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00000750: 726e 2073 656c 662e 762e 7a0a 2020 2020  rn self.v.z.    
-00000760: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00000770: 2020 2020 2020 7261 6973 6520 5374 6f70        raise Stop
-00000780: 4974 6572 6174 696f 6e0a 0a0a 2320 7665  Iteration...# ve
-00000790: 6333 0a63 6465 6620 636c 6173 7320 7665  c3.cdef class ve
-000007a0: 6333 3a0a 2020 2020 2222 2254 6872 6565  c3:.    """Three
-000007b0: 2d64 696d 656e 7369 6f6e 616c 2076 6563  -dimensional vec
-000007c0: 746f 722e 0a0a 2020 2020 5468 6973 2063  tor...    This c
-000007d0: 6c61 7373 2063 616e 2062 6520 7573 6564  lass can be used
-000007e0: 2074 6f20 7265 7072 6573 656e 7420 706f   to represent po
-000007f0: 696e 7473 2c20 7665 6374 6f72 732c 206e  ints, vectors, n
-00000800: 6f72 6d61 6c73 0a20 2020 206f 7220 6576  ormals.    or ev
-00000810: 656e 2063 6f6c 6f72 732e 2054 6865 2075  en colors. The u
-00000820: 7375 616c 2076 6563 746f 7220 6f70 6572  sual vector oper
-00000830: 6174 696f 6e73 2061 7265 2061 7661 696c  ations are avail
-00000840: 6162 6c65 2e0a 0a20 2020 2043 6f6d 7061  able...    Compa
-00000850: 7269 736f 6e73 2061 7265 2064 6f6e 6520  risons are done 
-00000860: 7769 7468 696e 2061 6e20 6570 7369 6c6f  within an epsilo
-00000870: 6e20 656e 7669 726f 6e6d 656e 742e 0a20  n environment.. 
-00000880: 2020 2022 2222 0a0a 2020 2020 6364 6566     """..    cdef
-00000890: 2064 6f75 626c 6520 782c 792c 7a0a 0a20   double x,y,z.. 
-000008a0: 2020 2064 6566 205f 5f63 696e 6974 5f5f     def __cinit__
-000008b0: 2873 656c 662c 202a 6172 6773 293a 0a20  (self, *args):. 
-000008c0: 2020 2020 2020 2022 2222 436f 6e73 7472         """Constr
-000008d0: 7563 746f 722e 0a0a 2020 2020 2020 2020  uctor...        
-000008e0: 5468 6572 6520 6172 6520 7365 7665 7261  There are severa
-000008f0: 6c20 706f 7373 6962 696c 6974 6965 7320  l possibilities 
-00000900: 686f 7720 746f 2069 6e69 7469 616c 697a  how to initializ
-00000910: 6520 6120 7665 6374 6f72 3a0a 0a20 2020  e a vector:..   
-00000920: 2020 2020 2076 203d 2076 6563 3328 2920       v = vec3() 
-00000930: 2020 2020 2020 2d3e 2076 203d 203c 302c        -> v = <0,
-00000940: 302c 303e 0a20 2020 2020 2020 2076 203d  0,0>.        v =
-00000950: 2076 6563 3328 6129 2020 2020 2020 2d3e   vec3(a)      ->
-00000960: 2076 203d 203c 612c 612c 613e 0a20 2020   v = <a,a,a>.   
-00000970: 2020 2020 2076 203d 2076 6563 3328 782c       v = vec3(x,
-00000980: 7929 2020 2020 2d3e 2076 203d 203c 782c  y)    -> v = <x,
-00000990: 792c 303e 0a20 2020 2020 2020 2076 203d  y,0>.        v =
-000009a0: 2076 6563 3328 782c 792c 7a29 2020 2d3e   vec3(x,y,z)  ->
-000009b0: 2076 203d 203c 782c 792c 7a3e 0a20 2020   v = <x,y,z>.   
-000009c0: 2020 2020 2077 203d 2076 6563 3328 7629       w = vec3(v)
-000009d0: 2020 2020 2020 2d3e 2077 203d 203c 782c        -> w = <x,
-000009e0: 792c 7a3e 0a0a 2020 2020 2020 2020 4e6f  y,z>..        No
-000009f0: 7465 2074 6861 7420 7370 6563 6966 7969  te that specifyi
-00000a00: 6e67 206a 7573 7420 6f6e 6520 7661 6c75  ng just one valu
-00000a10: 6520 7365 7473 2061 6c6c 2074 6872 6565  e sets all three
-00000a20: 2063 6f6d 706f 6e65 6e74 7320 746f 0a20   components to. 
-00000a30: 2020 2020 2020 2074 6861 7420 7661 6c75         that valu
-00000a40: 6520 2865 7863 6570 7420 7768 656e 2074  e (except when t
-00000a50: 6861 7420 7369 6e67 6c65 2076 616c 7565  hat single value
-00000a60: 2069 7320 6120 616e 6f74 6865 7220 7665   is a another ve
-00000a70: 6333 2c20 7468 656e 0a20 2020 2020 2020  c3, then.       
-00000a80: 2074 6861 7420 7665 6374 6f72 2069 7320   that vector is 
-00000a90: 636f 7069 6564 292e 0a0a 2020 2020 2020  copied)...      
-00000aa0: 2020 4164 6469 7469 6f6e 616c 6c79 2079    Additionally y
-00000ab0: 6f75 2063 616e 2077 7261 7020 7468 6f73  ou can wrap thos
-00000ac0: 6520 7661 6c75 6573 2069 6e20 6120 6c69  e values in a li
-00000ad0: 7374 206f 7220 6120 7475 706c 6520 6f72  st or a tuple or
-00000ae0: 0a20 2020 2020 2020 2073 7065 6369 6679  .        specify
-00000af0: 2074 6865 6d20 6173 2061 2073 7472 696e   them as a strin
-00000b00: 673a 0a0a 2020 2020 2020 2020 7620 3d20  g:..        v = 
-00000b10: 7665 6333 285b 312c 322c 335d 2920 2d3e  vec3([1,2,3]) ->
-00000b20: 2076 203d 203c 312c 322c 333e 0a20 2020   v = <1,2,3>.   
-00000b30: 2020 2020 2076 203d 2076 6563 3328 2234       v = vec3("4
-00000b40: 2c35 2229 2020 202d 3e20 7620 3d20 3c34  ,5")   -> v = <4
-00000b50: 2c35 2c30 3e0a 2020 2020 2020 2020 2222  ,5,0>.        ""
-00000b60: 220a 2020 2020 2020 2020 6364 6566 2069  ".        cdef i
-00000b70: 6e74 2061 7267 6c65 6e2c 2073 6571 6c65  nt arglen, seqle
-00000b80: 6e0a 2020 2020 2020 2020 6364 6566 2076  n.        cdef v
-00000b90: 6563 3320 760a 2020 2020 2020 2020 6172  ec3 v.        ar
-00000ba0: 676c 656e 203d 206c 656e 2861 7267 7329  glen = len(args)
-00000bb0: 0a0a 2020 2020 2020 2020 6966 2061 7267  ..        if arg
-00000bc0: 6c65 6e3d 3d30 3a0a 2020 2020 2020 2020  len==0:.        
-00000bd0: 2020 2020 7365 6c66 2e78 203d 2030 2e30      self.x = 0.0
-00000be0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00000bf0: 662e 7920 3d20 302e 300a 2020 2020 2020  f.y = 0.0.      
-00000c00: 2020 2020 2020 7365 6c66 2e7a 203d 2030        self.z = 0
-00000c10: 2e30 0a20 2020 2020 2020 2065 6c69 6620  .0.        elif 
-00000c20: 6172 676c 656e 3d3d 313a 0a20 2020 2020  arglen==1:.     
-00000c30: 2020 2020 2020 2054 203d 2074 7970 6528         T = type(
-00000c40: 6172 6773 5b30 5d29 0a20 2020 2020 2020  args[0]).       
-00000c50: 2020 2020 2023 2073 6361 6c61 720a 2020       # scalar.  
-00000c60: 2020 2020 2020 2020 2020 6966 2054 2069            if T i
-00000c70: 7320 666c 6f61 7420 6f72 2054 2069 7320  s float or T is 
-00000c80: 696e 7420 6f72 2054 2069 7320 6c6f 6e67  int or T is long
-00000c90: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00000ca0: 2020 7365 6c66 2e78 203d 2061 7267 735b    self.x = args[
-00000cb0: 305d 0a20 2020 2020 2020 2020 2020 2020  0].             
-00000cc0: 2020 2073 656c 662e 7920 3d20 7365 6c66     self.y = self
-00000cd0: 2e78 0a20 2020 2020 2020 2020 2020 2020  .x.             
-00000ce0: 2020 2073 656c 662e 7a20 3d20 7365 6c66     self.z = self
-00000cf0: 2e78 0a20 2020 2020 2020 2020 2020 2023  .x.            #
-00000d00: 2076 6563 330a 2020 2020 2020 2020 2020   vec3.          
-00000d10: 2020 656c 6966 2054 2069 7320 7665 6333    elif T is vec3
-00000d20: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00000d30: 2020 7620 3d20 6172 6773 5b30 5d0a 2020    v = args[0].  
-00000d40: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00000d50: 6c66 2e78 203d 2076 2e78 0a20 2020 2020  lf.x = v.x.     
-00000d60: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00000d70: 7920 3d20 762e 790a 2020 2020 2020 2020  y = v.y.        
-00000d80: 2020 2020 2020 2020 7365 6c66 2e7a 203d          self.z =
-00000d90: 2076 2e7a 0a20 2020 2020 2020 2020 2020   v.z.           
-00000da0: 2023 2053 7472 696e 670a 2020 2020 2020   # String.      
-00000db0: 2020 2020 2020 656c 6966 2054 2069 7320        elif T is 
-00000dc0: 7374 7220 6f72 2054 2069 7320 756e 6963  str or T is unic
-00000dd0: 6f64 653a 0a20 2020 2020 2020 2020 2020  ode:.           
-00000de0: 2020 2020 2073 3d61 7267 735b 305d 2e72       s=args[0].r
-00000df0: 6570 6c61 6365 2822 2c22 2c22 2022 292e  eplace(","," ").
-00000e00: 7265 706c 6163 6528 2220 2022 2c22 2022  replace("  "," "
-00000e10: 292e 7374 7269 7028 292e 7370 6c69 7428  ).strip().split(
-00000e20: 2220 2229 0a20 2020 2020 2020 2020 2020  " ").           
-00000e30: 2020 2020 2069 6620 733d 3d5b 2222 5d3a       if s==[""]:
-00000e40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00000e50: 2020 2020 2073 3d5b 5d0a 2020 2020 2020       s=[].      
-00000e60: 2020 2020 2020 2020 2020 666f 7220 6920            for i 
-00000e70: 696e 2072 616e 6765 286c 656e 2873 2929  in range(len(s))
-00000e80: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00000e90: 2020 2020 2020 7472 793a 0a20 2020 2020        try:.     
-00000ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000eb0: 2020 2073 5b69 5d20 3d20 666c 6f61 7428     s[i] = float(
-00000ec0: 735b 695d 290a 2020 2020 2020 2020 2020  s[i]).          
-00000ed0: 2020 2020 2020 2020 2020 6578 6365 7074            except
-00000ee0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00000ef0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00000f00: 5661 6c75 6545 7272 6f72 2c22 7665 6333  ValueError,"vec3
-00000f10: 2829 2061 7267 2069 7320 6120 6d61 6c66  () arg is a malf
-00000f20: 6f72 6d65 6420 7374 7269 6e67 220a 2020  ormed string".  
-00000f30: 2020 2020 2020 2020 2020 2020 2020 7620                v 
-00000f40: 3d20 7665 6333 2873 290a 2020 2020 2020  = vec3(s).      
-00000f50: 2020 2020 2020 2020 2020 7365 6c66 2e78            self.x
-00000f60: 203d 2076 2e78 0a20 2020 2020 2020 2020   = v.x.         
-00000f70: 2020 2020 2020 2073 656c 662e 7920 3d20         self.y = 
-00000f80: 762e 790a 2020 2020 2020 2020 2020 2020  v.y.            
-00000f90: 2020 2020 7365 6c66 2e7a 203d 2076 2e7a      self.z = v.z
-00000fa0: 0a20 2020 2020 2020 2020 2020 2023 2053  .            # S
-00000fb0: 6571 7565 6e63 6520 6f66 2066 6c6f 6174  equence of float
-00000fc0: 730a 2020 2020 2020 2020 2020 2020 656c  s.            el
-00000fd0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00000fe0: 2020 2020 7365 7120 3d20 6172 6773 5b30      seq = args[0
-00000ff0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-00001000: 2020 7472 793a 0a20 2020 2020 2020 2020    try:.         
-00001010: 2020 2020 2020 2020 2020 2073 6571 6c65             seqle
-00001020: 6e20 3d20 6c65 6e28 7365 7129 0a20 2020  n = len(seq).   
-00001030: 2020 2020 2020 2020 2020 2020 2065 7863               exc
-00001040: 6570 743a 0a20 2020 2020 2020 2020 2020  ept:.           
-00001050: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
-00001060: 7970 6545 7272 6f72 2c22 7665 6333 2829  ypeError,"vec3()
-00001070: 2061 7267 2063 616e 2774 2062 6520 636f   arg can't be co
-00001080: 6e76 6572 7465 6420 746f 2076 6563 3322  nverted to vec3"
-00001090: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000010a0: 2020 6966 2073 6571 6c65 6e3d 3d33 3a0a    if seqlen==3:.
-000010b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000010c0: 2020 2020 7365 6c66 2e78 203d 2073 6571      self.x = seq
-000010d0: 5b30 5d0a 2020 2020 2020 2020 2020 2020  [0].            
-000010e0: 2020 2020 2020 2020 7365 6c66 2e79 203d          self.y =
-000010f0: 2073 6571 5b31 5d0a 2020 2020 2020 2020   seq[1].        
-00001100: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00001110: 2e7a 203d 2073 6571 5b32 5d0a 2020 2020  .z = seq[2].    
-00001120: 2020 2020 2020 2020 2020 2020 656c 6966              elif
-00001130: 2073 6571 6c65 6e3d 3d32 3a0a 2020 2020   seqlen==2:.    
-00001140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001150: 7365 6c66 2e78 203d 2073 6571 5b30 5d0a  self.x = seq[0].
-00001160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001170: 2020 2020 7365 6c66 2e79 203d 2073 6571      self.y = seq
-00001180: 5b31 5d0a 2020 2020 2020 2020 2020 2020  [1].            
-00001190: 2020 2020 2020 2020 7365 6c66 2e7a 203d          self.z =
-000011a0: 2030 2e30 0a20 2020 2020 2020 2020 2020   0.0.           
-000011b0: 2020 2020 2065 6c69 6620 7365 716c 656e       elif seqlen
-000011c0: 3d3d 313a 0a20 2020 2020 2020 2020 2020  ==1:.           
-000011d0: 2020 2020 2020 2020 2073 656c 662e 7820           self.x 
-000011e0: 3d20 7365 715b 305d 0a20 2020 2020 2020  = seq[0].       
-000011f0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00001200: 662e 7920 3d20 7365 6c66 2e78 0a20 2020  f.y = self.x.   
-00001210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001220: 2073 656c 662e 7a20 3d20 7365 6c66 2e78   self.z = self.x
-00001230: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00001240: 2065 6c69 6620 7365 716c 656e 3d3d 303a   elif seqlen==0:
-00001250: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00001260: 2020 2020 2073 656c 662e 7820 3d20 302e       self.x = 0.
-00001270: 300a 2020 2020 2020 2020 2020 2020 2020  0.              
-00001280: 2020 2020 2020 7365 6c66 2e79 203d 2030        self.y = 0
-00001290: 2e30 0a20 2020 2020 2020 2020 2020 2020  .0.             
-000012a0: 2020 2020 2020 2073 656c 662e 7a20 3d20         self.z = 
-000012b0: 302e 300a 2020 2020 2020 2020 2020 2020  0.0.            
-000012c0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-000012d0: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-000012e0: 6973 6520 5479 7065 4572 726f 722c 2022  ise TypeError, "
-000012f0: 7665 6333 2829 2074 616b 6573 2061 7420  vec3() takes at 
-00001300: 6d6f 7374 2033 2061 7267 756d 656e 7473  most 3 arguments
-00001310: 220a 0a20 2020 2020 2020 2065 6c69 6620  "..        elif 
-00001320: 6172 676c 656e 3d3d 323a 0a20 2020 2020  arglen==2:.     
-00001330: 2020 2020 2020 2073 656c 662e 7820 3d20         self.x = 
-00001340: 6172 6773 5b30 5d0a 2020 2020 2020 2020  args[0].        
-00001350: 2020 2020 7365 6c66 2e79 203d 2061 7267      self.y = arg
-00001360: 735b 315d 0a20 2020 2020 2020 2020 2020  s[1].           
-00001370: 2073 656c 662e 7a20 3d20 302e 300a 0a20   self.z = 0.0.. 
-00001380: 2020 2020 2020 2065 6c69 6620 6172 676c         elif argl
-00001390: 656e 3d3d 333a 0a20 2020 2020 2020 2020  en==3:.         
-000013a0: 2020 2073 656c 662e 7820 3d20 6172 6773     self.x = args
-000013b0: 5b30 5d0a 2020 2020 2020 2020 2020 2020  [0].            
-000013c0: 7365 6c66 2e79 203d 2061 7267 735b 315d  self.y = args[1]
-000013d0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-000013e0: 662e 7a20 3d20 6172 6773 5b32 5d0a 0a20  f.z = args[2].. 
-000013f0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00001400: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
-00001410: 7970 6545 7272 6f72 2c20 2276 6563 3328  ypeError, "vec3(
-00001420: 2920 7461 6b65 7320 6174 206d 6f73 7420  ) takes at most 
-00001430: 3320 6172 6775 6d65 6e74 7322 0a0a 2020  3 arguments"..  
-00001440: 2020 6465 6620 5f5f 7265 6475 6365 5f5f    def __reduce__
-00001450: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00001460: 7265 7475 726e 2028 5f76 6563 3363 6f6e  return (_vec3con
-00001470: 7374 7275 6374 2c20 2873 656c 662e 782c  struct, (self.x,
-00001480: 2073 656c 662e 792c 2073 656c 662e 7a29   self.y, self.z)
-00001490: 290a 0a20 2020 2064 6566 205f 5f72 6570  )..    def __rep
-000014a0: 725f 5f28 7365 6c66 293a 0a20 2020 2020  r__(self):.     
-000014b0: 2020 2072 6574 7572 6e20 2776 6563 3328     return 'vec3(
-000014c0: 2573 2c20 2573 2c20 2573 2927 2528 7265  %s, %s, %s)'%(re
-000014d0: 7072 2873 656c 662e 7829 2c72 6570 7228  pr(self.x),repr(
-000014e0: 7365 6c66 2e79 292c 7265 7072 2873 656c  self.y),repr(sel
-000014f0: 662e 7a29 290a 0a20 2020 2064 6566 205f  f.z))..    def _
-00001500: 5f73 7472 5f5f 2873 656c 6629 3a0a 2020  _str__(self):.  
-00001510: 2020 2020 2020 7265 7475 726e 2022 2825        return "(%
-00001520: 312e 3466 2c20 2531 2e34 662c 2025 312e  1.4f, %1.4f, %1.
-00001530: 3466 2922 2528 7365 6c66 2e78 2c20 7365  4f)"%(self.x, se
-00001540: 6c66 2e79 2c20 7365 6c66 2e7a 290a 0a20  lf.y, self.z).. 
-00001550: 2020 2064 6566 205f 5f69 7465 725f 5f28     def __iter__(
-00001560: 7365 6c66 293a 0a20 2020 2020 2020 2072  self):.        r
-00001570: 6574 7572 6e20 7665 6333 6974 6572 2873  eturn vec3iter(s
-00001580: 656c 6629 0a0a 2020 2020 6465 6620 5f5f  elf)..    def __
-00001590: 7269 6368 636d 705f 5f28 612c 622c 6f70  richcmp__(a,b,op
-000015a0: 293a 0a20 2020 2020 2020 2063 6465 6620  ):.        cdef 
-000015b0: 7665 6333 2076 612c 2076 620a 2020 2020  vec3 va, vb.    
-000015c0: 2020 2020 6364 6566 2069 6e74 2063 6f70      cdef int cop
-000015d0: 0a0a 2020 2020 2020 2020 636f 7020 3d20  ..        cop = 
-000015e0: 6f70 0a0a 2020 2020 2020 2020 7461 203d  op..        ta =
-000015f0: 2074 7970 6528 6129 0a20 2020 2020 2020   type(a).       
-00001600: 2074 6220 3d20 7479 7065 2862 290a 2020   tb = type(b).  
-00001610: 2020 2020 2020 6966 2028 7461 213d 7665        if (ta!=ve
-00001620: 6333 206f 7220 7462 213d 7665 6333 293a  c3 or tb!=vec3):
-00001630: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00001640: 636f 703d 3d33 3a0a 2020 2020 2020 2020  cop==3:.        
-00001650: 2020 2020 2020 2020 7265 7475 726e 2031          return 1
-00001660: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
-00001670: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00001680: 2020 2072 6574 7572 6e20 300a 0a20 2020     return 0..   
-00001690: 2020 2020 2076 6120 3d20 610a 2020 2020       va = a.    
-000016a0: 2020 2020 7662 203d 2062 0a0a 2020 2020      vb = b..    
-000016b0: 2020 2020 2320 3c0a 2020 2020 2020 2020      # <.        
-000016c0: 6966 2063 6f70 3d3d 303a 0a20 2020 2020  if cop==0:.     
-000016d0: 2020 2020 2020 2072 6574 7572 6e20 2876         return (v
-000016e0: 612e 783c 7662 2e78 2061 6e64 2076 612e  a.x<vb.x and va.
-000016f0: 793c 7662 2e79 2061 6e64 2076 612e 7a3c  y<vb.y and va.z<
-00001700: 7662 2e7a 290a 2020 2020 2020 2020 2320  vb.z).        # 
-00001710: 3c3d 0a20 2020 2020 2020 2065 6c69 6620  <=.        elif 
-00001720: 636f 703d 3d31 3a0a 2020 2020 2020 2020  cop==1:.        
-00001730: 2020 2020 7265 7475 726e 2028 7661 2e78      return (va.x
-00001740: 2d65 7073 3c3d 7662 2e78 2061 6e64 2076  -eps<=vb.x and v
-00001750: 612e 792d 6570 733c 3d76 622e 7920 616e  a.y-eps<=vb.y an
-00001760: 6420 7661 2e7a 2d65 7073 3c3d 7662 2e7a  d va.z-eps<=vb.z
-00001770: 290a 2020 2020 2020 2020 2320 3d3d 0a20  ).        # ==. 
-00001780: 2020 2020 2020 2065 6c69 6620 636f 703d         elif cop=
-00001790: 3d32 3a0a 2320 2020 2020 2020 2020 2020  =2:.#           
-000017a0: 2072 6574 7572 6e20 2876 612e 783d 3d76   return (va.x==v
-000017b0: 622e 7820 616e 6420 7661 2e79 3d3d 7662  b.x and va.y==vb
-000017c0: 2e79 2061 6e64 2076 612e 7a3d 3d76 622e  .y and va.z==vb.
-000017d0: 7a29 0a20 2020 2020 2020 2020 2020 2072  z).            r
-000017e0: 6574 7572 6e20 2866 6162 7328 7661 2e78  eturn (fabs(va.x
-000017f0: 2d76 622e 7829 3c3d 6570 7320 616e 6420  -vb.x)<=eps and 
-00001800: 6661 6273 2876 612e 792d 7662 2e79 293c  fabs(va.y-vb.y)<
-00001810: 3d65 7073 2061 6e64 2066 6162 7328 7661  =eps and fabs(va
-00001820: 2e7a 2d76 622e 7a29 3c3d 6570 7329 0a20  .z-vb.z)<=eps). 
-00001830: 2020 2020 2020 2023 2021 3d0a 2020 2020         # !=.    
-00001840: 2020 2020 656c 6966 2063 6f70 3d3d 333a      elif cop==3:
-00001850: 0a23 2020 2020 2020 2020 2020 2020 7265  .#            re
-00001860: 7475 726e 2028 7661 2e78 213d 7662 2e78  turn (va.x!=vb.x
-00001870: 206f 7220 7661 2e79 213d 7662 2e79 206f   or va.y!=vb.y o
-00001880: 7220 7661 2e7a 213d 7662 2e7a 290a 2020  r va.z!=vb.z).  
-00001890: 2020 2020 2020 2020 2020 7265 7475 726e            return
-000018a0: 2028 6661 6273 2876 612e 782d 7662 2e78   (fabs(va.x-vb.x
-000018b0: 293e 6570 7320 6f72 2066 6162 7328 7661  )>eps or fabs(va
-000018c0: 2e79 2d76 622e 7929 3e65 7073 2061 6e64  .y-vb.y)>eps and
-000018d0: 2066 6162 7328 7661 2e7a 2d76 622e 7a29   fabs(va.z-vb.z)
-000018e0: 3e65 7073 290a 2020 2020 2020 2020 2320  >eps).        # 
-000018f0: 3e0a 2020 2020 2020 2020 656c 6966 2063  >.        elif c
-00001900: 6f70 3d3d 343a 0a20 2020 2020 2020 2020  op==4:.         
-00001910: 2020 2072 6574 7572 6e20 2876 612e 783e     return (va.x>
-00001920: 7662 2e78 2061 6e64 2076 612e 793e 7662  vb.x and va.y>vb
-00001930: 2e79 2061 6e64 2076 612e 7a3e 7662 2e7a  .y and va.z>vb.z
-00001940: 290a 2020 2020 2020 2020 2320 3e3d 0a20  ).        # >=. 
-00001950: 2020 2020 2020 2065 6c69 6620 636f 703d         elif cop=
-00001960: 3d35 3a0a 2020 2020 2020 2020 2020 2020  =5:.            
-00001970: 7265 7475 726e 2028 7661 2e78 2b65 7073  return (va.x+eps
-00001980: 3e3d 7662 2e78 2061 6e64 2076 612e 792b  >=vb.x and va.y+
-00001990: 6570 733e 3d76 622e 7920 616e 6420 7661  eps>=vb.y and va
-000019a0: 2e7a 2b65 7073 3e3d 7662 2e7a 290a 2020  .z+eps>=vb.z).  
-000019b0: 2020 2020 2020 2320 736f 6e73 7420 2846        # sonst (F
-000019c0: 6568 6c65 7229 0a20 2020 2020 2020 2065  ehler).        e
-000019d0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-000019e0: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-000019f0: 722c 2269 6e74 6572 6e61 6c20 6572 726f  r,"internal erro
-00001a00: 723a 2069 6c6c 6567 616c 2072 6963 6820  r: illegal rich 
-00001a10: 636f 6d70 6172 6973 6f6e 206e 756d 6265  comparison numbe
-00001a20: 7222 0a0a 0a20 2020 2064 6566 205f 5f61  r"...    def __a
-00001a30: 6464 5f5f 2876 6563 3320 612c 2076 6563  dd__(vec3 a, vec
-00001a40: 3320 6229 3a0a 2020 2020 2020 2020 2222  3 b):.        ""
-00001a50: 2256 6563 746f 7220 6164 6469 7469 6f6e  "Vector addition
-00001a60: 2e0a 0a20 2020 2020 2020 203e 3e3e 2061  ...        >>> a
-00001a70: 3d76 6563 3328 312e 302c 2030 2e35 2c20  =vec3(1.0, 0.5, 
-00001a80: 2d31 2e38 290a 2020 2020 2020 2020 3e3e  -1.8).        >>
-00001a90: 3e20 623d 7665 6333 282d 302e 332c 2030  > b=vec3(-0.3, 0
-00001aa0: 2e37 352c 2030 2e35 290a 2020 2020 2020  .75, 0.5).      
-00001ab0: 2020 3e3e 3e20 7072 696e 7420 612b 620a    >>> print a+b.
-00001ac0: 2020 2020 2020 2020 2830 2e37 3030 302c          (0.7000,
-00001ad0: 2031 2e32 3530 302c 202d 312e 3330 3030   1.2500, -1.3000
-00001ae0: 290a 2020 2020 2020 2020 2222 220a 2020  ).        """.  
-00001af0: 2020 2020 2020 6364 6566 2076 6563 3320        cdef vec3 
-00001b00: 7265 730a 2020 2020 2020 2020 7265 7320  res.        res 
-00001b10: 3d20 7665 6333 2829 0a20 2020 2020 2020  = vec3().       
-00001b20: 2072 6573 2e78 203d 2061 2e78 2b62 2e78   res.x = a.x+b.x
-00001b30: 0a20 2020 2020 2020 2072 6573 2e79 203d  .        res.y =
-00001b40: 2061 2e79 2b62 2e79 0a20 2020 2020 2020   a.y+b.y.       
-00001b50: 2072 6573 2e7a 203d 2061 2e7a 2b62 2e7a   res.z = a.z+b.z
-00001b60: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00001b70: 7265 730a 0a20 2020 2064 6566 205f 5f73  res..    def __s
-00001b80: 7562 5f5f 2876 6563 3320 612c 2076 6563  ub__(vec3 a, vec
-00001b90: 3320 6229 3a0a 2020 2020 2020 2020 2222  3 b):.        ""
-00001ba0: 2256 6563 746f 7220 7375 6274 7261 6374  "Vector subtract
-00001bb0: 696f 6e2e 0a0a 2020 2020 2020 2020 3e3e  ion...        >>
-00001bc0: 3e20 613d 7665 6333 2831 2e30 2c20 302e  > a=vec3(1.0, 0.
-00001bd0: 352c 202d 312e 3829 0a20 2020 2020 2020  5, -1.8).       
-00001be0: 203e 3e3e 2062 3d76 6563 3328 2d30 2e33   >>> b=vec3(-0.3
-00001bf0: 2c20 302e 3735 2c20 302e 3529 0a20 2020  , 0.75, 0.5).   
-00001c00: 2020 2020 203e 3e3e 2070 7269 6e74 2061       >>> print a
-00001c10: 2d62 0a20 2020 2020 2020 2028 312e 3330  -b.        (1.30
-00001c20: 3030 2c20 2d30 2e32 3530 302c 202d 322e  00, -0.2500, -2.
-00001c30: 3330 3030 290a 2020 2020 2020 2020 2222  3000).        ""
-00001c40: 220a 2020 2020 2020 2020 6364 6566 2076  ".        cdef v
-00001c50: 6563 3320 7265 730a 2020 2020 2020 2020  ec3 res.        
-00001c60: 7265 7320 3d20 7665 6333 2829 0a20 2020  res = vec3().   
-00001c70: 2020 2020 2072 6573 2e78 203d 2061 2e78       res.x = a.x
-00001c80: 2d62 2e78 0a20 2020 2020 2020 2072 6573  -b.x.        res
-00001c90: 2e79 203d 2061 2e79 2d62 2e79 0a20 2020  .y = a.y-b.y.   
-00001ca0: 2020 2020 2072 6573 2e7a 203d 2061 2e7a       res.z = a.z
-00001cb0: 2d62 2e7a 0a20 2020 2020 2020 2072 6574  -b.z.        ret
-00001cc0: 7572 6e20 7265 730a 0a20 2020 2064 6566  urn res..    def
-00001cd0: 205f 5f6d 756c 5f5f 2861 2c20 6229 3a0a   __mul__(a, b):.
-00001ce0: 2020 2020 2020 2020 2222 224d 756c 7469          """Multi
-00001cf0: 706c 6963 6174 696f 6e20 7769 7468 2061  plication with a
-00001d00: 2073 6361 6c61 7220 6f72 2064 6f74 2070   scalar or dot p
-00001d10: 726f 6475 6374 2e0a 0a20 2020 2020 2020  roduct...       
-00001d20: 203e 3e3e 2061 3d76 6563 3328 312e 302c   >>> a=vec3(1.0,
-00001d30: 2030 2e35 2c20 2d31 2e38 290a 2020 2020   0.5, -1.8).    
-00001d40: 2020 2020 3e3e 3e20 623d 7665 6333 282d      >>> b=vec3(-
-00001d50: 302e 332c 2030 2e37 352c 2030 2e35 290a  0.3, 0.75, 0.5).
-00001d60: 2020 2020 2020 2020 3e3e 3e20 7072 696e          >>> prin
-00001d70: 7420 612a 322e 300a 2020 2020 2020 2020  t a*2.0.        
-00001d80: 2832 2e30 3030 302c 2031 2e30 3030 302c  (2.0000, 1.0000,
-00001d90: 202d 332e 3630 3030 290a 2020 2020 2020   -3.6000).      
-00001da0: 2020 3e3e 3e20 7072 696e 7420 322e 302a    >>> print 2.0*
-00001db0: 610a 2020 2020 2020 2020 2832 2e30 3030  a.        (2.000
-00001dc0: 302c 2031 2e30 3030 302c 202d 332e 3630  0, 1.0000, -3.60
-00001dd0: 3030 290a 2020 2020 2020 2020 3e3e 3e20  00).        >>> 
-00001de0: 7072 696e 7420 612a 620a 2020 2020 2020  print a*b.      
-00001df0: 2020 2d30 2e38 3235 0a20 2020 2020 2020    -0.825.       
-00001e00: 2022 2222 0a20 2020 2020 2020 2063 6465   """.        cde
-00001e10: 6620 7665 6333 2072 6573 2c20 7661 2c20  f vec3 res, va, 
-00001e20: 7662 0a20 2020 2020 2020 2063 6465 6620  vb.        cdef 
-00001e30: 646f 7562 6c65 2072 0a0a 2020 2020 2020  double r..      
-00001e40: 2020 7461 203d 2074 7970 6528 6129 0a20    ta = type(a). 
-00001e50: 2020 2020 2020 2074 6220 3d20 7479 7065         tb = type
-00001e60: 2862 290a 0a20 2020 2020 2020 2069 6620  (b)..        if 
-00001e70: 7461 2069 7320 7665 6333 3a0a 2020 2020  ta is vec3:.    
-00001e80: 2020 2020 2020 2020 7661 203d 2061 0a20          va = a. 
-00001e90: 2020 2020 2020 2020 2020 2069 6620 7462             if tb
-00001ea0: 2069 7320 7665 6333 3a0a 2020 2020 2020   is vec3:.      
-00001eb0: 2020 2020 2020 2020 2020 2320 7665 6333            # vec3
-00001ec0: 2a76 6563 3320 2020 2864 6f74 2070 726f  *vec3   (dot pro
-00001ed0: 6475 6374 2061 2a62 290a 2020 2020 2020  duct a*b).      
-00001ee0: 2020 2020 2020 2020 2020 7662 203d 2062            vb = b
-00001ef0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00001f00: 2072 6574 7572 6e20 7661 2e78 2a76 622e   return va.x*vb.
-00001f10: 7820 2b20 7661 2e79 2a76 622e 7920 2b20  x + va.y*vb.y + 
-00001f20: 7661 2e7a 2a76 622e 7a0a 2020 2020 2020  va.z*vb.z.      
-00001f30: 2020 2020 2020 656c 6966 2074 6220 6973        elif tb is
-00001f40: 2066 6c6f 6174 206f 7220 7462 2069 7320   float or tb is 
-00001f50: 696e 7420 6f72 2074 6220 6973 206c 6f6e  int or tb is lon
-00001f60: 673a 0a20 2020 2020 2020 2020 2020 2020  g:.             
-00001f70: 2020 2023 2076 6563 332a 7363 616c 6172     # vec3*scalar
-00001f80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00001f90: 2072 6573 203d 2076 6563 3328 290a 2020   res = vec3().  
-00001fa0: 2020 2020 2020 2020 2020 2020 2020 7220                r 
-00001fb0: 2020 3d20 620a 2020 2020 2020 2020 2020    = b.          
-00001fc0: 2020 2020 2020 7265 732e 7820 3d20 7661        res.x = va
-00001fd0: 2e78 2a72 0a20 2020 2020 2020 2020 2020  .x*r.           
-00001fe0: 2020 2020 2072 6573 2e79 203d 2076 612e       res.y = va.
-00001ff0: 792a 720a 2020 2020 2020 2020 2020 2020  y*r.            
-00002000: 2020 2020 7265 732e 7a20 3d20 7661 2e7a      res.z = va.z
-00002010: 2a72 0a20 2020 2020 2020 2020 2020 2020  *r.             
-00002020: 2020 2072 6574 7572 6e20 7265 730a 2020     return res.  
-00002030: 2020 2020 2020 2020 2020 656c 6966 2074            elif t
-00002040: 6220 6973 206d 6174 333a 0a20 2020 2020  b is mat3:.     
-00002050: 2020 2020 2020 2020 2020 2023 2076 6563             # vec
-00002060: 332a 6d61 7433 0a20 2020 2020 2020 2020  3*mat3.         
-00002070: 2020 2020 2020 2072 6574 7572 6e20 622e         return b.
-00002080: 5f5f 726d 756c 5f5f 2861 290a 2020 2020  __rmul__(a).    
-00002090: 2020 2020 2020 2020 656c 6966 2074 6220          elif tb 
-000020a0: 6973 206d 6174 343a 0a20 2020 2020 2020  is mat4:.       
-000020b0: 2020 2020 2020 2020 2023 2076 6563 332a           # vec3*
-000020c0: 6d61 7434 0a20 2020 2020 2020 2020 2020  mat4.           
-000020d0: 2020 2020 2072 6574 7572 6e20 622e 5f5f       return b.__
-000020e0: 726d 756c 5f5f 2861 290a 0a20 2020 2020  rmul__(a)..     
-000020f0: 2020 2065 6c69 6620 7461 2069 7320 666c     elif ta is fl
-00002100: 6f61 7420 6f72 2074 6120 6973 2069 6e74  oat or ta is int
-00002110: 206f 7220 7461 2069 7320 6c6f 6e67 3a0a   or ta is long:.
-00002120: 2020 2020 2020 2020 2020 2020 6966 2074              if t
-00002130: 6220 6973 2076 6563 333a 0a20 2020 2020  b is vec3:.     
-00002140: 2020 2020 2020 2020 2020 2023 2073 6361             # sca
-00002150: 6c61 722a 7665 6333 0a20 2020 2020 2020  lar*vec3.       
-00002160: 2020 2020 2020 2020 2072 6573 203d 2076           res = v
-00002170: 6563 3328 290a 2020 2020 2020 2020 2020  ec3().          
-00002180: 2020 2020 2020 7662 2020 3d20 620a 2020        vb  = b.  
-00002190: 2020 2020 2020 2020 2020 2020 2020 7220                r 
-000021a0: 2020 3d20 610a 2020 2020 2020 2020 2020    = a.          
-000021b0: 2020 2020 2020 7265 732e 7820 3d20 722a        res.x = r*
-000021c0: 7662 2e78 0a20 2020 2020 2020 2020 2020  vb.x.           
-000021d0: 2020 2020 2072 6573 2e79 203d 2072 2a76       res.y = r*v
-000021e0: 622e 790a 2020 2020 2020 2020 2020 2020  b.y.            
-000021f0: 2020 2020 7265 732e 7a20 3d20 722a 7662      res.z = r*vb
-00002200: 2e7a 0a20 2020 2020 2020 2020 2020 2020  .z.             
-00002210: 2020 2072 6574 7572 6e20 7265 730a 0a20     return res.. 
-00002220: 2020 2020 2020 2072 6169 7365 2054 7970         raise Typ
-00002230: 6545 7272 6f72 2c20 2275 6e73 7570 706f  eError, "unsuppo
-00002240: 7274 6564 206f 7065 7261 6e64 2074 7970  rted operand typ
-00002250: 6520 666f 7220 2a22 0a0a 2020 2020 6465  e for *"..    de
-00002260: 6620 5f5f 6469 765f 5f28 7665 6333 2061  f __div__(vec3 a
-00002270: 2c20 6229 3a0a 2020 2020 2020 2020 2320  , b):.        # 
-00002280: 5079 7468 6f6e 2032 0a20 2020 2020 2020  Python 2.       
-00002290: 2072 6574 7572 6e20 7665 6333 2e5f 5f74   return vec3.__t
-000022a0: 7275 6564 6976 5f5f 2861 2c62 290a 0a20  ruediv__(a,b).. 
-000022b0: 2020 2064 6566 205f 5f74 7275 6564 6976     def __truediv
-000022c0: 5f5f 2876 6563 3320 612c 2062 293a 0a20  __(vec3 a, b):. 
-000022d0: 2020 2020 2020 2022 2222 4469 7669 7369         """Divisi
-000022e0: 6f6e 2062 7920 7363 616c 6172 0a0a 2020  on by scalar..  
-000022f0: 2020 2020 2020 3e3e 3e20 613d 7665 6333        >>> a=vec3
-00002300: 2831 2e30 2c20 302e 352c 202d 312e 3829  (1.0, 0.5, -1.8)
-00002310: 0a20 2020 2020 2020 203e 3e3e 2070 7269  .        >>> pri
-00002320: 6e74 2061 2f32 2e30 0a20 2020 2020 2020  nt a/2.0.       
-00002330: 2028 302e 3530 3030 2c20 302e 3235 3030   (0.5000, 0.2500
-00002340: 2c20 2d30 2e39 3030 3029 0a20 2020 2020  , -0.9000).     
-00002350: 2020 2022 2222 0a20 2020 2020 2020 2063     """.        c
-00002360: 6465 6620 7665 6333 2072 6573 0a20 2020  def vec3 res.   
-00002370: 2020 2020 2063 6465 6620 646f 7562 6c65       cdef double
-00002380: 2072 0a0a 2020 2020 2020 2020 7462 203d   r..        tb =
-00002390: 2074 7970 6528 6229 0a0a 2020 2020 2020   type(b)..      
-000023a0: 2020 6966 2074 6220 6973 2066 6c6f 6174    if tb is float
-000023b0: 206f 7220 7462 2069 7320 696e 7420 6f72   or tb is int or
-000023c0: 2074 6220 6973 206c 6f6e 673a 0a20 2020   tb is long:.   
-000023d0: 2020 2020 2020 2020 2023 2076 6563 332f           # vec3/
-000023e0: 7363 616c 6172 0a20 2020 2020 2020 2020  scalar.         
-000023f0: 2020 2072 6573 203d 2076 6563 3328 290a     res = vec3().
-00002400: 2020 2020 2020 2020 2020 2020 7220 3d20              r = 
-00002410: 620a 2020 2020 2020 2020 2020 2020 6966  b.            if
-00002420: 2066 6162 7328 7229 3c3d 6570 733a 0a20   fabs(r)<=eps:. 
-00002430: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00002440: 6169 7365 205a 6572 6f44 6976 6973 696f  aise ZeroDivisio
-00002450: 6e45 7272 6f72 2c22 7665 6333 2064 6976  nError,"vec3 div
-00002460: 6973 696f 6e22 0a20 2020 2020 2020 2020  ision".         
-00002470: 2020 2072 6573 2e78 203d 2061 2e78 2f72     res.x = a.x/r
-00002480: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
-00002490: 2e79 203d 2061 2e79 2f72 0a20 2020 2020  .y = a.y/r.     
-000024a0: 2020 2020 2020 2072 6573 2e7a 203d 2061         res.z = a
-000024b0: 2e7a 2f72 0a20 2020 2020 2020 2020 2020  .z/r.           
-000024c0: 2072 6574 7572 6e20 7265 730a 2020 2020   return res.    
-000024d0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-000024e0: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
-000024f0: 4572 726f 722c 2022 756e 7375 7070 6f72  Error, "unsuppor
-00002500: 7465 6420 6f70 6572 616e 6420 7479 7065  ted operand type
-00002510: 2066 6f72 202f 220a 0a20 2020 2064 6566   for /"..    def
-00002520: 205f 5f6d 6f64 5f5f 2876 6563 3320 7365   __mod__(vec3 se
-00002530: 6c66 2c20 6229 3a0a 2020 2020 2020 2020  lf, b):.        
-00002540: 2222 224d 6f64 756c 6f20 2863 6f6d 706f  """Modulo (compo
-00002550: 6e65 6e74 2077 6973 6529 2e0a 0a20 2020  nent wise)...   
-00002560: 2020 2020 203e 3e3e 2061 3d76 6563 3328       >>> a=vec3(
-00002570: 332e 302c 2032 2e35 2c20 2d31 2e38 290a  3.0, 2.5, -1.8).
-00002580: 2020 2020 2020 2020 3e3e 3e20 7072 696e          >>> prin
-00002590: 7420 6125 322e 300a 2020 2020 2020 2020  t a%2.0.        
-000025a0: 2831 2e30 3030 302c 2030 2e35 3030 302c  (1.0000, 0.5000,
-000025b0: 2030 2e32 3030 3029 0a20 2020 2020 2020   0.2000).       
-000025c0: 2022 2222 0a20 2020 2020 2020 2063 6465   """.        cde
-000025d0: 6620 7665 6333 2072 6573 2c20 7662 0a20  f vec3 res, vb. 
-000025e0: 2020 2020 2020 2063 6465 6620 646f 7562         cdef doub
-000025f0: 6c65 2072 0a0a 2020 2020 2020 2020 7462  le r..        tb
-00002600: 203d 2074 7970 6528 6229 0a0a 2020 2020   = type(b)..    
-00002610: 2020 2020 6966 2074 6220 6973 2066 6c6f      if tb is flo
-00002620: 6174 206f 7220 7462 2069 7320 696e 7420  at or tb is int 
-00002630: 6f72 2074 6220 6973 206c 6f6e 673a 0a20  or tb is long:. 
-00002640: 2020 2020 2020 2020 2020 2023 2076 6563             # vec
-00002650: 3325 7363 616c 6172 0a20 2020 2020 2020  3%scalar.       
-00002660: 2020 2020 2072 6573 203d 2076 6563 3328       res = vec3(
-00002670: 290a 2020 2020 2020 2020 2020 2020 7220  ).            r 
-00002680: 3d20 620a 2020 2020 2020 2020 2020 2020  = b.            
-00002690: 6966 2066 6162 7328 7229 3c3d 6570 733a  if fabs(r)<=eps:
-000026a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000026b0: 2072 6169 7365 205a 6572 6f44 6976 6973   raise ZeroDivis
-000026c0: 696f 6e45 7272 6f72 2c22 7665 6333 206d  ionError,"vec3 m
-000026d0: 6f64 756c 6f22 0a20 2020 2020 2020 2020  odulo".         
-000026e0: 2020 2072 6573 2e78 203d 205f 666d 6f64     res.x = _fmod
-000026f0: 2873 656c 662e 782c 7229 0a20 2020 2020  (self.x,r).     
-00002700: 2020 2020 2020 2072 6573 2e79 203d 205f         res.y = _
-00002710: 666d 6f64 2873 656c 662e 792c 7229 0a20  fmod(self.y,r). 
-00002720: 2020 2020 2020 2020 2020 2072 6573 2e7a             res.z
-00002730: 203d 205f 666d 6f64 2873 656c 662e 7a2c   = _fmod(self.z,
-00002740: 7229 0a20 2020 2020 2020 2020 2020 2072  r).            r
-00002750: 6574 7572 6e20 7265 730a 2020 2020 2020  eturn res.      
-00002760: 2020 656c 6966 2074 6220 6973 2076 6563    elif tb is vec
-00002770: 333a 0a20 2020 2020 2020 2020 2020 2023  3:.            #
-00002780: 2076 6563 3325 7665 6333 0a20 2020 2020   vec3%vec3.     
-00002790: 2020 2020 2020 2072 6573 203d 2076 6563         res = vec
-000027a0: 3328 290a 2020 2020 2020 2020 2020 2020  3().            
-000027b0: 7662 203d 2062 0a20 2020 2020 2020 2020  vb = b.         
-000027c0: 2020 2069 6620 6661 6273 2876 622e 7829     if fabs(vb.x)
-000027d0: 3c3d 6570 7320 6f72 2066 6162 7328 7662  <=eps or fabs(vb
-000027e0: 2e79 293c 3d65 7073 206f 7220 6661 6273  .y)<=eps or fabs
-000027f0: 2876 622e 7a29 3c3d 6570 733a 0a20 2020  (vb.z)<=eps:.   
-00002800: 2020 2020 2020 2020 2020 2020 2072 6169               rai
-00002810: 7365 205a 6572 6f44 6976 6973 696f 6e45  se ZeroDivisionE
-00002820: 7272 6f72 2c22 7665 6333 206d 6f64 756c  rror,"vec3 modul
-00002830: 6f22 0a20 2020 2020 2020 2020 2020 2072  o".            r
-00002840: 6573 2e78 203d 205f 666d 6f64 2873 656c  es.x = _fmod(sel
-00002850: 662e 782c 2076 622e 7829 0a20 2020 2020  f.x, vb.x).     
-00002860: 2020 2020 2020 2072 6573 2e79 203d 205f         res.y = _
-00002870: 666d 6f64 2873 656c 662e 792c 2076 622e  fmod(self.y, vb.
-00002880: 7929 0a20 2020 2020 2020 2020 2020 2072  y).            r
-00002890: 6573 2e7a 203d 205f 666d 6f64 2873 656c  es.z = _fmod(sel
-000028a0: 662e 7a2c 2076 622e 7a29 0a20 2020 2020  f.z, vb.z).     
-000028b0: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
-000028c0: 730a 2020 2020 2020 2020 656c 7365 3a0a  s.        else:.
-000028d0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-000028e0: 6520 5479 7065 4572 726f 722c 2022 756e  e TypeError, "un
-000028f0: 7375 7070 6f72 7465 6420 6f70 6572 616e  supported operan
-00002900: 6420 7479 7065 2066 6f72 2025 220a 0a20  d type for %".. 
-00002910: 2020 2064 6566 205f 5f6e 6567 5f5f 2873     def __neg__(s
-00002920: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
-00002930: 224e 6567 6174 696f 6e0a 0a20 2020 2020  "Negation..     
-00002940: 2020 203e 3e3e 2061 3d76 6563 3328 332e     >>> a=vec3(3.
-00002950: 302c 2032 2e35 2c20 2d31 2e38 290a 2020  0, 2.5, -1.8).  
-00002960: 2020 2020 2020 3e3e 3e20 7072 696e 7420        >>> print 
-00002970: 2d61 0a20 2020 2020 2020 2028 2d33 2e30  -a.        (-3.0
-00002980: 3030 302c 202d 322e 3530 3030 2c20 312e  000, -2.5000, 1.
-00002990: 3830 3030 290a 2020 2020 2020 2020 2222  8000).        ""
-000029a0: 220a 2020 2020 2020 2020 6364 6566 2076  ".        cdef v
-000029b0: 6563 3320 7265 730a 2020 2020 2020 2020  ec3 res.        
-000029c0: 7265 7320 3d20 7665 6333 2829 0a20 2020  res = vec3().   
-000029d0: 2020 2020 2072 6573 2e78 203d 202d 7365       res.x = -se
-000029e0: 6c66 2e78 0a20 2020 2020 2020 2072 6573  lf.x.        res
-000029f0: 2e79 203d 202d 7365 6c66 2e79 0a20 2020  .y = -self.y.   
-00002a00: 2020 2020 2072 6573 2e7a 203d 202d 7365       res.z = -se
-00002a10: 6c66 2e7a 0a20 2020 2020 2020 2072 6574  lf.z.        ret
-00002a20: 7572 6e20 7265 730a 0a20 2020 2064 6566  urn res..    def
-00002a30: 205f 5f70 6f73 5f5f 2873 656c 6629 3a0a   __pos__(self):.
-00002a40: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00002a50: 2020 2020 3e3e 3e20 613d 7665 6333 2833      >>> a=vec3(3
-00002a60: 2e30 2c20 322e 352c 202d 312e 3829 0a20  .0, 2.5, -1.8). 
-00002a70: 2020 2020 2020 203e 3e3e 2070 7269 6e74         >>> print
-00002a80: 202b 610a 2020 2020 2020 2020 2833 2e30   +a.        (3.0
-00002a90: 3030 302c 2032 2e35 3030 302c 202d 312e  000, 2.5000, -1.
-00002aa0: 3830 3030 290a 2020 2020 2020 2020 2222  8000).        ""
-00002ab0: 220a 2020 2020 2020 2020 6364 6566 2076  ".        cdef v
-00002ac0: 6563 3320 7265 730a 2020 2020 2020 2020  ec3 res.        
-00002ad0: 7265 7320 3d20 7665 6333 2829 0a20 2020  res = vec3().   
-00002ae0: 2020 2020 2072 6573 2e78 203d 2073 656c       res.x = sel
-00002af0: 662e 780a 2020 2020 2020 2020 7265 732e  f.x.        res.
-00002b00: 7920 3d20 7365 6c66 2e79 0a20 2020 2020  y = self.y.     
-00002b10: 2020 2072 6573 2e7a 203d 2073 656c 662e     res.z = self.
-00002b20: 7a0a 2020 2020 2020 2020 7265 7475 726e  z.        return
-00002b30: 2072 6573 0a0a 0a20 2020 2064 6566 205f   res...    def _
-00002b40: 5f69 6164 645f 5f28 7365 6c66 2c20 7665  _iadd__(self, ve
-00002b50: 6333 206f 7468 6572 293a 0a20 2020 2020  c3 other):.     
-00002b60: 2020 2022 2222 496e 6c69 6e65 2076 6563     """Inline vec
-00002b70: 746f 7220 6164 6469 7469 6f6e 2e0a 0a20  tor addition... 
-00002b80: 2020 2020 2020 203e 3e3e 2061 3d76 6563         >>> a=vec
-00002b90: 3328 312e 302c 2030 2e35 2c20 2d31 2e38  3(1.0, 0.5, -1.8
-00002ba0: 290a 2020 2020 2020 2020 3e3e 3e20 623d  ).        >>> b=
-00002bb0: 7665 6333 282d 302e 332c 2030 2e37 352c  vec3(-0.3, 0.75,
-00002bc0: 2030 2e35 290a 2020 2020 2020 2020 3e3e   0.5).        >>
-00002bd0: 3e20 612b 3d62 0a20 2020 2020 2020 203e  > a+=b.        >
-00002be0: 3e3e 2070 7269 6e74 2061 0a20 2020 2020  >> print a.     
-00002bf0: 2020 2028 302e 3730 3030 2c20 312e 3235     (0.7000, 1.25
-00002c00: 3030 2c20 2d31 2e33 3030 3029 0a20 2020  00, -1.3000).   
-00002c10: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00002c20: 2073 656c 662e 783d 7365 6c66 2e78 2b6f   self.x=self.x+o
-00002c30: 7468 6572 2e78 0a20 2020 2020 2020 2073  ther.x.        s
-00002c40: 656c 662e 793d 7365 6c66 2e79 2b6f 7468  elf.y=self.y+oth
-00002c50: 6572 2e79 0a20 2020 2020 2020 2073 656c  er.y.        sel
-00002c60: 662e 7a3d 7365 6c66 2e7a 2b6f 7468 6572  f.z=self.z+other
-00002c70: 2e7a 0a20 2020 2020 2020 2072 6574 7572  .z.        retur
-00002c80: 6e20 7365 6c66 0a0a 2020 2020 6465 6620  n self..    def 
-00002c90: 5f5f 6973 7562 5f5f 2873 656c 662c 2076  __isub__(self, v
-00002ca0: 6563 3320 6f74 6865 7229 3a0a 2020 2020  ec3 other):.    
-00002cb0: 2020 2020 2222 2249 6e6c 696e 6520 7665      """Inline ve
-00002cc0: 6374 6f72 2073 7562 7472 6163 7469 6f6e  ctor subtraction
-00002cd0: 2e0a 0a20 2020 2020 2020 203e 3e3e 2061  ...        >>> a
-00002ce0: 3d76 6563 3328 312e 302c 2030 2e35 2c20  =vec3(1.0, 0.5, 
-00002cf0: 2d31 2e38 290a 2020 2020 2020 2020 3e3e  -1.8).        >>
-00002d00: 3e20 623d 7665 6333 282d 302e 332c 2030  > b=vec3(-0.3, 0
-00002d10: 2e37 352c 2030 2e35 290a 2020 2020 2020  .75, 0.5).      
-00002d20: 2020 3e3e 3e20 612d 3d62 0a20 2020 2020    >>> a-=b.     
-00002d30: 2020 203e 3e3e 2070 7269 6e74 2061 0a20     >>> print a. 
-00002d40: 2020 2020 2020 2028 312e 3330 3030 2c20         (1.3000, 
-00002d50: 2d30 2e32 3530 302c 202d 322e 3330 3030  -0.2500, -2.3000
-00002d60: 290a 2020 2020 2020 2020 2222 220a 2020  ).        """.  
-00002d70: 2020 2020 2020 7365 6c66 2e78 3d73 656c        self.x=sel
-00002d80: 662e 782d 6f74 6865 722e 780a 2020 2020  f.x-other.x.    
-00002d90: 2020 2020 7365 6c66 2e79 3d73 656c 662e      self.y=self.
-00002da0: 792d 6f74 6865 722e 790a 2020 2020 2020  y-other.y.      
-00002db0: 2020 7365 6c66 2e7a 3d73 656c 662e 7a2d    self.z=self.z-
-00002dc0: 6f74 6865 722e 7a0a 2020 2020 2020 2020  other.z.        
-00002dd0: 7265 7475 726e 2073 656c 660a 0a20 2020  return self..   
-00002de0: 2064 6566 205f 5f69 6d75 6c5f 5f28 7365   def __imul__(se
-00002df0: 6c66 2c20 6f74 6865 7229 3a0a 2020 2020  lf, other):.    
-00002e00: 2020 2020 2222 2249 6e6c 696e 6520 6d75      """Inline mu
-00002e10: 6c74 6970 6c69 6361 7469 6f6e 2028 6f6e  ltiplication (on
-00002e20: 6c79 2077 6974 6820 7363 616c 6172 290a  ly with scalar).
-00002e30: 0a20 2020 2020 2020 203e 3e3e 2061 3d76  .        >>> a=v
-00002e40: 6563 3328 312e 302c 2030 2e35 2c20 2d31  ec3(1.0, 0.5, -1
-00002e50: 2e38 290a 2020 2020 2020 2020 3e3e 3e20  .8).        >>> 
-00002e60: 612a 3d32 2e30 0a20 2020 2020 2020 203e  a*=2.0.        >
-00002e70: 3e3e 2070 7269 6e74 2061 0a20 2020 2020  >> print a.     
-00002e80: 2020 2028 322e 3030 3030 2c20 312e 3030     (2.0000, 1.00
-00002e90: 3030 2c20 2d33 2e36 3030 3029 0a20 2020  00, -3.6000).   
-00002ea0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00002eb0: 2063 6465 6620 646f 7562 6c65 2072 0a20   cdef double r. 
-00002ec0: 2020 2020 2020 2074 6220 3d20 7479 7065         tb = type
-00002ed0: 286f 7468 6572 290a 2020 2020 2020 2020  (other).        
-00002ee0: 6966 2074 6220 6973 2066 6c6f 6174 206f  if tb is float o
-00002ef0: 7220 7462 2069 7320 696e 7420 6f72 2074  r tb is int or t
-00002f00: 6220 6973 206c 6f6e 673a 0a20 2020 2020  b is long:.     
-00002f10: 2020 2020 2020 2072 3d6f 7468 6572 0a20         r=other. 
-00002f20: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00002f30: 783d 7365 6c66 2e78 2a72 0a20 2020 2020  x=self.x*r.     
-00002f40: 2020 2020 2020 2073 656c 662e 793d 7365         self.y=se
-00002f50: 6c66 2e79 2a72 0a20 2020 2020 2020 2020  lf.y*r.         
-00002f60: 2020 2073 656c 662e 7a3d 7365 6c66 2e7a     self.z=self.z
-00002f70: 2a72 0a20 2020 2020 2020 2020 2020 2072  *r.            r
-00002f80: 6574 7572 6e20 7365 6c66 0a20 2020 2020  eturn self.     
-00002f90: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00002fa0: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
-00002fb0: 7272 6f72 2c20 2275 6e73 7570 706f 7274  rror, "unsupport
-00002fc0: 6564 206f 7065 7261 6e64 2074 7970 6520  ed operand type 
-00002fd0: 666f 7220 2a3d 220a 0a20 2020 2064 6566  for *="..    def
-00002fe0: 205f 5f69 6469 765f 5f28 7365 6c66 2c20   __idiv__(self, 
-00002ff0: 6f74 6865 7229 3a0a 2020 2020 2020 2020  other):.        
-00003000: 2222 2249 6e6c 696e 6520 6469 7669 7369  """Inline divisi
-00003010: 6f6e 2077 6974 6820 7363 616c 6172 0a0a  on with scalar..
-00003020: 2020 2020 2020 2020 3e3e 3e20 613d 7665          >>> a=ve
-00003030: 6333 2831 2e30 2c20 302e 352c 202d 312e  c3(1.0, 0.5, -1.
-00003040: 3829 0a20 2020 2020 2020 203e 3e3e 2061  8).        >>> a
-00003050: 2f3d 322e 300a 2020 2020 2020 2020 3e3e  /=2.0.        >>
-00003060: 3e20 7072 696e 7420 610a 2020 2020 2020  > print a.      
-00003070: 2020 2830 2e35 3030 302c 2030 2e32 3530    (0.5000, 0.250
-00003080: 302c 202d 302e 3930 3030 290a 2020 2020  0, -0.9000).    
-00003090: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-000030a0: 6364 6566 2064 6f75 626c 6520 720a 2020  cdef double r.  
-000030b0: 2020 2020 2020 7462 203d 2074 7970 6528        tb = type(
-000030c0: 6f74 6865 7229 0a20 2020 2020 2020 2069  other).        i
-000030d0: 6620 7462 2069 7320 666c 6f61 7420 6f72  f tb is float or
-000030e0: 2074 6220 6973 2069 6e74 206f 7220 7462   tb is int or tb
-000030f0: 2069 7320 6c6f 6e67 3a0a 2020 2020 2020   is long:.      
-00003100: 2020 2020 2020 723d 6f74 6865 720a 2020        r=other.  
-00003110: 2020 2020 2020 2020 2020 6966 2066 6162            if fab
-00003120: 7328 7229 3c3d 6570 733a 0a20 2020 2020  s(r)<=eps:.     
-00003130: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00003140: 205a 6572 6f44 6976 6973 696f 6e45 7272   ZeroDivisionErr
-00003150: 6f72 2c22 7665 6333 2064 6976 6973 696f  or,"vec3 divisio
-00003160: 6e22 0a20 2020 2020 2020 2020 2020 2073  n".            s
-00003170: 656c 662e 783d 7365 6c66 2e78 2f72 0a20  elf.x=self.x/r. 
-00003180: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00003190: 793d 7365 6c66 2e79 2f72 0a20 2020 2020  y=self.y/r.     
-000031a0: 2020 2020 2020 2073 656c 662e 7a3d 7365         self.z=se
-000031b0: 6c66 2e7a 2f72 0a20 2020 2020 2020 2020  lf.z/r.         
-000031c0: 2020 2072 6574 7572 6e20 7365 6c66 0a20     return self. 
-000031d0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-000031e0: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
-000031f0: 7970 6545 7272 6f72 2c20 2275 6e73 7570  ypeError, "unsup
-00003200: 706f 7274 6564 206f 7065 7261 6e64 2074  ported operand t
-00003210: 7970 6520 666f 7220 2f3d 220a 0a20 2020  ype for /="..   
-00003220: 2064 6566 205f 5f69 6d6f 645f 5f28 7365   def __imod__(se
-00003230: 6c66 2c20 6229 3a0a 2020 2020 2020 2020  lf, b):.        
-00003240: 2222 2249 6e6c 696e 6520 6d6f 6475 6c6f  """Inline modulo
-00003250: 2e0a 0a20 2020 2020 2020 203e 3e3e 2061  ...        >>> a
-00003260: 3d76 6563 3328 332e 302c 2032 2e35 2c20  =vec3(3.0, 2.5, 
-00003270: 2d31 2e38 290a 2020 2020 2020 2020 3e3e  -1.8).        >>
-00003280: 3e20 6125 3d32 2e30 0a20 2020 2020 2020  > a%=2.0.       
-00003290: 203e 3e3e 2070 7269 6e74 2061 0a20 2020   >>> print a.   
-000032a0: 2020 2020 2028 312e 3030 3030 2c20 302e       (1.0000, 0.
-000032b0: 3530 3030 2c20 302e 3230 3030 290a 2020  5000, 0.2000).  
-000032c0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-000032d0: 2020 6364 6566 2076 6563 3320 7662 0a20    cdef vec3 vb. 
-000032e0: 2020 2020 2020 2063 6465 6620 646f 7562         cdef doub
-000032f0: 6c65 2072 0a0a 2020 2020 2020 2020 7462  le r..        tb
-00003300: 203d 2074 7970 6528 6229 0a0a 2020 2020   = type(b)..    
-00003310: 2020 2020 6966 2074 6220 6973 2066 6c6f      if tb is flo
-00003320: 6174 206f 7220 7462 2069 7320 696e 7420  at or tb is int 
-00003330: 6f72 2074 6220 6973 206c 6f6e 673a 0a20  or tb is long:. 
-00003340: 2020 2020 2020 2020 2020 2023 2076 6563             # vec
-00003350: 3325 3d73 6361 6c61 720a 2020 2020 2020  3%=scalar.      
-00003360: 2020 2020 2020 7220 3d20 620a 2020 2020        r = b.    
-00003370: 2020 2020 2020 2020 6966 2066 6162 7328          if fabs(
-00003380: 7229 3c3d 6570 733a 0a20 2020 2020 2020  r)<=eps:.       
-00003390: 2020 2020 2020 2020 2072 6169 7365 205a           raise Z
-000033a0: 6572 6f44 6976 6973 696f 6e45 7272 6f72  eroDivisionError
-000033b0: 2c22 7665 6333 206d 6f64 756c 6f22 0a20  ,"vec3 modulo". 
-000033c0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-000033d0: 7820 3d20 5f66 6d6f 6428 7365 6c66 2e78  x = _fmod(self.x
-000033e0: 2c72 290a 2020 2020 2020 2020 2020 2020  ,r).            
-000033f0: 7365 6c66 2e79 203d 205f 666d 6f64 2873  self.y = _fmod(s
-00003400: 656c 662e 792c 7229 0a20 2020 2020 2020  elf.y,r).       
-00003410: 2020 2020 2073 656c 662e 7a20 3d20 5f66       self.z = _f
-00003420: 6d6f 6428 7365 6c66 2e7a 2c72 290a 2020  mod(self.z,r).  
-00003430: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00003440: 2073 656c 660a 2020 2020 2020 2020 656c   self.        el
-00003450: 6966 2074 6220 6973 2076 6563 333a 0a20  if tb is vec3:. 
-00003460: 2020 2020 2020 2020 2020 2023 2076 6563             # vec
-00003470: 3325 3d76 6563 330a 2020 2020 2020 2020  3%=vec3.        
-00003480: 2020 2020 7662 203d 2062 0a20 2020 2020      vb = b.     
-00003490: 2020 2020 2020 2069 6620 6661 6273 2876         if fabs(v
-000034a0: 622e 7829 3c3d 6570 7320 6f72 2066 6162  b.x)<=eps or fab
-000034b0: 7328 7662 2e79 293c 3d65 7073 206f 7220  s(vb.y)<=eps or 
-000034c0: 6661 6273 2876 622e 7a29 3c3d 6570 733a  fabs(vb.z)<=eps:
-000034d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000034e0: 2072 6169 7365 205a 6572 6f44 6976 6973   raise ZeroDivis
-000034f0: 696f 6e45 7272 6f72 2c22 7665 6333 206d  ionError,"vec3 m
-00003500: 6f64 756c 6f22 0a20 2020 2020 2020 2020  odulo".         
-00003510: 2020 2073 656c 662e 7820 3d20 5f66 6d6f     self.x = _fmo
-00003520: 6428 7365 6c66 2e78 2c20 7662 2e78 290a  d(self.x, vb.x).
-00003530: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00003540: 2e79 203d 205f 666d 6f64 2873 656c 662e  .y = _fmod(self.
-00003550: 792c 2076 622e 7929 0a20 2020 2020 2020  y, vb.y).       
-00003560: 2020 2020 2073 656c 662e 7a20 3d20 5f66       self.z = _f
-00003570: 6d6f 6428 7365 6c66 2e7a 2c20 7662 2e7a  mod(self.z, vb.z
-00003580: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
-00003590: 7475 726e 2073 656c 660a 2020 2020 2020  turn self.      
-000035a0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-000035b0: 2020 2020 7261 6973 6520 5479 7065 4572      raise TypeEr
-000035c0: 726f 722c 2022 756e 7375 7070 6f72 7465  ror, "unsupporte
-000035d0: 6420 6f70 6572 616e 6420 7479 7065 2066  d operand type f
-000035e0: 6f72 2025 3d22 0a0a 0a20 2020 2064 6566  or %="...    def
-000035f0: 205f 5f61 6273 5f5f 2873 656c 6629 3a0a   __abs__(self):.
-00003600: 2020 2020 2020 2020 2222 2252 6574 7572          """Retur
-00003610: 6e20 7468 6520 6c65 6e67 7468 206f 6620  n the length of 
-00003620: 7468 6520 7665 6374 6f72 2e0a 0a20 2020  the vector...   
-00003630: 2020 2020 2061 6273 2876 2920 6973 2065       abs(v) is e
-00003640: 7175 6976 616c 656e 7420 746f 2076 2e6c  quivalent to v.l
-00003650: 656e 6774 6828 292e 0a0a 2020 2020 2020  ength()...      
-00003660: 2020 3e3e 3e20 613d 7665 6333 2831 2e30    >>> a=vec3(1.0
-00003670: 2c20 302e 352c 202d 312e 3829 0a20 2020  , 0.5, -1.8).   
-00003680: 2020 2020 203e 3e3e 2070 7269 6e74 2061       >>> print a
-00003690: 6273 2861 290a 2020 2020 2020 2020 322e  bs(a).        2.
-000036a0: 3131 3839 3632 3031 3030 340a 2020 2020  11896201004.    
-000036b0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-000036c0: 6364 6566 2064 6f75 626c 6520 610a 2020  cdef double a.  
-000036d0: 2020 2020 2020 6120 3d20 7365 6c66 2e78        a = self.x
-000036e0: 2a73 656c 662e 7820 2b20 7365 6c66 2e79  *self.x + self.y
-000036f0: 2a73 656c 662e 7920 2b20 7365 6c66 2e7a  *self.y + self.z
-00003700: 2a73 656c 662e 7a0a 2020 2020 2020 2020  *self.z.        
-00003710: 7265 7475 726e 2073 7172 7428 6129 0a0a  return sqrt(a)..
-00003720: 2020 2020 6465 6620 5f5f 6765 7461 7474      def __getatt
-00003730: 725f 5f28 7365 6c66 2c20 6e61 6d65 293a  r__(self, name):
-00003740: 0a20 2020 2020 2020 2069 6620 6e61 6d65  .        if name
-00003750: 3d3d 2278 223a 0a20 2020 2020 2020 2020  =="x":.         
-00003760: 2020 2072 6574 7572 6e20 7365 6c66 2e78     return self.x
-00003770: 0a20 2020 2020 2020 2065 6c69 6620 6e61  .        elif na
-00003780: 6d65 3d3d 2279 223a 0a20 2020 2020 2020  me=="y":.       
-00003790: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-000037a0: 2e79 0a20 2020 2020 2020 2065 6c69 6620  .y.        elif 
-000037b0: 6e61 6d65 3d3d 227a 223a 0a20 2020 2020  name=="z":.     
-000037c0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-000037d0: 6c66 2e7a 0a20 2020 2020 2020 2065 6c73  lf.z.        els
-000037e0: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
-000037f0: 6169 7365 2041 7474 7269 6275 7465 4572  aise AttributeEr
-00003800: 726f 722c 2276 6563 3320 6861 7320 6e6f  ror,"vec3 has no
-00003810: 2061 7474 7269 6275 7465 2027 222b 6e61   attribute '"+na
-00003820: 6d65 2b22 2722 0a0a 2020 2020 6465 6620  me+"'"..    def 
-00003830: 5f5f 7365 7461 7474 725f 5f28 7365 6c66  __setattr__(self
-00003840: 2c20 6e61 6d65 2c20 7661 6c29 3a0a 2020  , name, val):.  
-00003850: 2020 2020 2020 6966 206e 616d 653d 3d22        if name=="
-00003860: 7822 3a0a 2020 2020 2020 2020 2020 2020  x":.            
-00003870: 7365 6c66 2e78 203d 2076 616c 0a20 2020  self.x = val.   
-00003880: 2020 2020 2065 6c69 6620 6e61 6d65 3d3d       elif name==
-00003890: 2279 223a 0a20 2020 2020 2020 2020 2020  "y":.           
-000038a0: 2073 656c 662e 7920 3d20 7661 6c0a 2020   self.y = val.  
-000038b0: 2020 2020 2020 656c 6966 206e 616d 653d        elif name=
-000038c0: 3d22 7a22 3a0a 2020 2020 2020 2020 2020  ="z":.          
-000038d0: 2020 7365 6c66 2e7a 203d 2076 616c 0a20    self.z = val. 
-000038e0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-000038f0: 2020 2020 2020 2020 2072 6169 7365 2041           raise A
-00003900: 7474 7269 6275 7465 4572 726f 722c 2276  ttributeError,"v
-00003910: 6563 3320 6861 7320 6e6f 2077 7269 7461  ec3 has no writa
-00003920: 626c 6520 6174 7472 6962 7574 6520 2722  ble attribute '"
-00003930: 2b6e 616d 652b 2227 220a 0a20 2020 2064  +name+"'"..    d
-00003940: 6566 205f 5f6c 656e 5f5f 2873 656c 6629  ef __len__(self)
-00003950: 3a0a 2020 2020 2020 2020 2222 224c 656e  :.        """Len
-00003960: 6774 6820 6f66 2074 6865 2073 6571 7565  gth of the seque
-00003970: 6e63 6520 2861 6c77 6179 7320 3329 2222  nce (always 3)""
-00003980: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
-00003990: 2033 0a0a 2020 2020 6465 6620 5f5f 6765   3..    def __ge
-000039a0: 7469 7465 6d5f 5f28 7665 6333 2073 656c  titem__(vec3 sel
-000039b0: 662c 206b 6579 293a 0a20 2020 2020 2020  f, key):.       
-000039c0: 2022 2222 5265 7475 726e 2061 2063 6f6d   """Return a com
-000039d0: 706f 6e65 6e74 2062 7920 696e 6465 7820  ponent by index 
-000039e0: 2830 2d62 6173 6564 290a 0a20 2020 2020  (0-based)..     
-000039f0: 2020 203e 3e3e 2061 3d76 6563 3328 312e     >>> a=vec3(1.
-00003a00: 302c 2030 2e35 2c20 2d31 2e38 290a 2020  0, 0.5, -1.8).  
-00003a10: 2020 2020 2020 3e3e 3e20 7072 696e 7420        >>> print 
-00003a20: 615b 305d 0a20 2020 2020 2020 2031 2e30  a[0].        1.0
-00003a30: 0a20 2020 2020 2020 203e 3e3e 2070 7269  .        >>> pri
-00003a40: 6e74 2061 5b31 5d0a 2020 2020 2020 2020  nt a[1].        
-00003a50: 302e 350a 2020 2020 2020 2020 3e3e 3e20  0.5.        >>> 
-00003a60: 7072 696e 7420 615b 325d 0a20 2020 2020  print a[2].     
-00003a70: 2020 202d 312e 380a 2020 2020 2020 2020     -1.8.        
-00003a80: 2222 220a 2020 2020 2020 2020 6364 6566  """.        cdef
-00003a90: 2069 6e74 206b 0a0a 2020 2020 2020 2020   int k..        
-00003aa0: 543d 7479 7065 286b 6579 290a 2020 2020  T=type(key).    
-00003ab0: 2020 2020 6966 2054 213d 696e 7420 616e      if T!=int an
-00003ac0: 6420 5421 3d6c 6f6e 673a 0a20 2020 2020  d T!=long:.     
-00003ad0: 2020 2020 2020 2072 6169 7365 2054 7970         raise Typ
-00003ae0: 6545 7272 6f72 2c20 2269 6e64 6578 206d  eError, "index m
-00003af0: 7573 7420 6265 2069 6e74 6567 6572 220a  ust be integer".
-00003b00: 0a20 2020 2020 2020 206b 203d 206b 6579  .        k = key
-00003b10: 0a20 2020 2020 2020 2069 6620 2020 6b3d  .        if   k=
-00003b20: 3d30 3a20 7265 7475 726e 2073 656c 662e  =0: return self.
-00003b30: 780a 2020 2020 2020 2020 656c 6966 206b  x.        elif k
-00003b40: 3d3d 313a 2072 6574 7572 6e20 7365 6c66  ==1: return self
-00003b50: 2e79 0a20 2020 2020 2020 2065 6c69 6620  .y.        elif 
-00003b60: 6b3d 3d32 3a20 7265 7475 726e 2073 656c  k==2: return sel
-00003b70: 662e 7a0a 2020 2020 2020 2020 656c 7365  f.z.        else
-00003b80: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
-00003b90: 6973 6520 496e 6465 7845 7272 6f72 2c22  ise IndexError,"
-00003ba0: 696e 6465 7820 6f75 7420 6f66 2072 616e  index out of ran
-00003bb0: 6765 220a 0a20 2020 2064 6566 205f 5f73  ge"..    def __s
-00003bc0: 6574 6974 656d 5f5f 2873 656c 662c 206b  etitem__(self, k
-00003bd0: 6579 2c20 7661 6c75 6529 3a0a 2020 2020  ey, value):.    
-00003be0: 2020 2020 2222 2253 6574 2061 2063 6f6d      """Set a com
-00003bf0: 706f 6e65 6e74 2062 7920 696e 6465 7820  ponent by index 
-00003c00: 2830 2d62 6173 6564 290a 0a20 2020 2020  (0-based)..     
-00003c10: 2020 203e 3e3e 2061 3d76 6563 3328 290a     >>> a=vec3().
-00003c20: 2020 2020 2020 2020 3e3e 3e20 615b 305d          >>> a[0]
-00003c30: 3d31 2e35 3b20 615b 315d 3d30 2e37 3b20  =1.5; a[1]=0.7; 
-00003c40: 615b 325d 3d2d 302e 330a 2020 2020 2020  a[2]=-0.3.      
-00003c50: 2020 3e3e 3e20 7072 696e 7420 610a 2020    >>> print a.  
-00003c60: 2020 2020 2020 2831 2e35 3030 302c 2030        (1.5000, 0
-00003c70: 2e37 3030 302c 202d 302e 3330 3030 290a  .7000, -0.3000).
-00003c80: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00003c90: 2020 2020 6364 6566 2069 6e74 206b 0a0a      cdef int k..
-00003ca0: 2020 2020 2020 2020 543d 7479 7065 286b          T=type(k
-00003cb0: 6579 290a 2020 2020 2020 2020 6966 2054  ey).        if T
-00003cc0: 213d 696e 7420 616e 6420 5421 3d6c 6f6e  !=int and T!=lon
-00003cd0: 673a 0a20 2020 2020 2020 2020 2020 2072  g:.            r
-00003ce0: 6169 7365 2054 7970 6545 7272 6f72 2c20  aise TypeError, 
-00003cf0: 2269 6e64 6578 206d 7573 7420 6265 2069  "index must be i
-00003d00: 6e74 6567 6572 220a 0a20 2020 2020 2020  nteger"..       
-00003d10: 206b 203d 206b 6579 0a20 2020 2020 2020   k = key.       
-00003d20: 2069 6620 2020 6b3d 3d30 3a20 7365 6c66   if   k==0: self
-00003d30: 2e78 203d 2076 616c 7565 0a20 2020 2020  .x = value.     
-00003d40: 2020 2065 6c69 6620 6b3d 3d31 3a20 7365     elif k==1: se
-00003d50: 6c66 2e79 203d 2076 616c 7565 0a20 2020  lf.y = value.   
-00003d60: 2020 2020 2065 6c69 6620 6b3d 3d32 3a20       elif k==2: 
-00003d70: 7365 6c66 2e7a 203d 2076 616c 7565 0a20  self.z = value. 
-00003d80: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00003d90: 2020 2020 2020 2020 2072 6169 7365 2049           raise I
-00003da0: 6e64 6578 4572 726f 722c 2269 6e64 6578  ndexError,"index
-00003db0: 206f 7574 206f 6620 7261 6e67 6522 0a0a   out of range"..
-00003dc0: 2020 2020 6465 6620 6372 6f73 7328 7365      def cross(se
-00003dd0: 6c66 2c20 7665 6333 206f 7468 6572 293a  lf, vec3 other):
-00003de0: 0a20 2020 2020 2020 2022 2222 4372 6f73  .        """Cros
-00003df0: 7320 7072 6f64 7563 742e 0a0a 2020 2020  s product...    
-00003e00: 2020 2020 3e3e 3e20 613d 7665 6333 2831      >>> a=vec3(1
-00003e10: 2e30 2c20 302e 352c 202d 312e 3829 0a20  .0, 0.5, -1.8). 
-00003e20: 2020 2020 2020 203e 3e3e 2062 3d76 6563         >>> b=vec
-00003e30: 3328 2d30 2e33 2c20 302e 3735 2c20 302e  3(-0.3, 0.75, 0.
-00003e40: 3529 0a20 2020 2020 2020 203e 3e3e 2063  5).        >>> c
-00003e50: 3d61 2e63 726f 7373 2862 290a 2020 2020  =a.cross(b).    
-00003e60: 2020 2020 3e3e 3e20 7072 696e 7420 630a      >>> print c.
-00003e70: 2020 2020 2020 2020 2831 2e36 3030 302c          (1.6000,
-00003e80: 2030 2e30 3430 302c 2030 2e39 3030 3029   0.0400, 0.9000)
-00003e90: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00003ea0: 2020 2020 2063 6465 6620 7665 6333 2072       cdef vec3 r
-00003eb0: 6573 0a0a 2020 2020 2020 2020 6966 2074  es..        if t
-00003ec0: 7970 6528 6f74 6865 7229 3d3d 7665 6333  ype(other)==vec3
-00003ed0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-00003ee0: 7320 3d20 7665 6333 2829 0a20 2020 2020  s = vec3().     
-00003ef0: 2020 2020 2020 2072 6573 2e78 203d 2073         res.x = s
-00003f00: 656c 662e 792a 6f74 6865 722e 7a2d 7365  elf.y*other.z-se
-00003f10: 6c66 2e7a 2a6f 7468 6572 2e79 0a20 2020  lf.z*other.y.   
-00003f20: 2020 2020 2020 2020 2072 6573 2e79 203d           res.y =
-00003f30: 2073 656c 662e 7a2a 6f74 6865 722e 782d   self.z*other.x-
-00003f40: 7365 6c66 2e78 2a6f 7468 6572 2e7a 0a20  self.x*other.z. 
-00003f50: 2020 2020 2020 2020 2020 2072 6573 2e7a             res.z
-00003f60: 203d 2073 656c 662e 782a 6f74 6865 722e   = self.x*other.
-00003f70: 792d 7365 6c66 2e79 2a6f 7468 6572 2e78  y-self.y*other.x
-00003f80: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00003f90: 7572 6e20 7265 730a 2020 2020 2020 2020  urn res.        
-00003fa0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00003fb0: 2020 7261 6973 6520 5479 7065 4572 726f    raise TypeErro
-00003fc0: 722c 2022 756e 7375 7070 6f72 7465 6420  r, "unsupported 
-00003fd0: 6f70 6572 616e 6420 7479 7065 2066 6f72  operand type for
-00003fe0: 2063 726f 7373 2829 220a 0a20 2020 2064   cross()"..    d
-00003ff0: 6566 206c 656e 6774 6828 7365 6c66 293a  ef length(self):
-00004000: 0a20 2020 2020 2020 2022 2222 5265 7475  .        """Retu
-00004010: 726e 2074 6865 206c 656e 6774 6820 6f66  rn the length of
-00004020: 2074 6865 2076 6563 746f 722e 0a0a 2020   the vector...  
-00004030: 2020 2020 2020 762e 6c65 6e67 7468 2829        v.length()
-00004040: 2069 7320 6571 7569 7661 6c65 6e74 2074   is equivalent t
-00004050: 6f20 6162 7328 7629 2e0a 0a20 2020 2020  o abs(v)...     
-00004060: 2020 203e 3e3e 2061 3d76 6563 3328 312e     >>> a=vec3(1.
-00004070: 302c 2030 2e35 2c20 2d31 2e38 290a 2020  0, 0.5, -1.8).  
-00004080: 2020 2020 2020 3e3e 3e20 7072 696e 7420        >>> print 
-00004090: 612e 6c65 6e67 7468 2829 0a20 2020 2020  a.length().     
-000040a0: 2020 2032 2e31 3138 3936 3230 3130 3034     2.11896201004
-000040b0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-000040c0: 2020 2020 2063 6465 6620 646f 7562 6c65       cdef double
-000040d0: 2061 0a20 2020 2020 2020 2061 203d 2073   a.        a = s
-000040e0: 656c 662e 782a 7365 6c66 2e78 202b 2073  elf.x*self.x + s
-000040f0: 656c 662e 792a 7365 6c66 2e79 202b 2073  elf.y*self.y + s
-00004100: 656c 662e 7a2a 7365 6c66 2e7a 0a20 2020  elf.z*self.z.   
-00004110: 2020 2020 2072 6574 7572 6e20 7371 7274       return sqrt
-00004120: 2861 290a 0a20 2020 2064 6566 206e 6f72  (a)..    def nor
-00004130: 6d61 6c69 7a65 2873 656c 6629 3a0a 2020  malize(self):.  
-00004140: 2020 2020 2020 2222 2252 6574 7572 6e20        """Return 
-00004150: 6e6f 726d 616c 697a 6564 2076 6563 746f  normalized vecto
-00004160: 722e 0a0a 2020 2020 2020 2020 3e3e 3e20  r...        >>> 
-00004170: 613d 7665 6333 2831 2e30 2c20 302e 352c  a=vec3(1.0, 0.5,
-00004180: 202d 312e 3829 0a20 2020 2020 2020 203e   -1.8).        >
-00004190: 3e3e 2070 7269 6e74 2061 2e6e 6f72 6d61  >> print a.norma
-000041a0: 6c69 7a65 2829 0a20 2020 2020 2020 2028  lize().        (
-000041b0: 302e 3437 3139 2c20 302e 3233 3630 2c20  0.4719, 0.2360, 
-000041c0: 2d30 2e38 3439 3529 0a20 2020 2020 2020  -0.8495).       
-000041d0: 2022 2222 0a20 2020 2020 2020 2063 6465   """.        cde
-000041e0: 6620 7665 6333 2072 6573 0a20 2020 2020  f vec3 res.     
-000041f0: 2020 2063 6465 6620 646f 7562 6c65 206e     cdef double n
-00004200: 6c65 6e0a 0a20 2020 2020 2020 206e 6c65  len..        nle
-00004210: 6e20 3d20 7371 7274 2873 656c 662e 782a  n = sqrt(self.x*
-00004220: 7365 6c66 2e78 202b 2073 656c 662e 792a  self.x + self.y*
-00004230: 7365 6c66 2e79 202b 2073 656c 662e 7a2a  self.y + self.z*
-00004240: 7365 6c66 2e7a 290a 2020 2020 2020 2020  self.z).        
-00004250: 6966 206e 6c65 6e3c 3d65 7073 3a0a 2020  if nlen<=eps:.  
-00004260: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00004270: 5a65 726f 4469 7669 7369 6f6e 4572 726f  ZeroDivisionErro
-00004280: 722c 226e 756c 6c20 7665 6374 6f72 2063  r,"null vector c
-00004290: 616e 2774 2062 6520 6e6f 726d 616c 697a  an't be normaliz
-000042a0: 6564 220a 2020 2020 2020 2020 6e6c 656e  ed".        nlen
-000042b0: 203d 2031 2e30 2f6e 6c65 6e0a 2020 2020   = 1.0/nlen.    
-000042c0: 2020 2020 7265 7320 3d20 7665 6333 2829      res = vec3()
-000042d0: 0a20 2020 2020 2020 2072 6573 2e78 203d  .        res.x =
-000042e0: 2073 656c 662e 782a 6e6c 656e 0a20 2020   self.x*nlen.   
-000042f0: 2020 2020 2072 6573 2e79 203d 2073 656c       res.y = sel
-00004300: 662e 792a 6e6c 656e 0a20 2020 2020 2020  f.y*nlen.       
-00004310: 2072 6573 2e7a 203d 2073 656c 662e 7a2a   res.z = self.z*
-00004320: 6e6c 656e 0a20 2020 2020 2020 2072 6574  nlen.        ret
-00004330: 7572 6e20 7265 730a 0a20 2020 2064 6566  urn res..    def
-00004340: 2061 6e67 6c65 2873 656c 662c 2076 6563   angle(self, vec
-00004350: 3320 6f74 6865 7229 3a0a 2020 2020 2020  3 other):.      
-00004360: 2020 2222 2252 6574 7572 6e20 616e 676c    """Return angl
-00004370: 6520 2869 6e20 7261 6469 616e 7329 2062  e (in radians) b
-00004380: 6574 7765 656e 2073 656c 6620 616e 6420  etween self and 
-00004390: 6f74 6865 722e 0a0a 2020 2020 2020 2020  other...        
-000043a0: 3e3e 3e20 613d 7665 6333 2831 2e30 2c20  >>> a=vec3(1.0, 
-000043b0: 302e 352c 202d 312e 3829 0a20 2020 2020  0.5, -1.8).     
-000043c0: 2020 203e 3e3e 2062 3d76 6563 3328 2d30     >>> b=vec3(-0
-000043d0: 2e33 2c20 302e 3735 2c20 302e 3529 0a20  .3, 0.75, 0.5). 
-000043e0: 2020 2020 2020 203e 3e3e 2070 7269 6e74         >>> print
-000043f0: 2061 2e61 6e67 6c65 2862 290a 2020 2020   a.angle(b).    
-00004400: 2020 2020 312e 3939 3330 3637 3535 3538      1.9930675558
-00004410: 340a 2020 2020 2020 2020 2222 220a 0a20  4.        """.. 
-00004420: 2020 2020 2020 2063 6465 6620 646f 7562         cdef doub
-00004430: 6c65 2061 2c20 6c73 2c20 6c6f 0a0a 2020  le a, ls, lo..  
-00004440: 2020 2020 2020 6c73 203d 2073 7172 7428        ls = sqrt(
-00004450: 7365 6c66 2e78 2a73 656c 662e 7820 2b20  self.x*self.x + 
-00004460: 7365 6c66 2e79 2a73 656c 662e 7920 2b20  self.y*self.y + 
-00004470: 7365 6c66 2e7a 2a73 656c 662e 7a29 0a20  self.z*self.z). 
-00004480: 2020 2020 2020 206c 6f20 3d20 7371 7274         lo = sqrt
-00004490: 286f 7468 6572 2e78 2a6f 7468 6572 2e78  (other.x*other.x
-000044a0: 202b 206f 7468 6572 2e79 2a6f 7468 6572   + other.y*other
-000044b0: 2e79 202b 206f 7468 6572 2e7a 2a6f 7468  .y + other.z*oth
-000044c0: 6572 2e7a 290a 2020 2020 2020 2020 6120  er.z).        a 
-000044d0: 203d 206c 732a 6c6f 0a20 2020 2020 2020   = ls*lo.       
-000044e0: 2069 6620 613c 3d65 7073 3a0a 2020 2020   if a<=eps:.    
-000044f0: 2020 2020 2020 2020 7261 6973 6520 5a65          raise Ze
-00004500: 726f 4469 7669 7369 6f6e 4572 726f 722c  roDivisionError,
-00004510: 2261 6e67 6c65 2829 3a20 6e75 6c6c 2076  "angle(): null v
-00004520: 6563 746f 7220 6361 6e27 7420 6265 206e  ector can't be n
-00004530: 6f72 6d61 6c69 7a65 6422 0a20 2020 2020  ormalized".     
-00004540: 2020 2061 2020 3d20 2873 656c 662e 782a     a  = (self.x*
-00004550: 6f74 6865 722e 7820 2b20 7365 6c66 2e79  other.x + self.y
-00004560: 2a6f 7468 6572 2e79 202b 2073 656c 662e  *other.y + self.
-00004570: 7a2a 6f74 6865 722e 7a29 2f61 0a20 2020  z*other.z)/a.   
-00004580: 2020 2020 2069 6620 613e 312e 303a 0a20       if a>1.0:. 
-00004590: 2020 2020 2020 2020 2020 2061 3d31 2e30             a=1.0
-000045a0: 0a20 2020 2020 2020 2069 6620 613c 2d31  .        if a<-1
-000045b0: 2e30 3a0a 2020 2020 2020 2020 2020 2020  .0:.            
-000045c0: 613d 2d31 2e30 0a20 2020 2020 2020 2072  a=-1.0.        r
-000045d0: 6574 7572 6e20 6163 6f73 2861 290a 2320  eturn acos(a).# 
-000045e0: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-000045f0: 616e 6365 286f 7468 6572 2c20 7665 6333  ance(other, vec3
-00004600: 293a 0a23 2020 2020 2020 2020 2020 2020  ):.#            
-00004610: 7265 7475 726e 206d 6174 682e 6163 6f73  return math.acos
-00004620: 2828 7365 6c66 2a6f 7468 6572 2920 2f20  ((self*other) / 
-00004630: 2861 6273 2873 656c 6629 2a61 6273 286f  (abs(self)*abs(o
-00004640: 7468 6572 2929 290a 2320 2020 2020 2020  ther))).#       
-00004650: 2065 6c73 653a 0a23 2020 2020 2020 2020   else:.#        
-00004660: 2020 2020 7261 6973 6520 5479 7065 4572      raise TypeEr
-00004670: 726f 722c 2022 756e 7375 7070 6f72 7465  ror, "unsupporte
-00004680: 6420 6f70 6572 616e 6420 7479 7065 2066  d operand type f
-00004690: 6f72 2061 6e67 6c65 2829 220a 0a20 2020  or angle()"..   
-000046a0: 2064 6566 2072 6566 6c65 6374 2873 656c   def reflect(sel
-000046b0: 662c 2076 6563 3320 4e29 3a0a 2020 2020  f, vec3 N):.    
-000046c0: 2020 2020 2222 2252 6574 7572 6e20 7468      """Return th
-000046d0: 6520 7265 666c 6563 7469 6f6e 2076 6563  e reflection vec
-000046e0: 746f 722e 0a0a 2020 2020 2020 2020 4e20  tor...        N 
-000046f0: 6973 2074 6865 2073 7572 6661 6365 206e  is the surface n
-00004700: 6f72 6d61 6c20 7768 6963 6820 6861 7320  ormal which has 
-00004710: 746f 2062 6520 6f66 2075 6e69 7420 6c65  to be of unit le
-00004720: 6e67 7468 2e0a 0a20 2020 2020 2020 203e  ngth...        >
-00004730: 3e3e 2061 3d76 6563 3328 312e 302c 202d  >> a=vec3(1.0, -
-00004740: 312e 302c 2030 2e30 290a 2020 2020 2020  1.0, 0.0).      
-00004750: 2020 3e3e 3e20 7072 696e 7420 612e 7265    >>> print a.re
-00004760: 666c 6563 7428 7665 6333 2830 2c31 2c30  flect(vec3(0,1,0
-00004770: 290a 2020 2020 2020 2020 2831 2e30 3030  ).        (1.000
-00004780: 302c 2031 2e30 3030 302c 2030 2e30 3030  0, 1.0000, 0.000
-00004790: 3029 0a20 2020 2020 2020 2022 2222 0a20  0).        """. 
-000047a0: 2020 2020 2020 2063 6465 6620 7665 6333         cdef vec3
-000047b0: 2072 6573 0a20 2020 2020 2020 2063 6465   res.        cde
-000047c0: 6620 646f 7562 6c65 2061 0a0a 2020 2020  f double a..    
-000047d0: 2020 2020 7265 7320 3d20 7665 6333 2829      res = vec3()
-000047e0: 0a20 2020 2020 2020 2061 203d 2032 2e30  .        a = 2.0
-000047f0: 2a28 7365 6c66 2e78 2a4e 2e78 202b 2073  *(self.x*N.x + s
-00004800: 656c 662e 792a 4e2e 7920 2b20 7365 6c66  elf.y*N.y + self
-00004810: 2e7a 2a4e 2e7a 290a 2020 2020 2020 2020  .z*N.z).        
-00004820: 7265 732e 7820 3d20 7365 6c66 2e78 202d  res.x = self.x -
-00004830: 2061 2a4e 2e78 0a20 2020 2020 2020 2072   a*N.x.        r
-00004840: 6573 2e79 203d 2073 656c 662e 7920 2d20  es.y = self.y - 
-00004850: 612a 4e2e 790a 2020 2020 2020 2020 7265  a*N.y.        re
-00004860: 732e 7a20 3d20 7365 6c66 2e7a 202d 2061  s.z = self.z - a
-00004870: 2a4e 2e7a 0a20 2020 2020 2020 2072 6574  *N.z.        ret
-00004880: 7572 6e20 7265 730a 0a20 2020 2064 6566  urn res..    def
-00004890: 2072 6566 7261 6374 2873 656c 662c 2076   refract(self, v
-000048a0: 6563 3320 4e2c 2065 7461 293a 0a20 2020  ec3 N, eta):.   
-000048b0: 2020 2020 2022 2222 5265 7475 726e 2074       """Return t
-000048c0: 6865 2074 7261 6e73 6d69 7474 6564 2076  he transmitted v
-000048d0: 6563 746f 722e 0a0a 2020 2020 2020 2020  ector...        
-000048e0: 4e20 6973 2074 6865 2073 7572 6661 6365  N is the surface
-000048f0: 206e 6f72 6d61 6c20 7768 6963 6820 6861   normal which ha
-00004900: 7320 746f 2062 6520 6f66 2075 6e69 7420  s to be of unit 
-00004910: 6c65 6e67 7468 2e0a 2020 2020 2020 2020  length..        
-00004920: 6574 6120 6973 2074 6865 2072 656c 6174  eta is the relat
-00004930: 6976 6520 696e 6465 7820 6f66 2072 6566  ive index of ref
-00004940: 7261 6374 696f 6e2e 2049 6620 7468 6520  raction. If the 
-00004950: 7265 7475 726e 6564 0a20 2020 2020 2020  returned.       
-00004960: 2076 6563 746f 7220 6973 207a 6572 6f20   vector is zero 
-00004970: 7468 656e 2074 6865 7265 2069 7320 6e6f  then there is no
-00004980: 2074 7261 6e73 6d69 7474 6564 206c 6967   transmitted lig
-00004990: 6874 2062 6563 6175 7365 0a20 2020 2020  ht because.     
-000049a0: 2020 206f 6620 746f 7461 6c20 696e 7465     of total inte
-000049b0: 726e 616c 2072 6566 6c65 6374 696f 6e2e  rnal reflection.
-000049c0: 0a0a 2020 2020 2020 2020 3e3e 3e20 613d  ..        >>> a=
-000049d0: 7665 6333 2831 2e30 2c20 2d31 2e35 2c20  vec3(1.0, -1.5, 
-000049e0: 302e 3829 0a20 2020 2020 2020 203e 3e3e  0.8).        >>>
-000049f0: 2070 7269 6e74 2061 2e72 6566 7261 6374   print a.refract
-00004a00: 2876 6563 3328 302c 312c 3029 2c20 312e  (vec3(0,1,0), 1.
-00004a10: 3333 290a 2020 2020 2020 2020 2831 2e33  33).        (1.3
-00004a20: 3330 302c 202d 312e 3739 3230 2c20 312e  300, -1.7920, 1.
-00004a30: 3036 3430 290a 2020 2020 2020 2020 2222  0640).        ""
-00004a40: 220a 2020 2020 2020 2020 6364 6566 2076  ".        cdef v
-00004a50: 6563 3320 7265 730a 2020 2020 2020 2020  ec3 res.        
-00004a60: 6364 6566 2064 6f75 626c 6520 646f 742c  cdef double dot,
-00004a70: 206b 2c20 6365 7461 0a0a 2020 2020 2020   k, ceta..      
-00004a80: 2020 7265 7320 3d20 7665 6333 2829 0a0a    res = vec3()..
-00004a90: 2020 2020 2020 2020 6365 7461 203d 2065          ceta = e
-00004aa0: 7461 0a20 2020 2020 2020 2064 6f74 203d  ta.        dot =
-00004ab0: 2073 656c 662e 782a 4e2e 7820 2b20 7365   self.x*N.x + se
-00004ac0: 6c66 2e79 2a4e 2e79 202b 2073 656c 662e  lf.y*N.y + self.
-00004ad0: 7a2a 4e2e 7a0a 2020 2020 2020 2020 6b20  z*N.z.        k 
-00004ae0: 2020 3d20 312e 3020 2d20 6365 7461 2a63    = 1.0 - ceta*c
-00004af0: 6574 612a 2831 2e30 202d 2064 6f74 2a64  eta*(1.0 - dot*d
-00004b00: 6f74 290a 2020 2020 2020 2020 6966 206b  ot).        if k
-00004b10: 3c3d 6570 733a 0a20 2020 2020 2020 2020  <=eps:.         
-00004b20: 2020 2072 6573 2e78 203d 2030 2e30 0a20     res.x = 0.0. 
-00004b30: 2020 2020 2020 2020 2020 2072 6573 2e79             res.y
-00004b40: 203d 2030 2e30 0a20 2020 2020 2020 2020   = 0.0.         
-00004b50: 2020 2072 6573 2e7a 203d 2030 2e30 0a20     res.z = 0.0. 
-00004b60: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00004b70: 2020 2020 2020 2020 206b 203d 2063 6574           k = cet
-00004b80: 612a 646f 7420 2b20 7371 7274 286b 290a  a*dot + sqrt(k).
-00004b90: 2020 2020 2020 2020 2020 2020 7265 732e              res.
-00004ba0: 7820 3d20 6365 7461 2a73 656c 662e 7820  x = ceta*self.x 
-00004bb0: 2d20 6b2a 4e2e 780a 2020 2020 2020 2020  - k*N.x.        
-00004bc0: 2020 2020 7265 732e 7920 3d20 6365 7461      res.y = ceta
-00004bd0: 2a73 656c 662e 7920 2d20 6b2a 4e2e 790a  *self.y - k*N.y.
-00004be0: 2020 2020 2020 2020 2020 2020 7265 732e              res.
-00004bf0: 7a20 3d20 6365 7461 2a73 656c 662e 7a20  z = ceta*self.z 
-00004c00: 2d20 6b2a 4e2e 7a0a 0a20 2020 2020 2020  - k*N.z..       
-00004c10: 2072 6574 7572 6e20 7265 730a 0a20 2020   return res..   
-00004c20: 2064 6566 206f 7274 686f 2873 656c 6629   def ortho(self)
-00004c30: 3a0a 2020 2020 2020 2020 2222 2252 6574  :.        """Ret
-00004c40: 7572 6e73 2061 6e20 6f72 7468 6f67 6f6e  urns an orthogon
-00004c50: 616c 2076 6563 746f 722e 0a0a 2020 2020  al vector...    
-00004c60: 2020 2020 5265 7475 726e 7320 6120 7665      Returns a ve
-00004c70: 6374 6f72 2074 6861 7420 6973 206f 7274  ctor that is ort
-00004c80: 686f 676f 6e61 6c20 746f 2073 656c 6620  hogonal to self 
-00004c90: 2877 6865 7265 0a20 2020 2020 2020 2073  (where.        s
-00004ca0: 656c 662a 7365 6c66 2e6f 7274 686f 2829  elf*self.ortho()
-00004cb0: 3d3d 3029 2e0a 0a20 2020 2020 2020 203e  ==0)...        >
-00004cc0: 3e3e 2061 3d76 6563 3328 312e 302c 202d  >> a=vec3(1.0, -
-00004cd0: 312e 352c 2030 2e38 290a 2020 2020 2020  1.5, 0.8).      
-00004ce0: 2020 3e3e 3e20 7072 696e 7420 726f 756e    >>> print roun
-00004cf0: 6428 612a 612e 6f72 7468 6f28 292c 3829  d(a*a.ortho(),8)
-00004d00: 0a20 2020 2020 2020 2030 2e30 0a20 2020  .        0.0.   
-00004d10: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00004d20: 2063 6465 6620 7665 6333 2072 6573 0a20   cdef vec3 res. 
-00004d30: 2020 2020 2020 2063 6465 6620 646f 7562         cdef doub
-00004d40: 6c65 2078 2c79 2c7a 0a20 2020 2020 2020  le x,y,z.       
-00004d50: 2072 6573 203d 2076 6563 3328 290a 0a20   res = vec3().. 
-00004d60: 2020 2020 2020 2078 3d66 6162 7328 7365         x=fabs(se
-00004d70: 6c66 2e78 290a 2020 2020 2020 2020 793d  lf.x).        y=
-00004d80: 6661 6273 2873 656c 662e 7929 0a20 2020  fabs(self.y).   
-00004d90: 2020 2020 207a 3d66 6162 7328 7365 6c66       z=fabs(self
-00004da0: 2e7a 290a 2020 2020 2020 2020 2320 4973  .z).        # Is
-00004db0: 207a 2074 6865 2073 6d61 6c6c 6573 7420   z the smallest 
-00004dc0: 656c 656d 656e 743f 2054 6865 6e20 7573  element? Then us
-00004dd0: 6520 7820 616e 6420 790a 2020 2020 2020  e x and y.      
-00004de0: 2020 6966 207a 3c3d 7820 616e 6420 7a3c    if z<=x and z<
-00004df0: 3d79 3a0a 2020 2020 2020 2020 2020 2020  =y:.            
-00004e00: 7265 732e 7820 3d20 2d73 656c 662e 790a  res.x = -self.y.
-00004e10: 2020 2020 2020 2020 2020 2020 7265 732e              res.
-00004e20: 7920 3d20 7365 6c66 2e78 0a20 2020 2020  y = self.x.     
-00004e30: 2020 2020 2020 2072 6573 2e7a 203d 2030         res.z = 0
-00004e40: 2e30 0a20 2020 2020 2020 2023 2049 7320  .0.        # Is 
-00004e50: 7920 736d 616c 6c65 7374 2065 6c65 6d65  y smallest eleme
-00004e60: 6e74 3f20 5468 656e 2075 7365 2078 2061  nt? Then use x a
-00004e70: 6e64 207a 0a20 2020 2020 2020 2065 6c69  nd z.        eli
-00004e80: 6620 793c 3d78 2061 6e64 2079 3c3d 7a3a  f y<=x and y<=z:
-00004e90: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
-00004ea0: 2e78 203d 202d 7365 6c66 2e7a 0a20 2020  .x = -self.z.   
-00004eb0: 2020 2020 2020 2020 2072 6573 2e79 203d           res.y =
-00004ec0: 2030 2e30 0a20 2020 2020 2020 2020 2020   0.0.           
-00004ed0: 2072 6573 2e7a 203d 2073 656c 662e 780a   res.z = self.x.
-00004ee0: 2020 2020 2020 2020 2320 7820 6973 2073          # x is s
-00004ef0: 6d61 6c6c 6573 740a 2020 2020 2020 2020  mallest.        
-00004f00: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00004f10: 2020 7265 732e 7820 3d20 302e 300a 2020    res.x = 0.0.  
-00004f20: 2020 2020 2020 2020 2020 7265 732e 7920            res.y 
-00004f30: 3d20 2d73 656c 662e 7a0a 2020 2020 2020  = -self.z.      
-00004f40: 2020 2020 2020 7265 732e 7a20 3d20 7365        res.z = se
-00004f50: 6c66 2e79 0a0a 2020 2020 2020 2020 7265  lf.y..        re
-00004f60: 7475 726e 2072 6573 0a0a 0a20 2020 2064  turn res...    d
-00004f70: 6566 2066 6164 6428 7365 6c66 2c20 7665  ef fadd(self, ve
-00004f80: 6333 2061 2c20 7665 6333 2062 293a 0a20  c3 a, vec3 b):. 
-00004f90: 2020 2020 2020 2073 656c 662e 7820 3d20         self.x = 
-00004fa0: 612e 782b 622e 780a 2020 2020 2020 2020  a.x+b.x.        
-00004fb0: 7365 6c66 2e79 203d 2061 2e79 2b62 2e79  self.y = a.y+b.y
-00004fc0: 0a20 2020 2020 2020 2073 656c 662e 7a20  .        self.z 
-00004fd0: 3d20 612e 7a2b 622e 7a0a 2020 2020 2020  = a.z+b.z.      
-00004fe0: 2020 7265 7475 726e 2073 656c 660a 0a20    return self.. 
-00004ff0: 2020 2064 6566 2066 6e6f 726d 616c 697a     def fnormaliz
-00005000: 6528 7365 6c66 2c20 7665 6333 2061 293a  e(self, vec3 a):
-00005010: 0a20 2020 2020 2020 2022 2222 4e6f 726d  .        """Norm
-00005020: 616c 697a 6520 7665 6374 6f72 2061 2061  alize vector a a
-00005030: 6e64 2073 746f 7265 2072 6573 756c 7420  nd store result 
-00005040: 696e 2073 656c 662e 0a20 2020 2020 2020  in self..       
-00005050: 2022 2222 0a20 2020 2020 2020 2063 6465   """.        cde
-00005060: 6620 646f 7562 6c65 206e 6c65 6e0a 0a20  f double nlen.. 
-00005070: 2020 2020 2020 206e 6c65 6e20 3d20 7371         nlen = sq
-00005080: 7274 2861 2e78 2a61 2e78 202b 2061 2e79  rt(a.x*a.x + a.y
-00005090: 2a61 2e79 202b 2061 2e7a 2a61 2e7a 290a  *a.y + a.z*a.z).
-000050a0: 2020 2020 2020 2020 6966 206e 6c65 6e3c          if nlen<
-000050b0: 3d65 7073 3a0a 2020 2020 2020 2020 2020  =eps:.          
-000050c0: 2020 7261 6973 6520 5a65 726f 4469 7669    raise ZeroDivi
-000050d0: 7369 6f6e 4572 726f 722c 226e 756c 6c20  sionError,"null 
-000050e0: 7665 6374 6f72 2063 616e 2774 2062 6520  vector can't be 
-000050f0: 6e6f 726d 616c 697a 6564 220a 2020 2020  normalized".    
-00005100: 2020 2020 6e6c 656e 203d 2031 2e30 2f6e      nlen = 1.0/n
-00005110: 6c65 6e0a 2020 2020 2020 2020 7365 6c66  len.        self
-00005120: 2e78 203d 2061 2e78 2a6e 6c65 6e0a 2020  .x = a.x*nlen.  
-00005130: 2020 2020 2020 7365 6c66 2e79 203d 2061        self.y = a
-00005140: 2e79 2a6e 6c65 6e0a 2020 2020 2020 2020  .y*nlen.        
-00005150: 7365 6c66 2e7a 203d 2061 2e7a 2a6e 6c65  self.z = a.z*nle
-00005160: 6e0a 2020 2020 2020 2020 7265 7475 726e  n.        return
-00005170: 2073 656c 660a 0a23 2323 2323 2323 2323   self..#########
-00005180: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00005190: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00000580: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00000590: 2323 230a 0a0a 2320 7665 6333 6974 6572  ###...# vec3iter
+000005a0: 0a63 6465 6620 636c 6173 7320 7665 6333  .cdef class vec3
+000005b0: 6974 6572 3a0a 2020 2020 2222 2276 6563  iter:.    """vec
+000005c0: 3320 6974 6572 6174 6f72 2e22 2222 0a20  3 iterator.""". 
+000005d0: 2020 2063 6465 6620 696e 7420 6964 780a     cdef int idx.
+000005e0: 2020 2020 6364 6566 206f 626a 6563 7420      cdef object 
+000005f0: 760a 0a20 2020 2064 6566 205f 5f63 696e  v..    def __cin
+00000600: 6974 5f5f 2873 656c 662c 2076 293a 0a20  it__(self, v):. 
+00000610: 2020 2020 2020 2073 656c 662e 6964 7820         self.idx 
+00000620: 3d20 300a 2020 2020 2020 2020 7365 6c66  = 0.        self
+00000630: 2e76 2020 203d 2076 0a0a 2020 2020 6465  .v   = v..    de
+00000640: 6620 5f5f 6974 6572 5f5f 2873 656c 6629  f __iter__(self)
+00000650: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+00000660: 2073 656c 660a 0a20 2020 2064 6566 205f   self..    def _
+00000670: 5f6e 6578 745f 5f28 7365 6c66 293a 0a20  _next__(self):. 
+00000680: 2020 2020 2020 2069 6620 7365 6c66 2e69         if self.i
+00000690: 6478 3d3d 303a 0a20 2020 2020 2020 2020  dx==0:.         
+000006a0: 2020 2073 656c 662e 6964 783d 310a 2020     self.idx=1.  
+000006b0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+000006c0: 2073 656c 662e 762e 780a 2020 2020 2020   self.v.x.      
+000006d0: 2020 656c 6966 2073 656c 662e 6964 783d    elif self.idx=
+000006e0: 3d31 3a0a 2020 2020 2020 2020 2020 2020  =1:.            
+000006f0: 7365 6c66 2e69 6478 3d32 0a20 2020 2020  self.idx=2.     
+00000700: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00000710: 6c66 2e76 2e79 0a20 2020 2020 2020 2065  lf.v.y.        e
+00000720: 6c69 6620 7365 6c66 2e69 6478 3d3d 323a  lif self.idx==2:
+00000730: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00000740: 662e 6964 783d 330a 2020 2020 2020 2020  f.idx=3.        
+00000750: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+00000760: 762e 7a0a 2020 2020 2020 2020 656c 7365  v.z.        else
+00000770: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+00000780: 6973 6520 5374 6f70 4974 6572 6174 696f  ise StopIteratio
+00000790: 6e0a 0a0a 2320 7665 6333 0a63 6465 6620  n...# vec3.cdef 
+000007a0: 636c 6173 7320 7665 6333 3a0a 2020 2020  class vec3:.    
+000007b0: 2222 2254 6872 6565 2d64 696d 656e 7369  """Three-dimensi
+000007c0: 6f6e 616c 2076 6563 746f 722e 0a0a 2020  onal vector...  
+000007d0: 2020 5468 6973 2063 6c61 7373 2063 616e    This class can
+000007e0: 2062 6520 7573 6564 2074 6f20 7265 7072   be used to repr
+000007f0: 6573 656e 7420 706f 696e 7473 2c20 7665  esent points, ve
+00000800: 6374 6f72 732c 206e 6f72 6d61 6c73 0a20  ctors, normals. 
+00000810: 2020 206f 7220 6576 656e 2063 6f6c 6f72     or even color
+00000820: 732e 2054 6865 2075 7375 616c 2076 6563  s. The usual vec
+00000830: 746f 7220 6f70 6572 6174 696f 6e73 2061  tor operations a
+00000840: 7265 2061 7661 696c 6162 6c65 2e0a 0a20  re available... 
+00000850: 2020 2043 6f6d 7061 7269 736f 6e73 2061     Comparisons a
+00000860: 7265 2064 6f6e 6520 7769 7468 696e 2061  re done within a
+00000870: 6e20 6570 7369 6c6f 6e20 656e 7669 726f  n epsilon enviro
+00000880: 6e6d 656e 742e 0a20 2020 2022 2222 0a0a  nment..    """..
+00000890: 2020 2020 6364 6566 2064 6f75 626c 6520      cdef double 
+000008a0: 782c 792c 7a0a 0a20 2020 2064 6566 205f  x,y,z..    def _
+000008b0: 5f63 696e 6974 5f5f 2873 656c 662c 202a  _cinit__(self, *
+000008c0: 6172 6773 293a 0a20 2020 2020 2020 2022  args):.        "
+000008d0: 2222 436f 6e73 7472 7563 746f 722e 0a0a  ""Constructor...
+000008e0: 2020 2020 2020 2020 5468 6572 6520 6172          There ar
+000008f0: 6520 7365 7665 7261 6c20 706f 7373 6962  e several possib
+00000900: 696c 6974 6965 7320 686f 7720 746f 2069  ilities how to i
+00000910: 6e69 7469 616c 697a 6520 6120 7665 6374  nitialize a vect
+00000920: 6f72 3a0a 0a20 2020 2020 2020 2076 203d  or:..        v =
+00000930: 2076 6563 3328 2920 2020 2020 2020 2d3e   vec3()       ->
+00000940: 2076 203d 203c 302c 302c 303e 0a20 2020   v = <0,0,0>.   
+00000950: 2020 2020 2076 203d 2076 6563 3328 6129       v = vec3(a)
+00000960: 2020 2020 2020 2d3e 2076 203d 203c 612c        -> v = <a,
+00000970: 612c 613e 0a20 2020 2020 2020 2076 203d  a,a>.        v =
+00000980: 2076 6563 3328 782c 7929 2020 2020 2d3e   vec3(x,y)    ->
+00000990: 2076 203d 203c 782c 792c 303e 0a20 2020   v = <x,y,0>.   
+000009a0: 2020 2020 2076 203d 2076 6563 3328 782c       v = vec3(x,
+000009b0: 792c 7a29 2020 2d3e 2076 203d 203c 782c  y,z)  -> v = <x,
+000009c0: 792c 7a3e 0a20 2020 2020 2020 2077 203d  y,z>.        w =
+000009d0: 2076 6563 3328 7629 2020 2020 2020 2d3e   vec3(v)      ->
+000009e0: 2077 203d 203c 782c 792c 7a3e 0a0a 2020   w = <x,y,z>..  
+000009f0: 2020 2020 2020 4e6f 7465 2074 6861 7420        Note that 
+00000a00: 7370 6563 6966 7969 6e67 206a 7573 7420  specifying just 
+00000a10: 6f6e 6520 7661 6c75 6520 7365 7473 2061  one value sets a
+00000a20: 6c6c 2074 6872 6565 2063 6f6d 706f 6e65  ll three compone
+00000a30: 6e74 7320 746f 0a20 2020 2020 2020 2074  nts to.        t
+00000a40: 6861 7420 7661 6c75 6520 2865 7863 6570  hat value (excep
+00000a50: 7420 7768 656e 2074 6861 7420 7369 6e67  t when that sing
+00000a60: 6c65 2076 616c 7565 2069 7320 6120 616e  le value is a an
+00000a70: 6f74 6865 7220 7665 6333 2c20 7468 656e  other vec3, then
+00000a80: 0a20 2020 2020 2020 2074 6861 7420 7665  .        that ve
+00000a90: 6374 6f72 2069 7320 636f 7069 6564 292e  ctor is copied).
+00000aa0: 0a0a 2020 2020 2020 2020 4164 6469 7469  ..        Additi
+00000ab0: 6f6e 616c 6c79 2079 6f75 2063 616e 2077  onally you can w
+00000ac0: 7261 7020 7468 6f73 6520 7661 6c75 6573  rap those values
+00000ad0: 2069 6e20 6120 6c69 7374 206f 7220 6120   in a list or a 
+00000ae0: 7475 706c 6520 6f72 0a20 2020 2020 2020  tuple or.       
+00000af0: 2073 7065 6369 6679 2074 6865 6d20 6173   specify them as
+00000b00: 2061 2073 7472 696e 673a 0a0a 2020 2020   a string:..    
+00000b10: 2020 2020 7620 3d20 7665 6333 285b 312c      v = vec3([1,
+00000b20: 322c 335d 2920 2d3e 2076 203d 203c 312c  2,3]) -> v = <1,
+00000b30: 322c 333e 0a20 2020 2020 2020 2076 203d  2,3>.        v =
+00000b40: 2076 6563 3328 2234 2c35 2229 2020 202d   vec3("4,5")   -
+00000b50: 3e20 7620 3d20 3c34 2c35 2c30 3e0a 2020  > v = <4,5,0>.  
+00000b60: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00000b70: 2020 6364 6566 2069 6e74 2061 7267 6c65    cdef int argle
+00000b80: 6e2c 2073 6571 6c65 6e0a 2020 2020 2020  n, seqlen.      
+00000b90: 2020 6364 6566 2076 6563 3320 760a 2020    cdef vec3 v.  
+00000ba0: 2020 2020 2020 6172 676c 656e 203d 206c        arglen = l
+00000bb0: 656e 2861 7267 7329 0a0a 2020 2020 2020  en(args)..      
+00000bc0: 2020 6966 2061 7267 6c65 6e3d 3d30 3a0a    if arglen==0:.
+00000bd0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00000be0: 2e78 203d 2030 2e30 0a20 2020 2020 2020  .x = 0.0.       
+00000bf0: 2020 2020 2073 656c 662e 7920 3d20 302e       self.y = 0.
+00000c00: 300a 2020 2020 2020 2020 2020 2020 7365  0.            se
+00000c10: 6c66 2e7a 203d 2030 2e30 0a20 2020 2020  lf.z = 0.0.     
+00000c20: 2020 2065 6c69 6620 6172 676c 656e 3d3d     elif arglen==
+00000c30: 313a 0a20 2020 2020 2020 2020 2020 2054  1:.            T
+00000c40: 203d 2074 7970 6528 6172 6773 5b30 5d29   = type(args[0])
+00000c50: 0a20 2020 2020 2020 2020 2020 2023 2073  .            # s
+00000c60: 6361 6c61 720a 2020 2020 2020 2020 2020  calar.          
+00000c70: 2020 6966 2054 2069 7320 666c 6f61 7420    if T is float 
+00000c80: 6f72 2054 2069 7320 696e 7420 6f72 2054  or T is int or T
+00000c90: 2069 7320 6c6f 6e67 3a0a 2020 2020 2020   is long:.      
+00000ca0: 2020 2020 2020 2020 2020 7365 6c66 2e78            self.x
+00000cb0: 203d 2061 7267 735b 305d 0a20 2020 2020   = args[0].     
+00000cc0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00000cd0: 7920 3d20 7365 6c66 2e78 0a20 2020 2020  y = self.x.     
+00000ce0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00000cf0: 7a20 3d20 7365 6c66 2e78 0a20 2020 2020  z = self.x.     
+00000d00: 2020 2020 2020 2023 2076 6563 330a 2020         # vec3.  
+00000d10: 2020 2020 2020 2020 2020 656c 6966 2054            elif T
+00000d20: 2069 7320 7665 6333 3a0a 2020 2020 2020   is vec3:.      
+00000d30: 2020 2020 2020 2020 2020 7620 3d20 6172            v = ar
+00000d40: 6773 5b30 5d0a 2020 2020 2020 2020 2020  gs[0].          
+00000d50: 2020 2020 2020 7365 6c66 2e78 203d 2076        self.x = v
+00000d60: 2e78 0a20 2020 2020 2020 2020 2020 2020  .x.             
+00000d70: 2020 2073 656c 662e 7920 3d20 762e 790a     self.y = v.y.
+00000d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000d90: 7365 6c66 2e7a 203d 2076 2e7a 0a20 2020  self.z = v.z.   
+00000da0: 2020 2020 2020 2020 2023 2053 7472 696e           # Strin
+00000db0: 670a 2020 2020 2020 2020 2020 2020 656c  g.            el
+00000dc0: 6966 2054 2069 7320 7374 7220 6f72 2054  if T is str or T
+00000dd0: 2069 7320 756e 6963 6f64 653a 0a20 2020   is unicode:.   
+00000de0: 2020 2020 2020 2020 2020 2020 2073 3d61               s=a
+00000df0: 7267 735b 305d 2e72 6570 6c61 6365 2822  rgs[0].replace("
+00000e00: 2c22 2c22 2022 292e 7265 706c 6163 6528  ,"," ").replace(
+00000e10: 2220 2022 2c22 2022 292e 7374 7269 7028  "  "," ").strip(
+00000e20: 292e 7370 6c69 7428 2220 2229 0a20 2020  ).split(" ").   
+00000e30: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00000e40: 733d 3d5b 2222 5d3a 0a20 2020 2020 2020  s==[""]:.       
+00000e50: 2020 2020 2020 2020 2020 2020 2073 3d5b               s=[
+00000e60: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+00000e70: 2020 666f 7220 6920 696e 2072 616e 6765    for i in range
+00000e80: 286c 656e 2873 2929 3a0a 2020 2020 2020  (len(s)):.      
+00000e90: 2020 2020 2020 2020 2020 2020 2020 7472                tr
+00000ea0: 793a 0a20 2020 2020 2020 2020 2020 2020  y:.             
+00000eb0: 2020 2020 2020 2020 2020 2073 5b69 5d20             s[i] 
+00000ec0: 3d20 666c 6f61 7428 735b 695d 290a 2020  = float(s[i]).  
+00000ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000ee0: 2020 6578 6365 7074 3a0a 2020 2020 2020    except:.      
+00000ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000f00: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+00000f10: 6f72 2c22 7665 6333 2829 2061 7267 2069  or,"vec3() arg i
+00000f20: 7320 6120 6d61 6c66 6f72 6d65 6420 7374  s a malformed st
+00000f30: 7269 6e67 220a 2020 2020 2020 2020 2020  ring".          
+00000f40: 2020 2020 2020 7620 3d20 7665 6333 2873        v = vec3(s
+00000f50: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00000f60: 2020 7365 6c66 2e78 203d 2076 2e78 0a20    self.x = v.x. 
+00000f70: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00000f80: 656c 662e 7920 3d20 762e 790a 2020 2020  elf.y = v.y.    
+00000f90: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00000fa0: 2e7a 203d 2076 2e7a 0a20 2020 2020 2020  .z = v.z.       
+00000fb0: 2020 2020 2023 2053 6571 7565 6e63 6520       # Sequence 
+00000fc0: 6f66 2066 6c6f 6174 730a 2020 2020 2020  of floats.      
+00000fd0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00000fe0: 2020 2020 2020 2020 2020 2020 7365 7120              seq 
+00000ff0: 3d20 6172 6773 5b30 5d0a 2020 2020 2020  = args[0].      
+00001000: 2020 2020 2020 2020 2020 7472 793a 0a20            try:. 
+00001010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001020: 2020 2073 6571 6c65 6e20 3d20 6c65 6e28     seqlen = len(
+00001030: 7365 7129 0a20 2020 2020 2020 2020 2020  seq).           
+00001040: 2020 2020 2065 7863 6570 743a 0a20 2020       except:.   
+00001050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001060: 2072 6169 7365 2054 7970 6545 7272 6f72   raise TypeError
+00001070: 2c22 7665 6333 2829 2061 7267 2063 616e  ,"vec3() arg can
+00001080: 2774 2062 6520 636f 6e76 6572 7465 6420  't be converted 
+00001090: 746f 2076 6563 3322 0a0a 2020 2020 2020  to vec3"..      
+000010a0: 2020 2020 2020 2020 2020 6966 2073 6571            if seq
+000010b0: 6c65 6e3d 3d33 3a0a 2020 2020 2020 2020  len==3:.        
+000010c0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000010d0: 2e78 203d 2073 6571 5b30 5d0a 2020 2020  .x = seq[0].    
+000010e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000010f0: 7365 6c66 2e79 203d 2073 6571 5b31 5d0a  self.y = seq[1].
+00001100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001110: 2020 2020 7365 6c66 2e7a 203d 2073 6571      self.z = seq
+00001120: 5b32 5d0a 2020 2020 2020 2020 2020 2020  [2].            
+00001130: 2020 2020 656c 6966 2073 6571 6c65 6e3d      elif seqlen=
+00001140: 3d32 3a0a 2020 2020 2020 2020 2020 2020  =2:.            
+00001150: 2020 2020 2020 2020 7365 6c66 2e78 203d          self.x =
+00001160: 2073 6571 5b30 5d0a 2020 2020 2020 2020   seq[0].        
+00001170: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00001180: 2e79 203d 2073 6571 5b31 5d0a 2020 2020  .y = seq[1].    
+00001190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000011a0: 7365 6c66 2e7a 203d 2030 2e30 0a20 2020  self.z = 0.0.   
+000011b0: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
+000011c0: 6620 7365 716c 656e 3d3d 313a 0a20 2020  f seqlen==1:.   
+000011d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000011e0: 2073 656c 662e 7820 3d20 7365 715b 305d   self.x = seq[0]
+000011f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00001200: 2020 2020 2073 656c 662e 7920 3d20 7365       self.y = se
+00001210: 6c66 2e78 0a20 2020 2020 2020 2020 2020  lf.x.           
+00001220: 2020 2020 2020 2020 2073 656c 662e 7a20           self.z 
+00001230: 3d20 7365 6c66 2e78 0a20 2020 2020 2020  = self.x.       
+00001240: 2020 2020 2020 2020 2065 6c69 6620 7365           elif se
+00001250: 716c 656e 3d3d 303a 0a20 2020 2020 2020  qlen==0:.       
+00001260: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00001270: 662e 7820 3d20 302e 300a 2020 2020 2020  f.x = 0.0.      
+00001280: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00001290: 6c66 2e79 203d 2030 2e30 0a20 2020 2020  lf.y = 0.0.     
+000012a0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+000012b0: 656c 662e 7a20 3d20 302e 300a 2020 2020  elf.z = 0.0.    
+000012c0: 2020 2020 2020 2020 2020 2020 656c 7365              else
+000012d0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000012e0: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
+000012f0: 4572 726f 722c 2022 7665 6333 2829 2074  Error, "vec3() t
+00001300: 616b 6573 2061 7420 6d6f 7374 2033 2061  akes at most 3 a
+00001310: 7267 756d 656e 7473 220a 0a20 2020 2020  rguments"..     
+00001320: 2020 2065 6c69 6620 6172 676c 656e 3d3d     elif arglen==
+00001330: 323a 0a20 2020 2020 2020 2020 2020 2073  2:.            s
+00001340: 656c 662e 7820 3d20 6172 6773 5b30 5d0a  elf.x = args[0].
+00001350: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00001360: 2e79 203d 2061 7267 735b 315d 0a20 2020  .y = args[1].   
+00001370: 2020 2020 2020 2020 2073 656c 662e 7a20           self.z 
+00001380: 3d20 302e 300a 0a20 2020 2020 2020 2065  = 0.0..        e
+00001390: 6c69 6620 6172 676c 656e 3d3d 333a 0a20  lif arglen==3:. 
+000013a0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000013b0: 7820 3d20 6172 6773 5b30 5d0a 2020 2020  x = args[0].    
+000013c0: 2020 2020 2020 2020 7365 6c66 2e79 203d          self.y =
+000013d0: 2061 7267 735b 315d 0a20 2020 2020 2020   args[1].       
+000013e0: 2020 2020 2073 656c 662e 7a20 3d20 6172       self.z = ar
+000013f0: 6773 5b32 5d0a 0a20 2020 2020 2020 2065  gs[2]..        e
+00001400: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00001410: 2072 6169 7365 2054 7970 6545 7272 6f72   raise TypeError
+00001420: 2c20 2276 6563 3328 2920 7461 6b65 7320  , "vec3() takes 
+00001430: 6174 206d 6f73 7420 3320 6172 6775 6d65  at most 3 argume
+00001440: 6e74 7322 0a0a 2020 2020 6465 6620 5f5f  nts"..    def __
+00001450: 7265 6475 6365 5f5f 2873 656c 6629 3a0a  reduce__(self):.
+00001460: 2020 2020 2020 2020 7265 7475 726e 2028          return (
+00001470: 5f76 6563 3363 6f6e 7374 7275 6374 2c20  _vec3construct, 
+00001480: 2873 656c 662e 782c 2073 656c 662e 792c  (self.x, self.y,
+00001490: 2073 656c 662e 7a29 290a 0a20 2020 2064   self.z))..    d
+000014a0: 6566 205f 5f72 6570 725f 5f28 7365 6c66  ef __repr__(self
+000014b0: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+000014c0: 6e20 2776 6563 3328 2573 2c20 2573 2c20  n 'vec3(%s, %s, 
+000014d0: 2573 2927 2528 7265 7072 2873 656c 662e  %s)'%(repr(self.
+000014e0: 7829 2c72 6570 7228 7365 6c66 2e79 292c  x),repr(self.y),
+000014f0: 7265 7072 2873 656c 662e 7a29 290a 0a20  repr(self.z)).. 
+00001500: 2020 2064 6566 205f 5f73 7472 5f5f 2873     def __str__(s
+00001510: 656c 6629 3a0a 2020 2020 2020 2020 7265  elf):.        re
+00001520: 7475 726e 2022 2825 312e 3466 2c20 2531  turn "(%1.4f, %1
+00001530: 2e34 662c 2025 312e 3466 2922 2528 7365  .4f, %1.4f)"%(se
+00001540: 6c66 2e78 2c20 7365 6c66 2e79 2c20 7365  lf.x, self.y, se
+00001550: 6c66 2e7a 290a 0a20 2020 2064 6566 205f  lf.z)..    def _
+00001560: 5f69 7465 725f 5f28 7365 6c66 293a 0a20  _iter__(self):. 
+00001570: 2020 2020 2020 2072 6574 7572 6e20 7665         return ve
+00001580: 6333 6974 6572 2873 656c 6629 0a0a 2020  c3iter(self)..  
+00001590: 2020 6465 6620 5f5f 7269 6368 636d 705f    def __richcmp_
+000015a0: 5f28 612c 622c 6f70 293a 0a20 2020 2020  _(a,b,op):.     
+000015b0: 2020 2063 6465 6620 7665 6333 2076 612c     cdef vec3 va,
+000015c0: 2076 620a 2020 2020 2020 2020 6364 6566   vb.        cdef
+000015d0: 2069 6e74 2063 6f70 0a0a 2020 2020 2020   int cop..      
+000015e0: 2020 636f 7020 3d20 6f70 0a0a 2020 2020    cop = op..    
+000015f0: 2020 2020 7461 203d 2074 7970 6528 6129      ta = type(a)
+00001600: 0a20 2020 2020 2020 2074 6220 3d20 7479  .        tb = ty
+00001610: 7065 2862 290a 2020 2020 2020 2020 6966  pe(b).        if
+00001620: 2028 7461 213d 7665 6333 206f 7220 7462   (ta!=vec3 or tb
+00001630: 213d 7665 6333 293a 0a20 2020 2020 2020  !=vec3):.       
+00001640: 2020 2020 2069 6620 636f 703d 3d33 3a0a       if cop==3:.
+00001650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001660: 7265 7475 726e 2031 0a20 2020 2020 2020  return 1.       
+00001670: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00001680: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00001690: 6e20 300a 0a20 2020 2020 2020 2076 6120  n 0..        va 
+000016a0: 3d20 610a 2020 2020 2020 2020 7662 203d  = a.        vb =
+000016b0: 2062 0a0a 2020 2020 2020 2020 2320 3c0a   b..        # <.
+000016c0: 2020 2020 2020 2020 6966 2063 6f70 3d3d          if cop==
+000016d0: 303a 0a20 2020 2020 2020 2020 2020 2072  0:.            r
+000016e0: 6574 7572 6e20 2876 612e 783c 7662 2e78  eturn (va.x<vb.x
+000016f0: 2061 6e64 2076 612e 793c 7662 2e79 2061   and va.y<vb.y a
+00001700: 6e64 2076 612e 7a3c 7662 2e7a 290a 2020  nd va.z<vb.z).  
+00001710: 2020 2020 2020 2320 3c3d 0a20 2020 2020        # <=.     
+00001720: 2020 2065 6c69 6620 636f 703d 3d31 3a0a     elif cop==1:.
+00001730: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00001740: 726e 2028 7661 2e78 2d65 7073 3c3d 7662  rn (va.x-eps<=vb
+00001750: 2e78 2061 6e64 2076 612e 792d 6570 733c  .x and va.y-eps<
+00001760: 3d76 622e 7920 616e 6420 7661 2e7a 2d65  =vb.y and va.z-e
+00001770: 7073 3c3d 7662 2e7a 290a 2020 2020 2020  ps<=vb.z).      
+00001780: 2020 2320 3d3d 0a20 2020 2020 2020 2065    # ==.        e
+00001790: 6c69 6620 636f 703d 3d32 3a0a 2320 2020  lif cop==2:.#   
+000017a0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+000017b0: 2876 612e 783d 3d76 622e 7820 616e 6420  (va.x==vb.x and 
+000017c0: 7661 2e79 3d3d 7662 2e79 2061 6e64 2076  va.y==vb.y and v
+000017d0: 612e 7a3d 3d76 622e 7a29 0a20 2020 2020  a.z==vb.z).     
+000017e0: 2020 2020 2020 2072 6574 7572 6e20 2866         return (f
+000017f0: 6162 7328 7661 2e78 2d76 622e 7829 3c3d  abs(va.x-vb.x)<=
+00001800: 6570 7320 616e 6420 6661 6273 2876 612e  eps and fabs(va.
+00001810: 792d 7662 2e79 293c 3d65 7073 2061 6e64  y-vb.y)<=eps and
+00001820: 2066 6162 7328 7661 2e7a 2d76 622e 7a29   fabs(va.z-vb.z)
+00001830: 3c3d 6570 7329 0a20 2020 2020 2020 2023  <=eps).        #
+00001840: 2021 3d0a 2020 2020 2020 2020 656c 6966   !=.        elif
+00001850: 2063 6f70 3d3d 333a 0a23 2020 2020 2020   cop==3:.#      
+00001860: 2020 2020 2020 7265 7475 726e 2028 7661        return (va
+00001870: 2e78 213d 7662 2e78 206f 7220 7661 2e79  .x!=vb.x or va.y
+00001880: 213d 7662 2e79 206f 7220 7661 2e7a 213d  !=vb.y or va.z!=
+00001890: 7662 2e7a 290a 2020 2020 2020 2020 2020  vb.z).          
+000018a0: 2020 7265 7475 726e 2028 6661 6273 2876    return (fabs(v
+000018b0: 612e 782d 7662 2e78 293e 6570 7320 6f72  a.x-vb.x)>eps or
+000018c0: 2066 6162 7328 7661 2e79 2d76 622e 7929   fabs(va.y-vb.y)
+000018d0: 3e65 7073 2061 6e64 2066 6162 7328 7661  >eps and fabs(va
+000018e0: 2e7a 2d76 622e 7a29 3e65 7073 290a 2020  .z-vb.z)>eps).  
+000018f0: 2020 2020 2020 2320 3e0a 2020 2020 2020        # >.      
+00001900: 2020 656c 6966 2063 6f70 3d3d 343a 0a20    elif cop==4:. 
+00001910: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00001920: 6e20 2876 612e 783e 7662 2e78 2061 6e64  n (va.x>vb.x and
+00001930: 2076 612e 793e 7662 2e79 2061 6e64 2076   va.y>vb.y and v
+00001940: 612e 7a3e 7662 2e7a 290a 2020 2020 2020  a.z>vb.z).      
+00001950: 2020 2320 3e3d 0a20 2020 2020 2020 2065    # >=.        e
+00001960: 6c69 6620 636f 703d 3d35 3a0a 2020 2020  lif cop==5:.    
+00001970: 2020 2020 2020 2020 7265 7475 726e 2028          return (
+00001980: 7661 2e78 2b65 7073 3e3d 7662 2e78 2061  va.x+eps>=vb.x a
+00001990: 6e64 2076 612e 792b 6570 733e 3d76 622e  nd va.y+eps>=vb.
+000019a0: 7920 616e 6420 7661 2e7a 2b65 7073 3e3d  y and va.z+eps>=
+000019b0: 7662 2e7a 290a 2020 2020 2020 2020 2320  vb.z).        # 
+000019c0: 736f 6e73 7420 2846 6568 6c65 7229 0a20  sonst (Fehler). 
+000019d0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+000019e0: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+000019f0: 616c 7565 4572 726f 722c 2269 6e74 6572  alueError,"inter
+00001a00: 6e61 6c20 6572 726f 723a 2069 6c6c 6567  nal error: illeg
+00001a10: 616c 2072 6963 6820 636f 6d70 6172 6973  al rich comparis
+00001a20: 6f6e 206e 756d 6265 7222 0a0a 0a20 2020  on number"...   
+00001a30: 2064 6566 205f 5f61 6464 5f5f 2876 6563   def __add__(vec
+00001a40: 3320 612c 2076 6563 3320 6229 3a0a 2020  3 a, vec3 b):.  
+00001a50: 2020 2020 2020 2222 2256 6563 746f 7220        """Vector 
+00001a60: 6164 6469 7469 6f6e 2e0a 0a20 2020 2020  addition...     
+00001a70: 2020 203e 3e3e 2061 3d76 6563 3328 312e     >>> a=vec3(1.
+00001a80: 302c 2030 2e35 2c20 2d31 2e38 290a 2020  0, 0.5, -1.8).  
+00001a90: 2020 2020 2020 3e3e 3e20 623d 7665 6333        >>> b=vec3
+00001aa0: 282d 302e 332c 2030 2e37 352c 2030 2e35  (-0.3, 0.75, 0.5
+00001ab0: 290a 2020 2020 2020 2020 3e3e 3e20 7072  ).        >>> pr
+00001ac0: 696e 7428 612b 6229 0a20 2020 2020 2020  int(a+b).       
+00001ad0: 2028 302e 3730 3030 2c20 312e 3235 3030   (0.7000, 1.2500
+00001ae0: 2c20 2d31 2e33 3030 3029 0a20 2020 2020  , -1.3000).     
+00001af0: 2020 2022 2222 0a20 2020 2020 2020 2063     """.        c
+00001b00: 6465 6620 7665 6333 2072 6573 0a20 2020  def vec3 res.   
+00001b10: 2020 2020 2072 6573 203d 2076 6563 3328       res = vec3(
+00001b20: 290a 2020 2020 2020 2020 7265 732e 7820  ).        res.x 
+00001b30: 3d20 612e 782b 622e 780a 2020 2020 2020  = a.x+b.x.      
+00001b40: 2020 7265 732e 7920 3d20 612e 792b 622e    res.y = a.y+b.
+00001b50: 790a 2020 2020 2020 2020 7265 732e 7a20  y.        res.z 
+00001b60: 3d20 612e 7a2b 622e 7a0a 2020 2020 2020  = a.z+b.z.      
+00001b70: 2020 7265 7475 726e 2072 6573 0a0a 2020    return res..  
+00001b80: 2020 6465 6620 5f5f 7375 625f 5f28 7665    def __sub__(ve
+00001b90: 6333 2061 2c20 7665 6333 2062 293a 0a20  c3 a, vec3 b):. 
+00001ba0: 2020 2020 2020 2022 2222 5665 6374 6f72         """Vector
+00001bb0: 2073 7562 7472 6163 7469 6f6e 2e0a 0a20   subtraction... 
+00001bc0: 2020 2020 2020 203e 3e3e 2061 3d76 6563         >>> a=vec
+00001bd0: 3328 312e 302c 2030 2e35 2c20 2d31 2e38  3(1.0, 0.5, -1.8
+00001be0: 290a 2020 2020 2020 2020 3e3e 3e20 623d  ).        >>> b=
+00001bf0: 7665 6333 282d 302e 332c 2030 2e37 352c  vec3(-0.3, 0.75,
+00001c00: 2030 2e35 290a 2020 2020 2020 2020 3e3e   0.5).        >>
+00001c10: 3e20 7072 696e 7428 612d 6229 0a20 2020  > print(a-b).   
+00001c20: 2020 2020 2028 312e 3330 3030 2c20 2d30       (1.3000, -0
+00001c30: 2e32 3530 302c 202d 322e 3330 3030 290a  .2500, -2.3000).
+00001c40: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00001c50: 2020 2020 6364 6566 2076 6563 3320 7265      cdef vec3 re
+00001c60: 730a 2020 2020 2020 2020 7265 7320 3d20  s.        res = 
+00001c70: 7665 6333 2829 0a20 2020 2020 2020 2072  vec3().        r
+00001c80: 6573 2e78 203d 2061 2e78 2d62 2e78 0a20  es.x = a.x-b.x. 
+00001c90: 2020 2020 2020 2072 6573 2e79 203d 2061         res.y = a
+00001ca0: 2e79 2d62 2e79 0a20 2020 2020 2020 2072  .y-b.y.        r
+00001cb0: 6573 2e7a 203d 2061 2e7a 2d62 2e7a 0a20  es.z = a.z-b.z. 
+00001cc0: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
+00001cd0: 730a 0a20 2020 2064 6566 205f 5f6d 756c  s..    def __mul
+00001ce0: 5f5f 2861 2c20 6229 3a0a 2020 2020 2020  __(a, b):.      
+00001cf0: 2020 2222 224d 756c 7469 706c 6963 6174    """Multiplicat
+00001d00: 696f 6e20 7769 7468 2061 2073 6361 6c61  ion with a scala
+00001d10: 7220 6f72 2064 6f74 2070 726f 6475 6374  r or dot product
+00001d20: 2e0a 0a20 2020 2020 2020 203e 3e3e 2061  ...        >>> a
+00001d30: 3d76 6563 3328 312e 302c 2030 2e35 2c20  =vec3(1.0, 0.5, 
+00001d40: 2d31 2e38 290a 2020 2020 2020 2020 3e3e  -1.8).        >>
+00001d50: 3e20 623d 7665 6333 282d 302e 332c 2030  > b=vec3(-0.3, 0
+00001d60: 2e37 352c 2030 2e35 290a 2020 2020 2020  .75, 0.5).      
+00001d70: 2020 3e3e 3e20 7072 696e 7428 612a 322e    >>> print(a*2.
+00001d80: 3029 0a20 2020 2020 2020 2028 322e 3030  0).        (2.00
+00001d90: 3030 2c20 312e 3030 3030 2c20 2d33 2e36  00, 1.0000, -3.6
+00001da0: 3030 3029 0a20 2020 2020 2020 203e 3e3e  000).        >>>
+00001db0: 2070 7269 6e74 2832 2e30 2a61 290a 2020   print(2.0*a).  
+00001dc0: 2020 2020 2020 2832 2e30 3030 302c 2031        (2.0000, 1
+00001dd0: 2e30 3030 302c 202d 332e 3630 3030 290a  .0000, -3.6000).
+00001de0: 2020 2020 2020 2020 3e3e 3e20 7072 696e          >>> prin
+00001df0: 7428 612a 6229 0a20 2020 2020 2020 202d  t(a*b).        -
+00001e00: 302e 3832 350a 2020 2020 2020 2020 2222  0.825.        ""
+00001e10: 220a 2020 2020 2020 2020 6364 6566 2076  ".        cdef v
+00001e20: 6563 3320 7265 732c 2076 612c 2076 620a  ec3 res, va, vb.
+00001e30: 2020 2020 2020 2020 6364 6566 2064 6f75          cdef dou
+00001e40: 626c 6520 720a 0a20 2020 2020 2020 2074  ble r..        t
+00001e50: 6120 3d20 7479 7065 2861 290a 2020 2020  a = type(a).    
+00001e60: 2020 2020 7462 203d 2074 7970 6528 6229      tb = type(b)
+00001e70: 0a0a 2020 2020 2020 2020 6966 2074 6120  ..        if ta 
+00001e80: 6973 2076 6563 333a 0a20 2020 2020 2020  is vec3:.       
+00001e90: 2020 2020 2076 6120 3d20 610a 2020 2020       va = a.    
+00001ea0: 2020 2020 2020 2020 6966 2074 6220 6973          if tb is
+00001eb0: 2076 6563 333a 0a20 2020 2020 2020 2020   vec3:.         
+00001ec0: 2020 2020 2020 2023 2076 6563 332a 7665         # vec3*ve
+00001ed0: 6333 2020 2028 646f 7420 7072 6f64 7563  c3   (dot produc
+00001ee0: 7420 612a 6229 0a20 2020 2020 2020 2020  t a*b).         
+00001ef0: 2020 2020 2020 2076 6220 3d20 620a 2020         vb = b.  
+00001f00: 2020 2020 2020 2020 2020 2020 2020 7265                re
+00001f10: 7475 726e 2076 612e 782a 7662 2e78 202b  turn va.x*vb.x +
+00001f20: 2076 612e 792a 7662 2e79 202b 2076 612e   va.y*vb.y + va.
+00001f30: 7a2a 7662 2e7a 0a20 2020 2020 2020 2020  z*vb.z.         
+00001f40: 2020 2065 6c69 6620 7462 2069 7320 666c     elif tb is fl
+00001f50: 6f61 7420 6f72 2074 6220 6973 2069 6e74  oat or tb is int
+00001f60: 206f 7220 7462 2069 7320 6c6f 6e67 3a0a   or tb is long:.
+00001f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001f80: 2320 7665 6333 2a73 6361 6c61 720a 2020  # vec3*scalar.  
+00001f90: 2020 2020 2020 2020 2020 2020 2020 7265                re
+00001fa0: 7320 3d20 7665 6333 2829 0a20 2020 2020  s = vec3().     
+00001fb0: 2020 2020 2020 2020 2020 2072 2020 203d             r   =
+00001fc0: 2062 0a20 2020 2020 2020 2020 2020 2020   b.             
+00001fd0: 2020 2072 6573 2e78 203d 2076 612e 782a     res.x = va.x*
+00001fe0: 720a 2020 2020 2020 2020 2020 2020 2020  r.              
+00001ff0: 2020 7265 732e 7920 3d20 7661 2e79 2a72    res.y = va.y*r
+00002000: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00002010: 2072 6573 2e7a 203d 2076 612e 7a2a 720a   res.z = va.z*r.
+00002020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002030: 7265 7475 726e 2072 6573 0a20 2020 2020  return res.     
+00002040: 2020 2020 2020 2065 6c69 6620 7462 2069         elif tb i
+00002050: 7320 6d61 7433 3a0a 2020 2020 2020 2020  s mat3:.        
+00002060: 2020 2020 2020 2020 2320 7665 6333 2a6d          # vec3*m
+00002070: 6174 330a 2020 2020 2020 2020 2020 2020  at3.            
+00002080: 2020 2020 7265 7475 726e 2062 2e5f 5f72      return b.__r
+00002090: 6d75 6c5f 5f28 6129 0a20 2020 2020 2020  mul__(a).       
+000020a0: 2020 2020 2065 6c69 6620 7462 2069 7320       elif tb is 
+000020b0: 6d61 7434 3a0a 2020 2020 2020 2020 2020  mat4:.          
+000020c0: 2020 2020 2020 2320 7665 6333 2a6d 6174        # vec3*mat
+000020d0: 340a 2020 2020 2020 2020 2020 2020 2020  4.              
+000020e0: 2020 7265 7475 726e 2062 2e5f 5f72 6d75    return b.__rmu
+000020f0: 6c5f 5f28 6129 0a0a 2020 2020 2020 2020  l__(a)..        
+00002100: 656c 6966 2074 6120 6973 2066 6c6f 6174  elif ta is float
+00002110: 206f 7220 7461 2069 7320 696e 7420 6f72   or ta is int or
+00002120: 2074 6120 6973 206c 6f6e 673a 0a20 2020   ta is long:.   
+00002130: 2020 2020 2020 2020 2069 6620 7462 2069           if tb i
+00002140: 7320 7665 6333 3a0a 2020 2020 2020 2020  s vec3:.        
+00002150: 2020 2020 2020 2020 2320 7363 616c 6172          # scalar
+00002160: 2a76 6563 330a 2020 2020 2020 2020 2020  *vec3.          
+00002170: 2020 2020 2020 7265 7320 3d20 7665 6333        res = vec3
+00002180: 2829 0a20 2020 2020 2020 2020 2020 2020  ().             
+00002190: 2020 2076 6220 203d 2062 0a20 2020 2020     vb  = b.     
+000021a0: 2020 2020 2020 2020 2020 2072 2020 203d             r   =
+000021b0: 2061 0a20 2020 2020 2020 2020 2020 2020   a.             
+000021c0: 2020 2072 6573 2e78 203d 2072 2a76 622e     res.x = r*vb.
+000021d0: 780a 2020 2020 2020 2020 2020 2020 2020  x.              
+000021e0: 2020 7265 732e 7920 3d20 722a 7662 2e79    res.y = r*vb.y
+000021f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00002200: 2072 6573 2e7a 203d 2072 2a76 622e 7a0a   res.z = r*vb.z.
+00002210: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002220: 7265 7475 726e 2072 6573 0a0a 2020 2020  return res..    
+00002230: 2020 2020 7261 6973 6520 5479 7065 4572      raise TypeEr
+00002240: 726f 722c 2022 756e 7375 7070 6f72 7465  ror, "unsupporte
+00002250: 6420 6f70 6572 616e 6420 7479 7065 2066  d operand type f
+00002260: 6f72 202a 220a 0a20 2020 2064 6566 205f  or *"..    def _
+00002270: 5f64 6976 5f5f 2876 6563 3320 612c 2062  _div__(vec3 a, b
+00002280: 293a 0a20 2020 2020 2020 2023 2050 7974  ):.        # Pyt
+00002290: 686f 6e20 320a 2020 2020 2020 2020 7265  hon 2.        re
+000022a0: 7475 726e 2076 6563 332e 5f5f 7472 7565  turn vec3.__true
+000022b0: 6469 765f 5f28 612c 6229 0a0a 2020 2020  div__(a,b)..    
+000022c0: 6465 6620 5f5f 7472 7565 6469 765f 5f28  def __truediv__(
+000022d0: 7665 6333 2061 2c20 6229 3a0a 2020 2020  vec3 a, b):.    
+000022e0: 2020 2020 2222 2244 6976 6973 696f 6e20      """Division 
+000022f0: 6279 2073 6361 6c61 720a 0a20 2020 2020  by scalar..     
+00002300: 2020 203e 3e3e 2061 3d76 6563 3328 312e     >>> a=vec3(1.
+00002310: 302c 2030 2e35 2c20 2d31 2e38 290a 2020  0, 0.5, -1.8).  
+00002320: 2020 2020 2020 3e3e 3e20 7072 696e 7428        >>> print(
+00002330: 612f 322e 3029 0a20 2020 2020 2020 2028  a/2.0).        (
+00002340: 302e 3530 3030 2c20 302e 3235 3030 2c20  0.5000, 0.2500, 
+00002350: 2d30 2e39 3030 3029 0a20 2020 2020 2020  -0.9000).       
+00002360: 2022 2222 0a20 2020 2020 2020 2063 6465   """.        cde
+00002370: 6620 7665 6333 2072 6573 0a20 2020 2020  f vec3 res.     
+00002380: 2020 2063 6465 6620 646f 7562 6c65 2072     cdef double r
+00002390: 0a0a 2020 2020 2020 2020 7462 203d 2074  ..        tb = t
+000023a0: 7970 6528 6229 0a0a 2020 2020 2020 2020  ype(b)..        
+000023b0: 6966 2074 6220 6973 2066 6c6f 6174 206f  if tb is float o
+000023c0: 7220 7462 2069 7320 696e 7420 6f72 2074  r tb is int or t
+000023d0: 6220 6973 206c 6f6e 673a 0a20 2020 2020  b is long:.     
+000023e0: 2020 2020 2020 2023 2076 6563 332f 7363         # vec3/sc
+000023f0: 616c 6172 0a20 2020 2020 2020 2020 2020  alar.           
+00002400: 2072 6573 203d 2076 6563 3328 290a 2020   res = vec3().  
+00002410: 2020 2020 2020 2020 2020 7220 3d20 620a            r = b.
+00002420: 2020 2020 2020 2020 2020 2020 6966 2066              if f
+00002430: 6162 7328 7229 3c3d 6570 733a 0a20 2020  abs(r)<=eps:.   
+00002440: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+00002450: 7365 205a 6572 6f44 6976 6973 696f 6e45  se ZeroDivisionE
+00002460: 7272 6f72 2c22 7665 6333 2064 6976 6973  rror,"vec3 divis
+00002470: 696f 6e22 0a20 2020 2020 2020 2020 2020  ion".           
+00002480: 2072 6573 2e78 203d 2061 2e78 2f72 0a20   res.x = a.x/r. 
+00002490: 2020 2020 2020 2020 2020 2072 6573 2e79             res.y
+000024a0: 203d 2061 2e79 2f72 0a20 2020 2020 2020   = a.y/r.       
+000024b0: 2020 2020 2072 6573 2e7a 203d 2061 2e7a       res.z = a.z
+000024c0: 2f72 0a20 2020 2020 2020 2020 2020 2072  /r.            r
+000024d0: 6574 7572 6e20 7265 730a 2020 2020 2020  eturn res.      
+000024e0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+000024f0: 2020 2020 7261 6973 6520 5479 7065 4572      raise TypeEr
+00002500: 726f 722c 2022 756e 7375 7070 6f72 7465  ror, "unsupporte
+00002510: 6420 6f70 6572 616e 6420 7479 7065 2066  d operand type f
+00002520: 6f72 202f 220a 0a20 2020 2064 6566 205f  or /"..    def _
+00002530: 5f6d 6f64 5f5f 2876 6563 3320 7365 6c66  _mod__(vec3 self
+00002540: 2c20 6229 3a0a 2020 2020 2020 2020 2222  , b):.        ""
+00002550: 224d 6f64 756c 6f20 2863 6f6d 706f 6e65  "Modulo (compone
+00002560: 6e74 2077 6973 6529 2e0a 0a20 2020 2020  nt wise)...     
+00002570: 2020 203e 3e3e 2061 3d76 6563 3328 332e     >>> a=vec3(3.
+00002580: 302c 2032 2e35 2c20 2d31 2e38 290a 2020  0, 2.5, -1.8).  
+00002590: 2020 2020 2020 3e3e 3e20 7072 696e 7428        >>> print(
+000025a0: 6125 322e 3029 0a20 2020 2020 2020 2028  a%2.0).        (
+000025b0: 312e 3030 3030 2c20 302e 3530 3030 2c20  1.0000, 0.5000, 
+000025c0: 302e 3230 3030 290a 2020 2020 2020 2020  0.2000).        
+000025d0: 2222 220a 2020 2020 2020 2020 6364 6566  """.        cdef
+000025e0: 2076 6563 3320 7265 732c 2076 620a 2020   vec3 res, vb.  
+000025f0: 2020 2020 2020 6364 6566 2064 6f75 626c        cdef doubl
+00002600: 6520 720a 0a20 2020 2020 2020 2074 6220  e r..        tb 
+00002610: 3d20 7479 7065 2862 290a 0a20 2020 2020  = type(b)..     
+00002620: 2020 2069 6620 7462 2069 7320 666c 6f61     if tb is floa
+00002630: 7420 6f72 2074 6220 6973 2069 6e74 206f  t or tb is int o
+00002640: 7220 7462 2069 7320 6c6f 6e67 3a0a 2020  r tb is long:.  
+00002650: 2020 2020 2020 2020 2020 2320 7665 6333            # vec3
+00002660: 2573 6361 6c61 720a 2020 2020 2020 2020  %scalar.        
+00002670: 2020 2020 7265 7320 3d20 7665 6333 2829      res = vec3()
+00002680: 0a20 2020 2020 2020 2020 2020 2072 203d  .            r =
+00002690: 2062 0a20 2020 2020 2020 2020 2020 2069   b.            i
+000026a0: 6620 6661 6273 2872 293c 3d65 7073 3a0a  f fabs(r)<=eps:.
+000026b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000026c0: 7261 6973 6520 5a65 726f 4469 7669 7369  raise ZeroDivisi
+000026d0: 6f6e 4572 726f 722c 2276 6563 3320 6d6f  onError,"vec3 mo
+000026e0: 6475 6c6f 220a 2020 2020 2020 2020 2020  dulo".          
+000026f0: 2020 7265 732e 7820 3d20 5f66 6d6f 6428    res.x = _fmod(
+00002700: 7365 6c66 2e78 2c72 290a 2020 2020 2020  self.x,r).      
+00002710: 2020 2020 2020 7265 732e 7920 3d20 5f66        res.y = _f
+00002720: 6d6f 6428 7365 6c66 2e79 2c72 290a 2020  mod(self.y,r).  
+00002730: 2020 2020 2020 2020 2020 7265 732e 7a20            res.z 
+00002740: 3d20 5f66 6d6f 6428 7365 6c66 2e7a 2c72  = _fmod(self.z,r
+00002750: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
+00002760: 7475 726e 2072 6573 0a20 2020 2020 2020  turn res.       
+00002770: 2065 6c69 6620 7462 2069 7320 7665 6333   elif tb is vec3
+00002780: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
+00002790: 7665 6333 2576 6563 330a 2020 2020 2020  vec3%vec3.      
+000027a0: 2020 2020 2020 7265 7320 3d20 7665 6333        res = vec3
+000027b0: 2829 0a20 2020 2020 2020 2020 2020 2076  ().            v
+000027c0: 6220 3d20 620a 2020 2020 2020 2020 2020  b = b.          
+000027d0: 2020 6966 2066 6162 7328 7662 2e78 293c    if fabs(vb.x)<
+000027e0: 3d65 7073 206f 7220 6661 6273 2876 622e  =eps or fabs(vb.
+000027f0: 7929 3c3d 6570 7320 6f72 2066 6162 7328  y)<=eps or fabs(
+00002800: 7662 2e7a 293c 3d65 7073 3a0a 2020 2020  vb.z)<=eps:.    
+00002810: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00002820: 6520 5a65 726f 4469 7669 7369 6f6e 4572  e ZeroDivisionEr
+00002830: 726f 722c 2276 6563 3320 6d6f 6475 6c6f  ror,"vec3 modulo
+00002840: 220a 2020 2020 2020 2020 2020 2020 7265  ".            re
+00002850: 732e 7820 3d20 5f66 6d6f 6428 7365 6c66  s.x = _fmod(self
+00002860: 2e78 2c20 7662 2e78 290a 2020 2020 2020  .x, vb.x).      
+00002870: 2020 2020 2020 7265 732e 7920 3d20 5f66        res.y = _f
+00002880: 6d6f 6428 7365 6c66 2e79 2c20 7662 2e79  mod(self.y, vb.y
+00002890: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
+000028a0: 732e 7a20 3d20 5f66 6d6f 6428 7365 6c66  s.z = _fmod(self
+000028b0: 2e7a 2c20 7662 2e7a 290a 2020 2020 2020  .z, vb.z).      
+000028c0: 2020 2020 2020 7265 7475 726e 2072 6573        return res
+000028d0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+000028e0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+000028f0: 2054 7970 6545 7272 6f72 2c20 2275 6e73   TypeError, "uns
+00002900: 7570 706f 7274 6564 206f 7065 7261 6e64  upported operand
+00002910: 2074 7970 6520 666f 7220 2522 0a0a 2020   type for %"..  
+00002920: 2020 6465 6620 5f5f 6e65 675f 5f28 7365    def __neg__(se
+00002930: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
+00002940: 4e65 6761 7469 6f6e 0a0a 2020 2020 2020  Negation..      
+00002950: 2020 3e3e 3e20 613d 7665 6333 2833 2e30    >>> a=vec3(3.0
+00002960: 2c20 322e 352c 202d 312e 3829 0a20 2020  , 2.5, -1.8).   
+00002970: 2020 2020 203e 3e3e 2070 7269 6e74 282d       >>> print(-
+00002980: 6129 0a20 2020 2020 2020 2028 2d33 2e30  a).        (-3.0
+00002990: 3030 302c 202d 322e 3530 3030 2c20 312e  000, -2.5000, 1.
+000029a0: 3830 3030 290a 2020 2020 2020 2020 2222  8000).        ""
+000029b0: 220a 2020 2020 2020 2020 6364 6566 2076  ".        cdef v
+000029c0: 6563 3320 7265 730a 2020 2020 2020 2020  ec3 res.        
+000029d0: 7265 7320 3d20 7665 6333 2829 0a20 2020  res = vec3().   
+000029e0: 2020 2020 2072 6573 2e78 203d 202d 7365       res.x = -se
+000029f0: 6c66 2e78 0a20 2020 2020 2020 2072 6573  lf.x.        res
+00002a00: 2e79 203d 202d 7365 6c66 2e79 0a20 2020  .y = -self.y.   
+00002a10: 2020 2020 2072 6573 2e7a 203d 202d 7365       res.z = -se
+00002a20: 6c66 2e7a 0a20 2020 2020 2020 2072 6574  lf.z.        ret
+00002a30: 7572 6e20 7265 730a 0a20 2020 2064 6566  urn res..    def
+00002a40: 205f 5f70 6f73 5f5f 2873 656c 6629 3a0a   __pos__(self):.
+00002a50: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00002a60: 2020 2020 3e3e 3e20 613d 7665 6333 2833      >>> a=vec3(3
+00002a70: 2e30 2c20 322e 352c 202d 312e 3829 0a20  .0, 2.5, -1.8). 
+00002a80: 2020 2020 2020 203e 3e3e 2070 7269 6e74         >>> print
+00002a90: 282b 6129 0a20 2020 2020 2020 2028 332e  (+a).        (3.
+00002aa0: 3030 3030 2c20 322e 3530 3030 2c20 2d31  0000, 2.5000, -1
+00002ab0: 2e38 3030 3029 0a20 2020 2020 2020 2022  .8000).        "
+00002ac0: 2222 0a20 2020 2020 2020 2063 6465 6620  "".        cdef 
+00002ad0: 7665 6333 2072 6573 0a20 2020 2020 2020  vec3 res.       
+00002ae0: 2072 6573 203d 2076 6563 3328 290a 2020   res = vec3().  
+00002af0: 2020 2020 2020 7265 732e 7820 3d20 7365        res.x = se
+00002b00: 6c66 2e78 0a20 2020 2020 2020 2072 6573  lf.x.        res
+00002b10: 2e79 203d 2073 656c 662e 790a 2020 2020  .y = self.y.    
+00002b20: 2020 2020 7265 732e 7a20 3d20 7365 6c66      res.z = self
+00002b30: 2e7a 0a20 2020 2020 2020 2072 6574 7572  .z.        retur
+00002b40: 6e20 7265 730a 0a0a 2020 2020 6465 6620  n res...    def 
+00002b50: 5f5f 6961 6464 5f5f 2873 656c 662c 2076  __iadd__(self, v
+00002b60: 6563 3320 6f74 6865 7229 3a0a 2020 2020  ec3 other):.    
+00002b70: 2020 2020 2222 2249 6e6c 696e 6520 7665      """Inline ve
+00002b80: 6374 6f72 2061 6464 6974 696f 6e2e 0a0a  ctor addition...
+00002b90: 2020 2020 2020 2020 3e3e 3e20 613d 7665          >>> a=ve
+00002ba0: 6333 2831 2e30 2c20 302e 352c 202d 312e  c3(1.0, 0.5, -1.
+00002bb0: 3829 0a20 2020 2020 2020 203e 3e3e 2062  8).        >>> b
+00002bc0: 3d76 6563 3328 2d30 2e33 2c20 302e 3735  =vec3(-0.3, 0.75
+00002bd0: 2c20 302e 3529 0a20 2020 2020 2020 203e  , 0.5).        >
+00002be0: 3e3e 2061 2b3d 620a 2020 2020 2020 2020  >> a+=b.        
+00002bf0: 3e3e 3e20 7072 696e 7428 6129 0a20 2020  >>> print(a).   
+00002c00: 2020 2020 2028 302e 3730 3030 2c20 312e       (0.7000, 1.
+00002c10: 3235 3030 2c20 2d31 2e33 3030 3029 0a20  2500, -1.3000). 
+00002c20: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00002c30: 2020 2073 656c 662e 783d 7365 6c66 2e78     self.x=self.x
+00002c40: 2b6f 7468 6572 2e78 0a20 2020 2020 2020  +other.x.       
+00002c50: 2073 656c 662e 793d 7365 6c66 2e79 2b6f   self.y=self.y+o
+00002c60: 7468 6572 2e79 0a20 2020 2020 2020 2073  ther.y.        s
+00002c70: 656c 662e 7a3d 7365 6c66 2e7a 2b6f 7468  elf.z=self.z+oth
+00002c80: 6572 2e7a 0a20 2020 2020 2020 2072 6574  er.z.        ret
+00002c90: 7572 6e20 7365 6c66 0a0a 2020 2020 6465  urn self..    de
+00002ca0: 6620 5f5f 6973 7562 5f5f 2873 656c 662c  f __isub__(self,
+00002cb0: 2076 6563 3320 6f74 6865 7229 3a0a 2020   vec3 other):.  
+00002cc0: 2020 2020 2020 2222 2249 6e6c 696e 6520        """Inline 
+00002cd0: 7665 6374 6f72 2073 7562 7472 6163 7469  vector subtracti
+00002ce0: 6f6e 2e0a 0a20 2020 2020 2020 203e 3e3e  on...        >>>
+00002cf0: 2061 3d76 6563 3328 312e 302c 2030 2e35   a=vec3(1.0, 0.5
+00002d00: 2c20 2d31 2e38 290a 2020 2020 2020 2020  , -1.8).        
+00002d10: 3e3e 3e20 623d 7665 6333 282d 302e 332c  >>> b=vec3(-0.3,
+00002d20: 2030 2e37 352c 2030 2e35 290a 2020 2020   0.75, 0.5).    
+00002d30: 2020 2020 3e3e 3e20 612d 3d62 0a20 2020      >>> a-=b.   
+00002d40: 2020 2020 203e 3e3e 2070 7269 6e74 2861       >>> print(a
+00002d50: 290a 2020 2020 2020 2020 2831 2e33 3030  ).        (1.300
+00002d60: 302c 202d 302e 3235 3030 2c20 2d32 2e33  0, -0.2500, -2.3
+00002d70: 3030 3029 0a20 2020 2020 2020 2022 2222  000).        """
+00002d80: 0a20 2020 2020 2020 2073 656c 662e 783d  .        self.x=
+00002d90: 7365 6c66 2e78 2d6f 7468 6572 2e78 0a20  self.x-other.x. 
+00002da0: 2020 2020 2020 2073 656c 662e 793d 7365         self.y=se
+00002db0: 6c66 2e79 2d6f 7468 6572 2e79 0a20 2020  lf.y-other.y.   
+00002dc0: 2020 2020 2073 656c 662e 7a3d 7365 6c66       self.z=self
+00002dd0: 2e7a 2d6f 7468 6572 2e7a 0a20 2020 2020  .z-other.z.     
+00002de0: 2020 2072 6574 7572 6e20 7365 6c66 0a0a     return self..
+00002df0: 2020 2020 6465 6620 5f5f 696d 756c 5f5f      def __imul__
+00002e00: 2873 656c 662c 206f 7468 6572 293a 0a20  (self, other):. 
+00002e10: 2020 2020 2020 2022 2222 496e 6c69 6e65         """Inline
+00002e20: 206d 756c 7469 706c 6963 6174 696f 6e20   multiplication 
+00002e30: 286f 6e6c 7920 7769 7468 2073 6361 6c61  (only with scala
+00002e40: 7229 0a0a 2020 2020 2020 2020 3e3e 3e20  r)..        >>> 
+00002e50: 613d 7665 6333 2831 2e30 2c20 302e 352c  a=vec3(1.0, 0.5,
+00002e60: 202d 312e 3829 0a20 2020 2020 2020 203e   -1.8).        >
+00002e70: 3e3e 2061 2a3d 322e 300a 2020 2020 2020  >> a*=2.0.      
+00002e80: 2020 3e3e 3e20 7072 696e 7428 6129 0a20    >>> print(a). 
+00002e90: 2020 2020 2020 2028 322e 3030 3030 2c20         (2.0000, 
+00002ea0: 312e 3030 3030 2c20 2d33 2e36 3030 3029  1.0000, -3.6000)
+00002eb0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00002ec0: 2020 2020 2063 6465 6620 646f 7562 6c65       cdef double
+00002ed0: 2072 0a20 2020 2020 2020 2074 6220 3d20   r.        tb = 
+00002ee0: 7479 7065 286f 7468 6572 290a 2020 2020  type(other).    
+00002ef0: 2020 2020 6966 2074 6220 6973 2066 6c6f      if tb is flo
+00002f00: 6174 206f 7220 7462 2069 7320 696e 7420  at or tb is int 
+00002f10: 6f72 2074 6220 6973 206c 6f6e 673a 0a20  or tb is long:. 
+00002f20: 2020 2020 2020 2020 2020 2072 3d6f 7468             r=oth
+00002f30: 6572 0a20 2020 2020 2020 2020 2020 2073  er.            s
+00002f40: 656c 662e 783d 7365 6c66 2e78 2a72 0a20  elf.x=self.x*r. 
+00002f50: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00002f60: 793d 7365 6c66 2e79 2a72 0a20 2020 2020  y=self.y*r.     
+00002f70: 2020 2020 2020 2073 656c 662e 7a3d 7365         self.z=se
+00002f80: 6c66 2e7a 2a72 0a20 2020 2020 2020 2020  lf.z*r.         
+00002f90: 2020 2072 6574 7572 6e20 7365 6c66 0a20     return self. 
+00002fa0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00002fb0: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
+00002fc0: 7970 6545 7272 6f72 2c20 2275 6e73 7570  ypeError, "unsup
+00002fd0: 706f 7274 6564 206f 7065 7261 6e64 2074  ported operand t
+00002fe0: 7970 6520 666f 7220 2a3d 220a 0a20 2020  ype for *="..   
+00002ff0: 2064 6566 205f 5f69 6469 765f 5f28 7365   def __idiv__(se
+00003000: 6c66 2c20 6f74 6865 7229 3a0a 2020 2020  lf, other):.    
+00003010: 2020 2020 2222 2249 6e6c 696e 6520 6469      """Inline di
+00003020: 7669 7369 6f6e 2077 6974 6820 7363 616c  vision with scal
+00003030: 6172 0a0a 2020 2020 2020 2020 3e3e 3e20  ar..        >>> 
+00003040: 613d 7665 6333 2831 2e30 2c20 302e 352c  a=vec3(1.0, 0.5,
+00003050: 202d 312e 3829 0a20 2020 2020 2020 203e   -1.8).        >
+00003060: 3e3e 2061 2f3d 322e 300a 2020 2020 2020  >> a/=2.0.      
+00003070: 2020 3e3e 3e20 7072 696e 7428 6129 0a20    >>> print(a). 
+00003080: 2020 2020 2020 2028 302e 3530 3030 2c20         (0.5000, 
+00003090: 302e 3235 3030 2c20 2d30 2e39 3030 3029  0.2500, -0.9000)
+000030a0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+000030b0: 2020 2020 2063 6465 6620 646f 7562 6c65       cdef double
+000030c0: 2072 0a20 2020 2020 2020 2074 6220 3d20   r.        tb = 
+000030d0: 7479 7065 286f 7468 6572 290a 2020 2020  type(other).    
+000030e0: 2020 2020 6966 2074 6220 6973 2066 6c6f      if tb is flo
+000030f0: 6174 206f 7220 7462 2069 7320 696e 7420  at or tb is int 
+00003100: 6f72 2074 6220 6973 206c 6f6e 673a 0a20  or tb is long:. 
+00003110: 2020 2020 2020 2020 2020 2072 3d6f 7468             r=oth
+00003120: 6572 0a20 2020 2020 2020 2020 2020 2069  er.            i
+00003130: 6620 6661 6273 2872 293c 3d65 7073 3a0a  f fabs(r)<=eps:.
+00003140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003150: 7261 6973 6520 5a65 726f 4469 7669 7369  raise ZeroDivisi
+00003160: 6f6e 4572 726f 722c 2276 6563 3320 6469  onError,"vec3 di
+00003170: 7669 7369 6f6e 220a 2020 2020 2020 2020  vision".        
+00003180: 2020 2020 7365 6c66 2e78 3d73 656c 662e      self.x=self.
+00003190: 782f 720a 2020 2020 2020 2020 2020 2020  x/r.            
+000031a0: 7365 6c66 2e79 3d73 656c 662e 792f 720a  self.y=self.y/r.
+000031b0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000031c0: 2e7a 3d73 656c 662e 7a2f 720a 2020 2020  .z=self.z/r.    
+000031d0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+000031e0: 656c 660a 2020 2020 2020 2020 656c 7365  elf.        else
+000031f0: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+00003200: 6973 6520 5479 7065 4572 726f 722c 2022  ise TypeError, "
+00003210: 756e 7375 7070 6f72 7465 6420 6f70 6572  unsupported oper
+00003220: 616e 6420 7479 7065 2066 6f72 202f 3d22  and type for /="
+00003230: 0a0a 2020 2020 6465 6620 5f5f 696d 6f64  ..    def __imod
+00003240: 5f5f 2873 656c 662c 2062 293a 0a20 2020  __(self, b):.   
+00003250: 2020 2020 2022 2222 496e 6c69 6e65 206d       """Inline m
+00003260: 6f64 756c 6f2e 0a0a 2020 2020 2020 2020  odulo...        
+00003270: 3e3e 3e20 613d 7665 6333 2833 2e30 2c20  >>> a=vec3(3.0, 
+00003280: 322e 352c 202d 312e 3829 0a20 2020 2020  2.5, -1.8).     
+00003290: 2020 203e 3e3e 2061 253d 322e 300a 2020     >>> a%=2.0.  
+000032a0: 2020 2020 2020 3e3e 3e20 7072 696e 7428        >>> print(
+000032b0: 6129 0a20 2020 2020 2020 2028 312e 3030  a).        (1.00
+000032c0: 3030 2c20 302e 3530 3030 2c20 302e 3230  00, 0.5000, 0.20
+000032d0: 3030 290a 2020 2020 2020 2020 2222 220a  00).        """.
+000032e0: 2020 2020 2020 2020 6364 6566 2076 6563          cdef vec
+000032f0: 3320 7662 0a20 2020 2020 2020 2063 6465  3 vb.        cde
+00003300: 6620 646f 7562 6c65 2072 0a0a 2020 2020  f double r..    
+00003310: 2020 2020 7462 203d 2074 7970 6528 6229      tb = type(b)
+00003320: 0a0a 2020 2020 2020 2020 6966 2074 6220  ..        if tb 
+00003330: 6973 2066 6c6f 6174 206f 7220 7462 2069  is float or tb i
+00003340: 7320 696e 7420 6f72 2074 6220 6973 206c  s int or tb is l
+00003350: 6f6e 673a 0a20 2020 2020 2020 2020 2020  ong:.           
+00003360: 2023 2076 6563 3325 3d73 6361 6c61 720a   # vec3%=scalar.
+00003370: 2020 2020 2020 2020 2020 2020 7220 3d20              r = 
+00003380: 620a 2020 2020 2020 2020 2020 2020 6966  b.            if
+00003390: 2066 6162 7328 7229 3c3d 6570 733a 0a20   fabs(r)<=eps:. 
+000033a0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+000033b0: 6169 7365 205a 6572 6f44 6976 6973 696f  aise ZeroDivisio
+000033c0: 6e45 7272 6f72 2c22 7665 6333 206d 6f64  nError,"vec3 mod
+000033d0: 756c 6f22 0a20 2020 2020 2020 2020 2020  ulo".           
+000033e0: 2073 656c 662e 7820 3d20 5f66 6d6f 6428   self.x = _fmod(
+000033f0: 7365 6c66 2e78 2c72 290a 2020 2020 2020  self.x,r).      
+00003400: 2020 2020 2020 7365 6c66 2e79 203d 205f        self.y = _
+00003410: 666d 6f64 2873 656c 662e 792c 7229 0a20  fmod(self.y,r). 
+00003420: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00003430: 7a20 3d20 5f66 6d6f 6428 7365 6c66 2e7a  z = _fmod(self.z
+00003440: 2c72 290a 2020 2020 2020 2020 2020 2020  ,r).            
+00003450: 7265 7475 726e 2073 656c 660a 2020 2020  return self.    
+00003460: 2020 2020 656c 6966 2074 6220 6973 2076      elif tb is v
+00003470: 6563 333a 0a20 2020 2020 2020 2020 2020  ec3:.           
+00003480: 2023 2076 6563 3325 3d76 6563 330a 2020   # vec3%=vec3.  
+00003490: 2020 2020 2020 2020 2020 7662 203d 2062            vb = b
+000034a0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+000034b0: 6661 6273 2876 622e 7829 3c3d 6570 7320  fabs(vb.x)<=eps 
+000034c0: 6f72 2066 6162 7328 7662 2e79 293c 3d65  or fabs(vb.y)<=e
+000034d0: 7073 206f 7220 6661 6273 2876 622e 7a29  ps or fabs(vb.z)
+000034e0: 3c3d 6570 733a 0a20 2020 2020 2020 2020  <=eps:.         
+000034f0: 2020 2020 2020 2072 6169 7365 205a 6572         raise Zer
+00003500: 6f44 6976 6973 696f 6e45 7272 6f72 2c22  oDivisionError,"
+00003510: 7665 6333 206d 6f64 756c 6f22 0a20 2020  vec3 modulo".   
+00003520: 2020 2020 2020 2020 2073 656c 662e 7820           self.x 
+00003530: 3d20 5f66 6d6f 6428 7365 6c66 2e78 2c20  = _fmod(self.x, 
+00003540: 7662 2e78 290a 2020 2020 2020 2020 2020  vb.x).          
+00003550: 2020 7365 6c66 2e79 203d 205f 666d 6f64    self.y = _fmod
+00003560: 2873 656c 662e 792c 2076 622e 7929 0a20  (self.y, vb.y). 
+00003570: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00003580: 7a20 3d20 5f66 6d6f 6428 7365 6c66 2e7a  z = _fmod(self.z
+00003590: 2c20 7662 2e7a 290a 2020 2020 2020 2020  , vb.z).        
+000035a0: 2020 2020 7265 7475 726e 2073 656c 660a      return self.
+000035b0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+000035c0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+000035d0: 5479 7065 4572 726f 722c 2022 756e 7375  TypeError, "unsu
+000035e0: 7070 6f72 7465 6420 6f70 6572 616e 6420  pported operand 
+000035f0: 7479 7065 2066 6f72 2025 3d22 0a0a 0a20  type for %="... 
+00003600: 2020 2064 6566 205f 5f61 6273 5f5f 2873     def __abs__(s
+00003610: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
+00003620: 2252 6574 7572 6e20 7468 6520 6c65 6e67  "Return the leng
+00003630: 7468 206f 6620 7468 6520 7665 6374 6f72  th of the vector
+00003640: 2e0a 0a20 2020 2020 2020 2061 6273 2876  ...        abs(v
+00003650: 2920 6973 2065 7175 6976 616c 656e 7420  ) is equivalent 
+00003660: 746f 2076 2e6c 656e 6774 6828 292e 0a0a  to v.length()...
+00003670: 2020 2020 2020 2020 3e3e 3e20 613d 7665          >>> a=ve
+00003680: 6333 2831 2e30 2c20 302e 352c 202d 312e  c3(1.0, 0.5, -1.
+00003690: 3829 0a20 2020 2020 2020 203e 3e3e 2070  8).        >>> p
+000036a0: 7269 6e74 2861 6273 2861 2929 0a20 2020  rint(abs(a)).   
+000036b0: 2020 2020 2032 2e31 3138 3936 3230 3130       2.118962010
+000036c0: 3034 0a20 2020 2020 2020 2022 2222 0a20  04.        """. 
+000036d0: 2020 2020 2020 2063 6465 6620 646f 7562         cdef doub
+000036e0: 6c65 2061 0a20 2020 2020 2020 2061 203d  le a.        a =
+000036f0: 2073 656c 662e 782a 7365 6c66 2e78 202b   self.x*self.x +
+00003700: 2073 656c 662e 792a 7365 6c66 2e79 202b   self.y*self.y +
+00003710: 2073 656c 662e 7a2a 7365 6c66 2e7a 0a20   self.z*self.z. 
+00003720: 2020 2020 2020 2072 6574 7572 6e20 7371         return sq
+00003730: 7274 2861 290a 0a20 2020 2064 6566 205f  rt(a)..    def _
+00003740: 5f67 6574 6174 7472 5f5f 2873 656c 662c  _getattr__(self,
+00003750: 206e 616d 6529 3a0a 2020 2020 2020 2020   name):.        
+00003760: 6966 206e 616d 653d 3d22 7822 3a0a 2020  if name=="x":.  
+00003770: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00003780: 2073 656c 662e 780a 2020 2020 2020 2020   self.x.        
+00003790: 656c 6966 206e 616d 653d 3d22 7922 3a0a  elif name=="y":.
+000037a0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+000037b0: 726e 2073 656c 662e 790a 2020 2020 2020  rn self.y.      
+000037c0: 2020 656c 6966 206e 616d 653d 3d22 7a22    elif name=="z"
+000037d0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+000037e0: 7475 726e 2073 656c 662e 7a0a 2020 2020  turn self.z.    
+000037f0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00003800: 2020 2020 2020 7261 6973 6520 4174 7472        raise Attr
+00003810: 6962 7574 6545 7272 6f72 2c22 7665 6333  ibuteError,"vec3
+00003820: 2068 6173 206e 6f20 6174 7472 6962 7574   has no attribut
+00003830: 6520 2722 2b6e 616d 652b 2227 220a 0a20  e '"+name+"'".. 
+00003840: 2020 2064 6566 205f 5f73 6574 6174 7472     def __setattr
+00003850: 5f5f 2873 656c 662c 206e 616d 652c 2076  __(self, name, v
+00003860: 616c 293a 0a20 2020 2020 2020 2069 6620  al):.        if 
+00003870: 6e61 6d65 3d3d 2278 223a 0a20 2020 2020  name=="x":.     
+00003880: 2020 2020 2020 2073 656c 662e 7820 3d20         self.x = 
+00003890: 7661 6c0a 2020 2020 2020 2020 656c 6966  val.        elif
+000038a0: 206e 616d 653d 3d22 7922 3a0a 2020 2020   name=="y":.    
+000038b0: 2020 2020 2020 2020 7365 6c66 2e79 203d          self.y =
+000038c0: 2076 616c 0a20 2020 2020 2020 2065 6c69   val.        eli
+000038d0: 6620 6e61 6d65 3d3d 227a 223a 0a20 2020  f name=="z":.   
+000038e0: 2020 2020 2020 2020 2073 656c 662e 7a20           self.z 
+000038f0: 3d20 7661 6c0a 2020 2020 2020 2020 656c  = val.        el
+00003900: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00003910: 7261 6973 6520 4174 7472 6962 7574 6545  raise AttributeE
+00003920: 7272 6f72 2c22 7665 6333 2068 6173 206e  rror,"vec3 has n
+00003930: 6f20 7772 6974 6162 6c65 2061 7474 7269  o writable attri
+00003940: 6275 7465 2027 222b 6e61 6d65 2b22 2722  bute '"+name+"'"
+00003950: 0a0a 2020 2020 6465 6620 5f5f 6c65 6e5f  ..    def __len_
+00003960: 5f28 7365 6c66 293a 0a20 2020 2020 2020  _(self):.       
+00003970: 2022 2222 4c65 6e67 7468 206f 6620 7468   """Length of th
+00003980: 6520 7365 7175 656e 6365 2028 616c 7761  e sequence (alwa
+00003990: 7973 2033 2922 2222 0a20 2020 2020 2020  ys 3)""".       
+000039a0: 2072 6574 7572 6e20 330a 0a20 2020 2064   return 3..    d
+000039b0: 6566 205f 5f67 6574 6974 656d 5f5f 2876  ef __getitem__(v
+000039c0: 6563 3320 7365 6c66 2c20 6b65 7929 3a0a  ec3 self, key):.
+000039d0: 2020 2020 2020 2020 2222 2252 6574 7572          """Retur
+000039e0: 6e20 6120 636f 6d70 6f6e 656e 7420 6279  n a component by
+000039f0: 2069 6e64 6578 2028 302d 6261 7365 6429   index (0-based)
+00003a00: 0a0a 2020 2020 2020 2020 3e3e 3e20 613d  ..        >>> a=
+00003a10: 7665 6333 2831 2e30 2c20 302e 352c 202d  vec3(1.0, 0.5, -
+00003a20: 312e 3829 0a20 2020 2020 2020 203e 3e3e  1.8).        >>>
+00003a30: 2070 7269 6e74 2861 5b30 5d29 0a20 2020   print(a[0]).   
+00003a40: 2020 2020 2031 2e30 0a20 2020 2020 2020       1.0.       
+00003a50: 203e 3e3e 2070 7269 6e74 2861 5b31 5d29   >>> print(a[1])
+00003a60: 0a20 2020 2020 2020 2030 2e35 0a20 2020  .        0.5.   
+00003a70: 2020 2020 203e 3e3e 2070 7269 6e74 2861       >>> print(a
+00003a80: 5b32 5d29 0a20 2020 2020 2020 202d 312e  [2]).        -1.
+00003a90: 380a 2020 2020 2020 2020 2222 220a 2020  8.        """.  
+00003aa0: 2020 2020 2020 6364 6566 2069 6e74 206b        cdef int k
+00003ab0: 0a0a 2020 2020 2020 2020 543d 7479 7065  ..        T=type
+00003ac0: 286b 6579 290a 2020 2020 2020 2020 6966  (key).        if
+00003ad0: 2054 213d 696e 7420 616e 6420 5421 3d6c   T!=int and T!=l
+00003ae0: 6f6e 673a 0a20 2020 2020 2020 2020 2020  ong:.           
+00003af0: 2072 6169 7365 2054 7970 6545 7272 6f72   raise TypeError
+00003b00: 2c20 2269 6e64 6578 206d 7573 7420 6265  , "index must be
+00003b10: 2069 6e74 6567 6572 220a 0a20 2020 2020   integer"..     
+00003b20: 2020 206b 203d 206b 6579 0a20 2020 2020     k = key.     
+00003b30: 2020 2069 6620 2020 6b3d 3d30 3a20 7265     if   k==0: re
+00003b40: 7475 726e 2073 656c 662e 780a 2020 2020  turn self.x.    
+00003b50: 2020 2020 656c 6966 206b 3d3d 313a 2072      elif k==1: r
+00003b60: 6574 7572 6e20 7365 6c66 2e79 0a20 2020  eturn self.y.   
+00003b70: 2020 2020 2065 6c69 6620 6b3d 3d32 3a20       elif k==2: 
+00003b80: 7265 7475 726e 2073 656c 662e 7a0a 2020  return self.z.  
+00003b90: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00003ba0: 2020 2020 2020 2020 7261 6973 6520 496e          raise In
+00003bb0: 6465 7845 7272 6f72 2c22 696e 6465 7820  dexError,"index 
+00003bc0: 6f75 7420 6f66 2072 616e 6765 220a 0a20  out of range".. 
+00003bd0: 2020 2064 6566 205f 5f73 6574 6974 656d     def __setitem
+00003be0: 5f5f 2873 656c 662c 206b 6579 2c20 7661  __(self, key, va
+00003bf0: 6c75 6529 3a0a 2020 2020 2020 2020 2222  lue):.        ""
+00003c00: 2253 6574 2061 2063 6f6d 706f 6e65 6e74  "Set a component
+00003c10: 2062 7920 696e 6465 7820 2830 2d62 6173   by index (0-bas
+00003c20: 6564 290a 0a20 2020 2020 2020 203e 3e3e  ed)..        >>>
+00003c30: 2061 3d76 6563 3328 290a 2020 2020 2020   a=vec3().      
+00003c40: 2020 3e3e 3e20 615b 305d 3d31 2e35 3b20    >>> a[0]=1.5; 
+00003c50: 615b 315d 3d30 2e37 3b20 615b 325d 3d2d  a[1]=0.7; a[2]=-
+00003c60: 302e 330a 2020 2020 2020 2020 3e3e 3e20  0.3.        >>> 
+00003c70: 7072 696e 7428 6129 0a20 2020 2020 2020  print(a).       
+00003c80: 2028 312e 3530 3030 2c20 302e 3730 3030   (1.5000, 0.7000
+00003c90: 2c20 2d30 2e33 3030 3029 0a20 2020 2020  , -0.3000).     
+00003ca0: 2020 2022 2222 0a20 2020 2020 2020 2063     """.        c
+00003cb0: 6465 6620 696e 7420 6b0a 0a20 2020 2020  def int k..     
+00003cc0: 2020 2054 3d74 7970 6528 6b65 7929 0a20     T=type(key). 
+00003cd0: 2020 2020 2020 2069 6620 5421 3d69 6e74         if T!=int
+00003ce0: 2061 6e64 2054 213d 6c6f 6e67 3a0a 2020   and T!=long:.  
+00003cf0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00003d00: 5479 7065 4572 726f 722c 2022 696e 6465  TypeError, "inde
+00003d10: 7820 6d75 7374 2062 6520 696e 7465 6765  x must be intege
+00003d20: 7222 0a0a 2020 2020 2020 2020 6b20 3d20  r"..        k = 
+00003d30: 6b65 790a 2020 2020 2020 2020 6966 2020  key.        if  
+00003d40: 206b 3d3d 303a 2073 656c 662e 7820 3d20   k==0: self.x = 
+00003d50: 7661 6c75 650a 2020 2020 2020 2020 656c  value.        el
+00003d60: 6966 206b 3d3d 313a 2073 656c 662e 7920  if k==1: self.y 
+00003d70: 3d20 7661 6c75 650a 2020 2020 2020 2020  = value.        
+00003d80: 656c 6966 206b 3d3d 323a 2073 656c 662e  elif k==2: self.
+00003d90: 7a20 3d20 7661 6c75 650a 2020 2020 2020  z = value.      
+00003da0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00003db0: 2020 2020 7261 6973 6520 496e 6465 7845      raise IndexE
+00003dc0: 7272 6f72 2c22 696e 6465 7820 6f75 7420  rror,"index out 
+00003dd0: 6f66 2072 616e 6765 220a 0a20 2020 2064  of range"..    d
+00003de0: 6566 2063 726f 7373 2873 656c 662c 2076  ef cross(self, v
+00003df0: 6563 3320 6f74 6865 7229 3a0a 2020 2020  ec3 other):.    
+00003e00: 2020 2020 2222 2243 726f 7373 2070 726f      """Cross pro
+00003e10: 6475 6374 2e0a 0a20 2020 2020 2020 203e  duct...        >
+00003e20: 3e3e 2061 3d76 6563 3328 312e 302c 2030  >> a=vec3(1.0, 0
+00003e30: 2e35 2c20 2d31 2e38 290a 2020 2020 2020  .5, -1.8).      
+00003e40: 2020 3e3e 3e20 623d 7665 6333 282d 302e    >>> b=vec3(-0.
+00003e50: 332c 2030 2e37 352c 2030 2e35 290a 2020  3, 0.75, 0.5).  
+00003e60: 2020 2020 2020 3e3e 3e20 633d 612e 6372        >>> c=a.cr
+00003e70: 6f73 7328 6229 0a20 2020 2020 2020 203e  oss(b).        >
+00003e80: 3e3e 2070 7269 6e74 2863 290a 2020 2020  >> print(c).    
+00003e90: 2020 2020 2831 2e36 3030 302c 2030 2e30      (1.6000, 0.0
+00003ea0: 3430 302c 2030 2e39 3030 3029 0a20 2020  400, 0.9000).   
+00003eb0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00003ec0: 2063 6465 6620 7665 6333 2072 6573 0a0a   cdef vec3 res..
+00003ed0: 2020 2020 2020 2020 6966 2074 7970 6528          if type(
+00003ee0: 6f74 6865 7229 3d3d 7665 6333 3a0a 2020  other)==vec3:.  
+00003ef0: 2020 2020 2020 2020 2020 7265 7320 3d20            res = 
+00003f00: 7665 6333 2829 0a20 2020 2020 2020 2020  vec3().         
+00003f10: 2020 2072 6573 2e78 203d 2073 656c 662e     res.x = self.
+00003f20: 792a 6f74 6865 722e 7a2d 7365 6c66 2e7a  y*other.z-self.z
+00003f30: 2a6f 7468 6572 2e79 0a20 2020 2020 2020  *other.y.       
+00003f40: 2020 2020 2072 6573 2e79 203d 2073 656c       res.y = sel
+00003f50: 662e 7a2a 6f74 6865 722e 782d 7365 6c66  f.z*other.x-self
+00003f60: 2e78 2a6f 7468 6572 2e7a 0a20 2020 2020  .x*other.z.     
+00003f70: 2020 2020 2020 2072 6573 2e7a 203d 2073         res.z = s
+00003f80: 656c 662e 782a 6f74 6865 722e 792d 7365  elf.x*other.y-se
+00003f90: 6c66 2e79 2a6f 7468 6572 2e78 0a20 2020  lf.y*other.x.   
+00003fa0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00003fb0: 7265 730a 2020 2020 2020 2020 656c 7365  res.        else
+00003fc0: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+00003fd0: 6973 6520 5479 7065 4572 726f 722c 2022  ise TypeError, "
+00003fe0: 756e 7375 7070 6f72 7465 6420 6f70 6572  unsupported oper
+00003ff0: 616e 6420 7479 7065 2066 6f72 2063 726f  and type for cro
+00004000: 7373 2829 220a 0a20 2020 2064 6566 206c  ss()"..    def l
+00004010: 656e 6774 6828 7365 6c66 293a 0a20 2020  ength(self):.   
+00004020: 2020 2020 2022 2222 5265 7475 726e 2074       """Return t
+00004030: 6865 206c 656e 6774 6820 6f66 2074 6865  he length of the
+00004040: 2076 6563 746f 722e 0a0a 2020 2020 2020   vector...      
+00004050: 2020 762e 6c65 6e67 7468 2829 2069 7320    v.length() is 
+00004060: 6571 7569 7661 6c65 6e74 2074 6f20 6162  equivalent to ab
+00004070: 7328 7629 2e0a 0a20 2020 2020 2020 203e  s(v)...        >
+00004080: 3e3e 2061 3d76 6563 3328 312e 302c 2030  >> a=vec3(1.0, 0
+00004090: 2e35 2c20 2d31 2e38 290a 2020 2020 2020  .5, -1.8).      
+000040a0: 2020 3e3e 3e20 7072 696e 7428 612e 6c65    >>> print(a.le
+000040b0: 6e67 7468 2829 290a 2020 2020 2020 2020  ngth()).        
+000040c0: 322e 3131 3839 3632 3031 3030 340a 2020  2.11896201004.  
+000040d0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+000040e0: 2020 6364 6566 2064 6f75 626c 6520 610a    cdef double a.
+000040f0: 2020 2020 2020 2020 6120 3d20 7365 6c66          a = self
+00004100: 2e78 2a73 656c 662e 7820 2b20 7365 6c66  .x*self.x + self
+00004110: 2e79 2a73 656c 662e 7920 2b20 7365 6c66  .y*self.y + self
+00004120: 2e7a 2a73 656c 662e 7a0a 2020 2020 2020  .z*self.z.      
+00004130: 2020 7265 7475 726e 2073 7172 7428 6129    return sqrt(a)
+00004140: 0a0a 2020 2020 6465 6620 6e6f 726d 616c  ..    def normal
+00004150: 697a 6528 7365 6c66 293a 0a20 2020 2020  ize(self):.     
+00004160: 2020 2022 2222 5265 7475 726e 206e 6f72     """Return nor
+00004170: 6d61 6c69 7a65 6420 7665 6374 6f72 2e0a  malized vector..
+00004180: 0a20 2020 2020 2020 203e 3e3e 2061 3d76  .        >>> a=v
+00004190: 6563 3328 312e 302c 2030 2e35 2c20 2d31  ec3(1.0, 0.5, -1
+000041a0: 2e38 290a 2020 2020 2020 2020 3e3e 3e20  .8).        >>> 
+000041b0: 7072 696e 7428 612e 6e6f 726d 616c 697a  print(a.normaliz
+000041c0: 6528 2929 0a20 2020 2020 2020 2028 302e  e()).        (0.
+000041d0: 3437 3139 2c20 302e 3233 3630 2c20 2d30  4719, 0.2360, -0
+000041e0: 2e38 3439 3529 0a20 2020 2020 2020 2022  .8495).        "
+000041f0: 2222 0a20 2020 2020 2020 2063 6465 6620  "".        cdef 
+00004200: 7665 6333 2072 6573 0a20 2020 2020 2020  vec3 res.       
+00004210: 2063 6465 6620 646f 7562 6c65 206e 6c65   cdef double nle
+00004220: 6e0a 0a20 2020 2020 2020 206e 6c65 6e20  n..        nlen 
+00004230: 3d20 7371 7274 2873 656c 662e 782a 7365  = sqrt(self.x*se
+00004240: 6c66 2e78 202b 2073 656c 662e 792a 7365  lf.x + self.y*se
+00004250: 6c66 2e79 202b 2073 656c 662e 7a2a 7365  lf.y + self.z*se
+00004260: 6c66 2e7a 290a 2020 2020 2020 2020 6966  lf.z).        if
+00004270: 206e 6c65 6e3c 3d65 7073 3a0a 2020 2020   nlen<=eps:.    
+00004280: 2020 2020 2020 2020 7261 6973 6520 5a65          raise Ze
+00004290: 726f 4469 7669 7369 6f6e 4572 726f 722c  roDivisionError,
+000042a0: 226e 756c 6c20 7665 6374 6f72 2063 616e  "null vector can
+000042b0: 2774 2062 6520 6e6f 726d 616c 697a 6564  't be normalized
+000042c0: 220a 2020 2020 2020 2020 6e6c 656e 203d  ".        nlen =
+000042d0: 2031 2e30 2f6e 6c65 6e0a 2020 2020 2020   1.0/nlen.      
+000042e0: 2020 7265 7320 3d20 7665 6333 2829 0a20    res = vec3(). 
+000042f0: 2020 2020 2020 2072 6573 2e78 203d 2073         res.x = s
+00004300: 656c 662e 782a 6e6c 656e 0a20 2020 2020  elf.x*nlen.     
+00004310: 2020 2072 6573 2e79 203d 2073 656c 662e     res.y = self.
+00004320: 792a 6e6c 656e 0a20 2020 2020 2020 2072  y*nlen.        r
+00004330: 6573 2e7a 203d 2073 656c 662e 7a2a 6e6c  es.z = self.z*nl
+00004340: 656e 0a20 2020 2020 2020 2072 6574 7572  en.        retur
+00004350: 6e20 7265 730a 0a20 2020 2064 6566 2061  n res..    def a
+00004360: 6e67 6c65 2873 656c 662c 2076 6563 3320  ngle(self, vec3 
+00004370: 6f74 6865 7229 3a0a 2020 2020 2020 2020  other):.        
+00004380: 2222 2252 6574 7572 6e20 616e 676c 6520  """Return angle 
+00004390: 2869 6e20 7261 6469 616e 7329 2062 6574  (in radians) bet
+000043a0: 7765 656e 2073 656c 6620 616e 6420 6f74  ween self and ot
+000043b0: 6865 722e 0a0a 2020 2020 2020 2020 3e3e  her...        >>
+000043c0: 3e20 613d 7665 6333 2831 2e30 2c20 302e  > a=vec3(1.0, 0.
+000043d0: 352c 202d 312e 3829 0a20 2020 2020 2020  5, -1.8).       
+000043e0: 203e 3e3e 2062 3d76 6563 3328 2d30 2e33   >>> b=vec3(-0.3
+000043f0: 2c20 302e 3735 2c20 302e 3529 0a20 2020  , 0.75, 0.5).   
+00004400: 2020 2020 203e 3e3e 2070 7269 6e74 2861       >>> print(a
+00004410: 2e61 6e67 6c65 2862 2929 0a20 2020 2020  .angle(b)).     
+00004420: 2020 2031 2e39 3933 3036 3735 3535 3834     1.99306755584
+00004430: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
+00004440: 2020 2020 2020 6364 6566 2064 6f75 626c        cdef doubl
+00004450: 6520 612c 206c 732c 206c 6f0a 0a20 2020  e a, ls, lo..   
+00004460: 2020 2020 206c 7320 3d20 7371 7274 2873       ls = sqrt(s
+00004470: 656c 662e 782a 7365 6c66 2e78 202b 2073  elf.x*self.x + s
+00004480: 656c 662e 792a 7365 6c66 2e79 202b 2073  elf.y*self.y + s
+00004490: 656c 662e 7a2a 7365 6c66 2e7a 290a 2020  elf.z*self.z).  
+000044a0: 2020 2020 2020 6c6f 203d 2073 7172 7428        lo = sqrt(
+000044b0: 6f74 6865 722e 782a 6f74 6865 722e 7820  other.x*other.x 
+000044c0: 2b20 6f74 6865 722e 792a 6f74 6865 722e  + other.y*other.
+000044d0: 7920 2b20 6f74 6865 722e 7a2a 6f74 6865  y + other.z*othe
+000044e0: 722e 7a29 0a20 2020 2020 2020 2061 2020  r.z).        a  
+000044f0: 3d20 6c73 2a6c 6f0a 2020 2020 2020 2020  = ls*lo.        
+00004500: 6966 2061 3c3d 6570 733a 0a20 2020 2020  if a<=eps:.     
+00004510: 2020 2020 2020 2072 6169 7365 205a 6572         raise Zer
+00004520: 6f44 6976 6973 696f 6e45 7272 6f72 2c22  oDivisionError,"
+00004530: 616e 676c 6528 293a 206e 756c 6c20 7665  angle(): null ve
+00004540: 6374 6f72 2063 616e 2774 2062 6520 6e6f  ctor can't be no
+00004550: 726d 616c 697a 6564 220a 2020 2020 2020  rmalized".      
+00004560: 2020 6120 203d 2028 7365 6c66 2e78 2a6f    a  = (self.x*o
+00004570: 7468 6572 2e78 202b 2073 656c 662e 792a  ther.x + self.y*
+00004580: 6f74 6865 722e 7920 2b20 7365 6c66 2e7a  other.y + self.z
+00004590: 2a6f 7468 6572 2e7a 292f 610a 2020 2020  *other.z)/a.    
+000045a0: 2020 2020 6966 2061 3e31 2e30 3a0a 2020      if a>1.0:.  
+000045b0: 2020 2020 2020 2020 2020 613d 312e 300a            a=1.0.
+000045c0: 2020 2020 2020 2020 6966 2061 3c2d 312e          if a<-1.
+000045d0: 303a 0a20 2020 2020 2020 2020 2020 2061  0:.            a
+000045e0: 3d2d 312e 300a 2020 2020 2020 2020 7265  =-1.0.        re
+000045f0: 7475 726e 2061 636f 7328 6129 0a23 2020  turn acos(a).#  
+00004600: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
+00004610: 6e63 6528 6f74 6865 722c 2076 6563 3329  nce(other, vec3)
+00004620: 3a0a 2320 2020 2020 2020 2020 2020 2072  :.#            r
+00004630: 6574 7572 6e20 6d61 7468 2e61 636f 7328  eturn math.acos(
+00004640: 2873 656c 662a 6f74 6865 7229 202f 2028  (self*other) / (
+00004650: 6162 7328 7365 6c66 292a 6162 7328 6f74  abs(self)*abs(ot
+00004660: 6865 7229 2929 0a23 2020 2020 2020 2020  her))).#        
+00004670: 656c 7365 3a0a 2320 2020 2020 2020 2020  else:.#         
+00004680: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
+00004690: 6f72 2c20 2275 6e73 7570 706f 7274 6564  or, "unsupported
+000046a0: 206f 7065 7261 6e64 2074 7970 6520 666f   operand type fo
+000046b0: 7220 616e 676c 6528 2922 0a0a 2020 2020  r angle()"..    
+000046c0: 6465 6620 7265 666c 6563 7428 7365 6c66  def reflect(self
+000046d0: 2c20 7665 6333 204e 293a 0a20 2020 2020  , vec3 N):.     
+000046e0: 2020 2022 2222 5265 7475 726e 2074 6865     """Return the
+000046f0: 2072 6566 6c65 6374 696f 6e20 7665 6374   reflection vect
+00004700: 6f72 2e0a 0a20 2020 2020 2020 204e 2069  or...        N i
+00004710: 7320 7468 6520 7375 7266 6163 6520 6e6f  s the surface no
+00004720: 726d 616c 2077 6869 6368 2068 6173 2074  rmal which has t
+00004730: 6f20 6265 206f 6620 756e 6974 206c 656e  o be of unit len
+00004740: 6774 682e 0a0a 2020 2020 2020 2020 3e3e  gth...        >>
+00004750: 3e20 613d 7665 6333 2831 2e30 2c20 2d31  > a=vec3(1.0, -1
+00004760: 2e30 2c20 302e 3029 0a20 2020 2020 2020  .0, 0.0).       
+00004770: 203e 3e3e 2070 7269 6e74 2861 2e72 6566   >>> print(a.ref
+00004780: 6c65 6374 2876 6563 3328 302c 312c 3029  lect(vec3(0,1,0)
+00004790: 2929 0a20 2020 2020 2020 2028 312e 3030  )).        (1.00
+000047a0: 3030 2c20 312e 3030 3030 2c20 302e 3030  00, 1.0000, 0.00
+000047b0: 3030 290a 2020 2020 2020 2020 2222 220a  00).        """.
+000047c0: 2020 2020 2020 2020 6364 6566 2076 6563          cdef vec
+000047d0: 3320 7265 730a 2020 2020 2020 2020 6364  3 res.        cd
+000047e0: 6566 2064 6f75 626c 6520 610a 0a20 2020  ef double a..   
+000047f0: 2020 2020 2072 6573 203d 2076 6563 3328       res = vec3(
+00004800: 290a 2020 2020 2020 2020 6120 3d20 322e  ).        a = 2.
+00004810: 302a 2873 656c 662e 782a 4e2e 7820 2b20  0*(self.x*N.x + 
+00004820: 7365 6c66 2e79 2a4e 2e79 202b 2073 656c  self.y*N.y + sel
+00004830: 662e 7a2a 4e2e 7a29 0a20 2020 2020 2020  f.z*N.z).       
+00004840: 2072 6573 2e78 203d 2073 656c 662e 7820   res.x = self.x 
+00004850: 2d20 612a 4e2e 780a 2020 2020 2020 2020  - a*N.x.        
+00004860: 7265 732e 7920 3d20 7365 6c66 2e79 202d  res.y = self.y -
+00004870: 2061 2a4e 2e79 0a20 2020 2020 2020 2072   a*N.y.        r
+00004880: 6573 2e7a 203d 2073 656c 662e 7a20 2d20  es.z = self.z - 
+00004890: 612a 4e2e 7a0a 2020 2020 2020 2020 7265  a*N.z.        re
+000048a0: 7475 726e 2072 6573 0a0a 2020 2020 6465  turn res..    de
+000048b0: 6620 7265 6672 6163 7428 7365 6c66 2c20  f refract(self, 
+000048c0: 7665 6333 204e 2c20 6574 6129 3a0a 2020  vec3 N, eta):.  
+000048d0: 2020 2020 2020 2222 2252 6574 7572 6e20        """Return 
+000048e0: 7468 6520 7472 616e 736d 6974 7465 6420  the transmitted 
+000048f0: 7665 6374 6f72 2e0a 0a20 2020 2020 2020  vector...       
+00004900: 204e 2069 7320 7468 6520 7375 7266 6163   N is the surfac
+00004910: 6520 6e6f 726d 616c 2077 6869 6368 2068  e normal which h
+00004920: 6173 2074 6f20 6265 206f 6620 756e 6974  as to be of unit
+00004930: 206c 656e 6774 682e 0a20 2020 2020 2020   length..       
+00004940: 2065 7461 2069 7320 7468 6520 7265 6c61   eta is the rela
+00004950: 7469 7665 2069 6e64 6578 206f 6620 7265  tive index of re
+00004960: 6672 6163 7469 6f6e 2e20 4966 2074 6865  fraction. If the
+00004970: 2072 6574 7572 6e65 640a 2020 2020 2020   returned.      
+00004980: 2020 7665 6374 6f72 2069 7320 7a65 726f    vector is zero
+00004990: 2074 6865 6e20 7468 6572 6520 6973 206e   then there is n
+000049a0: 6f20 7472 616e 736d 6974 7465 6420 6c69  o transmitted li
+000049b0: 6768 7420 6265 6361 7573 650a 2020 2020  ght because.    
+000049c0: 2020 2020 6f66 2074 6f74 616c 2069 6e74      of total int
+000049d0: 6572 6e61 6c20 7265 666c 6563 7469 6f6e  ernal reflection
+000049e0: 2e0a 0a20 2020 2020 2020 203e 3e3e 2061  ...        >>> a
+000049f0: 3d76 6563 3328 312e 302c 202d 312e 352c  =vec3(1.0, -1.5,
+00004a00: 2030 2e38 290a 2020 2020 2020 2020 3e3e   0.8).        >>
+00004a10: 3e20 7072 696e 7428 612e 7265 6672 6163  > print(a.refrac
+00004a20: 7428 7665 6333 2830 2c31 2c30 292c 2031  t(vec3(0,1,0), 1
+00004a30: 2e33 3329 290a 2020 2020 2020 2020 2831  .33)).        (1
+00004a40: 2e33 3330 302c 202d 312e 3739 3230 2c20  .3300, -1.7920, 
+00004a50: 312e 3036 3430 290a 2020 2020 2020 2020  1.0640).        
+00004a60: 2222 220a 2020 2020 2020 2020 6364 6566  """.        cdef
+00004a70: 2076 6563 3320 7265 730a 2020 2020 2020   vec3 res.      
+00004a80: 2020 6364 6566 2064 6f75 626c 6520 646f    cdef double do
+00004a90: 742c 206b 2c20 6365 7461 0a0a 2020 2020  t, k, ceta..    
+00004aa0: 2020 2020 7265 7320 3d20 7665 6333 2829      res = vec3()
+00004ab0: 0a0a 2020 2020 2020 2020 6365 7461 203d  ..        ceta =
+00004ac0: 2065 7461 0a20 2020 2020 2020 2064 6f74   eta.        dot
+00004ad0: 203d 2073 656c 662e 782a 4e2e 7820 2b20   = self.x*N.x + 
+00004ae0: 7365 6c66 2e79 2a4e 2e79 202b 2073 656c  self.y*N.y + sel
+00004af0: 662e 7a2a 4e2e 7a0a 2020 2020 2020 2020  f.z*N.z.        
+00004b00: 6b20 2020 3d20 312e 3020 2d20 6365 7461  k   = 1.0 - ceta
+00004b10: 2a63 6574 612a 2831 2e30 202d 2064 6f74  *ceta*(1.0 - dot
+00004b20: 2a64 6f74 290a 2020 2020 2020 2020 6966  *dot).        if
+00004b30: 206b 3c3d 6570 733a 0a20 2020 2020 2020   k<=eps:.       
+00004b40: 2020 2020 2072 6573 2e78 203d 2030 2e30       res.x = 0.0
+00004b50: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
+00004b60: 2e79 203d 2030 2e30 0a20 2020 2020 2020  .y = 0.0.       
+00004b70: 2020 2020 2072 6573 2e7a 203d 2030 2e30       res.z = 0.0
+00004b80: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+00004b90: 2020 2020 2020 2020 2020 206b 203d 2063             k = c
+00004ba0: 6574 612a 646f 7420 2b20 7371 7274 286b  eta*dot + sqrt(k
+00004bb0: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
+00004bc0: 732e 7820 3d20 6365 7461 2a73 656c 662e  s.x = ceta*self.
+00004bd0: 7820 2d20 6b2a 4e2e 780a 2020 2020 2020  x - k*N.x.      
+00004be0: 2020 2020 2020 7265 732e 7920 3d20 6365        res.y = ce
+00004bf0: 7461 2a73 656c 662e 7920 2d20 6b2a 4e2e  ta*self.y - k*N.
+00004c00: 790a 2020 2020 2020 2020 2020 2020 7265  y.            re
+00004c10: 732e 7a20 3d20 6365 7461 2a73 656c 662e  s.z = ceta*self.
+00004c20: 7a20 2d20 6b2a 4e2e 7a0a 0a20 2020 2020  z - k*N.z..     
+00004c30: 2020 2072 6574 7572 6e20 7265 730a 0a20     return res.. 
+00004c40: 2020 2064 6566 206f 7274 686f 2873 656c     def ortho(sel
+00004c50: 6629 3a0a 2020 2020 2020 2020 2222 2252  f):.        """R
+00004c60: 6574 7572 6e73 2061 6e20 6f72 7468 6f67  eturns an orthog
+00004c70: 6f6e 616c 2076 6563 746f 722e 0a0a 2020  onal vector...  
+00004c80: 2020 2020 2020 5265 7475 726e 7320 6120        Returns a 
+00004c90: 7665 6374 6f72 2074 6861 7420 6973 206f  vector that is o
+00004ca0: 7274 686f 676f 6e61 6c20 746f 2073 656c  rthogonal to sel
+00004cb0: 6620 2877 6865 7265 0a20 2020 2020 2020  f (where.       
+00004cc0: 2073 656c 662a 7365 6c66 2e6f 7274 686f   self*self.ortho
+00004cd0: 2829 3d3d 3029 2e0a 0a20 2020 2020 2020  ()==0)...       
+00004ce0: 203e 3e3e 2061 3d76 6563 3328 312e 302c   >>> a=vec3(1.0,
+00004cf0: 202d 312e 352c 2030 2e38 290a 2020 2020   -1.5, 0.8).    
+00004d00: 2020 2020 3e3e 3e20 7072 696e 7428 726f      >>> print(ro
+00004d10: 756e 6428 612a 612e 6f72 7468 6f28 292c  und(a*a.ortho(),
+00004d20: 3829 290a 2020 2020 2020 2020 302e 300a  8)).        0.0.
+00004d30: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00004d40: 2020 2020 6364 6566 2076 6563 3320 7265      cdef vec3 re
+00004d50: 730a 2020 2020 2020 2020 6364 6566 2064  s.        cdef d
+00004d60: 6f75 626c 6520 782c 792c 7a0a 2020 2020  ouble x,y,z.    
+00004d70: 2020 2020 7265 7320 3d20 7665 6333 2829      res = vec3()
+00004d80: 0a0a 2020 2020 2020 2020 783d 6661 6273  ..        x=fabs
+00004d90: 2873 656c 662e 7829 0a20 2020 2020 2020  (self.x).       
+00004da0: 2079 3d66 6162 7328 7365 6c66 2e79 290a   y=fabs(self.y).
+00004db0: 2020 2020 2020 2020 7a3d 6661 6273 2873          z=fabs(s
+00004dc0: 656c 662e 7a29 0a20 2020 2020 2020 2023  elf.z).        #
+00004dd0: 2049 7320 7a20 7468 6520 736d 616c 6c65   Is z the smalle
+00004de0: 7374 2065 6c65 6d65 6e74 3f20 5468 656e  st element? Then
+00004df0: 2075 7365 2078 2061 6e64 2079 0a20 2020   use x and y.   
+00004e00: 2020 2020 2069 6620 7a3c 3d78 2061 6e64       if z<=x and
+00004e10: 207a 3c3d 793a 0a20 2020 2020 2020 2020   z<=y:.         
+00004e20: 2020 2072 6573 2e78 203d 202d 7365 6c66     res.x = -self
+00004e30: 2e79 0a20 2020 2020 2020 2020 2020 2072  .y.            r
+00004e40: 6573 2e79 203d 2073 656c 662e 780a 2020  es.y = self.x.  
+00004e50: 2020 2020 2020 2020 2020 7265 732e 7a20            res.z 
+00004e60: 3d20 302e 300a 2020 2020 2020 2020 2320  = 0.0.        # 
+00004e70: 4973 2079 2073 6d61 6c6c 6573 7420 656c  Is y smallest el
+00004e80: 656d 656e 743f 2054 6865 6e20 7573 6520  ement? Then use 
+00004e90: 7820 616e 6420 7a0a 2020 2020 2020 2020  x and z.        
+00004ea0: 656c 6966 2079 3c3d 7820 616e 6420 793c  elif y<=x and y<
+00004eb0: 3d7a 3a0a 2020 2020 2020 2020 2020 2020  =z:.            
+00004ec0: 7265 732e 7820 3d20 2d73 656c 662e 7a0a  res.x = -self.z.
+00004ed0: 2020 2020 2020 2020 2020 2020 7265 732e              res.
+00004ee0: 7920 3d20 302e 300a 2020 2020 2020 2020  y = 0.0.        
+00004ef0: 2020 2020 7265 732e 7a20 3d20 7365 6c66      res.z = self
+00004f00: 2e78 0a20 2020 2020 2020 2023 2078 2069  .x.        # x i
+00004f10: 7320 736d 616c 6c65 7374 0a20 2020 2020  s smallest.     
+00004f20: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00004f30: 2020 2020 2072 6573 2e78 203d 2030 2e30       res.x = 0.0
+00004f40: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
+00004f50: 2e79 203d 202d 7365 6c66 2e7a 0a20 2020  .y = -self.z.   
+00004f60: 2020 2020 2020 2020 2072 6573 2e7a 203d           res.z =
+00004f70: 2073 656c 662e 790a 0a20 2020 2020 2020   self.y..       
+00004f80: 2072 6574 7572 6e20 7265 730a 0a0a 2020   return res...  
+00004f90: 2020 6465 6620 6661 6464 2873 656c 662c    def fadd(self,
+00004fa0: 2076 6563 3320 612c 2076 6563 3320 6229   vec3 a, vec3 b)
+00004fb0: 3a0a 2020 2020 2020 2020 7365 6c66 2e78  :.        self.x
+00004fc0: 203d 2061 2e78 2b62 2e78 0a20 2020 2020   = a.x+b.x.     
+00004fd0: 2020 2073 656c 662e 7920 3d20 612e 792b     self.y = a.y+
+00004fe0: 622e 790a 2020 2020 2020 2020 7365 6c66  b.y.        self
+00004ff0: 2e7a 203d 2061 2e7a 2b62 2e7a 0a20 2020  .z = a.z+b.z.   
+00005000: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00005010: 0a0a 2020 2020 6465 6620 666e 6f72 6d61  ..    def fnorma
+00005020: 6c69 7a65 2873 656c 662c 2076 6563 3320  lize(self, vec3 
+00005030: 6129 3a0a 2020 2020 2020 2020 2222 224e  a):.        """N
+00005040: 6f72 6d61 6c69 7a65 2076 6563 746f 7220  ormalize vector 
+00005050: 6120 616e 6420 7374 6f72 6520 7265 7375  a and store resu
+00005060: 6c74 2069 6e20 7365 6c66 2e0a 2020 2020  lt in self..    
+00005070: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00005080: 6364 6566 2064 6f75 626c 6520 6e6c 656e  cdef double nlen
+00005090: 0a0a 2020 2020 2020 2020 6e6c 656e 203d  ..        nlen =
+000050a0: 2073 7172 7428 612e 782a 612e 7820 2b20   sqrt(a.x*a.x + 
+000050b0: 612e 792a 612e 7920 2b20 612e 7a2a 612e  a.y*a.y + a.z*a.
+000050c0: 7a29 0a20 2020 2020 2020 2069 6620 6e6c  z).        if nl
+000050d0: 656e 3c3d 6570 733a 0a20 2020 2020 2020  en<=eps:.       
+000050e0: 2020 2020 2072 6169 7365 205a 6572 6f44       raise ZeroD
+000050f0: 6976 6973 696f 6e45 7272 6f72 2c22 6e75  ivisionError,"nu
+00005100: 6c6c 2076 6563 746f 7220 6361 6e27 7420  ll vector can't 
+00005110: 6265 206e 6f72 6d61 6c69 7a65 6422 0a20  be normalized". 
+00005120: 2020 2020 2020 206e 6c65 6e20 3d20 312e         nlen = 1.
+00005130: 302f 6e6c 656e 0a20 2020 2020 2020 2073  0/nlen.        s
+00005140: 656c 662e 7820 3d20 612e 782a 6e6c 656e  elf.x = a.x*nlen
+00005150: 0a20 2020 2020 2020 2073 656c 662e 7920  .        self.y 
+00005160: 3d20 612e 792a 6e6c 656e 0a20 2020 2020  = a.y*nlen.     
+00005170: 2020 2073 656c 662e 7a20 3d20 612e 7a2a     self.z = a.z*
+00005180: 6e6c 656e 0a20 2020 2020 2020 2072 6574  nlen.        ret
+00005190: 7572 6e20 7365 6c66 0a0a 2323 2323 2323  urn self..######
 000051a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000051b0: 2323 2323 2323 2323 2323 2323 230a 0a23  #############..#
-000051c0: 2076 6563 3469 7465 720a 6364 6566 2063   vec4iter.cdef c
-000051d0: 6c61 7373 2076 6563 3469 7465 723a 0a20  lass vec4iter:. 
-000051e0: 2020 2022 2222 7665 6334 2069 7465 7261     """vec4 itera
-000051f0: 746f 722e 2222 220a 2020 2020 6364 6566  tor.""".    cdef
-00005200: 2069 6e74 2069 6478 0a20 2020 2063 6465   int idx.    cde
-00005210: 6620 6f62 6a65 6374 2076 0a0a 2020 2020  f object v..    
-00005220: 6465 6620 5f5f 6369 6e69 745f 5f28 7365  def __cinit__(se
-00005230: 6c66 2c20 7629 3a0a 2020 2020 2020 2020  lf, v):.        
-00005240: 7365 6c66 2e69 6478 203d 2030 0a20 2020  self.idx = 0.   
-00005250: 2020 2020 2073 656c 662e 7620 2020 3d20       self.v   = 
-00005260: 760a 0a20 2020 2064 6566 205f 5f69 7465  v..    def __ite
-00005270: 725f 5f28 7365 6c66 293a 0a20 2020 2020  r__(self):.     
-00005280: 2020 2072 6574 7572 6e20 7365 6c66 0a0a     return self..
-00005290: 2020 2020 6465 6620 5f5f 6e65 7874 5f5f      def __next__
-000052a0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-000052b0: 6966 2073 656c 662e 6964 783d 3d30 3a0a  if self.idx==0:.
-000052c0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000052d0: 2e69 6478 3d31 0a20 2020 2020 2020 2020  .idx=1.         
-000052e0: 2020 2072 6574 7572 6e20 7365 6c66 2e76     return self.v
-000052f0: 2e78 0a20 2020 2020 2020 2065 6c69 6620  .x.        elif 
-00005300: 7365 6c66 2e69 6478 3d3d 313a 0a20 2020  self.idx==1:.   
-00005310: 2020 2020 2020 2020 2073 656c 662e 6964           self.id
-00005320: 783d 320a 2020 2020 2020 2020 2020 2020  x=2.            
-00005330: 7265 7475 726e 2073 656c 662e 762e 790a  return self.v.y.
-00005340: 2020 2020 2020 2020 656c 6966 2073 656c          elif sel
-00005350: 662e 6964 783d 3d32 3a0a 2020 2020 2020  f.idx==2:.      
-00005360: 2020 2020 2020 7365 6c66 2e69 6478 3d33        self.idx=3
-00005370: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00005380: 7572 6e20 7365 6c66 2e76 2e7a 0a20 2020  urn self.v.z.   
-00005390: 2020 2020 2065 6c69 6620 7365 6c66 2e69       elif self.i
-000053a0: 6478 3d3d 333a 0a20 2020 2020 2020 2020  dx==3:.         
-000053b0: 2020 2073 656c 662e 6964 783d 340a 2020     self.idx=4.  
-000053c0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-000053d0: 2073 656c 662e 762e 770a 2020 2020 2020   self.v.w.      
-000053e0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-000053f0: 2020 2020 7261 6973 6520 5374 6f70 4974      raise StopIt
-00005400: 6572 6174 696f 6e0a 0a23 2076 6563 340a  eration..# vec4.
-00005410: 6364 6566 2063 6c61 7373 2076 6563 343a  cdef class vec4:
-00005420: 0a20 2020 2022 2222 466f 7572 2d64 696d  .    """Four-dim
-00005430: 656e 7369 6f6e 616c 2076 6563 746f 722e  ensional vector.
-00005440: 0a0a 2020 2020 5468 6973 2063 6c61 7373  ..    This class
-00005450: 2072 6570 7265 7365 6e74 7320 6120 3444   represents a 4D
-00005460: 2076 6563 746f 722e 0a20 2020 2022 2222   vector..    """
-00005470: 0a0a 2020 2020 6364 6566 2064 6f75 626c  ..    cdef doubl
-00005480: 6520 782c 792c 7a2c 770a 0a20 2020 2064  e x,y,z,w..    d
-00005490: 6566 205f 5f63 696e 6974 5f5f 2873 656c  ef __cinit__(sel
-000054a0: 662c 202a 6172 6773 293a 0a20 2020 2020  f, *args):.     
-000054b0: 2020 2022 2222 436f 6e73 7472 7563 746f     """Constructo
-000054c0: 722e 0a0a 2020 2020 2020 2020 5468 6572  r...        Ther
-000054d0: 6520 6172 6520 7365 7665 7261 6c20 706f  e are several po
-000054e0: 7373 6962 696c 6974 6965 7320 686f 7720  ssibilities how 
-000054f0: 746f 2069 6e69 7469 616c 697a 6520 6120  to initialize a 
-00005500: 7665 6374 6f72 3a0a 0a20 2020 2020 2020  vector:..       
-00005510: 2076 203d 2076 6563 3428 2920 2020 2020   v = vec4()     
-00005520: 2020 202d 3e20 7620 3d20 3c30 2c30 2c30     -> v = <0,0,0
-00005530: 2c30 3e0a 2020 2020 2020 2020 7620 3d20  ,0>.        v = 
-00005540: 7665 6334 2861 2920 2020 2020 2020 2d3e  vec4(a)       ->
-00005550: 2076 203d 203c 612c 612c 612c 613e 0a20   v = <a,a,a,a>. 
-00005560: 2020 2020 2020 2076 203d 2076 6563 3428         v = vec4(
-00005570: 782c 7929 2020 2020 202d 3e20 7620 3d20  x,y)     -> v = 
-00005580: 3c78 2c79 2c30 2c30 3e0a 2020 2020 2020  <x,y,0,0>.      
-00005590: 2020 7620 3d20 7665 6334 2878 2c79 2c7a    v = vec4(x,y,z
-000055a0: 2920 2020 2d3e 2076 203d 203c 782c 792c  )   -> v = <x,y,
-000055b0: 7a2c 303e 0a20 2020 2020 2020 2076 203d  z,0>.        v =
-000055c0: 2076 6563 3428 782c 792c 7a2c 7729 202d   vec4(x,y,z,w) -
-000055d0: 3e20 7620 3d20 3c78 2c79 2c7a 2c77 3e0a  > v = <x,y,z,w>.
-000055e0: 0a20 2020 2020 2020 204e 6f74 6520 7468  .        Note th
-000055f0: 6174 2073 7065 6369 6679 696e 6720 6a75  at specifying ju
-00005600: 7374 206f 6e65 2076 616c 7565 2073 6574  st one value set
-00005610: 7320 616c 6c20 666f 7572 2063 6f6d 706f  s all four compo
-00005620: 6e65 6e74 7320 746f 0a20 2020 2020 2020  nents to.       
-00005630: 2074 6861 7420 7661 6c75 652e 0a0a 2020   that value...  
-00005640: 2020 2020 2020 4164 6469 7469 6f6e 616c        Additional
-00005650: 6c79 2079 6f75 2063 616e 2077 7261 7020  ly you can wrap 
-00005660: 7468 6f73 6520 7661 6c75 6573 2069 6e20  those values in 
-00005670: 6120 6c69 7374 206f 7220 6120 7475 706c  a list or a tupl
-00005680: 6520 6f72 0a20 2020 2020 2020 2073 7065  e or.        spe
-00005690: 6369 6679 2074 6865 6d20 6173 2061 2073  cify them as a s
-000056a0: 7472 696e 673a 0a0a 2020 2020 2020 2020  tring:..        
-000056b0: 7620 3d20 7665 6334 285b 312c 322c 335d  v = vec4([1,2,3]
-000056c0: 2920 2d3e 2076 203d 203c 312c 322c 332c  ) -> v = <1,2,3,
-000056d0: 303e 0a20 2020 2020 2020 2076 203d 2076  0>.        v = v
-000056e0: 6563 3428 2234 2c35 2229 2020 202d 3e20  ec4("4,5")   -> 
-000056f0: 7620 3d20 3c34 2c35 2c30 2c30 3e0a 2020  v = <4,5,0,0>.  
-00005700: 2020 2020 2020 2222 220a 0a20 2020 2020        """..     
-00005710: 2020 2063 6465 6620 696e 7420 6172 676c     cdef int argl
-00005720: 656e 2c20 7365 716c 656e 0a20 2020 2020  en, seqlen.     
-00005730: 2020 2063 6465 6620 7665 6334 2076 0a20     cdef vec4 v. 
-00005740: 2020 2020 2020 2061 7267 6c65 6e20 3d20         arglen = 
-00005750: 6c65 6e28 6172 6773 290a 0a20 2020 2020  len(args)..     
-00005760: 2020 2069 6620 6172 676c 656e 3d3d 303a     if arglen==0:
-00005770: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00005780: 662e 7820 3d20 302e 300a 2020 2020 2020  f.x = 0.0.      
-00005790: 2020 2020 2020 7365 6c66 2e79 203d 2030        self.y = 0
-000057a0: 2e30 0a20 2020 2020 2020 2020 2020 2073  .0.            s
-000057b0: 656c 662e 7a20 3d20 302e 300a 2020 2020  elf.z = 0.0.    
-000057c0: 2020 2020 2020 2020 7365 6c66 2e77 203d          self.w =
-000057d0: 2030 2e30 0a20 2020 2020 2020 2065 6c69   0.0.        eli
-000057e0: 6620 6172 676c 656e 3d3d 313a 0a20 2020  f arglen==1:.   
-000057f0: 2020 2020 2020 2020 2054 203d 2074 7970           T = typ
-00005800: 6528 6172 6773 5b30 5d29 0a20 2020 2020  e(args[0]).     
-00005810: 2020 2020 2020 2023 2073 6361 6c61 720a         # scalar.
-00005820: 2020 2020 2020 2020 2020 2020 6966 2054              if T
-00005830: 2069 7320 666c 6f61 7420 6f72 2054 2069   is float or T i
-00005840: 7320 696e 7420 6f72 2054 2069 7320 6c6f  s int or T is lo
-00005850: 6e67 3a0a 2020 2020 2020 2020 2020 2020  ng:.            
-00005860: 2020 2020 7365 6c66 2e78 203d 2061 7267      self.x = arg
-00005870: 735b 305d 0a20 2020 2020 2020 2020 2020  s[0].           
-00005880: 2020 2020 2073 656c 662e 7920 3d20 7365       self.y = se
-00005890: 6c66 2e78 0a20 2020 2020 2020 2020 2020  lf.x.           
-000058a0: 2020 2020 2073 656c 662e 7a20 3d20 7365       self.z = se
-000058b0: 6c66 2e78 0a20 2020 2020 2020 2020 2020  lf.x.           
-000058c0: 2020 2020 2073 656c 662e 7720 3d20 7365       self.w = se
-000058d0: 6c66 2e78 0a20 2020 2020 2020 2020 2020  lf.x.           
-000058e0: 2023 2076 6563 340a 2020 2020 2020 2020   # vec4.        
-000058f0: 2020 2020 656c 6966 2054 2069 7320 7665      elif T is ve
-00005900: 6334 3a0a 2020 2020 2020 2020 2020 2020  c4:.            
-00005910: 2020 2020 7620 3d20 6172 6773 5b30 5d0a      v = args[0].
-00005920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005930: 7365 6c66 2e78 203d 2076 2e78 0a20 2020  self.x = v.x.   
-00005940: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00005950: 662e 7920 3d20 762e 790a 2020 2020 2020  f.y = v.y.      
-00005960: 2020 2020 2020 2020 2020 7365 6c66 2e7a            self.z
-00005970: 203d 2076 2e7a 0a20 2020 2020 2020 2020   = v.z.         
-00005980: 2020 2020 2020 2073 656c 662e 7720 3d20         self.w = 
-00005990: 762e 770a 2020 2020 2020 2020 2020 2020  v.w.            
-000059a0: 2320 5374 7269 6e67 0a20 2020 2020 2020  # String.       
-000059b0: 2020 2020 2065 6c69 6620 5420 6973 2073       elif T is s
-000059c0: 7472 206f 7220 5420 6973 2075 6e69 636f  tr or T is unico
-000059d0: 6465 3a0a 2020 2020 2020 2020 2020 2020  de:.            
-000059e0: 2020 2020 733d 6172 6773 5b30 5d2e 7265      s=args[0].re
-000059f0: 706c 6163 6528 222c 222c 2220 2229 2e72  place(","," ").r
-00005a00: 6570 6c61 6365 2822 2020 222c 2220 2229  eplace("  "," ")
-00005a10: 2e73 7472 6970 2829 2e73 706c 6974 2822  .strip().split("
-00005a20: 2022 290a 2020 2020 2020 2020 2020 2020   ").            
-00005a30: 2020 2020 6966 2073 3d3d 5b22 225d 3a0a      if s==[""]:.
-00005a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005a50: 2020 2020 733d 5b5d 0a20 2020 2020 2020      s=[].       
-00005a60: 2020 2020 2020 2020 2066 6f72 2069 2069           for i i
-00005a70: 6e20 7261 6e67 6528 6c65 6e28 7329 293a  n range(len(s)):
-00005a80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00005a90: 2020 2020 2074 7279 3a0a 2020 2020 2020       try:.      
-00005aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005ab0: 2020 735b 695d 203d 2066 6c6f 6174 2873    s[i] = float(s
-00005ac0: 5b69 5d29 0a20 2020 2020 2020 2020 2020  [i]).           
-00005ad0: 2020 2020 2020 2020 2065 7863 6570 743a           except:
-00005ae0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00005af0: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-00005b00: 616c 7565 4572 726f 722c 2276 6563 3428  alueError,"vec4(
-00005b10: 2920 6172 6720 6973 2061 206d 616c 666f  ) arg is a malfo
-00005b20: 726d 6564 2073 7472 696e 6722 0a20 2020  rmed string".   
-00005b30: 2020 2020 2020 2020 2020 2020 2076 203d               v =
-00005b40: 2076 6563 3428 7329 0a20 2020 2020 2020   vec4(s).       
-00005b50: 2020 2020 2020 2020 2073 656c 662e 7820           self.x 
-00005b60: 3d20 762e 780a 2020 2020 2020 2020 2020  = v.x.          
-00005b70: 2020 2020 2020 7365 6c66 2e79 203d 2076        self.y = v
-00005b80: 2e79 0a20 2020 2020 2020 2020 2020 2020  .y.             
-00005b90: 2020 2073 656c 662e 7a20 3d20 762e 7a0a     self.z = v.z.
-00005ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005bb0: 7365 6c66 2e77 203d 2076 2e77 0a20 2020  self.w = v.w.   
-00005bc0: 2020 2020 2020 2020 2023 2053 6571 7565           # Seque
-00005bd0: 6e63 6520 6f66 2066 6c6f 6174 730a 2020  nce of floats.  
-00005be0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-00005bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005c00: 7365 7120 3d20 6172 6773 5b30 5d0a 2020  seq = args[0].  
-00005c10: 2020 2020 2020 2020 2020 2020 2020 7472                tr
-00005c20: 793a 0a20 2020 2020 2020 2020 2020 2020  y:.             
-00005c30: 2020 2020 2020 2073 6571 6c65 6e20 3d20         seqlen = 
-00005c40: 6c65 6e28 7365 7129 0a20 2020 2020 2020  len(seq).       
-00005c50: 2020 2020 2020 2020 2065 7863 6570 743a           except:
-00005c60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00005c70: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
-00005c80: 7272 6f72 2c22 7665 6334 2829 2061 7267  rror,"vec4() arg
-00005c90: 2063 616e 2774 2062 6520 636f 6e76 6572   can't be conver
-00005ca0: 7465 6420 746f 2076 6563 3422 0a0a 2020  ted to vec4"..  
-00005cb0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00005cc0: 2073 6571 6c65 6e3d 3d34 3a0a 2020 2020   seqlen==4:.    
-00005cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005ce0: 7365 6c66 2e78 203d 2073 6571 5b30 5d0a  self.x = seq[0].
+000051b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000051c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000051d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000051e0: 0a0a 2320 7665 6334 6974 6572 0a63 6465  ..# vec4iter.cde
+000051f0: 6620 636c 6173 7320 7665 6334 6974 6572  f class vec4iter
+00005200: 3a0a 2020 2020 2222 2276 6563 3420 6974  :.    """vec4 it
+00005210: 6572 6174 6f72 2e22 2222 0a20 2020 2063  erator.""".    c
+00005220: 6465 6620 696e 7420 6964 780a 2020 2020  def int idx.    
+00005230: 6364 6566 206f 626a 6563 7420 760a 0a20  cdef object v.. 
+00005240: 2020 2064 6566 205f 5f63 696e 6974 5f5f     def __cinit__
+00005250: 2873 656c 662c 2076 293a 0a20 2020 2020  (self, v):.     
+00005260: 2020 2073 656c 662e 6964 7820 3d20 300a     self.idx = 0.
+00005270: 2020 2020 2020 2020 7365 6c66 2e76 2020          self.v  
+00005280: 203d 2076 0a0a 2020 2020 6465 6620 5f5f   = v..    def __
+00005290: 6974 6572 5f5f 2873 656c 6629 3a0a 2020  iter__(self):.  
+000052a0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+000052b0: 660a 0a20 2020 2064 6566 205f 5f6e 6578  f..    def __nex
+000052c0: 745f 5f28 7365 6c66 293a 0a20 2020 2020  t__(self):.     
+000052d0: 2020 2069 6620 7365 6c66 2e69 6478 3d3d     if self.idx==
+000052e0: 303a 0a20 2020 2020 2020 2020 2020 2073  0:.            s
+000052f0: 656c 662e 6964 783d 310a 2020 2020 2020  elf.idx=1.      
+00005300: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00005310: 662e 762e 780a 2020 2020 2020 2020 656c  f.v.x.        el
+00005320: 6966 2073 656c 662e 6964 783d 3d31 3a0a  if self.idx==1:.
+00005330: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00005340: 2e69 6478 3d32 0a20 2020 2020 2020 2020  .idx=2.         
+00005350: 2020 2072 6574 7572 6e20 7365 6c66 2e76     return self.v
+00005360: 2e79 0a20 2020 2020 2020 2065 6c69 6620  .y.        elif 
+00005370: 7365 6c66 2e69 6478 3d3d 323a 0a20 2020  self.idx==2:.   
+00005380: 2020 2020 2020 2020 2073 656c 662e 6964           self.id
+00005390: 783d 330a 2020 2020 2020 2020 2020 2020  x=3.            
+000053a0: 7265 7475 726e 2073 656c 662e 762e 7a0a  return self.v.z.
+000053b0: 2020 2020 2020 2020 656c 6966 2073 656c          elif sel
+000053c0: 662e 6964 783d 3d33 3a0a 2020 2020 2020  f.idx==3:.      
+000053d0: 2020 2020 2020 7365 6c66 2e69 6478 3d34        self.idx=4
+000053e0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+000053f0: 7572 6e20 7365 6c66 2e76 2e77 0a20 2020  urn self.v.w.   
+00005400: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00005410: 2020 2020 2020 2072 6169 7365 2053 746f         raise Sto
+00005420: 7049 7465 7261 7469 6f6e 0a0a 2320 7665  pIteration..# ve
+00005430: 6334 0a63 6465 6620 636c 6173 7320 7665  c4.cdef class ve
+00005440: 6334 3a0a 2020 2020 2222 2246 6f75 722d  c4:.    """Four-
+00005450: 6469 6d65 6e73 696f 6e61 6c20 7665 6374  dimensional vect
+00005460: 6f72 2e0a 0a20 2020 2054 6869 7320 636c  or...    This cl
+00005470: 6173 7320 7265 7072 6573 656e 7473 2061  ass represents a
+00005480: 2034 4420 7665 6374 6f72 2e0a 2020 2020   4D vector..    
+00005490: 2222 220a 0a20 2020 2063 6465 6620 646f  """..    cdef do
+000054a0: 7562 6c65 2078 2c79 2c7a 2c77 0a0a 2020  uble x,y,z,w..  
+000054b0: 2020 6465 6620 5f5f 6369 6e69 745f 5f28    def __cinit__(
+000054c0: 7365 6c66 2c20 2a61 7267 7329 3a0a 2020  self, *args):.  
+000054d0: 2020 2020 2020 2222 2243 6f6e 7374 7275        """Constru
+000054e0: 6374 6f72 2e0a 0a20 2020 2020 2020 2054  ctor...        T
+000054f0: 6865 7265 2061 7265 2073 6576 6572 616c  here are several
+00005500: 2070 6f73 7369 6269 6c69 7469 6573 2068   possibilities h
+00005510: 6f77 2074 6f20 696e 6974 6961 6c69 7a65  ow to initialize
+00005520: 2061 2076 6563 746f 723a 0a0a 2020 2020   a vector:..    
+00005530: 2020 2020 7620 3d20 7665 6334 2829 2020      v = vec4()  
+00005540: 2020 2020 2020 2d3e 2076 203d 203c 302c        -> v = <0,
+00005550: 302c 302c 303e 0a20 2020 2020 2020 2076  0,0,0>.        v
+00005560: 203d 2076 6563 3428 6129 2020 2020 2020   = vec4(a)      
+00005570: 202d 3e20 7620 3d20 3c61 2c61 2c61 2c61   -> v = <a,a,a,a
+00005580: 3e0a 2020 2020 2020 2020 7620 3d20 7665  >.        v = ve
+00005590: 6334 2878 2c79 2920 2020 2020 2d3e 2076  c4(x,y)     -> v
+000055a0: 203d 203c 782c 792c 302c 303e 0a20 2020   = <x,y,0,0>.   
+000055b0: 2020 2020 2076 203d 2076 6563 3428 782c       v = vec4(x,
+000055c0: 792c 7a29 2020 202d 3e20 7620 3d20 3c78  y,z)   -> v = <x
+000055d0: 2c79 2c7a 2c30 3e0a 2020 2020 2020 2020  ,y,z,0>.        
+000055e0: 7620 3d20 7665 6334 2878 2c79 2c7a 2c77  v = vec4(x,y,z,w
+000055f0: 2920 2d3e 2076 203d 203c 782c 792c 7a2c  ) -> v = <x,y,z,
+00005600: 773e 0a0a 2020 2020 2020 2020 4e6f 7465  w>..        Note
+00005610: 2074 6861 7420 7370 6563 6966 7969 6e67   that specifying
+00005620: 206a 7573 7420 6f6e 6520 7661 6c75 6520   just one value 
+00005630: 7365 7473 2061 6c6c 2066 6f75 7220 636f  sets all four co
+00005640: 6d70 6f6e 656e 7473 2074 6f0a 2020 2020  mponents to.    
+00005650: 2020 2020 7468 6174 2076 616c 7565 2e0a      that value..
+00005660: 0a20 2020 2020 2020 2041 6464 6974 696f  .        Additio
+00005670: 6e61 6c6c 7920 796f 7520 6361 6e20 7772  nally you can wr
+00005680: 6170 2074 686f 7365 2076 616c 7565 7320  ap those values 
+00005690: 696e 2061 206c 6973 7420 6f72 2061 2074  in a list or a t
+000056a0: 7570 6c65 206f 720a 2020 2020 2020 2020  uple or.        
+000056b0: 7370 6563 6966 7920 7468 656d 2061 7320  specify them as 
+000056c0: 6120 7374 7269 6e67 3a0a 0a20 2020 2020  a string:..     
+000056d0: 2020 2076 203d 2076 6563 3428 5b31 2c32     v = vec4([1,2
+000056e0: 2c33 5d29 202d 3e20 7620 3d20 3c31 2c32  ,3]) -> v = <1,2
+000056f0: 2c33 2c30 3e0a 2020 2020 2020 2020 7620  ,3,0>.        v 
+00005700: 3d20 7665 6334 2822 342c 3522 2920 2020  = vec4("4,5")   
+00005710: 2d3e 2076 203d 203c 342c 352c 302c 303e  -> v = <4,5,0,0>
+00005720: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
+00005730: 2020 2020 2020 6364 6566 2069 6e74 2061        cdef int a
+00005740: 7267 6c65 6e2c 2073 6571 6c65 6e0a 2020  rglen, seqlen.  
+00005750: 2020 2020 2020 6364 6566 2076 6563 3420        cdef vec4 
+00005760: 760a 2020 2020 2020 2020 6172 676c 656e  v.        arglen
+00005770: 203d 206c 656e 2861 7267 7329 0a0a 2020   = len(args)..  
+00005780: 2020 2020 2020 6966 2061 7267 6c65 6e3d        if arglen=
+00005790: 3d30 3a0a 2020 2020 2020 2020 2020 2020  =0:.            
+000057a0: 7365 6c66 2e78 203d 2030 2e30 0a20 2020  self.x = 0.0.   
+000057b0: 2020 2020 2020 2020 2073 656c 662e 7920           self.y 
+000057c0: 3d20 302e 300a 2020 2020 2020 2020 2020  = 0.0.          
+000057d0: 2020 7365 6c66 2e7a 203d 2030 2e30 0a20    self.z = 0.0. 
+000057e0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000057f0: 7720 3d20 302e 300a 2020 2020 2020 2020  w = 0.0.        
+00005800: 656c 6966 2061 7267 6c65 6e3d 3d31 3a0a  elif arglen==1:.
+00005810: 2020 2020 2020 2020 2020 2020 5420 3d20              T = 
+00005820: 7479 7065 2861 7267 735b 305d 290a 2020  type(args[0]).  
+00005830: 2020 2020 2020 2020 2020 2320 7363 616c            # scal
+00005840: 6172 0a20 2020 2020 2020 2020 2020 2069  ar.            i
+00005850: 6620 5420 6973 2066 6c6f 6174 206f 7220  f T is float or 
+00005860: 5420 6973 2069 6e74 206f 7220 5420 6973  T is int or T is
+00005870: 206c 6f6e 673a 0a20 2020 2020 2020 2020   long:.         
+00005880: 2020 2020 2020 2073 656c 662e 7820 3d20         self.x = 
+00005890: 6172 6773 5b30 5d0a 2020 2020 2020 2020  args[0].        
+000058a0: 2020 2020 2020 2020 7365 6c66 2e79 203d          self.y =
+000058b0: 2073 656c 662e 780a 2020 2020 2020 2020   self.x.        
+000058c0: 2020 2020 2020 2020 7365 6c66 2e7a 203d          self.z =
+000058d0: 2073 656c 662e 780a 2020 2020 2020 2020   self.x.        
+000058e0: 2020 2020 2020 2020 7365 6c66 2e77 203d          self.w =
+000058f0: 2073 656c 662e 780a 2020 2020 2020 2020   self.x.        
+00005900: 2020 2020 2320 7665 6334 0a20 2020 2020      # vec4.     
+00005910: 2020 2020 2020 2065 6c69 6620 5420 6973         elif T is
+00005920: 2076 6563 343a 0a20 2020 2020 2020 2020   vec4:.         
+00005930: 2020 2020 2020 2076 203d 2061 7267 735b         v = args[
+00005940: 305d 0a20 2020 2020 2020 2020 2020 2020  0].             
+00005950: 2020 2073 656c 662e 7820 3d20 762e 780a     self.x = v.x.
+00005960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005970: 7365 6c66 2e79 203d 2076 2e79 0a20 2020  self.y = v.y.   
+00005980: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00005990: 662e 7a20 3d20 762e 7a0a 2020 2020 2020  f.z = v.z.      
+000059a0: 2020 2020 2020 2020 2020 7365 6c66 2e77            self.w
+000059b0: 203d 2076 2e77 0a20 2020 2020 2020 2020   = v.w.         
+000059c0: 2020 2023 2053 7472 696e 670a 2020 2020     # String.    
+000059d0: 2020 2020 2020 2020 656c 6966 2054 2069          elif T i
+000059e0: 7320 7374 7220 6f72 2054 2069 7320 756e  s str or T is un
+000059f0: 6963 6f64 653a 0a20 2020 2020 2020 2020  icode:.         
+00005a00: 2020 2020 2020 2073 3d61 7267 735b 305d         s=args[0]
+00005a10: 2e72 6570 6c61 6365 2822 2c22 2c22 2022  .replace(","," "
+00005a20: 292e 7265 706c 6163 6528 2220 2022 2c22  ).replace("  ","
+00005a30: 2022 292e 7374 7269 7028 292e 7370 6c69   ").strip().spli
+00005a40: 7428 2220 2229 0a20 2020 2020 2020 2020  t(" ").         
+00005a50: 2020 2020 2020 2069 6620 733d 3d5b 2222         if s==[""
+00005a60: 5d3a 0a20 2020 2020 2020 2020 2020 2020  ]:.             
+00005a70: 2020 2020 2020 2073 3d5b 5d0a 2020 2020         s=[].    
+00005a80: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00005a90: 6920 696e 2072 616e 6765 286c 656e 2873  i in range(len(s
+00005aa0: 2929 3a0a 2020 2020 2020 2020 2020 2020  )):.            
+00005ab0: 2020 2020 2020 2020 7472 793a 0a20 2020          try:.   
+00005ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005ad0: 2020 2020 2073 5b69 5d20 3d20 666c 6f61       s[i] = floa
+00005ae0: 7428 735b 695d 290a 2020 2020 2020 2020  t(s[i]).        
+00005af0: 2020 2020 2020 2020 2020 2020 6578 6365              exce
+00005b00: 7074 3a0a 2020 2020 2020 2020 2020 2020  pt:.            
+00005b10: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00005b20: 6520 5661 6c75 6545 7272 6f72 2c22 7665  e ValueError,"ve
+00005b30: 6334 2829 2061 7267 2069 7320 6120 6d61  c4() arg is a ma
+00005b40: 6c66 6f72 6d65 6420 7374 7269 6e67 220a  lformed string".
+00005b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005b60: 7620 3d20 7665 6334 2873 290a 2020 2020  v = vec4(s).    
+00005b70: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00005b80: 2e78 203d 2076 2e78 0a20 2020 2020 2020  .x = v.x.       
+00005b90: 2020 2020 2020 2020 2073 656c 662e 7920           self.y 
+00005ba0: 3d20 762e 790a 2020 2020 2020 2020 2020  = v.y.          
+00005bb0: 2020 2020 2020 7365 6c66 2e7a 203d 2076        self.z = v
+00005bc0: 2e7a 0a20 2020 2020 2020 2020 2020 2020  .z.             
+00005bd0: 2020 2073 656c 662e 7720 3d20 762e 770a     self.w = v.w.
+00005be0: 2020 2020 2020 2020 2020 2020 2320 5365              # Se
+00005bf0: 7175 656e 6365 206f 6620 666c 6f61 7473  quence of floats
+00005c00: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
+00005c10: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+00005c20: 2020 2073 6571 203d 2061 7267 735b 305d     seq = args[0]
+00005c30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00005c40: 2074 7279 3a0a 2020 2020 2020 2020 2020   try:.          
+00005c50: 2020 2020 2020 2020 2020 7365 716c 656e            seqlen
+00005c60: 203d 206c 656e 2873 6571 290a 2020 2020   = len(seq).    
+00005c70: 2020 2020 2020 2020 2020 2020 6578 6365              exce
+00005c80: 7074 3a0a 2020 2020 2020 2020 2020 2020  pt:.            
+00005c90: 2020 2020 2020 2020 7261 6973 6520 5479          raise Ty
+00005ca0: 7065 4572 726f 722c 2276 6563 3428 2920  peError,"vec4() 
+00005cb0: 6172 6720 6361 6e27 7420 6265 2063 6f6e  arg can't be con
+00005cc0: 7665 7274 6564 2074 6f20 7665 6334 220a  verted to vec4".
+00005cd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00005ce0: 2069 6620 7365 716c 656e 3d3d 343a 0a20   if seqlen==4:. 
 00005cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005d00: 2020 2020 7365 6c66 2e79 203d 2073 6571      self.y = seq
-00005d10: 5b31 5d0a 2020 2020 2020 2020 2020 2020  [1].            
-00005d20: 2020 2020 2020 2020 7365 6c66 2e7a 203d          self.z =
-00005d30: 2073 6571 5b32 5d0a 2020 2020 2020 2020   seq[2].        
-00005d40: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00005d50: 2e77 203d 2073 6571 5b33 5d0a 2020 2020  .w = seq[3].    
-00005d60: 2020 2020 2020 2020 2020 2020 656c 6966              elif
-00005d70: 2073 6571 6c65 6e3d 3d33 3a0a 2020 2020   seqlen==3:.    
-00005d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005d90: 7365 6c66 2e78 203d 2073 6571 5b30 5d0a  self.x = seq[0].
+00005d00: 2020 2073 656c 662e 7820 3d20 7365 715b     self.x = seq[
+00005d10: 305d 0a20 2020 2020 2020 2020 2020 2020  0].             
+00005d20: 2020 2020 2020 2073 656c 662e 7920 3d20         self.y = 
+00005d30: 7365 715b 315d 0a20 2020 2020 2020 2020  seq[1].         
+00005d40: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00005d50: 7a20 3d20 7365 715b 325d 0a20 2020 2020  z = seq[2].     
+00005d60: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00005d70: 656c 662e 7720 3d20 7365 715b 335d 0a20  elf.w = seq[3]. 
+00005d80: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00005d90: 6c69 6620 7365 716c 656e 3d3d 333a 0a20  lif seqlen==3:. 
 00005da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005db0: 2020 2020 7365 6c66 2e79 203d 2073 6571      self.y = seq
-00005dc0: 5b31 5d0a 2020 2020 2020 2020 2020 2020  [1].            
-00005dd0: 2020 2020 2020 2020 7365 6c66 2e7a 203d          self.z =
-00005de0: 2073 6571 5b32 5d0a 2020 2020 2020 2020   seq[2].        
-00005df0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00005e00: 2e77 203d 2030 2e30 0a20 2020 2020 2020  .w = 0.0.       
-00005e10: 2020 2020 2020 2020 2065 6c69 6620 7365           elif se
-00005e20: 716c 656e 3d3d 323a 0a20 2020 2020 2020  qlen==2:.       
-00005e30: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00005e40: 662e 7820 3d20 7365 715b 305d 0a20 2020  f.x = seq[0].   
+00005db0: 2020 2073 656c 662e 7820 3d20 7365 715b     self.x = seq[
+00005dc0: 305d 0a20 2020 2020 2020 2020 2020 2020  0].             
+00005dd0: 2020 2020 2020 2073 656c 662e 7920 3d20         self.y = 
+00005de0: 7365 715b 315d 0a20 2020 2020 2020 2020  seq[1].         
+00005df0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00005e00: 7a20 3d20 7365 715b 325d 0a20 2020 2020  z = seq[2].     
+00005e10: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00005e20: 656c 662e 7720 3d20 302e 300a 2020 2020  elf.w = 0.0.    
+00005e30: 2020 2020 2020 2020 2020 2020 656c 6966              elif
+00005e40: 2073 6571 6c65 6e3d 3d32 3a0a 2020 2020   seqlen==2:.    
 00005e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005e60: 2073 656c 662e 7920 3d20 7365 715b 315d   self.y = seq[1]
-00005e70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00005e80: 2020 2020 2073 656c 662e 7a20 3d20 302e       self.z = 0.
-00005e90: 300a 2020 2020 2020 2020 2020 2020 2020  0.              
-00005ea0: 2020 2020 2020 7365 6c66 2e77 203d 2030        self.w = 0
-00005eb0: 2e30 0a20 2020 2020 2020 2020 2020 2020  .0.             
-00005ec0: 2020 2065 6c69 6620 7365 716c 656e 3d3d     elif seqlen==
-00005ed0: 313a 0a20 2020 2020 2020 2020 2020 2020  1:.             
-00005ee0: 2020 2020 2020 2073 656c 662e 7820 3d20         self.x = 
-00005ef0: 7365 715b 305d 0a20 2020 2020 2020 2020  seq[0].         
-00005f00: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00005f10: 7920 3d20 7365 6c66 2e78 0a20 2020 2020  y = self.x.     
-00005f20: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00005f30: 656c 662e 7a20 3d20 7365 6c66 2e78 0a20  elf.z = self.x. 
+00005e60: 7365 6c66 2e78 203d 2073 6571 5b30 5d0a  self.x = seq[0].
+00005e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005e80: 2020 2020 7365 6c66 2e79 203d 2073 6571      self.y = seq
+00005e90: 5b31 5d0a 2020 2020 2020 2020 2020 2020  [1].            
+00005ea0: 2020 2020 2020 2020 7365 6c66 2e7a 203d          self.z =
+00005eb0: 2030 2e30 0a20 2020 2020 2020 2020 2020   0.0.           
+00005ec0: 2020 2020 2020 2020 2073 656c 662e 7720           self.w 
+00005ed0: 3d20 302e 300a 2020 2020 2020 2020 2020  = 0.0.          
+00005ee0: 2020 2020 2020 656c 6966 2073 6571 6c65        elif seqle
+00005ef0: 6e3d 3d31 3a0a 2020 2020 2020 2020 2020  n==1:.          
+00005f00: 2020 2020 2020 2020 2020 7365 6c66 2e78            self.x
+00005f10: 203d 2073 6571 5b30 5d0a 2020 2020 2020   = seq[0].      
+00005f20: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00005f30: 6c66 2e79 203d 2073 656c 662e 780a 2020  lf.y = self.x.  
 00005f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005f50: 2020 2073 656c 662e 7720 3d20 7365 6c66     self.w = self
-00005f60: 2e78 0a20 2020 2020 2020 2020 2020 2020  .x.             
-00005f70: 2020 2065 6c69 6620 7365 716c 656e 3d3d     elif seqlen==
-00005f80: 303a 0a20 2020 2020 2020 2020 2020 2020  0:.             
-00005f90: 2020 2020 2020 2073 656c 662e 7820 3d20         self.x = 
-00005fa0: 302e 300a 2020 2020 2020 2020 2020 2020  0.0.            
-00005fb0: 2020 2020 2020 2020 7365 6c66 2e79 203d          self.y =
-00005fc0: 2030 2e30 0a20 2020 2020 2020 2020 2020   0.0.           
-00005fd0: 2020 2020 2020 2020 2073 656c 662e 7a20           self.z 
-00005fe0: 3d20 302e 300a 2020 2020 2020 2020 2020  = 0.0.          
-00005ff0: 2020 2020 2020 2020 2020 7365 6c66 2e77            self.w
-00006000: 203d 2030 2e30 0a20 2020 2020 2020 2020   = 0.0.         
-00006010: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00006020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006030: 2072 6169 7365 2054 7970 6545 7272 6f72   raise TypeError
-00006040: 2c20 2276 6563 3428 2920 7461 6b65 7320  , "vec4() takes 
-00006050: 6174 206d 6f73 7420 3420 6172 6775 6d65  at most 4 argume
-00006060: 6e74 7322 0a0a 2020 2020 2020 2020 656c  nts"..        el
-00006070: 6966 2061 7267 6c65 6e3d 3d32 3a0a 2020  if arglen==2:.  
-00006080: 2020 2020 2020 2020 2020 7365 6c66 2e78            self.x
-00006090: 203d 2061 7267 735b 305d 0a20 2020 2020   = args[0].     
-000060a0: 2020 2020 2020 2073 656c 662e 7920 3d20         self.y = 
-000060b0: 6172 6773 5b31 5d0a 2020 2020 2020 2020  args[1].        
-000060c0: 2020 2020 7365 6c66 2e7a 203d 2030 2e30      self.z = 0.0
-000060d0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-000060e0: 662e 7720 3d20 302e 300a 0a20 2020 2020  f.w = 0.0..     
-000060f0: 2020 2065 6c69 6620 6172 676c 656e 3d3d     elif arglen==
-00006100: 333a 0a20 2020 2020 2020 2020 2020 2073  3:.            s
-00006110: 656c 662e 7820 3d20 6172 6773 5b30 5d0a  elf.x = args[0].
-00006120: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00006130: 2e79 203d 2061 7267 735b 315d 0a20 2020  .y = args[1].   
-00006140: 2020 2020 2020 2020 2073 656c 662e 7a20           self.z 
-00006150: 3d20 6172 6773 5b32 5d0a 2020 2020 2020  = args[2].      
-00006160: 2020 2020 2020 7365 6c66 2e77 203d 2030        self.w = 0
-00006170: 2e30 0a0a 2020 2020 2020 2020 656c 6966  .0..        elif
-00006180: 2061 7267 6c65 6e3d 3d34 3a0a 2020 2020   arglen==4:.    
-00006190: 2020 2020 2020 2020 7365 6c66 2e78 203d          self.x =
-000061a0: 2061 7267 735b 305d 0a20 2020 2020 2020   args[0].       
-000061b0: 2020 2020 2073 656c 662e 7920 3d20 6172       self.y = ar
-000061c0: 6773 5b31 5d0a 2020 2020 2020 2020 2020  gs[1].          
-000061d0: 2020 7365 6c66 2e7a 203d 2061 7267 735b    self.z = args[
-000061e0: 325d 0a20 2020 2020 2020 2020 2020 2073  2].            s
-000061f0: 656c 662e 7720 3d20 6172 6773 5b33 5d0a  elf.w = args[3].
-00006200: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-00006210: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00006220: 2054 7970 6545 7272 6f72 2c20 2276 6563   TypeError, "vec
-00006230: 3428 2920 7461 6b65 7320 6174 206d 6f73  4() takes at mos
-00006240: 7420 3420 6172 6775 6d65 6e74 7322 0a0a  t 4 arguments"..
-00006250: 2020 2020 6465 6620 5f5f 7265 6475 6365      def __reduce
-00006260: 5f5f 2873 656c 6629 3a0a 2020 2020 2020  __(self):.      
-00006270: 2020 7265 7475 726e 2028 5f76 6563 3463    return (_vec4c
-00006280: 6f6e 7374 7275 6374 2c20 2873 656c 662e  onstruct, (self.
-00006290: 782c 2073 656c 662e 792c 2073 656c 662e  x, self.y, self.
-000062a0: 7a2c 2073 656c 662e 7729 290a 0a20 2020  z, self.w))..   
-000062b0: 2064 6566 205f 5f72 6570 725f 5f28 7365   def __repr__(se
-000062c0: 6c66 293a 0a20 2020 2020 2020 2072 6574  lf):.        ret
-000062d0: 7572 6e20 2776 6563 3428 2573 2c20 2573  urn 'vec4(%s, %s
-000062e0: 2c20 2573 2c20 2573 2927 2528 7265 7072  , %s, %s)'%(repr
-000062f0: 2873 656c 662e 7829 2c72 6570 7228 7365  (self.x),repr(se
-00006300: 6c66 2e79 292c 7265 7072 2873 656c 662e  lf.y),repr(self.
-00006310: 7a29 2c72 6570 7228 7365 6c66 2e77 2929  z),repr(self.w))
-00006320: 0a0a 2020 2020 6465 6620 5f5f 7374 725f  ..    def __str_
-00006330: 5f28 7365 6c66 293a 0a20 2020 2020 2020  _(self):.       
-00006340: 2072 6574 7572 6e20 2228 2531 2e34 662c   return "(%1.4f,
-00006350: 2025 312e 3466 2c20 2531 2e34 662c 2025   %1.4f, %1.4f, %
-00006360: 312e 3466 2922 2528 7365 6c66 2e78 2c20  1.4f)"%(self.x, 
-00006370: 7365 6c66 2e79 2c20 7365 6c66 2e7a 2c20  self.y, self.z, 
-00006380: 7365 6c66 2e77 290a 0a20 2020 2064 6566  self.w)..    def
-00006390: 205f 5f69 7465 725f 5f28 7365 6c66 293a   __iter__(self):
-000063a0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-000063b0: 7665 6334 6974 6572 2873 656c 6629 0a0a  vec4iter(self)..
-000063c0: 2020 2020 6465 6620 5f5f 7269 6368 636d      def __richcm
-000063d0: 705f 5f28 612c 622c 6f70 293a 0a20 2020  p__(a,b,op):.   
-000063e0: 2020 2020 2063 6465 6620 7665 6334 2076       cdef vec4 v
-000063f0: 612c 2076 620a 2020 2020 2020 2020 6364  a, vb.        cd
-00006400: 6566 2069 6e74 2063 6f70 0a0a 2020 2020  ef int cop..    
-00006410: 2020 2020 636f 7020 3d20 6f70 0a0a 2020      cop = op..  
-00006420: 2020 2020 2020 7461 203d 2074 7970 6528        ta = type(
-00006430: 6129 0a20 2020 2020 2020 2074 6220 3d20  a).        tb = 
-00006440: 7479 7065 2862 290a 2020 2020 2020 2020  type(b).        
-00006450: 6966 2028 7461 213d 7665 6334 206f 7220  if (ta!=vec4 or 
-00006460: 7462 213d 7665 6334 293a 0a20 2020 2020  tb!=vec4):.     
-00006470: 2020 2020 2020 2069 6620 636f 703d 3d33         if cop==3
-00006480: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00006490: 2020 7265 7475 726e 2031 0a20 2020 2020    return 1.     
-000064a0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-000064b0: 2020 2020 2020 2020 2020 2020 2072 6574               ret
-000064c0: 7572 6e20 300a 0a20 2020 2020 2020 2076  urn 0..        v
-000064d0: 6120 3d20 610a 2020 2020 2020 2020 7662  a = a.        vb
-000064e0: 203d 2062 0a0a 2020 2020 2020 2020 2320   = b..        # 
-000064f0: 3c0a 2020 2020 2020 2020 6966 2063 6f70  <.        if cop
-00006500: 3d3d 303a 0a20 2020 2020 2020 2020 2020  ==0:.           
-00006510: 2072 6574 7572 6e20 2876 612e 783c 7662   return (va.x<vb
-00006520: 2e78 2061 6e64 2076 612e 793c 7662 2e79  .x and va.y<vb.y
-00006530: 2061 6e64 2076 612e 7a3c 7662 2e7a 2061   and va.z<vb.z a
-00006540: 6e64 2076 612e 773c 7662 2e77 290a 2020  nd va.w<vb.w).  
-00006550: 2020 2020 2020 2320 3c3d 0a20 2020 2020        # <=.     
-00006560: 2020 2065 6c69 6620 636f 703d 3d31 3a0a     elif cop==1:.
-00006570: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00006580: 726e 2028 7661 2e78 2d65 7073 3c3d 7662  rn (va.x-eps<=vb
-00006590: 2e78 2061 6e64 2076 612e 792d 6570 733c  .x and va.y-eps<
-000065a0: 3d76 622e 7920 616e 6420 7661 2e7a 2d65  =vb.y and va.z-e
-000065b0: 7073 3c3d 7662 2e7a 2061 6e64 2076 612e  ps<=vb.z and va.
-000065c0: 772d 6570 733c 3d76 622e 7729 0a20 2020  w-eps<=vb.w).   
-000065d0: 2020 2020 2023 203d 3d0a 2020 2020 2020       # ==.      
-000065e0: 2020 656c 6966 2063 6f70 3d3d 323a 0a20    elif cop==2:. 
-000065f0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00006600: 6e20 2866 6162 7328 7661 2e78 2d76 622e  n (fabs(va.x-vb.
-00006610: 7829 3c3d 6570 7320 616e 6420 6661 6273  x)<=eps and fabs
-00006620: 2876 612e 792d 7662 2e79 293c 3d65 7073  (va.y-vb.y)<=eps
-00006630: 2061 6e64 2066 6162 7328 7661 2e7a 2d76   and fabs(va.z-v
-00006640: 622e 7a29 3c3d 6570 7320 616e 6420 6661  b.z)<=eps and fa
-00006650: 6273 2876 612e 772d 7662 2e77 293c 3d65  bs(va.w-vb.w)<=e
-00006660: 7073 290a 2020 2020 2020 2020 2320 213d  ps).        # !=
-00006670: 0a20 2020 2020 2020 2065 6c69 6620 636f  .        elif co
-00006680: 703d 3d33 3a0a 2020 2020 2020 2020 2020  p==3:.          
-00006690: 2020 7265 7475 726e 2028 6661 6273 2876    return (fabs(v
-000066a0: 612e 782d 7662 2e78 293e 6570 7320 6f72  a.x-vb.x)>eps or
-000066b0: 2066 6162 7328 7661 2e79 2d76 622e 7929   fabs(va.y-vb.y)
-000066c0: 3e65 7073 2061 6e64 2066 6162 7328 7661  >eps and fabs(va
-000066d0: 2e7a 2d76 622e 7a29 3e65 7073 2061 6e64  .z-vb.z)>eps and
-000066e0: 2066 6162 7328 7661 2e77 2d76 622e 7729   fabs(va.w-vb.w)
-000066f0: 3e65 7073 290a 2020 2020 2020 2020 2320  >eps).        # 
-00006700: 3e0a 2020 2020 2020 2020 656c 6966 2063  >.        elif c
-00006710: 6f70 3d3d 343a 0a20 2020 2020 2020 2020  op==4:.         
-00006720: 2020 2072 6574 7572 6e20 2876 612e 783e     return (va.x>
-00006730: 7662 2e78 2061 6e64 2076 612e 793e 7662  vb.x and va.y>vb
-00006740: 2e79 2061 6e64 2076 612e 7a3e 7662 2e7a  .y and va.z>vb.z
-00006750: 2061 6e64 2076 612e 773e 7662 2e77 290a   and va.w>vb.w).
-00006760: 2020 2020 2020 2020 2320 3e3d 0a20 2020          # >=.   
-00006770: 2020 2020 2065 6c69 6620 636f 703d 3d35       elif cop==5
-00006780: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-00006790: 7475 726e 2028 7661 2e78 2b65 7073 3e3d  turn (va.x+eps>=
-000067a0: 7662 2e78 2061 6e64 2076 612e 792b 6570  vb.x and va.y+ep
-000067b0: 733e 3d76 622e 7920 616e 6420 7661 2e7a  s>=vb.y and va.z
-000067c0: 2b65 7073 3e3d 7662 2e7a 2061 6e64 2076  +eps>=vb.z and v
-000067d0: 612e 772b 6570 733e 3d76 622e 7729 0a20  a.w+eps>=vb.w). 
-000067e0: 2020 2020 2020 2023 2073 6f6e 7374 2028         # sonst (
-000067f0: 4665 686c 6572 290a 2020 2020 2020 2020  Fehler).        
-00006800: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00006810: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-00006820: 6f72 2c22 696e 7465 726e 616c 2065 7272  or,"internal err
-00006830: 6f72 3a20 696c 6c65 6761 6c20 7269 6368  or: illegal rich
-00006840: 2063 6f6d 7061 7269 736f 6e20 6e75 6d62   comparison numb
-00006850: 6572 220a 0a20 2020 2064 6566 205f 5f61  er"..    def __a
-00006860: 6464 5f5f 2876 6563 3420 612c 2076 6563  dd__(vec4 a, vec
-00006870: 3420 6229 3a0a 2020 2020 2020 2020 2222  4 b):.        ""
-00006880: 2256 6563 746f 7220 6164 6469 7469 6f6e  "Vector addition
-00006890: 2e0a 0a20 2020 2020 2020 203e 3e3e 2061  ...        >>> a
-000068a0: 3d76 6563 3428 312e 302c 2030 2e35 2c20  =vec4(1.0, 0.5, 
-000068b0: 2d31 2e38 2c20 302e 3229 0a20 2020 2020  -1.8, 0.2).     
-000068c0: 2020 203e 3e3e 2062 3d76 6563 3428 2d30     >>> b=vec4(-0
-000068d0: 2e33 2c20 302e 3735 2c20 302e 352c 2030  .3, 0.75, 0.5, 0
-000068e0: 2e33 290a 2020 2020 2020 2020 3e3e 3e20  .3).        >>> 
-000068f0: 7072 696e 7420 612b 620a 2020 2020 2020  print a+b.      
-00006900: 2020 2830 2e37 3030 302c 2031 2e32 3530    (0.7000, 1.250
-00006910: 302c 202d 312e 3330 3030 2c20 302e 3530  0, -1.3000, 0.50
-00006920: 3030 290a 2020 2020 2020 2020 2222 220a  00).        """.
-00006930: 2020 2020 2020 2020 6364 6566 2076 6563          cdef vec
-00006940: 3420 7265 730a 2020 2020 2020 2020 7265  4 res.        re
-00006950: 7320 3d20 7665 6334 2829 0a20 2020 2020  s = vec4().     
-00006960: 2020 2072 6573 2e78 203d 2061 2e78 2b62     res.x = a.x+b
-00006970: 2e78 0a20 2020 2020 2020 2072 6573 2e79  .x.        res.y
-00006980: 203d 2061 2e79 2b62 2e79 0a20 2020 2020   = a.y+b.y.     
-00006990: 2020 2072 6573 2e7a 203d 2061 2e7a 2b62     res.z = a.z+b
-000069a0: 2e7a 0a20 2020 2020 2020 2072 6573 2e77  .z.        res.w
-000069b0: 203d 2061 2e77 2b62 2e77 0a20 2020 2020   = a.w+b.w.     
-000069c0: 2020 2072 6574 7572 6e20 7265 730a 0a20     return res.. 
-000069d0: 2020 2064 6566 205f 5f73 7562 5f5f 2876     def __sub__(v
-000069e0: 6563 3420 612c 2076 6563 3420 6229 3a0a  ec4 a, vec4 b):.
-000069f0: 2020 2020 2020 2020 2222 2256 6563 746f          """Vecto
-00006a00: 7220 7375 6274 7261 6374 696f 6e2e 0a0a  r subtraction...
-00006a10: 2020 2020 2020 2020 3e3e 3e20 613d 7665          >>> a=ve
-00006a20: 6334 2831 2e30 2c20 302e 352c 202d 312e  c4(1.0, 0.5, -1.
-00006a30: 382c 2030 2e32 290a 2020 2020 2020 2020  8, 0.2).        
-00006a40: 3e3e 3e20 623d 7665 6334 282d 302e 332c  >>> b=vec4(-0.3,
-00006a50: 2030 2e37 352c 2030 2e35 2c20 302e 3329   0.75, 0.5, 0.3)
-00006a60: 0a20 2020 2020 2020 203e 3e3e 2070 7269  .        >>> pri
-00006a70: 6e74 2061 2d62 0a20 2020 2020 2020 2028  nt a-b.        (
-00006a80: 312e 3330 3030 2c20 2d30 2e32 3530 302c  1.3000, -0.2500,
-00006a90: 202d 322e 3330 3030 2c20 2d30 2e31 3030   -2.3000, -0.100
-00006aa0: 3029 0a20 2020 2020 2020 2022 2222 0a20  0).        """. 
-00006ab0: 2020 2020 2020 2063 6465 6620 7665 6334         cdef vec4
-00006ac0: 2072 6573 0a20 2020 2020 2020 2072 6573   res.        res
-00006ad0: 203d 2076 6563 3428 290a 2020 2020 2020   = vec4().      
-00006ae0: 2020 7265 732e 7820 3d20 612e 782d 622e    res.x = a.x-b.
-00006af0: 780a 2020 2020 2020 2020 7265 732e 7920  x.        res.y 
-00006b00: 3d20 612e 792d 622e 790a 2020 2020 2020  = a.y-b.y.      
-00006b10: 2020 7265 732e 7a20 3d20 612e 7a2d 622e    res.z = a.z-b.
-00006b20: 7a0a 2020 2020 2020 2020 7265 732e 7720  z.        res.w 
-00006b30: 3d20 612e 772d 622e 770a 2020 2020 2020  = a.w-b.w.      
-00006b40: 2020 7265 7475 726e 2072 6573 0a0a 2020    return res..  
-00006b50: 2020 6465 6620 5f5f 6d75 6c5f 5f28 612c    def __mul__(a,
-00006b60: 2062 293a 0a20 2020 2020 2020 2022 2222   b):.        """
-00006b70: 4d75 6c74 6970 6c69 6361 7469 6f6e 2077  Multiplication w
-00006b80: 6974 6820 6120 7363 616c 6172 206f 7220  ith a scalar or 
-00006b90: 646f 7420 7072 6f64 7563 742e 0a0a 2020  dot product...  
-00006ba0: 2020 2020 2020 3e3e 3e20 613d 7665 6334        >>> a=vec4
-00006bb0: 2831 2e30 2c20 302e 352c 202d 312e 382c  (1.0, 0.5, -1.8,
-00006bc0: 2030 2e32 290a 2020 2020 2020 2020 3e3e   0.2).        >>
-00006bd0: 3e20 623d 7665 6334 282d 302e 332c 2030  > b=vec4(-0.3, 0
-00006be0: 2e37 352c 2030 2e35 2c20 302e 3329 0a20  .75, 0.5, 0.3). 
-00006bf0: 2020 2020 2020 203e 3e3e 2070 7269 6e74         >>> print
-00006c00: 2061 2a32 2e30 0a20 2020 2020 2020 2028   a*2.0.        (
-00006c10: 322e 3030 3030 2c20 312e 3030 3030 2c20  2.0000, 1.0000, 
-00006c20: 2d33 2e36 3030 302c 2030 2e34 3030 3029  -3.6000, 0.4000)
-00006c30: 0a20 2020 2020 2020 203e 3e3e 2070 7269  .        >>> pri
-00006c40: 6e74 2032 2e30 2a61 0a20 2020 2020 2020  nt 2.0*a.       
-00006c50: 2028 322e 3030 3030 2c20 312e 3030 3030   (2.0000, 1.0000
-00006c60: 2c20 2d33 2e36 3030 302c 2030 2e34 3030  , -3.6000, 0.400
-00006c70: 3029 0a20 2020 2020 2020 203e 3e3e 2070  0).        >>> p
-00006c80: 7269 6e74 2061 2a62 0a20 2020 2020 2020  rint a*b.       
-00006c90: 202d 302e 3736 350a 2020 2020 2020 2020   -0.765.        
-00006ca0: 2222 220a 0a20 2020 2020 2020 2063 6465  """..        cde
-00006cb0: 6620 7665 6334 2072 6573 2c20 7661 2c20  f vec4 res, va, 
-00006cc0: 7662 0a20 2020 2020 2020 2063 6465 6620  vb.        cdef 
-00006cd0: 646f 7562 6c65 2072 0a0a 2020 2020 2020  double r..      
-00006ce0: 2020 7461 203d 2074 7970 6528 6129 0a20    ta = type(a). 
-00006cf0: 2020 2020 2020 2074 6220 3d20 7479 7065         tb = type
-00006d00: 2862 290a 0a20 2020 2020 2020 2069 6620  (b)..        if 
-00006d10: 7461 2069 7320 7665 6334 3a0a 2020 2020  ta is vec4:.    
-00006d20: 2020 2020 2020 2020 7661 203d 2061 0a20          va = a. 
-00006d30: 2020 2020 2020 2020 2020 2069 6620 7462             if tb
-00006d40: 2069 7320 7665 6334 3a0a 2020 2020 2020   is vec4:.      
-00006d50: 2020 2020 2020 2020 2020 2320 7665 6334            # vec4
-00006d60: 2a76 6563 3420 2020 2864 6f74 2070 726f  *vec4   (dot pro
-00006d70: 6475 6374 2061 2a62 290a 2020 2020 2020  duct a*b).      
-00006d80: 2020 2020 2020 2020 2020 7662 203d 2062            vb = b
-00006d90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00006da0: 2072 6574 7572 6e20 7661 2e78 2a76 622e   return va.x*vb.
-00006db0: 7820 2b20 7661 2e79 2a76 622e 7920 2b20  x + va.y*vb.y + 
-00006dc0: 7661 2e7a 2a76 622e 7a20 2b20 7661 2e77  va.z*vb.z + va.w
-00006dd0: 2a76 622e 770a 2020 2020 2020 2020 2020  *vb.w.          
-00006de0: 2020 656c 6966 2074 6220 6973 2066 6c6f    elif tb is flo
-00006df0: 6174 206f 7220 7462 2069 7320 696e 7420  at or tb is int 
-00006e00: 6f72 2074 6220 6973 206c 6f6e 673a 0a20  or tb is long:. 
-00006e10: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00006e20: 2076 6563 342a 7363 616c 6172 0a20 2020   vec4*scalar.   
-00006e30: 2020 2020 2020 2020 2020 2020 2072 6573               res
-00006e40: 203d 2076 6563 3428 290a 2020 2020 2020   = vec4().      
-00006e50: 2020 2020 2020 2020 2020 7220 2020 3d20            r   = 
-00006e60: 620a 2020 2020 2020 2020 2020 2020 2020  b.              
-00006e70: 2020 7265 732e 7820 3d20 7661 2e78 2a72    res.x = va.x*r
-00006e80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00006e90: 2072 6573 2e79 203d 2076 612e 792a 720a   res.y = va.y*r.
-00006ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006eb0: 7265 732e 7a20 3d20 7661 2e7a 2a72 0a20  res.z = va.z*r. 
-00006ec0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00006ed0: 6573 2e77 203d 2076 612e 772a 720a 2020  es.w = va.w*r.  
-00006ee0: 2020 2020 2020 2020 2020 2020 2020 7265                re
-00006ef0: 7475 726e 2072 6573 0a20 2020 2020 2020  turn res.       
-00006f00: 2020 2020 2065 6c69 6620 7462 2069 7320       elif tb is 
-00006f10: 6d61 7434 3a0a 2020 2020 2020 2020 2020  mat4:.          
-00006f20: 2020 2020 2020 2320 7665 6334 2a6d 6174        # vec4*mat
-00006f30: 340a 2020 2020 2020 2020 2020 2020 2020  4.              
-00006f40: 2020 7265 7475 726e 2062 2e5f 5f72 6d75    return b.__rmu
-00006f50: 6c5f 5f28 6129 0a20 2020 2020 2020 2065  l__(a).        e
-00006f60: 6c69 6620 7461 2069 7320 666c 6f61 7420  lif ta is float 
-00006f70: 6f72 2074 6120 6973 2069 6e74 206f 7220  or ta is int or 
-00006f80: 7461 2069 7320 6c6f 6e67 3a0a 2020 2020  ta is long:.    
-00006f90: 2020 2020 2020 2020 6966 2074 6220 6973          if tb is
-00006fa0: 2076 6563 343a 0a20 2020 2020 2020 2020   vec4:.         
-00006fb0: 2020 2020 2020 2023 2073 6361 6c61 722a         # scalar*
-00006fc0: 7665 6334 0a20 2020 2020 2020 2020 2020  vec4.           
-00006fd0: 2020 2020 2072 6573 203d 2076 6563 3428       res = vec4(
-00006fe0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00006ff0: 2020 7662 2020 3d20 620a 2020 2020 2020    vb  = b.      
-00007000: 2020 2020 2020 2020 2020 7220 2020 3d20            r   = 
-00007010: 610a 2020 2020 2020 2020 2020 2020 2020  a.              
-00007020: 2020 7265 732e 7820 3d20 722a 7662 2e78    res.x = r*vb.x
-00007030: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00007040: 2072 6573 2e79 203d 2072 2a76 622e 790a   res.y = r*vb.y.
-00007050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007060: 7265 732e 7a20 3d20 722a 7662 2e7a 0a20  res.z = r*vb.z. 
-00007070: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00007080: 6573 2e77 203d 2072 2a76 622e 770a 2020  es.w = r*vb.w.  
-00007090: 2020 2020 2020 2020 2020 2020 2020 7265                re
-000070a0: 7475 726e 2072 6573 0a0a 2020 2020 2020  turn res..      
-000070b0: 2020 7261 6973 6520 5479 7065 4572 726f    raise TypeErro
-000070c0: 722c 2022 756e 7375 7070 6f72 7465 6420  r, "unsupported 
-000070d0: 6f70 6572 616e 6420 7479 7065 2066 6f72  operand type for
-000070e0: 202a 220a 0a20 2020 2064 6566 205f 5f64   *"..    def __d
-000070f0: 6976 5f5f 2876 6563 3420 612c 2062 293a  iv__(vec4 a, b):
-00007100: 0a20 2020 2020 2020 2023 2050 7974 686f  .        # Pytho
-00007110: 6e20 320a 2020 2020 2020 2020 7265 7475  n 2.        retu
-00007120: 726e 2076 6563 342e 5f5f 7472 7565 6469  rn vec4.__truedi
-00007130: 765f 5f28 612c 6229 0a0a 2020 2020 6465  v__(a,b)..    de
-00007140: 6620 5f5f 7472 7565 6469 765f 5f28 7665  f __truediv__(ve
-00007150: 6334 2061 2c20 6229 3a0a 2020 2020 2020  c4 a, b):.      
-00007160: 2020 2222 2244 6976 6973 696f 6e20 6279    """Division by
-00007170: 2073 6361 6c61 722e 0a0a 2020 2020 2020   scalar...      
-00007180: 2020 3e3e 3e20 613d 7665 6334 2831 2e30    >>> a=vec4(1.0
-00007190: 2c20 302e 352c 202d 312e 382c 2030 2e32  , 0.5, -1.8, 0.2
-000071a0: 290a 2020 2020 2020 2020 3e3e 3e20 7072  ).        >>> pr
-000071b0: 696e 7420 612f 322e 300a 2020 2020 2020  int a/2.0.      
-000071c0: 2020 2830 2e35 3030 302c 2030 2e32 3530    (0.5000, 0.250
-000071d0: 302c 202d 302e 3930 3030 2c20 302e 3130  0, -0.9000, 0.10
-000071e0: 3030 290a 2020 2020 2020 2020 2222 220a  00).        """.
-000071f0: 0a20 2020 2020 2020 2063 6465 6620 7665  .        cdef ve
-00007200: 6334 2072 6573 0a20 2020 2020 2020 2063  c4 res.        c
-00007210: 6465 6620 646f 7562 6c65 2072 0a0a 2020  def double r..  
-00007220: 2020 2020 2020 7462 203d 2074 7970 6528        tb = type(
-00007230: 6229 0a0a 2020 2020 2020 2020 6966 2074  b)..        if t
-00007240: 6220 6973 2066 6c6f 6174 206f 7220 7462  b is float or tb
-00007250: 2069 7320 696e 7420 6f72 2074 6220 6973   is int or tb is
-00007260: 206c 6f6e 673a 0a20 2020 2020 2020 2020   long:.         
-00007270: 2020 2023 2076 6563 342f 7363 616c 6172     # vec4/scalar
-00007280: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
-00007290: 203d 2076 6563 3428 290a 2020 2020 2020   = vec4().      
-000072a0: 2020 2020 2020 7220 3d20 620a 2020 2020        r = b.    
-000072b0: 2020 2020 2020 2020 6966 2066 6162 7328          if fabs(
-000072c0: 7229 3c3d 6570 733a 0a20 2020 2020 2020  r)<=eps:.       
-000072d0: 2020 2020 2020 2020 2072 6169 7365 205a           raise Z
-000072e0: 6572 6f44 6976 6973 696f 6e45 7272 6f72  eroDivisionError
-000072f0: 2c22 7665 6334 2064 6976 6973 696f 6e22  ,"vec4 division"
-00007300: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
-00007310: 2e78 203d 2061 2e78 2f72 0a20 2020 2020  .x = a.x/r.     
-00007320: 2020 2020 2020 2072 6573 2e79 203d 2061         res.y = a
-00007330: 2e79 2f72 0a20 2020 2020 2020 2020 2020  .y/r.           
-00007340: 2072 6573 2e7a 203d 2061 2e7a 2f72 0a20   res.z = a.z/r. 
-00007350: 2020 2020 2020 2020 2020 2072 6573 2e77             res.w
-00007360: 203d 2061 2e77 2f72 0a20 2020 2020 2020   = a.w/r.       
-00007370: 2020 2020 2072 6574 7572 6e20 7265 730a       return res.
-00007380: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00007390: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-000073a0: 5479 7065 4572 726f 722c 2022 756e 7375  TypeError, "unsu
-000073b0: 7070 6f72 7465 6420 6f70 6572 616e 6420  pported operand 
-000073c0: 7479 7065 2066 6f72 202f 220a 0a20 2020  type for /"..   
-000073d0: 2064 6566 205f 5f6d 6f64 5f5f 2876 6563   def __mod__(vec
-000073e0: 3420 7365 6c66 2c20 6229 3a0a 2020 2020  4 self, b):.    
-000073f0: 2020 2020 2222 224d 6f64 756c 6f20 2863      """Modulo (c
-00007400: 6f6d 706f 6e65 6e74 2077 6973 6529 0a0a  omponent wise)..
-00007410: 2020 2020 2020 2020 3e3e 3e20 613d 7665          >>> a=ve
-00007420: 6334 2833 2e30 2c20 322e 352c 202d 312e  c4(3.0, 2.5, -1.
-00007430: 382c 2030 2e32 290a 2020 2020 2020 2020  8, 0.2).        
-00007440: 3e3e 3e20 7072 696e 7420 6125 322e 300a  >>> print a%2.0.
-00007450: 2020 2020 2020 2020 2831 2e30 3030 302c          (1.0000,
-00007460: 2030 2e35 3030 302c 2030 2e32 3030 302c   0.5000, 0.2000,
-00007470: 2030 2e32 3030 3029 0a20 2020 2020 2020   0.2000).       
-00007480: 2022 2222 0a20 2020 2020 2020 2063 6465   """.        cde
-00007490: 6620 7665 6334 2072 6573 2c20 7662 0a20  f vec4 res, vb. 
-000074a0: 2020 2020 2020 2063 6465 6620 646f 7562         cdef doub
-000074b0: 6c65 2072 0a0a 2020 2020 2020 2020 7462  le r..        tb
-000074c0: 203d 2074 7970 6528 6229 0a0a 2020 2020   = type(b)..    
-000074d0: 2020 2020 6966 2074 6220 6973 2066 6c6f      if tb is flo
-000074e0: 6174 206f 7220 7462 2069 7320 696e 7420  at or tb is int 
-000074f0: 6f72 2074 6220 6973 206c 6f6e 673a 0a20  or tb is long:. 
-00007500: 2020 2020 2020 2020 2020 2023 2076 6563             # vec
-00007510: 3425 7363 616c 6172 0a20 2020 2020 2020  4%scalar.       
-00007520: 2020 2020 2072 6573 203d 2076 6563 3428       res = vec4(
-00007530: 290a 2020 2020 2020 2020 2020 2020 7220  ).            r 
-00007540: 3d20 620a 2020 2020 2020 2020 2020 2020  = b.            
-00007550: 6966 2066 6162 7328 7229 3c3d 6570 733a  if fabs(r)<=eps:
-00007560: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00007570: 2072 6169 7365 205a 6572 6f44 6976 6973   raise ZeroDivis
-00007580: 696f 6e45 7272 6f72 2c22 7665 6334 206d  ionError,"vec4 m
-00007590: 6f64 756c 6f22 0a20 2020 2020 2020 2020  odulo".         
-000075a0: 2020 2072 6573 2e78 203d 205f 666d 6f64     res.x = _fmod
-000075b0: 2873 656c 662e 782c 7229 0a20 2020 2020  (self.x,r).     
-000075c0: 2020 2020 2020 2072 6573 2e79 203d 205f         res.y = _
-000075d0: 666d 6f64 2873 656c 662e 792c 7229 0a20  fmod(self.y,r). 
-000075e0: 2020 2020 2020 2020 2020 2072 6573 2e7a             res.z
-000075f0: 203d 205f 666d 6f64 2873 656c 662e 7a2c   = _fmod(self.z,
-00007600: 7229 0a20 2020 2020 2020 2020 2020 2072  r).            r
-00007610: 6573 2e77 203d 205f 666d 6f64 2873 656c  es.w = _fmod(sel
-00007620: 662e 772c 7229 0a20 2020 2020 2020 2020  f.w,r).         
-00007630: 2020 2072 6574 7572 6e20 7265 730a 2020     return res.  
-00007640: 2020 2020 2020 656c 6966 2074 6220 6973        elif tb is
-00007650: 2076 6563 343a 0a20 2020 2020 2020 2020   vec4:.         
-00007660: 2020 2023 2076 6563 3425 7665 6334 0a20     # vec4%vec4. 
-00007670: 2020 2020 2020 2020 2020 2072 6573 203d             res =
-00007680: 2076 6563 3428 290a 2020 2020 2020 2020   vec4().        
-00007690: 2020 2020 7662 203d 2062 0a20 2020 2020      vb = b.     
-000076a0: 2020 2020 2020 2069 6620 2866 6162 7328         if (fabs(
-000076b0: 7662 2e78 293c 3d65 7073 206f 7220 6661  vb.x)<=eps or fa
-000076c0: 6273 2876 622e 7929 3c3d 6570 7320 6f72  bs(vb.y)<=eps or
-000076d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000076e0: 2066 6162 7328 7662 2e7a 293c 3d65 7073   fabs(vb.z)<=eps
-000076f0: 206f 7220 6661 6273 2876 622e 7729 3c3d   or fabs(vb.w)<=
-00007700: 6570 7329 3a0a 2020 2020 2020 2020 2020  eps):.          
-00007710: 2020 2020 2020 7261 6973 6520 5a65 726f        raise Zero
-00007720: 4469 7669 7369 6f6e 4572 726f 722c 2276  DivisionError,"v
-00007730: 6563 3420 6d6f 6475 6c6f 220a 2020 2020  ec4 modulo".    
-00007740: 2020 2020 2020 2020 7265 732e 7820 3d20          res.x = 
-00007750: 5f66 6d6f 6428 7365 6c66 2e78 2c20 7662  _fmod(self.x, vb
-00007760: 2e78 290a 2020 2020 2020 2020 2020 2020  .x).            
-00007770: 7265 732e 7920 3d20 5f66 6d6f 6428 7365  res.y = _fmod(se
-00007780: 6c66 2e79 2c20 7662 2e79 290a 2020 2020  lf.y, vb.y).    
-00007790: 2020 2020 2020 2020 7265 732e 7a20 3d20          res.z = 
-000077a0: 5f66 6d6f 6428 7365 6c66 2e7a 2c20 7662  _fmod(self.z, vb
-000077b0: 2e7a 290a 2020 2020 2020 2020 2020 2020  .z).            
-000077c0: 7265 732e 7720 3d20 5f66 6d6f 6428 7365  res.w = _fmod(se
-000077d0: 6c66 2e77 2c20 7662 2e77 290a 2020 2020  lf.w, vb.w).    
-000077e0: 2020 2020 2020 2020 7265 7475 726e 2072          return r
-000077f0: 6573 0a20 2020 2020 2020 2065 6c73 653a  es.        else:
-00007800: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-00007810: 7365 2054 7970 6545 7272 6f72 2c20 2275  se TypeError, "u
-00007820: 6e73 7570 706f 7274 6564 206f 7065 7261  nsupported opera
-00007830: 6e64 2074 7970 6520 666f 7220 2522 0a0a  nd type for %"..
-00007840: 2020 2020 6465 6620 5f5f 6e65 675f 5f28      def __neg__(
-00007850: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
-00007860: 2222 4e65 6761 7469 6f6e 2e0a 0a20 2020  ""Negation...   
-00007870: 2020 2020 203e 3e3e 2061 3d76 6563 3428       >>> a=vec4(
-00007880: 332e 302c 2032 2e35 2c20 2d31 2e38 2c20  3.0, 2.5, -1.8, 
-00007890: 302e 3229 0a20 2020 2020 2020 203e 3e3e  0.2).        >>>
-000078a0: 2070 7269 6e74 202d 610a 2020 2020 2020   print -a.      
-000078b0: 2020 282d 332e 3030 3030 2c20 2d32 2e35    (-3.0000, -2.5
-000078c0: 3030 302c 2031 2e38 3030 302c 202d 302e  000, 1.8000, -0.
-000078d0: 3230 3030 290a 2020 2020 2020 2020 2222  2000).        ""
-000078e0: 220a 2020 2020 2020 2020 6364 6566 2076  ".        cdef v
-000078f0: 6563 3420 7265 730a 2020 2020 2020 2020  ec4 res.        
-00007900: 7265 7320 3d20 7665 6334 2829 0a20 2020  res = vec4().   
-00007910: 2020 2020 2072 6573 2e78 203d 202d 7365       res.x = -se
-00007920: 6c66 2e78 0a20 2020 2020 2020 2072 6573  lf.x.        res
-00007930: 2e79 203d 202d 7365 6c66 2e79 0a20 2020  .y = -self.y.   
-00007940: 2020 2020 2072 6573 2e7a 203d 202d 7365       res.z = -se
-00007950: 6c66 2e7a 0a20 2020 2020 2020 2072 6573  lf.z.        res
-00007960: 2e77 203d 202d 7365 6c66 2e77 0a20 2020  .w = -self.w.   
-00007970: 2020 2020 2072 6574 7572 6e20 7265 730a       return res.
-00007980: 0a20 2020 2064 6566 205f 5f70 6f73 5f5f  .    def __pos__
-00007990: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-000079a0: 2222 220a 2020 2020 2020 2020 3e3e 3e20  """.        >>> 
-000079b0: 613d 7665 6334 2833 2e30 2c20 322e 352c  a=vec4(3.0, 2.5,
-000079c0: 202d 312e 382c 2030 2e32 290a 2020 2020   -1.8, 0.2).    
-000079d0: 2020 2020 3e3e 3e20 7072 696e 7420 2b61      >>> print +a
-000079e0: 0a20 2020 2020 2020 2028 332e 3030 3030  .        (3.0000
-000079f0: 2c20 322e 3530 3030 2c20 2d31 2e38 3030  , 2.5000, -1.800
-00007a00: 302c 2030 2e32 3030 3029 0a20 2020 2020  0, 0.2000).     
-00007a10: 2020 2022 2222 0a20 2020 2020 2020 2063     """.        c
-00007a20: 6465 6620 7665 6334 2072 6573 0a20 2020  def vec4 res.   
-00007a30: 2020 2020 2072 6573 203d 2076 6563 3428       res = vec4(
-00007a40: 290a 2020 2020 2020 2020 7265 732e 7820  ).        res.x 
-00007a50: 3d20 7365 6c66 2e78 0a20 2020 2020 2020  = self.x.       
-00007a60: 2072 6573 2e79 203d 2073 656c 662e 790a   res.y = self.y.
-00007a70: 2020 2020 2020 2020 7265 732e 7a20 3d20          res.z = 
-00007a80: 7365 6c66 2e7a 0a20 2020 2020 2020 2072  self.z.        r
-00007a90: 6573 2e77 203d 2073 656c 662e 770a 2020  es.w = self.w.  
-00007aa0: 2020 2020 2020 7265 7475 726e 2072 6573        return res
-00007ab0: 0a0a 2020 2020 6465 6620 5f5f 6961 6464  ..    def __iadd
-00007ac0: 5f5f 2873 656c 662c 2076 6563 3420 6f74  __(self, vec4 ot
-00007ad0: 6865 7229 3a0a 2020 2020 2020 2020 2222  her):.        ""
-00007ae0: 2249 6e6c 696e 6520 7665 6374 6f72 2061  "Inline vector a
-00007af0: 6464 6974 696f 6e2e 0a0a 2020 2020 2020  ddition...      
-00007b00: 2020 3e3e 3e20 613d 7665 6334 2831 2e30    >>> a=vec4(1.0
-00007b10: 2c20 302e 352c 202d 312e 382c 2030 2e32  , 0.5, -1.8, 0.2
-00007b20: 290a 2020 2020 2020 2020 3e3e 3e20 623d  ).        >>> b=
-00007b30: 7665 6334 282d 302e 332c 2030 2e37 352c  vec4(-0.3, 0.75,
-00007b40: 2030 2e35 2c20 302e 3329 0a20 2020 2020   0.5, 0.3).     
-00007b50: 2020 203e 3e3e 2061 2b3d 620a 2020 2020     >>> a+=b.    
-00007b60: 2020 2020 3e3e 3e20 7072 696e 7420 610a      >>> print a.
-00007b70: 2020 2020 2020 2020 2830 2e37 3030 302c          (0.7000,
-00007b80: 2031 2e32 3530 302c 202d 312e 3330 3030   1.2500, -1.3000
-00007b90: 2c20 302e 3530 3030 290a 2020 2020 2020  , 0.5000).      
-00007ba0: 2020 2222 220a 2020 2020 2020 2020 7365    """.        se
-00007bb0: 6c66 2e78 3d73 656c 662e 782b 6f74 6865  lf.x=self.x+othe
-00007bc0: 722e 780a 2020 2020 2020 2020 7365 6c66  r.x.        self
-00007bd0: 2e79 3d73 656c 662e 792b 6f74 6865 722e  .y=self.y+other.
-00007be0: 790a 2020 2020 2020 2020 7365 6c66 2e7a  y.        self.z
-00007bf0: 3d73 656c 662e 7a2b 6f74 6865 722e 7a0a  =self.z+other.z.
-00007c00: 2020 2020 2020 2020 7365 6c66 2e77 3d73          self.w=s
-00007c10: 656c 662e 772b 6f74 6865 722e 770a 2020  elf.w+other.w.  
-00007c20: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00007c30: 660a 0a20 2020 2064 6566 205f 5f69 7375  f..    def __isu
-00007c40: 625f 5f28 7365 6c66 2c20 7665 6334 206f  b__(self, vec4 o
-00007c50: 7468 6572 293a 0a20 2020 2020 2020 2022  ther):.        "
-00007c60: 2222 496e 6c69 6e65 2076 6563 746f 7220  ""Inline vector 
-00007c70: 7375 6274 7261 6374 696f 6e2e 0a0a 2020  subtraction...  
-00007c80: 2020 2020 2020 3e3e 3e20 613d 7665 6334        >>> a=vec4
-00007c90: 2831 2e30 2c20 302e 352c 202d 312e 382c  (1.0, 0.5, -1.8,
-00007ca0: 2030 2e32 290a 2020 2020 2020 2020 3e3e   0.2).        >>
-00007cb0: 3e20 623d 7665 6334 282d 302e 332c 2030  > b=vec4(-0.3, 0
-00007cc0: 2e37 352c 2030 2e35 2c20 302e 3329 0a20  .75, 0.5, 0.3). 
-00007cd0: 2020 2020 2020 203e 3e3e 2061 2d3d 620a         >>> a-=b.
-00007ce0: 2020 2020 2020 2020 3e3e 3e20 7072 696e          >>> prin
-00007cf0: 7420 610a 2020 2020 2020 2020 2831 2e33  t a.        (1.3
-00007d00: 3030 302c 202d 302e 3235 3030 2c20 2d32  000, -0.2500, -2
-00007d10: 2e33 3030 302c 202d 302e 3130 3030 290a  .3000, -0.1000).
-00007d20: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00007d30: 2020 2020 7365 6c66 2e78 3d73 656c 662e      self.x=self.
-00007d40: 782d 6f74 6865 722e 780a 2020 2020 2020  x-other.x.      
-00007d50: 2020 7365 6c66 2e79 3d73 656c 662e 792d    self.y=self.y-
-00007d60: 6f74 6865 722e 790a 2020 2020 2020 2020  other.y.        
-00007d70: 7365 6c66 2e7a 3d73 656c 662e 7a2d 6f74  self.z=self.z-ot
-00007d80: 6865 722e 7a0a 2020 2020 2020 2020 7365  her.z.        se
-00007d90: 6c66 2e77 3d73 656c 662e 772d 6f74 6865  lf.w=self.w-othe
-00007da0: 722e 770a 2020 2020 2020 2020 7265 7475  r.w.        retu
-00007db0: 726e 2073 656c 660a 0a20 2020 2064 6566  rn self..    def
-00007dc0: 205f 5f69 6d75 6c5f 5f28 7365 6c66 2c20   __imul__(self, 
-00007dd0: 6f74 6865 7229 3a0a 2020 2020 2020 2020  other):.        
-00007de0: 2222 2249 6e6c 696e 6520 6d75 6c74 6970  """Inline multip
-00007df0: 6c69 6361 7469 6f6e 2028 6f6e 6c79 2077  lication (only w
-00007e00: 6974 6820 7363 616c 6172 290a 0a20 2020  ith scalar)..   
-00007e10: 2020 2020 203e 3e3e 2061 3d76 6563 3428       >>> a=vec4(
-00007e20: 312e 302c 2030 2e35 2c20 2d31 2e38 2c20  1.0, 0.5, -1.8, 
-00007e30: 302e 3229 0a20 2020 2020 2020 203e 3e3e  0.2).        >>>
-00007e40: 2061 2a3d 322e 300a 2020 2020 2020 2020   a*=2.0.        
-00007e50: 3e3e 3e20 7072 696e 7420 610a 2020 2020  >>> print a.    
-00007e60: 2020 2020 2832 2e30 3030 302c 2031 2e30      (2.0000, 1.0
-00007e70: 3030 302c 202d 332e 3630 3030 2c20 302e  000, -3.6000, 0.
-00007e80: 3430 3030 290a 2020 2020 2020 2020 2222  4000).        ""
-00007e90: 220a 2020 2020 2020 2020 6364 6566 2064  ".        cdef d
-00007ea0: 6f75 626c 6520 720a 2020 2020 2020 2020  ouble r.        
-00007eb0: 7462 203d 2074 7970 6528 6f74 6865 7229  tb = type(other)
-00007ec0: 0a20 2020 2020 2020 2069 6620 7462 2069  .        if tb i
-00007ed0: 7320 666c 6f61 7420 6f72 2074 6220 6973  s float or tb is
-00007ee0: 2069 6e74 206f 7220 7462 2069 7320 6c6f   int or tb is lo
-00007ef0: 6e67 3a0a 2020 2020 2020 2020 2020 2020  ng:.            
-00007f00: 723d 6f74 6865 720a 2020 2020 2020 2020  r=other.        
-00007f10: 2020 2020 7365 6c66 2e78 3d73 656c 662e      self.x=self.
-00007f20: 782a 720a 2020 2020 2020 2020 2020 2020  x*r.            
-00007f30: 7365 6c66 2e79 3d73 656c 662e 792a 720a  self.y=self.y*r.
-00007f40: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00007f50: 2e7a 3d73 656c 662e 7a2a 720a 2020 2020  .z=self.z*r.    
-00007f60: 2020 2020 2020 2020 7365 6c66 2e77 3d73          self.w=s
-00007f70: 656c 662e 772a 720a 2020 2020 2020 2020  elf.w*r.        
-00007f80: 2020 2020 7265 7475 726e 2073 656c 660a      return self.
-00007f90: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00007fa0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00007fb0: 5479 7065 4572 726f 722c 2022 756e 7375  TypeError, "unsu
-00007fc0: 7070 6f72 7465 6420 6f70 6572 616e 6420  pported operand 
-00007fd0: 7479 7065 2066 6f72 202a 3d22 0a0a 2020  type for *="..  
-00007fe0: 2020 6465 6620 5f5f 6964 6976 5f5f 2873    def __idiv__(s
-00007ff0: 656c 662c 206f 7468 6572 293a 0a20 2020  elf, other):.   
-00008000: 2020 2020 2022 2222 496e 6c69 6e65 2064       """Inline d
-00008010: 6976 6973 696f 6e20 7769 7468 2073 6361  ivision with sca
-00008020: 6c61 720a 0a20 2020 2020 2020 203e 3e3e  lar..        >>>
-00008030: 2061 3d76 6563 3428 312e 302c 2030 2e35   a=vec4(1.0, 0.5
-00008040: 2c20 2d31 2e38 2c20 302e 3229 0a20 2020  , -1.8, 0.2).   
-00008050: 2020 2020 203e 3e3e 2061 2f3d 322e 300a       >>> a/=2.0.
-00008060: 2020 2020 2020 2020 3e3e 3e20 7072 696e          >>> prin
-00008070: 7420 610a 2020 2020 2020 2020 2830 2e35  t a.        (0.5
-00008080: 3030 302c 2030 2e32 3530 302c 202d 302e  000, 0.2500, -0.
-00008090: 3930 3030 2c20 302e 3130 3030 290a 2020  9000, 0.1000).  
-000080a0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-000080b0: 2020 6364 6566 2064 6f75 626c 6520 720a    cdef double r.
-000080c0: 2020 2020 2020 2020 7462 203d 2074 7970          tb = typ
-000080d0: 6528 6f74 6865 7229 0a20 2020 2020 2020  e(other).       
-000080e0: 2069 6620 7462 2069 7320 666c 6f61 7420   if tb is float 
-000080f0: 6f72 2074 6220 6973 2069 6e74 206f 7220  or tb is int or 
-00008100: 7462 2069 7320 6c6f 6e67 3a0a 2020 2020  tb is long:.    
-00008110: 2020 2020 2020 2020 723d 6f74 6865 720a          r=other.
-00008120: 2020 2020 2020 2020 2020 2020 6966 2066              if f
-00008130: 6162 7328 7229 3c3d 6570 733a 0a20 2020  abs(r)<=eps:.   
-00008140: 2020 2020 2020 2020 2020 2020 2072 6169               rai
-00008150: 7365 205a 6572 6f44 6976 6973 696f 6e45  se ZeroDivisionE
-00008160: 7272 6f72 2c22 7665 6334 2064 6976 6973  rror,"vec4 divis
-00008170: 696f 6e22 0a20 2020 2020 2020 2020 2020  ion".           
-00008180: 2073 656c 662e 783d 7365 6c66 2e78 2f72   self.x=self.x/r
-00008190: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-000081a0: 662e 793d 7365 6c66 2e79 2f72 0a20 2020  f.y=self.y/r.   
-000081b0: 2020 2020 2020 2020 2073 656c 662e 7a3d           self.z=
-000081c0: 7365 6c66 2e7a 2f72 0a20 2020 2020 2020  self.z/r.       
-000081d0: 2020 2020 2073 656c 662e 773d 7365 6c66       self.w=self
-000081e0: 2e77 2f72 0a20 2020 2020 2020 2020 2020  .w/r.           
-000081f0: 2072 6574 7572 6e20 7365 6c66 0a20 2020   return self.   
-00008200: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00008210: 2020 2020 2020 2072 6169 7365 2054 7970         raise Typ
-00008220: 6545 7272 6f72 2c20 2275 6e73 7570 706f  eError, "unsuppo
-00008230: 7274 6564 206f 7065 7261 6e64 2074 7970  rted operand typ
-00008240: 6520 666f 7220 2f3d 220a 0a20 2020 2064  e for /="..    d
-00008250: 6566 205f 5f69 6d6f 645f 5f28 7365 6c66  ef __imod__(self
-00008260: 2c20 6229 3a0a 2020 2020 2020 2020 2222  , b):.        ""
-00008270: 2249 6e6c 696e 6520 6d6f 6475 6c6f 2e0a  "Inline modulo..
-00008280: 0a20 2020 2020 2020 203e 3e3e 2061 3d76  .        >>> a=v
-00008290: 6563 3428 332e 302c 2032 2e35 2c20 2d31  ec4(3.0, 2.5, -1
-000082a0: 2e38 2c20 302e 3229 0a20 2020 2020 2020  .8, 0.2).       
-000082b0: 203e 3e3e 2061 253d 322e 300a 2020 2020   >>> a%=2.0.    
-000082c0: 2020 2020 3e3e 3e20 7072 696e 7420 610a      >>> print a.
-000082d0: 2020 2020 2020 2020 2831 2e30 3030 302c          (1.0000,
-000082e0: 2030 2e35 3030 302c 2030 2e32 3030 302c   0.5000, 0.2000,
-000082f0: 2030 2e32 3030 3029 0a20 2020 2020 2020   0.2000).       
-00008300: 2022 2222 0a20 2020 2020 2020 2063 6465   """.        cde
-00008310: 6620 7665 6334 2076 620a 2020 2020 2020  f vec4 vb.      
-00008320: 2020 6364 6566 2064 6f75 626c 6520 720a    cdef double r.
-00008330: 0a20 2020 2020 2020 2074 6220 3d20 7479  .        tb = ty
-00008340: 7065 2862 290a 0a20 2020 2020 2020 2069  pe(b)..        i
-00008350: 6620 7462 2069 7320 666c 6f61 7420 6f72  f tb is float or
-00008360: 2074 6220 6973 2069 6e74 206f 7220 7462   tb is int or tb
-00008370: 2069 7320 6c6f 6e67 3a0a 2020 2020 2020   is long:.      
-00008380: 2020 2020 2020 2320 7665 6334 253d 7363        # vec4%=sc
-00008390: 616c 6172 0a20 2020 2020 2020 2020 2020  alar.           
-000083a0: 2072 203d 2062 0a20 2020 2020 2020 2020   r = b.         
-000083b0: 2020 2069 6620 6661 6273 2872 293c 3d65     if fabs(r)<=e
-000083c0: 7073 3a0a 2020 2020 2020 2020 2020 2020  ps:.            
-000083d0: 2020 2020 7261 6973 6520 5a65 726f 4469      raise ZeroDi
-000083e0: 7669 7369 6f6e 4572 726f 722c 2276 6563  visionError,"vec
-000083f0: 3420 6d6f 6475 6c6f 220a 2020 2020 2020  4 modulo".      
-00008400: 2020 2020 2020 7365 6c66 2e78 203d 205f        self.x = _
-00008410: 666d 6f64 2873 656c 662e 782c 7229 0a20  fmod(self.x,r). 
-00008420: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00008430: 7920 3d20 5f66 6d6f 6428 7365 6c66 2e79  y = _fmod(self.y
-00008440: 2c72 290a 2020 2020 2020 2020 2020 2020  ,r).            
-00008450: 7365 6c66 2e7a 203d 205f 666d 6f64 2873  self.z = _fmod(s
-00008460: 656c 662e 7a2c 7229 0a20 2020 2020 2020  elf.z,r).       
-00008470: 2020 2020 2073 656c 662e 7720 3d20 5f66       self.w = _f
-00008480: 6d6f 6428 7365 6c66 2e77 2c72 290a 2020  mod(self.w,r).  
-00008490: 2020 2020 2020 2020 2020 7265 7475 726e            return
-000084a0: 2073 656c 660a 2020 2020 2020 2020 656c   self.        el
-000084b0: 6966 2074 6220 6973 2076 6563 343a 0a20  if tb is vec4:. 
-000084c0: 2020 2020 2020 2020 2020 2023 2076 6563             # vec
-000084d0: 3425 3d76 6563 340a 2020 2020 2020 2020  4%=vec4.        
-000084e0: 2020 2020 7662 203d 2062 0a20 2020 2020      vb = b.     
-000084f0: 2020 2020 2020 2069 6620 2866 6162 7328         if (fabs(
-00008500: 7662 2e78 293c 3d65 7073 206f 7220 6661  vb.x)<=eps or fa
-00008510: 6273 2876 622e 7929 3c3d 6570 7320 6f72  bs(vb.y)<=eps or
-00008520: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00008530: 2066 6162 7328 7662 2e7a 293c 3d65 7073   fabs(vb.z)<=eps
-00008540: 206f 7220 6661 6273 2876 622e 7729 3c3d   or fabs(vb.w)<=
-00008550: 6570 7329 3a0a 2020 2020 2020 2020 2020  eps):.          
-00008560: 2020 2020 2020 7261 6973 6520 5a65 726f        raise Zero
-00008570: 4469 7669 7369 6f6e 4572 726f 722c 2276  DivisionError,"v
-00008580: 6563 3420 6d6f 6475 6c6f 220a 2020 2020  ec4 modulo".    
-00008590: 2020 2020 2020 2020 7365 6c66 2e78 203d          self.x =
-000085a0: 205f 666d 6f64 2873 656c 662e 782c 2076   _fmod(self.x, v
-000085b0: 622e 7829 0a20 2020 2020 2020 2020 2020  b.x).           
-000085c0: 2073 656c 662e 7920 3d20 5f66 6d6f 6428   self.y = _fmod(
-000085d0: 7365 6c66 2e79 2c20 7662 2e79 290a 2020  self.y, vb.y).  
-000085e0: 2020 2020 2020 2020 2020 7365 6c66 2e7a            self.z
-000085f0: 203d 205f 666d 6f64 2873 656c 662e 7a2c   = _fmod(self.z,
-00008600: 2076 622e 7a29 0a20 2020 2020 2020 2020   vb.z).         
-00008610: 2020 2073 656c 662e 7720 3d20 5f66 6d6f     self.w = _fmo
-00008620: 6428 7365 6c66 2e77 2c20 7662 2e77 290a  d(self.w, vb.w).
-00008630: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00008640: 726e 2073 656c 660a 2020 2020 2020 2020  rn self.        
-00008650: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00008660: 2020 7261 6973 6520 5479 7065 4572 726f    raise TypeErro
-00008670: 722c 2022 756e 7375 7070 6f72 7465 6420  r, "unsupported 
-00008680: 6f70 6572 616e 6420 7479 7065 2066 6f72  operand type for
-00008690: 2025 3d22 0a0a 0a20 2020 2064 6566 205f   %="...    def _
-000086a0: 5f61 6273 5f5f 2873 656c 6629 3a0a 2020  _abs__(self):.  
-000086b0: 2020 2020 2020 2222 2252 6574 7572 6e20        """Return 
-000086c0: 7468 6520 6c65 6e67 7468 206f 6620 7468  the length of th
-000086d0: 6520 7665 6374 6f72 2e0a 0a20 2020 2020  e vector...     
-000086e0: 2020 2061 6273 2876 2920 6973 2065 7175     abs(v) is equ
-000086f0: 6976 616c 656e 7420 746f 2076 2e6c 656e  ivalent to v.len
-00008700: 6774 6828 292e 0a0a 2020 2020 2020 2020  gth()...        
-00008710: 3e3e 3e20 613d 7665 6334 2831 2e30 2c20  >>> a=vec4(1.0, 
-00008720: 302e 352c 202d 312e 382c 2030 2e32 290a  0.5, -1.8, 0.2).
-00008730: 2020 2020 2020 2020 3e3e 3e20 7072 696e          >>> prin
-00008740: 7420 6162 7328 6129 0a20 2020 2020 2020  t abs(a).       
-00008750: 2032 2e31 3238 3337 3936 3635 3338 0a20   2.12837966538. 
-00008760: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00008770: 2020 2063 6465 6620 646f 7562 6c65 2061     cdef double a
-00008780: 0a20 2020 2020 2020 2061 203d 2073 656c  .        a = sel
-00008790: 662e 782a 7365 6c66 2e78 202b 2073 656c  f.x*self.x + sel
-000087a0: 662e 792a 7365 6c66 2e79 202b 2073 656c  f.y*self.y + sel
-000087b0: 662e 7a2a 7365 6c66 2e7a 202b 2073 656c  f.z*self.z + sel
-000087c0: 662e 772a 7365 6c66 2e77 0a20 2020 2020  f.w*self.w.     
-000087d0: 2020 2072 6574 7572 6e20 7371 7274 2861     return sqrt(a
-000087e0: 290a 0a20 2020 2064 6566 205f 5f67 6574  )..    def __get
-000087f0: 6174 7472 5f5f 2873 656c 662c 206e 616d  attr__(self, nam
-00008800: 6529 3a0a 2020 2020 2020 2020 6966 206e  e):.        if n
-00008810: 616d 653d 3d22 7822 3a0a 2020 2020 2020  ame=="x":.      
-00008820: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00008830: 662e 780a 2020 2020 2020 2020 656c 6966  f.x.        elif
-00008840: 206e 616d 653d 3d22 7922 3a0a 2020 2020   name=="y":.    
+00005f50: 2020 7365 6c66 2e7a 203d 2073 656c 662e    self.z = self.
+00005f60: 780a 2020 2020 2020 2020 2020 2020 2020  x.              
+00005f70: 2020 2020 2020 7365 6c66 2e77 203d 2073        self.w = s
+00005f80: 656c 662e 780a 2020 2020 2020 2020 2020  elf.x.          
+00005f90: 2020 2020 2020 656c 6966 2073 6571 6c65        elif seqle
+00005fa0: 6e3d 3d30 3a0a 2020 2020 2020 2020 2020  n==0:.          
+00005fb0: 2020 2020 2020 2020 2020 7365 6c66 2e78            self.x
+00005fc0: 203d 2030 2e30 0a20 2020 2020 2020 2020   = 0.0.         
+00005fd0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00005fe0: 7920 3d20 302e 300a 2020 2020 2020 2020  y = 0.0.        
+00005ff0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00006000: 2e7a 203d 2030 2e30 0a20 2020 2020 2020  .z = 0.0.       
+00006010: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00006020: 662e 7720 3d20 302e 300a 2020 2020 2020  f.w = 0.0.      
+00006030: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+00006040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006050: 2020 2020 7261 6973 6520 5479 7065 4572      raise TypeEr
+00006060: 726f 722c 2022 7665 6334 2829 2074 616b  ror, "vec4() tak
+00006070: 6573 2061 7420 6d6f 7374 2034 2061 7267  es at most 4 arg
+00006080: 756d 656e 7473 220a 0a20 2020 2020 2020  uments"..       
+00006090: 2065 6c69 6620 6172 676c 656e 3d3d 323a   elif arglen==2:
+000060a0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+000060b0: 662e 7820 3d20 6172 6773 5b30 5d0a 2020  f.x = args[0].  
+000060c0: 2020 2020 2020 2020 2020 7365 6c66 2e79            self.y
+000060d0: 203d 2061 7267 735b 315d 0a20 2020 2020   = args[1].     
+000060e0: 2020 2020 2020 2073 656c 662e 7a20 3d20         self.z = 
+000060f0: 302e 300a 2020 2020 2020 2020 2020 2020  0.0.            
+00006100: 7365 6c66 2e77 203d 2030 2e30 0a0a 2020  self.w = 0.0..  
+00006110: 2020 2020 2020 656c 6966 2061 7267 6c65        elif argle
+00006120: 6e3d 3d33 3a0a 2020 2020 2020 2020 2020  n==3:.          
+00006130: 2020 7365 6c66 2e78 203d 2061 7267 735b    self.x = args[
+00006140: 305d 0a20 2020 2020 2020 2020 2020 2073  0].            s
+00006150: 656c 662e 7920 3d20 6172 6773 5b31 5d0a  elf.y = args[1].
+00006160: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00006170: 2e7a 203d 2061 7267 735b 325d 0a20 2020  .z = args[2].   
+00006180: 2020 2020 2020 2020 2073 656c 662e 7720           self.w 
+00006190: 3d20 302e 300a 0a20 2020 2020 2020 2065  = 0.0..        e
+000061a0: 6c69 6620 6172 676c 656e 3d3d 343a 0a20  lif arglen==4:. 
+000061b0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000061c0: 7820 3d20 6172 6773 5b30 5d0a 2020 2020  x = args[0].    
+000061d0: 2020 2020 2020 2020 7365 6c66 2e79 203d          self.y =
+000061e0: 2061 7267 735b 315d 0a20 2020 2020 2020   args[1].       
+000061f0: 2020 2020 2073 656c 662e 7a20 3d20 6172       self.z = ar
+00006200: 6773 5b32 5d0a 2020 2020 2020 2020 2020  gs[2].          
+00006210: 2020 7365 6c66 2e77 203d 2061 7267 735b    self.w = args[
+00006220: 335d 0a0a 2020 2020 2020 2020 656c 7365  3]..        else
+00006230: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+00006240: 6973 6520 5479 7065 4572 726f 722c 2022  ise TypeError, "
+00006250: 7665 6334 2829 2074 616b 6573 2061 7420  vec4() takes at 
+00006260: 6d6f 7374 2034 2061 7267 756d 656e 7473  most 4 arguments
+00006270: 220a 0a20 2020 2064 6566 205f 5f72 6564  "..    def __red
+00006280: 7563 655f 5f28 7365 6c66 293a 0a20 2020  uce__(self):.   
+00006290: 2020 2020 2072 6574 7572 6e20 285f 7665       return (_ve
+000062a0: 6334 636f 6e73 7472 7563 742c 2028 7365  c4construct, (se
+000062b0: 6c66 2e78 2c20 7365 6c66 2e79 2c20 7365  lf.x, self.y, se
+000062c0: 6c66 2e7a 2c20 7365 6c66 2e77 2929 0a0a  lf.z, self.w))..
+000062d0: 2020 2020 6465 6620 5f5f 7265 7072 5f5f      def __repr__
+000062e0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+000062f0: 7265 7475 726e 2027 7665 6334 2825 732c  return 'vec4(%s,
+00006300: 2025 732c 2025 732c 2025 7329 2725 2872   %s, %s, %s)'%(r
+00006310: 6570 7228 7365 6c66 2e78 292c 7265 7072  epr(self.x),repr
+00006320: 2873 656c 662e 7929 2c72 6570 7228 7365  (self.y),repr(se
+00006330: 6c66 2e7a 292c 7265 7072 2873 656c 662e  lf.z),repr(self.
+00006340: 7729 290a 0a20 2020 2064 6566 205f 5f73  w))..    def __s
+00006350: 7472 5f5f 2873 656c 6629 3a0a 2020 2020  tr__(self):.    
+00006360: 2020 2020 7265 7475 726e 2022 2825 312e      return "(%1.
+00006370: 3466 2c20 2531 2e34 662c 2025 312e 3466  4f, %1.4f, %1.4f
+00006380: 2c20 2531 2e34 6629 2225 2873 656c 662e  , %1.4f)"%(self.
+00006390: 782c 2073 656c 662e 792c 2073 656c 662e  x, self.y, self.
+000063a0: 7a2c 2073 656c 662e 7729 0a0a 2020 2020  z, self.w)..    
+000063b0: 6465 6620 5f5f 6974 6572 5f5f 2873 656c  def __iter__(sel
+000063c0: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
+000063d0: 726e 2076 6563 3469 7465 7228 7365 6c66  rn vec4iter(self
+000063e0: 290a 0a20 2020 2064 6566 205f 5f72 6963  )..    def __ric
+000063f0: 6863 6d70 5f5f 2861 2c62 2c6f 7029 3a0a  hcmp__(a,b,op):.
+00006400: 2020 2020 2020 2020 6364 6566 2076 6563          cdef vec
+00006410: 3420 7661 2c20 7662 0a20 2020 2020 2020  4 va, vb.       
+00006420: 2063 6465 6620 696e 7420 636f 700a 0a20   cdef int cop.. 
+00006430: 2020 2020 2020 2063 6f70 203d 206f 700a         cop = op.
+00006440: 0a20 2020 2020 2020 2074 6120 3d20 7479  .        ta = ty
+00006450: 7065 2861 290a 2020 2020 2020 2020 7462  pe(a).        tb
+00006460: 203d 2074 7970 6528 6229 0a20 2020 2020   = type(b).     
+00006470: 2020 2069 6620 2874 6121 3d76 6563 3420     if (ta!=vec4 
+00006480: 6f72 2074 6221 3d76 6563 3429 3a0a 2020  or tb!=vec4):.  
+00006490: 2020 2020 2020 2020 2020 6966 2063 6f70            if cop
+000064a0: 3d3d 333a 0a20 2020 2020 2020 2020 2020  ==3:.           
+000064b0: 2020 2020 2072 6574 7572 6e20 310a 2020       return 1.  
+000064c0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+000064d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000064e0: 7265 7475 726e 2030 0a0a 2020 2020 2020  return 0..      
+000064f0: 2020 7661 203d 2061 0a20 2020 2020 2020    va = a.       
+00006500: 2076 6220 3d20 620a 0a20 2020 2020 2020   vb = b..       
+00006510: 2023 203c 0a20 2020 2020 2020 2069 6620   # <.        if 
+00006520: 636f 703d 3d30 3a0a 2020 2020 2020 2020  cop==0:.        
+00006530: 2020 2020 7265 7475 726e 2028 7661 2e78      return (va.x
+00006540: 3c76 622e 7820 616e 6420 7661 2e79 3c76  <vb.x and va.y<v
+00006550: 622e 7920 616e 6420 7661 2e7a 3c76 622e  b.y and va.z<vb.
+00006560: 7a20 616e 6420 7661 2e77 3c76 622e 7729  z and va.w<vb.w)
+00006570: 0a20 2020 2020 2020 2023 203c 3d0a 2020  .        # <=.  
+00006580: 2020 2020 2020 656c 6966 2063 6f70 3d3d        elif cop==
+00006590: 313a 0a20 2020 2020 2020 2020 2020 2072  1:.            r
+000065a0: 6574 7572 6e20 2876 612e 782d 6570 733c  eturn (va.x-eps<
+000065b0: 3d76 622e 7820 616e 6420 7661 2e79 2d65  =vb.x and va.y-e
+000065c0: 7073 3c3d 7662 2e79 2061 6e64 2076 612e  ps<=vb.y and va.
+000065d0: 7a2d 6570 733c 3d76 622e 7a20 616e 6420  z-eps<=vb.z and 
+000065e0: 7661 2e77 2d65 7073 3c3d 7662 2e77 290a  va.w-eps<=vb.w).
+000065f0: 2020 2020 2020 2020 2320 3d3d 0a20 2020          # ==.   
+00006600: 2020 2020 2065 6c69 6620 636f 703d 3d32       elif cop==2
+00006610: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+00006620: 7475 726e 2028 6661 6273 2876 612e 782d  turn (fabs(va.x-
+00006630: 7662 2e78 293c 3d65 7073 2061 6e64 2066  vb.x)<=eps and f
+00006640: 6162 7328 7661 2e79 2d76 622e 7929 3c3d  abs(va.y-vb.y)<=
+00006650: 6570 7320 616e 6420 6661 6273 2876 612e  eps and fabs(va.
+00006660: 7a2d 7662 2e7a 293c 3d65 7073 2061 6e64  z-vb.z)<=eps and
+00006670: 2066 6162 7328 7661 2e77 2d76 622e 7729   fabs(va.w-vb.w)
+00006680: 3c3d 6570 7329 0a20 2020 2020 2020 2023  <=eps).        #
+00006690: 2021 3d0a 2020 2020 2020 2020 656c 6966   !=.        elif
+000066a0: 2063 6f70 3d3d 333a 0a20 2020 2020 2020   cop==3:.       
+000066b0: 2020 2020 2072 6574 7572 6e20 2866 6162       return (fab
+000066c0: 7328 7661 2e78 2d76 622e 7829 3e65 7073  s(va.x-vb.x)>eps
+000066d0: 206f 7220 6661 6273 2876 612e 792d 7662   or fabs(va.y-vb
+000066e0: 2e79 293e 6570 7320 616e 6420 6661 6273  .y)>eps and fabs
+000066f0: 2876 612e 7a2d 7662 2e7a 293e 6570 7320  (va.z-vb.z)>eps 
+00006700: 616e 6420 6661 6273 2876 612e 772d 7662  and fabs(va.w-vb
+00006710: 2e77 293e 6570 7329 0a20 2020 2020 2020  .w)>eps).       
+00006720: 2023 203e 0a20 2020 2020 2020 2065 6c69   # >.        eli
+00006730: 6620 636f 703d 3d34 3a0a 2020 2020 2020  f cop==4:.      
+00006740: 2020 2020 2020 7265 7475 726e 2028 7661        return (va
+00006750: 2e78 3e76 622e 7820 616e 6420 7661 2e79  .x>vb.x and va.y
+00006760: 3e76 622e 7920 616e 6420 7661 2e7a 3e76  >vb.y and va.z>v
+00006770: 622e 7a20 616e 6420 7661 2e77 3e76 622e  b.z and va.w>vb.
+00006780: 7729 0a20 2020 2020 2020 2023 203e 3d0a  w).        # >=.
+00006790: 2020 2020 2020 2020 656c 6966 2063 6f70          elif cop
+000067a0: 3d3d 353a 0a20 2020 2020 2020 2020 2020  ==5:.           
+000067b0: 2072 6574 7572 6e20 2876 612e 782b 6570   return (va.x+ep
+000067c0: 733e 3d76 622e 7820 616e 6420 7661 2e79  s>=vb.x and va.y
+000067d0: 2b65 7073 3e3d 7662 2e79 2061 6e64 2076  +eps>=vb.y and v
+000067e0: 612e 7a2b 6570 733e 3d76 622e 7a20 616e  a.z+eps>=vb.z an
+000067f0: 6420 7661 2e77 2b65 7073 3e3d 7662 2e77  d va.w+eps>=vb.w
+00006800: 290a 2020 2020 2020 2020 2320 736f 6e73  ).        # sons
+00006810: 7420 2846 6568 6c65 7229 0a20 2020 2020  t (Fehler).     
+00006820: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00006830: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+00006840: 4572 726f 722c 2269 6e74 6572 6e61 6c20  Error,"internal 
+00006850: 6572 726f 723a 2069 6c6c 6567 616c 2072  error: illegal r
+00006860: 6963 6820 636f 6d70 6172 6973 6f6e 206e  ich comparison n
+00006870: 756d 6265 7222 0a0a 2020 2020 6465 6620  umber"..    def 
+00006880: 5f5f 6164 645f 5f28 7665 6334 2061 2c20  __add__(vec4 a, 
+00006890: 7665 6334 2062 293a 0a20 2020 2020 2020  vec4 b):.       
+000068a0: 2022 2222 5665 6374 6f72 2061 6464 6974   """Vector addit
+000068b0: 696f 6e2e 0a0a 2020 2020 2020 2020 3e3e  ion...        >>
+000068c0: 3e20 613d 7665 6334 2831 2e30 2c20 302e  > a=vec4(1.0, 0.
+000068d0: 352c 202d 312e 382c 2030 2e32 290a 2020  5, -1.8, 0.2).  
+000068e0: 2020 2020 2020 3e3e 3e20 623d 7665 6334        >>> b=vec4
+000068f0: 282d 302e 332c 2030 2e37 352c 2030 2e35  (-0.3, 0.75, 0.5
+00006900: 2c20 302e 3329 0a20 2020 2020 2020 203e  , 0.3).        >
+00006910: 3e3e 2070 7269 6e74 2861 2b62 290a 2020  >> print(a+b).  
+00006920: 2020 2020 2020 2830 2e37 3030 302c 2031        (0.7000, 1
+00006930: 2e32 3530 302c 202d 312e 3330 3030 2c20  .2500, -1.3000, 
+00006940: 302e 3530 3030 290a 2020 2020 2020 2020  0.5000).        
+00006950: 2222 220a 2020 2020 2020 2020 6364 6566  """.        cdef
+00006960: 2076 6563 3420 7265 730a 2020 2020 2020   vec4 res.      
+00006970: 2020 7265 7320 3d20 7665 6334 2829 0a20    res = vec4(). 
+00006980: 2020 2020 2020 2072 6573 2e78 203d 2061         res.x = a
+00006990: 2e78 2b62 2e78 0a20 2020 2020 2020 2072  .x+b.x.        r
+000069a0: 6573 2e79 203d 2061 2e79 2b62 2e79 0a20  es.y = a.y+b.y. 
+000069b0: 2020 2020 2020 2072 6573 2e7a 203d 2061         res.z = a
+000069c0: 2e7a 2b62 2e7a 0a20 2020 2020 2020 2072  .z+b.z.        r
+000069d0: 6573 2e77 203d 2061 2e77 2b62 2e77 0a20  es.w = a.w+b.w. 
+000069e0: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
+000069f0: 730a 0a20 2020 2064 6566 205f 5f73 7562  s..    def __sub
+00006a00: 5f5f 2876 6563 3420 612c 2076 6563 3420  __(vec4 a, vec4 
+00006a10: 6229 3a0a 2020 2020 2020 2020 2222 2256  b):.        """V
+00006a20: 6563 746f 7220 7375 6274 7261 6374 696f  ector subtractio
+00006a30: 6e2e 0a0a 2020 2020 2020 2020 3e3e 3e20  n...        >>> 
+00006a40: 613d 7665 6334 2831 2e30 2c20 302e 352c  a=vec4(1.0, 0.5,
+00006a50: 202d 312e 382c 2030 2e32 290a 2020 2020   -1.8, 0.2).    
+00006a60: 2020 2020 3e3e 3e20 623d 7665 6334 282d      >>> b=vec4(-
+00006a70: 302e 332c 2030 2e37 352c 2030 2e35 2c20  0.3, 0.75, 0.5, 
+00006a80: 302e 3329 0a20 2020 2020 2020 203e 3e3e  0.3).        >>>
+00006a90: 2070 7269 6e74 2861 2d62 290a 2020 2020   print(a-b).    
+00006aa0: 2020 2020 2831 2e33 3030 302c 202d 302e      (1.3000, -0.
+00006ab0: 3235 3030 2c20 2d32 2e33 3030 302c 202d  2500, -2.3000, -
+00006ac0: 302e 3130 3030 290a 2020 2020 2020 2020  0.1000).        
+00006ad0: 2222 220a 2020 2020 2020 2020 6364 6566  """.        cdef
+00006ae0: 2076 6563 3420 7265 730a 2020 2020 2020   vec4 res.      
+00006af0: 2020 7265 7320 3d20 7665 6334 2829 0a20    res = vec4(). 
+00006b00: 2020 2020 2020 2072 6573 2e78 203d 2061         res.x = a
+00006b10: 2e78 2d62 2e78 0a20 2020 2020 2020 2072  .x-b.x.        r
+00006b20: 6573 2e79 203d 2061 2e79 2d62 2e79 0a20  es.y = a.y-b.y. 
+00006b30: 2020 2020 2020 2072 6573 2e7a 203d 2061         res.z = a
+00006b40: 2e7a 2d62 2e7a 0a20 2020 2020 2020 2072  .z-b.z.        r
+00006b50: 6573 2e77 203d 2061 2e77 2d62 2e77 0a20  es.w = a.w-b.w. 
+00006b60: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
+00006b70: 730a 0a20 2020 2064 6566 205f 5f6d 756c  s..    def __mul
+00006b80: 5f5f 2861 2c20 6229 3a0a 2020 2020 2020  __(a, b):.      
+00006b90: 2020 2222 224d 756c 7469 706c 6963 6174    """Multiplicat
+00006ba0: 696f 6e20 7769 7468 2061 2073 6361 6c61  ion with a scala
+00006bb0: 7220 6f72 2064 6f74 2070 726f 6475 6374  r or dot product
+00006bc0: 2e0a 0a20 2020 2020 2020 203e 3e3e 2061  ...        >>> a
+00006bd0: 3d76 6563 3428 312e 302c 2030 2e35 2c20  =vec4(1.0, 0.5, 
+00006be0: 2d31 2e38 2c20 302e 3229 0a20 2020 2020  -1.8, 0.2).     
+00006bf0: 2020 203e 3e3e 2062 3d76 6563 3428 2d30     >>> b=vec4(-0
+00006c00: 2e33 2c20 302e 3735 2c20 302e 352c 2030  .3, 0.75, 0.5, 0
+00006c10: 2e33 290a 2020 2020 2020 2020 3e3e 3e20  .3).        >>> 
+00006c20: 7072 696e 7428 612a 322e 3029 0a20 2020  print(a*2.0).   
+00006c30: 2020 2020 2028 322e 3030 3030 2c20 312e       (2.0000, 1.
+00006c40: 3030 3030 2c20 2d33 2e36 3030 302c 2030  0000, -3.6000, 0
+00006c50: 2e34 3030 3029 0a20 2020 2020 2020 203e  .4000).        >
+00006c60: 3e3e 2070 7269 6e74 2832 2e30 2a61 290a  >> print(2.0*a).
+00006c70: 2020 2020 2020 2020 2832 2e30 3030 302c          (2.0000,
+00006c80: 2031 2e30 3030 302c 202d 332e 3630 3030   1.0000, -3.6000
+00006c90: 2c20 302e 3430 3030 290a 2020 2020 2020  , 0.4000).      
+00006ca0: 2020 3e3e 3e20 7072 696e 7428 612a 6229    >>> print(a*b)
+00006cb0: 0a20 2020 2020 2020 202d 302e 3736 350a  .        -0.765.
+00006cc0: 2020 2020 2020 2020 2222 220a 0a20 2020          """..   
+00006cd0: 2020 2020 2063 6465 6620 7665 6334 2072       cdef vec4 r
+00006ce0: 6573 2c20 7661 2c20 7662 0a20 2020 2020  es, va, vb.     
+00006cf0: 2020 2063 6465 6620 646f 7562 6c65 2072     cdef double r
+00006d00: 0a0a 2020 2020 2020 2020 7461 203d 2074  ..        ta = t
+00006d10: 7970 6528 6129 0a20 2020 2020 2020 2074  ype(a).        t
+00006d20: 6220 3d20 7479 7065 2862 290a 0a20 2020  b = type(b)..   
+00006d30: 2020 2020 2069 6620 7461 2069 7320 7665       if ta is ve
+00006d40: 6334 3a0a 2020 2020 2020 2020 2020 2020  c4:.            
+00006d50: 7661 203d 2061 0a20 2020 2020 2020 2020  va = a.         
+00006d60: 2020 2069 6620 7462 2069 7320 7665 6334     if tb is vec4
+00006d70: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00006d80: 2020 2320 7665 6334 2a76 6563 3420 2020    # vec4*vec4   
+00006d90: 2864 6f74 2070 726f 6475 6374 2061 2a62  (dot product a*b
+00006da0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00006db0: 2020 7662 203d 2062 0a20 2020 2020 2020    vb = b.       
+00006dc0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00006dd0: 7661 2e78 2a76 622e 7820 2b20 7661 2e79  va.x*vb.x + va.y
+00006de0: 2a76 622e 7920 2b20 7661 2e7a 2a76 622e  *vb.y + va.z*vb.
+00006df0: 7a20 2b20 7661 2e77 2a76 622e 770a 2020  z + va.w*vb.w.  
+00006e00: 2020 2020 2020 2020 2020 656c 6966 2074            elif t
+00006e10: 6220 6973 2066 6c6f 6174 206f 7220 7462  b is float or tb
+00006e20: 2069 7320 696e 7420 6f72 2074 6220 6973   is int or tb is
+00006e30: 206c 6f6e 673a 0a20 2020 2020 2020 2020   long:.         
+00006e40: 2020 2020 2020 2023 2076 6563 342a 7363         # vec4*sc
+00006e50: 616c 6172 0a20 2020 2020 2020 2020 2020  alar.           
+00006e60: 2020 2020 2072 6573 203d 2076 6563 3428       res = vec4(
+00006e70: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00006e80: 2020 7220 2020 3d20 620a 2020 2020 2020    r   = b.      
+00006e90: 2020 2020 2020 2020 2020 7265 732e 7820            res.x 
+00006ea0: 3d20 7661 2e78 2a72 0a20 2020 2020 2020  = va.x*r.       
+00006eb0: 2020 2020 2020 2020 2072 6573 2e79 203d           res.y =
+00006ec0: 2076 612e 792a 720a 2020 2020 2020 2020   va.y*r.        
+00006ed0: 2020 2020 2020 2020 7265 732e 7a20 3d20          res.z = 
+00006ee0: 7661 2e7a 2a72 0a20 2020 2020 2020 2020  va.z*r.         
+00006ef0: 2020 2020 2020 2072 6573 2e77 203d 2076         res.w = v
+00006f00: 612e 772a 720a 2020 2020 2020 2020 2020  a.w*r.          
+00006f10: 2020 2020 2020 7265 7475 726e 2072 6573        return res
+00006f20: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
+00006f30: 6620 7462 2069 7320 6d61 7434 3a0a 2020  f tb is mat4:.  
+00006f40: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+00006f50: 7665 6334 2a6d 6174 340a 2020 2020 2020  vec4*mat4.      
+00006f60: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00006f70: 2062 2e5f 5f72 6d75 6c5f 5f28 6129 0a20   b.__rmul__(a). 
+00006f80: 2020 2020 2020 2065 6c69 6620 7461 2069         elif ta i
+00006f90: 7320 666c 6f61 7420 6f72 2074 6120 6973  s float or ta is
+00006fa0: 2069 6e74 206f 7220 7461 2069 7320 6c6f   int or ta is lo
+00006fb0: 6e67 3a0a 2020 2020 2020 2020 2020 2020  ng:.            
+00006fc0: 6966 2074 6220 6973 2076 6563 343a 0a20  if tb is vec4:. 
+00006fd0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00006fe0: 2073 6361 6c61 722a 7665 6334 0a20 2020   scalar*vec4.   
+00006ff0: 2020 2020 2020 2020 2020 2020 2072 6573               res
+00007000: 203d 2076 6563 3428 290a 2020 2020 2020   = vec4().      
+00007010: 2020 2020 2020 2020 2020 7662 2020 3d20            vb  = 
+00007020: 620a 2020 2020 2020 2020 2020 2020 2020  b.              
+00007030: 2020 7220 2020 3d20 610a 2020 2020 2020    r   = a.      
+00007040: 2020 2020 2020 2020 2020 7265 732e 7820            res.x 
+00007050: 3d20 722a 7662 2e78 0a20 2020 2020 2020  = r*vb.x.       
+00007060: 2020 2020 2020 2020 2072 6573 2e79 203d           res.y =
+00007070: 2072 2a76 622e 790a 2020 2020 2020 2020   r*vb.y.        
+00007080: 2020 2020 2020 2020 7265 732e 7a20 3d20          res.z = 
+00007090: 722a 7662 2e7a 0a20 2020 2020 2020 2020  r*vb.z.         
+000070a0: 2020 2020 2020 2072 6573 2e77 203d 2072         res.w = r
+000070b0: 2a76 622e 770a 2020 2020 2020 2020 2020  *vb.w.          
+000070c0: 2020 2020 2020 7265 7475 726e 2072 6573        return res
+000070d0: 0a0a 2020 2020 2020 2020 7261 6973 6520  ..        raise 
+000070e0: 5479 7065 4572 726f 722c 2022 756e 7375  TypeError, "unsu
+000070f0: 7070 6f72 7465 6420 6f70 6572 616e 6420  pported operand 
+00007100: 7479 7065 2066 6f72 202a 220a 0a20 2020  type for *"..   
+00007110: 2064 6566 205f 5f64 6976 5f5f 2876 6563   def __div__(vec
+00007120: 3420 612c 2062 293a 0a20 2020 2020 2020  4 a, b):.       
+00007130: 2023 2050 7974 686f 6e20 320a 2020 2020   # Python 2.    
+00007140: 2020 2020 7265 7475 726e 2076 6563 342e      return vec4.
+00007150: 5f5f 7472 7565 6469 765f 5f28 612c 6229  __truediv__(a,b)
+00007160: 0a0a 2020 2020 6465 6620 5f5f 7472 7565  ..    def __true
+00007170: 6469 765f 5f28 7665 6334 2061 2c20 6229  div__(vec4 a, b)
+00007180: 3a0a 2020 2020 2020 2020 2222 2244 6976  :.        """Div
+00007190: 6973 696f 6e20 6279 2073 6361 6c61 722e  ision by scalar.
+000071a0: 0a0a 2020 2020 2020 2020 3e3e 3e20 613d  ..        >>> a=
+000071b0: 7665 6334 2831 2e30 2c20 302e 352c 202d  vec4(1.0, 0.5, -
+000071c0: 312e 382c 2030 2e32 290a 2020 2020 2020  1.8, 0.2).      
+000071d0: 2020 3e3e 3e20 7072 696e 7428 612f 322e    >>> print(a/2.
+000071e0: 3029 0a20 2020 2020 2020 2028 302e 3530  0).        (0.50
+000071f0: 3030 2c20 302e 3235 3030 2c20 2d30 2e39  00, 0.2500, -0.9
+00007200: 3030 302c 2030 2e31 3030 3029 0a20 2020  000, 0.1000).   
+00007210: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
+00007220: 2020 6364 6566 2076 6563 3420 7265 730a    cdef vec4 res.
+00007230: 2020 2020 2020 2020 6364 6566 2064 6f75          cdef dou
+00007240: 626c 6520 720a 0a20 2020 2020 2020 2074  ble r..        t
+00007250: 6220 3d20 7479 7065 2862 290a 0a20 2020  b = type(b)..   
+00007260: 2020 2020 2069 6620 7462 2069 7320 666c       if tb is fl
+00007270: 6f61 7420 6f72 2074 6220 6973 2069 6e74  oat or tb is int
+00007280: 206f 7220 7462 2069 7320 6c6f 6e67 3a0a   or tb is long:.
+00007290: 2020 2020 2020 2020 2020 2020 2320 7665              # ve
+000072a0: 6334 2f73 6361 6c61 720a 2020 2020 2020  c4/scalar.      
+000072b0: 2020 2020 2020 7265 7320 3d20 7665 6334        res = vec4
+000072c0: 2829 0a20 2020 2020 2020 2020 2020 2072  ().            r
+000072d0: 203d 2062 0a20 2020 2020 2020 2020 2020   = b.           
+000072e0: 2069 6620 6661 6273 2872 293c 3d65 7073   if fabs(r)<=eps
+000072f0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00007300: 2020 7261 6973 6520 5a65 726f 4469 7669    raise ZeroDivi
+00007310: 7369 6f6e 4572 726f 722c 2276 6563 3420  sionError,"vec4 
+00007320: 6469 7669 7369 6f6e 220a 2020 2020 2020  division".      
+00007330: 2020 2020 2020 7265 732e 7820 3d20 612e        res.x = a.
+00007340: 782f 720a 2020 2020 2020 2020 2020 2020  x/r.            
+00007350: 7265 732e 7920 3d20 612e 792f 720a 2020  res.y = a.y/r.  
+00007360: 2020 2020 2020 2020 2020 7265 732e 7a20            res.z 
+00007370: 3d20 612e 7a2f 720a 2020 2020 2020 2020  = a.z/r.        
+00007380: 2020 2020 7265 732e 7720 3d20 612e 772f      res.w = a.w/
+00007390: 720a 2020 2020 2020 2020 2020 2020 7265  r.            re
+000073a0: 7475 726e 2072 6573 0a20 2020 2020 2020  turn res.       
+000073b0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+000073c0: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
+000073d0: 6f72 2c20 2275 6e73 7570 706f 7274 6564  or, "unsupported
+000073e0: 206f 7065 7261 6e64 2074 7970 6520 666f   operand type fo
+000073f0: 7220 2f22 0a0a 2020 2020 6465 6620 5f5f  r /"..    def __
+00007400: 6d6f 645f 5f28 7665 6334 2073 656c 662c  mod__(vec4 self,
+00007410: 2062 293a 0a20 2020 2020 2020 2022 2222   b):.        """
+00007420: 4d6f 6475 6c6f 2028 636f 6d70 6f6e 656e  Modulo (componen
+00007430: 7420 7769 7365 290a 0a20 2020 2020 2020  t wise)..       
+00007440: 203e 3e3e 2061 3d76 6563 3428 332e 302c   >>> a=vec4(3.0,
+00007450: 2032 2e35 2c20 2d31 2e38 2c20 302e 3229   2.5, -1.8, 0.2)
+00007460: 0a20 2020 2020 2020 203e 3e3e 2070 7269  .        >>> pri
+00007470: 6e74 2861 2532 2e30 290a 2020 2020 2020  nt(a%2.0).      
+00007480: 2020 2831 2e30 3030 302c 2030 2e35 3030    (1.0000, 0.500
+00007490: 302c 2030 2e32 3030 302c 2030 2e32 3030  0, 0.2000, 0.200
+000074a0: 3029 0a20 2020 2020 2020 2022 2222 0a20  0).        """. 
+000074b0: 2020 2020 2020 2063 6465 6620 7665 6334         cdef vec4
+000074c0: 2072 6573 2c20 7662 0a20 2020 2020 2020   res, vb.       
+000074d0: 2063 6465 6620 646f 7562 6c65 2072 0a0a   cdef double r..
+000074e0: 2020 2020 2020 2020 7462 203d 2074 7970          tb = typ
+000074f0: 6528 6229 0a0a 2020 2020 2020 2020 6966  e(b)..        if
+00007500: 2074 6220 6973 2066 6c6f 6174 206f 7220   tb is float or 
+00007510: 7462 2069 7320 696e 7420 6f72 2074 6220  tb is int or tb 
+00007520: 6973 206c 6f6e 673a 0a20 2020 2020 2020  is long:.       
+00007530: 2020 2020 2023 2076 6563 3425 7363 616c       # vec4%scal
+00007540: 6172 0a20 2020 2020 2020 2020 2020 2072  ar.            r
+00007550: 6573 203d 2076 6563 3428 290a 2020 2020  es = vec4().    
+00007560: 2020 2020 2020 2020 7220 3d20 620a 2020          r = b.  
+00007570: 2020 2020 2020 2020 2020 6966 2066 6162            if fab
+00007580: 7328 7229 3c3d 6570 733a 0a20 2020 2020  s(r)<=eps:.     
+00007590: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+000075a0: 205a 6572 6f44 6976 6973 696f 6e45 7272   ZeroDivisionErr
+000075b0: 6f72 2c22 7665 6334 206d 6f64 756c 6f22  or,"vec4 modulo"
+000075c0: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
+000075d0: 2e78 203d 205f 666d 6f64 2873 656c 662e  .x = _fmod(self.
+000075e0: 782c 7229 0a20 2020 2020 2020 2020 2020  x,r).           
+000075f0: 2072 6573 2e79 203d 205f 666d 6f64 2873   res.y = _fmod(s
+00007600: 656c 662e 792c 7229 0a20 2020 2020 2020  elf.y,r).       
+00007610: 2020 2020 2072 6573 2e7a 203d 205f 666d       res.z = _fm
+00007620: 6f64 2873 656c 662e 7a2c 7229 0a20 2020  od(self.z,r).   
+00007630: 2020 2020 2020 2020 2072 6573 2e77 203d           res.w =
+00007640: 205f 666d 6f64 2873 656c 662e 772c 7229   _fmod(self.w,r)
+00007650: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00007660: 7572 6e20 7265 730a 2020 2020 2020 2020  urn res.        
+00007670: 656c 6966 2074 6220 6973 2076 6563 343a  elif tb is vec4:
+00007680: 0a20 2020 2020 2020 2020 2020 2023 2076  .            # v
+00007690: 6563 3425 7665 6334 0a20 2020 2020 2020  ec4%vec4.       
+000076a0: 2020 2020 2072 6573 203d 2076 6563 3428       res = vec4(
+000076b0: 290a 2020 2020 2020 2020 2020 2020 7662  ).            vb
+000076c0: 203d 2062 0a20 2020 2020 2020 2020 2020   = b.           
+000076d0: 2069 6620 2866 6162 7328 7662 2e78 293c   if (fabs(vb.x)<
+000076e0: 3d65 7073 206f 7220 6661 6273 2876 622e  =eps or fabs(vb.
+000076f0: 7929 3c3d 6570 7320 6f72 0a20 2020 2020  y)<=eps or.     
+00007700: 2020 2020 2020 2020 2020 2066 6162 7328             fabs(
+00007710: 7662 2e7a 293c 3d65 7073 206f 7220 6661  vb.z)<=eps or fa
+00007720: 6273 2876 622e 7729 3c3d 6570 7329 3a0a  bs(vb.w)<=eps):.
+00007730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007740: 7261 6973 6520 5a65 726f 4469 7669 7369  raise ZeroDivisi
+00007750: 6f6e 4572 726f 722c 2276 6563 3420 6d6f  onError,"vec4 mo
+00007760: 6475 6c6f 220a 2020 2020 2020 2020 2020  dulo".          
+00007770: 2020 7265 732e 7820 3d20 5f66 6d6f 6428    res.x = _fmod(
+00007780: 7365 6c66 2e78 2c20 7662 2e78 290a 2020  self.x, vb.x).  
+00007790: 2020 2020 2020 2020 2020 7265 732e 7920            res.y 
+000077a0: 3d20 5f66 6d6f 6428 7365 6c66 2e79 2c20  = _fmod(self.y, 
+000077b0: 7662 2e79 290a 2020 2020 2020 2020 2020  vb.y).          
+000077c0: 2020 7265 732e 7a20 3d20 5f66 6d6f 6428    res.z = _fmod(
+000077d0: 7365 6c66 2e7a 2c20 7662 2e7a 290a 2020  self.z, vb.z).  
+000077e0: 2020 2020 2020 2020 2020 7265 732e 7720            res.w 
+000077f0: 3d20 5f66 6d6f 6428 7365 6c66 2e77 2c20  = _fmod(self.w, 
+00007800: 7662 2e77 290a 2020 2020 2020 2020 2020  vb.w).          
+00007810: 2020 7265 7475 726e 2072 6573 0a20 2020    return res.   
+00007820: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00007830: 2020 2020 2020 2072 6169 7365 2054 7970         raise Typ
+00007840: 6545 7272 6f72 2c20 2275 6e73 7570 706f  eError, "unsuppo
+00007850: 7274 6564 206f 7065 7261 6e64 2074 7970  rted operand typ
+00007860: 6520 666f 7220 2522 0a0a 2020 2020 6465  e for %"..    de
+00007870: 6620 5f5f 6e65 675f 5f28 7365 6c66 293a  f __neg__(self):
+00007880: 0a20 2020 2020 2020 2022 2222 4e65 6761  .        """Nega
+00007890: 7469 6f6e 2e0a 0a20 2020 2020 2020 203e  tion...        >
+000078a0: 3e3e 2061 3d76 6563 3428 332e 302c 2032  >> a=vec4(3.0, 2
+000078b0: 2e35 2c20 2d31 2e38 2c20 302e 3229 0a20  .5, -1.8, 0.2). 
+000078c0: 2020 2020 2020 203e 3e3e 2070 7269 6e74         >>> print
+000078d0: 282d 6129 0a20 2020 2020 2020 2028 2d33  (-a).        (-3
+000078e0: 2e30 3030 302c 202d 322e 3530 3030 2c20  .0000, -2.5000, 
+000078f0: 312e 3830 3030 2c20 2d30 2e32 3030 3029  1.8000, -0.2000)
+00007900: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00007910: 2020 2020 2063 6465 6620 7665 6334 2072       cdef vec4 r
+00007920: 6573 0a20 2020 2020 2020 2072 6573 203d  es.        res =
+00007930: 2076 6563 3428 290a 2020 2020 2020 2020   vec4().        
+00007940: 7265 732e 7820 3d20 2d73 656c 662e 780a  res.x = -self.x.
+00007950: 2020 2020 2020 2020 7265 732e 7920 3d20          res.y = 
+00007960: 2d73 656c 662e 790a 2020 2020 2020 2020  -self.y.        
+00007970: 7265 732e 7a20 3d20 2d73 656c 662e 7a0a  res.z = -self.z.
+00007980: 2020 2020 2020 2020 7265 732e 7720 3d20          res.w = 
+00007990: 2d73 656c 662e 770a 2020 2020 2020 2020  -self.w.        
+000079a0: 7265 7475 726e 2072 6573 0a0a 2020 2020  return res..    
+000079b0: 6465 6620 5f5f 706f 735f 5f28 7365 6c66  def __pos__(self
+000079c0: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
+000079d0: 2020 2020 2020 203e 3e3e 2061 3d76 6563         >>> a=vec
+000079e0: 3428 332e 302c 2032 2e35 2c20 2d31 2e38  4(3.0, 2.5, -1.8
+000079f0: 2c20 302e 3229 0a20 2020 2020 2020 203e  , 0.2).        >
+00007a00: 3e3e 2070 7269 6e74 282b 6129 0a20 2020  >> print(+a).   
+00007a10: 2020 2020 2028 332e 3030 3030 2c20 322e       (3.0000, 2.
+00007a20: 3530 3030 2c20 2d31 2e38 3030 302c 2030  5000, -1.8000, 0
+00007a30: 2e32 3030 3029 0a20 2020 2020 2020 2022  .2000).        "
+00007a40: 2222 0a20 2020 2020 2020 2063 6465 6620  "".        cdef 
+00007a50: 7665 6334 2072 6573 0a20 2020 2020 2020  vec4 res.       
+00007a60: 2072 6573 203d 2076 6563 3428 290a 2020   res = vec4().  
+00007a70: 2020 2020 2020 7265 732e 7820 3d20 7365        res.x = se
+00007a80: 6c66 2e78 0a20 2020 2020 2020 2072 6573  lf.x.        res
+00007a90: 2e79 203d 2073 656c 662e 790a 2020 2020  .y = self.y.    
+00007aa0: 2020 2020 7265 732e 7a20 3d20 7365 6c66      res.z = self
+00007ab0: 2e7a 0a20 2020 2020 2020 2072 6573 2e77  .z.        res.w
+00007ac0: 203d 2073 656c 662e 770a 2020 2020 2020   = self.w.      
+00007ad0: 2020 7265 7475 726e 2072 6573 0a0a 2020    return res..  
+00007ae0: 2020 6465 6620 5f5f 6961 6464 5f5f 2873    def __iadd__(s
+00007af0: 656c 662c 2076 6563 3420 6f74 6865 7229  elf, vec4 other)
+00007b00: 3a0a 2020 2020 2020 2020 2222 2249 6e6c  :.        """Inl
+00007b10: 696e 6520 7665 6374 6f72 2061 6464 6974  ine vector addit
+00007b20: 696f 6e2e 0a0a 2020 2020 2020 2020 3e3e  ion...        >>
+00007b30: 3e20 613d 7665 6334 2831 2e30 2c20 302e  > a=vec4(1.0, 0.
+00007b40: 352c 202d 312e 382c 2030 2e32 290a 2020  5, -1.8, 0.2).  
+00007b50: 2020 2020 2020 3e3e 3e20 623d 7665 6334        >>> b=vec4
+00007b60: 282d 302e 332c 2030 2e37 352c 2030 2e35  (-0.3, 0.75, 0.5
+00007b70: 2c20 302e 3329 0a20 2020 2020 2020 203e  , 0.3).        >
+00007b80: 3e3e 2061 2b3d 620a 2020 2020 2020 2020  >> a+=b.        
+00007b90: 3e3e 3e20 7072 696e 7428 6129 0a20 2020  >>> print(a).   
+00007ba0: 2020 2020 2028 302e 3730 3030 2c20 312e       (0.7000, 1.
+00007bb0: 3235 3030 2c20 2d31 2e33 3030 302c 2030  2500, -1.3000, 0
+00007bc0: 2e35 3030 3029 0a20 2020 2020 2020 2022  .5000).        "
+00007bd0: 2222 0a20 2020 2020 2020 2073 656c 662e  "".        self.
+00007be0: 783d 7365 6c66 2e78 2b6f 7468 6572 2e78  x=self.x+other.x
+00007bf0: 0a20 2020 2020 2020 2073 656c 662e 793d  .        self.y=
+00007c00: 7365 6c66 2e79 2b6f 7468 6572 2e79 0a20  self.y+other.y. 
+00007c10: 2020 2020 2020 2073 656c 662e 7a3d 7365         self.z=se
+00007c20: 6c66 2e7a 2b6f 7468 6572 2e7a 0a20 2020  lf.z+other.z.   
+00007c30: 2020 2020 2073 656c 662e 773d 7365 6c66       self.w=self
+00007c40: 2e77 2b6f 7468 6572 2e77 0a20 2020 2020  .w+other.w.     
+00007c50: 2020 2072 6574 7572 6e20 7365 6c66 0a0a     return self..
+00007c60: 2020 2020 6465 6620 5f5f 6973 7562 5f5f      def __isub__
+00007c70: 2873 656c 662c 2076 6563 3420 6f74 6865  (self, vec4 othe
+00007c80: 7229 3a0a 2020 2020 2020 2020 2222 2249  r):.        """I
+00007c90: 6e6c 696e 6520 7665 6374 6f72 2073 7562  nline vector sub
+00007ca0: 7472 6163 7469 6f6e 2e0a 0a20 2020 2020  traction...     
+00007cb0: 2020 203e 3e3e 2061 3d76 6563 3428 312e     >>> a=vec4(1.
+00007cc0: 302c 2030 2e35 2c20 2d31 2e38 2c20 302e  0, 0.5, -1.8, 0.
+00007cd0: 3229 0a20 2020 2020 2020 203e 3e3e 2062  2).        >>> b
+00007ce0: 3d76 6563 3428 2d30 2e33 2c20 302e 3735  =vec4(-0.3, 0.75
+00007cf0: 2c20 302e 352c 2030 2e33 290a 2020 2020  , 0.5, 0.3).    
+00007d00: 2020 2020 3e3e 3e20 612d 3d62 0a20 2020      >>> a-=b.   
+00007d10: 2020 2020 203e 3e3e 2070 7269 6e74 2861       >>> print(a
+00007d20: 290a 2020 2020 2020 2020 2831 2e33 3030  ).        (1.300
+00007d30: 302c 202d 302e 3235 3030 2c20 2d32 2e33  0, -0.2500, -2.3
+00007d40: 3030 302c 202d 302e 3130 3030 290a 2020  000, -0.1000).  
+00007d50: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00007d60: 2020 7365 6c66 2e78 3d73 656c 662e 782d    self.x=self.x-
+00007d70: 6f74 6865 722e 780a 2020 2020 2020 2020  other.x.        
+00007d80: 7365 6c66 2e79 3d73 656c 662e 792d 6f74  self.y=self.y-ot
+00007d90: 6865 722e 790a 2020 2020 2020 2020 7365  her.y.        se
+00007da0: 6c66 2e7a 3d73 656c 662e 7a2d 6f74 6865  lf.z=self.z-othe
+00007db0: 722e 7a0a 2020 2020 2020 2020 7365 6c66  r.z.        self
+00007dc0: 2e77 3d73 656c 662e 772d 6f74 6865 722e  .w=self.w-other.
+00007dd0: 770a 2020 2020 2020 2020 7265 7475 726e  w.        return
+00007de0: 2073 656c 660a 0a20 2020 2064 6566 205f   self..    def _
+00007df0: 5f69 6d75 6c5f 5f28 7365 6c66 2c20 6f74  _imul__(self, ot
+00007e00: 6865 7229 3a0a 2020 2020 2020 2020 2222  her):.        ""
+00007e10: 2249 6e6c 696e 6520 6d75 6c74 6970 6c69  "Inline multipli
+00007e20: 6361 7469 6f6e 2028 6f6e 6c79 2077 6974  cation (only wit
+00007e30: 6820 7363 616c 6172 290a 0a20 2020 2020  h scalar)..     
+00007e40: 2020 203e 3e3e 2061 3d76 6563 3428 312e     >>> a=vec4(1.
+00007e50: 302c 2030 2e35 2c20 2d31 2e38 2c20 302e  0, 0.5, -1.8, 0.
+00007e60: 3229 0a20 2020 2020 2020 203e 3e3e 2061  2).        >>> a
+00007e70: 2a3d 322e 300a 2020 2020 2020 2020 3e3e  *=2.0.        >>
+00007e80: 3e20 7072 696e 7428 6129 0a20 2020 2020  > print(a).     
+00007e90: 2020 2028 322e 3030 3030 2c20 312e 3030     (2.0000, 1.00
+00007ea0: 3030 2c20 2d33 2e36 3030 302c 2030 2e34  00, -3.6000, 0.4
+00007eb0: 3030 3029 0a20 2020 2020 2020 2022 2222  000).        """
+00007ec0: 0a20 2020 2020 2020 2063 6465 6620 646f  .        cdef do
+00007ed0: 7562 6c65 2072 0a20 2020 2020 2020 2074  uble r.        t
+00007ee0: 6220 3d20 7479 7065 286f 7468 6572 290a  b = type(other).
+00007ef0: 2020 2020 2020 2020 6966 2074 6220 6973          if tb is
+00007f00: 2066 6c6f 6174 206f 7220 7462 2069 7320   float or tb is 
+00007f10: 696e 7420 6f72 2074 6220 6973 206c 6f6e  int or tb is lon
+00007f20: 673a 0a20 2020 2020 2020 2020 2020 2072  g:.            r
+00007f30: 3d6f 7468 6572 0a20 2020 2020 2020 2020  =other.         
+00007f40: 2020 2073 656c 662e 783d 7365 6c66 2e78     self.x=self.x
+00007f50: 2a72 0a20 2020 2020 2020 2020 2020 2073  *r.            s
+00007f60: 656c 662e 793d 7365 6c66 2e79 2a72 0a20  elf.y=self.y*r. 
+00007f70: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00007f80: 7a3d 7365 6c66 2e7a 2a72 0a20 2020 2020  z=self.z*r.     
+00007f90: 2020 2020 2020 2073 656c 662e 773d 7365         self.w=se
+00007fa0: 6c66 2e77 2a72 0a20 2020 2020 2020 2020  lf.w*r.         
+00007fb0: 2020 2072 6574 7572 6e20 7365 6c66 0a20     return self. 
+00007fc0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00007fd0: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
+00007fe0: 7970 6545 7272 6f72 2c20 2275 6e73 7570  ypeError, "unsup
+00007ff0: 706f 7274 6564 206f 7065 7261 6e64 2074  ported operand t
+00008000: 7970 6520 666f 7220 2a3d 220a 0a20 2020  ype for *="..   
+00008010: 2064 6566 205f 5f69 6469 765f 5f28 7365   def __idiv__(se
+00008020: 6c66 2c20 6f74 6865 7229 3a0a 2020 2020  lf, other):.    
+00008030: 2020 2020 2222 2249 6e6c 696e 6520 6469      """Inline di
+00008040: 7669 7369 6f6e 2077 6974 6820 7363 616c  vision with scal
+00008050: 6172 0a0a 2020 2020 2020 2020 3e3e 3e20  ar..        >>> 
+00008060: 613d 7665 6334 2831 2e30 2c20 302e 352c  a=vec4(1.0, 0.5,
+00008070: 202d 312e 382c 2030 2e32 290a 2020 2020   -1.8, 0.2).    
+00008080: 2020 2020 3e3e 3e20 612f 3d32 2e30 0a20      >>> a/=2.0. 
+00008090: 2020 2020 2020 203e 3e3e 2070 7269 6e74         >>> print
+000080a0: 2861 290a 2020 2020 2020 2020 2830 2e35  (a).        (0.5
+000080b0: 3030 302c 2030 2e32 3530 302c 202d 302e  000, 0.2500, -0.
+000080c0: 3930 3030 2c20 302e 3130 3030 290a 2020  9000, 0.1000).  
+000080d0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+000080e0: 2020 6364 6566 2064 6f75 626c 6520 720a    cdef double r.
+000080f0: 2020 2020 2020 2020 7462 203d 2074 7970          tb = typ
+00008100: 6528 6f74 6865 7229 0a20 2020 2020 2020  e(other).       
+00008110: 2069 6620 7462 2069 7320 666c 6f61 7420   if tb is float 
+00008120: 6f72 2074 6220 6973 2069 6e74 206f 7220  or tb is int or 
+00008130: 7462 2069 7320 6c6f 6e67 3a0a 2020 2020  tb is long:.    
+00008140: 2020 2020 2020 2020 723d 6f74 6865 720a          r=other.
+00008150: 2020 2020 2020 2020 2020 2020 6966 2066              if f
+00008160: 6162 7328 7229 3c3d 6570 733a 0a20 2020  abs(r)<=eps:.   
+00008170: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+00008180: 7365 205a 6572 6f44 6976 6973 696f 6e45  se ZeroDivisionE
+00008190: 7272 6f72 2c22 7665 6334 2064 6976 6973  rror,"vec4 divis
+000081a0: 696f 6e22 0a20 2020 2020 2020 2020 2020  ion".           
+000081b0: 2073 656c 662e 783d 7365 6c66 2e78 2f72   self.x=self.x/r
+000081c0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+000081d0: 662e 793d 7365 6c66 2e79 2f72 0a20 2020  f.y=self.y/r.   
+000081e0: 2020 2020 2020 2020 2073 656c 662e 7a3d           self.z=
+000081f0: 7365 6c66 2e7a 2f72 0a20 2020 2020 2020  self.z/r.       
+00008200: 2020 2020 2073 656c 662e 773d 7365 6c66       self.w=self
+00008210: 2e77 2f72 0a20 2020 2020 2020 2020 2020  .w/r.           
+00008220: 2072 6574 7572 6e20 7365 6c66 0a20 2020   return self.   
+00008230: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00008240: 2020 2020 2020 2072 6169 7365 2054 7970         raise Typ
+00008250: 6545 7272 6f72 2c20 2275 6e73 7570 706f  eError, "unsuppo
+00008260: 7274 6564 206f 7065 7261 6e64 2074 7970  rted operand typ
+00008270: 6520 666f 7220 2f3d 220a 0a20 2020 2064  e for /="..    d
+00008280: 6566 205f 5f69 6d6f 645f 5f28 7365 6c66  ef __imod__(self
+00008290: 2c20 6229 3a0a 2020 2020 2020 2020 2222  , b):.        ""
+000082a0: 2249 6e6c 696e 6520 6d6f 6475 6c6f 2e0a  "Inline modulo..
+000082b0: 0a20 2020 2020 2020 203e 3e3e 2061 3d76  .        >>> a=v
+000082c0: 6563 3428 332e 302c 2032 2e35 2c20 2d31  ec4(3.0, 2.5, -1
+000082d0: 2e38 2c20 302e 3229 0a20 2020 2020 2020  .8, 0.2).       
+000082e0: 203e 3e3e 2061 253d 322e 300a 2020 2020   >>> a%=2.0.    
+000082f0: 2020 2020 3e3e 3e20 7072 696e 7428 6129      >>> print(a)
+00008300: 0a20 2020 2020 2020 2028 312e 3030 3030  .        (1.0000
+00008310: 2c20 302e 3530 3030 2c20 302e 3230 3030  , 0.5000, 0.2000
+00008320: 2c20 302e 3230 3030 290a 2020 2020 2020  , 0.2000).      
+00008330: 2020 2222 220a 2020 2020 2020 2020 6364    """.        cd
+00008340: 6566 2076 6563 3420 7662 0a20 2020 2020  ef vec4 vb.     
+00008350: 2020 2063 6465 6620 646f 7562 6c65 2072     cdef double r
+00008360: 0a0a 2020 2020 2020 2020 7462 203d 2074  ..        tb = t
+00008370: 7970 6528 6229 0a0a 2020 2020 2020 2020  ype(b)..        
+00008380: 6966 2074 6220 6973 2066 6c6f 6174 206f  if tb is float o
+00008390: 7220 7462 2069 7320 696e 7420 6f72 2074  r tb is int or t
+000083a0: 6220 6973 206c 6f6e 673a 0a20 2020 2020  b is long:.     
+000083b0: 2020 2020 2020 2023 2076 6563 3425 3d73         # vec4%=s
+000083c0: 6361 6c61 720a 2020 2020 2020 2020 2020  calar.          
+000083d0: 2020 7220 3d20 620a 2020 2020 2020 2020    r = b.        
+000083e0: 2020 2020 6966 2066 6162 7328 7229 3c3d      if fabs(r)<=
+000083f0: 6570 733a 0a20 2020 2020 2020 2020 2020  eps:.           
+00008400: 2020 2020 2072 6169 7365 205a 6572 6f44       raise ZeroD
+00008410: 6976 6973 696f 6e45 7272 6f72 2c22 7665  ivisionError,"ve
+00008420: 6334 206d 6f64 756c 6f22 0a20 2020 2020  c4 modulo".     
+00008430: 2020 2020 2020 2073 656c 662e 7820 3d20         self.x = 
+00008440: 5f66 6d6f 6428 7365 6c66 2e78 2c72 290a  _fmod(self.x,r).
+00008450: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00008460: 2e79 203d 205f 666d 6f64 2873 656c 662e  .y = _fmod(self.
+00008470: 792c 7229 0a20 2020 2020 2020 2020 2020  y,r).           
+00008480: 2073 656c 662e 7a20 3d20 5f66 6d6f 6428   self.z = _fmod(
+00008490: 7365 6c66 2e7a 2c72 290a 2020 2020 2020  self.z,r).      
+000084a0: 2020 2020 2020 7365 6c66 2e77 203d 205f        self.w = _
+000084b0: 666d 6f64 2873 656c 662e 772c 7229 0a20  fmod(self.w,r). 
+000084c0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+000084d0: 6e20 7365 6c66 0a20 2020 2020 2020 2065  n self.        e
+000084e0: 6c69 6620 7462 2069 7320 7665 6334 3a0a  lif tb is vec4:.
+000084f0: 2020 2020 2020 2020 2020 2020 2320 7665              # ve
+00008500: 6334 253d 7665 6334 0a20 2020 2020 2020  c4%=vec4.       
+00008510: 2020 2020 2076 6220 3d20 620a 2020 2020       vb = b.    
+00008520: 2020 2020 2020 2020 6966 2028 6661 6273          if (fabs
+00008530: 2876 622e 7829 3c3d 6570 7320 6f72 2066  (vb.x)<=eps or f
+00008540: 6162 7328 7662 2e79 293c 3d65 7073 206f  abs(vb.y)<=eps o
+00008550: 720a 2020 2020 2020 2020 2020 2020 2020  r.              
+00008560: 2020 6661 6273 2876 622e 7a29 3c3d 6570    fabs(vb.z)<=ep
+00008570: 7320 6f72 2066 6162 7328 7662 2e77 293c  s or fabs(vb.w)<
+00008580: 3d65 7073 293a 0a20 2020 2020 2020 2020  =eps):.         
+00008590: 2020 2020 2020 2072 6169 7365 205a 6572         raise Zer
+000085a0: 6f44 6976 6973 696f 6e45 7272 6f72 2c22  oDivisionError,"
+000085b0: 7665 6334 206d 6f64 756c 6f22 0a20 2020  vec4 modulo".   
+000085c0: 2020 2020 2020 2020 2073 656c 662e 7820           self.x 
+000085d0: 3d20 5f66 6d6f 6428 7365 6c66 2e78 2c20  = _fmod(self.x, 
+000085e0: 7662 2e78 290a 2020 2020 2020 2020 2020  vb.x).          
+000085f0: 2020 7365 6c66 2e79 203d 205f 666d 6f64    self.y = _fmod
+00008600: 2873 656c 662e 792c 2076 622e 7929 0a20  (self.y, vb.y). 
+00008610: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00008620: 7a20 3d20 5f66 6d6f 6428 7365 6c66 2e7a  z = _fmod(self.z
+00008630: 2c20 7662 2e7a 290a 2020 2020 2020 2020  , vb.z).        
+00008640: 2020 2020 7365 6c66 2e77 203d 205f 666d      self.w = _fm
+00008650: 6f64 2873 656c 662e 772c 2076 622e 7729  od(self.w, vb.w)
+00008660: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00008670: 7572 6e20 7365 6c66 0a20 2020 2020 2020  urn self.       
+00008680: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00008690: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
+000086a0: 6f72 2c20 2275 6e73 7570 706f 7274 6564  or, "unsupported
+000086b0: 206f 7065 7261 6e64 2074 7970 6520 666f   operand type fo
+000086c0: 7220 253d 220a 0a0a 2020 2020 6465 6620  r %="...    def 
+000086d0: 5f5f 6162 735f 5f28 7365 6c66 293a 0a20  __abs__(self):. 
+000086e0: 2020 2020 2020 2022 2222 5265 7475 726e         """Return
+000086f0: 2074 6865 206c 656e 6774 6820 6f66 2074   the length of t
+00008700: 6865 2076 6563 746f 722e 0a0a 2020 2020  he vector...    
+00008710: 2020 2020 6162 7328 7629 2069 7320 6571      abs(v) is eq
+00008720: 7569 7661 6c65 6e74 2074 6f20 762e 6c65  uivalent to v.le
+00008730: 6e67 7468 2829 2e0a 0a20 2020 2020 2020  ngth()...       
+00008740: 203e 3e3e 2061 3d76 6563 3428 312e 302c   >>> a=vec4(1.0,
+00008750: 2030 2e35 2c20 2d31 2e38 2c20 302e 3229   0.5, -1.8, 0.2)
+00008760: 0a20 2020 2020 2020 203e 3e3e 2070 7269  .        >>> pri
+00008770: 6e74 2861 6273 2861 2929 0a20 2020 2020  nt(abs(a)).     
+00008780: 2020 2032 2e31 3238 3337 3936 3635 3338     2.12837966538
+00008790: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+000087a0: 2020 2020 2063 6465 6620 646f 7562 6c65       cdef double
+000087b0: 2061 0a20 2020 2020 2020 2061 203d 2073   a.        a = s
+000087c0: 656c 662e 782a 7365 6c66 2e78 202b 2073  elf.x*self.x + s
+000087d0: 656c 662e 792a 7365 6c66 2e79 202b 2073  elf.y*self.y + s
+000087e0: 656c 662e 7a2a 7365 6c66 2e7a 202b 2073  elf.z*self.z + s
+000087f0: 656c 662e 772a 7365 6c66 2e77 0a20 2020  elf.w*self.w.   
+00008800: 2020 2020 2072 6574 7572 6e20 7371 7274       return sqrt
+00008810: 2861 290a 0a20 2020 2064 6566 205f 5f67  (a)..    def __g
+00008820: 6574 6174 7472 5f5f 2873 656c 662c 206e  etattr__(self, n
+00008830: 616d 6529 3a0a 2020 2020 2020 2020 6966  ame):.        if
+00008840: 206e 616d 653d 3d22 7822 3a0a 2020 2020   name=="x":.    
 00008850: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00008860: 656c 662e 790a 2020 2020 2020 2020 656c  elf.y.        el
-00008870: 6966 206e 616d 653d 3d22 7a22 3a0a 2020  if name=="z":.  
+00008860: 656c 662e 780a 2020 2020 2020 2020 656c  elf.x.        el
+00008870: 6966 206e 616d 653d 3d22 7922 3a0a 2020  if name=="y":.  
 00008880: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00008890: 2073 656c 662e 7a0a 2020 2020 2020 2020   self.z.        
-000088a0: 656c 6966 206e 616d 653d 3d22 7722 206f  elif name=="w" o
-000088b0: 7220 6e61 6d65 3d3d 2274 223a 0a20 2020  r name=="t":.   
-000088c0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-000088d0: 7365 6c66 2e77 0a20 2020 2020 2020 2065  self.w.        e
-000088e0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-000088f0: 2072 6169 7365 2041 7474 7269 6275 7465   raise Attribute
-00008900: 4572 726f 722c 2276 6563 3420 6861 7320  Error,"vec4 has 
-00008910: 6e6f 2061 7474 7269 6275 7465 2027 222b  no attribute '"+
-00008920: 6e61 6d65 2b22 2722 0a0a 2020 2020 6465  name+"'"..    de
-00008930: 6620 5f5f 7365 7461 7474 725f 5f28 7365  f __setattr__(se
-00008940: 6c66 2c20 6e61 6d65 2c20 7661 6c29 3a0a  lf, name, val):.
-00008950: 2020 2020 2020 2020 6966 206e 616d 653d          if name=
-00008960: 3d22 7822 3a0a 2020 2020 2020 2020 2020  ="x":.          
-00008970: 2020 7365 6c66 2e78 203d 2076 616c 0a20    self.x = val. 
-00008980: 2020 2020 2020 2065 6c69 6620 6e61 6d65         elif name
-00008990: 3d3d 2279 223a 0a20 2020 2020 2020 2020  =="y":.         
-000089a0: 2020 2073 656c 662e 7920 3d20 7661 6c0a     self.y = val.
-000089b0: 2020 2020 2020 2020 656c 6966 206e 616d          elif nam
-000089c0: 653d 3d22 7a22 3a0a 2020 2020 2020 2020  e=="z":.        
-000089d0: 2020 2020 7365 6c66 2e7a 203d 2076 616c      self.z = val
-000089e0: 0a20 2020 2020 2020 2065 6c69 6620 6e61  .        elif na
-000089f0: 6d65 3d3d 2277 2220 6f72 206e 616d 653d  me=="w" or name=
-00008a00: 3d22 7422 3a0a 2020 2020 2020 2020 2020  ="t":.          
-00008a10: 2020 7365 6c66 2e77 203d 2076 616c 0a20    self.w = val. 
-00008a20: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00008a30: 2020 2020 2020 2020 2072 6169 7365 2041           raise A
-00008a40: 7474 7269 6275 7465 4572 726f 722c 2276  ttributeError,"v
-00008a50: 6563 3420 6861 7320 6e6f 2077 7269 7461  ec4 has no writa
-00008a60: 626c 6520 6174 7472 6962 7574 6520 2722  ble attribute '"
-00008a70: 2b6e 616d 652b 2227 220a 0a20 2020 2064  +name+"'"..    d
-00008a80: 6566 205f 5f6c 656e 5f5f 2873 656c 6629  ef __len__(self)
-00008a90: 3a0a 2020 2020 2020 2020 2222 224c 656e  :.        """Len
-00008aa0: 6774 6820 6f66 2074 6865 2073 6571 7565  gth of the seque
-00008ab0: 6e63 6520 2861 6c77 6179 7320 3429 2e22  nce (always 4)."
-00008ac0: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
-00008ad0: 6e20 340a 0a20 2020 2064 6566 205f 5f67  n 4..    def __g
-00008ae0: 6574 6974 656d 5f5f 2873 656c 662c 206b  etitem__(self, k
-00008af0: 6579 293a 0a20 2020 2020 2020 2022 2222  ey):.        """
-00008b00: 5265 7475 726e 2061 2063 6f6d 706f 6e65  Return a compone
-00008b10: 6e74 2062 7920 696e 6465 7820 2830 2d62  nt by index (0-b
-00008b20: 6173 6564 292e 0a0a 2020 2020 2020 2020  ased)...        
-00008b30: 3e3e 3e20 613d 7665 6334 2831 2e30 2c20  >>> a=vec4(1.0, 
-00008b40: 302e 352c 202d 312e 382c 2030 2e32 290a  0.5, -1.8, 0.2).
-00008b50: 2020 2020 2020 2020 3e3e 3e20 7072 696e          >>> prin
-00008b60: 7420 615b 305d 0a20 2020 2020 2020 2031  t a[0].        1
-00008b70: 2e30 0a20 2020 2020 2020 203e 3e3e 2070  .0.        >>> p
-00008b80: 7269 6e74 2061 5b31 5d0a 2020 2020 2020  rint a[1].      
-00008b90: 2020 302e 350a 2020 2020 2020 2020 3e3e    0.5.        >>
-00008ba0: 3e20 7072 696e 7420 615b 325d 0a20 2020  > print a[2].   
-00008bb0: 2020 2020 202d 312e 380a 2020 2020 2020       -1.8.      
-00008bc0: 2020 3e3e 3e20 7072 696e 7420 615b 335d    >>> print a[3]
-00008bd0: 0a20 2020 2020 2020 2030 2e32 0a20 2020  .        0.2.   
-00008be0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00008bf0: 2063 6465 6620 696e 7420 6b0a 0a20 2020   cdef int k..   
-00008c00: 2020 2020 2054 3d74 7970 6528 6b65 7929       T=type(key)
-00008c10: 0a20 2020 2020 2020 2069 6620 5421 3d69  .        if T!=i
-00008c20: 6e74 2061 6e64 2054 213d 6c6f 6e67 3a0a  nt and T!=long:.
-00008c30: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00008c40: 6520 5479 7065 4572 726f 722c 2022 696e  e TypeError, "in
-00008c50: 6465 7820 6d75 7374 2062 6520 696e 7465  dex must be inte
-00008c60: 6765 7222 0a0a 2020 2020 2020 2020 6b20  ger"..        k 
-00008c70: 3d20 6b65 790a 2020 2020 2020 2020 6966  = key.        if
-00008c80: 2020 206b 3d3d 303a 2072 6574 7572 6e20     k==0: return 
-00008c90: 7365 6c66 2e78 0a20 2020 2020 2020 2065  self.x.        e
-00008ca0: 6c69 6620 6b3d 3d31 3a20 7265 7475 726e  lif k==1: return
-00008cb0: 2073 656c 662e 790a 2020 2020 2020 2020   self.y.        
-00008cc0: 656c 6966 206b 3d3d 323a 2072 6574 7572  elif k==2: retur
-00008cd0: 6e20 7365 6c66 2e7a 0a20 2020 2020 2020  n self.z.       
-00008ce0: 2065 6c69 6620 6b3d 3d33 3a20 7265 7475   elif k==3: retu
-00008cf0: 726e 2073 656c 662e 770a 2020 2020 2020  rn self.w.      
-00008d00: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00008d10: 2020 2020 7261 6973 6520 496e 6465 7845      raise IndexE
-00008d20: 7272 6f72 2c22 696e 6465 7820 6f75 7420  rror,"index out 
-00008d30: 6f66 2072 616e 6765 220a 0a20 2020 2064  of range"..    d
-00008d40: 6566 205f 5f73 6574 6974 656d 5f5f 2873  ef __setitem__(s
-00008d50: 656c 662c 206b 6579 2c20 7661 6c75 6529  elf, key, value)
-00008d60: 3a0a 2020 2020 2020 2020 2222 2253 6574  :.        """Set
-00008d70: 2061 2063 6f6d 706f 6e65 6e74 2062 7920   a component by 
-00008d80: 696e 6465 7820 2830 2d62 6173 6564 292e  index (0-based).
-00008d90: 0a0a 2020 2020 2020 2020 3e3e 3e20 613d  ..        >>> a=
-00008da0: 7665 6334 2829 0a20 2020 2020 2020 203e  vec4().        >
-00008db0: 3e3e 2061 5b30 5d3d 312e 353b 2061 5b31  >> a[0]=1.5; a[1
-00008dc0: 5d3d 302e 373b 2061 5b32 5d3d 2d30 2e33  ]=0.7; a[2]=-0.3
-00008dd0: 3b20 615b 335d 3d30 2e32 0a20 2020 2020  ; a[3]=0.2.     
-00008de0: 2020 203e 3e3e 2070 7269 6e74 2061 0a20     >>> print a. 
-00008df0: 2020 2020 2020 2028 312e 3530 3030 2c20         (1.5000, 
-00008e00: 302e 3730 3030 2c20 2d30 2e33 3030 302c  0.7000, -0.3000,
-00008e10: 2030 2e32 3030 3029 0a20 2020 2020 2020   0.2000).       
-00008e20: 2022 2222 0a20 2020 2020 2020 2063 6465   """.        cde
-00008e30: 6620 696e 7420 6b0a 0a20 2020 2020 2020  f int k..       
-00008e40: 2054 3d74 7970 6528 6b65 7929 0a20 2020   T=type(key).   
-00008e50: 2020 2020 2069 6620 5421 3d69 6e74 2061       if T!=int a
-00008e60: 6e64 2054 213d 6c6f 6e67 3a0a 2020 2020  nd T!=long:.    
-00008e70: 2020 2020 2020 2020 7261 6973 6520 5479          raise Ty
-00008e80: 7065 4572 726f 722c 2022 696e 6465 7820  peError, "index 
-00008e90: 6d75 7374 2062 6520 696e 7465 6765 7222  must be integer"
-00008ea0: 0a0a 2020 2020 2020 2020 6b20 3d20 6b65  ..        k = ke
-00008eb0: 790a 2020 2020 2020 2020 6966 2020 206b  y.        if   k
-00008ec0: 3d3d 303a 2073 656c 662e 7820 3d20 7661  ==0: self.x = va
-00008ed0: 6c75 650a 2020 2020 2020 2020 656c 6966  lue.        elif
-00008ee0: 206b 3d3d 313a 2073 656c 662e 7920 3d20   k==1: self.y = 
-00008ef0: 7661 6c75 650a 2020 2020 2020 2020 656c  value.        el
-00008f00: 6966 206b 3d3d 323a 2073 656c 662e 7a20  if k==2: self.z 
-00008f10: 3d20 7661 6c75 650a 2020 2020 2020 2020  = value.        
-00008f20: 656c 6966 206b 3d3d 333a 2073 656c 662e  elif k==3: self.
-00008f30: 7720 3d20 7661 6c75 650a 2020 2020 2020  w = value.      
-00008f40: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00008f50: 2020 2020 7261 6973 6520 496e 6465 7845      raise IndexE
-00008f60: 7272 6f72 2c22 696e 6465 7820 6f75 7420  rror,"index out 
-00008f70: 6f66 2072 616e 6765 220a 0a20 2020 2064  of range"..    d
-00008f80: 6566 206c 656e 6774 6828 7365 6c66 293a  ef length(self):
-00008f90: 0a20 2020 2020 2020 2022 2222 5265 7475  .        """Retu
-00008fa0: 726e 2074 6865 206c 656e 6774 6820 6f66  rn the length of
-00008fb0: 2074 6865 2076 6563 746f 722e 0a0a 2020   the vector...  
-00008fc0: 2020 2020 2020 762e 6c65 6e67 7468 2829        v.length()
-00008fd0: 2069 7320 6571 7569 7661 6c65 6e74 2074   is equivalent t
-00008fe0: 6f20 6162 7328 7629 2e0a 0a20 2020 2020  o abs(v)...     
-00008ff0: 2020 203e 3e3e 2061 3d76 6563 3428 312e     >>> a=vec4(1.
-00009000: 302c 2030 2e35 2c20 2d31 2e38 2c20 302e  0, 0.5, -1.8, 0.
-00009010: 3229 0a20 2020 2020 2020 203e 3e3e 2070  2).        >>> p
-00009020: 7269 6e74 2061 2e6c 656e 6774 6828 290a  rint a.length().
-00009030: 2020 2020 2020 2020 322e 3132 3833 3739          2.128379
-00009040: 3636 3533 380a 2020 2020 2020 2020 2222  66538.        ""
-00009050: 220a 2020 2020 2020 2020 6364 6566 2064  ".        cdef d
-00009060: 6f75 626c 6520 610a 2020 2020 2020 2020  ouble a.        
-00009070: 6120 3d20 7365 6c66 2e78 2a73 656c 662e  a = self.x*self.
-00009080: 7820 2b20 7365 6c66 2e79 2a73 656c 662e  x + self.y*self.
-00009090: 7920 2b20 7365 6c66 2e7a 2a73 656c 662e  y + self.z*self.
-000090a0: 7a20 2b20 7365 6c66 2e77 2a73 656c 662e  z + self.w*self.
-000090b0: 770a 2020 2020 2020 2020 7265 7475 726e  w.        return
-000090c0: 2073 7172 7428 6129 0a0a 2020 2020 6465   sqrt(a)..    de
-000090d0: 6620 6e6f 726d 616c 697a 6528 7365 6c66  f normalize(self
-000090e0: 293a 0a20 2020 2020 2020 2022 2222 5265  ):.        """Re
-000090f0: 7475 726e 206e 6f72 6d61 6c69 7a65 6420  turn normalized 
-00009100: 7665 6374 6f72 2e0a 0a20 2020 2020 2020  vector...       
-00009110: 203e 3e3e 2061 3d76 6563 3428 312e 302c   >>> a=vec4(1.0,
-00009120: 2030 2e35 2c20 2d31 2e38 2c20 312e 3229   0.5, -1.8, 1.2)
-00009130: 0a20 2020 2020 2020 203e 3e3e 2070 7269  .        >>> pri
-00009140: 6e74 2061 2e6e 6f72 6d61 6c69 7a65 2829  nt a.normalize()
-00009150: 0a20 2020 2020 2020 2028 302e 3431 3037  .        (0.4107
-00009160: 2c20 302e 3230 3533 2c20 2d30 2e37 3339  , 0.2053, -0.739
-00009170: 322c 2030 2e34 3932 3829 0a20 2020 2020  2, 0.4928).     
-00009180: 2020 2022 2222 0a20 2020 2020 2020 2063     """.        c
-00009190: 6465 6620 7665 6334 2072 6573 0a20 2020  def vec4 res.   
-000091a0: 2020 2020 2063 6465 6620 646f 7562 6c65       cdef double
-000091b0: 206e 6c65 6e0a 0a20 2020 2020 2020 206e   nlen..        n
-000091c0: 6c65 6e20 3d20 7371 7274 2873 656c 662e  len = sqrt(self.
-000091d0: 782a 7365 6c66 2e78 202b 2073 656c 662e  x*self.x + self.
-000091e0: 792a 7365 6c66 2e79 202b 2073 656c 662e  y*self.y + self.
-000091f0: 7a2a 7365 6c66 2e7a 202b 2073 656c 662e  z*self.z + self.
-00009200: 772a 7365 6c66 2e77 290a 2020 2020 2020  w*self.w).      
-00009210: 2020 6966 206e 6c65 6e3c 3d65 7073 3a0a    if nlen<=eps:.
-00009220: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00009230: 6520 5a65 726f 4469 7669 7369 6f6e 4572  e ZeroDivisionEr
-00009240: 726f 722c 226e 756c 6c20 7665 6374 6f72  ror,"null vector
-00009250: 2063 616e 2774 2062 6520 6e6f 726d 616c   can't be normal
-00009260: 697a 6564 220a 2020 2020 2020 2020 6e6c  ized".        nl
-00009270: 656e 203d 2031 2e30 2f6e 6c65 6e0a 2020  en = 1.0/nlen.  
-00009280: 2020 2020 2020 7265 7320 3d20 7665 6334        res = vec4
-00009290: 2829 0a20 2020 2020 2020 2072 6573 2e78  ().        res.x
-000092a0: 203d 2073 656c 662e 782a 6e6c 656e 0a20   = self.x*nlen. 
-000092b0: 2020 2020 2020 2072 6573 2e79 203d 2073         res.y = s
-000092c0: 656c 662e 792a 6e6c 656e 0a20 2020 2020  elf.y*nlen.     
-000092d0: 2020 2072 6573 2e7a 203d 2073 656c 662e     res.z = self.
-000092e0: 7a2a 6e6c 656e 0a20 2020 2020 2020 2072  z*nlen.        r
-000092f0: 6573 2e77 203d 2073 656c 662e 772a 6e6c  es.w = self.w*nl
-00009300: 656e 0a20 2020 2020 2020 2072 6574 7572  en.        retur
-00009310: 6e20 7265 730a 0a23 2323 2323 2323 2323  n res..#########
-00009320: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00009330: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00009340: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00009350: 2323 2323 2323 2323 2323 2323 230a 0a23  #############..#
-00009360: 206d 6174 3369 7465 720a 6364 6566 2063   mat3iter.cdef c
-00009370: 6c61 7373 206d 6174 3369 7465 723a 0a20  lass mat3iter:. 
-00009380: 2020 2022 2222 6d61 7420 6974 6572 6174     """mat iterat
-00009390: 6f72 2e22 2222 0a20 2020 2063 6465 6620  or.""".    cdef 
-000093a0: 696e 7420 6964 780a 2020 2020 6364 6566  int idx.    cdef
-000093b0: 206f 626a 6563 7420 6d0a 0a20 2020 2064   object m..    d
-000093c0: 6566 205f 5f63 696e 6974 5f5f 2873 656c  ef __cinit__(sel
-000093d0: 662c 206d 293a 0a20 2020 2020 2020 2073  f, m):.        s
-000093e0: 656c 662e 6964 7820 3d20 300a 2020 2020  elf.idx = 0.    
-000093f0: 2020 2020 7365 6c66 2e6d 2020 203d 206d      self.m   = m
-00009400: 0a0a 2020 2020 6465 6620 5f5f 6974 6572  ..    def __iter
-00009410: 5f5f 2873 656c 6629 3a0a 2020 2020 2020  __(self):.      
-00009420: 2020 7265 7475 726e 2073 656c 660a 0a20    return self.. 
-00009430: 2020 2064 6566 205f 5f6e 6578 745f 5f28     def __next__(
-00009440: 7365 6c66 293a 0a20 2020 2020 2020 2069  self):.        i
-00009450: 6620 7365 6c66 2e69 6478 3d3d 303a 0a20  f self.idx==0:. 
-00009460: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00009470: 6964 783d 310a 2020 2020 2020 2020 2020  idx=1.          
-00009480: 2020 7265 7475 726e 2073 656c 662e 6d5b    return self.m[
-00009490: 305d 0a20 2020 2020 2020 2065 6c69 6620  0].        elif 
-000094a0: 7365 6c66 2e69 6478 3d3d 313a 0a20 2020  self.idx==1:.   
-000094b0: 2020 2020 2020 2020 2073 656c 662e 6964           self.id
-000094c0: 783d 320a 2020 2020 2020 2020 2020 2020  x=2.            
-000094d0: 7265 7475 726e 2073 656c 662e 6d5b 315d  return self.m[1]
-000094e0: 0a20 2020 2020 2020 2065 6c69 6620 7365  .        elif se
-000094f0: 6c66 2e69 6478 3d3d 323a 0a20 2020 2020  lf.idx==2:.     
-00009500: 2020 2020 2020 2073 656c 662e 6964 783d         self.idx=
-00009510: 330a 2020 2020 2020 2020 2020 2020 7265  3.            re
-00009520: 7475 726e 2073 656c 662e 6d5b 325d 0a20  turn self.m[2]. 
-00009530: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00009540: 2020 2020 2020 2020 2072 6169 7365 2053           raise S
-00009550: 746f 7049 7465 7261 7469 6f6e 0a0a 2320  topIteration..# 
-00009560: 6d61 7433 0a63 6465 6620 636c 6173 7320  mat3.cdef class 
-00009570: 6d61 7433 3a0a 0a20 2020 2063 6465 6620  mat3:..    cdef 
-00009580: 646f 7562 6c65 206d 3131 2c20 6d31 322c  double m11, m12,
-00009590: 206d 3133 0a20 2020 2063 6465 6620 646f   m13.    cdef do
-000095a0: 7562 6c65 206d 3231 2c20 6d32 322c 206d  uble m21, m22, m
-000095b0: 3233 0a20 2020 2063 6465 6620 646f 7562  23.    cdef doub
-000095c0: 6c65 206d 3331 2c20 6d33 322c 206d 3333  le m31, m32, m33
-000095d0: 0a0a 2020 2020 6465 6620 5f5f 6369 6e69  ..    def __cini
-000095e0: 745f 5f28 7365 6c66 2c20 2a61 7267 7329  t__(self, *args)
-000095f0: 3a0a 2020 2020 2020 2020 2222 2243 6f6e  :.        """Con
-00009600: 7374 7275 6374 6f72 2e0a 0a20 2020 2020  structor...     
-00009610: 2020 2054 6865 7265 2061 7265 2073 6576     There are sev
-00009620: 6572 616c 2070 6f73 7369 6269 6c69 7469  eral possibiliti
-00009630: 6573 2068 6f77 2074 6f20 696e 6974 6961  es how to initia
-00009640: 6c69 7a65 2061 206d 6174 7269 782c 0a20  lize a matrix,. 
-00009650: 2020 2020 2020 2064 6570 656e 6469 6e67         depending
-00009660: 206f 6e20 7468 6520 6e75 6d62 6572 206f   on the number o
-00009670: 6620 6172 6775 6d65 6e74 7320 796f 7520  f arguments you 
-00009680: 7072 6f76 6964 6520 746f 2074 6865 2063  provide to the c
-00009690: 6f6e 7374 7275 6374 6f72 2e0a 0a20 2020  onstructor...   
-000096a0: 2020 2020 202d 2030 2061 7267 756d 656e       - 0 argumen
-000096b0: 7473 3a20 4576 6572 7920 636f 6d70 6f6e  ts: Every compon
-000096c0: 656e 7420 6973 207a 6572 6f2e 0a20 2020  ent is zero..   
-000096d0: 2020 2020 202d 2031 206e 756d 6265 7220       - 1 number 
-000096e0: 6172 6775 6d65 6e74 3a20 5468 6520 6469  argument: The di
-000096f0: 6167 6f6e 616c 2069 7320 696e 6974 6961  agonal is initia
-00009700: 6c69 7a65 6420 746f 2074 6861 7420 6e75  lized to that nu
-00009710: 6d62 6572 2c0a 2020 2020 2020 2020 2020  mber,.          
-00009720: 616c 6c20 7468 6520 6f74 6865 7220 656c  all the other el
-00009730: 656d 656e 7473 2061 7265 207a 6572 6f2e  ements are zero.
-00009740: 0a20 2020 2020 2020 202d 2031 2073 6571  .        - 1 seq
-00009750: 7565 6e63 6520 6172 6775 6d65 6e74 3a20  uence argument: 
-00009760: 5468 6520 656c 656d 656e 7473 2061 7265  The elements are
-00009770: 2069 6e69 7469 616c 697a 6564 2077 6974   initialized wit
-00009780: 6820 7468 6520 6e75 6d62 6572 730a 2020  h the numbers.  
-00009790: 2020 2020 2020 2020 696e 2074 6865 2073          in the s
-000097a0: 6571 7565 6e63 6520 2874 6865 2073 6571  equence (the seq
-000097b0: 7565 6e63 6520 6d75 7374 2063 6f6e 7461  uence must conta
-000097c0: 696e 2039 206e 756d 6265 7273 292e 0a20  in 9 numbers).. 
-000097d0: 2020 2020 2020 202d 2031 206d 6174 3320         - 1 mat3 
-000097e0: 6172 6775 6d65 6e74 3a20 5468 6520 6d61  argument: The ma
-000097f0: 7472 6978 2069 7320 636f 7069 6564 2e0a  trix is copied..
-00009800: 2020 2020 2020 2020 2d20 3320 7365 7175          - 3 sequ
-00009810: 656e 6365 2061 7267 756d 656e 7473 3a20  ence arguments: 
-00009820: 5468 6520 636f 6c75 6d6e 7320 6172 6520  The columns are 
-00009830: 696e 6974 6961 6c69 7a65 6420 7769 7468  initialized with
-00009840: 2074 6865 0a20 2020 2020 2020 2020 2072   the.          r
-00009850: 6573 7065 6374 6976 6520 7365 7175 656e  espective sequen
-00009860: 6365 2028 6561 6368 2073 6571 7565 6e63  ce (each sequenc
-00009870: 6520 6d75 7374 2063 6f6e 7461 696e 2033  e must contain 3
-00009880: 206e 756d 6265 7273 292e 0a20 2020 2020   numbers)..     
-00009890: 2020 202d 2039 206e 756d 6265 7220 6172     - 9 number ar
-000098a0: 6775 6d65 6e74 733a 2054 6865 206d 6174  guments: The mat
-000098b0: 7269 7820 6973 2069 6e69 7469 616c 697a  rix is initializ
-000098c0: 6564 2077 6974 6820 7468 6f73 6520 7661  ed with those va
-000098d0: 6c75 6573 0a20 2020 2020 2020 2020 2028  lues.          (
-000098e0: 726f 772d 6d61 6a6f 7220 6f72 6465 7229  row-major order)
-000098f0: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-00009900: 2020 2020 2020 6364 6566 2069 6e74 2061        cdef int a
-00009910: 7267 6c65 6e0a 2020 2020 2020 2020 6364  rglen.        cd
-00009920: 6566 206d 6174 3320 420a 2020 2020 2020  ef mat3 B.      
-00009930: 2020 6172 676c 656e 203d 206c 656e 2861    arglen = len(a
-00009940: 7267 7329 0a0a 2020 2020 2020 2020 2320  rgs)..        # 
-00009950: 4e6f 2061 7267 756d 656e 7473 0a20 2020  No arguments.   
-00009960: 2020 2020 2069 6620 6172 676c 656e 3d3d       if arglen==
-00009970: 303a 0a20 2020 2020 2020 2020 2020 206d  0:.            m
-00009980: 3131 3d6d 3132 3d6d 3133 3d30 2e30 0a20  11=m12=m13=0.0. 
-00009990: 2020 2020 2020 2020 2020 206d 3231 3d6d             m21=m
-000099a0: 3232 3d6d 3233 3d30 2e30 0a20 2020 2020  22=m23=0.0.     
-000099b0: 2020 2020 2020 206d 3331 3d6d 3332 3d6d         m31=m32=m
-000099c0: 3333 3d30 2e30 0a0a 2020 2020 2020 2020  33=0.0..        
-000099d0: 2320 3120 6172 6775 6d65 6e74 2028 6c69  # 1 argument (li
-000099e0: 7374 2c20 7363 616c 6172 206f 7220 6d61  st, scalar or ma
-000099f0: 7433 290a 2020 2020 2020 2020 656c 6966  t3).        elif
-00009a00: 2061 7267 6c65 6e3d 3d31 3a0a 2020 2020   arglen==1:.    
-00009a10: 2020 2020 2020 2020 5420 3d20 7479 7065          T = type
-00009a20: 2861 7267 735b 305d 290a 2020 2020 2020  (args[0]).      
-00009a30: 2020 2020 2020 2320 7363 616c 6172 0a20        # scalar. 
-00009a40: 2020 2020 2020 2020 2020 2069 6620 5420             if T 
-00009a50: 6973 2066 6c6f 6174 206f 7220 5420 6973  is float or T is
-00009a60: 2069 6e74 206f 7220 5420 6973 206c 6f6e   int or T is lon
-00009a70: 673a 0a20 2020 2020 2020 2020 2020 2020  g:.             
-00009a80: 2020 2073 656c 662e 6d31 3120 3d20 6172     self.m11 = ar
-00009a90: 6773 5b30 5d0a 2020 2020 2020 2020 2020  gs[0].          
-00009aa0: 2020 2020 2020 7365 6c66 2e6d 3132 203d        self.m12 =
-00009ab0: 2030 2e30 0a20 2020 2020 2020 2020 2020   0.0.           
-00009ac0: 2020 2020 2073 656c 662e 6d31 3320 3d20       self.m13 = 
-00009ad0: 302e 300a 2020 2020 2020 2020 2020 2020  0.0.            
-00009ae0: 2020 2020 7365 6c66 2e6d 3231 203d 2030      self.m21 = 0
-00009af0: 2e30 0a20 2020 2020 2020 2020 2020 2020  .0.             
-00009b00: 2020 2073 656c 662e 6d32 3220 3d20 7365     self.m22 = se
-00009b10: 6c66 2e6d 3131 0a20 2020 2020 2020 2020  lf.m11.         
-00009b20: 2020 2020 2020 2073 656c 662e 6d32 3320         self.m23 
-00009b30: 3d20 302e 300a 2020 2020 2020 2020 2020  = 0.0.          
-00009b40: 2020 2020 2020 7365 6c66 2e6d 3331 203d        self.m31 =
-00009b50: 2030 2e30 0a20 2020 2020 2020 2020 2020   0.0.           
-00009b60: 2020 2020 2073 656c 662e 6d33 3220 3d20       self.m32 = 
-00009b70: 302e 300a 2020 2020 2020 2020 2020 2020  0.0.            
-00009b80: 2020 2020 7365 6c66 2e6d 3333 203d 2073      self.m33 = s
-00009b90: 656c 662e 6d31 310a 0a20 2020 2020 2020  elf.m11..       
-00009ba0: 2020 2020 2023 206d 6174 330a 2020 2020       # mat3.    
-00009bb0: 2020 2020 2020 2020 656c 6966 2054 2069          elif T i
-00009bc0: 7320 6d61 7433 3a0a 2020 2020 2020 2020  s mat3:.        
-00009bd0: 2020 2020 2020 2020 4220 3d20 6172 6773          B = args
-00009be0: 5b30 5d0a 2020 2020 2020 2020 2020 2020  [0].            
-00009bf0: 2020 2020 7365 6c66 2e6d 3131 203d 2042      self.m11 = B
-00009c00: 2e6d 3131 0a20 2020 2020 2020 2020 2020  .m11.           
-00009c10: 2020 2020 2073 656c 662e 6d31 3220 3d20       self.m12 = 
-00009c20: 422e 6d31 320a 2020 2020 2020 2020 2020  B.m12.          
-00009c30: 2020 2020 2020 7365 6c66 2e6d 3133 203d        self.m13 =
-00009c40: 2042 2e6d 3133 0a20 2020 2020 2020 2020   B.m13.         
-00009c50: 2020 2020 2020 2073 656c 662e 6d32 3120         self.m21 
-00009c60: 3d20 422e 6d32 310a 2020 2020 2020 2020  = B.m21.        
-00009c70: 2020 2020 2020 2020 7365 6c66 2e6d 3232          self.m22
-00009c80: 203d 2042 2e6d 3232 0a20 2020 2020 2020   = B.m22.       
-00009c90: 2020 2020 2020 2020 2073 656c 662e 6d32           self.m2
-00009ca0: 3320 3d20 422e 6d32 330a 2020 2020 2020  3 = B.m23.      
-00009cb0: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
-00009cc0: 3331 203d 2042 2e6d 3331 0a20 2020 2020  31 = B.m31.     
-00009cd0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00009ce0: 6d33 3220 3d20 422e 6d33 320a 2020 2020  m32 = B.m32.    
-00009cf0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00009d00: 2e6d 3333 203d 2042 2e6d 3333 0a20 2020  .m33 = B.m33.   
-00009d10: 2020 2020 2020 2020 2023 2053 7472 696e           # Strin
-00009d20: 670a 2020 2020 2020 2020 2020 2020 656c  g.            el
-00009d30: 6966 2054 2069 7320 7374 7220 6f72 2054  if T is str or T
-00009d40: 2069 7320 756e 6963 6f64 653a 0a20 2020   is unicode:.   
-00009d50: 2020 2020 2020 2020 2020 2020 2073 3d61               s=a
-00009d60: 7267 735b 305d 2e72 6570 6c61 6365 2822  rgs[0].replace("
-00009d70: 2c22 2c22 2022 292e 7265 706c 6163 6528  ,"," ").replace(
-00009d80: 2220 2022 2c22 2022 292e 7374 7269 7028  "  "," ").strip(
-00009d90: 292e 7370 6c69 7428 2220 2229 0a20 2020  ).split(" ").   
-00009da0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00009db0: 733d 3d5b 2222 5d3a 0a20 2020 2020 2020  s==[""]:.       
-00009dc0: 2020 2020 2020 2020 2020 2020 2073 3d5b               s=[
-00009dd0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-00009de0: 2020 666f 7220 6920 696e 2072 616e 6765    for i in range
-00009df0: 286c 656e 2873 2929 3a0a 2020 2020 2020  (len(s)):.      
-00009e00: 2020 2020 2020 2020 2020 2020 2020 7472                tr
-00009e10: 793a 0a20 2020 2020 2020 2020 2020 2020  y:.             
-00009e20: 2020 2020 2020 2020 2020 2073 5b69 5d20             s[i] 
-00009e30: 3d20 666c 6f61 7428 735b 695d 290a 2020  = float(s[i]).  
-00009e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009e50: 2020 6578 6365 7074 3a0a 2020 2020 2020    except:.      
-00009e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009e70: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-00009e80: 6f72 2c22 6d61 7433 2829 2061 7267 2069  or,"mat3() arg i
-00009e90: 7320 6120 6d61 6c66 6f72 6d65 6420 7374  s a malformed st
-00009ea0: 7269 6e67 220a 2020 2020 2020 2020 2020  ring".          
-00009eb0: 2020 2020 2020 4220 3d20 6d61 7433 2873        B = mat3(s
-00009ec0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00009ed0: 2020 7365 6c66 2e6d 3131 203d 2042 2e6d    self.m11 = B.m
-00009ee0: 3131 0a20 2020 2020 2020 2020 2020 2020  11.             
-00009ef0: 2020 2073 656c 662e 6d31 3220 3d20 422e     self.m12 = B.
-00009f00: 6d31 320a 2020 2020 2020 2020 2020 2020  m12.            
-00009f10: 2020 2020 7365 6c66 2e6d 3133 203d 2042      self.m13 = B
-00009f20: 2e6d 3133 0a20 2020 2020 2020 2020 2020  .m13.           
-00009f30: 2020 2020 2073 656c 662e 6d32 3120 3d20       self.m21 = 
-00009f40: 422e 6d32 310a 2020 2020 2020 2020 2020  B.m21.          
-00009f50: 2020 2020 2020 7365 6c66 2e6d 3232 203d        self.m22 =
-00009f60: 2042 2e6d 3232 0a20 2020 2020 2020 2020   B.m22.         
-00009f70: 2020 2020 2020 2073 656c 662e 6d32 3320         self.m23 
-00009f80: 3d20 422e 6d32 330a 2020 2020 2020 2020  = B.m23.        
-00009f90: 2020 2020 2020 2020 7365 6c66 2e6d 3331          self.m31
-00009fa0: 203d 2042 2e6d 3331 0a20 2020 2020 2020   = B.m31.       
-00009fb0: 2020 2020 2020 2020 2073 656c 662e 6d33           self.m3
-00009fc0: 3220 3d20 422e 6d33 320a 2020 2020 2020  2 = B.m32.      
-00009fd0: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
-00009fe0: 3333 203d 2042 2e6d 3333 0a20 2020 2020  33 = B.m33.     
-00009ff0: 2020 2020 2020 2023 2053 6571 7565 6e63         # Sequenc
-0000a000: 6520 6f66 2039 2066 6c6f 6174 730a 2020  e of 9 floats.  
-0000a010: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-0000a020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a030: 7365 7120 3d20 6172 6773 5b30 5d0a 2020  seq = args[0].  
-0000a040: 2020 2020 2020 2020 2020 2020 2020 7472                tr
-0000a050: 793a 0a20 2020 2020 2020 2020 2020 2020  y:.             
-0000a060: 2020 2020 2020 2073 6571 6c65 6e20 3d20         seqlen = 
-0000a070: 6c65 6e28 7365 7129 0a20 2020 2020 2020  len(seq).       
-0000a080: 2020 2020 2020 2020 2065 7863 6570 743a           except:
-0000a090: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000a0a0: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
-0000a0b0: 7272 6f72 2c22 6d61 7433 2829 2061 7267  rror,"mat3() arg
-0000a0c0: 2063 616e 2774 2062 6520 636f 6e76 6572   can't be conver
-0000a0d0: 7465 6420 746f 206d 6174 3322 0a0a 2020  ted to mat3"..  
-0000a0e0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0000a0f0: 2073 6571 6c65 6e3d 3d39 3a0a 2020 2020   seqlen==9:.    
-0000a100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a110: 7365 6c66 2e6d 3131 203d 2073 6571 5b30  self.m11 = seq[0
-0000a120: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-0000a130: 2020 2020 2020 7365 6c66 2e6d 3132 203d        self.m12 =
-0000a140: 2073 6571 5b31 5d0a 2020 2020 2020 2020   seq[1].        
-0000a150: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0000a160: 2e6d 3133 203d 2073 6571 5b32 5d0a 2020  .m13 = seq[2].  
-0000a170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a180: 2020 7365 6c66 2e6d 3231 203d 2073 6571    self.m21 = seq
-0000a190: 5b33 5d0a 2020 2020 2020 2020 2020 2020  [3].            
-0000a1a0: 2020 2020 2020 2020 7365 6c66 2e6d 3232          self.m22
-0000a1b0: 203d 2073 6571 5b34 5d0a 2020 2020 2020   = seq[4].      
-0000a1c0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0000a1d0: 6c66 2e6d 3233 203d 2073 6571 5b35 5d0a  lf.m23 = seq[5].
-0000a1e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a1f0: 2020 2020 7365 6c66 2e6d 3331 203d 2073      self.m31 = s
-0000a200: 6571 5b36 5d0a 2020 2020 2020 2020 2020  eq[6].          
-0000a210: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
-0000a220: 3332 203d 2073 6571 5b37 5d0a 2020 2020  32 = seq[7].    
-0000a230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a240: 7365 6c66 2e6d 3333 203d 2073 6571 5b38  self.m33 = seq[8
-0000a250: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-0000a260: 2020 656c 6966 2073 6571 6c65 6e3d 3d33    elif seqlen==3
-0000a270: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0000a280: 2020 2020 2020 6220 3d20 7365 715b 305d        b = seq[0]
-0000a290: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000a2a0: 2020 2020 2073 656c 662e 6d31 3120 3d20       self.m11 = 
-0000a2b0: 625b 305d 0a20 2020 2020 2020 2020 2020  b[0].           
-0000a2c0: 2020 2020 2020 2020 2073 656c 662e 6d32           self.m2
-0000a2d0: 3120 3d20 625b 315d 0a20 2020 2020 2020  1 = b[1].       
-0000a2e0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0000a2f0: 662e 6d33 3120 3d20 625b 325d 0a20 2020  f.m31 = b[2].   
-0000a300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a310: 2062 203d 2073 6571 5b31 5d0a 2020 2020   b = seq[1].    
-0000a320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a330: 7365 6c66 2e6d 3132 203d 2062 5b30 5d0a  self.m12 = b[0].
-0000a340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a350: 2020 2020 7365 6c66 2e6d 3232 203d 2062      self.m22 = b
-0000a360: 5b31 5d0a 2020 2020 2020 2020 2020 2020  [1].            
-0000a370: 2020 2020 2020 2020 7365 6c66 2e6d 3332          self.m32
-0000a380: 203d 2062 5b32 5d0a 2020 2020 2020 2020   = b[2].        
-0000a390: 2020 2020 2020 2020 2020 2020 6220 3d20              b = 
-0000a3a0: 7365 715b 325d 0a20 2020 2020 2020 2020  seq[2].         
-0000a3b0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0000a3c0: 6d31 3320 3d20 625b 305d 0a20 2020 2020  m13 = b[0].     
-0000a3d0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0000a3e0: 656c 662e 6d32 3320 3d20 625b 315d 0a20  elf.m23 = b[1]. 
-0000a3f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a400: 2020 2073 656c 662e 6d33 3320 3d20 625b     self.m33 = b[
-0000a410: 325d 0a20 2020 2020 2020 2020 2020 2020  2].             
-0000a420: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0000a430: 2020 2020 2020 2020 2020 2020 2072 6169               rai
-0000a440: 7365 2054 7970 6545 7272 6f72 2c20 226d  se TypeError, "m
-0000a450: 6174 3328 2920 7461 6b65 7320 6174 206d  at3() takes at m
-0000a460: 6f73 7420 3920 6172 6775 6d65 6e74 7322  ost 9 arguments"
-0000a470: 0a0a 2020 2020 2020 2020 2320 3320 6172  ..        # 3 ar
-0000a480: 6775 6d65 6e74 7320 2863 6f6c 756d 6e73  guments (columns
-0000a490: 2061 7320 7365 7175 656e 6365 7329 0a20   as sequences). 
-0000a4a0: 2020 2020 2020 2065 6c69 6620 6172 676c         elif argl
-0000a4b0: 656e 3d3d 333a 0a20 2020 2020 2020 2020  en==3:.         
-0000a4c0: 2020 2061 2c62 2c63 3d61 7267 730a 2020     a,b,c=args.  
-0000a4d0: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
-0000a4e0: 3131 203d 2061 5b30 5d0a 2020 2020 2020  11 = a[0].      
-0000a4f0: 2020 2020 2020 7365 6c66 2e6d 3132 203d        self.m12 =
-0000a500: 2062 5b30 5d0a 2020 2020 2020 2020 2020   b[0].          
-0000a510: 2020 7365 6c66 2e6d 3133 203d 2063 5b30    self.m13 = c[0
-0000a520: 5d0a 2020 2020 2020 2020 2020 2020 7365  ].            se
-0000a530: 6c66 2e6d 3231 203d 2061 5b31 5d0a 2020  lf.m21 = a[1].  
-0000a540: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
-0000a550: 3232 203d 2062 5b31 5d0a 2020 2020 2020  22 = b[1].      
-0000a560: 2020 2020 2020 7365 6c66 2e6d 3233 203d        self.m23 =
-0000a570: 2063 5b31 5d0a 2020 2020 2020 2020 2020   c[1].          
-0000a580: 2020 7365 6c66 2e6d 3331 203d 2061 5b32    self.m31 = a[2
-0000a590: 5d0a 2020 2020 2020 2020 2020 2020 7365  ].            se
-0000a5a0: 6c66 2e6d 3332 203d 2062 5b32 5d0a 2020  lf.m32 = b[2].  
-0000a5b0: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
-0000a5c0: 3333 203d 2063 5b32 5d0a 0a20 2020 2020  33 = c[2]..     
-0000a5d0: 2020 2023 2039 2061 7267 756d 656e 7473     # 9 arguments
-0000a5e0: 0a20 2020 2020 2020 2065 6c69 6620 6172  .        elif ar
-0000a5f0: 676c 656e 3d3d 393a 0a20 2020 2020 2020  glen==9:.       
-0000a600: 2020 2020 2073 656c 662e 6d31 3120 3d20       self.m11 = 
-0000a610: 6172 6773 5b30 5d0a 2020 2020 2020 2020  args[0].        
-0000a620: 2020 2020 7365 6c66 2e6d 3132 203d 2061      self.m12 = a
-0000a630: 7267 735b 315d 0a20 2020 2020 2020 2020  rgs[1].         
-0000a640: 2020 2073 656c 662e 6d31 3320 3d20 6172     self.m13 = ar
-0000a650: 6773 5b32 5d0a 2020 2020 2020 2020 2020  gs[2].          
-0000a660: 2020 7365 6c66 2e6d 3231 203d 2061 7267    self.m21 = arg
-0000a670: 735b 335d 0a20 2020 2020 2020 2020 2020  s[3].           
-0000a680: 2073 656c 662e 6d32 3220 3d20 6172 6773   self.m22 = args
-0000a690: 5b34 5d0a 2020 2020 2020 2020 2020 2020  [4].            
-0000a6a0: 7365 6c66 2e6d 3233 203d 2061 7267 735b  self.m23 = args[
-0000a6b0: 355d 0a20 2020 2020 2020 2020 2020 2073  5].            s
-0000a6c0: 656c 662e 6d33 3120 3d20 6172 6773 5b36  elf.m31 = args[6
-0000a6d0: 5d0a 2020 2020 2020 2020 2020 2020 7365  ].            se
-0000a6e0: 6c66 2e6d 3332 203d 2061 7267 735b 375d  lf.m32 = args[7]
-0000a6f0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0000a700: 662e 6d33 3320 3d20 6172 6773 5b38 5d0a  f.m33 = args[8].
-0000a710: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-0000a720: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-0000a730: 2054 7970 6545 7272 6f72 2c22 6d61 7433   TypeError,"mat3
-0000a740: 2829 2061 7267 2063 616e 2774 2062 6520  () arg can't be 
-0000a750: 636f 6e76 6572 7465 6420 746f 206d 6174  converted to mat
-0000a760: 3322 0a0a 2020 2020 6465 6620 5f5f 7265  3"..    def __re
-0000a770: 6475 6365 5f5f 2873 656c 6629 3a0a 2020  duce__(self):.  
-0000a780: 2020 2020 2020 7265 7475 726e 2028 5f6d        return (_m
-0000a790: 6174 3363 6f6e 7374 7275 6374 2c20 2873  at3construct, (s
-0000a7a0: 656c 665b 305d 2c20 7365 6c66 5b31 5d2c  elf[0], self[1],
-0000a7b0: 2073 656c 665b 325d 2929 0a0a 2020 2020   self[2]))..    
-0000a7c0: 6465 6620 5f5f 7265 7072 5f5f 2873 656c  def __repr__(sel
-0000a7d0: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
-0000a7e0: 726e 2027 6d61 7433 2825 732c 2025 732c  rn 'mat3(%s, %s,
-0000a7f0: 2025 732c 2025 732c 2025 732c 2025 732c   %s, %s, %s, %s,
-0000a800: 2025 732c 2025 732c 2025 7329 2725 280a   %s, %s, %s)'%(.
-0000a810: 2020 2020 2020 2020 2020 2020 7265 7072              repr
-0000a820: 2873 656c 662e 6d31 3129 2c72 6570 7228  (self.m11),repr(
-0000a830: 7365 6c66 2e6d 3132 292c 7265 7072 2873  self.m12),repr(s
-0000a840: 656c 662e 6d31 3329 2c0a 2020 2020 2020  elf.m13),.      
-0000a850: 2020 2020 2020 7265 7072 2873 656c 662e        repr(self.
-0000a860: 6d32 3129 2c72 6570 7228 7365 6c66 2e6d  m21),repr(self.m
-0000a870: 3232 292c 7265 7072 2873 656c 662e 6d32  22),repr(self.m2
-0000a880: 3329 2c0a 2020 2020 2020 2020 2020 2020  3),.            
-0000a890: 7265 7072 2873 656c 662e 6d33 3129 2c72  repr(self.m31),r
-0000a8a0: 6570 7228 7365 6c66 2e6d 3332 292c 7265  epr(self.m32),re
-0000a8b0: 7072 2873 656c 662e 6d33 3329 290a 0a20  pr(self.m33)).. 
-0000a8c0: 2020 2064 6566 205f 5f73 7472 5f5f 2873     def __str__(s
-0000a8d0: 656c 6629 3a0a 2020 2020 2020 2020 7265  elf):.        re
-0000a8e0: 7475 726e 2022 5b25 392e 3466 2c20 2539  turn "[%9.4f, %9
-0000a8f0: 2e34 662c 2025 392e 3466 5d5c 6e5b 2539  .4f, %9.4f]\n[%9
-0000a900: 2e34 662c 2025 392e 3466 2c20 2539 2e34  .4f, %9.4f, %9.4
-0000a910: 665d 5c6e 5b25 392e 3466 2c20 2539 2e34  f]\n[%9.4f, %9.4
-0000a920: 662c 2025 392e 3466 5d22 2528 0a20 2020  f, %9.4f]"%(.   
-0000a930: 2020 2020 2020 2020 2073 656c 662e 6d31           self.m1
-0000a940: 312c 2073 656c 662e 6d31 322c 2073 656c  1, self.m12, sel
-0000a950: 662e 6d31 332c 0a20 2020 2020 2020 2020  f.m13,.         
-0000a960: 2020 2073 656c 662e 6d32 312c 2073 656c     self.m21, sel
-0000a970: 662e 6d32 322c 2073 656c 662e 6d32 332c  f.m22, self.m23,
-0000a980: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0000a990: 662e 6d33 312c 2073 656c 662e 6d33 322c  f.m31, self.m32,
-0000a9a0: 2073 656c 662e 6d33 3329 0a0a 2020 2020   self.m33)..    
-0000a9b0: 6465 6620 5f5f 6974 6572 5f5f 2873 656c  def __iter__(sel
-0000a9c0: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
-0000a9d0: 726e 206d 6174 3369 7465 7228 7365 6c66  rn mat3iter(self
-0000a9e0: 290a 0a20 2020 2064 6566 205f 5f72 6963  )..    def __ric
-0000a9f0: 6863 6d70 5f5f 2861 2c62 2c6f 7029 3a0a  hcmp__(a,b,op):.
-0000aa00: 2020 2020 2020 2020 6364 6566 206d 6174          cdef mat
-0000aa10: 3320 6d61 2c20 6d62 0a20 2020 2020 2020  3 ma, mb.       
-0000aa20: 2063 6465 6620 696e 7420 636f 700a 0a20   cdef int cop.. 
-0000aa30: 2020 2020 2020 2063 6f70 203d 206f 700a         cop = op.
-0000aa40: 0a20 2020 2020 2020 2074 6120 3d20 7479  .        ta = ty
-0000aa50: 7065 2861 290a 2020 2020 2020 2020 7462  pe(a).        tb
-0000aa60: 203d 2074 7970 6528 6229 0a20 2020 2020   = type(b).     
-0000aa70: 2020 2069 6620 2874 6121 3d6d 6174 3320     if (ta!=mat3 
-0000aa80: 6f72 2074 6221 3d6d 6174 3329 3a0a 2020  or tb!=mat3):.  
-0000aa90: 2020 2020 2020 2020 2020 6966 2063 6f70            if cop
-0000aaa0: 3d3d 333a 0a20 2020 2020 2020 2020 2020  ==3:.           
-0000aab0: 2020 2020 2072 6574 7572 6e20 310a 2020       return 1.  
-0000aac0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-0000aad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000aae0: 7265 7475 726e 2030 0a0a 2020 2020 2020  return 0..      
-0000aaf0: 2020 6d61 203d 2061 0a20 2020 2020 2020    ma = a.       
-0000ab00: 206d 6220 3d20 620a 0a20 2020 2020 2020   mb = b..       
-0000ab10: 2023 203c 0a20 2020 2020 2020 2069 6620   # <.        if 
-0000ab20: 636f 703d 3d30 3a0a 2020 2020 2020 2020  cop==0:.        
-0000ab30: 2020 2020 7265 7475 726e 2030 0a20 2020      return 0.   
-0000ab40: 2020 2020 2023 203c 3d0a 2020 2020 2020       # <=.      
-0000ab50: 2020 656c 6966 2063 6f70 3d3d 313a 0a20    elif cop==1:. 
-0000ab60: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0000ab70: 6e20 300a 2020 2020 2020 2020 2320 3d3d  n 0.        # ==
-0000ab80: 0a20 2020 2020 2020 2065 6c69 6620 636f  .        elif co
-0000ab90: 703d 3d32 3a0a 2020 2020 2020 2020 2020  p==2:.          
-0000aba0: 2020 7265 7475 726e 2028 6661 6273 286d    return (fabs(m
-0000abb0: 612e 6d31 312d 6d62 2e6d 3131 293c 3d65  a.m11-mb.m11)<=e
-0000abc0: 7073 2061 6e64 2066 6162 7328 6d61 2e6d  ps and fabs(ma.m
-0000abd0: 3132 2d6d 622e 6d31 3229 3c3d 6570 7320  12-mb.m12)<=eps 
-0000abe0: 616e 640a 2020 2020 2020 2020 2020 2020  and.            
-0000abf0: 2020 2020 2020 2020 6661 6273 286d 612e          fabs(ma.
-0000ac00: 6d31 332d 6d62 2e6d 3133 293c 3d65 7073  m13-mb.m13)<=eps
-0000ac10: 2061 6e64 0a20 2020 2020 2020 2020 2020   and.           
-0000ac20: 2020 2020 2020 2020 2066 6162 7328 6d61           fabs(ma
-0000ac30: 2e6d 3231 2d6d 622e 6d32 3129 3c3d 6570  .m21-mb.m21)<=ep
-0000ac40: 7320 616e 6420 6661 6273 286d 612e 6d32  s and fabs(ma.m2
-0000ac50: 322d 6d62 2e6d 3232 293c 3d65 7073 2061  2-mb.m22)<=eps a
-0000ac60: 6e64 0a20 2020 2020 2020 2020 2020 2020  nd.             
-0000ac70: 2020 2020 2020 2066 6162 7328 6d61 2e6d         fabs(ma.m
-0000ac80: 3233 2d6d 622e 6d32 3329 3c3d 6570 7320  23-mb.m23)<=eps 
-0000ac90: 616e 640a 2020 2020 2020 2020 2020 2020  and.            
-0000aca0: 2020 2020 2020 2020 6661 6273 286d 612e          fabs(ma.
-0000acb0: 6d33 312d 6d62 2e6d 3331 293c 3d65 7073  m31-mb.m31)<=eps
-0000acc0: 2061 6e64 2066 6162 7328 6d61 2e6d 3332   and fabs(ma.m32
-0000acd0: 2d6d 622e 6d33 3229 3c3d 6570 7320 616e  -mb.m32)<=eps an
-0000ace0: 640a 2020 2020 2020 2020 2020 2020 2020  d.              
-0000acf0: 2020 2020 2020 6661 6273 286d 612e 6d33        fabs(ma.m3
-0000ad00: 332d 6d62 2e6d 3333 293c 3d65 7073 290a  3-mb.m33)<=eps).
-0000ad10: 2020 2020 2020 2020 2320 213d 0a20 2020          # !=.   
-0000ad20: 2020 2020 2065 6c69 6620 636f 703d 3d33       elif cop==3
-0000ad30: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-0000ad40: 7475 726e 2028 6661 6273 286d 612e 6d31  turn (fabs(ma.m1
-0000ad50: 312d 6d62 2e6d 3131 293e 6570 7320 6f72  1-mb.m11)>eps or
-0000ad60: 2066 6162 7328 6d61 2e6d 3132 2d6d 622e   fabs(ma.m12-mb.
-0000ad70: 6d31 3229 3e65 7073 206f 720a 2020 2020  m12)>eps or.    
-0000ad80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ad90: 6661 6273 286d 612e 6d31 332d 6d62 2e6d  fabs(ma.m13-mb.m
-0000ada0: 3133 293e 6570 7320 6f72 0a20 2020 2020  13)>eps or.     
-0000adb0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0000adc0: 6162 7328 6d61 2e6d 3231 2d6d 622e 6d32  abs(ma.m21-mb.m2
-0000add0: 3129 3e65 7073 206f 7220 6661 6273 286d  1)>eps or fabs(m
-0000ade0: 612e 6d32 322d 6d62 2e6d 3232 293e 6570  a.m22-mb.m22)>ep
-0000adf0: 7320 6f72 0a20 2020 2020 2020 2020 2020  s or.           
-0000ae00: 2020 2020 2020 2020 2066 6162 7328 6d61           fabs(ma
-0000ae10: 2e6d 3233 2d6d 622e 6d32 3329 3e65 7073  .m23-mb.m23)>eps
-0000ae20: 206f 720a 2020 2020 2020 2020 2020 2020   or.            
-0000ae30: 2020 2020 2020 2020 6661 6273 286d 612e          fabs(ma.
-0000ae40: 6d33 312d 6d62 2e6d 3331 293e 6570 7320  m31-mb.m31)>eps 
-0000ae50: 6f72 2066 6162 7328 6d61 2e6d 3332 2d6d  or fabs(ma.m32-m
-0000ae60: 622e 6d33 3229 3e65 7073 206f 720a 2020  b.m32)>eps or.  
-0000ae70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ae80: 2020 6661 6273 286d 612e 6d33 332d 6d62    fabs(ma.m33-mb
-0000ae90: 2e6d 3333 293e 6570 7329 0a20 2020 2020  .m33)>eps).     
-0000aea0: 2020 2023 203e 0a20 2020 2020 2020 2065     # >.        e
-0000aeb0: 6c69 6620 636f 703d 3d34 3a0a 2020 2020  lif cop==4:.    
-0000aec0: 2020 2020 2020 2020 7265 7475 726e 2030          return 0
-0000aed0: 0a20 2020 2020 2020 2023 203e 3d0a 2020  .        # >=.  
-0000aee0: 2020 2020 2020 656c 6966 2063 6f70 3d3d        elif cop==
-0000aef0: 353a 0a20 2020 2020 2020 2020 2020 2072  5:.            r
-0000af00: 6574 7572 6e20 300a 2020 2020 2020 2020  eturn 0.        
-0000af10: 2320 736f 6e73 7420 2846 6568 6c65 7229  # sonst (Fehler)
-0000af20: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-0000af30: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-0000af40: 2056 616c 7565 4572 726f 722c 2269 6e74   ValueError,"int
-0000af50: 6572 6e61 6c20 6572 726f 723a 2069 6c6c  ernal error: ill
-0000af60: 6567 616c 2072 6963 6820 636f 6d70 6172  egal rich compar
-0000af70: 6973 6f6e 206e 756d 6265 7222 0a0a 0a20  ison number"... 
-0000af80: 2020 2064 6566 205f 5f61 6464 5f5f 286d     def __add__(m
-0000af90: 6174 3320 612c 206d 6174 3320 6229 3a0a  at3 a, mat3 b):.
-0000afa0: 2020 2020 2020 2020 2222 224d 6174 7269          """Matri
-0000afb0: 7820 6164 6469 7469 6f6e 2e0a 2020 2020  x addition..    
-0000afc0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0000afd0: 6364 6566 206d 6174 3320 7265 730a 2020  cdef mat3 res.  
-0000afe0: 2020 2020 2020 7265 7320 3d20 6d61 7433        res = mat3
-0000aff0: 2829 0a20 2020 2020 2020 2072 6573 2e6d  ().        res.m
-0000b000: 3131 203d 2061 2e6d 3131 202b 2062 2e6d  11 = a.m11 + b.m
-0000b010: 3131 0a20 2020 2020 2020 2072 6573 2e6d  11.        res.m
-0000b020: 3132 203d 2061 2e6d 3132 202b 2062 2e6d  12 = a.m12 + b.m
-0000b030: 3132 0a20 2020 2020 2020 2072 6573 2e6d  12.        res.m
-0000b040: 3133 203d 2061 2e6d 3133 202b 2062 2e6d  13 = a.m13 + b.m
-0000b050: 3133 0a20 2020 2020 2020 2072 6573 2e6d  13.        res.m
-0000b060: 3231 203d 2061 2e6d 3231 202b 2062 2e6d  21 = a.m21 + b.m
-0000b070: 3231 0a20 2020 2020 2020 2072 6573 2e6d  21.        res.m
-0000b080: 3232 203d 2061 2e6d 3232 202b 2062 2e6d  22 = a.m22 + b.m
-0000b090: 3232 0a20 2020 2020 2020 2072 6573 2e6d  22.        res.m
-0000b0a0: 3233 203d 2061 2e6d 3233 202b 2062 2e6d  23 = a.m23 + b.m
-0000b0b0: 3233 0a20 2020 2020 2020 2072 6573 2e6d  23.        res.m
-0000b0c0: 3331 203d 2061 2e6d 3331 202b 2062 2e6d  31 = a.m31 + b.m
-0000b0d0: 3331 0a20 2020 2020 2020 2072 6573 2e6d  31.        res.m
-0000b0e0: 3332 203d 2061 2e6d 3332 202b 2062 2e6d  32 = a.m32 + b.m
-0000b0f0: 3332 0a20 2020 2020 2020 2072 6573 2e6d  32.        res.m
-0000b100: 3333 203d 2061 2e6d 3333 202b 2062 2e6d  33 = a.m33 + b.m
-0000b110: 3333 0a20 2020 2020 2020 2072 6574 7572  33.        retur
-0000b120: 6e20 7265 730a 0a20 2020 2064 6566 205f  n res..    def _
-0000b130: 5f73 7562 5f5f 286d 6174 3320 612c 206d  _sub__(mat3 a, m
-0000b140: 6174 3320 6229 3a0a 2020 2020 2020 2020  at3 b):.        
-0000b150: 2222 224d 6174 7269 7820 7375 6274 7261  """Matrix subtra
-0000b160: 6374 696f 6e2e 0a20 2020 2020 2020 2022  ction..        "
-0000b170: 2222 0a20 2020 2020 2020 2063 6465 6620  "".        cdef 
-0000b180: 6d61 7433 2072 6573 0a20 2020 2020 2020  mat3 res.       
-0000b190: 2072 6573 203d 206d 6174 3328 290a 2020   res = mat3().  
-0000b1a0: 2020 2020 2020 7265 732e 6d31 3120 3d20        res.m11 = 
-0000b1b0: 612e 6d31 3120 2d20 622e 6d31 310a 2020  a.m11 - b.m11.  
-0000b1c0: 2020 2020 2020 7265 732e 6d31 3220 3d20        res.m12 = 
-0000b1d0: 612e 6d31 3220 2d20 622e 6d31 320a 2020  a.m12 - b.m12.  
-0000b1e0: 2020 2020 2020 7265 732e 6d31 3320 3d20        res.m13 = 
-0000b1f0: 612e 6d31 3320 2d20 622e 6d31 330a 2020  a.m13 - b.m13.  
-0000b200: 2020 2020 2020 7265 732e 6d32 3120 3d20        res.m21 = 
-0000b210: 612e 6d32 3120 2d20 622e 6d32 310a 2020  a.m21 - b.m21.  
-0000b220: 2020 2020 2020 7265 732e 6d32 3220 3d20        res.m22 = 
-0000b230: 612e 6d32 3220 2d20 622e 6d32 320a 2020  a.m22 - b.m22.  
-0000b240: 2020 2020 2020 7265 732e 6d32 3320 3d20        res.m23 = 
-0000b250: 612e 6d32 3320 2d20 622e 6d32 330a 2020  a.m23 - b.m23.  
-0000b260: 2020 2020 2020 7265 732e 6d33 3120 3d20        res.m31 = 
-0000b270: 612e 6d33 3120 2d20 622e 6d33 310a 2020  a.m31 - b.m31.  
-0000b280: 2020 2020 2020 7265 732e 6d33 3220 3d20        res.m32 = 
-0000b290: 612e 6d33 3220 2d20 622e 6d33 320a 2020  a.m32 - b.m32.  
-0000b2a0: 2020 2020 2020 7265 732e 6d33 3320 3d20        res.m33 = 
-0000b2b0: 612e 6d33 3320 2d20 622e 6d33 330a 2020  a.m33 - b.m33.  
-0000b2c0: 2020 2020 2020 7265 7475 726e 2072 6573        return res
-0000b2d0: 0a0a 2020 2020 6465 6620 5f5f 6d75 6c5f  ..    def __mul_
-0000b2e0: 5f28 612c 2062 293a 0a20 2020 2020 2020  _(a, b):.       
-0000b2f0: 2022 2222 4d75 6c74 6970 6c69 6361 7469   """Multiplicati
-0000b300: 6f6e 2e0a 2020 2020 2020 2020 2222 220a  on..        """.
-0000b310: 2020 2020 2020 2020 6364 6566 206d 6174          cdef mat
-0000b320: 3320 6d61 2c20 6d62 2c20 7265 730a 2020  3 ma, mb, res.  
-0000b330: 2020 2020 2020 6364 6566 2076 6563 3320        cdef vec3 
-0000b340: 7661 2c20 7662 2c20 7672 6573 0a20 2020  va, vb, vres.   
-0000b350: 2020 2020 2063 6465 6620 646f 7562 6c65       cdef double
-0000b360: 2072 0a0a 2020 2020 2020 2020 7461 203d   r..        ta =
-0000b370: 2074 7970 6528 6129 0a20 2020 2020 2020   type(a).       
-0000b380: 2074 6220 3d20 7479 7065 2862 290a 0a20   tb = type(b).. 
-0000b390: 2020 2020 2020 2023 206d 6174 3320 6f6e         # mat3 on
-0000b3a0: 2074 6865 206c 6566 743f 0a20 2020 2020   the left?.     
-0000b3b0: 2020 2069 6620 7461 2069 7320 6d61 7433     if ta is mat3
-0000b3c0: 3a0a 2020 2020 2020 2020 2020 2020 6d61  :.            ma
-0000b3d0: 203d 2061 0a20 2020 2020 2020 2020 2020   = a.           
-0000b3e0: 2023 206d 6174 3320 6f6e 2074 6865 2072   # mat3 on the r
-0000b3f0: 6967 6874 3f0a 2020 2020 2020 2020 2020  ight?.          
-0000b400: 2020 6966 2074 6220 6973 206d 6174 333a    if tb is mat3:
-0000b410: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000b420: 2023 206d 6174 332a 6d61 7433 0a20 2020   # mat3*mat3.   
-0000b430: 2020 2020 2020 2020 2020 2020 2072 6573               res
-0000b440: 203d 206d 6174 3328 290a 2020 2020 2020   = mat3().      
-0000b450: 2020 2020 2020 2020 2020 6d62 203d 2062            mb = b
-0000b460: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000b470: 2072 6573 2e6d 3131 203d 206d 612e 6d31   res.m11 = ma.m1
-0000b480: 312a 6d62 2e6d 3131 2b6d 612e 6d31 322a  1*mb.m11+ma.m12*
-0000b490: 6d62 2e6d 3231 2b6d 612e 6d31 332a 6d62  mb.m21+ma.m13*mb
-0000b4a0: 2e6d 3331 0a20 2020 2020 2020 2020 2020  .m31.           
-0000b4b0: 2020 2020 2072 6573 2e6d 3132 203d 206d       res.m12 = m
-0000b4c0: 612e 6d31 312a 6d62 2e6d 3132 2b6d 612e  a.m11*mb.m12+ma.
-0000b4d0: 6d31 322a 6d62 2e6d 3232 2b6d 612e 6d31  m12*mb.m22+ma.m1
-0000b4e0: 332a 6d62 2e6d 3332 0a20 2020 2020 2020  3*mb.m32.       
-0000b4f0: 2020 2020 2020 2020 2072 6573 2e6d 3133           res.m13
-0000b500: 203d 206d 612e 6d31 312a 6d62 2e6d 3133   = ma.m11*mb.m13
-0000b510: 2b6d 612e 6d31 322a 6d62 2e6d 3233 2b6d  +ma.m12*mb.m23+m
-0000b520: 612e 6d31 332a 6d62 2e6d 3333 0a20 2020  a.m13*mb.m33.   
-0000b530: 2020 2020 2020 2020 2020 2020 2072 6573               res
-0000b540: 2e6d 3231 203d 206d 612e 6d32 312a 6d62  .m21 = ma.m21*mb
-0000b550: 2e6d 3131 2b6d 612e 6d32 322a 6d62 2e6d  .m11+ma.m22*mb.m
-0000b560: 3231 2b6d 612e 6d32 332a 6d62 2e6d 3331  21+ma.m23*mb.m31
-0000b570: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000b580: 2072 6573 2e6d 3232 203d 206d 612e 6d32   res.m22 = ma.m2
-0000b590: 312a 6d62 2e6d 3132 2b6d 612e 6d32 322a  1*mb.m12+ma.m22*
-0000b5a0: 6d62 2e6d 3232 2b6d 612e 6d32 332a 6d62  mb.m22+ma.m23*mb
-0000b5b0: 2e6d 3332 0a20 2020 2020 2020 2020 2020  .m32.           
-0000b5c0: 2020 2020 2072 6573 2e6d 3233 203d 206d       res.m23 = m
-0000b5d0: 612e 6d32 312a 6d62 2e6d 3133 2b6d 612e  a.m21*mb.m13+ma.
-0000b5e0: 6d32 322a 6d62 2e6d 3233 2b6d 612e 6d32  m22*mb.m23+ma.m2
-0000b5f0: 332a 6d62 2e6d 3333 0a20 2020 2020 2020  3*mb.m33.       
-0000b600: 2020 2020 2020 2020 2072 6573 2e6d 3331           res.m31
-0000b610: 203d 206d 612e 6d33 312a 6d62 2e6d 3131   = ma.m31*mb.m11
-0000b620: 2b6d 612e 6d33 322a 6d62 2e6d 3231 2b6d  +ma.m32*mb.m21+m
-0000b630: 612e 6d33 332a 6d62 2e6d 3331 0a20 2020  a.m33*mb.m31.   
-0000b640: 2020 2020 2020 2020 2020 2020 2072 6573               res
-0000b650: 2e6d 3332 203d 206d 612e 6d33 312a 6d62  .m32 = ma.m31*mb
-0000b660: 2e6d 3132 2b6d 612e 6d33 322a 6d62 2e6d  .m12+ma.m32*mb.m
-0000b670: 3232 2b6d 612e 6d33 332a 6d62 2e6d 3332  22+ma.m33*mb.m32
-0000b680: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000b690: 2072 6573 2e6d 3333 203d 206d 612e 6d33   res.m33 = ma.m3
-0000b6a0: 312a 6d62 2e6d 3133 2b6d 612e 6d33 322a  1*mb.m13+ma.m32*
-0000b6b0: 6d62 2e6d 3233 2b6d 612e 6d33 332a 6d62  mb.m23+ma.m33*mb
-0000b6c0: 2e6d 3333 0a20 2020 2020 2020 2020 2020  .m33.           
-0000b6d0: 2020 2020 2072 6574 7572 6e20 7265 730a       return res.
-0000b6e0: 2020 2020 2020 2020 2020 2020 2320 7665              # ve
-0000b6f0: 6333 206f 6e20 7468 6520 7269 6768 743f  c3 on the right?
-0000b700: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
-0000b710: 6620 7462 2069 7320 7665 6333 3a0a 2020  f tb is vec3:.  
-0000b720: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-0000b730: 6d61 7433 2a76 6563 330a 2020 2020 2020  mat3*vec3.      
-0000b740: 2020 2020 2020 2020 2020 7772 6573 203d            wres =
-0000b750: 2076 6563 3328 290a 2020 2020 2020 2020   vec3().        
-0000b760: 2020 2020 2020 2020 7762 2020 203d 2062          wb   = b
-0000b770: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000b780: 2077 7265 732e 7820 3d20 6d61 2e6d 3131   wres.x = ma.m11
-0000b790: 2a77 622e 7820 2b20 6d61 2e6d 3132 2a77  *wb.x + ma.m12*w
-0000b7a0: 622e 7920 2b20 6d61 2e6d 3133 2a77 622e  b.y + ma.m13*wb.
-0000b7b0: 7a0a 2020 2020 2020 2020 2020 2020 2020  z.              
-0000b7c0: 2020 7772 6573 2e79 203d 206d 612e 6d32    wres.y = ma.m2
-0000b7d0: 312a 7762 2e78 202b 206d 612e 6d32 322a  1*wb.x + ma.m22*
-0000b7e0: 7762 2e79 202b 206d 612e 6d32 332a 7762  wb.y + ma.m23*wb
-0000b7f0: 2e7a 0a20 2020 2020 2020 2020 2020 2020  .z.             
-0000b800: 2020 2077 7265 732e 7a20 3d20 6d61 2e6d     wres.z = ma.m
-0000b810: 3331 2a77 622e 7820 2b20 6d61 2e6d 3332  31*wb.x + ma.m32
-0000b820: 2a77 622e 7920 2b20 6d61 2e6d 3333 2a77  *wb.y + ma.m33*w
-0000b830: 622e 7a0a 2020 2020 2020 2020 2020 2020  b.z.            
-0000b840: 2020 2020 7265 7475 726e 2077 7265 730a      return wres.
-0000b850: 2020 2020 2020 2020 2020 2020 2320 5363              # Sc
-0000b860: 616c 6172 206f 6e20 7468 6520 7269 6768  alar on the righ
-0000b870: 743f 0a20 2020 2020 2020 2020 2020 2065  t?.            e
-0000b880: 6c69 6620 7462 2069 7320 666c 6f61 7420  lif tb is float 
-0000b890: 6f72 2074 6220 6973 2069 6e74 206f 7220  or tb is int or 
-0000b8a0: 7462 2069 7320 6c6f 6e67 3a0a 2020 2020  tb is long:.    
-0000b8b0: 2020 2020 2020 2020 2020 2020 7265 7320              res 
-0000b8c0: 3d20 6d61 7433 2829 0a20 2020 2020 2020  = mat3().       
-0000b8d0: 2020 2020 2020 2020 2072 203d 2062 0a20           r = b. 
-0000b8e0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0000b8f0: 6573 2e6d 3131 203d 206d 612e 6d31 312a  es.m11 = ma.m11*
-0000b900: 720a 2020 2020 2020 2020 2020 2020 2020  r.              
-0000b910: 2020 7265 732e 6d31 3220 3d20 6d61 2e6d    res.m12 = ma.m
-0000b920: 3132 2a72 0a20 2020 2020 2020 2020 2020  12*r.           
-0000b930: 2020 2020 2072 6573 2e6d 3133 203d 206d       res.m13 = m
-0000b940: 612e 6d31 332a 720a 2020 2020 2020 2020  a.m13*r.        
-0000b950: 2020 2020 2020 2020 7265 732e 6d32 3120          res.m21 
-0000b960: 3d20 6d61 2e6d 3231 2a72 0a20 2020 2020  = ma.m21*r.     
-0000b970: 2020 2020 2020 2020 2020 2072 6573 2e6d             res.m
-0000b980: 3232 203d 206d 612e 6d32 322a 720a 2020  22 = ma.m22*r.  
-0000b990: 2020 2020 2020 2020 2020 2020 2020 7265                re
-0000b9a0: 732e 6d32 3320 3d20 6d61 2e6d 3233 2a72  s.m23 = ma.m23*r
-0000b9b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000b9c0: 2072 6573 2e6d 3331 203d 206d 612e 6d33   res.m31 = ma.m3
-0000b9d0: 312a 720a 2020 2020 2020 2020 2020 2020  1*r.            
-0000b9e0: 2020 2020 7265 732e 6d33 3220 3d20 6d61      res.m32 = ma
-0000b9f0: 2e6d 3332 2a72 0a20 2020 2020 2020 2020  .m32*r.         
-0000ba00: 2020 2020 2020 2072 6573 2e6d 3333 203d         res.m33 =
-0000ba10: 206d 612e 6d33 332a 720a 2020 2020 2020   ma.m33*r.      
-0000ba20: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0000ba30: 2072 6573 0a0a 2020 2020 2020 2020 2320   res..        # 
-0000ba40: 7665 6333 206f 6e20 7468 6520 6c65 6674  vec3 on the left
-0000ba50: 3f20 2874 6865 6e20 7468 6572 6520 6d75  ? (then there mu
-0000ba60: 7374 2062 6520 6120 6d61 7433 206f 6e20  st be a mat3 on 
-0000ba70: 7468 6520 7269 6768 7429 0a20 2020 2020  the right).     
-0000ba80: 2020 2065 6c69 6620 7461 2069 7320 7665     elif ta is ve
-0000ba90: 6333 3a0a 2020 2020 2020 2020 2020 2020  c3:.            
-0000baa0: 2320 7665 6333 2a6d 6174 330a 2020 2020  # vec3*mat3.    
-0000bab0: 2020 2020 2020 2020 7772 6573 203d 2076          wres = v
-0000bac0: 6563 3328 290a 2020 2020 2020 2020 2020  ec3().          
-0000bad0: 2020 7761 2020 203d 2061 0a20 2020 2020    wa   = a.     
-0000bae0: 2020 2020 2020 206d 6220 2020 3d20 620a         mb   = b.
-0000baf0: 2020 2020 2020 2020 2020 2020 7772 6573              wres
-0000bb00: 2e78 203d 2077 612e 782a 6d62 2e6d 3131  .x = wa.x*mb.m11
-0000bb10: 202b 2077 612e 792a 6d62 2e6d 3231 202b   + wa.y*mb.m21 +
-0000bb20: 2077 612e 7a2a 6d62 2e6d 3331 0a20 2020   wa.z*mb.m31.   
-0000bb30: 2020 2020 2020 2020 2077 7265 732e 7920           wres.y 
-0000bb40: 3d20 7761 2e78 2a6d 622e 6d31 3220 2b20  = wa.x*mb.m12 + 
-0000bb50: 7761 2e79 2a6d 622e 6d32 3220 2b20 7761  wa.y*mb.m22 + wa
-0000bb60: 2e7a 2a6d 622e 6d33 320a 2020 2020 2020  .z*mb.m32.      
-0000bb70: 2020 2020 2020 7772 6573 2e7a 203d 2077        wres.z = w
-0000bb80: 612e 782a 6d62 2e6d 3133 202b 2077 612e  a.x*mb.m13 + wa.
-0000bb90: 792a 6d62 2e6d 3233 202b 2077 612e 7a2a  y*mb.m23 + wa.z*
-0000bba0: 6d62 2e6d 3333 0a20 2020 2020 2020 2020  mb.m33.         
-0000bbb0: 2020 2072 6574 7572 6e20 7772 6573 0a0a     return wres..
-0000bbc0: 2020 2020 2020 2020 2320 5363 616c 6172          # Scalar
-0000bbd0: 206f 6e20 7468 6520 6c65 6674 3f20 2874   on the left? (t
-0000bbe0: 6865 6e20 7468 6572 6520 6d75 7374 2062  hen there must b
-0000bbf0: 6520 6120 6d61 7433 206f 6e20 7468 6520  e a mat3 on the 
-0000bc00: 7269 6768 7429 0a20 2020 2020 2020 2065  right).        e
-0000bc10: 6c69 6620 7461 2069 7320 666c 6f61 7420  lif ta is float 
-0000bc20: 6f72 2074 6120 6973 2069 6e74 206f 7220  or ta is int or 
-0000bc30: 7461 2069 7320 6c6f 6e67 3a0a 2020 2020  ta is long:.    
-0000bc40: 2020 2020 2020 2020 7265 7320 3d20 6d61          res = ma
-0000bc50: 7433 2829 0a20 2020 2020 2020 2020 2020  t3().           
-0000bc60: 2072 2020 3d20 610a 2020 2020 2020 2020   r  = a.        
-0000bc70: 2020 2020 6d62 203d 2062 0a20 2020 2020      mb = b.     
-0000bc80: 2020 2020 2020 2072 6573 2e6d 3131 203d         res.m11 =
-0000bc90: 2072 2a6d 622e 6d31 310a 2020 2020 2020   r*mb.m11.      
-0000bca0: 2020 2020 2020 7265 732e 6d31 3220 3d20        res.m12 = 
-0000bcb0: 722a 6d62 2e6d 3132 0a20 2020 2020 2020  r*mb.m12.       
-0000bcc0: 2020 2020 2072 6573 2e6d 3133 203d 2072       res.m13 = r
-0000bcd0: 2a6d 622e 6d31 330a 2020 2020 2020 2020  *mb.m13.        
-0000bce0: 2020 2020 7265 732e 6d32 3120 3d20 722a      res.m21 = r*
-0000bcf0: 6d62 2e6d 3231 0a20 2020 2020 2020 2020  mb.m21.         
-0000bd00: 2020 2072 6573 2e6d 3232 203d 2072 2a6d     res.m22 = r*m
-0000bd10: 622e 6d32 320a 2020 2020 2020 2020 2020  b.m22.          
-0000bd20: 2020 7265 732e 6d32 3320 3d20 722a 6d62    res.m23 = r*mb
-0000bd30: 2e6d 3233 0a20 2020 2020 2020 2020 2020  .m23.           
-0000bd40: 2072 6573 2e6d 3331 203d 2072 2a6d 622e   res.m31 = r*mb.
-0000bd50: 6d33 310a 2020 2020 2020 2020 2020 2020  m31.            
-0000bd60: 7265 732e 6d33 3220 3d20 722a 6d62 2e6d  res.m32 = r*mb.m
-0000bd70: 3332 0a20 2020 2020 2020 2020 2020 2072  32.            r
-0000bd80: 6573 2e6d 3333 203d 2072 2a6d 622e 6d33  es.m33 = r*mb.m3
-0000bd90: 330a 2020 2020 2020 2020 2020 2020 7265  3.            re
-0000bda0: 7475 726e 2072 6573 0a0a 2020 2020 2020  turn res..      
-0000bdb0: 2020 2320 4e6f 2076 616c 6964 2063 6f6d    # No valid com
-0000bdc0: 6269 6e61 7469 6f6e 2066 6f75 6e64 0a20  bination found. 
-0000bdd0: 2020 2020 2020 2072 6169 7365 2054 7970         raise Typ
-0000bde0: 6545 7272 6f72 2c20 2275 6e73 7570 706f  eError, "unsuppo
-0000bdf0: 7274 6564 206f 7065 7261 6e64 2074 7970  rted operand typ
-0000be00: 6520 666f 7220 2a22 0a0a 2020 2020 6465  e for *"..    de
-0000be10: 6620 5f5f 6469 765f 5f28 6d61 7433 2061  f __div__(mat3 a
-0000be20: 2c20 6229 3a0a 2020 2020 2020 2020 2320  , b):.        # 
-0000be30: 5079 7468 6f6e 2032 0a20 2020 2020 2020  Python 2.       
-0000be40: 2072 6574 7572 6e20 6d61 7433 2e5f 5f74   return mat3.__t
-0000be50: 7275 6564 6976 5f5f 2861 2c62 290a 0a20  ruediv__(a,b).. 
-0000be60: 2020 2064 6566 205f 5f74 7275 6564 6976     def __truediv
-0000be70: 5f5f 286d 6174 3320 612c 2062 293a 0a20  __(mat3 a, b):. 
-0000be80: 2020 2020 2020 2022 2222 4469 7669 7369         """Divisi
-0000be90: 6f6e 2e0a 2020 2020 2020 2020 2222 220a  on..        """.
-0000bea0: 2020 2020 2020 2020 6364 6566 206d 6174          cdef mat
-0000beb0: 3320 7265 730a 2020 2020 2020 2020 6364  3 res.        cd
-0000bec0: 6566 2064 6f75 626c 6520 720a 0a20 2020  ef double r..   
-0000bed0: 2020 2020 2074 6220 3d20 7479 7065 2862       tb = type(b
-0000bee0: 290a 0a20 2020 2020 2020 2069 6620 7462  )..        if tb
-0000bef0: 2069 7320 666c 6f61 7420 6f72 2074 6220   is float or tb 
-0000bf00: 6973 2069 6e74 206f 7220 7462 2069 7320  is int or tb is 
-0000bf10: 6c6f 6e67 3a0a 2020 2020 2020 2020 2020  long:.          
-0000bf20: 2020 2320 6d61 7433 2f73 6361 6c61 720a    # mat3/scalar.
-0000bf30: 2020 2020 2020 2020 2020 2020 7265 7320              res 
-0000bf40: 3d20 6d61 7433 2829 0a20 2020 2020 2020  = mat3().       
-0000bf50: 2020 2020 2072 203d 2062 0a20 2020 2020       r = b.     
-0000bf60: 2020 2020 2020 2069 6620 6661 6273 2872         if fabs(r
-0000bf70: 293c 3d65 7073 3a0a 2020 2020 2020 2020  )<=eps:.        
-0000bf80: 2020 2020 2020 2020 7261 6973 6520 5a65          raise Ze
-0000bf90: 726f 4469 7669 7369 6f6e 4572 726f 722c  roDivisionError,
-0000bfa0: 226d 6174 3320 6469 7669 7369 6f6e 220a  "mat3 division".
-0000bfb0: 2020 2020 2020 2020 2020 2020 7265 732e              res.
-0000bfc0: 6d31 3120 3d20 612e 6d31 312f 720a 2020  m11 = a.m11/r.  
-0000bfd0: 2020 2020 2020 2020 2020 7265 732e 6d31            res.m1
-0000bfe0: 3220 3d20 612e 6d31 322f 720a 2020 2020  2 = a.m12/r.    
-0000bff0: 2020 2020 2020 2020 7265 732e 6d31 3320          res.m13 
-0000c000: 3d20 612e 6d31 332f 720a 2020 2020 2020  = a.m13/r.      
-0000c010: 2020 2020 2020 7265 732e 6d32 3120 3d20        res.m21 = 
-0000c020: 612e 6d32 312f 720a 2020 2020 2020 2020  a.m21/r.        
-0000c030: 2020 2020 7265 732e 6d32 3220 3d20 612e      res.m22 = a.
-0000c040: 6d32 322f 720a 2020 2020 2020 2020 2020  m22/r.          
-0000c050: 2020 7265 732e 6d32 3320 3d20 612e 6d32    res.m23 = a.m2
-0000c060: 332f 720a 2020 2020 2020 2020 2020 2020  3/r.            
-0000c070: 7265 732e 6d33 3120 3d20 612e 6d33 312f  res.m31 = a.m31/
-0000c080: 720a 2020 2020 2020 2020 2020 2020 7265  r.            re
-0000c090: 732e 6d33 3220 3d20 612e 6d33 322f 720a  s.m32 = a.m32/r.
-0000c0a0: 2020 2020 2020 2020 2020 2020 7265 732e              res.
-0000c0b0: 6d33 3320 3d20 612e 6d33 332f 720a 2020  m33 = a.m33/r.  
-0000c0c0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0000c0d0: 2072 6573 0a20 2020 2020 2020 2065 6c73   res.        els
-0000c0e0: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
-0000c0f0: 6169 7365 2054 7970 6545 7272 6f72 2c20  aise TypeError, 
-0000c100: 2275 6e73 7570 706f 7274 6564 206f 7065  "unsupported ope
-0000c110: 7261 6e64 2074 7970 6520 666f 7220 2f22  rand type for /"
-0000c120: 0a0a 2020 2020 6465 6620 5f5f 6d6f 645f  ..    def __mod_
-0000c130: 5f28 6d61 7433 2073 656c 662c 206f 7468  _(mat3 self, oth
-0000c140: 6572 293a 0a20 2020 2020 2020 2022 2222  er):.        """
-0000c150: 4d6f 6475 6c6f 2e0a 2020 2020 2020 2020  Modulo..        
-0000c160: 2222 220a 2020 2020 2020 2020 6364 6566  """.        cdef
-0000c170: 206d 6174 3320 6d62 2c20 7265 730a 0a20   mat3 mb, res.. 
-0000c180: 2020 2020 2020 2074 6220 3d20 7479 7065         tb = type
-0000c190: 286f 7468 6572 290a 0a20 2020 2020 2020  (other)..       
-0000c1a0: 2069 6620 7462 2069 7320 666c 6f61 7420   if tb is float 
-0000c1b0: 6f72 2074 6220 6973 2069 6e74 206f 7220  or tb is int or 
-0000c1c0: 7462 2069 7320 6c6f 6e67 3a0a 2020 2020  tb is long:.    
-0000c1d0: 2020 2020 2020 2020 7220 3d20 6f74 6865          r = othe
-0000c1e0: 720a 2020 2020 2020 2020 2020 2020 6966  r.            if
-0000c1f0: 2066 6162 7328 7229 3c3d 6570 733a 0a20   fabs(r)<=eps:. 
-0000c200: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0000c210: 6169 7365 205a 6572 6f44 6976 6973 696f  aise ZeroDivisio
-0000c220: 6e45 7272 6f72 2c22 6d61 7433 206d 6f64  nError,"mat3 mod
-0000c230: 756c 6f22 0a20 2020 2020 2020 2020 2020  ulo".           
-0000c240: 2072 6573 203d 206d 6174 3328 290a 2020   res = mat3().  
-0000c250: 2020 2020 2020 2020 2020 7265 732e 6d31            res.m1
-0000c260: 3120 3d20 5f66 6d6f 6428 7365 6c66 2e6d  1 = _fmod(self.m
-0000c270: 3131 2c20 7229 0a20 2020 2020 2020 2020  11, r).         
-0000c280: 2020 2072 6573 2e6d 3132 203d 205f 666d     res.m12 = _fm
-0000c290: 6f64 2873 656c 662e 6d31 322c 2072 290a  od(self.m12, r).
-0000c2a0: 2020 2020 2020 2020 2020 2020 7265 732e              res.
-0000c2b0: 6d31 3320 3d20 5f66 6d6f 6428 7365 6c66  m13 = _fmod(self
-0000c2c0: 2e6d 3133 2c20 7229 0a20 2020 2020 2020  .m13, r).       
-0000c2d0: 2020 2020 2072 6573 2e6d 3231 203d 205f       res.m21 = _
-0000c2e0: 666d 6f64 2873 656c 662e 6d32 312c 2072  fmod(self.m21, r
-0000c2f0: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
-0000c300: 732e 6d32 3220 3d20 5f66 6d6f 6428 7365  s.m22 = _fmod(se
-0000c310: 6c66 2e6d 3232 2c20 7229 0a20 2020 2020  lf.m22, r).     
-0000c320: 2020 2020 2020 2072 6573 2e6d 3233 203d         res.m23 =
-0000c330: 205f 666d 6f64 2873 656c 662e 6d32 332c   _fmod(self.m23,
-0000c340: 2072 290a 2020 2020 2020 2020 2020 2020   r).            
-0000c350: 7265 732e 6d33 3120 3d20 5f66 6d6f 6428  res.m31 = _fmod(
-0000c360: 7365 6c66 2e6d 3331 2c20 7229 0a20 2020  self.m31, r).   
-0000c370: 2020 2020 2020 2020 2072 6573 2e6d 3332           res.m32
-0000c380: 203d 205f 666d 6f64 2873 656c 662e 6d33   = _fmod(self.m3
-0000c390: 322c 2072 290a 2020 2020 2020 2020 2020  2, r).          
-0000c3a0: 2020 7265 732e 6d33 3320 3d20 5f66 6d6f    res.m33 = _fmo
-0000c3b0: 6428 7365 6c66 2e6d 3333 2c20 7229 0a20  d(self.m33, r). 
-0000c3c0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0000c3d0: 6e20 7265 730a 0a20 2020 2020 2020 2065  n res..        e
-0000c3e0: 6c69 6620 7462 2069 7320 6d61 7433 3a0a  lif tb is mat3:.
-0000c3f0: 2020 2020 2020 2020 2020 2020 6d62 203d              mb =
-0000c400: 206f 7468 6572 0a0a 2020 2020 2020 2020   other..        
-0000c410: 2020 2020 6966 2028 6661 6273 286d 622e      if (fabs(mb.
-0000c420: 6d31 3129 3c3d 6570 7320 6f72 2066 6162  m11)<=eps or fab
-0000c430: 7328 6d62 2e6d 3132 293c 3d65 7073 206f  s(mb.m12)<=eps o
-0000c440: 7220 6661 6273 286d 622e 6d31 3329 3c3d  r fabs(mb.m13)<=
-0000c450: 6570 7320 6f72 0a20 2020 2020 2020 2020  eps or.         
-0000c460: 2020 2020 2020 2066 6162 7328 6d62 2e6d         fabs(mb.m
-0000c470: 3231 293c 3d65 7073 206f 7220 6661 6273  21)<=eps or fabs
-0000c480: 286d 622e 6d32 3229 3c3d 6570 7320 6f72  (mb.m22)<=eps or
-0000c490: 2066 6162 7328 6d62 2e6d 3233 293c 3d65   fabs(mb.m23)<=e
-0000c4a0: 7073 206f 720a 2020 2020 2020 2020 2020  ps or.          
-0000c4b0: 2020 2020 2020 6661 6273 286d 622e 6d33        fabs(mb.m3
-0000c4c0: 3129 3c3d 6570 7320 6f72 2066 6162 7328  1)<=eps or fabs(
-0000c4d0: 6d62 2e6d 3332 293c 3d65 7073 206f 7220  mb.m32)<=eps or 
-0000c4e0: 6661 6273 286d 622e 6d33 3329 3c3d 6570  fabs(mb.m33)<=ep
-0000c4f0: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
-0000c500: 2020 2020 7261 6973 6520 5a65 726f 4469      raise ZeroDi
-0000c510: 7669 7369 6f6e 4572 726f 722c 226d 6174  visionError,"mat
-0000c520: 3320 6d6f 6475 6c6f 220a 0a20 2020 2020  3 modulo"..     
-0000c530: 2020 2020 2020 2072 6573 3d6d 6174 3328         res=mat3(
-0000c540: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
-0000c550: 732e 6d31 3120 3d20 5f66 6d6f 6428 7365  s.m11 = _fmod(se
-0000c560: 6c66 2e6d 3131 2c20 6d62 2e6d 3131 290a  lf.m11, mb.m11).
-0000c570: 2020 2020 2020 2020 2020 2020 7265 732e              res.
-0000c580: 6d31 3220 3d20 5f66 6d6f 6428 7365 6c66  m12 = _fmod(self
-0000c590: 2e6d 3132 2c20 6d62 2e6d 3132 290a 2020  .m12, mb.m12).  
-0000c5a0: 2020 2020 2020 2020 2020 7265 732e 6d31            res.m1
-0000c5b0: 3320 3d20 5f66 6d6f 6428 7365 6c66 2e6d  3 = _fmod(self.m
-0000c5c0: 3133 2c20 6d62 2e6d 3133 290a 2020 2020  13, mb.m13).    
-0000c5d0: 2020 2020 2020 2020 7265 732e 6d32 3120          res.m21 
-0000c5e0: 3d20 5f66 6d6f 6428 7365 6c66 2e6d 3231  = _fmod(self.m21
-0000c5f0: 2c20 6d62 2e6d 3231 290a 2020 2020 2020  , mb.m21).      
-0000c600: 2020 2020 2020 7265 732e 6d32 3220 3d20        res.m22 = 
-0000c610: 5f66 6d6f 6428 7365 6c66 2e6d 3232 2c20  _fmod(self.m22, 
-0000c620: 6d62 2e6d 3232 290a 2020 2020 2020 2020  mb.m22).        
-0000c630: 2020 2020 7265 732e 6d32 3320 3d20 5f66      res.m23 = _f
-0000c640: 6d6f 6428 7365 6c66 2e6d 3233 2c20 6d62  mod(self.m23, mb
-0000c650: 2e6d 3233 290a 2020 2020 2020 2020 2020  .m23).          
-0000c660: 2020 7265 732e 6d33 3120 3d20 5f66 6d6f    res.m31 = _fmo
-0000c670: 6428 7365 6c66 2e6d 3331 2c20 6d62 2e6d  d(self.m31, mb.m
-0000c680: 3331 290a 2020 2020 2020 2020 2020 2020  31).            
-0000c690: 7265 732e 6d33 3220 3d20 5f66 6d6f 6428  res.m32 = _fmod(
-0000c6a0: 7365 6c66 2e6d 3332 2c20 6d62 2e6d 3332  self.m32, mb.m32
-0000c6b0: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
-0000c6c0: 732e 6d33 3320 3d20 5f66 6d6f 6428 7365  s.m33 = _fmod(se
-0000c6d0: 6c66 2e6d 3333 2c20 6d62 2e6d 3333 290a  lf.m33, mb.m33).
-0000c6e0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0000c6f0: 726e 2072 6573 0a0a 2020 2020 2020 2020  rn res..        
-0000c700: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-0000c710: 2020 7261 6973 6520 5479 7065 4572 726f    raise TypeErro
-0000c720: 722c 2022 756e 7375 7070 6f72 7465 6420  r, "unsupported 
-0000c730: 6f70 6572 616e 6420 7479 7065 2066 6f72  operand type for
-0000c740: 2025 220a 0a0a 2020 2020 6465 6620 5f5f   %"...    def __
-0000c750: 6e65 675f 5f28 7365 6c66 293a 0a20 2020  neg__(self):.   
-0000c760: 2020 2020 2022 2222 4e65 6761 7469 6f6e       """Negation
-0000c770: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-0000c780: 2020 2020 2020 6364 6566 206d 6174 3320        cdef mat3 
-0000c790: 7265 730a 2020 2020 2020 2020 7265 7320  res.        res 
-0000c7a0: 3d20 6d61 7433 2829 0a20 2020 2020 2020  = mat3().       
-0000c7b0: 2072 6573 2e6d 3131 203d 202d 7365 6c66   res.m11 = -self
-0000c7c0: 2e6d 3131 0a20 2020 2020 2020 2072 6573  .m11.        res
-0000c7d0: 2e6d 3132 203d 202d 7365 6c66 2e6d 3132  .m12 = -self.m12
-0000c7e0: 0a20 2020 2020 2020 2072 6573 2e6d 3133  .        res.m13
-0000c7f0: 203d 202d 7365 6c66 2e6d 3133 0a20 2020   = -self.m13.   
-0000c800: 2020 2020 2072 6573 2e6d 3231 203d 202d       res.m21 = -
-0000c810: 7365 6c66 2e6d 3231 0a20 2020 2020 2020  self.m21.       
-0000c820: 2072 6573 2e6d 3232 203d 202d 7365 6c66   res.m22 = -self
-0000c830: 2e6d 3232 0a20 2020 2020 2020 2072 6573  .m22.        res
-0000c840: 2e6d 3233 203d 202d 7365 6c66 2e6d 3233  .m23 = -self.m23
-0000c850: 0a20 2020 2020 2020 2072 6573 2e6d 3331  .        res.m31
-0000c860: 203d 202d 7365 6c66 2e6d 3331 0a20 2020   = -self.m31.   
-0000c870: 2020 2020 2072 6573 2e6d 3332 203d 202d       res.m32 = -
-0000c880: 7365 6c66 2e6d 3332 0a20 2020 2020 2020  self.m32.       
-0000c890: 2072 6573 2e6d 3333 203d 202d 7365 6c66   res.m33 = -self
-0000c8a0: 2e6d 3333 0a20 2020 2020 2020 2072 6574  .m33.        ret
-0000c8b0: 7572 6e20 7265 730a 0a20 2020 2064 6566  urn res..    def
-0000c8c0: 205f 5f70 6f73 5f5f 2873 656c 6629 3a0a   __pos__(self):.
-0000c8d0: 2020 2020 2020 2020 6364 6566 206d 6174          cdef mat
-0000c8e0: 3320 7265 730a 2020 2020 2020 2020 7265  3 res.        re
-0000c8f0: 7320 3d20 6d61 7433 2829 0a20 2020 2020  s = mat3().     
-0000c900: 2020 2072 6573 2e6d 3131 203d 2073 656c     res.m11 = sel
-0000c910: 662e 6d31 310a 2020 2020 2020 2020 7265  f.m11.        re
-0000c920: 732e 6d31 3220 3d20 7365 6c66 2e6d 3132  s.m12 = self.m12
-0000c930: 0a20 2020 2020 2020 2072 6573 2e6d 3133  .        res.m13
-0000c940: 203d 2073 656c 662e 6d31 330a 2020 2020   = self.m13.    
-0000c950: 2020 2020 7265 732e 6d32 3120 3d20 7365      res.m21 = se
-0000c960: 6c66 2e6d 3231 0a20 2020 2020 2020 2072  lf.m21.        r
-0000c970: 6573 2e6d 3232 203d 2073 656c 662e 6d32  es.m22 = self.m2
-0000c980: 320a 2020 2020 2020 2020 7265 732e 6d32  2.        res.m2
-0000c990: 3320 3d20 7365 6c66 2e6d 3233 0a20 2020  3 = self.m23.   
-0000c9a0: 2020 2020 2072 6573 2e6d 3331 203d 2073       res.m31 = s
-0000c9b0: 656c 662e 6d33 310a 2020 2020 2020 2020  elf.m31.        
-0000c9c0: 7265 732e 6d33 3220 3d20 7365 6c66 2e6d  res.m32 = self.m
-0000c9d0: 3332 0a20 2020 2020 2020 2072 6573 2e6d  32.        res.m
-0000c9e0: 3333 203d 2073 656c 662e 6d33 330a 2020  33 = self.m33.  
-0000c9f0: 2020 2020 2020 7265 7475 726e 2072 6573        return res
-0000ca00: 0a0a 2020 2020 6465 6620 5f5f 6961 6464  ..    def __iadd
-0000ca10: 5f5f 2873 656c 662c 206d 6174 3320 6f74  __(self, mat3 ot
-0000ca20: 6865 7229 3a0a 2020 2020 2020 2020 2222  her):.        ""
-0000ca30: 2249 6e6c 696e 6520 6d61 7472 6978 2061  "Inline matrix a
-0000ca40: 6464 6974 696f 6e2e 0a20 2020 2020 2020  ddition..       
-0000ca50: 2022 2222 0a20 2020 2020 2020 2073 656c   """.        sel
-0000ca60: 662e 6d31 3120 3d20 7365 6c66 2e6d 3131  f.m11 = self.m11
-0000ca70: 202b 206f 7468 6572 2e6d 3131 0a20 2020   + other.m11.   
-0000ca80: 2020 2020 2073 656c 662e 6d31 3220 3d20       self.m12 = 
-0000ca90: 7365 6c66 2e6d 3132 202b 206f 7468 6572  self.m12 + other
-0000caa0: 2e6d 3132 0a20 2020 2020 2020 2073 656c  .m12.        sel
-0000cab0: 662e 6d31 3320 3d20 7365 6c66 2e6d 3133  f.m13 = self.m13
-0000cac0: 202b 206f 7468 6572 2e6d 3133 0a20 2020   + other.m13.   
-0000cad0: 2020 2020 2073 656c 662e 6d32 3120 3d20       self.m21 = 
-0000cae0: 7365 6c66 2e6d 3231 202b 206f 7468 6572  self.m21 + other
-0000caf0: 2e6d 3231 0a20 2020 2020 2020 2073 656c  .m21.        sel
-0000cb00: 662e 6d32 3220 3d20 7365 6c66 2e6d 3232  f.m22 = self.m22
-0000cb10: 202b 206f 7468 6572 2e6d 3232 0a20 2020   + other.m22.   
-0000cb20: 2020 2020 2073 656c 662e 6d32 3320 3d20       self.m23 = 
-0000cb30: 7365 6c66 2e6d 3233 202b 206f 7468 6572  self.m23 + other
-0000cb40: 2e6d 3233 0a20 2020 2020 2020 2073 656c  .m23.        sel
-0000cb50: 662e 6d33 3120 3d20 7365 6c66 2e6d 3331  f.m31 = self.m31
-0000cb60: 202b 206f 7468 6572 2e6d 3331 0a20 2020   + other.m31.   
-0000cb70: 2020 2020 2073 656c 662e 6d33 3220 3d20       self.m32 = 
-0000cb80: 7365 6c66 2e6d 3332 202b 206f 7468 6572  self.m32 + other
-0000cb90: 2e6d 3332 0a20 2020 2020 2020 2073 656c  .m32.        sel
-0000cba0: 662e 6d33 3320 3d20 7365 6c66 2e6d 3333  f.m33 = self.m33
-0000cbb0: 202b 206f 7468 6572 2e6d 3333 0a20 2020   + other.m33.   
-0000cbc0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-0000cbd0: 0a0a 2020 2020 6465 6620 5f5f 6973 7562  ..    def __isub
-0000cbe0: 5f5f 2873 656c 662c 206d 6174 3320 6f74  __(self, mat3 ot
-0000cbf0: 6865 7229 3a0a 2020 2020 2020 2020 2222  her):.        ""
-0000cc00: 2249 6e6c 696e 6520 6d61 7472 6978 2073  "Inline matrix s
-0000cc10: 7562 7472 6163 7469 6f6e 2e0a 2020 2020  ubtraction..    
-0000cc20: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0000cc30: 7365 6c66 2e6d 3131 203d 2073 656c 662e  self.m11 = self.
-0000cc40: 6d31 3120 2d20 6f74 6865 722e 6d31 310a  m11 - other.m11.
-0000cc50: 2020 2020 2020 2020 7365 6c66 2e6d 3132          self.m12
-0000cc60: 203d 2073 656c 662e 6d31 3220 2d20 6f74   = self.m12 - ot
-0000cc70: 6865 722e 6d31 320a 2020 2020 2020 2020  her.m12.        
-0000cc80: 7365 6c66 2e6d 3133 203d 2073 656c 662e  self.m13 = self.
-0000cc90: 6d31 3320 2d20 6f74 6865 722e 6d31 330a  m13 - other.m13.
-0000cca0: 2020 2020 2020 2020 7365 6c66 2e6d 3231          self.m21
-0000ccb0: 203d 2073 656c 662e 6d32 3120 2d20 6f74   = self.m21 - ot
-0000ccc0: 6865 722e 6d32 310a 2020 2020 2020 2020  her.m21.        
-0000ccd0: 7365 6c66 2e6d 3232 203d 2073 656c 662e  self.m22 = self.
-0000cce0: 6d32 3220 2d20 6f74 6865 722e 6d32 320a  m22 - other.m22.
-0000ccf0: 2020 2020 2020 2020 7365 6c66 2e6d 3233          self.m23
-0000cd00: 203d 2073 656c 662e 6d32 3320 2d20 6f74   = self.m23 - ot
-0000cd10: 6865 722e 6d32 330a 2020 2020 2020 2020  her.m23.        
-0000cd20: 7365 6c66 2e6d 3331 203d 2073 656c 662e  self.m31 = self.
-0000cd30: 6d33 3120 2d20 6f74 6865 722e 6d33 310a  m31 - other.m31.
-0000cd40: 2020 2020 2020 2020 7365 6c66 2e6d 3332          self.m32
-0000cd50: 203d 2073 656c 662e 6d33 3220 2d20 6f74   = self.m32 - ot
-0000cd60: 6865 722e 6d33 320a 2020 2020 2020 2020  her.m32.        
-0000cd70: 7365 6c66 2e6d 3333 203d 2073 656c 662e  self.m33 = self.
-0000cd80: 6d33 3320 2d20 6f74 6865 722e 6d33 330a  m33 - other.m33.
-0000cd90: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0000cda0: 656c 660a 0a20 2020 2064 6566 205f 5f69  elf..    def __i
-0000cdb0: 6d75 6c5f 5f28 7365 6c66 2c20 6f74 6865  mul__(self, othe
-0000cdc0: 7229 3a0a 2020 2020 2020 2020 2222 2249  r):.        """I
-0000cdd0: 6e6c 696e 6520 6d75 6c74 6970 6c69 6361  nline multiplica
-0000cde0: 7469 6f6e 2028 7363 616c 6172 206f 7220  tion (scalar or 
-0000cdf0: 6d61 7472 6978 292e 0a20 2020 2020 2020  matrix)..       
-0000ce00: 2022 2222 0a20 2020 2020 2020 2063 6465   """.        cde
-0000ce10: 6620 646f 7562 6c65 2072 2c20 612c 622c  f double r, a,b,
-0000ce20: 630a 2020 2020 2020 2020 6364 6566 206d  c.        cdef m
-0000ce30: 6174 3320 6d62 0a0a 2020 2020 2020 2020  at3 mb..        
-0000ce40: 7462 203d 2074 7970 6528 6f74 6865 7229  tb = type(other)
-0000ce50: 0a20 2020 2020 2020 2069 6620 7462 2069  .        if tb i
-0000ce60: 7320 666c 6f61 7420 6f72 2074 6220 6973  s float or tb is
-0000ce70: 2069 6e74 206f 7220 7462 2069 7320 6c6f   int or tb is lo
-0000ce80: 6e67 3a0a 2020 2020 2020 2020 2020 2020  ng:.            
-0000ce90: 723d 6f74 6865 720a 2020 2020 2020 2020  r=other.        
-0000cea0: 2020 2020 7365 6c66 2e6d 3131 203d 2073      self.m11 = s
-0000ceb0: 656c 662e 6d31 312a 720a 2020 2020 2020  elf.m11*r.      
-0000cec0: 2020 2020 2020 7365 6c66 2e6d 3132 203d        self.m12 =
-0000ced0: 2073 656c 662e 6d31 322a 720a 2020 2020   self.m12*r.    
-0000cee0: 2020 2020 2020 2020 7365 6c66 2e6d 3133          self.m13
-0000cef0: 203d 2073 656c 662e 6d31 332a 720a 2020   = self.m13*r.  
-0000cf00: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
-0000cf10: 3231 203d 2073 656c 662e 6d32 312a 720a  21 = self.m21*r.
-0000cf20: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0000cf30: 2e6d 3232 203d 2073 656c 662e 6d32 322a  .m22 = self.m22*
-0000cf40: 720a 2020 2020 2020 2020 2020 2020 7365  r.            se
-0000cf50: 6c66 2e6d 3233 203d 2073 656c 662e 6d32  lf.m23 = self.m2
-0000cf60: 332a 720a 2020 2020 2020 2020 2020 2020  3*r.            
-0000cf70: 7365 6c66 2e6d 3331 203d 2073 656c 662e  self.m31 = self.
-0000cf80: 6d33 312a 720a 2020 2020 2020 2020 2020  m31*r.          
-0000cf90: 2020 7365 6c66 2e6d 3332 203d 2073 656c    self.m32 = sel
-0000cfa0: 662e 6d33 322a 720a 2020 2020 2020 2020  f.m32*r.        
-0000cfb0: 2020 2020 7365 6c66 2e6d 3333 203d 2073      self.m33 = s
-0000cfc0: 656c 662e 6d33 332a 720a 2020 2020 2020  elf.m33*r.      
-0000cfd0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-0000cfe0: 660a 2020 2020 2020 2020 656c 6966 2074  f.        elif t
-0000cff0: 6220 6973 206d 6174 333a 0a20 2020 2020  b is mat3:.     
-0000d000: 2020 2020 2020 206d 6220 3d20 6f74 6865         mb = othe
-0000d010: 720a 2020 2020 2020 2020 2020 2020 6120  r.            a 
-0000d020: 3d20 7365 6c66 2e6d 3131 0a20 2020 2020  = self.m11.     
-0000d030: 2020 2020 2020 2062 203d 2073 656c 662e         b = self.
-0000d040: 6d31 320a 2020 2020 2020 2020 2020 2020  m12.            
-0000d050: 6320 3d20 7365 6c66 2e6d 3133 0a20 2020  c = self.m13.   
-0000d060: 2020 2020 2020 2020 2073 656c 662e 6d31           self.m1
-0000d070: 3120 3d20 612a 6d62 2e6d 3131 2b62 2a6d  1 = a*mb.m11+b*m
-0000d080: 622e 6d32 312b 632a 6d62 2e6d 3331 0a20  b.m21+c*mb.m31. 
-0000d090: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0000d0a0: 6d31 3220 3d20 612a 6d62 2e6d 3132 2b62  m12 = a*mb.m12+b
-0000d0b0: 2a6d 622e 6d32 322b 632a 6d62 2e6d 3332  *mb.m22+c*mb.m32
-0000d0c0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0000d0d0: 662e 6d31 3320 3d20 612a 6d62 2e6d 3133  f.m13 = a*mb.m13
-0000d0e0: 2b62 2a6d 622e 6d32 332b 632a 6d62 2e6d  +b*mb.m23+c*mb.m
-0000d0f0: 3333 0a20 2020 2020 2020 2020 2020 2061  33.            a
-0000d100: 203d 2073 656c 662e 6d32 310a 2020 2020   = self.m21.    
-0000d110: 2020 2020 2020 2020 6220 3d20 7365 6c66          b = self
-0000d120: 2e6d 3232 0a20 2020 2020 2020 2020 2020  .m22.           
-0000d130: 2063 203d 2073 656c 662e 6d32 330a 2020   c = self.m23.  
-0000d140: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
-0000d150: 3231 203d 2061 2a6d 622e 6d31 312b 622a  21 = a*mb.m11+b*
-0000d160: 6d62 2e6d 3231 2b63 2a6d 622e 6d33 310a  mb.m21+c*mb.m31.
-0000d170: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0000d180: 2e6d 3232 203d 2061 2a6d 622e 6d31 322b  .m22 = a*mb.m12+
-0000d190: 622a 6d62 2e6d 3232 2b63 2a6d 622e 6d33  b*mb.m22+c*mb.m3
-0000d1a0: 320a 2020 2020 2020 2020 2020 2020 7365  2.            se
-0000d1b0: 6c66 2e6d 3233 203d 2061 2a6d 622e 6d31  lf.m23 = a*mb.m1
-0000d1c0: 332b 622a 6d62 2e6d 3233 2b63 2a6d 622e  3+b*mb.m23+c*mb.
-0000d1d0: 6d33 330a 2020 2020 2020 2020 2020 2020  m33.            
-0000d1e0: 6120 3d20 7365 6c66 2e6d 3331 0a20 2020  a = self.m31.   
-0000d1f0: 2020 2020 2020 2020 2062 203d 2073 656c           b = sel
-0000d200: 662e 6d33 320a 2020 2020 2020 2020 2020  f.m32.          
-0000d210: 2020 6320 3d20 7365 6c66 2e6d 3333 0a20    c = self.m33. 
-0000d220: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0000d230: 6d33 3120 3d20 612a 6d62 2e6d 3131 2b62  m31 = a*mb.m11+b
-0000d240: 2a6d 622e 6d32 312b 632a 6d62 2e6d 3331  *mb.m21+c*mb.m31
-0000d250: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0000d260: 662e 6d33 3220 3d20 612a 6d62 2e6d 3132  f.m32 = a*mb.m12
-0000d270: 2b62 2a6d 622e 6d32 322b 632a 6d62 2e6d  +b*mb.m22+c*mb.m
-0000d280: 3332 0a20 2020 2020 2020 2020 2020 2073  32.            s
-0000d290: 656c 662e 6d33 3320 3d20 612a 6d62 2e6d  elf.m33 = a*mb.m
-0000d2a0: 3133 2b62 2a6d 622e 6d32 332b 632a 6d62  13+b*mb.m23+c*mb
-0000d2b0: 2e6d 3333 0a20 2020 2020 2020 2020 2020  .m33.           
-0000d2c0: 2072 6574 7572 6e20 7365 6c66 0a20 2020   return self.   
-0000d2d0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-0000d2e0: 2020 2020 2020 2072 6169 7365 2054 7970         raise Typ
-0000d2f0: 6545 7272 6f72 2c20 2275 6e73 7570 706f  eError, "unsuppo
-0000d300: 7274 6564 206f 7065 7261 6e64 2074 7970  rted operand typ
-0000d310: 6520 666f 7220 2a3d 220a 0a20 2020 2064  e for *="..    d
-0000d320: 6566 205f 5f69 6469 765f 5f28 7365 6c66  ef __idiv__(self
-0000d330: 2c20 6f74 6865 7229 3a0a 2020 2020 2020  , other):.      
-0000d340: 2020 2222 2249 6e6c 696e 6520 6469 7669    """Inline divi
-0000d350: 7369 6f6e 2077 6974 6820 7363 616c 6172  sion with scalar
-0000d360: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-0000d370: 2020 2020 2020 6364 6566 2064 6f75 626c        cdef doubl
-0000d380: 6520 720a 2020 2020 2020 2020 7462 203d  e r.        tb =
-0000d390: 2074 7970 6528 6f74 6865 7229 0a20 2020   type(other).   
-0000d3a0: 2020 2020 2069 6620 7462 2069 7320 666c       if tb is fl
-0000d3b0: 6f61 7420 6f72 2074 6220 6973 2069 6e74  oat or tb is int
-0000d3c0: 206f 7220 7462 2069 7320 6c6f 6e67 3a0a   or tb is long:.
-0000d3d0: 2020 2020 2020 2020 2020 2020 723d 6f74              r=ot
-0000d3e0: 6865 720a 2020 2020 2020 2020 2020 2020  her.            
-0000d3f0: 6966 2066 6162 7328 7229 3c3d 6570 733a  if fabs(r)<=eps:
-0000d400: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000d410: 2072 6169 7365 205a 6572 6f44 6976 6973   raise ZeroDivis
-0000d420: 696f 6e45 7272 6f72 2c22 6d61 7433 2064  ionError,"mat3 d
-0000d430: 6976 6973 696f 6e22 0a20 2020 2020 2020  ivision".       
-0000d440: 2020 2020 2073 656c 662e 6d31 3120 3d20       self.m11 = 
-0000d450: 7365 6c66 2e6d 3131 2f72 0a20 2020 2020  self.m11/r.     
-0000d460: 2020 2020 2020 2073 656c 662e 6d31 3220         self.m12 
-0000d470: 3d20 7365 6c66 2e6d 3132 2f72 0a20 2020  = self.m12/r.   
-0000d480: 2020 2020 2020 2020 2073 656c 662e 6d31           self.m1
-0000d490: 3320 3d20 7365 6c66 2e6d 3133 2f72 0a20  3 = self.m13/r. 
-0000d4a0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0000d4b0: 6d32 3120 3d20 7365 6c66 2e6d 3231 2f72  m21 = self.m21/r
-0000d4c0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0000d4d0: 662e 6d32 3220 3d20 7365 6c66 2e6d 3232  f.m22 = self.m22
-0000d4e0: 2f72 0a20 2020 2020 2020 2020 2020 2073  /r.            s
-0000d4f0: 656c 662e 6d32 3320 3d20 7365 6c66 2e6d  elf.m23 = self.m
-0000d500: 3233 2f72 0a20 2020 2020 2020 2020 2020  23/r.           
-0000d510: 2073 656c 662e 6d33 3120 3d20 7365 6c66   self.m31 = self
-0000d520: 2e6d 3331 2f72 0a20 2020 2020 2020 2020  .m31/r.         
-0000d530: 2020 2073 656c 662e 6d33 3220 3d20 7365     self.m32 = se
-0000d540: 6c66 2e6d 3332 2f72 0a20 2020 2020 2020  lf.m32/r.       
-0000d550: 2020 2020 2073 656c 662e 6d33 3320 3d20       self.m33 = 
-0000d560: 7365 6c66 2e6d 3333 2f72 0a20 2020 2020  self.m33/r.     
-0000d570: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-0000d580: 6c66 0a20 2020 2020 2020 2065 6c73 653a  lf.        else:
-0000d590: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-0000d5a0: 7365 2054 7970 6545 7272 6f72 2c20 2275  se TypeError, "u
-0000d5b0: 6e73 7570 706f 7274 6564 206f 7065 7261  nsupported opera
-0000d5c0: 6e64 2074 7970 6520 666f 7220 2f3d 220a  nd type for /=".
-0000d5d0: 0a20 2020 2064 6566 205f 5f69 6d6f 645f  .    def __imod_
-0000d5e0: 5f28 7365 6c66 2c20 6229 3a0a 2020 2020  _(self, b):.    
-0000d5f0: 2020 2020 2222 2249 6e6c 696e 6520 6d6f      """Inline mo
-0000d600: 6475 6c6f 2e0a 2020 2020 2020 2020 2222  dulo..        ""
-0000d610: 220a 2020 2020 2020 2020 6364 6566 206d  ".        cdef m
-0000d620: 6174 3320 6d62 0a20 2020 2020 2020 2063  at3 mb.        c
-0000d630: 6465 6620 646f 7562 6c65 2072 0a0a 2020  def double r..  
-0000d640: 2020 2020 2020 7462 203d 2074 7970 6528        tb = type(
-0000d650: 6229 0a0a 2020 2020 2020 2020 6966 2074  b)..        if t
-0000d660: 6220 6973 2066 6c6f 6174 206f 7220 7462  b is float or tb
-0000d670: 2069 7320 696e 7420 6f72 2074 6220 6973   is int or tb is
-0000d680: 206c 6f6e 673a 0a20 2020 2020 2020 2020   long:.         
-0000d690: 2020 2072 203d 2062 0a20 2020 2020 2020     r = b.       
-0000d6a0: 2020 2020 2069 6620 6661 6273 2872 293c       if fabs(r)<
-0000d6b0: 3d65 7073 3a0a 2020 2020 2020 2020 2020  =eps:.          
-0000d6c0: 2020 2020 2020 7261 6973 6520 5a65 726f        raise Zero
-0000d6d0: 4469 7669 7369 6f6e 4572 726f 722c 226d  DivisionError,"m
-0000d6e0: 6174 3320 6d6f 6475 6c6f 220a 2020 2020  at3 modulo".    
-0000d6f0: 2020 2020 2020 2020 7365 6c66 2e6d 3131          self.m11
-0000d700: 203d 205f 666d 6f64 2873 656c 662e 6d31   = _fmod(self.m1
-0000d710: 312c 2072 290a 2020 2020 2020 2020 2020  1, r).          
-0000d720: 2020 7365 6c66 2e6d 3132 203d 205f 666d    self.m12 = _fm
-0000d730: 6f64 2873 656c 662e 6d31 322c 2072 290a  od(self.m12, r).
-0000d740: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0000d750: 2e6d 3133 203d 205f 666d 6f64 2873 656c  .m13 = _fmod(sel
-0000d760: 662e 6d31 332c 2072 290a 2020 2020 2020  f.m13, r).      
-0000d770: 2020 2020 2020 7365 6c66 2e6d 3231 203d        self.m21 =
-0000d780: 205f 666d 6f64 2873 656c 662e 6d32 312c   _fmod(self.m21,
-0000d790: 2072 290a 2020 2020 2020 2020 2020 2020   r).            
-0000d7a0: 7365 6c66 2e6d 3232 203d 205f 666d 6f64  self.m22 = _fmod
-0000d7b0: 2873 656c 662e 6d32 322c 2072 290a 2020  (self.m22, r).  
-0000d7c0: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
-0000d7d0: 3233 203d 205f 666d 6f64 2873 656c 662e  23 = _fmod(self.
-0000d7e0: 6d32 332c 2072 290a 2020 2020 2020 2020  m23, r).        
-0000d7f0: 2020 2020 7365 6c66 2e6d 3331 203d 205f      self.m31 = _
-0000d800: 666d 6f64 2873 656c 662e 6d33 312c 2072  fmod(self.m31, r
-0000d810: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
-0000d820: 6c66 2e6d 3332 203d 205f 666d 6f64 2873  lf.m32 = _fmod(s
-0000d830: 656c 662e 6d33 322c 2072 290a 2020 2020  elf.m32, r).    
-0000d840: 2020 2020 2020 2020 7365 6c66 2e6d 3333          self.m33
-0000d850: 203d 205f 666d 6f64 2873 656c 662e 6d33   = _fmod(self.m3
-0000d860: 332c 2072 290a 2020 2020 2020 2020 2020  3, r).          
-0000d870: 2020 7265 7475 726e 2073 656c 660a 2020    return self.  
-0000d880: 2020 2020 2020 656c 6966 2074 6220 6973        elif tb is
-0000d890: 206d 6174 333a 0a20 2020 2020 2020 2020   mat3:.         
-0000d8a0: 2020 206d 6220 3d20 620a 2020 2020 2020     mb = b.      
-0000d8b0: 2020 2020 2020 6966 2028 6661 6273 286d        if (fabs(m
-0000d8c0: 622e 6d31 3129 3c3d 6570 7320 6f72 2066  b.m11)<=eps or f
-0000d8d0: 6162 7328 6d62 2e6d 3132 293c 3d65 7073  abs(mb.m12)<=eps
-0000d8e0: 206f 7220 6661 6273 286d 622e 6d31 3329   or fabs(mb.m13)
-0000d8f0: 3c3d 6570 7320 6f72 0a20 2020 2020 2020  <=eps or.       
-0000d900: 2020 2020 2020 2020 2066 6162 7328 6d62           fabs(mb
-0000d910: 2e6d 3231 293c 3d65 7073 206f 7220 6661  .m21)<=eps or fa
-0000d920: 6273 286d 622e 6d32 3229 3c3d 6570 7320  bs(mb.m22)<=eps 
-0000d930: 6f72 2066 6162 7328 6d62 2e6d 3233 293c  or fabs(mb.m23)<
-0000d940: 3d65 7073 206f 720a 2020 2020 2020 2020  =eps or.        
-0000d950: 2020 2020 2020 2020 6661 6273 286d 622e          fabs(mb.
-0000d960: 6d33 3129 3c3d 6570 7320 6f72 2066 6162  m31)<=eps or fab
-0000d970: 7328 6d62 2e6d 3332 293c 3d65 7073 206f  s(mb.m32)<=eps o
-0000d980: 7220 6661 6273 286d 622e 6d33 3329 3c3d  r fabs(mb.m33)<=
-0000d990: 6570 7329 3a0a 2020 2020 2020 2020 2020  eps):.          
-0000d9a0: 2020 2020 2020 7261 6973 6520 5a65 726f        raise Zero
-0000d9b0: 4469 7669 7369 6f6e 4572 726f 722c 226d  DivisionError,"m
-0000d9c0: 6174 3320 6d6f 6475 6c6f 220a 2020 2020  at3 modulo".    
-0000d9d0: 2020 2020 2020 2020 7365 6c66 2e6d 3131          self.m11
-0000d9e0: 203d 205f 666d 6f64 2873 656c 662e 6d31   = _fmod(self.m1
-0000d9f0: 312c 206d 622e 6d31 3129 0a20 2020 2020  1, mb.m11).     
-0000da00: 2020 2020 2020 2073 656c 662e 6d31 3220         self.m12 
-0000da10: 3d20 5f66 6d6f 6428 7365 6c66 2e6d 3132  = _fmod(self.m12
-0000da20: 2c20 6d62 2e6d 3132 290a 2020 2020 2020  , mb.m12).      
-0000da30: 2020 2020 2020 7365 6c66 2e6d 3133 203d        self.m13 =
-0000da40: 205f 666d 6f64 2873 656c 662e 6d31 332c   _fmod(self.m13,
-0000da50: 206d 622e 6d31 3329 0a20 2020 2020 2020   mb.m13).       
-0000da60: 2020 2020 2073 656c 662e 6d32 3120 3d20       self.m21 = 
-0000da70: 5f66 6d6f 6428 7365 6c66 2e6d 3231 2c20  _fmod(self.m21, 
-0000da80: 6d62 2e6d 3231 290a 2020 2020 2020 2020  mb.m21).        
-0000da90: 2020 2020 7365 6c66 2e6d 3232 203d 205f      self.m22 = _
-0000daa0: 666d 6f64 2873 656c 662e 6d32 322c 206d  fmod(self.m22, m
-0000dab0: 622e 6d32 3229 0a20 2020 2020 2020 2020  b.m22).         
-0000dac0: 2020 2073 656c 662e 6d32 3320 3d20 5f66     self.m23 = _f
-0000dad0: 6d6f 6428 7365 6c66 2e6d 3233 2c20 6d62  mod(self.m23, mb
-0000dae0: 2e6d 3233 290a 2020 2020 2020 2020 2020  .m23).          
-0000daf0: 2020 7365 6c66 2e6d 3331 203d 205f 666d    self.m31 = _fm
-0000db00: 6f64 2873 656c 662e 6d33 312c 206d 622e  od(self.m31, mb.
-0000db10: 6d33 3129 0a20 2020 2020 2020 2020 2020  m31).           
-0000db20: 2073 656c 662e 6d33 3220 3d20 5f66 6d6f   self.m32 = _fmo
-0000db30: 6428 7365 6c66 2e6d 3332 2c20 6d62 2e6d  d(self.m32, mb.m
-0000db40: 3332 290a 2020 2020 2020 2020 2020 2020  32).            
-0000db50: 7365 6c66 2e6d 3333 203d 205f 666d 6f64  self.m33 = _fmod
-0000db60: 2873 656c 662e 6d33 332c 206d 622e 6d33  (self.m33, mb.m3
-0000db70: 3329 0a20 2020 2020 2020 2020 2020 2072  3).            r
-0000db80: 6574 7572 6e20 7365 6c66 0a20 2020 2020  eturn self.     
-0000db90: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0000dba0: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
-0000dbb0: 7272 6f72 2c20 2275 6e73 7570 706f 7274  rror, "unsupport
-0000dbc0: 6564 206f 7065 7261 6e64 2074 7970 6520  ed operand type 
-0000dbd0: 666f 7220 253d 220a 0a0a 2020 2020 6465  for %="...    de
-0000dbe0: 6620 5f5f 6c65 6e5f 5f28 7365 6c66 293a  f __len__(self):
-0000dbf0: 0a20 2020 2020 2020 2022 2222 4c65 6e67  .        """Leng
-0000dc00: 7468 206f 6620 7468 6520 7365 7175 656e  th of the sequen
-0000dc10: 6365 2028 616c 7761 7973 2033 292e 2222  ce (always 3).""
-0000dc20: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
-0000dc30: 2033 0a0a 2020 2020 6465 6620 5f5f 6765   3..    def __ge
-0000dc40: 7469 7465 6d5f 5f28 6d61 7433 2073 656c  titem__(mat3 sel
-0000dc50: 662c 206b 6579 293a 0a20 2020 2020 2020  f, key):.       
-0000dc60: 2022 2222 5265 7475 726e 2061 2063 6f6c   """Return a col
-0000dc70: 756d 6e20 6f72 2061 2073 696e 676c 6520  umn or a single 
-0000dc80: 6d61 7472 6978 2065 6c65 6d65 6e74 2e0a  matrix element..
-0000dc90: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0000dca0: 2020 2020 6364 6566 2069 6e74 2069 2c6a      cdef int i,j
-0000dcb0: 0a0a 2020 2020 2020 2020 543d 7479 7065  ..        T=type
-0000dcc0: 286b 6579 290a 2020 2020 2020 2020 6966  (key).        if
-0000dcd0: 2054 2069 7320 696e 7420 6f72 2054 2069   T is int or T i
-0000dce0: 7320 6c6f 6e67 3a0a 2020 2020 2020 2020  s long:.        
-0000dcf0: 2020 2020 6920 3d20 6b65 790a 2020 2020      i = key.    
-0000dd00: 2020 2020 2020 2020 6966 2069 3d3d 303a          if i==0:
-0000dd10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000dd20: 2072 6574 7572 6e20 7665 6333 2873 656c   return vec3(sel
-0000dd30: 662e 6d31 312c 2073 656c 662e 6d32 312c  f.m11, self.m21,
-0000dd40: 2073 656c 662e 6d33 3129 0a20 2020 2020   self.m31).     
-0000dd50: 2020 2020 2020 2065 6c69 6620 693d 3d31         elif i==1
-0000dd60: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0000dd70: 2020 7265 7475 726e 2076 6563 3328 7365    return vec3(se
-0000dd80: 6c66 2e6d 3132 2c20 7365 6c66 2e6d 3232  lf.m12, self.m22
-0000dd90: 2c20 7365 6c66 2e6d 3332 290a 2020 2020  , self.m32).    
-0000dda0: 2020 2020 2020 2020 656c 6966 2069 3d3d          elif i==
-0000ddb0: 323a 0a20 2020 2020 2020 2020 2020 2020  2:.             
-0000ddc0: 2020 2072 6574 7572 6e20 7665 6333 2873     return vec3(s
-0000ddd0: 656c 662e 6d31 332c 2073 656c 662e 6d32  elf.m13, self.m2
-0000dde0: 332c 2073 656c 662e 6d33 3329 0a20 2020  3, self.m33).   
-0000ddf0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-0000de00: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0000de10: 6169 7365 2049 6e64 6578 4572 726f 722c  aise IndexError,
-0000de20: 2022 696e 6465 7820 6f75 7420 6f66 2072   "index out of r
-0000de30: 616e 6765 220a 2020 2020 2020 2020 656c  ange".        el
-0000de40: 6966 2054 2069 7320 7475 706c 653a 0a20  if T is tuple:. 
-0000de50: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
-0000de60: 6e28 6b65 7929 213d 323a 0a20 2020 2020  n(key)!=2:.     
-0000de70: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-0000de80: 2056 616c 7565 4572 726f 722c 2022 696e   ValueError, "in
-0000de90: 6465 7820 7475 706c 6520 6d75 7374 2062  dex tuple must b
-0000dea0: 6520 6120 322d 7475 706c 6522 0a20 2020  e a 2-tuple".   
-0000deb0: 2020 2020 2020 2020 2069 203d 206b 6579           i = key
-0000dec0: 5b30 5d0a 2020 2020 2020 2020 2020 2020  [0].            
-0000ded0: 6a20 3d20 6b65 795b 315d 0a20 2020 2020  j = key[1].     
-0000dee0: 2020 2020 2020 2069 6620 693c 3020 6f72         if i<0 or
-0000def0: 2069 3e32 206f 7220 6a3c 3020 6f72 206a   i>2 or j<0 or j
-0000df00: 3e32 3a0a 2020 2020 2020 2020 2020 2020  >2:.            
-0000df10: 2020 2020 7261 6973 6520 496e 6465 7845      raise IndexE
-0000df20: 7272 6f72 2c20 2269 6e64 6578 206f 7574  rror, "index out
-0000df30: 206f 6620 7261 6e67 6522 0a0a 2020 2020   of range"..    
-0000df40: 2020 2020 2020 2020 6966 2069 3d3d 303a          if i==0:
-0000df50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000df60: 2069 6620 6a3d 3d30 3a0a 2020 2020 2020   if j==0:.      
-0000df70: 2020 2020 2020 2020 2020 2020 2020 7265                re
-0000df80: 7475 726e 2073 656c 662e 6d31 310a 2020  turn self.m11.  
-0000df90: 2020 2020 2020 2020 2020 2020 2020 656c                el
-0000dfa0: 6966 206a 3d3d 313a 0a20 2020 2020 2020  if j==1:.       
-0000dfb0: 2020 2020 2020 2020 2020 2020 2072 6574               ret
-0000dfc0: 7572 6e20 7365 6c66 2e6d 3132 0a20 2020  urn self.m12.   
-0000dfd0: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
-0000dfe0: 6620 6a3d 3d32 3a0a 2020 2020 2020 2020  f j==2:.        
-0000dff0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0000e000: 726e 2073 656c 662e 6d31 330a 2020 2020  rn self.m13.    
-0000e010: 2020 2020 2020 2020 656c 6966 2069 3d3d          elif i==
-0000e020: 313a 0a20 2020 2020 2020 2020 2020 2020  1:.             
-0000e030: 2020 2069 6620 6a3d 3d30 3a0a 2020 2020     if j==0:.    
-0000e040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e050: 7265 7475 726e 2073 656c 662e 6d32 310a  return self.m21.
-0000e060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e070: 656c 6966 206a 3d3d 313a 0a20 2020 2020  elif j==1:.     
-0000e080: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0000e090: 6574 7572 6e20 7365 6c66 2e6d 3232 0a20  eturn self.m22. 
-0000e0a0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0000e0b0: 6c69 6620 6a3d 3d32 3a0a 2020 2020 2020  lif j==2:.      
-0000e0c0: 2020 2020 2020 2020 2020 2020 2020 7265                re
-0000e0d0: 7475 726e 2073 656c 662e 6d32 330a 2020  turn self.m23.  
-0000e0e0: 2020 2020 2020 2020 2020 656c 6966 2069            elif i
-0000e0f0: 3d3d 323a 0a20 2020 2020 2020 2020 2020  ==2:.           
-0000e100: 2020 2020 2069 6620 6a3d 3d30 3a0a 2020       if j==0:.  
-0000e110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e120: 2020 7265 7475 726e 2073 656c 662e 6d33    return self.m3
-0000e130: 310a 2020 2020 2020 2020 2020 2020 2020  1.              
-0000e140: 2020 656c 6966 206a 3d3d 313a 0a20 2020    elif j==1:.   
-0000e150: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e160: 2072 6574 7572 6e20 7365 6c66 2e6d 3332   return self.m32
-0000e170: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000e180: 2065 6c69 6620 6a3d 3d32 3a0a 2020 2020   elif j==2:.    
-0000e190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e1a0: 7265 7475 726e 2073 656c 662e 6d33 330a  return self.m33.
-0000e1b0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0000e1c0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-0000e1d0: 5479 7065 4572 726f 722c 2269 6e64 6578  TypeError,"index
-0000e1e0: 206d 7573 7420 6265 2069 6e74 6567 6572   must be integer
-0000e1f0: 206f 7220 322d 7475 706c 6522 0a0a 2020   or 2-tuple"..  
-0000e200: 2020 6465 6620 5f5f 7365 7469 7465 6d5f    def __setitem_
-0000e210: 5f28 7365 6c66 2c20 6b65 792c 2076 616c  _(self, key, val
-0000e220: 7565 293a 0a20 2020 2020 2020 2022 2222  ue):.        """
-0000e230: 5365 7420 6120 636f 6c75 6d6e 206f 7220  Set a column or 
-0000e240: 6120 7369 6e67 6c65 206d 6174 7269 7820  a single matrix 
-0000e250: 656c 656d 656e 742e 0a0a 2020 2020 2020  element...      
-0000e260: 2020 5468 6520 636f 6c75 6d6e 206d 7573    The column mus
-0000e270: 7420 6265 2067 6976 656e 2061 7320 6120  t be given as a 
-0000e280: 332d 7365 7175 656e 6365 2028 7468 6973  3-sequence (this
-0000e290: 2069 6e63 6c75 6465 7320 7665 6333 2061   includes vec3 a
-0000e2a0: 7320 7765 6c6c 292e 0a20 2020 2020 2020  s well)..       
-0000e2b0: 2022 2222 0a20 2020 2020 2020 2063 6465   """.        cde
-0000e2c0: 6620 696e 7420 692c 6a0a 2020 2020 2020  f int i,j.      
-0000e2d0: 2020 6364 6566 2064 6f75 626c 6520 760a    cdef double v.
-0000e2e0: 0a20 2020 2020 2020 2054 3d74 7970 6528  .        T=type(
-0000e2f0: 6b65 7929 0a20 2020 2020 2020 2069 6620  key).        if 
-0000e300: 5420 6973 2069 6e74 206f 7220 5420 6973  T is int or T is
-0000e310: 206c 6f6e 673a 0a20 2020 2020 2020 2020   long:.         
-0000e320: 2020 2069 6620 6c65 6e28 7661 6c75 6529     if len(value)
-0000e330: 213d 333a 0a20 2020 2020 2020 2020 2020  !=3:.           
-0000e340: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-0000e350: 4572 726f 722c 2022 332d 7365 7175 656e  Error, "3-sequen
-0000e360: 6365 2065 7870 6563 7465 6422 0a20 2020  ce expected".   
-0000e370: 2020 2020 2020 2020 2069 203d 206b 6579           i = key
-0000e380: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0000e390: 693d 3d30 3a0a 2020 2020 2020 2020 2020  i==0:.          
-0000e3a0: 2020 2020 2020 7365 6c66 2e6d 3131 203d        self.m11 =
-0000e3b0: 2076 616c 7565 5b30 5d0a 2020 2020 2020   value[0].      
-0000e3c0: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
-0000e3d0: 3231 203d 2076 616c 7565 5b31 5d0a 2020  21 = value[1].  
-0000e3e0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0000e3f0: 6c66 2e6d 3331 203d 2076 616c 7565 5b32  lf.m31 = value[2
-0000e400: 5d0a 2020 2020 2020 2020 2020 2020 656c  ].            el
-0000e410: 6966 2069 3d3d 313a 0a20 2020 2020 2020  if i==1:.       
-0000e420: 2020 2020 2020 2020 2073 656c 662e 6d31           self.m1
-0000e430: 3220 3d20 7661 6c75 655b 305d 0a20 2020  2 = value[0].   
-0000e440: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0000e450: 662e 6d32 3220 3d20 7661 6c75 655b 315d  f.m22 = value[1]
-0000e460: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000e470: 2073 656c 662e 6d33 3220 3d20 7661 6c75   self.m32 = valu
-0000e480: 655b 325d 0a20 2020 2020 2020 2020 2020  e[2].           
-0000e490: 2065 6c69 6620 693d 3d32 3a0a 2020 2020   elif i==2:.    
-0000e4a0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0000e4b0: 2e6d 3133 203d 2076 616c 7565 5b30 5d0a  .m13 = value[0].
-0000e4c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e4d0: 7365 6c66 2e6d 3233 203d 2076 616c 7565  self.m23 = value
-0000e4e0: 5b31 5d0a 2020 2020 2020 2020 2020 2020  [1].            
-0000e4f0: 2020 2020 7365 6c66 2e6d 3333 203d 2076      self.m33 = v
-0000e500: 616c 7565 5b32 5d0a 2020 2020 2020 2020  alue[2].        
-0000e510: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-0000e520: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-0000e530: 496e 6465 7845 7272 6f72 2c20 2269 6e64  IndexError, "ind
-0000e540: 6578 206f 7574 206f 6620 7261 6e67 6522  ex out of range"
-0000e550: 0a20 2020 2020 2020 2065 6c69 6620 5420  .        elif T 
-0000e560: 6973 2074 7570 6c65 3a0a 2020 2020 2020  is tuple:.      
-0000e570: 2020 2020 2020 6966 206c 656e 286b 6579        if len(key
-0000e580: 2921 3d32 3a0a 2020 2020 2020 2020 2020  )!=2:.          
-0000e590: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-0000e5a0: 6545 7272 6f72 2c20 2269 6e64 6578 2074  eError, "index t
-0000e5b0: 7570 6c65 206d 7573 7420 6265 2061 2032  uple must be a 2
-0000e5c0: 2d74 7570 6c65 220a 2020 2020 2020 2020  -tuple".        
-0000e5d0: 2020 2020 6920 3d20 6b65 795b 305d 0a20      i = key[0]. 
-0000e5e0: 2020 2020 2020 2020 2020 206a 203d 206b             j = k
-0000e5f0: 6579 5b31 5d0a 2020 2020 2020 2020 2020  ey[1].          
-0000e600: 2020 7620 3d20 7661 6c75 650a 2020 2020    v = value.    
-0000e610: 2020 2020 2020 2020 6966 2069 3c30 206f          if i<0 o
-0000e620: 7220 693e 3220 6f72 206a 3c30 206f 7220  r i>2 or j<0 or 
-0000e630: 6a3e 323a 0a20 2020 2020 2020 2020 2020  j>2:.           
-0000e640: 2020 2020 2072 6169 7365 2049 6e64 6578       raise Index
-0000e650: 4572 726f 722c 2022 696e 6465 7820 6f75  Error, "index ou
-0000e660: 7420 6f66 2072 616e 6765 220a 0a20 2020  t of range"..   
-0000e670: 2020 2020 2020 2020 2069 6620 693d 3d30           if i==0
-0000e680: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0000e690: 2020 6966 206a 3d3d 303a 0a20 2020 2020    if j==0:.     
-0000e6a0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0000e6b0: 656c 662e 6d31 3120 3d20 760a 2020 2020  elf.m11 = v.    
-0000e6c0: 2020 2020 2020 2020 2020 2020 656c 6966              elif
-0000e6d0: 206a 3d3d 313a 0a20 2020 2020 2020 2020   j==1:.         
-0000e6e0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0000e6f0: 6d31 3220 3d20 760a 2020 2020 2020 2020  m12 = v.        
-0000e700: 2020 2020 2020 2020 656c 6966 206a 3d3d          elif j==
-0000e710: 323a 0a20 2020 2020 2020 2020 2020 2020  2:.             
-0000e720: 2020 2020 2020 2073 656c 662e 6d31 3320         self.m13 
-0000e730: 3d20 760a 2020 2020 2020 2020 2020 2020  = v.            
-0000e740: 656c 6966 2069 3d3d 313a 0a20 2020 2020  elif i==1:.     
-0000e750: 2020 2020 2020 2020 2020 2069 6620 6a3d             if j=
-0000e760: 3d30 3a0a 2020 2020 2020 2020 2020 2020  =0:.            
-0000e770: 2020 2020 2020 2020 7365 6c66 2e6d 3231          self.m21
-0000e780: 203d 2076 0a20 2020 2020 2020 2020 2020   = v.           
-0000e790: 2020 2020 2065 6c69 6620 6a3d 3d31 3a0a       elif j==1:.
+00008890: 2073 656c 662e 790a 2020 2020 2020 2020   self.y.        
+000088a0: 656c 6966 206e 616d 653d 3d22 7a22 3a0a  elif name=="z":.
+000088b0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+000088c0: 726e 2073 656c 662e 7a0a 2020 2020 2020  rn self.z.      
+000088d0: 2020 656c 6966 206e 616d 653d 3d22 7722    elif name=="w"
+000088e0: 206f 7220 6e61 6d65 3d3d 2274 223a 0a20   or name=="t":. 
+000088f0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00008900: 6e20 7365 6c66 2e77 0a20 2020 2020 2020  n self.w.       
+00008910: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00008920: 2020 2072 6169 7365 2041 7474 7269 6275     raise Attribu
+00008930: 7465 4572 726f 722c 2276 6563 3420 6861  teError,"vec4 ha
+00008940: 7320 6e6f 2061 7474 7269 6275 7465 2027  s no attribute '
+00008950: 222b 6e61 6d65 2b22 2722 0a0a 2020 2020  "+name+"'"..    
+00008960: 6465 6620 5f5f 7365 7461 7474 725f 5f28  def __setattr__(
+00008970: 7365 6c66 2c20 6e61 6d65 2c20 7661 6c29  self, name, val)
+00008980: 3a0a 2020 2020 2020 2020 6966 206e 616d  :.        if nam
+00008990: 653d 3d22 7822 3a0a 2020 2020 2020 2020  e=="x":.        
+000089a0: 2020 2020 7365 6c66 2e78 203d 2076 616c      self.x = val
+000089b0: 0a20 2020 2020 2020 2065 6c69 6620 6e61  .        elif na
+000089c0: 6d65 3d3d 2279 223a 0a20 2020 2020 2020  me=="y":.       
+000089d0: 2020 2020 2073 656c 662e 7920 3d20 7661       self.y = va
+000089e0: 6c0a 2020 2020 2020 2020 656c 6966 206e  l.        elif n
+000089f0: 616d 653d 3d22 7a22 3a0a 2020 2020 2020  ame=="z":.      
+00008a00: 2020 2020 2020 7365 6c66 2e7a 203d 2076        self.z = v
+00008a10: 616c 0a20 2020 2020 2020 2065 6c69 6620  al.        elif 
+00008a20: 6e61 6d65 3d3d 2277 2220 6f72 206e 616d  name=="w" or nam
+00008a30: 653d 3d22 7422 3a0a 2020 2020 2020 2020  e=="t":.        
+00008a40: 2020 2020 7365 6c66 2e77 203d 2076 616c      self.w = val
+00008a50: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+00008a60: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00008a70: 2041 7474 7269 6275 7465 4572 726f 722c   AttributeError,
+00008a80: 2276 6563 3420 6861 7320 6e6f 2077 7269  "vec4 has no wri
+00008a90: 7461 626c 6520 6174 7472 6962 7574 6520  table attribute 
+00008aa0: 2722 2b6e 616d 652b 2227 220a 0a20 2020  '"+name+"'"..   
+00008ab0: 2064 6566 205f 5f6c 656e 5f5f 2873 656c   def __len__(sel
+00008ac0: 6629 3a0a 2020 2020 2020 2020 2222 224c  f):.        """L
+00008ad0: 656e 6774 6820 6f66 2074 6865 2073 6571  ength of the seq
+00008ae0: 7565 6e63 6520 2861 6c77 6179 7320 3429  uence (always 4)
+00008af0: 2e22 2222 0a20 2020 2020 2020 2072 6574  .""".        ret
+00008b00: 7572 6e20 340a 0a20 2020 2064 6566 205f  urn 4..    def _
+00008b10: 5f67 6574 6974 656d 5f5f 2873 656c 662c  _getitem__(self,
+00008b20: 206b 6579 293a 0a20 2020 2020 2020 2022   key):.        "
+00008b30: 2222 5265 7475 726e 2061 2063 6f6d 706f  ""Return a compo
+00008b40: 6e65 6e74 2062 7920 696e 6465 7820 2830  nent by index (0
+00008b50: 2d62 6173 6564 292e 0a0a 2020 2020 2020  -based)...      
+00008b60: 2020 3e3e 3e20 613d 7665 6334 2831 2e30    >>> a=vec4(1.0
+00008b70: 2c20 302e 352c 202d 312e 382c 2030 2e32  , 0.5, -1.8, 0.2
+00008b80: 290a 2020 2020 2020 2020 3e3e 3e20 7072  ).        >>> pr
+00008b90: 696e 7428 615b 305d 290a 2020 2020 2020  int(a[0]).      
+00008ba0: 2020 312e 300a 2020 2020 2020 2020 3e3e    1.0.        >>
+00008bb0: 3e20 7072 696e 7428 615b 315d 290a 2020  > print(a[1]).  
+00008bc0: 2020 2020 2020 302e 350a 2020 2020 2020        0.5.      
+00008bd0: 2020 3e3e 3e20 7072 696e 7428 615b 325d    >>> print(a[2]
+00008be0: 290a 2020 2020 2020 2020 2d31 2e38 0a20  ).        -1.8. 
+00008bf0: 2020 2020 2020 203e 3e3e 2070 7269 6e74         >>> print
+00008c00: 2861 5b33 5d29 0a20 2020 2020 2020 2030  (a[3]).        0
+00008c10: 2e32 0a20 2020 2020 2020 2022 2222 0a20  .2.        """. 
+00008c20: 2020 2020 2020 2063 6465 6620 696e 7420         cdef int 
+00008c30: 6b0a 0a20 2020 2020 2020 2054 3d74 7970  k..        T=typ
+00008c40: 6528 6b65 7929 0a20 2020 2020 2020 2069  e(key).        i
+00008c50: 6620 5421 3d69 6e74 2061 6e64 2054 213d  f T!=int and T!=
+00008c60: 6c6f 6e67 3a0a 2020 2020 2020 2020 2020  long:.          
+00008c70: 2020 7261 6973 6520 5479 7065 4572 726f    raise TypeErro
+00008c80: 722c 2022 696e 6465 7820 6d75 7374 2062  r, "index must b
+00008c90: 6520 696e 7465 6765 7222 0a0a 2020 2020  e integer"..    
+00008ca0: 2020 2020 6b20 3d20 6b65 790a 2020 2020      k = key.    
+00008cb0: 2020 2020 6966 2020 206b 3d3d 303a 2072      if   k==0: r
+00008cc0: 6574 7572 6e20 7365 6c66 2e78 0a20 2020  eturn self.x.   
+00008cd0: 2020 2020 2065 6c69 6620 6b3d 3d31 3a20       elif k==1: 
+00008ce0: 7265 7475 726e 2073 656c 662e 790a 2020  return self.y.  
+00008cf0: 2020 2020 2020 656c 6966 206b 3d3d 323a        elif k==2:
+00008d00: 2072 6574 7572 6e20 7365 6c66 2e7a 0a20   return self.z. 
+00008d10: 2020 2020 2020 2065 6c69 6620 6b3d 3d33         elif k==3
+00008d20: 3a20 7265 7475 726e 2073 656c 662e 770a  : return self.w.
+00008d30: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00008d40: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00008d50: 496e 6465 7845 7272 6f72 2c22 696e 6465  IndexError,"inde
+00008d60: 7820 6f75 7420 6f66 2072 616e 6765 220a  x out of range".
+00008d70: 0a20 2020 2064 6566 205f 5f73 6574 6974  .    def __setit
+00008d80: 656d 5f5f 2873 656c 662c 206b 6579 2c20  em__(self, key, 
+00008d90: 7661 6c75 6529 3a0a 2020 2020 2020 2020  value):.        
+00008da0: 2222 2253 6574 2061 2063 6f6d 706f 6e65  """Set a compone
+00008db0: 6e74 2062 7920 696e 6465 7820 2830 2d62  nt by index (0-b
+00008dc0: 6173 6564 292e 0a0a 2020 2020 2020 2020  ased)...        
+00008dd0: 3e3e 3e20 613d 7665 6334 2829 0a20 2020  >>> a=vec4().   
+00008de0: 2020 2020 203e 3e3e 2061 5b30 5d3d 312e       >>> a[0]=1.
+00008df0: 353b 2061 5b31 5d3d 302e 373b 2061 5b32  5; a[1]=0.7; a[2
+00008e00: 5d3d 2d30 2e33 3b20 615b 335d 3d30 2e32  ]=-0.3; a[3]=0.2
+00008e10: 0a20 2020 2020 2020 203e 3e3e 2070 7269  .        >>> pri
+00008e20: 6e74 2861 290a 2020 2020 2020 2020 2831  nt(a).        (1
+00008e30: 2e35 3030 302c 2030 2e37 3030 302c 202d  .5000, 0.7000, -
+00008e40: 302e 3330 3030 2c20 302e 3230 3030 290a  0.3000, 0.2000).
+00008e50: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00008e60: 2020 2020 6364 6566 2069 6e74 206b 0a0a      cdef int k..
+00008e70: 2020 2020 2020 2020 543d 7479 7065 286b          T=type(k
+00008e80: 6579 290a 2020 2020 2020 2020 6966 2054  ey).        if T
+00008e90: 213d 696e 7420 616e 6420 5421 3d6c 6f6e  !=int and T!=lon
+00008ea0: 673a 0a20 2020 2020 2020 2020 2020 2072  g:.            r
+00008eb0: 6169 7365 2054 7970 6545 7272 6f72 2c20  aise TypeError, 
+00008ec0: 2269 6e64 6578 206d 7573 7420 6265 2069  "index must be i
+00008ed0: 6e74 6567 6572 220a 0a20 2020 2020 2020  nteger"..       
+00008ee0: 206b 203d 206b 6579 0a20 2020 2020 2020   k = key.       
+00008ef0: 2069 6620 2020 6b3d 3d30 3a20 7365 6c66   if   k==0: self
+00008f00: 2e78 203d 2076 616c 7565 0a20 2020 2020  .x = value.     
+00008f10: 2020 2065 6c69 6620 6b3d 3d31 3a20 7365     elif k==1: se
+00008f20: 6c66 2e79 203d 2076 616c 7565 0a20 2020  lf.y = value.   
+00008f30: 2020 2020 2065 6c69 6620 6b3d 3d32 3a20       elif k==2: 
+00008f40: 7365 6c66 2e7a 203d 2076 616c 7565 0a20  self.z = value. 
+00008f50: 2020 2020 2020 2065 6c69 6620 6b3d 3d33         elif k==3
+00008f60: 3a20 7365 6c66 2e77 203d 2076 616c 7565  : self.w = value
+00008f70: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+00008f80: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00008f90: 2049 6e64 6578 4572 726f 722c 2269 6e64   IndexError,"ind
+00008fa0: 6578 206f 7574 206f 6620 7261 6e67 6522  ex out of range"
+00008fb0: 0a0a 2020 2020 6465 6620 6c65 6e67 7468  ..    def length
+00008fc0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00008fd0: 2222 2252 6574 7572 6e20 7468 6520 6c65  """Return the le
+00008fe0: 6e67 7468 206f 6620 7468 6520 7665 6374  ngth of the vect
+00008ff0: 6f72 2e0a 0a20 2020 2020 2020 2076 2e6c  or...        v.l
+00009000: 656e 6774 6828 2920 6973 2065 7175 6976  ength() is equiv
+00009010: 616c 656e 7420 746f 2061 6273 2876 292e  alent to abs(v).
+00009020: 0a0a 2020 2020 2020 2020 3e3e 3e20 613d  ..        >>> a=
+00009030: 7665 6334 2831 2e30 2c20 302e 352c 202d  vec4(1.0, 0.5, -
+00009040: 312e 382c 2030 2e32 290a 2020 2020 2020  1.8, 0.2).      
+00009050: 2020 3e3e 3e20 7072 696e 7428 612e 6c65    >>> print(a.le
+00009060: 6e67 7468 2829 290a 2020 2020 2020 2020  ngth()).        
+00009070: 322e 3132 3833 3739 3636 3533 380a 2020  2.12837966538.  
+00009080: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00009090: 2020 6364 6566 2064 6f75 626c 6520 610a    cdef double a.
+000090a0: 2020 2020 2020 2020 6120 3d20 7365 6c66          a = self
+000090b0: 2e78 2a73 656c 662e 7820 2b20 7365 6c66  .x*self.x + self
+000090c0: 2e79 2a73 656c 662e 7920 2b20 7365 6c66  .y*self.y + self
+000090d0: 2e7a 2a73 656c 662e 7a20 2b20 7365 6c66  .z*self.z + self
+000090e0: 2e77 2a73 656c 662e 770a 2020 2020 2020  .w*self.w.      
+000090f0: 2020 7265 7475 726e 2073 7172 7428 6129    return sqrt(a)
+00009100: 0a0a 2020 2020 6465 6620 6e6f 726d 616c  ..    def normal
+00009110: 697a 6528 7365 6c66 293a 0a20 2020 2020  ize(self):.     
+00009120: 2020 2022 2222 5265 7475 726e 206e 6f72     """Return nor
+00009130: 6d61 6c69 7a65 6420 7665 6374 6f72 2e0a  malized vector..
+00009140: 0a20 2020 2020 2020 203e 3e3e 2061 3d76  .        >>> a=v
+00009150: 6563 3428 312e 302c 2030 2e35 2c20 2d31  ec4(1.0, 0.5, -1
+00009160: 2e38 2c20 312e 3229 0a20 2020 2020 2020  .8, 1.2).       
+00009170: 203e 3e3e 2070 7269 6e74 2861 2e6e 6f72   >>> print(a.nor
+00009180: 6d61 6c69 7a65 2829 290a 2020 2020 2020  malize()).      
+00009190: 2020 2830 2e34 3130 372c 2030 2e32 3035    (0.4107, 0.205
+000091a0: 332c 202d 302e 3733 3932 2c20 302e 3439  3, -0.7392, 0.49
+000091b0: 3238 290a 2020 2020 2020 2020 2222 220a  28).        """.
+000091c0: 2020 2020 2020 2020 6364 6566 2076 6563          cdef vec
+000091d0: 3420 7265 730a 2020 2020 2020 2020 6364  4 res.        cd
+000091e0: 6566 2064 6f75 626c 6520 6e6c 656e 0a0a  ef double nlen..
+000091f0: 2020 2020 2020 2020 6e6c 656e 203d 2073          nlen = s
+00009200: 7172 7428 7365 6c66 2e78 2a73 656c 662e  qrt(self.x*self.
+00009210: 7820 2b20 7365 6c66 2e79 2a73 656c 662e  x + self.y*self.
+00009220: 7920 2b20 7365 6c66 2e7a 2a73 656c 662e  y + self.z*self.
+00009230: 7a20 2b20 7365 6c66 2e77 2a73 656c 662e  z + self.w*self.
+00009240: 7729 0a20 2020 2020 2020 2069 6620 6e6c  w).        if nl
+00009250: 656e 3c3d 6570 733a 0a20 2020 2020 2020  en<=eps:.       
+00009260: 2020 2020 2072 6169 7365 205a 6572 6f44       raise ZeroD
+00009270: 6976 6973 696f 6e45 7272 6f72 2c22 6e75  ivisionError,"nu
+00009280: 6c6c 2076 6563 746f 7220 6361 6e27 7420  ll vector can't 
+00009290: 6265 206e 6f72 6d61 6c69 7a65 6422 0a20  be normalized". 
+000092a0: 2020 2020 2020 206e 6c65 6e20 3d20 312e         nlen = 1.
+000092b0: 302f 6e6c 656e 0a20 2020 2020 2020 2072  0/nlen.        r
+000092c0: 6573 203d 2076 6563 3428 290a 2020 2020  es = vec4().    
+000092d0: 2020 2020 7265 732e 7820 3d20 7365 6c66      res.x = self
+000092e0: 2e78 2a6e 6c65 6e0a 2020 2020 2020 2020  .x*nlen.        
+000092f0: 7265 732e 7920 3d20 7365 6c66 2e79 2a6e  res.y = self.y*n
+00009300: 6c65 6e0a 2020 2020 2020 2020 7265 732e  len.        res.
+00009310: 7a20 3d20 7365 6c66 2e7a 2a6e 6c65 6e0a  z = self.z*nlen.
+00009320: 2020 2020 2020 2020 7265 732e 7720 3d20          res.w = 
+00009330: 7365 6c66 2e77 2a6e 6c65 6e0a 2020 2020  self.w*nlen.    
+00009340: 2020 2020 7265 7475 726e 2072 6573 0a0a      return res..
+00009350: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00009360: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00009370: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00009380: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00009390: 2323 2323 2323 0a0a 2320 6d61 7433 6974  ######..# mat3it
+000093a0: 6572 0a63 6465 6620 636c 6173 7320 6d61  er.cdef class ma
+000093b0: 7433 6974 6572 3a0a 2020 2020 2222 226d  t3iter:.    """m
+000093c0: 6174 2069 7465 7261 746f 722e 2222 220a  at iterator.""".
+000093d0: 2020 2020 6364 6566 2069 6e74 2069 6478      cdef int idx
+000093e0: 0a20 2020 2063 6465 6620 6f62 6a65 6374  .    cdef object
+000093f0: 206d 0a0a 2020 2020 6465 6620 5f5f 6369   m..    def __ci
+00009400: 6e69 745f 5f28 7365 6c66 2c20 6d29 3a0a  nit__(self, m):.
+00009410: 2020 2020 2020 2020 7365 6c66 2e69 6478          self.idx
+00009420: 203d 2030 0a20 2020 2020 2020 2073 656c   = 0.        sel
+00009430: 662e 6d20 2020 3d20 6d0a 0a20 2020 2064  f.m   = m..    d
+00009440: 6566 205f 5f69 7465 725f 5f28 7365 6c66  ef __iter__(self
+00009450: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+00009460: 6e20 7365 6c66 0a0a 2020 2020 6465 6620  n self..    def 
+00009470: 5f5f 6e65 7874 5f5f 2873 656c 6629 3a0a  __next__(self):.
+00009480: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+00009490: 6964 783d 3d30 3a0a 2020 2020 2020 2020  idx==0:.        
+000094a0: 2020 2020 7365 6c66 2e69 6478 3d31 0a20      self.idx=1. 
+000094b0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+000094c0: 6e20 7365 6c66 2e6d 5b30 5d0a 2020 2020  n self.m[0].    
+000094d0: 2020 2020 656c 6966 2073 656c 662e 6964      elif self.id
+000094e0: 783d 3d31 3a0a 2020 2020 2020 2020 2020  x==1:.          
+000094f0: 2020 7365 6c66 2e69 6478 3d32 0a20 2020    self.idx=2.   
+00009500: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00009510: 7365 6c66 2e6d 5b31 5d0a 2020 2020 2020  self.m[1].      
+00009520: 2020 656c 6966 2073 656c 662e 6964 783d    elif self.idx=
+00009530: 3d32 3a0a 2020 2020 2020 2020 2020 2020  =2:.            
+00009540: 7365 6c66 2e69 6478 3d33 0a20 2020 2020  self.idx=3.     
+00009550: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00009560: 6c66 2e6d 5b32 5d0a 2020 2020 2020 2020  lf.m[2].        
+00009570: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00009580: 2020 7261 6973 6520 5374 6f70 4974 6572    raise StopIter
+00009590: 6174 696f 6e0a 0a23 206d 6174 330a 6364  ation..# mat3.cd
+000095a0: 6566 2063 6c61 7373 206d 6174 333a 0a0a  ef class mat3:..
+000095b0: 2020 2020 6364 6566 2064 6f75 626c 6520      cdef double 
+000095c0: 6d31 312c 206d 3132 2c20 6d31 330a 2020  m11, m12, m13.  
+000095d0: 2020 6364 6566 2064 6f75 626c 6520 6d32    cdef double m2
+000095e0: 312c 206d 3232 2c20 6d32 330a 2020 2020  1, m22, m23.    
+000095f0: 6364 6566 2064 6f75 626c 6520 6d33 312c  cdef double m31,
+00009600: 206d 3332 2c20 6d33 330a 0a20 2020 2064   m32, m33..    d
+00009610: 6566 205f 5f63 696e 6974 5f5f 2873 656c  ef __cinit__(sel
+00009620: 662c 202a 6172 6773 293a 0a20 2020 2020  f, *args):.     
+00009630: 2020 2022 2222 436f 6e73 7472 7563 746f     """Constructo
+00009640: 722e 0a0a 2020 2020 2020 2020 5468 6572  r...        Ther
+00009650: 6520 6172 6520 7365 7665 7261 6c20 706f  e are several po
+00009660: 7373 6962 696c 6974 6965 7320 686f 7720  ssibilities how 
+00009670: 746f 2069 6e69 7469 616c 697a 6520 6120  to initialize a 
+00009680: 6d61 7472 6978 2c0a 2020 2020 2020 2020  matrix,.        
+00009690: 6465 7065 6e64 696e 6720 6f6e 2074 6865  depending on the
+000096a0: 206e 756d 6265 7220 6f66 2061 7267 756d   number of argum
+000096b0: 656e 7473 2079 6f75 2070 726f 7669 6465  ents you provide
+000096c0: 2074 6f20 7468 6520 636f 6e73 7472 7563   to the construc
+000096d0: 746f 722e 0a0a 2020 2020 2020 2020 2d20  tor...        - 
+000096e0: 3020 6172 6775 6d65 6e74 733a 2045 7665  0 arguments: Eve
+000096f0: 7279 2063 6f6d 706f 6e65 6e74 2069 7320  ry component is 
+00009700: 7a65 726f 2e0a 2020 2020 2020 2020 2d20  zero..        - 
+00009710: 3120 6e75 6d62 6572 2061 7267 756d 656e  1 number argumen
+00009720: 743a 2054 6865 2064 6961 676f 6e61 6c20  t: The diagonal 
+00009730: 6973 2069 6e69 7469 616c 697a 6564 2074  is initialized t
+00009740: 6f20 7468 6174 206e 756d 6265 722c 0a20  o that number,. 
+00009750: 2020 2020 2020 2020 2061 6c6c 2074 6865           all the
+00009760: 206f 7468 6572 2065 6c65 6d65 6e74 7320   other elements 
+00009770: 6172 6520 7a65 726f 2e0a 2020 2020 2020  are zero..      
+00009780: 2020 2d20 3120 7365 7175 656e 6365 2061    - 1 sequence a
+00009790: 7267 756d 656e 743a 2054 6865 2065 6c65  rgument: The ele
+000097a0: 6d65 6e74 7320 6172 6520 696e 6974 6961  ments are initia
+000097b0: 6c69 7a65 6420 7769 7468 2074 6865 206e  lized with the n
+000097c0: 756d 6265 7273 0a20 2020 2020 2020 2020  umbers.         
+000097d0: 2069 6e20 7468 6520 7365 7175 656e 6365   in the sequence
+000097e0: 2028 7468 6520 7365 7175 656e 6365 206d   (the sequence m
+000097f0: 7573 7420 636f 6e74 6169 6e20 3920 6e75  ust contain 9 nu
+00009800: 6d62 6572 7329 2e0a 2020 2020 2020 2020  mbers)..        
+00009810: 2d20 3120 6d61 7433 2061 7267 756d 656e  - 1 mat3 argumen
+00009820: 743a 2054 6865 206d 6174 7269 7820 6973  t: The matrix is
+00009830: 2063 6f70 6965 642e 0a20 2020 2020 2020   copied..       
+00009840: 202d 2033 2073 6571 7565 6e63 6520 6172   - 3 sequence ar
+00009850: 6775 6d65 6e74 733a 2054 6865 2063 6f6c  guments: The col
+00009860: 756d 6e73 2061 7265 2069 6e69 7469 616c  umns are initial
+00009870: 697a 6564 2077 6974 6820 7468 650a 2020  ized with the.  
+00009880: 2020 2020 2020 2020 7265 7370 6563 7469          respecti
+00009890: 7665 2073 6571 7565 6e63 6520 2865 6163  ve sequence (eac
+000098a0: 6820 7365 7175 656e 6365 206d 7573 7420  h sequence must 
+000098b0: 636f 6e74 6169 6e20 3320 6e75 6d62 6572  contain 3 number
+000098c0: 7329 2e0a 2020 2020 2020 2020 2d20 3920  s)..        - 9 
+000098d0: 6e75 6d62 6572 2061 7267 756d 656e 7473  number arguments
+000098e0: 3a20 5468 6520 6d61 7472 6978 2069 7320  : The matrix is 
+000098f0: 696e 6974 6961 6c69 7a65 6420 7769 7468  initialized with
+00009900: 2074 686f 7365 2076 616c 7565 730a 2020   those values.  
+00009910: 2020 2020 2020 2020 2872 6f77 2d6d 616a          (row-maj
+00009920: 6f72 206f 7264 6572 292e 0a20 2020 2020  or order)..     
+00009930: 2020 2022 2222 0a20 2020 2020 2020 2063     """.        c
+00009940: 6465 6620 696e 7420 6172 676c 656e 0a20  def int arglen. 
+00009950: 2020 2020 2020 2063 6465 6620 6d61 7433         cdef mat3
+00009960: 2042 0a20 2020 2020 2020 2061 7267 6c65   B.        argle
+00009970: 6e20 3d20 6c65 6e28 6172 6773 290a 0a20  n = len(args).. 
+00009980: 2020 2020 2020 2023 204e 6f20 6172 6775         # No argu
+00009990: 6d65 6e74 730a 2020 2020 2020 2020 6966  ments.        if
+000099a0: 2061 7267 6c65 6e3d 3d30 3a0a 2020 2020   arglen==0:.    
+000099b0: 2020 2020 2020 2020 6d31 313d 6d31 323d          m11=m12=
+000099c0: 6d31 333d 302e 300a 2020 2020 2020 2020  m13=0.0.        
+000099d0: 2020 2020 6d32 313d 6d32 323d 6d32 333d      m21=m22=m23=
+000099e0: 302e 300a 2020 2020 2020 2020 2020 2020  0.0.            
+000099f0: 6d33 313d 6d33 323d 6d33 333d 302e 300a  m31=m32=m33=0.0.
+00009a00: 0a20 2020 2020 2020 2023 2031 2061 7267  .        # 1 arg
+00009a10: 756d 656e 7420 286c 6973 742c 2073 6361  ument (list, sca
+00009a20: 6c61 7220 6f72 206d 6174 3329 0a20 2020  lar or mat3).   
+00009a30: 2020 2020 2065 6c69 6620 6172 676c 656e       elif arglen
+00009a40: 3d3d 313a 0a20 2020 2020 2020 2020 2020  ==1:.           
+00009a50: 2054 203d 2074 7970 6528 6172 6773 5b30   T = type(args[0
+00009a60: 5d29 0a20 2020 2020 2020 2020 2020 2023  ]).            #
+00009a70: 2073 6361 6c61 720a 2020 2020 2020 2020   scalar.        
+00009a80: 2020 2020 6966 2054 2069 7320 666c 6f61      if T is floa
+00009a90: 7420 6f72 2054 2069 7320 696e 7420 6f72  t or T is int or
+00009aa0: 2054 2069 7320 6c6f 6e67 3a0a 2020 2020   T is long:.    
+00009ab0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00009ac0: 2e6d 3131 203d 2061 7267 735b 305d 0a20  .m11 = args[0]. 
+00009ad0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00009ae0: 656c 662e 6d31 3220 3d20 302e 300a 2020  elf.m12 = 0.0.  
+00009af0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00009b00: 6c66 2e6d 3133 203d 2030 2e30 0a20 2020  lf.m13 = 0.0.   
+00009b10: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00009b20: 662e 6d32 3120 3d20 302e 300a 2020 2020  f.m21 = 0.0.    
+00009b30: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00009b40: 2e6d 3232 203d 2073 656c 662e 6d31 310a  .m22 = self.m11.
+00009b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009b60: 7365 6c66 2e6d 3233 203d 2030 2e30 0a20  self.m23 = 0.0. 
+00009b70: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00009b80: 656c 662e 6d33 3120 3d20 302e 300a 2020  elf.m31 = 0.0.  
+00009b90: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00009ba0: 6c66 2e6d 3332 203d 2030 2e30 0a20 2020  lf.m32 = 0.0.   
+00009bb0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00009bc0: 662e 6d33 3320 3d20 7365 6c66 2e6d 3131  f.m33 = self.m11
+00009bd0: 0a0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
+00009be0: 6d61 7433 0a20 2020 2020 2020 2020 2020  mat3.           
+00009bf0: 2065 6c69 6620 5420 6973 206d 6174 333a   elif T is mat3:
+00009c00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00009c10: 2042 203d 2061 7267 735b 305d 0a20 2020   B = args[0].   
+00009c20: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00009c30: 662e 6d31 3120 3d20 422e 6d31 310a 2020  f.m11 = B.m11.  
+00009c40: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00009c50: 6c66 2e6d 3132 203d 2042 2e6d 3132 0a20  lf.m12 = B.m12. 
+00009c60: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00009c70: 656c 662e 6d31 3320 3d20 422e 6d31 330a  elf.m13 = B.m13.
+00009c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009c90: 7365 6c66 2e6d 3231 203d 2042 2e6d 3231  self.m21 = B.m21
+00009ca0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00009cb0: 2073 656c 662e 6d32 3220 3d20 422e 6d32   self.m22 = B.m2
+00009cc0: 320a 2020 2020 2020 2020 2020 2020 2020  2.              
+00009cd0: 2020 7365 6c66 2e6d 3233 203d 2042 2e6d    self.m23 = B.m
+00009ce0: 3233 0a20 2020 2020 2020 2020 2020 2020  23.             
+00009cf0: 2020 2073 656c 662e 6d33 3120 3d20 422e     self.m31 = B.
+00009d00: 6d33 310a 2020 2020 2020 2020 2020 2020  m31.            
+00009d10: 2020 2020 7365 6c66 2e6d 3332 203d 2042      self.m32 = B
+00009d20: 2e6d 3332 0a20 2020 2020 2020 2020 2020  .m32.           
+00009d30: 2020 2020 2073 656c 662e 6d33 3320 3d20       self.m33 = 
+00009d40: 422e 6d33 330a 2020 2020 2020 2020 2020  B.m33.          
+00009d50: 2020 2320 5374 7269 6e67 0a20 2020 2020    # String.     
+00009d60: 2020 2020 2020 2065 6c69 6620 5420 6973         elif T is
+00009d70: 2073 7472 206f 7220 5420 6973 2075 6e69   str or T is uni
+00009d80: 636f 6465 3a0a 2020 2020 2020 2020 2020  code:.          
+00009d90: 2020 2020 2020 733d 6172 6773 5b30 5d2e        s=args[0].
+00009da0: 7265 706c 6163 6528 222c 222c 2220 2229  replace(","," ")
+00009db0: 2e72 6570 6c61 6365 2822 2020 222c 2220  .replace("  "," 
+00009dc0: 2229 2e73 7472 6970 2829 2e73 706c 6974  ").strip().split
+00009dd0: 2822 2022 290a 2020 2020 2020 2020 2020  (" ").          
+00009de0: 2020 2020 2020 6966 2073 3d3d 5b22 225d        if s==[""]
+00009df0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00009e00: 2020 2020 2020 733d 5b5d 0a20 2020 2020        s=[].     
+00009e10: 2020 2020 2020 2020 2020 2066 6f72 2069             for i
+00009e20: 2069 6e20 7261 6e67 6528 6c65 6e28 7329   in range(len(s)
+00009e30: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+00009e40: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
+00009e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009e60: 2020 2020 735b 695d 203d 2066 6c6f 6174      s[i] = float
+00009e70: 2873 5b69 5d29 0a20 2020 2020 2020 2020  (s[i]).         
+00009e80: 2020 2020 2020 2020 2020 2065 7863 6570             excep
+00009e90: 743a 0a20 2020 2020 2020 2020 2020 2020  t:.             
+00009ea0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00009eb0: 2056 616c 7565 4572 726f 722c 226d 6174   ValueError,"mat
+00009ec0: 3328 2920 6172 6720 6973 2061 206d 616c  3() arg is a mal
+00009ed0: 666f 726d 6564 2073 7472 696e 6722 0a20  formed string". 
+00009ee0: 2020 2020 2020 2020 2020 2020 2020 2042                 B
+00009ef0: 203d 206d 6174 3328 7329 0a20 2020 2020   = mat3(s).     
+00009f00: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00009f10: 6d31 3120 3d20 422e 6d31 310a 2020 2020  m11 = B.m11.    
+00009f20: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00009f30: 2e6d 3132 203d 2042 2e6d 3132 0a20 2020  .m12 = B.m12.   
+00009f40: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00009f50: 662e 6d31 3320 3d20 422e 6d31 330a 2020  f.m13 = B.m13.  
+00009f60: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00009f70: 6c66 2e6d 3231 203d 2042 2e6d 3231 0a20  lf.m21 = B.m21. 
+00009f80: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00009f90: 656c 662e 6d32 3220 3d20 422e 6d32 320a  elf.m22 = B.m22.
+00009fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009fb0: 7365 6c66 2e6d 3233 203d 2042 2e6d 3233  self.m23 = B.m23
+00009fc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00009fd0: 2073 656c 662e 6d33 3120 3d20 422e 6d33   self.m31 = B.m3
+00009fe0: 310a 2020 2020 2020 2020 2020 2020 2020  1.              
+00009ff0: 2020 7365 6c66 2e6d 3332 203d 2042 2e6d    self.m32 = B.m
+0000a000: 3332 0a20 2020 2020 2020 2020 2020 2020  32.             
+0000a010: 2020 2073 656c 662e 6d33 3320 3d20 422e     self.m33 = B.
+0000a020: 6d33 330a 2020 2020 2020 2020 2020 2020  m33.            
+0000a030: 2320 5365 7175 656e 6365 206f 6620 3920  # Sequence of 9 
+0000a040: 666c 6f61 7473 0a20 2020 2020 2020 2020  floats.         
+0000a050: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0000a060: 2020 2020 2020 2020 2073 6571 203d 2061           seq = a
+0000a070: 7267 735b 305d 0a20 2020 2020 2020 2020  rgs[0].         
+0000a080: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
+0000a090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a0a0: 7365 716c 656e 203d 206c 656e 2873 6571  seqlen = len(seq
+0000a0b0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0000a0c0: 2020 6578 6365 7074 3a0a 2020 2020 2020    except:.      
+0000a0d0: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+0000a0e0: 6973 6520 5479 7065 4572 726f 722c 226d  ise TypeError,"m
+0000a0f0: 6174 3328 2920 6172 6720 6361 6e27 7420  at3() arg can't 
+0000a100: 6265 2063 6f6e 7665 7274 6564 2074 6f20  be converted to 
+0000a110: 6d61 7433 220a 0a20 2020 2020 2020 2020  mat3"..         
+0000a120: 2020 2020 2020 2069 6620 7365 716c 656e         if seqlen
+0000a130: 3d3d 393a 0a20 2020 2020 2020 2020 2020  ==9:.           
+0000a140: 2020 2020 2020 2020 2073 656c 662e 6d31           self.m1
+0000a150: 3120 3d20 7365 715b 305d 0a20 2020 2020  1 = seq[0].     
+0000a160: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0000a170: 656c 662e 6d31 3220 3d20 7365 715b 315d  elf.m12 = seq[1]
+0000a180: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000a190: 2020 2020 2073 656c 662e 6d31 3320 3d20       self.m13 = 
+0000a1a0: 7365 715b 325d 0a20 2020 2020 2020 2020  seq[2].         
+0000a1b0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0000a1c0: 6d32 3120 3d20 7365 715b 335d 0a20 2020  m21 = seq[3].   
+0000a1d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a1e0: 2073 656c 662e 6d32 3220 3d20 7365 715b   self.m22 = seq[
+0000a1f0: 345d 0a20 2020 2020 2020 2020 2020 2020  4].             
+0000a200: 2020 2020 2020 2073 656c 662e 6d32 3320         self.m23 
+0000a210: 3d20 7365 715b 355d 0a20 2020 2020 2020  = seq[5].       
+0000a220: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0000a230: 662e 6d33 3120 3d20 7365 715b 365d 0a20  f.m31 = seq[6]. 
+0000a240: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a250: 2020 2073 656c 662e 6d33 3220 3d20 7365     self.m32 = se
+0000a260: 715b 375d 0a20 2020 2020 2020 2020 2020  q[7].           
+0000a270: 2020 2020 2020 2020 2073 656c 662e 6d33           self.m3
+0000a280: 3320 3d20 7365 715b 385d 0a20 2020 2020  3 = seq[8].     
+0000a290: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
+0000a2a0: 7365 716c 656e 3d3d 333a 0a20 2020 2020  seqlen==3:.     
+0000a2b0: 2020 2020 2020 2020 2020 2020 2020 2062                 b
+0000a2c0: 203d 2073 6571 5b30 5d0a 2020 2020 2020   = seq[0].      
+0000a2d0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0000a2e0: 6c66 2e6d 3131 203d 2062 5b30 5d0a 2020  lf.m11 = b[0].  
+0000a2f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a300: 2020 7365 6c66 2e6d 3231 203d 2062 5b31    self.m21 = b[1
+0000a310: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+0000a320: 2020 2020 2020 7365 6c66 2e6d 3331 203d        self.m31 =
+0000a330: 2062 5b32 5d0a 2020 2020 2020 2020 2020   b[2].          
+0000a340: 2020 2020 2020 2020 2020 6220 3d20 7365            b = se
+0000a350: 715b 315d 0a20 2020 2020 2020 2020 2020  q[1].           
+0000a360: 2020 2020 2020 2020 2073 656c 662e 6d31           self.m1
+0000a370: 3220 3d20 625b 305d 0a20 2020 2020 2020  2 = b[0].       
+0000a380: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0000a390: 662e 6d32 3220 3d20 625b 315d 0a20 2020  f.m22 = b[1].   
+0000a3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a3b0: 2073 656c 662e 6d33 3220 3d20 625b 325d   self.m32 = b[2]
+0000a3c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000a3d0: 2020 2020 2062 203d 2073 6571 5b32 5d0a       b = seq[2].
+0000a3e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a3f0: 2020 2020 7365 6c66 2e6d 3133 203d 2062      self.m13 = b
+0000a400: 5b30 5d0a 2020 2020 2020 2020 2020 2020  [0].            
+0000a410: 2020 2020 2020 2020 7365 6c66 2e6d 3233          self.m23
+0000a420: 203d 2062 5b31 5d0a 2020 2020 2020 2020   = b[1].        
+0000a430: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0000a440: 2e6d 3333 203d 2062 5b32 5d0a 2020 2020  .m33 = b[2].    
+0000a450: 2020 2020 2020 2020 2020 2020 656c 7365              else
+0000a460: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0000a470: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
+0000a480: 4572 726f 722c 2022 6d61 7433 2829 2074  Error, "mat3() t
+0000a490: 616b 6573 2061 7420 6d6f 7374 2039 2061  akes at most 9 a
+0000a4a0: 7267 756d 656e 7473 220a 0a20 2020 2020  rguments"..     
+0000a4b0: 2020 2023 2033 2061 7267 756d 656e 7473     # 3 arguments
+0000a4c0: 2028 636f 6c75 6d6e 7320 6173 2073 6571   (columns as seq
+0000a4d0: 7565 6e63 6573 290a 2020 2020 2020 2020  uences).        
+0000a4e0: 656c 6966 2061 7267 6c65 6e3d 3d33 3a0a  elif arglen==3:.
+0000a4f0: 2020 2020 2020 2020 2020 2020 612c 622c              a,b,
+0000a500: 633d 6172 6773 0a20 2020 2020 2020 2020  c=args.         
+0000a510: 2020 2073 656c 662e 6d31 3120 3d20 615b     self.m11 = a[
+0000a520: 305d 0a20 2020 2020 2020 2020 2020 2073  0].            s
+0000a530: 656c 662e 6d31 3220 3d20 625b 305d 0a20  elf.m12 = b[0]. 
+0000a540: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0000a550: 6d31 3320 3d20 635b 305d 0a20 2020 2020  m13 = c[0].     
+0000a560: 2020 2020 2020 2073 656c 662e 6d32 3120         self.m21 
+0000a570: 3d20 615b 315d 0a20 2020 2020 2020 2020  = a[1].         
+0000a580: 2020 2073 656c 662e 6d32 3220 3d20 625b     self.m22 = b[
+0000a590: 315d 0a20 2020 2020 2020 2020 2020 2073  1].            s
+0000a5a0: 656c 662e 6d32 3320 3d20 635b 315d 0a20  elf.m23 = c[1]. 
+0000a5b0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0000a5c0: 6d33 3120 3d20 615b 325d 0a20 2020 2020  m31 = a[2].     
+0000a5d0: 2020 2020 2020 2073 656c 662e 6d33 3220         self.m32 
+0000a5e0: 3d20 625b 325d 0a20 2020 2020 2020 2020  = b[2].         
+0000a5f0: 2020 2073 656c 662e 6d33 3320 3d20 635b     self.m33 = c[
+0000a600: 325d 0a0a 2020 2020 2020 2020 2320 3920  2]..        # 9 
+0000a610: 6172 6775 6d65 6e74 730a 2020 2020 2020  arguments.      
+0000a620: 2020 656c 6966 2061 7267 6c65 6e3d 3d39    elif arglen==9
+0000a630: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
+0000a640: 6c66 2e6d 3131 203d 2061 7267 735b 305d  lf.m11 = args[0]
+0000a650: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0000a660: 662e 6d31 3220 3d20 6172 6773 5b31 5d0a  f.m12 = args[1].
+0000a670: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0000a680: 2e6d 3133 203d 2061 7267 735b 325d 0a20  .m13 = args[2]. 
+0000a690: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0000a6a0: 6d32 3120 3d20 6172 6773 5b33 5d0a 2020  m21 = args[3].  
+0000a6b0: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+0000a6c0: 3232 203d 2061 7267 735b 345d 0a20 2020  22 = args[4].   
+0000a6d0: 2020 2020 2020 2020 2073 656c 662e 6d32           self.m2
+0000a6e0: 3320 3d20 6172 6773 5b35 5d0a 2020 2020  3 = args[5].    
+0000a6f0: 2020 2020 2020 2020 7365 6c66 2e6d 3331          self.m31
+0000a700: 203d 2061 7267 735b 365d 0a20 2020 2020   = args[6].     
+0000a710: 2020 2020 2020 2073 656c 662e 6d33 3220         self.m32 
+0000a720: 3d20 6172 6773 5b37 5d0a 2020 2020 2020  = args[7].      
+0000a730: 2020 2020 2020 7365 6c66 2e6d 3333 203d        self.m33 =
+0000a740: 2061 7267 735b 385d 0a0a 2020 2020 2020   args[8]..      
+0000a750: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+0000a760: 2020 2020 7261 6973 6520 5479 7065 4572      raise TypeEr
+0000a770: 726f 722c 226d 6174 3328 2920 6172 6720  ror,"mat3() arg 
+0000a780: 6361 6e27 7420 6265 2063 6f6e 7665 7274  can't be convert
+0000a790: 6564 2074 6f20 6d61 7433 220a 0a20 2020  ed to mat3"..   
+0000a7a0: 2064 6566 205f 5f72 6564 7563 655f 5f28   def __reduce__(
+0000a7b0: 7365 6c66 293a 0a20 2020 2020 2020 2072  self):.        r
+0000a7c0: 6574 7572 6e20 285f 6d61 7433 636f 6e73  eturn (_mat3cons
+0000a7d0: 7472 7563 742c 2028 7365 6c66 5b30 5d2c  truct, (self[0],
+0000a7e0: 2073 656c 665b 315d 2c20 7365 6c66 5b32   self[1], self[2
+0000a7f0: 5d29 290a 0a20 2020 2064 6566 205f 5f72  ]))..    def __r
+0000a800: 6570 725f 5f28 7365 6c66 293a 0a20 2020  epr__(self):.   
+0000a810: 2020 2020 2072 6574 7572 6e20 276d 6174       return 'mat
+0000a820: 3328 2573 2c20 2573 2c20 2573 2c20 2573  3(%s, %s, %s, %s
+0000a830: 2c20 2573 2c20 2573 2c20 2573 2c20 2573  , %s, %s, %s, %s
+0000a840: 2c20 2573 2927 2528 0a20 2020 2020 2020  , %s)'%(.       
+0000a850: 2020 2020 2072 6570 7228 7365 6c66 2e6d       repr(self.m
+0000a860: 3131 292c 7265 7072 2873 656c 662e 6d31  11),repr(self.m1
+0000a870: 3229 2c72 6570 7228 7365 6c66 2e6d 3133  2),repr(self.m13
+0000a880: 292c 0a20 2020 2020 2020 2020 2020 2072  ),.            r
+0000a890: 6570 7228 7365 6c66 2e6d 3231 292c 7265  epr(self.m21),re
+0000a8a0: 7072 2873 656c 662e 6d32 3229 2c72 6570  pr(self.m22),rep
+0000a8b0: 7228 7365 6c66 2e6d 3233 292c 0a20 2020  r(self.m23),.   
+0000a8c0: 2020 2020 2020 2020 2072 6570 7228 7365           repr(se
+0000a8d0: 6c66 2e6d 3331 292c 7265 7072 2873 656c  lf.m31),repr(sel
+0000a8e0: 662e 6d33 3229 2c72 6570 7228 7365 6c66  f.m32),repr(self
+0000a8f0: 2e6d 3333 2929 0a0a 2020 2020 6465 6620  .m33))..    def 
+0000a900: 5f5f 7374 725f 5f28 7365 6c66 293a 0a20  __str__(self):. 
+0000a910: 2020 2020 2020 2072 6574 7572 6e20 225b         return "[
+0000a920: 2539 2e34 662c 2025 392e 3466 2c20 2539  %9.4f, %9.4f, %9
+0000a930: 2e34 665d 5c6e 5b25 392e 3466 2c20 2539  .4f]\n[%9.4f, %9
+0000a940: 2e34 662c 2025 392e 3466 5d5c 6e5b 2539  .4f, %9.4f]\n[%9
+0000a950: 2e34 662c 2025 392e 3466 2c20 2539 2e34  .4f, %9.4f, %9.4
+0000a960: 665d 2225 280a 2020 2020 2020 2020 2020  f]"%(.          
+0000a970: 2020 7365 6c66 2e6d 3131 2c20 7365 6c66    self.m11, self
+0000a980: 2e6d 3132 2c20 7365 6c66 2e6d 3133 2c0a  .m12, self.m13,.
+0000a990: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0000a9a0: 2e6d 3231 2c20 7365 6c66 2e6d 3232 2c20  .m21, self.m22, 
+0000a9b0: 7365 6c66 2e6d 3233 2c0a 2020 2020 2020  self.m23,.      
+0000a9c0: 2020 2020 2020 7365 6c66 2e6d 3331 2c20        self.m31, 
+0000a9d0: 7365 6c66 2e6d 3332 2c20 7365 6c66 2e6d  self.m32, self.m
+0000a9e0: 3333 290a 0a20 2020 2064 6566 205f 5f69  33)..    def __i
+0000a9f0: 7465 725f 5f28 7365 6c66 293a 0a20 2020  ter__(self):.   
+0000aa00: 2020 2020 2072 6574 7572 6e20 6d61 7433       return mat3
+0000aa10: 6974 6572 2873 656c 6629 0a0a 2020 2020  iter(self)..    
+0000aa20: 6465 6620 5f5f 7269 6368 636d 705f 5f28  def __richcmp__(
+0000aa30: 612c 622c 6f70 293a 0a20 2020 2020 2020  a,b,op):.       
+0000aa40: 2063 6465 6620 6d61 7433 206d 612c 206d   cdef mat3 ma, m
+0000aa50: 620a 2020 2020 2020 2020 6364 6566 2069  b.        cdef i
+0000aa60: 6e74 2063 6f70 0a0a 2020 2020 2020 2020  nt cop..        
+0000aa70: 636f 7020 3d20 6f70 0a0a 2020 2020 2020  cop = op..      
+0000aa80: 2020 7461 203d 2074 7970 6528 6129 0a20    ta = type(a). 
+0000aa90: 2020 2020 2020 2074 6220 3d20 7479 7065         tb = type
+0000aaa0: 2862 290a 2020 2020 2020 2020 6966 2028  (b).        if (
+0000aab0: 7461 213d 6d61 7433 206f 7220 7462 213d  ta!=mat3 or tb!=
+0000aac0: 6d61 7433 293a 0a20 2020 2020 2020 2020  mat3):.         
+0000aad0: 2020 2069 6620 636f 703d 3d33 3a0a 2020     if cop==3:.  
+0000aae0: 2020 2020 2020 2020 2020 2020 2020 7265                re
+0000aaf0: 7475 726e 2031 0a20 2020 2020 2020 2020  turn 1.         
+0000ab00: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0000ab10: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+0000ab20: 300a 0a20 2020 2020 2020 206d 6120 3d20  0..        ma = 
+0000ab30: 610a 2020 2020 2020 2020 6d62 203d 2062  a.        mb = b
+0000ab40: 0a0a 2020 2020 2020 2020 2320 3c0a 2020  ..        # <.  
+0000ab50: 2020 2020 2020 6966 2063 6f70 3d3d 303a        if cop==0:
+0000ab60: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+0000ab70: 7572 6e20 300a 2020 2020 2020 2020 2320  urn 0.        # 
+0000ab80: 3c3d 0a20 2020 2020 2020 2065 6c69 6620  <=.        elif 
+0000ab90: 636f 703d 3d31 3a0a 2020 2020 2020 2020  cop==1:.        
+0000aba0: 2020 2020 7265 7475 726e 2030 0a20 2020      return 0.   
+0000abb0: 2020 2020 2023 203d 3d0a 2020 2020 2020       # ==.      
+0000abc0: 2020 656c 6966 2063 6f70 3d3d 323a 0a20    elif cop==2:. 
+0000abd0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0000abe0: 6e20 2866 6162 7328 6d61 2e6d 3131 2d6d  n (fabs(ma.m11-m
+0000abf0: 622e 6d31 3129 3c3d 6570 7320 616e 6420  b.m11)<=eps and 
+0000ac00: 6661 6273 286d 612e 6d31 322d 6d62 2e6d  fabs(ma.m12-mb.m
+0000ac10: 3132 293c 3d65 7073 2061 6e64 0a20 2020  12)<=eps and.   
+0000ac20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ac30: 2066 6162 7328 6d61 2e6d 3133 2d6d 622e   fabs(ma.m13-mb.
+0000ac40: 6d31 3329 3c3d 6570 7320 616e 640a 2020  m13)<=eps and.  
+0000ac50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ac60: 2020 6661 6273 286d 612e 6d32 312d 6d62    fabs(ma.m21-mb
+0000ac70: 2e6d 3231 293c 3d65 7073 2061 6e64 2066  .m21)<=eps and f
+0000ac80: 6162 7328 6d61 2e6d 3232 2d6d 622e 6d32  abs(ma.m22-mb.m2
+0000ac90: 3229 3c3d 6570 7320 616e 640a 2020 2020  2)<=eps and.    
+0000aca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000acb0: 6661 6273 286d 612e 6d32 332d 6d62 2e6d  fabs(ma.m23-mb.m
+0000acc0: 3233 293c 3d65 7073 2061 6e64 0a20 2020  23)<=eps and.   
+0000acd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ace0: 2066 6162 7328 6d61 2e6d 3331 2d6d 622e   fabs(ma.m31-mb.
+0000acf0: 6d33 3129 3c3d 6570 7320 616e 6420 6661  m31)<=eps and fa
+0000ad00: 6273 286d 612e 6d33 322d 6d62 2e6d 3332  bs(ma.m32-mb.m32
+0000ad10: 293c 3d65 7073 2061 6e64 0a20 2020 2020  )<=eps and.     
+0000ad20: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0000ad30: 6162 7328 6d61 2e6d 3333 2d6d 622e 6d33  abs(ma.m33-mb.m3
+0000ad40: 3329 3c3d 6570 7329 0a20 2020 2020 2020  3)<=eps).       
+0000ad50: 2023 2021 3d0a 2020 2020 2020 2020 656c   # !=.        el
+0000ad60: 6966 2063 6f70 3d3d 333a 0a20 2020 2020  if cop==3:.     
+0000ad70: 2020 2020 2020 2072 6574 7572 6e20 2866         return (f
+0000ad80: 6162 7328 6d61 2e6d 3131 2d6d 622e 6d31  abs(ma.m11-mb.m1
+0000ad90: 3129 3e65 7073 206f 7220 6661 6273 286d  1)>eps or fabs(m
+0000ada0: 612e 6d31 322d 6d62 2e6d 3132 293e 6570  a.m12-mb.m12)>ep
+0000adb0: 7320 6f72 0a20 2020 2020 2020 2020 2020  s or.           
+0000adc0: 2020 2020 2020 2020 2066 6162 7328 6d61           fabs(ma
+0000add0: 2e6d 3133 2d6d 622e 6d31 3329 3e65 7073  .m13-mb.m13)>eps
+0000ade0: 206f 720a 2020 2020 2020 2020 2020 2020   or.            
+0000adf0: 2020 2020 2020 2020 6661 6273 286d 612e          fabs(ma.
+0000ae00: 6d32 312d 6d62 2e6d 3231 293e 6570 7320  m21-mb.m21)>eps 
+0000ae10: 6f72 2066 6162 7328 6d61 2e6d 3232 2d6d  or fabs(ma.m22-m
+0000ae20: 622e 6d32 3229 3e65 7073 206f 720a 2020  b.m22)>eps or.  
+0000ae30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ae40: 2020 6661 6273 286d 612e 6d32 332d 6d62    fabs(ma.m23-mb
+0000ae50: 2e6d 3233 293e 6570 7320 6f72 0a20 2020  .m23)>eps or.   
+0000ae60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ae70: 2066 6162 7328 6d61 2e6d 3331 2d6d 622e   fabs(ma.m31-mb.
+0000ae80: 6d33 3129 3e65 7073 206f 7220 6661 6273  m31)>eps or fabs
+0000ae90: 286d 612e 6d33 322d 6d62 2e6d 3332 293e  (ma.m32-mb.m32)>
+0000aea0: 6570 7320 6f72 0a20 2020 2020 2020 2020  eps or.         
+0000aeb0: 2020 2020 2020 2020 2020 2066 6162 7328             fabs(
+0000aec0: 6d61 2e6d 3333 2d6d 622e 6d33 3329 3e65  ma.m33-mb.m33)>e
+0000aed0: 7073 290a 2020 2020 2020 2020 2320 3e0a  ps).        # >.
+0000aee0: 2020 2020 2020 2020 656c 6966 2063 6f70          elif cop
+0000aef0: 3d3d 343a 0a20 2020 2020 2020 2020 2020  ==4:.           
+0000af00: 2072 6574 7572 6e20 300a 2020 2020 2020   return 0.      
+0000af10: 2020 2320 3e3d 0a20 2020 2020 2020 2065    # >=.        e
+0000af20: 6c69 6620 636f 703d 3d35 3a0a 2020 2020  lif cop==5:.    
+0000af30: 2020 2020 2020 2020 7265 7475 726e 2030          return 0
+0000af40: 0a20 2020 2020 2020 2023 2073 6f6e 7374  .        # sonst
+0000af50: 2028 4665 686c 6572 290a 2020 2020 2020   (Fehler).      
+0000af60: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+0000af70: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+0000af80: 7272 6f72 2c22 696e 7465 726e 616c 2065  rror,"internal e
+0000af90: 7272 6f72 3a20 696c 6c65 6761 6c20 7269  rror: illegal ri
+0000afa0: 6368 2063 6f6d 7061 7269 736f 6e20 6e75  ch comparison nu
+0000afb0: 6d62 6572 220a 0a0a 2020 2020 6465 6620  mber"...    def 
+0000afc0: 5f5f 6164 645f 5f28 6d61 7433 2061 2c20  __add__(mat3 a, 
+0000afd0: 6d61 7433 2062 293a 0a20 2020 2020 2020  mat3 b):.       
+0000afe0: 2022 2222 4d61 7472 6978 2061 6464 6974   """Matrix addit
+0000aff0: 696f 6e2e 0a20 2020 2020 2020 2022 2222  ion..        """
+0000b000: 0a20 2020 2020 2020 2063 6465 6620 6d61  .        cdef ma
+0000b010: 7433 2072 6573 0a20 2020 2020 2020 2072  t3 res.        r
+0000b020: 6573 203d 206d 6174 3328 290a 2020 2020  es = mat3().    
+0000b030: 2020 2020 7265 732e 6d31 3120 3d20 612e      res.m11 = a.
+0000b040: 6d31 3120 2b20 622e 6d31 310a 2020 2020  m11 + b.m11.    
+0000b050: 2020 2020 7265 732e 6d31 3220 3d20 612e      res.m12 = a.
+0000b060: 6d31 3220 2b20 622e 6d31 320a 2020 2020  m12 + b.m12.    
+0000b070: 2020 2020 7265 732e 6d31 3320 3d20 612e      res.m13 = a.
+0000b080: 6d31 3320 2b20 622e 6d31 330a 2020 2020  m13 + b.m13.    
+0000b090: 2020 2020 7265 732e 6d32 3120 3d20 612e      res.m21 = a.
+0000b0a0: 6d32 3120 2b20 622e 6d32 310a 2020 2020  m21 + b.m21.    
+0000b0b0: 2020 2020 7265 732e 6d32 3220 3d20 612e      res.m22 = a.
+0000b0c0: 6d32 3220 2b20 622e 6d32 320a 2020 2020  m22 + b.m22.    
+0000b0d0: 2020 2020 7265 732e 6d32 3320 3d20 612e      res.m23 = a.
+0000b0e0: 6d32 3320 2b20 622e 6d32 330a 2020 2020  m23 + b.m23.    
+0000b0f0: 2020 2020 7265 732e 6d33 3120 3d20 612e      res.m31 = a.
+0000b100: 6d33 3120 2b20 622e 6d33 310a 2020 2020  m31 + b.m31.    
+0000b110: 2020 2020 7265 732e 6d33 3220 3d20 612e      res.m32 = a.
+0000b120: 6d33 3220 2b20 622e 6d33 320a 2020 2020  m32 + b.m32.    
+0000b130: 2020 2020 7265 732e 6d33 3320 3d20 612e      res.m33 = a.
+0000b140: 6d33 3320 2b20 622e 6d33 330a 2020 2020  m33 + b.m33.    
+0000b150: 2020 2020 7265 7475 726e 2072 6573 0a0a      return res..
+0000b160: 2020 2020 6465 6620 5f5f 7375 625f 5f28      def __sub__(
+0000b170: 6d61 7433 2061 2c20 6d61 7433 2062 293a  mat3 a, mat3 b):
+0000b180: 0a20 2020 2020 2020 2022 2222 4d61 7472  .        """Matr
+0000b190: 6978 2073 7562 7472 6163 7469 6f6e 2e0a  ix subtraction..
+0000b1a0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0000b1b0: 2020 2020 6364 6566 206d 6174 3320 7265      cdef mat3 re
+0000b1c0: 730a 2020 2020 2020 2020 7265 7320 3d20  s.        res = 
+0000b1d0: 6d61 7433 2829 0a20 2020 2020 2020 2072  mat3().        r
+0000b1e0: 6573 2e6d 3131 203d 2061 2e6d 3131 202d  es.m11 = a.m11 -
+0000b1f0: 2062 2e6d 3131 0a20 2020 2020 2020 2072   b.m11.        r
+0000b200: 6573 2e6d 3132 203d 2061 2e6d 3132 202d  es.m12 = a.m12 -
+0000b210: 2062 2e6d 3132 0a20 2020 2020 2020 2072   b.m12.        r
+0000b220: 6573 2e6d 3133 203d 2061 2e6d 3133 202d  es.m13 = a.m13 -
+0000b230: 2062 2e6d 3133 0a20 2020 2020 2020 2072   b.m13.        r
+0000b240: 6573 2e6d 3231 203d 2061 2e6d 3231 202d  es.m21 = a.m21 -
+0000b250: 2062 2e6d 3231 0a20 2020 2020 2020 2072   b.m21.        r
+0000b260: 6573 2e6d 3232 203d 2061 2e6d 3232 202d  es.m22 = a.m22 -
+0000b270: 2062 2e6d 3232 0a20 2020 2020 2020 2072   b.m22.        r
+0000b280: 6573 2e6d 3233 203d 2061 2e6d 3233 202d  es.m23 = a.m23 -
+0000b290: 2062 2e6d 3233 0a20 2020 2020 2020 2072   b.m23.        r
+0000b2a0: 6573 2e6d 3331 203d 2061 2e6d 3331 202d  es.m31 = a.m31 -
+0000b2b0: 2062 2e6d 3331 0a20 2020 2020 2020 2072   b.m31.        r
+0000b2c0: 6573 2e6d 3332 203d 2061 2e6d 3332 202d  es.m32 = a.m32 -
+0000b2d0: 2062 2e6d 3332 0a20 2020 2020 2020 2072   b.m32.        r
+0000b2e0: 6573 2e6d 3333 203d 2061 2e6d 3333 202d  es.m33 = a.m33 -
+0000b2f0: 2062 2e6d 3333 0a20 2020 2020 2020 2072   b.m33.        r
+0000b300: 6574 7572 6e20 7265 730a 0a20 2020 2064  eturn res..    d
+0000b310: 6566 205f 5f6d 756c 5f5f 2861 2c20 6229  ef __mul__(a, b)
+0000b320: 3a0a 2020 2020 2020 2020 2222 224d 756c  :.        """Mul
+0000b330: 7469 706c 6963 6174 696f 6e2e 0a20 2020  tiplication..   
+0000b340: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0000b350: 2063 6465 6620 6d61 7433 206d 612c 206d   cdef mat3 ma, m
+0000b360: 622c 2072 6573 0a20 2020 2020 2020 2063  b, res.        c
+0000b370: 6465 6620 7665 6333 2076 612c 2076 622c  def vec3 va, vb,
+0000b380: 2076 7265 730a 2020 2020 2020 2020 6364   vres.        cd
+0000b390: 6566 2064 6f75 626c 6520 720a 0a20 2020  ef double r..   
+0000b3a0: 2020 2020 2074 6120 3d20 7479 7065 2861       ta = type(a
+0000b3b0: 290a 2020 2020 2020 2020 7462 203d 2074  ).        tb = t
+0000b3c0: 7970 6528 6229 0a0a 2020 2020 2020 2020  ype(b)..        
+0000b3d0: 2320 6d61 7433 206f 6e20 7468 6520 6c65  # mat3 on the le
+0000b3e0: 6674 3f0a 2020 2020 2020 2020 6966 2074  ft?.        if t
+0000b3f0: 6120 6973 206d 6174 333a 0a20 2020 2020  a is mat3:.     
+0000b400: 2020 2020 2020 206d 6120 3d20 610a 2020         ma = a.  
+0000b410: 2020 2020 2020 2020 2020 2320 6d61 7433            # mat3
+0000b420: 206f 6e20 7468 6520 7269 6768 743f 0a20   on the right?. 
+0000b430: 2020 2020 2020 2020 2020 2069 6620 7462             if tb
+0000b440: 2069 7320 6d61 7433 3a0a 2020 2020 2020   is mat3:.      
+0000b450: 2020 2020 2020 2020 2020 2320 6d61 7433            # mat3
+0000b460: 2a6d 6174 330a 2020 2020 2020 2020 2020  *mat3.          
+0000b470: 2020 2020 2020 7265 7320 3d20 6d61 7433        res = mat3
+0000b480: 2829 0a20 2020 2020 2020 2020 2020 2020  ().             
+0000b490: 2020 206d 6220 3d20 620a 2020 2020 2020     mb = b.      
+0000b4a0: 2020 2020 2020 2020 2020 7265 732e 6d31            res.m1
+0000b4b0: 3120 3d20 6d61 2e6d 3131 2a6d 622e 6d31  1 = ma.m11*mb.m1
+0000b4c0: 312b 6d61 2e6d 3132 2a6d 622e 6d32 312b  1+ma.m12*mb.m21+
+0000b4d0: 6d61 2e6d 3133 2a6d 622e 6d33 310a 2020  ma.m13*mb.m31.  
+0000b4e0: 2020 2020 2020 2020 2020 2020 2020 7265                re
+0000b4f0: 732e 6d31 3220 3d20 6d61 2e6d 3131 2a6d  s.m12 = ma.m11*m
+0000b500: 622e 6d31 322b 6d61 2e6d 3132 2a6d 622e  b.m12+ma.m12*mb.
+0000b510: 6d32 322b 6d61 2e6d 3133 2a6d 622e 6d33  m22+ma.m13*mb.m3
+0000b520: 320a 2020 2020 2020 2020 2020 2020 2020  2.              
+0000b530: 2020 7265 732e 6d31 3320 3d20 6d61 2e6d    res.m13 = ma.m
+0000b540: 3131 2a6d 622e 6d31 332b 6d61 2e6d 3132  11*mb.m13+ma.m12
+0000b550: 2a6d 622e 6d32 332b 6d61 2e6d 3133 2a6d  *mb.m23+ma.m13*m
+0000b560: 622e 6d33 330a 2020 2020 2020 2020 2020  b.m33.          
+0000b570: 2020 2020 2020 7265 732e 6d32 3120 3d20        res.m21 = 
+0000b580: 6d61 2e6d 3231 2a6d 622e 6d31 312b 6d61  ma.m21*mb.m11+ma
+0000b590: 2e6d 3232 2a6d 622e 6d32 312b 6d61 2e6d  .m22*mb.m21+ma.m
+0000b5a0: 3233 2a6d 622e 6d33 310a 2020 2020 2020  23*mb.m31.      
+0000b5b0: 2020 2020 2020 2020 2020 7265 732e 6d32            res.m2
+0000b5c0: 3220 3d20 6d61 2e6d 3231 2a6d 622e 6d31  2 = ma.m21*mb.m1
+0000b5d0: 322b 6d61 2e6d 3232 2a6d 622e 6d32 322b  2+ma.m22*mb.m22+
+0000b5e0: 6d61 2e6d 3233 2a6d 622e 6d33 320a 2020  ma.m23*mb.m32.  
+0000b5f0: 2020 2020 2020 2020 2020 2020 2020 7265                re
+0000b600: 732e 6d32 3320 3d20 6d61 2e6d 3231 2a6d  s.m23 = ma.m21*m
+0000b610: 622e 6d31 332b 6d61 2e6d 3232 2a6d 622e  b.m13+ma.m22*mb.
+0000b620: 6d32 332b 6d61 2e6d 3233 2a6d 622e 6d33  m23+ma.m23*mb.m3
+0000b630: 330a 2020 2020 2020 2020 2020 2020 2020  3.              
+0000b640: 2020 7265 732e 6d33 3120 3d20 6d61 2e6d    res.m31 = ma.m
+0000b650: 3331 2a6d 622e 6d31 312b 6d61 2e6d 3332  31*mb.m11+ma.m32
+0000b660: 2a6d 622e 6d32 312b 6d61 2e6d 3333 2a6d  *mb.m21+ma.m33*m
+0000b670: 622e 6d33 310a 2020 2020 2020 2020 2020  b.m31.          
+0000b680: 2020 2020 2020 7265 732e 6d33 3220 3d20        res.m32 = 
+0000b690: 6d61 2e6d 3331 2a6d 622e 6d31 322b 6d61  ma.m31*mb.m12+ma
+0000b6a0: 2e6d 3332 2a6d 622e 6d32 322b 6d61 2e6d  .m32*mb.m22+ma.m
+0000b6b0: 3333 2a6d 622e 6d33 320a 2020 2020 2020  33*mb.m32.      
+0000b6c0: 2020 2020 2020 2020 2020 7265 732e 6d33            res.m3
+0000b6d0: 3320 3d20 6d61 2e6d 3331 2a6d 622e 6d31  3 = ma.m31*mb.m1
+0000b6e0: 332b 6d61 2e6d 3332 2a6d 622e 6d32 332b  3+ma.m32*mb.m23+
+0000b6f0: 6d61 2e6d 3333 2a6d 622e 6d33 330a 2020  ma.m33*mb.m33.  
+0000b700: 2020 2020 2020 2020 2020 2020 2020 7265                re
+0000b710: 7475 726e 2072 6573 0a20 2020 2020 2020  turn res.       
+0000b720: 2020 2020 2023 2076 6563 3320 6f6e 2074       # vec3 on t
+0000b730: 6865 2072 6967 6874 3f0a 2020 2020 2020  he right?.      
+0000b740: 2020 2020 2020 656c 6966 2074 6220 6973        elif tb is
+0000b750: 2076 6563 333a 0a20 2020 2020 2020 2020   vec3:.         
+0000b760: 2020 2020 2020 2023 206d 6174 332a 7665         # mat3*ve
+0000b770: 6333 0a20 2020 2020 2020 2020 2020 2020  c3.             
+0000b780: 2020 2077 7265 7320 3d20 7665 6333 2829     wres = vec3()
+0000b790: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000b7a0: 2077 6220 2020 3d20 620a 2020 2020 2020   wb   = b.      
+0000b7b0: 2020 2020 2020 2020 2020 7772 6573 2e78            wres.x
+0000b7c0: 203d 206d 612e 6d31 312a 7762 2e78 202b   = ma.m11*wb.x +
+0000b7d0: 206d 612e 6d31 322a 7762 2e79 202b 206d   ma.m12*wb.y + m
+0000b7e0: 612e 6d31 332a 7762 2e7a 0a20 2020 2020  a.m13*wb.z.     
+0000b7f0: 2020 2020 2020 2020 2020 2077 7265 732e             wres.
+0000b800: 7920 3d20 6d61 2e6d 3231 2a77 622e 7820  y = ma.m21*wb.x 
+0000b810: 2b20 6d61 2e6d 3232 2a77 622e 7920 2b20  + ma.m22*wb.y + 
+0000b820: 6d61 2e6d 3233 2a77 622e 7a0a 2020 2020  ma.m23*wb.z.    
+0000b830: 2020 2020 2020 2020 2020 2020 7772 6573              wres
+0000b840: 2e7a 203d 206d 612e 6d33 312a 7762 2e78  .z = ma.m31*wb.x
+0000b850: 202b 206d 612e 6d33 322a 7762 2e79 202b   + ma.m32*wb.y +
+0000b860: 206d 612e 6d33 332a 7762 2e7a 0a20 2020   ma.m33*wb.z.   
+0000b870: 2020 2020 2020 2020 2020 2020 2072 6574               ret
+0000b880: 7572 6e20 7772 6573 0a20 2020 2020 2020  urn wres.       
+0000b890: 2020 2020 2023 2053 6361 6c61 7220 6f6e       # Scalar on
+0000b8a0: 2074 6865 2072 6967 6874 3f0a 2020 2020   the right?.    
+0000b8b0: 2020 2020 2020 2020 656c 6966 2074 6220          elif tb 
+0000b8c0: 6973 2066 6c6f 6174 206f 7220 7462 2069  is float or tb i
+0000b8d0: 7320 696e 7420 6f72 2074 6220 6973 206c  s int or tb is l
+0000b8e0: 6f6e 673a 0a20 2020 2020 2020 2020 2020  ong:.           
+0000b8f0: 2020 2020 2072 6573 203d 206d 6174 3328       res = mat3(
+0000b900: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0000b910: 2020 7220 3d20 620a 2020 2020 2020 2020    r = b.        
+0000b920: 2020 2020 2020 2020 7265 732e 6d31 3120          res.m11 
+0000b930: 3d20 6d61 2e6d 3131 2a72 0a20 2020 2020  = ma.m11*r.     
+0000b940: 2020 2020 2020 2020 2020 2072 6573 2e6d             res.m
+0000b950: 3132 203d 206d 612e 6d31 322a 720a 2020  12 = ma.m12*r.  
+0000b960: 2020 2020 2020 2020 2020 2020 2020 7265                re
+0000b970: 732e 6d31 3320 3d20 6d61 2e6d 3133 2a72  s.m13 = ma.m13*r
+0000b980: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000b990: 2072 6573 2e6d 3231 203d 206d 612e 6d32   res.m21 = ma.m2
+0000b9a0: 312a 720a 2020 2020 2020 2020 2020 2020  1*r.            
+0000b9b0: 2020 2020 7265 732e 6d32 3220 3d20 6d61      res.m22 = ma
+0000b9c0: 2e6d 3232 2a72 0a20 2020 2020 2020 2020  .m22*r.         
+0000b9d0: 2020 2020 2020 2072 6573 2e6d 3233 203d         res.m23 =
+0000b9e0: 206d 612e 6d32 332a 720a 2020 2020 2020   ma.m23*r.      
+0000b9f0: 2020 2020 2020 2020 2020 7265 732e 6d33            res.m3
+0000ba00: 3120 3d20 6d61 2e6d 3331 2a72 0a20 2020  1 = ma.m31*r.   
+0000ba10: 2020 2020 2020 2020 2020 2020 2072 6573               res
+0000ba20: 2e6d 3332 203d 206d 612e 6d33 322a 720a  .m32 = ma.m32*r.
+0000ba30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ba40: 7265 732e 6d33 3320 3d20 6d61 2e6d 3333  res.m33 = ma.m33
+0000ba50: 2a72 0a20 2020 2020 2020 2020 2020 2020  *r.             
+0000ba60: 2020 2072 6574 7572 6e20 7265 730a 0a20     return res.. 
+0000ba70: 2020 2020 2020 2023 2076 6563 3320 6f6e         # vec3 on
+0000ba80: 2074 6865 206c 6566 743f 2028 7468 656e   the left? (then
+0000ba90: 2074 6865 7265 206d 7573 7420 6265 2061   there must be a
+0000baa0: 206d 6174 3320 6f6e 2074 6865 2072 6967   mat3 on the rig
+0000bab0: 6874 290a 2020 2020 2020 2020 656c 6966  ht).        elif
+0000bac0: 2074 6120 6973 2076 6563 333a 0a20 2020   ta is vec3:.   
+0000bad0: 2020 2020 2020 2020 2023 2076 6563 332a           # vec3*
+0000bae0: 6d61 7433 0a20 2020 2020 2020 2020 2020  mat3.           
+0000baf0: 2077 7265 7320 3d20 7665 6333 2829 0a20   wres = vec3(). 
+0000bb00: 2020 2020 2020 2020 2020 2077 6120 2020             wa   
+0000bb10: 3d20 610a 2020 2020 2020 2020 2020 2020  = a.            
+0000bb20: 6d62 2020 203d 2062 0a20 2020 2020 2020  mb   = b.       
+0000bb30: 2020 2020 2077 7265 732e 7820 3d20 7761       wres.x = wa
+0000bb40: 2e78 2a6d 622e 6d31 3120 2b20 7761 2e79  .x*mb.m11 + wa.y
+0000bb50: 2a6d 622e 6d32 3120 2b20 7761 2e7a 2a6d  *mb.m21 + wa.z*m
+0000bb60: 622e 6d33 310a 2020 2020 2020 2020 2020  b.m31.          
+0000bb70: 2020 7772 6573 2e79 203d 2077 612e 782a    wres.y = wa.x*
+0000bb80: 6d62 2e6d 3132 202b 2077 612e 792a 6d62  mb.m12 + wa.y*mb
+0000bb90: 2e6d 3232 202b 2077 612e 7a2a 6d62 2e6d  .m22 + wa.z*mb.m
+0000bba0: 3332 0a20 2020 2020 2020 2020 2020 2077  32.            w
+0000bbb0: 7265 732e 7a20 3d20 7761 2e78 2a6d 622e  res.z = wa.x*mb.
+0000bbc0: 6d31 3320 2b20 7761 2e79 2a6d 622e 6d32  m13 + wa.y*mb.m2
+0000bbd0: 3320 2b20 7761 2e7a 2a6d 622e 6d33 330a  3 + wa.z*mb.m33.
+0000bbe0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0000bbf0: 726e 2077 7265 730a 0a20 2020 2020 2020  rn wres..       
+0000bc00: 2023 2053 6361 6c61 7220 6f6e 2074 6865   # Scalar on the
+0000bc10: 206c 6566 743f 2028 7468 656e 2074 6865   left? (then the
+0000bc20: 7265 206d 7573 7420 6265 2061 206d 6174  re must be a mat
+0000bc30: 3320 6f6e 2074 6865 2072 6967 6874 290a  3 on the right).
+0000bc40: 2020 2020 2020 2020 656c 6966 2074 6120          elif ta 
+0000bc50: 6973 2066 6c6f 6174 206f 7220 7461 2069  is float or ta i
+0000bc60: 7320 696e 7420 6f72 2074 6120 6973 206c  s int or ta is l
+0000bc70: 6f6e 673a 0a20 2020 2020 2020 2020 2020  ong:.           
+0000bc80: 2072 6573 203d 206d 6174 3328 290a 2020   res = mat3().  
+0000bc90: 2020 2020 2020 2020 2020 7220 203d 2061            r  = a
+0000bca0: 0a20 2020 2020 2020 2020 2020 206d 6220  .            mb 
+0000bcb0: 3d20 620a 2020 2020 2020 2020 2020 2020  = b.            
+0000bcc0: 7265 732e 6d31 3120 3d20 722a 6d62 2e6d  res.m11 = r*mb.m
+0000bcd0: 3131 0a20 2020 2020 2020 2020 2020 2072  11.            r
+0000bce0: 6573 2e6d 3132 203d 2072 2a6d 622e 6d31  es.m12 = r*mb.m1
+0000bcf0: 320a 2020 2020 2020 2020 2020 2020 7265  2.            re
+0000bd00: 732e 6d31 3320 3d20 722a 6d62 2e6d 3133  s.m13 = r*mb.m13
+0000bd10: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
+0000bd20: 2e6d 3231 203d 2072 2a6d 622e 6d32 310a  .m21 = r*mb.m21.
+0000bd30: 2020 2020 2020 2020 2020 2020 7265 732e              res.
+0000bd40: 6d32 3220 3d20 722a 6d62 2e6d 3232 0a20  m22 = r*mb.m22. 
+0000bd50: 2020 2020 2020 2020 2020 2072 6573 2e6d             res.m
+0000bd60: 3233 203d 2072 2a6d 622e 6d32 330a 2020  23 = r*mb.m23.  
+0000bd70: 2020 2020 2020 2020 2020 7265 732e 6d33            res.m3
+0000bd80: 3120 3d20 722a 6d62 2e6d 3331 0a20 2020  1 = r*mb.m31.   
+0000bd90: 2020 2020 2020 2020 2072 6573 2e6d 3332           res.m32
+0000bda0: 203d 2072 2a6d 622e 6d33 320a 2020 2020   = r*mb.m32.    
+0000bdb0: 2020 2020 2020 2020 7265 732e 6d33 3320          res.m33 
+0000bdc0: 3d20 722a 6d62 2e6d 3333 0a20 2020 2020  = r*mb.m33.     
+0000bdd0: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
+0000bde0: 730a 0a20 2020 2020 2020 2023 204e 6f20  s..        # No 
+0000bdf0: 7661 6c69 6420 636f 6d62 696e 6174 696f  valid combinatio
+0000be00: 6e20 666f 756e 640a 2020 2020 2020 2020  n found.        
+0000be10: 7261 6973 6520 5479 7065 4572 726f 722c  raise TypeError,
+0000be20: 2022 756e 7375 7070 6f72 7465 6420 6f70   "unsupported op
+0000be30: 6572 616e 6420 7479 7065 2066 6f72 202a  erand type for *
+0000be40: 220a 0a20 2020 2064 6566 205f 5f64 6976  "..    def __div
+0000be50: 5f5f 286d 6174 3320 612c 2062 293a 0a20  __(mat3 a, b):. 
+0000be60: 2020 2020 2020 2023 2050 7974 686f 6e20         # Python 
+0000be70: 320a 2020 2020 2020 2020 7265 7475 726e  2.        return
+0000be80: 206d 6174 332e 5f5f 7472 7565 6469 765f   mat3.__truediv_
+0000be90: 5f28 612c 6229 0a0a 2020 2020 6465 6620  _(a,b)..    def 
+0000bea0: 5f5f 7472 7565 6469 765f 5f28 6d61 7433  __truediv__(mat3
+0000beb0: 2061 2c20 6229 3a0a 2020 2020 2020 2020   a, b):.        
+0000bec0: 2222 2244 6976 6973 696f 6e2e 0a20 2020  """Division..   
+0000bed0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0000bee0: 2063 6465 6620 6d61 7433 2072 6573 0a20   cdef mat3 res. 
+0000bef0: 2020 2020 2020 2063 6465 6620 646f 7562         cdef doub
+0000bf00: 6c65 2072 0a0a 2020 2020 2020 2020 7462  le r..        tb
+0000bf10: 203d 2074 7970 6528 6229 0a0a 2020 2020   = type(b)..    
+0000bf20: 2020 2020 6966 2074 6220 6973 2066 6c6f      if tb is flo
+0000bf30: 6174 206f 7220 7462 2069 7320 696e 7420  at or tb is int 
+0000bf40: 6f72 2074 6220 6973 206c 6f6e 673a 0a20  or tb is long:. 
+0000bf50: 2020 2020 2020 2020 2020 2023 206d 6174             # mat
+0000bf60: 332f 7363 616c 6172 0a20 2020 2020 2020  3/scalar.       
+0000bf70: 2020 2020 2072 6573 203d 206d 6174 3328       res = mat3(
+0000bf80: 290a 2020 2020 2020 2020 2020 2020 7220  ).            r 
+0000bf90: 3d20 620a 2020 2020 2020 2020 2020 2020  = b.            
+0000bfa0: 6966 2066 6162 7328 7229 3c3d 6570 733a  if fabs(r)<=eps:
+0000bfb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000bfc0: 2072 6169 7365 205a 6572 6f44 6976 6973   raise ZeroDivis
+0000bfd0: 696f 6e45 7272 6f72 2c22 6d61 7433 2064  ionError,"mat3 d
+0000bfe0: 6976 6973 696f 6e22 0a20 2020 2020 2020  ivision".       
+0000bff0: 2020 2020 2072 6573 2e6d 3131 203d 2061       res.m11 = a
+0000c000: 2e6d 3131 2f72 0a20 2020 2020 2020 2020  .m11/r.         
+0000c010: 2020 2072 6573 2e6d 3132 203d 2061 2e6d     res.m12 = a.m
+0000c020: 3132 2f72 0a20 2020 2020 2020 2020 2020  12/r.           
+0000c030: 2072 6573 2e6d 3133 203d 2061 2e6d 3133   res.m13 = a.m13
+0000c040: 2f72 0a20 2020 2020 2020 2020 2020 2072  /r.            r
+0000c050: 6573 2e6d 3231 203d 2061 2e6d 3231 2f72  es.m21 = a.m21/r
+0000c060: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
+0000c070: 2e6d 3232 203d 2061 2e6d 3232 2f72 0a20  .m22 = a.m22/r. 
+0000c080: 2020 2020 2020 2020 2020 2072 6573 2e6d             res.m
+0000c090: 3233 203d 2061 2e6d 3233 2f72 0a20 2020  23 = a.m23/r.   
+0000c0a0: 2020 2020 2020 2020 2072 6573 2e6d 3331           res.m31
+0000c0b0: 203d 2061 2e6d 3331 2f72 0a20 2020 2020   = a.m31/r.     
+0000c0c0: 2020 2020 2020 2072 6573 2e6d 3332 203d         res.m32 =
+0000c0d0: 2061 2e6d 3332 2f72 0a20 2020 2020 2020   a.m32/r.       
+0000c0e0: 2020 2020 2072 6573 2e6d 3333 203d 2061       res.m33 = a
+0000c0f0: 2e6d 3333 2f72 0a20 2020 2020 2020 2020  .m33/r.         
+0000c100: 2020 2072 6574 7572 6e20 7265 730a 2020     return res.  
+0000c110: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0000c120: 2020 2020 2020 2020 7261 6973 6520 5479          raise Ty
+0000c130: 7065 4572 726f 722c 2022 756e 7375 7070  peError, "unsupp
+0000c140: 6f72 7465 6420 6f70 6572 616e 6420 7479  orted operand ty
+0000c150: 7065 2066 6f72 202f 220a 0a20 2020 2064  pe for /"..    d
+0000c160: 6566 205f 5f6d 6f64 5f5f 286d 6174 3320  ef __mod__(mat3 
+0000c170: 7365 6c66 2c20 6f74 6865 7229 3a0a 2020  self, other):.  
+0000c180: 2020 2020 2020 2222 224d 6f64 756c 6f2e        """Modulo.
+0000c190: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0000c1a0: 2020 2020 2063 6465 6620 6d61 7433 206d       cdef mat3 m
+0000c1b0: 622c 2072 6573 0a0a 2020 2020 2020 2020  b, res..        
+0000c1c0: 7462 203d 2074 7970 6528 6f74 6865 7229  tb = type(other)
+0000c1d0: 0a0a 2020 2020 2020 2020 6966 2074 6220  ..        if tb 
+0000c1e0: 6973 2066 6c6f 6174 206f 7220 7462 2069  is float or tb i
+0000c1f0: 7320 696e 7420 6f72 2074 6220 6973 206c  s int or tb is l
+0000c200: 6f6e 673a 0a20 2020 2020 2020 2020 2020  ong:.           
+0000c210: 2072 203d 206f 7468 6572 0a20 2020 2020   r = other.     
+0000c220: 2020 2020 2020 2069 6620 6661 6273 2872         if fabs(r
+0000c230: 293c 3d65 7073 3a0a 2020 2020 2020 2020  )<=eps:.        
+0000c240: 2020 2020 2020 2020 7261 6973 6520 5a65          raise Ze
+0000c250: 726f 4469 7669 7369 6f6e 4572 726f 722c  roDivisionError,
+0000c260: 226d 6174 3320 6d6f 6475 6c6f 220a 2020  "mat3 modulo".  
+0000c270: 2020 2020 2020 2020 2020 7265 7320 3d20            res = 
+0000c280: 6d61 7433 2829 0a20 2020 2020 2020 2020  mat3().         
+0000c290: 2020 2072 6573 2e6d 3131 203d 205f 666d     res.m11 = _fm
+0000c2a0: 6f64 2873 656c 662e 6d31 312c 2072 290a  od(self.m11, r).
+0000c2b0: 2020 2020 2020 2020 2020 2020 7265 732e              res.
+0000c2c0: 6d31 3220 3d20 5f66 6d6f 6428 7365 6c66  m12 = _fmod(self
+0000c2d0: 2e6d 3132 2c20 7229 0a20 2020 2020 2020  .m12, r).       
+0000c2e0: 2020 2020 2072 6573 2e6d 3133 203d 205f       res.m13 = _
+0000c2f0: 666d 6f64 2873 656c 662e 6d31 332c 2072  fmod(self.m13, r
+0000c300: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
+0000c310: 732e 6d32 3120 3d20 5f66 6d6f 6428 7365  s.m21 = _fmod(se
+0000c320: 6c66 2e6d 3231 2c20 7229 0a20 2020 2020  lf.m21, r).     
+0000c330: 2020 2020 2020 2072 6573 2e6d 3232 203d         res.m22 =
+0000c340: 205f 666d 6f64 2873 656c 662e 6d32 322c   _fmod(self.m22,
+0000c350: 2072 290a 2020 2020 2020 2020 2020 2020   r).            
+0000c360: 7265 732e 6d32 3320 3d20 5f66 6d6f 6428  res.m23 = _fmod(
+0000c370: 7365 6c66 2e6d 3233 2c20 7229 0a20 2020  self.m23, r).   
+0000c380: 2020 2020 2020 2020 2072 6573 2e6d 3331           res.m31
+0000c390: 203d 205f 666d 6f64 2873 656c 662e 6d33   = _fmod(self.m3
+0000c3a0: 312c 2072 290a 2020 2020 2020 2020 2020  1, r).          
+0000c3b0: 2020 7265 732e 6d33 3220 3d20 5f66 6d6f    res.m32 = _fmo
+0000c3c0: 6428 7365 6c66 2e6d 3332 2c20 7229 0a20  d(self.m32, r). 
+0000c3d0: 2020 2020 2020 2020 2020 2072 6573 2e6d             res.m
+0000c3e0: 3333 203d 205f 666d 6f64 2873 656c 662e  33 = _fmod(self.
+0000c3f0: 6d33 332c 2072 290a 2020 2020 2020 2020  m33, r).        
+0000c400: 2020 2020 7265 7475 726e 2072 6573 0a0a      return res..
+0000c410: 2020 2020 2020 2020 656c 6966 2074 6220          elif tb 
+0000c420: 6973 206d 6174 333a 0a20 2020 2020 2020  is mat3:.       
+0000c430: 2020 2020 206d 6220 3d20 6f74 6865 720a       mb = other.
+0000c440: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0000c450: 2866 6162 7328 6d62 2e6d 3131 293c 3d65  (fabs(mb.m11)<=e
+0000c460: 7073 206f 7220 6661 6273 286d 622e 6d31  ps or fabs(mb.m1
+0000c470: 3229 3c3d 6570 7320 6f72 2066 6162 7328  2)<=eps or fabs(
+0000c480: 6d62 2e6d 3133 293c 3d65 7073 206f 720a  mb.m13)<=eps or.
+0000c490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c4a0: 6661 6273 286d 622e 6d32 3129 3c3d 6570  fabs(mb.m21)<=ep
+0000c4b0: 7320 6f72 2066 6162 7328 6d62 2e6d 3232  s or fabs(mb.m22
+0000c4c0: 293c 3d65 7073 206f 7220 6661 6273 286d  )<=eps or fabs(m
+0000c4d0: 622e 6d32 3329 3c3d 6570 7320 6f72 0a20  b.m23)<=eps or. 
+0000c4e0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0000c4f0: 6162 7328 6d62 2e6d 3331 293c 3d65 7073  abs(mb.m31)<=eps
+0000c500: 206f 7220 6661 6273 286d 622e 6d33 3229   or fabs(mb.m32)
+0000c510: 3c3d 6570 7320 6f72 2066 6162 7328 6d62  <=eps or fabs(mb
+0000c520: 2e6d 3333 293c 3d65 7073 293a 0a20 2020  .m33)<=eps):.   
+0000c530: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+0000c540: 7365 205a 6572 6f44 6976 6973 696f 6e45  se ZeroDivisionE
+0000c550: 7272 6f72 2c22 6d61 7433 206d 6f64 756c  rror,"mat3 modul
+0000c560: 6f22 0a0a 2020 2020 2020 2020 2020 2020  o"..            
+0000c570: 7265 733d 6d61 7433 2829 0a20 2020 2020  res=mat3().     
+0000c580: 2020 2020 2020 2072 6573 2e6d 3131 203d         res.m11 =
+0000c590: 205f 666d 6f64 2873 656c 662e 6d31 312c   _fmod(self.m11,
+0000c5a0: 206d 622e 6d31 3129 0a20 2020 2020 2020   mb.m11).       
+0000c5b0: 2020 2020 2072 6573 2e6d 3132 203d 205f       res.m12 = _
+0000c5c0: 666d 6f64 2873 656c 662e 6d31 322c 206d  fmod(self.m12, m
+0000c5d0: 622e 6d31 3229 0a20 2020 2020 2020 2020  b.m12).         
+0000c5e0: 2020 2072 6573 2e6d 3133 203d 205f 666d     res.m13 = _fm
+0000c5f0: 6f64 2873 656c 662e 6d31 332c 206d 622e  od(self.m13, mb.
+0000c600: 6d31 3329 0a20 2020 2020 2020 2020 2020  m13).           
+0000c610: 2072 6573 2e6d 3231 203d 205f 666d 6f64   res.m21 = _fmod
+0000c620: 2873 656c 662e 6d32 312c 206d 622e 6d32  (self.m21, mb.m2
+0000c630: 3129 0a20 2020 2020 2020 2020 2020 2072  1).            r
+0000c640: 6573 2e6d 3232 203d 205f 666d 6f64 2873  es.m22 = _fmod(s
+0000c650: 656c 662e 6d32 322c 206d 622e 6d32 3229  elf.m22, mb.m22)
+0000c660: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
+0000c670: 2e6d 3233 203d 205f 666d 6f64 2873 656c  .m23 = _fmod(sel
+0000c680: 662e 6d32 332c 206d 622e 6d32 3329 0a20  f.m23, mb.m23). 
+0000c690: 2020 2020 2020 2020 2020 2072 6573 2e6d             res.m
+0000c6a0: 3331 203d 205f 666d 6f64 2873 656c 662e  31 = _fmod(self.
+0000c6b0: 6d33 312c 206d 622e 6d33 3129 0a20 2020  m31, mb.m31).   
+0000c6c0: 2020 2020 2020 2020 2072 6573 2e6d 3332           res.m32
+0000c6d0: 203d 205f 666d 6f64 2873 656c 662e 6d33   = _fmod(self.m3
+0000c6e0: 322c 206d 622e 6d33 3229 0a20 2020 2020  2, mb.m32).     
+0000c6f0: 2020 2020 2020 2072 6573 2e6d 3333 203d         res.m33 =
+0000c700: 205f 666d 6f64 2873 656c 662e 6d33 332c   _fmod(self.m33,
+0000c710: 206d 622e 6d33 3329 0a20 2020 2020 2020   mb.m33).       
+0000c720: 2020 2020 2072 6574 7572 6e20 7265 730a       return res.
+0000c730: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+0000c740: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+0000c750: 2054 7970 6545 7272 6f72 2c20 2275 6e73   TypeError, "uns
+0000c760: 7570 706f 7274 6564 206f 7065 7261 6e64  upported operand
+0000c770: 2074 7970 6520 666f 7220 2522 0a0a 0a20   type for %"... 
+0000c780: 2020 2064 6566 205f 5f6e 6567 5f5f 2873     def __neg__(s
+0000c790: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
+0000c7a0: 224e 6567 6174 696f 6e2e 0a20 2020 2020  "Negation..     
+0000c7b0: 2020 2022 2222 0a20 2020 2020 2020 2063     """.        c
+0000c7c0: 6465 6620 6d61 7433 2072 6573 0a20 2020  def mat3 res.   
+0000c7d0: 2020 2020 2072 6573 203d 206d 6174 3328       res = mat3(
+0000c7e0: 290a 2020 2020 2020 2020 7265 732e 6d31  ).        res.m1
+0000c7f0: 3120 3d20 2d73 656c 662e 6d31 310a 2020  1 = -self.m11.  
+0000c800: 2020 2020 2020 7265 732e 6d31 3220 3d20        res.m12 = 
+0000c810: 2d73 656c 662e 6d31 320a 2020 2020 2020  -self.m12.      
+0000c820: 2020 7265 732e 6d31 3320 3d20 2d73 656c    res.m13 = -sel
+0000c830: 662e 6d31 330a 2020 2020 2020 2020 7265  f.m13.        re
+0000c840: 732e 6d32 3120 3d20 2d73 656c 662e 6d32  s.m21 = -self.m2
+0000c850: 310a 2020 2020 2020 2020 7265 732e 6d32  1.        res.m2
+0000c860: 3220 3d20 2d73 656c 662e 6d32 320a 2020  2 = -self.m22.  
+0000c870: 2020 2020 2020 7265 732e 6d32 3320 3d20        res.m23 = 
+0000c880: 2d73 656c 662e 6d32 330a 2020 2020 2020  -self.m23.      
+0000c890: 2020 7265 732e 6d33 3120 3d20 2d73 656c    res.m31 = -sel
+0000c8a0: 662e 6d33 310a 2020 2020 2020 2020 7265  f.m31.        re
+0000c8b0: 732e 6d33 3220 3d20 2d73 656c 662e 6d33  s.m32 = -self.m3
+0000c8c0: 320a 2020 2020 2020 2020 7265 732e 6d33  2.        res.m3
+0000c8d0: 3320 3d20 2d73 656c 662e 6d33 330a 2020  3 = -self.m33.  
+0000c8e0: 2020 2020 2020 7265 7475 726e 2072 6573        return res
+0000c8f0: 0a0a 2020 2020 6465 6620 5f5f 706f 735f  ..    def __pos_
+0000c900: 5f28 7365 6c66 293a 0a20 2020 2020 2020  _(self):.       
+0000c910: 2063 6465 6620 6d61 7433 2072 6573 0a20   cdef mat3 res. 
+0000c920: 2020 2020 2020 2072 6573 203d 206d 6174         res = mat
+0000c930: 3328 290a 2020 2020 2020 2020 7265 732e  3().        res.
+0000c940: 6d31 3120 3d20 7365 6c66 2e6d 3131 0a20  m11 = self.m11. 
+0000c950: 2020 2020 2020 2072 6573 2e6d 3132 203d         res.m12 =
+0000c960: 2073 656c 662e 6d31 320a 2020 2020 2020   self.m12.      
+0000c970: 2020 7265 732e 6d31 3320 3d20 7365 6c66    res.m13 = self
+0000c980: 2e6d 3133 0a20 2020 2020 2020 2072 6573  .m13.        res
+0000c990: 2e6d 3231 203d 2073 656c 662e 6d32 310a  .m21 = self.m21.
+0000c9a0: 2020 2020 2020 2020 7265 732e 6d32 3220          res.m22 
+0000c9b0: 3d20 7365 6c66 2e6d 3232 0a20 2020 2020  = self.m22.     
+0000c9c0: 2020 2072 6573 2e6d 3233 203d 2073 656c     res.m23 = sel
+0000c9d0: 662e 6d32 330a 2020 2020 2020 2020 7265  f.m23.        re
+0000c9e0: 732e 6d33 3120 3d20 7365 6c66 2e6d 3331  s.m31 = self.m31
+0000c9f0: 0a20 2020 2020 2020 2072 6573 2e6d 3332  .        res.m32
+0000ca00: 203d 2073 656c 662e 6d33 320a 2020 2020   = self.m32.    
+0000ca10: 2020 2020 7265 732e 6d33 3320 3d20 7365      res.m33 = se
+0000ca20: 6c66 2e6d 3333 0a20 2020 2020 2020 2072  lf.m33.        r
+0000ca30: 6574 7572 6e20 7265 730a 0a20 2020 2064  eturn res..    d
+0000ca40: 6566 205f 5f69 6164 645f 5f28 7365 6c66  ef __iadd__(self
+0000ca50: 2c20 6d61 7433 206f 7468 6572 293a 0a20  , mat3 other):. 
+0000ca60: 2020 2020 2020 2022 2222 496e 6c69 6e65         """Inline
+0000ca70: 206d 6174 7269 7820 6164 6469 7469 6f6e   matrix addition
+0000ca80: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+0000ca90: 2020 2020 2020 7365 6c66 2e6d 3131 203d        self.m11 =
+0000caa0: 2073 656c 662e 6d31 3120 2b20 6f74 6865   self.m11 + othe
+0000cab0: 722e 6d31 310a 2020 2020 2020 2020 7365  r.m11.        se
+0000cac0: 6c66 2e6d 3132 203d 2073 656c 662e 6d31  lf.m12 = self.m1
+0000cad0: 3220 2b20 6f74 6865 722e 6d31 320a 2020  2 + other.m12.  
+0000cae0: 2020 2020 2020 7365 6c66 2e6d 3133 203d        self.m13 =
+0000caf0: 2073 656c 662e 6d31 3320 2b20 6f74 6865   self.m13 + othe
+0000cb00: 722e 6d31 330a 2020 2020 2020 2020 7365  r.m13.        se
+0000cb10: 6c66 2e6d 3231 203d 2073 656c 662e 6d32  lf.m21 = self.m2
+0000cb20: 3120 2b20 6f74 6865 722e 6d32 310a 2020  1 + other.m21.  
+0000cb30: 2020 2020 2020 7365 6c66 2e6d 3232 203d        self.m22 =
+0000cb40: 2073 656c 662e 6d32 3220 2b20 6f74 6865   self.m22 + othe
+0000cb50: 722e 6d32 320a 2020 2020 2020 2020 7365  r.m22.        se
+0000cb60: 6c66 2e6d 3233 203d 2073 656c 662e 6d32  lf.m23 = self.m2
+0000cb70: 3320 2b20 6f74 6865 722e 6d32 330a 2020  3 + other.m23.  
+0000cb80: 2020 2020 2020 7365 6c66 2e6d 3331 203d        self.m31 =
+0000cb90: 2073 656c 662e 6d33 3120 2b20 6f74 6865   self.m31 + othe
+0000cba0: 722e 6d33 310a 2020 2020 2020 2020 7365  r.m31.        se
+0000cbb0: 6c66 2e6d 3332 203d 2073 656c 662e 6d33  lf.m32 = self.m3
+0000cbc0: 3220 2b20 6f74 6865 722e 6d33 320a 2020  2 + other.m32.  
+0000cbd0: 2020 2020 2020 7365 6c66 2e6d 3333 203d        self.m33 =
+0000cbe0: 2073 656c 662e 6d33 3320 2b20 6f74 6865   self.m33 + othe
+0000cbf0: 722e 6d33 330a 2020 2020 2020 2020 7265  r.m33.        re
+0000cc00: 7475 726e 2073 656c 660a 0a20 2020 2064  turn self..    d
+0000cc10: 6566 205f 5f69 7375 625f 5f28 7365 6c66  ef __isub__(self
+0000cc20: 2c20 6d61 7433 206f 7468 6572 293a 0a20  , mat3 other):. 
+0000cc30: 2020 2020 2020 2022 2222 496e 6c69 6e65         """Inline
+0000cc40: 206d 6174 7269 7820 7375 6274 7261 6374   matrix subtract
+0000cc50: 696f 6e2e 0a20 2020 2020 2020 2022 2222  ion..        """
+0000cc60: 0a20 2020 2020 2020 2073 656c 662e 6d31  .        self.m1
+0000cc70: 3120 3d20 7365 6c66 2e6d 3131 202d 206f  1 = self.m11 - o
+0000cc80: 7468 6572 2e6d 3131 0a20 2020 2020 2020  ther.m11.       
+0000cc90: 2073 656c 662e 6d31 3220 3d20 7365 6c66   self.m12 = self
+0000cca0: 2e6d 3132 202d 206f 7468 6572 2e6d 3132  .m12 - other.m12
+0000ccb0: 0a20 2020 2020 2020 2073 656c 662e 6d31  .        self.m1
+0000ccc0: 3320 3d20 7365 6c66 2e6d 3133 202d 206f  3 = self.m13 - o
+0000ccd0: 7468 6572 2e6d 3133 0a20 2020 2020 2020  ther.m13.       
+0000cce0: 2073 656c 662e 6d32 3120 3d20 7365 6c66   self.m21 = self
+0000ccf0: 2e6d 3231 202d 206f 7468 6572 2e6d 3231  .m21 - other.m21
+0000cd00: 0a20 2020 2020 2020 2073 656c 662e 6d32  .        self.m2
+0000cd10: 3220 3d20 7365 6c66 2e6d 3232 202d 206f  2 = self.m22 - o
+0000cd20: 7468 6572 2e6d 3232 0a20 2020 2020 2020  ther.m22.       
+0000cd30: 2073 656c 662e 6d32 3320 3d20 7365 6c66   self.m23 = self
+0000cd40: 2e6d 3233 202d 206f 7468 6572 2e6d 3233  .m23 - other.m23
+0000cd50: 0a20 2020 2020 2020 2073 656c 662e 6d33  .        self.m3
+0000cd60: 3120 3d20 7365 6c66 2e6d 3331 202d 206f  1 = self.m31 - o
+0000cd70: 7468 6572 2e6d 3331 0a20 2020 2020 2020  ther.m31.       
+0000cd80: 2073 656c 662e 6d33 3220 3d20 7365 6c66   self.m32 = self
+0000cd90: 2e6d 3332 202d 206f 7468 6572 2e6d 3332  .m32 - other.m32
+0000cda0: 0a20 2020 2020 2020 2073 656c 662e 6d33  .        self.m3
+0000cdb0: 3320 3d20 7365 6c66 2e6d 3333 202d 206f  3 = self.m33 - o
+0000cdc0: 7468 6572 2e6d 3333 0a20 2020 2020 2020  ther.m33.       
+0000cdd0: 2072 6574 7572 6e20 7365 6c66 0a0a 2020   return self..  
+0000cde0: 2020 6465 6620 5f5f 696d 756c 5f5f 2873    def __imul__(s
+0000cdf0: 656c 662c 206f 7468 6572 293a 0a20 2020  elf, other):.   
+0000ce00: 2020 2020 2022 2222 496e 6c69 6e65 206d       """Inline m
+0000ce10: 756c 7469 706c 6963 6174 696f 6e20 2873  ultiplication (s
+0000ce20: 6361 6c61 7220 6f72 206d 6174 7269 7829  calar or matrix)
+0000ce30: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+0000ce40: 2020 2020 2020 6364 6566 2064 6f75 626c        cdef doubl
+0000ce50: 6520 722c 2061 2c62 2c63 0a20 2020 2020  e r, a,b,c.     
+0000ce60: 2020 2063 6465 6620 6d61 7433 206d 620a     cdef mat3 mb.
+0000ce70: 0a20 2020 2020 2020 2074 6220 3d20 7479  .        tb = ty
+0000ce80: 7065 286f 7468 6572 290a 2020 2020 2020  pe(other).      
+0000ce90: 2020 6966 2074 6220 6973 2066 6c6f 6174    if tb is float
+0000cea0: 206f 7220 7462 2069 7320 696e 7420 6f72   or tb is int or
+0000ceb0: 2074 6220 6973 206c 6f6e 673a 0a20 2020   tb is long:.   
+0000cec0: 2020 2020 2020 2020 2072 3d6f 7468 6572           r=other
+0000ced0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0000cee0: 662e 6d31 3120 3d20 7365 6c66 2e6d 3131  f.m11 = self.m11
+0000cef0: 2a72 0a20 2020 2020 2020 2020 2020 2073  *r.            s
+0000cf00: 656c 662e 6d31 3220 3d20 7365 6c66 2e6d  elf.m12 = self.m
+0000cf10: 3132 2a72 0a20 2020 2020 2020 2020 2020  12*r.           
+0000cf20: 2073 656c 662e 6d31 3320 3d20 7365 6c66   self.m13 = self
+0000cf30: 2e6d 3133 2a72 0a20 2020 2020 2020 2020  .m13*r.         
+0000cf40: 2020 2073 656c 662e 6d32 3120 3d20 7365     self.m21 = se
+0000cf50: 6c66 2e6d 3231 2a72 0a20 2020 2020 2020  lf.m21*r.       
+0000cf60: 2020 2020 2073 656c 662e 6d32 3220 3d20       self.m22 = 
+0000cf70: 7365 6c66 2e6d 3232 2a72 0a20 2020 2020  self.m22*r.     
+0000cf80: 2020 2020 2020 2073 656c 662e 6d32 3320         self.m23 
+0000cf90: 3d20 7365 6c66 2e6d 3233 2a72 0a20 2020  = self.m23*r.   
+0000cfa0: 2020 2020 2020 2020 2073 656c 662e 6d33           self.m3
+0000cfb0: 3120 3d20 7365 6c66 2e6d 3331 2a72 0a20  1 = self.m31*r. 
+0000cfc0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0000cfd0: 6d33 3220 3d20 7365 6c66 2e6d 3332 2a72  m32 = self.m32*r
+0000cfe0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0000cff0: 662e 6d33 3320 3d20 7365 6c66 2e6d 3333  f.m33 = self.m33
+0000d000: 2a72 0a20 2020 2020 2020 2020 2020 2072  *r.            r
+0000d010: 6574 7572 6e20 7365 6c66 0a20 2020 2020  eturn self.     
+0000d020: 2020 2065 6c69 6620 7462 2069 7320 6d61     elif tb is ma
+0000d030: 7433 3a0a 2020 2020 2020 2020 2020 2020  t3:.            
+0000d040: 6d62 203d 206f 7468 6572 0a20 2020 2020  mb = other.     
+0000d050: 2020 2020 2020 2061 203d 2073 656c 662e         a = self.
+0000d060: 6d31 310a 2020 2020 2020 2020 2020 2020  m11.            
+0000d070: 6220 3d20 7365 6c66 2e6d 3132 0a20 2020  b = self.m12.   
+0000d080: 2020 2020 2020 2020 2063 203d 2073 656c           c = sel
+0000d090: 662e 6d31 330a 2020 2020 2020 2020 2020  f.m13.          
+0000d0a0: 2020 7365 6c66 2e6d 3131 203d 2061 2a6d    self.m11 = a*m
+0000d0b0: 622e 6d31 312b 622a 6d62 2e6d 3231 2b63  b.m11+b*mb.m21+c
+0000d0c0: 2a6d 622e 6d33 310a 2020 2020 2020 2020  *mb.m31.        
+0000d0d0: 2020 2020 7365 6c66 2e6d 3132 203d 2061      self.m12 = a
+0000d0e0: 2a6d 622e 6d31 322b 622a 6d62 2e6d 3232  *mb.m12+b*mb.m22
+0000d0f0: 2b63 2a6d 622e 6d33 320a 2020 2020 2020  +c*mb.m32.      
+0000d100: 2020 2020 2020 7365 6c66 2e6d 3133 203d        self.m13 =
+0000d110: 2061 2a6d 622e 6d31 332b 622a 6d62 2e6d   a*mb.m13+b*mb.m
+0000d120: 3233 2b63 2a6d 622e 6d33 330a 2020 2020  23+c*mb.m33.    
+0000d130: 2020 2020 2020 2020 6120 3d20 7365 6c66          a = self
+0000d140: 2e6d 3231 0a20 2020 2020 2020 2020 2020  .m21.           
+0000d150: 2062 203d 2073 656c 662e 6d32 320a 2020   b = self.m22.  
+0000d160: 2020 2020 2020 2020 2020 6320 3d20 7365            c = se
+0000d170: 6c66 2e6d 3233 0a20 2020 2020 2020 2020  lf.m23.         
+0000d180: 2020 2073 656c 662e 6d32 3120 3d20 612a     self.m21 = a*
+0000d190: 6d62 2e6d 3131 2b62 2a6d 622e 6d32 312b  mb.m11+b*mb.m21+
+0000d1a0: 632a 6d62 2e6d 3331 0a20 2020 2020 2020  c*mb.m31.       
+0000d1b0: 2020 2020 2073 656c 662e 6d32 3220 3d20       self.m22 = 
+0000d1c0: 612a 6d62 2e6d 3132 2b62 2a6d 622e 6d32  a*mb.m12+b*mb.m2
+0000d1d0: 322b 632a 6d62 2e6d 3332 0a20 2020 2020  2+c*mb.m32.     
+0000d1e0: 2020 2020 2020 2073 656c 662e 6d32 3320         self.m23 
+0000d1f0: 3d20 612a 6d62 2e6d 3133 2b62 2a6d 622e  = a*mb.m13+b*mb.
+0000d200: 6d32 332b 632a 6d62 2e6d 3333 0a20 2020  m23+c*mb.m33.   
+0000d210: 2020 2020 2020 2020 2061 203d 2073 656c           a = sel
+0000d220: 662e 6d33 310a 2020 2020 2020 2020 2020  f.m31.          
+0000d230: 2020 6220 3d20 7365 6c66 2e6d 3332 0a20    b = self.m32. 
+0000d240: 2020 2020 2020 2020 2020 2063 203d 2073             c = s
+0000d250: 656c 662e 6d33 330a 2020 2020 2020 2020  elf.m33.        
+0000d260: 2020 2020 7365 6c66 2e6d 3331 203d 2061      self.m31 = a
+0000d270: 2a6d 622e 6d31 312b 622a 6d62 2e6d 3231  *mb.m11+b*mb.m21
+0000d280: 2b63 2a6d 622e 6d33 310a 2020 2020 2020  +c*mb.m31.      
+0000d290: 2020 2020 2020 7365 6c66 2e6d 3332 203d        self.m32 =
+0000d2a0: 2061 2a6d 622e 6d31 322b 622a 6d62 2e6d   a*mb.m12+b*mb.m
+0000d2b0: 3232 2b63 2a6d 622e 6d33 320a 2020 2020  22+c*mb.m32.    
+0000d2c0: 2020 2020 2020 2020 7365 6c66 2e6d 3333          self.m33
+0000d2d0: 203d 2061 2a6d 622e 6d31 332b 622a 6d62   = a*mb.m13+b*mb
+0000d2e0: 2e6d 3233 2b63 2a6d 622e 6d33 330a 2020  .m23+c*mb.m33.  
+0000d2f0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0000d300: 2073 656c 660a 2020 2020 2020 2020 656c   self.        el
+0000d310: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+0000d320: 7261 6973 6520 5479 7065 4572 726f 722c  raise TypeError,
+0000d330: 2022 756e 7375 7070 6f72 7465 6420 6f70   "unsupported op
+0000d340: 6572 616e 6420 7479 7065 2066 6f72 202a  erand type for *
+0000d350: 3d22 0a0a 2020 2020 6465 6620 5f5f 6964  ="..    def __id
+0000d360: 6976 5f5f 2873 656c 662c 206f 7468 6572  iv__(self, other
+0000d370: 293a 0a20 2020 2020 2020 2022 2222 496e  ):.        """In
+0000d380: 6c69 6e65 2064 6976 6973 696f 6e20 7769  line division wi
+0000d390: 7468 2073 6361 6c61 722e 0a20 2020 2020  th scalar..     
+0000d3a0: 2020 2022 2222 0a20 2020 2020 2020 2063     """.        c
+0000d3b0: 6465 6620 646f 7562 6c65 2072 0a20 2020  def double r.   
+0000d3c0: 2020 2020 2074 6220 3d20 7479 7065 286f       tb = type(o
+0000d3d0: 7468 6572 290a 2020 2020 2020 2020 6966  ther).        if
+0000d3e0: 2074 6220 6973 2066 6c6f 6174 206f 7220   tb is float or 
+0000d3f0: 7462 2069 7320 696e 7420 6f72 2074 6220  tb is int or tb 
+0000d400: 6973 206c 6f6e 673a 0a20 2020 2020 2020  is long:.       
+0000d410: 2020 2020 2072 3d6f 7468 6572 0a20 2020       r=other.   
+0000d420: 2020 2020 2020 2020 2069 6620 6661 6273           if fabs
+0000d430: 2872 293c 3d65 7073 3a0a 2020 2020 2020  (r)<=eps:.      
+0000d440: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+0000d450: 5a65 726f 4469 7669 7369 6f6e 4572 726f  ZeroDivisionErro
+0000d460: 722c 226d 6174 3320 6469 7669 7369 6f6e  r,"mat3 division
+0000d470: 220a 2020 2020 2020 2020 2020 2020 7365  ".            se
+0000d480: 6c66 2e6d 3131 203d 2073 656c 662e 6d31  lf.m11 = self.m1
+0000d490: 312f 720a 2020 2020 2020 2020 2020 2020  1/r.            
+0000d4a0: 7365 6c66 2e6d 3132 203d 2073 656c 662e  self.m12 = self.
+0000d4b0: 6d31 322f 720a 2020 2020 2020 2020 2020  m12/r.          
+0000d4c0: 2020 7365 6c66 2e6d 3133 203d 2073 656c    self.m13 = sel
+0000d4d0: 662e 6d31 332f 720a 2020 2020 2020 2020  f.m13/r.        
+0000d4e0: 2020 2020 7365 6c66 2e6d 3231 203d 2073      self.m21 = s
+0000d4f0: 656c 662e 6d32 312f 720a 2020 2020 2020  elf.m21/r.      
+0000d500: 2020 2020 2020 7365 6c66 2e6d 3232 203d        self.m22 =
+0000d510: 2073 656c 662e 6d32 322f 720a 2020 2020   self.m22/r.    
+0000d520: 2020 2020 2020 2020 7365 6c66 2e6d 3233          self.m23
+0000d530: 203d 2073 656c 662e 6d32 332f 720a 2020   = self.m23/r.  
+0000d540: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+0000d550: 3331 203d 2073 656c 662e 6d33 312f 720a  31 = self.m31/r.
+0000d560: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0000d570: 2e6d 3332 203d 2073 656c 662e 6d33 322f  .m32 = self.m32/
+0000d580: 720a 2020 2020 2020 2020 2020 2020 7365  r.            se
+0000d590: 6c66 2e6d 3333 203d 2073 656c 662e 6d33  lf.m33 = self.m3
+0000d5a0: 332f 720a 2020 2020 2020 2020 2020 2020  3/r.            
+0000d5b0: 7265 7475 726e 2073 656c 660a 2020 2020  return self.    
+0000d5c0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0000d5d0: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
+0000d5e0: 4572 726f 722c 2022 756e 7375 7070 6f72  Error, "unsuppor
+0000d5f0: 7465 6420 6f70 6572 616e 6420 7479 7065  ted operand type
+0000d600: 2066 6f72 202f 3d22 0a0a 2020 2020 6465   for /="..    de
+0000d610: 6620 5f5f 696d 6f64 5f5f 2873 656c 662c  f __imod__(self,
+0000d620: 2062 293a 0a20 2020 2020 2020 2022 2222   b):.        """
+0000d630: 496e 6c69 6e65 206d 6f64 756c 6f2e 0a20  Inline modulo.. 
+0000d640: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0000d650: 2020 2063 6465 6620 6d61 7433 206d 620a     cdef mat3 mb.
+0000d660: 2020 2020 2020 2020 6364 6566 2064 6f75          cdef dou
+0000d670: 626c 6520 720a 0a20 2020 2020 2020 2074  ble r..        t
+0000d680: 6220 3d20 7479 7065 2862 290a 0a20 2020  b = type(b)..   
+0000d690: 2020 2020 2069 6620 7462 2069 7320 666c       if tb is fl
+0000d6a0: 6f61 7420 6f72 2074 6220 6973 2069 6e74  oat or tb is int
+0000d6b0: 206f 7220 7462 2069 7320 6c6f 6e67 3a0a   or tb is long:.
+0000d6c0: 2020 2020 2020 2020 2020 2020 7220 3d20              r = 
+0000d6d0: 620a 2020 2020 2020 2020 2020 2020 6966  b.            if
+0000d6e0: 2066 6162 7328 7229 3c3d 6570 733a 0a20   fabs(r)<=eps:. 
+0000d6f0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+0000d700: 6169 7365 205a 6572 6f44 6976 6973 696f  aise ZeroDivisio
+0000d710: 6e45 7272 6f72 2c22 6d61 7433 206d 6f64  nError,"mat3 mod
+0000d720: 756c 6f22 0a20 2020 2020 2020 2020 2020  ulo".           
+0000d730: 2073 656c 662e 6d31 3120 3d20 5f66 6d6f   self.m11 = _fmo
+0000d740: 6428 7365 6c66 2e6d 3131 2c20 7229 0a20  d(self.m11, r). 
+0000d750: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0000d760: 6d31 3220 3d20 5f66 6d6f 6428 7365 6c66  m12 = _fmod(self
+0000d770: 2e6d 3132 2c20 7229 0a20 2020 2020 2020  .m12, r).       
+0000d780: 2020 2020 2073 656c 662e 6d31 3320 3d20       self.m13 = 
+0000d790: 5f66 6d6f 6428 7365 6c66 2e6d 3133 2c20  _fmod(self.m13, 
+0000d7a0: 7229 0a20 2020 2020 2020 2020 2020 2073  r).            s
+0000d7b0: 656c 662e 6d32 3120 3d20 5f66 6d6f 6428  elf.m21 = _fmod(
+0000d7c0: 7365 6c66 2e6d 3231 2c20 7229 0a20 2020  self.m21, r).   
+0000d7d0: 2020 2020 2020 2020 2073 656c 662e 6d32           self.m2
+0000d7e0: 3220 3d20 5f66 6d6f 6428 7365 6c66 2e6d  2 = _fmod(self.m
+0000d7f0: 3232 2c20 7229 0a20 2020 2020 2020 2020  22, r).         
+0000d800: 2020 2073 656c 662e 6d32 3320 3d20 5f66     self.m23 = _f
+0000d810: 6d6f 6428 7365 6c66 2e6d 3233 2c20 7229  mod(self.m23, r)
+0000d820: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0000d830: 662e 6d33 3120 3d20 5f66 6d6f 6428 7365  f.m31 = _fmod(se
+0000d840: 6c66 2e6d 3331 2c20 7229 0a20 2020 2020  lf.m31, r).     
+0000d850: 2020 2020 2020 2073 656c 662e 6d33 3220         self.m32 
+0000d860: 3d20 5f66 6d6f 6428 7365 6c66 2e6d 3332  = _fmod(self.m32
+0000d870: 2c20 7229 0a20 2020 2020 2020 2020 2020  , r).           
+0000d880: 2073 656c 662e 6d33 3320 3d20 5f66 6d6f   self.m33 = _fmo
+0000d890: 6428 7365 6c66 2e6d 3333 2c20 7229 0a20  d(self.m33, r). 
+0000d8a0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0000d8b0: 6e20 7365 6c66 0a20 2020 2020 2020 2065  n self.        e
+0000d8c0: 6c69 6620 7462 2069 7320 6d61 7433 3a0a  lif tb is mat3:.
+0000d8d0: 2020 2020 2020 2020 2020 2020 6d62 203d              mb =
+0000d8e0: 2062 0a20 2020 2020 2020 2020 2020 2069   b.            i
+0000d8f0: 6620 2866 6162 7328 6d62 2e6d 3131 293c  f (fabs(mb.m11)<
+0000d900: 3d65 7073 206f 7220 6661 6273 286d 622e  =eps or fabs(mb.
+0000d910: 6d31 3229 3c3d 6570 7320 6f72 2066 6162  m12)<=eps or fab
+0000d920: 7328 6d62 2e6d 3133 293c 3d65 7073 206f  s(mb.m13)<=eps o
+0000d930: 720a 2020 2020 2020 2020 2020 2020 2020  r.              
+0000d940: 2020 6661 6273 286d 622e 6d32 3129 3c3d    fabs(mb.m21)<=
+0000d950: 6570 7320 6f72 2066 6162 7328 6d62 2e6d  eps or fabs(mb.m
+0000d960: 3232 293c 3d65 7073 206f 7220 6661 6273  22)<=eps or fabs
+0000d970: 286d 622e 6d32 3329 3c3d 6570 7320 6f72  (mb.m23)<=eps or
+0000d980: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000d990: 2066 6162 7328 6d62 2e6d 3331 293c 3d65   fabs(mb.m31)<=e
+0000d9a0: 7073 206f 7220 6661 6273 286d 622e 6d33  ps or fabs(mb.m3
+0000d9b0: 3229 3c3d 6570 7320 6f72 2066 6162 7328  2)<=eps or fabs(
+0000d9c0: 6d62 2e6d 3333 293c 3d65 7073 293a 0a20  mb.m33)<=eps):. 
+0000d9d0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+0000d9e0: 6169 7365 205a 6572 6f44 6976 6973 696f  aise ZeroDivisio
+0000d9f0: 6e45 7272 6f72 2c22 6d61 7433 206d 6f64  nError,"mat3 mod
+0000da00: 756c 6f22 0a20 2020 2020 2020 2020 2020  ulo".           
+0000da10: 2073 656c 662e 6d31 3120 3d20 5f66 6d6f   self.m11 = _fmo
+0000da20: 6428 7365 6c66 2e6d 3131 2c20 6d62 2e6d  d(self.m11, mb.m
+0000da30: 3131 290a 2020 2020 2020 2020 2020 2020  11).            
+0000da40: 7365 6c66 2e6d 3132 203d 205f 666d 6f64  self.m12 = _fmod
+0000da50: 2873 656c 662e 6d31 322c 206d 622e 6d31  (self.m12, mb.m1
+0000da60: 3229 0a20 2020 2020 2020 2020 2020 2073  2).            s
+0000da70: 656c 662e 6d31 3320 3d20 5f66 6d6f 6428  elf.m13 = _fmod(
+0000da80: 7365 6c66 2e6d 3133 2c20 6d62 2e6d 3133  self.m13, mb.m13
+0000da90: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
+0000daa0: 6c66 2e6d 3231 203d 205f 666d 6f64 2873  lf.m21 = _fmod(s
+0000dab0: 656c 662e 6d32 312c 206d 622e 6d32 3129  elf.m21, mb.m21)
+0000dac0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0000dad0: 662e 6d32 3220 3d20 5f66 6d6f 6428 7365  f.m22 = _fmod(se
+0000dae0: 6c66 2e6d 3232 2c20 6d62 2e6d 3232 290a  lf.m22, mb.m22).
+0000daf0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0000db00: 2e6d 3233 203d 205f 666d 6f64 2873 656c  .m23 = _fmod(sel
+0000db10: 662e 6d32 332c 206d 622e 6d32 3329 0a20  f.m23, mb.m23). 
+0000db20: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0000db30: 6d33 3120 3d20 5f66 6d6f 6428 7365 6c66  m31 = _fmod(self
+0000db40: 2e6d 3331 2c20 6d62 2e6d 3331 290a 2020  .m31, mb.m31).  
+0000db50: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+0000db60: 3332 203d 205f 666d 6f64 2873 656c 662e  32 = _fmod(self.
+0000db70: 6d33 322c 206d 622e 6d33 3229 0a20 2020  m32, mb.m32).   
+0000db80: 2020 2020 2020 2020 2073 656c 662e 6d33           self.m3
+0000db90: 3320 3d20 5f66 6d6f 6428 7365 6c66 2e6d  3 = _fmod(self.m
+0000dba0: 3333 2c20 6d62 2e6d 3333 290a 2020 2020  33, mb.m33).    
+0000dbb0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+0000dbc0: 656c 660a 2020 2020 2020 2020 656c 7365  elf.        else
+0000dbd0: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+0000dbe0: 6973 6520 5479 7065 4572 726f 722c 2022  ise TypeError, "
+0000dbf0: 756e 7375 7070 6f72 7465 6420 6f70 6572  unsupported oper
+0000dc00: 616e 6420 7479 7065 2066 6f72 2025 3d22  and type for %="
+0000dc10: 0a0a 0a20 2020 2064 6566 205f 5f6c 656e  ...    def __len
+0000dc20: 5f5f 2873 656c 6629 3a0a 2020 2020 2020  __(self):.      
+0000dc30: 2020 2222 224c 656e 6774 6820 6f66 2074    """Length of t
+0000dc40: 6865 2073 6571 7565 6e63 6520 2861 6c77  he sequence (alw
+0000dc50: 6179 7320 3329 2e22 2222 0a20 2020 2020  ays 3).""".     
+0000dc60: 2020 2072 6574 7572 6e20 330a 0a20 2020     return 3..   
+0000dc70: 2064 6566 205f 5f67 6574 6974 656d 5f5f   def __getitem__
+0000dc80: 286d 6174 3320 7365 6c66 2c20 6b65 7929  (mat3 self, key)
+0000dc90: 3a0a 2020 2020 2020 2020 2222 2252 6574  :.        """Ret
+0000dca0: 7572 6e20 6120 636f 6c75 6d6e 206f 7220  urn a column or 
+0000dcb0: 6120 7369 6e67 6c65 206d 6174 7269 7820  a single matrix 
+0000dcc0: 656c 656d 656e 742e 0a20 2020 2020 2020  element..       
+0000dcd0: 2022 2222 0a20 2020 2020 2020 2063 6465   """.        cde
+0000dce0: 6620 696e 7420 692c 6a0a 0a20 2020 2020  f int i,j..     
+0000dcf0: 2020 2054 3d74 7970 6528 6b65 7929 0a20     T=type(key). 
+0000dd00: 2020 2020 2020 2069 6620 5420 6973 2069         if T is i
+0000dd10: 6e74 206f 7220 5420 6973 206c 6f6e 673a  nt or T is long:
+0000dd20: 0a20 2020 2020 2020 2020 2020 2069 203d  .            i =
+0000dd30: 206b 6579 0a20 2020 2020 2020 2020 2020   key.           
+0000dd40: 2069 6620 693d 3d30 3a0a 2020 2020 2020   if i==0:.      
+0000dd50: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0000dd60: 2076 6563 3328 7365 6c66 2e6d 3131 2c20   vec3(self.m11, 
+0000dd70: 7365 6c66 2e6d 3231 2c20 7365 6c66 2e6d  self.m21, self.m
+0000dd80: 3331 290a 2020 2020 2020 2020 2020 2020  31).            
+0000dd90: 656c 6966 2069 3d3d 313a 0a20 2020 2020  elif i==1:.     
+0000dda0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0000ddb0: 6e20 7665 6333 2873 656c 662e 6d31 322c  n vec3(self.m12,
+0000ddc0: 2073 656c 662e 6d32 322c 2073 656c 662e   self.m22, self.
+0000ddd0: 6d33 3229 0a20 2020 2020 2020 2020 2020  m32).           
+0000dde0: 2065 6c69 6620 693d 3d32 3a0a 2020 2020   elif i==2:.    
+0000ddf0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0000de00: 726e 2076 6563 3328 7365 6c66 2e6d 3133  rn vec3(self.m13
+0000de10: 2c20 7365 6c66 2e6d 3233 2c20 7365 6c66  , self.m23, self
+0000de20: 2e6d 3333 290a 2020 2020 2020 2020 2020  .m33).          
+0000de30: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+0000de40: 2020 2020 2020 2020 7261 6973 6520 496e          raise In
+0000de50: 6465 7845 7272 6f72 2c20 2269 6e64 6578  dexError, "index
+0000de60: 206f 7574 206f 6620 7261 6e67 6522 0a20   out of range". 
+0000de70: 2020 2020 2020 2065 6c69 6620 5420 6973         elif T is
+0000de80: 2074 7570 6c65 3a0a 2020 2020 2020 2020   tuple:.        
+0000de90: 2020 2020 6966 206c 656e 286b 6579 2921      if len(key)!
+0000dea0: 3d32 3a0a 2020 2020 2020 2020 2020 2020  =2:.            
+0000deb0: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+0000dec0: 7272 6f72 2c20 2269 6e64 6578 2074 7570  rror, "index tup
+0000ded0: 6c65 206d 7573 7420 6265 2061 2032 2d74  le must be a 2-t
+0000dee0: 7570 6c65 220a 2020 2020 2020 2020 2020  uple".          
+0000def0: 2020 6920 3d20 6b65 795b 305d 0a20 2020    i = key[0].   
+0000df00: 2020 2020 2020 2020 206a 203d 206b 6579           j = key
+0000df10: 5b31 5d0a 2020 2020 2020 2020 2020 2020  [1].            
+0000df20: 6966 2069 3c30 206f 7220 693e 3220 6f72  if i<0 or i>2 or
+0000df30: 206a 3c30 206f 7220 6a3e 323a 0a20 2020   j<0 or j>2:.   
+0000df40: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+0000df50: 7365 2049 6e64 6578 4572 726f 722c 2022  se IndexError, "
+0000df60: 696e 6465 7820 6f75 7420 6f66 2072 616e  index out of ran
+0000df70: 6765 220a 0a20 2020 2020 2020 2020 2020  ge"..           
+0000df80: 2069 6620 693d 3d30 3a0a 2020 2020 2020   if i==0:.      
+0000df90: 2020 2020 2020 2020 2020 6966 206a 3d3d            if j==
+0000dfa0: 303a 0a20 2020 2020 2020 2020 2020 2020  0:.             
+0000dfb0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+0000dfc0: 6c66 2e6d 3131 0a20 2020 2020 2020 2020  lf.m11.         
+0000dfd0: 2020 2020 2020 2065 6c69 6620 6a3d 3d31         elif j==1
+0000dfe0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0000dff0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+0000e000: 662e 6d31 320a 2020 2020 2020 2020 2020  f.m12.          
+0000e010: 2020 2020 2020 656c 6966 206a 3d3d 323a        elif j==2:
+0000e020: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000e030: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+0000e040: 2e6d 3133 0a20 2020 2020 2020 2020 2020  .m13.           
+0000e050: 2065 6c69 6620 693d 3d31 3a0a 2020 2020   elif i==1:.    
+0000e060: 2020 2020 2020 2020 2020 2020 6966 206a              if j
+0000e070: 3d3d 303a 0a20 2020 2020 2020 2020 2020  ==0:.           
+0000e080: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+0000e090: 7365 6c66 2e6d 3231 0a20 2020 2020 2020  self.m21.       
+0000e0a0: 2020 2020 2020 2020 2065 6c69 6620 6a3d           elif j=
+0000e0b0: 3d31 3a0a 2020 2020 2020 2020 2020 2020  =1:.            
+0000e0c0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+0000e0d0: 656c 662e 6d32 320a 2020 2020 2020 2020  elf.m22.        
+0000e0e0: 2020 2020 2020 2020 656c 6966 206a 3d3d          elif j==
+0000e0f0: 323a 0a20 2020 2020 2020 2020 2020 2020  2:.             
+0000e100: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+0000e110: 6c66 2e6d 3233 0a20 2020 2020 2020 2020  lf.m23.         
+0000e120: 2020 2065 6c69 6620 693d 3d32 3a0a 2020     elif i==2:.  
+0000e130: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0000e140: 206a 3d3d 303a 0a20 2020 2020 2020 2020   j==0:.         
+0000e150: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0000e160: 6e20 7365 6c66 2e6d 3331 0a20 2020 2020  n self.m31.     
+0000e170: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
+0000e180: 6a3d 3d31 3a0a 2020 2020 2020 2020 2020  j==1:.          
+0000e190: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0000e1a0: 2073 656c 662e 6d33 320a 2020 2020 2020   self.m32.      
+0000e1b0: 2020 2020 2020 2020 2020 656c 6966 206a            elif j
+0000e1c0: 3d3d 323a 0a20 2020 2020 2020 2020 2020  ==2:.           
+0000e1d0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+0000e1e0: 7365 6c66 2e6d 3333 0a20 2020 2020 2020  self.m33.       
+0000e1f0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+0000e200: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
+0000e210: 6f72 2c22 696e 6465 7820 6d75 7374 2062  or,"index must b
+0000e220: 6520 696e 7465 6765 7220 6f72 2032 2d74  e integer or 2-t
+0000e230: 7570 6c65 220a 0a20 2020 2064 6566 205f  uple"..    def _
+0000e240: 5f73 6574 6974 656d 5f5f 2873 656c 662c  _setitem__(self,
+0000e250: 206b 6579 2c20 7661 6c75 6529 3a0a 2020   key, value):.  
+0000e260: 2020 2020 2020 2222 2253 6574 2061 2063        """Set a c
+0000e270: 6f6c 756d 6e20 6f72 2061 2073 696e 676c  olumn or a singl
+0000e280: 6520 6d61 7472 6978 2065 6c65 6d65 6e74  e matrix element
+0000e290: 2e0a 0a20 2020 2020 2020 2054 6865 2063  ...        The c
+0000e2a0: 6f6c 756d 6e20 6d75 7374 2062 6520 6769  olumn must be gi
+0000e2b0: 7665 6e20 6173 2061 2033 2d73 6571 7565  ven as a 3-seque
+0000e2c0: 6e63 6520 2874 6869 7320 696e 636c 7564  nce (this includ
+0000e2d0: 6573 2076 6563 3320 6173 2077 656c 6c29  es vec3 as well)
+0000e2e0: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+0000e2f0: 2020 2020 2020 6364 6566 2069 6e74 2069        cdef int i
+0000e300: 2c6a 0a20 2020 2020 2020 2063 6465 6620  ,j.        cdef 
+0000e310: 646f 7562 6c65 2076 0a0a 2020 2020 2020  double v..      
+0000e320: 2020 543d 7479 7065 286b 6579 290a 2020    T=type(key).  
+0000e330: 2020 2020 2020 6966 2054 2069 7320 696e        if T is in
+0000e340: 7420 6f72 2054 2069 7320 6c6f 6e67 3a0a  t or T is long:.
+0000e350: 2020 2020 2020 2020 2020 2020 6966 206c              if l
+0000e360: 656e 2876 616c 7565 2921 3d33 3a0a 2020  en(value)!=3:.  
+0000e370: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+0000e380: 6973 6520 5661 6c75 6545 7272 6f72 2c20  ise ValueError, 
+0000e390: 2233 2d73 6571 7565 6e63 6520 6578 7065  "3-sequence expe
+0000e3a0: 6374 6564 220a 2020 2020 2020 2020 2020  cted".          
+0000e3b0: 2020 6920 3d20 6b65 790a 2020 2020 2020    i = key.      
+0000e3c0: 2020 2020 2020 6966 2069 3d3d 303a 0a20        if i==0:. 
+0000e3d0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0000e3e0: 656c 662e 6d31 3120 3d20 7661 6c75 655b  elf.m11 = value[
+0000e3f0: 305d 0a20 2020 2020 2020 2020 2020 2020  0].             
+0000e400: 2020 2073 656c 662e 6d32 3120 3d20 7661     self.m21 = va
+0000e410: 6c75 655b 315d 0a20 2020 2020 2020 2020  lue[1].         
+0000e420: 2020 2020 2020 2073 656c 662e 6d33 3120         self.m31 
+0000e430: 3d20 7661 6c75 655b 325d 0a20 2020 2020  = value[2].     
+0000e440: 2020 2020 2020 2065 6c69 6620 693d 3d31         elif i==1
+0000e450: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0000e460: 2020 7365 6c66 2e6d 3132 203d 2076 616c    self.m12 = val
+0000e470: 7565 5b30 5d0a 2020 2020 2020 2020 2020  ue[0].          
+0000e480: 2020 2020 2020 7365 6c66 2e6d 3232 203d        self.m22 =
+0000e490: 2076 616c 7565 5b31 5d0a 2020 2020 2020   value[1].      
+0000e4a0: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+0000e4b0: 3332 203d 2076 616c 7565 5b32 5d0a 2020  32 = value[2].  
+0000e4c0: 2020 2020 2020 2020 2020 656c 6966 2069            elif i
+0000e4d0: 3d3d 323a 0a20 2020 2020 2020 2020 2020  ==2:.           
+0000e4e0: 2020 2020 2073 656c 662e 6d31 3320 3d20       self.m13 = 
+0000e4f0: 7661 6c75 655b 305d 0a20 2020 2020 2020  value[0].       
+0000e500: 2020 2020 2020 2020 2073 656c 662e 6d32           self.m2
+0000e510: 3320 3d20 7661 6c75 655b 315d 0a20 2020  3 = value[1].   
+0000e520: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0000e530: 662e 6d33 3320 3d20 7661 6c75 655b 325d  f.m33 = value[2]
+0000e540: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
+0000e550: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+0000e560: 2020 2072 6169 7365 2049 6e64 6578 4572     raise IndexEr
+0000e570: 726f 722c 2022 696e 6465 7820 6f75 7420  ror, "index out 
+0000e580: 6f66 2072 616e 6765 220a 2020 2020 2020  of range".      
+0000e590: 2020 656c 6966 2054 2069 7320 7475 706c    elif T is tupl
+0000e5a0: 653a 0a20 2020 2020 2020 2020 2020 2069  e:.            i
+0000e5b0: 6620 6c65 6e28 6b65 7929 213d 323a 0a20  f len(key)!=2:. 
+0000e5c0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+0000e5d0: 6169 7365 2056 616c 7565 4572 726f 722c  aise ValueError,
+0000e5e0: 2022 696e 6465 7820 7475 706c 6520 6d75   "index tuple mu
+0000e5f0: 7374 2062 6520 6120 322d 7475 706c 6522  st be a 2-tuple"
+0000e600: 0a20 2020 2020 2020 2020 2020 2069 203d  .            i =
+0000e610: 206b 6579 5b30 5d0a 2020 2020 2020 2020   key[0].        
+0000e620: 2020 2020 6a20 3d20 6b65 795b 315d 0a20      j = key[1]. 
+0000e630: 2020 2020 2020 2020 2020 2076 203d 2076             v = v
+0000e640: 616c 7565 0a20 2020 2020 2020 2020 2020  alue.           
+0000e650: 2069 6620 693c 3020 6f72 2069 3e32 206f   if i<0 or i>2 o
+0000e660: 7220 6a3c 3020 6f72 206a 3e32 3a0a 2020  r j<0 or j>2:.  
+0000e670: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+0000e680: 6973 6520 496e 6465 7845 7272 6f72 2c20  ise IndexError, 
+0000e690: 2269 6e64 6578 206f 7574 206f 6620 7261  "index out of ra
+0000e6a0: 6e67 6522 0a0a 2020 2020 2020 2020 2020  nge"..          
+0000e6b0: 2020 6966 2069 3d3d 303a 0a20 2020 2020    if i==0:.     
+0000e6c0: 2020 2020 2020 2020 2020 2069 6620 6a3d             if j=
+0000e6d0: 3d30 3a0a 2020 2020 2020 2020 2020 2020  =0:.            
+0000e6e0: 2020 2020 2020 2020 7365 6c66 2e6d 3131          self.m11
+0000e6f0: 203d 2076 0a20 2020 2020 2020 2020 2020   = v.           
+0000e700: 2020 2020 2065 6c69 6620 6a3d 3d31 3a0a       elif j==1:.
+0000e710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e720: 2020 2020 7365 6c66 2e6d 3132 203d 2076      self.m12 = v
+0000e730: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000e740: 2065 6c69 6620 6a3d 3d32 3a0a 2020 2020   elif j==2:.    
+0000e750: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e760: 7365 6c66 2e6d 3133 203d 2076 0a20 2020  self.m13 = v.   
+0000e770: 2020 2020 2020 2020 2065 6c69 6620 693d           elif i=
+0000e780: 3d31 3a0a 2020 2020 2020 2020 2020 2020  =1:.            
+0000e790: 2020 2020 6966 206a 3d3d 303a 0a20 2020      if j==0:.   
 0000e7a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e7b0: 2020 2020 7365 6c66 2e6d 3232 203d 2076      self.m22 = v
-0000e7c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000e7d0: 2065 6c69 6620 6a3d 3d32 3a0a 2020 2020   elif j==2:.    
-0000e7e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e7f0: 7365 6c66 2e6d 3233 203d 2076 0a20 2020  self.m23 = v.   
-0000e800: 2020 2020 2020 2020 2065 6c69 6620 693d           elif i=
-0000e810: 3d32 3a0a 2020 2020 2020 2020 2020 2020  =2:.            
-0000e820: 2020 2020 6966 206a 3d3d 303a 0a20 2020      if j==0:.   
-0000e830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e840: 2073 656c 662e 6d33 3120 3d20 760a 2020   self.m31 = v.  
-0000e850: 2020 2020 2020 2020 2020 2020 2020 656c                el
-0000e860: 6966 206a 3d3d 313a 0a20 2020 2020 2020  if j==1:.       
-0000e870: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0000e880: 662e 6d33 3220 3d20 760a 2020 2020 2020  f.m32 = v.      
-0000e890: 2020 2020 2020 2020 2020 656c 6966 206a            elif j
-0000e8a0: 3d3d 323a 0a20 2020 2020 2020 2020 2020  ==2:.           
-0000e8b0: 2020 2020 2020 2020 2073 656c 662e 6d33           self.m3
-0000e8c0: 3320 3d20 760a 2020 2020 2020 2020 656c  3 = v.        el
-0000e8d0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-0000e8e0: 7261 6973 6520 5479 7065 4572 726f 722c  raise TypeError,
-0000e8f0: 2269 6e64 6578 206d 7573 7420 6265 2069  "index must be i
-0000e900: 6e74 6567 6572 206f 7220 322d 7475 706c  nteger or 2-tupl
-0000e910: 6522 0a0a 2020 2020 6465 6620 6765 7452  e"..    def getR
-0000e920: 6f77 2873 656c 662c 2069 6478 293a 0a20  ow(self, idx):. 
-0000e930: 2020 2020 2020 2022 2222 5265 7475 726e         """Return
-0000e940: 2072 6f77 2028 6173 2076 6563 3329 2e22   row (as vec3)."
-0000e950: 2222 0a20 2020 2020 2020 2063 6465 6620  "".        cdef 
-0000e960: 696e 7420 690a 0a20 2020 2020 2020 2054  int i..        T
-0000e970: 3d74 7970 6528 6964 7829 0a20 2020 2020  =type(idx).     
-0000e980: 2020 2069 6620 5421 3d69 6e74 2061 6e64     if T!=int and
-0000e990: 2054 213d 6c6f 6e67 3a0a 2020 2020 2020   T!=long:.      
-0000e9a0: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
-0000e9b0: 4572 726f 722c 2269 6e64 6578 206d 7573  Error,"index mus
-0000e9c0: 7420 6265 2069 6e74 6567 6572 220a 0a20  t be integer".. 
-0000e9d0: 2020 2020 2020 2069 203d 2069 6478 0a20         i = idx. 
-0000e9e0: 2020 2020 2020 2069 6620 693d 3d30 3a0a         if i==0:.
-0000e9f0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0000ea00: 726e 2076 6563 3328 7365 6c66 2e6d 3131  rn vec3(self.m11
-0000ea10: 2c20 7365 6c66 2e6d 3132 2c20 7365 6c66  , self.m12, self
-0000ea20: 2e6d 3133 290a 2020 2020 2020 2020 656c  .m13).        el
-0000ea30: 6966 2069 3d3d 313a 0a20 2020 2020 2020  if i==1:.       
-0000ea40: 2020 2020 2072 6574 7572 6e20 7665 6333       return vec3
-0000ea50: 2873 656c 662e 6d32 312c 2073 656c 662e  (self.m21, self.
-0000ea60: 6d32 322c 2073 656c 662e 6d32 3329 0a20  m22, self.m23). 
-0000ea70: 2020 2020 2020 2065 6c69 6620 693d 3d32         elif i==2
-0000ea80: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-0000ea90: 7475 726e 2076 6563 3328 7365 6c66 2e6d  turn vec3(self.m
-0000eaa0: 3331 2c20 7365 6c66 2e6d 3332 2c20 7365  31, self.m32, se
-0000eab0: 6c66 2e6d 3333 290a 2020 2020 2020 2020  lf.m33).        
-0000eac0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-0000ead0: 2020 7261 6973 6520 496e 6465 7845 7272    raise IndexErr
-0000eae0: 6f72 2c20 2269 6e64 6578 206f 7574 206f  or, "index out o
-0000eaf0: 6620 7261 6e67 6522 0a0a 2020 2020 6465  f range"..    de
-0000eb00: 6620 7365 7452 6f77 2873 656c 662c 2069  f setRow(self, i
-0000eb10: 6478 2c20 7661 6c75 6529 3a0a 2020 2020  dx, value):.    
-0000eb20: 2020 2020 2222 2253 6574 2072 6f77 2e22      """Set row."
-0000eb30: 2222 0a20 2020 2020 2020 2063 6465 6620  "".        cdef 
-0000eb40: 696e 7420 690a 0a20 2020 2020 2020 2054  int i..        T
-0000eb50: 3d74 7970 6528 6964 7829 0a20 2020 2020  =type(idx).     
-0000eb60: 2020 2069 6620 5421 3d69 6e74 2061 6e64     if T!=int and
-0000eb70: 2054 213d 6c6f 6e67 3a0a 2020 2020 2020   T!=long:.      
-0000eb80: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
-0000eb90: 4572 726f 722c 2269 6e64 6578 206d 7573  Error,"index mus
-0000eba0: 7420 6265 2069 6e74 6567 6572 220a 0a20  t be integer".. 
-0000ebb0: 2020 2020 2020 2069 6620 6c65 6e28 7661         if len(va
-0000ebc0: 6c75 6529 213d 333a 0a20 2020 2020 2020  lue)!=3:.       
-0000ebd0: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-0000ebe0: 4572 726f 722c 2022 332d 7365 7175 656e  Error, "3-sequen
-0000ebf0: 6365 2065 7870 6563 7465 6422 0a0a 2020  ce expected"..  
-0000ec00: 2020 2020 2020 6920 3d20 6964 780a 2020        i = idx.  
-0000ec10: 2020 2020 2020 6966 2069 3d3d 303a 0a20        if i==0:. 
-0000ec20: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0000ec30: 6d31 3120 3d20 7661 6c75 655b 305d 0a20  m11 = value[0]. 
-0000ec40: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0000ec50: 6d31 3220 3d20 7661 6c75 655b 315d 0a20  m12 = value[1]. 
-0000ec60: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0000ec70: 6d31 3320 3d20 7661 6c75 655b 325d 0a20  m13 = value[2]. 
-0000ec80: 2020 2020 2020 2065 6c69 6620 693d 3d31         elif i==1
-0000ec90: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-0000eca0: 6c66 2e6d 3231 203d 2076 616c 7565 5b30  lf.m21 = value[0
-0000ecb0: 5d0a 2020 2020 2020 2020 2020 2020 7365  ].            se
-0000ecc0: 6c66 2e6d 3232 203d 2076 616c 7565 5b31  lf.m22 = value[1
-0000ecd0: 5d0a 2020 2020 2020 2020 2020 2020 7365  ].            se
-0000ece0: 6c66 2e6d 3233 203d 2076 616c 7565 5b32  lf.m23 = value[2
-0000ecf0: 5d0a 2020 2020 2020 2020 656c 6966 2069  ].        elif i
-0000ed00: 3d3d 323a 0a20 2020 2020 2020 2020 2020  ==2:.           
-0000ed10: 2073 656c 662e 6d33 3120 3d20 7661 6c75   self.m31 = valu
-0000ed20: 655b 305d 0a20 2020 2020 2020 2020 2020  e[0].           
-0000ed30: 2073 656c 662e 6d33 3220 3d20 7661 6c75   self.m32 = valu
-0000ed40: 655b 315d 0a20 2020 2020 2020 2020 2020  e[1].           
-0000ed50: 2073 656c 662e 6d33 3320 3d20 7661 6c75   self.m33 = valu
-0000ed60: 655b 325d 0a20 2020 2020 2020 2065 6c73  e[2].        els
-0000ed70: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
-0000ed80: 6169 7365 2049 6e64 6578 4572 726f 722c  aise IndexError,
-0000ed90: 2022 696e 6465 7820 6f75 7420 6f66 2072   "index out of r
-0000eda0: 616e 6765 220a 0a0a 2020 2020 6465 6620  ange"...    def 
-0000edb0: 6765 7443 6f6c 756d 6e28 7365 6c66 2c20  getColumn(self, 
-0000edc0: 6964 7829 3a0a 2020 2020 2020 2020 2222  idx):.        ""
-0000edd0: 2252 6574 7572 6e20 636f 6c75 6d6e 2028  "Return column (
-0000ede0: 6173 2076 6563 3329 2e22 2222 0a20 2020  as vec3).""".   
-0000edf0: 2020 2020 2063 6465 6620 696e 7420 690a       cdef int i.
-0000ee00: 0a20 2020 2020 2020 2054 3d74 7970 6528  .        T=type(
-0000ee10: 6964 7829 0a20 2020 2020 2020 2069 6620  idx).        if 
-0000ee20: 5421 3d69 6e74 2061 6e64 2054 213d 6c6f  T!=int and T!=lo
-0000ee30: 6e67 3a0a 2020 2020 2020 2020 2020 2020  ng:.            
-0000ee40: 7261 6973 6520 5479 7065 4572 726f 722c  raise TypeError,
-0000ee50: 2269 6e64 6578 206d 7573 7420 6265 2069  "index must be i
-0000ee60: 6e74 6567 6572 220a 0a20 2020 2020 2020  nteger"..       
-0000ee70: 2069 203d 2069 6478 0a20 2020 2020 2020   i = idx.       
-0000ee80: 2069 6620 693d 3d30 3a0a 2020 2020 2020   if i==0:.      
-0000ee90: 2020 2020 2020 7265 7475 726e 2076 6563        return vec
-0000eea0: 3328 7365 6c66 2e6d 3131 2c20 7365 6c66  3(self.m11, self
-0000eeb0: 2e6d 3231 2c20 7365 6c66 2e6d 3331 290a  .m21, self.m31).
-0000eec0: 2020 2020 2020 2020 656c 6966 2069 3d3d          elif i==
-0000eed0: 313a 0a20 2020 2020 2020 2020 2020 2072  1:.            r
-0000eee0: 6574 7572 6e20 7665 6333 2873 656c 662e  eturn vec3(self.
-0000eef0: 6d31 322c 2073 656c 662e 6d32 322c 2073  m12, self.m22, s
-0000ef00: 656c 662e 6d33 3229 0a20 2020 2020 2020  elf.m32).       
-0000ef10: 2065 6c69 6620 693d 3d32 3a0a 2020 2020   elif i==2:.    
-0000ef20: 2020 2020 2020 2020 7265 7475 726e 2076          return v
-0000ef30: 6563 3328 7365 6c66 2e6d 3133 2c20 7365  ec3(self.m13, se
-0000ef40: 6c66 2e6d 3233 2c20 7365 6c66 2e6d 3333  lf.m23, self.m33
-0000ef50: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
-0000ef60: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-0000ef70: 6520 496e 6465 7845 7272 6f72 2c20 2269  e IndexError, "i
-0000ef80: 6e64 6578 206f 7574 206f 6620 7261 6e67  ndex out of rang
-0000ef90: 6522 0a0a 2020 2020 6465 6620 7365 7443  e"..    def setC
-0000efa0: 6f6c 756d 6e28 7365 6c66 2c20 6964 782c  olumn(self, idx,
-0000efb0: 2076 616c 7565 293a 0a20 2020 2020 2020   value):.       
-0000efc0: 2022 2222 5365 7420 636f 6c75 6d6e 2e22   """Set column."
-0000efd0: 2222 0a20 2020 2020 2020 2063 6465 6620  "".        cdef 
-0000efe0: 696e 7420 690a 0a20 2020 2020 2020 2054  int i..        T
-0000eff0: 3d74 7970 6528 6964 7829 0a20 2020 2020  =type(idx).     
-0000f000: 2020 2069 6620 5421 3d69 6e74 2061 6e64     if T!=int and
-0000f010: 2054 213d 6c6f 6e67 3a0a 2020 2020 2020   T!=long:.      
-0000f020: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
-0000f030: 4572 726f 722c 2269 6e64 6578 206d 7573  Error,"index mus
-0000f040: 7420 6265 2069 6e74 6567 6572 220a 0a20  t be integer".. 
-0000f050: 2020 2020 2020 2069 6620 6c65 6e28 7661         if len(va
-0000f060: 6c75 6529 213d 333a 0a20 2020 2020 2020  lue)!=3:.       
-0000f070: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-0000f080: 4572 726f 722c 2022 332d 7365 7175 656e  Error, "3-sequen
-0000f090: 6365 2065 7870 6563 7465 6422 0a0a 2020  ce expected"..  
-0000f0a0: 2020 2020 2020 6920 3d20 6964 780a 2020        i = idx.  
-0000f0b0: 2020 2020 2020 6966 2069 3d3d 303a 0a20        if i==0:. 
-0000f0c0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0000f0d0: 6d31 3120 3d20 7661 6c75 655b 305d 0a20  m11 = value[0]. 
-0000f0e0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0000f0f0: 6d32 3120 3d20 7661 6c75 655b 315d 0a20  m21 = value[1]. 
-0000f100: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0000f110: 6d33 3120 3d20 7661 6c75 655b 325d 0a20  m31 = value[2]. 
-0000f120: 2020 2020 2020 2065 6c69 6620 693d 3d31         elif i==1
-0000f130: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-0000f140: 6c66 2e6d 3132 203d 2076 616c 7565 5b30  lf.m12 = value[0
-0000f150: 5d0a 2020 2020 2020 2020 2020 2020 7365  ].            se
-0000f160: 6c66 2e6d 3232 203d 2076 616c 7565 5b31  lf.m22 = value[1
-0000f170: 5d0a 2020 2020 2020 2020 2020 2020 7365  ].            se
-0000f180: 6c66 2e6d 3332 203d 2076 616c 7565 5b32  lf.m32 = value[2
-0000f190: 5d0a 2020 2020 2020 2020 656c 6966 2069  ].        elif i
-0000f1a0: 3d3d 323a 0a20 2020 2020 2020 2020 2020  ==2:.           
-0000f1b0: 2073 656c 662e 6d31 3320 3d20 7661 6c75   self.m13 = valu
-0000f1c0: 655b 305d 0a20 2020 2020 2020 2020 2020  e[0].           
-0000f1d0: 2073 656c 662e 6d32 3320 3d20 7661 6c75   self.m23 = valu
-0000f1e0: 655b 315d 0a20 2020 2020 2020 2020 2020  e[1].           
-0000f1f0: 2073 656c 662e 6d33 3320 3d20 7661 6c75   self.m33 = valu
-0000f200: 655b 325d 0a20 2020 2020 2020 2065 6c73  e[2].        els
-0000f210: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
-0000f220: 6169 7365 2049 6e64 6578 4572 726f 722c  aise IndexError,
-0000f230: 2022 696e 6465 7820 6f75 7420 6f66 2072   "index out of r
-0000f240: 616e 6765 220a 0a0a 2020 2020 6465 6620  ange"...    def 
-0000f250: 746f 4c69 7374 2873 656c 662c 2072 6f77  toList(self, row
-0000f260: 6d61 6a6f 723d 3029 3a0a 2020 2020 2020  major=0):.      
-0000f270: 2020 2222 2252 6574 7572 6e20 6120 6c69    """Return a li
-0000f280: 7374 2063 6f6e 7461 696e 696e 6720 7468  st containing th
-0000f290: 6520 6d61 7472 6978 2065 6c65 6d65 6e74  e matrix element
-0000f2a0: 732e 0a0a 2020 2020 2020 2020 4279 2064  s...        By d
-0000f2b0: 6566 6175 6c74 2074 6865 206c 6973 7420  efault the list 
-0000f2c0: 6973 2069 6e20 636f 6c75 6d6e 2d6d 616a  is in column-maj
-0000f2d0: 6f72 206f 7264 6572 2e20 4966 2079 6f75  or order. If you
-0000f2e0: 2073 6574 2074 6865 0a20 2020 2020 2020   set the.       
-0000f2f0: 206f 7074 696f 6e61 6c20 6172 6775 6d65   optional argume
-0000f300: 6e74 2072 6f77 6d61 6a6f 7220 746f 2031  nt rowmajor to 1
-0000f310: 2c20 796f 7527 6c6c 2067 6574 2074 6865  , you'll get the
-0000f320: 206c 6973 7420 696e 2072 6f77 2d6d 616a   list in row-maj
-0000f330: 6f72 0a20 2020 2020 2020 206f 7264 6572  or.        order
-0000f340: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-0000f350: 2020 2020 2020 6966 2072 6f77 6d61 6a6f        if rowmajo
-0000f360: 723a 0a20 2020 2020 2020 2020 2020 2072  r:.            r
-0000f370: 6574 7572 6e20 5b73 656c 662e 6d31 312c  eturn [self.m11,
-0000f380: 2073 656c 662e 6d31 322c 2073 656c 662e   self.m12, self.
-0000f390: 6d31 332c 0a20 2020 2020 2020 2020 2020  m13,.           
-0000f3a0: 2020 2020 2020 2020 2073 656c 662e 6d32           self.m2
-0000f3b0: 312c 2073 656c 662e 6d32 322c 2073 656c  1, self.m22, sel
-0000f3c0: 662e 6d32 332c 0a20 2020 2020 2020 2020  f.m23,.         
-0000f3d0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0000f3e0: 6d33 312c 2073 656c 662e 6d33 322c 2073  m31, self.m32, s
-0000f3f0: 656c 662e 6d33 335d 0a20 2020 2020 2020  elf.m33].       
-0000f400: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-0000f410: 2020 2072 6574 7572 6e20 5b73 656c 662e     return [self.
-0000f420: 6d31 312c 2073 656c 662e 6d32 312c 2073  m11, self.m21, s
-0000f430: 656c 662e 6d33 312c 0a20 2020 2020 2020  elf.m31,.       
-0000f440: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0000f450: 662e 6d31 322c 2073 656c 662e 6d32 322c  f.m12, self.m22,
-0000f460: 2073 656c 662e 6d33 322c 0a20 2020 2020   self.m32,.     
-0000f470: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0000f480: 656c 662e 6d31 332c 2073 656c 662e 6d32  elf.m13, self.m2
-0000f490: 332c 2073 656c 662e 6d33 335d 0a0a 0a20  3, self.m33]... 
-0000f4a0: 2020 2064 6566 2069 6465 6e74 6974 7928     def identity(
-0000f4b0: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
-0000f4c0: 2222 5265 7475 726e 2069 6465 6e74 6974  ""Return identit
-0000f4d0: 7920 6d61 7472 6978 2e0a 2020 2020 2020  y matrix..      
-0000f4e0: 2020 2222 220a 2020 2020 2020 2020 6364    """.        cd
-0000f4f0: 6566 206d 6174 3320 7265 730a 2020 2020  ef mat3 res.    
-0000f500: 2020 2020 7265 7320 3d20 6d61 7433 2829      res = mat3()
-0000f510: 0a20 2020 2020 2020 2072 6573 2e6d 3131  .        res.m11
-0000f520: 203d 2031 2e30 0a20 2020 2020 2020 2072   = 1.0.        r
-0000f530: 6573 2e6d 3132 203d 2030 2e30 0a20 2020  es.m12 = 0.0.   
-0000f540: 2020 2020 2072 6573 2e6d 3133 203d 2030       res.m13 = 0
-0000f550: 2e30 0a20 2020 2020 2020 2072 6573 2e6d  .0.        res.m
-0000f560: 3231 203d 2030 2e30 0a20 2020 2020 2020  21 = 0.0.       
-0000f570: 2072 6573 2e6d 3232 203d 2031 2e30 0a20   res.m22 = 1.0. 
-0000f580: 2020 2020 2020 2072 6573 2e6d 3233 203d         res.m23 =
-0000f590: 2030 2e30 0a20 2020 2020 2020 2072 6573   0.0.        res
-0000f5a0: 2e6d 3331 203d 2030 2e30 0a20 2020 2020  .m31 = 0.0.     
-0000f5b0: 2020 2072 6573 2e6d 3332 203d 2030 2e30     res.m32 = 0.0
-0000f5c0: 0a20 2020 2020 2020 2072 6573 2e6d 3333  .        res.m33
-0000f5d0: 203d 2031 2e30 0a20 2020 2020 2020 2072   = 1.0.        r
-0000f5e0: 6574 7572 6e20 7265 730a 0a20 2020 2064  eturn res..    d
-0000f5f0: 6566 2074 7261 6e73 706f 7365 2873 656c  ef transpose(sel
-0000f600: 6629 3a0a 2020 2020 2020 2020 2222 2252  f):.        """R
-0000f610: 6574 7572 6e20 7472 616e 7370 6f73 6520  eturn transpose 
-0000f620: 6d61 7472 6978 2e0a 2020 2020 2020 2020  matrix..        
-0000f630: 2222 220a 2020 2020 2020 2020 6364 6566  """.        cdef
-0000f640: 206d 6174 3320 7265 730a 2020 2020 2020   mat3 res.      
-0000f650: 2020 7265 7320 3d20 6d61 7433 2829 0a20    res = mat3(). 
-0000f660: 2020 2020 2020 2072 6573 2e6d 3131 203d         res.m11 =
-0000f670: 2073 656c 662e 6d31 310a 2020 2020 2020   self.m11.      
-0000f680: 2020 7265 732e 6d31 3220 3d20 7365 6c66    res.m12 = self
-0000f690: 2e6d 3231 0a20 2020 2020 2020 2072 6573  .m21.        res
-0000f6a0: 2e6d 3133 203d 2073 656c 662e 6d33 310a  .m13 = self.m31.
-0000f6b0: 2020 2020 2020 2020 7265 732e 6d32 3120          res.m21 
-0000f6c0: 3d20 7365 6c66 2e6d 3132 0a20 2020 2020  = self.m12.     
-0000f6d0: 2020 2072 6573 2e6d 3232 203d 2073 656c     res.m22 = sel
-0000f6e0: 662e 6d32 320a 2020 2020 2020 2020 7265  f.m22.        re
-0000f6f0: 732e 6d32 3320 3d20 7365 6c66 2e6d 3332  s.m23 = self.m32
-0000f700: 0a20 2020 2020 2020 2072 6573 2e6d 3331  .        res.m31
-0000f710: 203d 2073 656c 662e 6d31 330a 2020 2020   = self.m13.    
-0000f720: 2020 2020 7265 732e 6d33 3220 3d20 7365      res.m32 = se
-0000f730: 6c66 2e6d 3233 0a20 2020 2020 2020 2072  lf.m23.        r
-0000f740: 6573 2e6d 3333 203d 2073 656c 662e 6d33  es.m33 = self.m3
-0000f750: 330a 2020 2020 2020 2020 7265 7475 726e  3.        return
-0000f760: 2072 6573 0a0a 2020 2020 6465 6620 6465   res..    def de
-0000f770: 7465 726d 696e 616e 7428 7365 6c66 293a  terminant(self):
-0000f780: 0a20 2020 2020 2020 2022 2222 5265 7475  .        """Retu
-0000f790: 726e 2064 6574 6572 6d69 6e61 6e74 2e0a  rn determinant..
-0000f7a0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0000f7b0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-0000f7c0: 6d31 312a 7365 6c66 2e6d 3232 2a73 656c  m11*self.m22*sel
-0000f7d0: 662e 6d33 332b 205c 0a20 2020 2020 2020  f.m33+ \.       
-0000f7e0: 2020 2020 2020 2020 7365 6c66 2e6d 3132          self.m12
-0000f7f0: 2a73 656c 662e 6d32 332a 7365 6c66 2e6d  *self.m23*self.m
-0000f800: 3331 2b20 5c0a 2020 2020 2020 2020 2020  31+ \.          
-0000f810: 2020 2020 2073 656c 662e 6d31 332a 7365       self.m13*se
-0000f820: 6c66 2e6d 3231 2a73 656c 662e 6d33 322d  lf.m21*self.m32-
-0000f830: 205c 0a20 2020 2020 2020 2020 2020 2020   \.             
-0000f840: 2020 7365 6c66 2e6d 3331 2a73 656c 662e    self.m31*self.
-0000f850: 6d32 322a 7365 6c66 2e6d 3133 2d20 5c0a  m22*self.m13- \.
-0000f860: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0000f870: 656c 662e 6d33 322a 7365 6c66 2e6d 3233  elf.m32*self.m23
-0000f880: 2a73 656c 662e 6d31 312d 205c 0a20 2020  *self.m11- \.   
-0000f890: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0000f8a0: 2e6d 3333 2a73 656c 662e 6d32 312a 7365  .m33*self.m21*se
-0000f8b0: 6c66 2e6d 3132 0a0a 2020 2020 6465 6620  lf.m12..    def 
-0000f8c0: 696e 7665 7273 6528 7365 6c66 293a 0a20  inverse(self):. 
-0000f8d0: 2020 2020 2020 2022 2222 5265 7475 726e         """Return
-0000f8e0: 2069 6e76 6572 7365 206d 6174 7269 782e   inverse matrix.
-0000f8f0: 2222 220a 2020 2020 2020 2020 6364 6566  """.        cdef
-0000f900: 206d 6174 3320 7265 730a 2020 2020 2020   mat3 res.      
-0000f910: 2020 6364 6566 2064 6f75 626c 6520 640a    cdef double d.
-0000f920: 0a20 2020 2020 2020 2064 203d 2073 656c  .        d = sel
-0000f930: 662e 6465 7465 726d 696e 616e 7428 290a  f.determinant().
-0000f940: 2020 2020 2020 2020 6966 2066 6162 7328          if fabs(
-0000f950: 6429 3c3d 6570 733a 0a20 2020 2020 2020  d)<=eps:.       
-0000f960: 2020 2020 2072 6169 7365 205a 6572 6f44       raise ZeroD
-0000f970: 6976 6973 696f 6e45 7272 6f72 2c20 226d  ivisionError, "m
-0000f980: 6174 7269 7820 6973 206e 6f74 2069 6e76  atrix is not inv
-0000f990: 6572 7469 626c 6522 0a0a 2020 2020 2020  ertible"..      
-0000f9a0: 2020 6420 3d20 312e 302f 640a 0a20 2020    d = 1.0/d..   
-0000f9b0: 2020 2020 2072 6573 3d6d 6174 3328 290a       res=mat3().
-0000f9c0: 2020 2020 2020 2020 7265 732e 6d31 3120          res.m11 
-0000f9d0: 3d20 642a 2873 656c 662e 6d32 322a 7365  = d*(self.m22*se
-0000f9e0: 6c66 2e6d 3333 2d73 656c 662e 6d32 332a  lf.m33-self.m23*
-0000f9f0: 7365 6c66 2e6d 3332 290a 2020 2020 2020  self.m32).      
-0000fa00: 2020 7265 732e 6d31 3220 3d20 642a 2873    res.m12 = d*(s
-0000fa10: 656c 662e 6d33 322a 7365 6c66 2e6d 3133  elf.m32*self.m13
-0000fa20: 2d73 656c 662e 6d31 322a 7365 6c66 2e6d  -self.m12*self.m
-0000fa30: 3333 290a 2020 2020 2020 2020 7265 732e  33).        res.
-0000fa40: 6d31 3320 3d20 642a 2873 656c 662e 6d31  m13 = d*(self.m1
-0000fa50: 322a 7365 6c66 2e6d 3233 2d73 656c 662e  2*self.m23-self.
-0000fa60: 6d32 322a 7365 6c66 2e6d 3133 290a 2020  m22*self.m13).  
-0000fa70: 2020 2020 2020 7265 732e 6d32 3120 3d20        res.m21 = 
-0000fa80: 642a 2873 656c 662e 6d32 332a 7365 6c66  d*(self.m23*self
-0000fa90: 2e6d 3331 2d73 656c 662e 6d32 312a 7365  .m31-self.m21*se
-0000faa0: 6c66 2e6d 3333 290a 2020 2020 2020 2020  lf.m33).        
-0000fab0: 7265 732e 6d32 3220 3d20 642a 2873 656c  res.m22 = d*(sel
-0000fac0: 662e 6d31 312a 7365 6c66 2e6d 3333 2d73  f.m11*self.m33-s
-0000fad0: 656c 662e 6d33 312a 7365 6c66 2e6d 3133  elf.m31*self.m13
-0000fae0: 290a 2020 2020 2020 2020 7265 732e 6d32  ).        res.m2
-0000faf0: 3320 3d20 642a 2873 656c 662e 6d32 312a  3 = d*(self.m21*
-0000fb00: 7365 6c66 2e6d 3133 2d73 656c 662e 6d31  self.m13-self.m1
-0000fb10: 312a 7365 6c66 2e6d 3233 290a 2020 2020  1*self.m23).    
-0000fb20: 2020 2020 7265 732e 6d33 3120 3d20 642a      res.m31 = d*
-0000fb30: 2873 656c 662e 6d32 312a 7365 6c66 2e6d  (self.m21*self.m
-0000fb40: 3332 2d73 656c 662e 6d33 312a 7365 6c66  32-self.m31*self
-0000fb50: 2e6d 3232 290a 2020 2020 2020 2020 7265  .m22).        re
-0000fb60: 732e 6d33 3220 3d20 642a 2873 656c 662e  s.m32 = d*(self.
-0000fb70: 6d33 312a 7365 6c66 2e6d 3132 2d73 656c  m31*self.m12-sel
-0000fb80: 662e 6d31 312a 7365 6c66 2e6d 3332 290a  f.m11*self.m32).
-0000fb90: 2020 2020 2020 2020 7265 732e 6d33 3320          res.m33 
-0000fba0: 3d20 642a 2873 656c 662e 6d31 312a 7365  = d*(self.m11*se
-0000fbb0: 6c66 2e6d 3232 2d73 656c 662e 6d31 322a  lf.m22-self.m12*
-0000fbc0: 7365 6c66 2e6d 3231 290a 2020 2020 2020  self.m21).      
-0000fbd0: 2020 7265 7475 726e 2072 6573 0a0a 2020    return res..  
-0000fbe0: 2020 6465 6620 7363 616c 696e 6728 7365    def scaling(se
-0000fbf0: 6c66 2c20 7329 3a0a 2020 2020 2020 2020  lf, s):.        
-0000fc00: 2222 2252 6574 7572 6e20 7363 616c 696e  """Return scalin
-0000fc10: 6720 6d61 7472 6978 2e22 2222 0a20 2020  g matrix.""".   
-0000fc20: 2020 2020 2063 6465 6620 6d61 7433 2072       cdef mat3 r
-0000fc30: 6573 0a20 2020 2020 2020 2072 6573 203d  es.        res =
-0000fc40: 206d 6174 3328 290a 2020 2020 2020 2020   mat3().        
-0000fc50: 7265 732e 6d31 3120 3d20 735b 305d 0a20  res.m11 = s[0]. 
-0000fc60: 2020 2020 2020 2072 6573 2e6d 3132 203d         res.m12 =
-0000fc70: 2030 2e30 0a20 2020 2020 2020 2072 6573   0.0.        res
-0000fc80: 2e6d 3133 203d 2030 2e30 0a20 2020 2020  .m13 = 0.0.     
-0000fc90: 2020 2072 6573 2e6d 3231 203d 2030 2e30     res.m21 = 0.0
-0000fca0: 0a20 2020 2020 2020 2072 6573 2e6d 3232  .        res.m22
-0000fcb0: 203d 2073 5b31 5d0a 2020 2020 2020 2020   = s[1].        
-0000fcc0: 7265 732e 6d32 3320 3d20 302e 300a 2020  res.m23 = 0.0.  
-0000fcd0: 2020 2020 2020 7265 732e 6d33 3120 3d20        res.m31 = 
-0000fce0: 302e 300a 2020 2020 2020 2020 7265 732e  0.0.        res.
-0000fcf0: 6d33 3220 3d20 302e 300a 2020 2020 2020  m32 = 0.0.      
-0000fd00: 2020 7265 732e 6d33 3320 3d20 735b 325d    res.m33 = s[2]
-0000fd10: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0000fd20: 7265 730a 0a20 2020 2064 6566 2072 6f74  res..    def rot
-0000fd30: 6174 696f 6e28 7365 6c66 2c20 616e 676c  ation(self, angl
-0000fd40: 652c 2061 7869 7329 3a0a 2020 2020 2020  e, axis):.      
-0000fd50: 2020 2222 2252 6574 7572 6e20 726f 7461    """Return rota
-0000fd60: 7469 6f6e 206d 6174 7269 782e 0a0a 2020  tion matrix...  
-0000fd70: 2020 2020 2020 616e 676c 6520 6d75 7374        angle must
-0000fd80: 2062 6520 6769 7665 6e20 696e 2072 6164   be given in rad
-0000fd90: 6961 6e73 2e20 6178 6973 206d 7573 7420  ians. axis must 
-0000fda0: 6265 2061 2033 2d73 6571 7565 6e63 652e  be a 3-sequence.
-0000fdb0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0000fdc0: 2020 2020 2063 6465 6620 646f 7562 6c65       cdef double
-0000fdd0: 2063 616e 676c 652c 2061 782c 2061 792c   cangle, ax, ay,
-0000fde0: 2061 7a0a 2020 2020 2020 2020 6364 6566   az.        cdef
-0000fdf0: 2064 6f75 626c 6520 7371 725f 612c 2073   double sqr_a, s
-0000fe00: 7172 5f62 2c20 7371 725f 632c 206c 656e  qr_b, sqr_c, len
-0000fe10: 320a 2020 2020 2020 2020 6364 6566 2064  2.        cdef d
-0000fe20: 6f75 626c 6520 6b31 2c20 6b32 2c20 6b33  ouble k1, k2, k3
-0000fe30: 2c20 6b31 6162 2c20 6b31 6163 2c20 6b31  , k1ab, k1ac, k1
-0000fe40: 6263 2c20 6b33 612c 206b 3362 2c20 6b33  bc, k3a, k3b, k3
-0000fe50: 630a 2020 2020 2020 2020 6364 6566 206d  c.        cdef m
-0000fe60: 6174 3320 7265 730a 0a20 2020 2020 2020  at3 res..       
-0000fe70: 2063 616e 676c 6520 2020 3d20 616e 676c   cangle   = angl
-0000fe80: 650a 2020 2020 2020 2020 6178 2020 2020  e.        ax    
-0000fe90: 3d20 6178 6973 5b30 5d0a 2020 2020 2020  = axis[0].      
-0000fea0: 2020 6179 2020 2020 3d20 6178 6973 5b31    ay    = axis[1
-0000feb0: 5d0a 2020 2020 2020 2020 617a 2020 2020  ].        az    
-0000fec0: 3d20 6178 6973 5b32 5d0a 2020 2020 2020  = axis[2].      
-0000fed0: 2020 7371 725f 6120 3d20 6178 2a61 780a    sqr_a = ax*ax.
-0000fee0: 2020 2020 2020 2020 7371 725f 6220 3d20          sqr_b = 
-0000fef0: 6179 2a61 790a 2020 2020 2020 2020 7371  ay*ay.        sq
-0000ff00: 725f 6320 3d20 617a 2a61 7a0a 2020 2020  r_c = az*az.    
-0000ff10: 2020 2020 6c65 6e32 2020 3d20 7371 725f      len2  = sqr_
-0000ff20: 612b 7371 725f 622b 7371 725f 630a 0a20  a+sqr_b+sqr_c.. 
-0000ff30: 2020 2020 2020 206b 3220 2020 203d 2063         k2    = c
-0000ff40: 6f73 2863 616e 676c 6529 0a20 2020 2020  os(cangle).     
-0000ff50: 2020 206b 3120 2020 203d 2028 312e 302d     k1    = (1.0-
-0000ff60: 6b32 292f 6c65 6e32 0a20 2020 2020 2020  k2)/len2.       
-0000ff70: 206b 3320 2020 203d 2073 696e 2863 616e   k3    = sin(can
-0000ff80: 676c 6529 2f73 7172 7428 6c65 6e32 290a  gle)/sqrt(len2).
-0000ff90: 2020 2020 2020 2020 6b31 6162 2020 3d20          k1ab  = 
-0000ffa0: 6b31 2a61 782a 6179 0a20 2020 2020 2020  k1*ax*ay.       
-0000ffb0: 206b 3161 6320 203d 206b 312a 6178 2a61   k1ac  = k1*ax*a
-0000ffc0: 7a0a 2020 2020 2020 2020 6b31 6263 2020  z.        k1bc  
-0000ffd0: 3d20 6b31 2a61 792a 617a 0a20 2020 2020  = k1*ay*az.     
-0000ffe0: 2020 206b 3361 2020 203d 206b 332a 6178     k3a   = k3*ax
-0000fff0: 0a20 2020 2020 2020 206b 3362 2020 203d  .        k3b   =
-00010000: 206b 332a 6179 0a20 2020 2020 2020 206b   k3*ay.        k
-00010010: 3363 2020 203d 206b 332a 617a 0a0a 2020  3c   = k3*az..  
-00010020: 2020 2020 2020 7265 7320 3d20 6d61 7433        res = mat3
-00010030: 2829 0a20 2020 2020 2020 2072 6573 2e6d  ().        res.m
-00010040: 3131 203d 206b 312a 7371 725f 612b 6b32  11 = k1*sqr_a+k2
-00010050: 0a20 2020 2020 2020 2072 6573 2e6d 3132  .        res.m12
-00010060: 203d 206b 3161 622d 6b33 630a 2020 2020   = k1ab-k3c.    
-00010070: 2020 2020 7265 732e 6d31 3320 3d20 6b31      res.m13 = k1
-00010080: 6163 2b6b 3362 0a20 2020 2020 2020 2072  ac+k3b.        r
-00010090: 6573 2e6d 3231 203d 206b 3161 622b 6b33  es.m21 = k1ab+k3
-000100a0: 630a 2020 2020 2020 2020 7265 732e 6d32  c.        res.m2
-000100b0: 3220 3d20 6b31 2a73 7172 5f62 2b6b 320a  2 = k1*sqr_b+k2.
-000100c0: 2020 2020 2020 2020 7265 732e 6d32 3320          res.m23 
-000100d0: 3d20 6b31 6263 2d6b 3361 0a20 2020 2020  = k1bc-k3a.     
-000100e0: 2020 2072 6573 2e6d 3331 203d 206b 3161     res.m31 = k1a
-000100f0: 632d 6b33 620a 2020 2020 2020 2020 7265  c-k3b.        re
-00010100: 732e 6d33 3220 3d20 6b31 6263 2b6b 3361  s.m32 = k1bc+k3a
-00010110: 0a20 2020 2020 2020 2072 6573 2e6d 3333  .        res.m33
-00010120: 203d 206b 312a 7371 725f 632b 6b32 0a20   = k1*sqr_c+k2. 
-00010130: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
-00010140: 730a 0a0a 2020 2020 6465 6620 7363 616c  s...    def scal
-00010150: 6528 7365 6c66 2c20 7329 3a0a 2020 2020  e(self, s):.    
-00010160: 2020 2020 2222 2243 6f6e 6361 7465 6e61      """Concatena
-00010170: 7465 2061 2073 6361 6c69 6e67 2e22 2222  te a scaling."""
-00010180: 0a20 2020 2020 2020 2063 6465 6620 646f  .        cdef do
-00010190: 7562 6c65 2073 782c 2073 792c 2073 7a0a  uble sx, sy, sz.
-000101a0: 2020 2020 2020 2020 7378 203d 2073 5b30          sx = s[0
-000101b0: 5d0a 2020 2020 2020 2020 7379 203d 2073  ].        sy = s
-000101c0: 5b31 5d0a 2020 2020 2020 2020 737a 203d  [1].        sz =
-000101d0: 2073 5b32 5d0a 2020 2020 2020 2020 7365   s[2].        se
-000101e0: 6c66 2e6d 3131 203d 2073 656c 662e 6d31  lf.m11 = self.m1
-000101f0: 312a 7378 0a20 2020 2020 2020 2073 656c  1*sx.        sel
-00010200: 662e 6d31 3220 3d20 7365 6c66 2e6d 3132  f.m12 = self.m12
-00010210: 2a73 790a 2020 2020 2020 2020 7365 6c66  *sy.        self
-00010220: 2e6d 3133 203d 2073 656c 662e 6d31 332a  .m13 = self.m13*
-00010230: 737a 0a20 2020 2020 2020 2073 656c 662e  sz.        self.
-00010240: 6d32 3120 3d20 7365 6c66 2e6d 3231 2a73  m21 = self.m21*s
-00010250: 780a 2020 2020 2020 2020 7365 6c66 2e6d  x.        self.m
-00010260: 3232 203d 2073 656c 662e 6d32 322a 7379  22 = self.m22*sy
-00010270: 0a20 2020 2020 2020 2073 656c 662e 6d32  .        self.m2
-00010280: 3320 3d20 7365 6c66 2e6d 3233 2a73 7a0a  3 = self.m23*sz.
-00010290: 2020 2020 2020 2020 7365 6c66 2e6d 3331          self.m31
-000102a0: 203d 2073 656c 662e 6d33 312a 7378 0a20   = self.m31*sx. 
-000102b0: 2020 2020 2020 2073 656c 662e 6d33 3220         self.m32 
-000102c0: 3d20 7365 6c66 2e6d 3332 2a73 790a 2020  = self.m32*sy.  
-000102d0: 2020 2020 2020 7365 6c66 2e6d 3333 203d        self.m33 =
-000102e0: 2073 656c 662e 6d33 332a 737a 0a20 2020   self.m33*sz.   
-000102f0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00010300: 0a0a 2020 2020 6465 6620 726f 7461 7465  ..    def rotate
-00010310: 2873 656c 662c 2061 6e67 6c65 2c20 6178  (self, angle, ax
-00010320: 6973 293a 0a20 2020 2020 2020 2022 2222  is):.        """
-00010330: 436f 6e63 6174 656e 6174 6520 6120 726f  Concatenate a ro
-00010340: 7461 7469 6f6e 2e0a 0a20 2020 2020 2020  tation...       
-00010350: 2061 6e67 6c65 206d 7573 7420 6265 2067   angle must be g
-00010360: 6976 656e 2069 6e20 7261 6469 616e 732e  iven in radians.
-00010370: 2061 7869 7320 6d75 7374 2062 6520 6120   axis must be a 
-00010380: 332d 7365 7175 656e 6365 2e0a 2020 2020  3-sequence..    
-00010390: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-000103a0: 6364 6566 206d 6174 3320 520a 2020 2020  cdef mat3 R.    
-000103b0: 2020 2020 6364 6566 2064 6f75 626c 6520      cdef double 
-000103c0: 6331 2c20 6332 2c20 6333 0a20 2020 2020  c1, c2, c3.     
-000103d0: 2020 2052 3d73 656c 662e 726f 7461 7469     R=self.rotati
-000103e0: 6f6e 2861 6e67 6c65 2c20 6178 6973 290a  on(angle, axis).
-000103f0: 0a20 2020 2020 2020 2023 2073 656c 662a  .        # self*
-00010400: 5220 2028 696e 2d70 6c61 6365 290a 2020  R  (in-place).  
-00010410: 2020 2020 2020 6331 203d 2073 656c 662e        c1 = self.
-00010420: 6d31 310a 2020 2020 2020 2020 6332 203d  m11.        c2 =
-00010430: 2073 656c 662e 6d31 320a 2020 2020 2020   self.m12.      
-00010440: 2020 6333 203d 2073 656c 662e 6d31 330a    c3 = self.m13.
-00010450: 2020 2020 2020 2020 7365 6c66 2e6d 3131          self.m11
-00010460: 203d 2063 312a 522e 6d31 312b 6332 2a52   = c1*R.m11+c2*R
-00010470: 2e6d 3231 2b63 332a 522e 6d33 310a 2020  .m21+c3*R.m31.  
-00010480: 2020 2020 2020 7365 6c66 2e6d 3132 203d        self.m12 =
-00010490: 2063 312a 522e 6d31 322b 6332 2a52 2e6d   c1*R.m12+c2*R.m
-000104a0: 3232 2b63 332a 522e 6d33 320a 2020 2020  22+c3*R.m32.    
-000104b0: 2020 2020 7365 6c66 2e6d 3133 203d 2063      self.m13 = c
-000104c0: 312a 522e 6d31 332b 6332 2a52 2e6d 3233  1*R.m13+c2*R.m23
-000104d0: 2b63 332a 522e 6d33 330a 0a20 2020 2020  +c3*R.m33..     
-000104e0: 2020 2063 3120 3d20 7365 6c66 2e6d 3231     c1 = self.m21
-000104f0: 0a20 2020 2020 2020 2063 3220 3d20 7365  .        c2 = se
-00010500: 6c66 2e6d 3232 0a20 2020 2020 2020 2063  lf.m22.        c
-00010510: 3320 3d20 7365 6c66 2e6d 3233 0a20 2020  3 = self.m23.   
-00010520: 2020 2020 2073 656c 662e 6d32 3120 3d20       self.m21 = 
-00010530: 6331 2a52 2e6d 3131 2b63 322a 522e 6d32  c1*R.m11+c2*R.m2
-00010540: 312b 6333 2a52 2e6d 3331 0a20 2020 2020  1+c3*R.m31.     
-00010550: 2020 2073 656c 662e 6d32 3220 3d20 6331     self.m22 = c1
-00010560: 2a52 2e6d 3132 2b63 322a 522e 6d32 322b  *R.m12+c2*R.m22+
-00010570: 6333 2a52 2e6d 3332 0a20 2020 2020 2020  c3*R.m32.       
-00010580: 2073 656c 662e 6d32 3320 3d20 6331 2a52   self.m23 = c1*R
-00010590: 2e6d 3133 2b63 322a 522e 6d32 332b 6333  .m13+c2*R.m23+c3
-000105a0: 2a52 2e6d 3333 0a0a 2020 2020 2020 2020  *R.m33..        
-000105b0: 6331 203d 2073 656c 662e 6d33 310a 2020  c1 = self.m31.  
-000105c0: 2020 2020 2020 6332 203d 2073 656c 662e        c2 = self.
-000105d0: 6d33 320a 2020 2020 2020 2020 6333 203d  m32.        c3 =
-000105e0: 2073 656c 662e 6d33 330a 2020 2020 2020   self.m33.      
-000105f0: 2020 7365 6c66 2e6d 3331 203d 2063 312a    self.m31 = c1*
-00010600: 522e 6d31 312b 6332 2a52 2e6d 3231 2b63  R.m11+c2*R.m21+c
-00010610: 332a 522e 6d33 310a 2020 2020 2020 2020  3*R.m31.        
-00010620: 7365 6c66 2e6d 3332 203d 2063 312a 522e  self.m32 = c1*R.
-00010630: 6d31 322b 6332 2a52 2e6d 3232 2b63 332a  m12+c2*R.m22+c3*
-00010640: 522e 6d33 320a 2020 2020 2020 2020 7365  R.m32.        se
-00010650: 6c66 2e6d 3333 203d 2063 312a 522e 6d31  lf.m33 = c1*R.m1
-00010660: 332b 6332 2a52 2e6d 3233 2b63 332a 522e  3+c2*R.m23+c3*R.
-00010670: 6d33 330a 0a20 2020 2020 2020 2072 6574  m33..        ret
-00010680: 7572 6e20 7365 6c66 0a0a 2020 2020 6465  urn self..    de
-00010690: 6620 6f72 7468 6f28 7365 6c66 293a 0a20  f ortho(self):. 
-000106a0: 2020 2020 2020 2022 2222 5265 7475 726e         """Return
-000106b0: 2061 206d 6174 7269 7820 7769 7468 206f   a matrix with o
-000106c0: 7274 686f 676f 6e61 6c20 6261 7365 2076  rthogonal base v
-000106d0: 6563 746f 7273 2e0a 0a20 2020 2020 2020  ectors...       
-000106e0: 204d 616b 6573 2074 6865 2078 2d2c 2079   Makes the x-, y
-000106f0: 2d20 616e 6420 7a2d 6178 6973 206f 7274  - and z-axis ort
-00010700: 686f 676f 6e61 6c2e 0a20 2020 2020 2020  hogonal..       
-00010710: 2022 2222 0a20 2020 2020 2020 2063 6465   """.        cde
-00010720: 6620 6d61 7433 2072 6573 0a20 2020 2020  f mat3 res.     
-00010730: 2020 2063 6465 6620 7665 6333 2078 2c79     cdef vec3 x,y
-00010740: 2c7a 0a0a 2020 2020 2020 2020 7820 3d20  ,z..        x = 
-00010750: 7665 6333 2873 656c 662e 6d31 312c 2073  vec3(self.m11, s
-00010760: 656c 662e 6d32 312c 2073 656c 662e 6d33  elf.m21, self.m3
-00010770: 3129 0a20 2020 2020 2020 2079 203d 2076  1).        y = v
-00010780: 6563 3328 7365 6c66 2e6d 3132 2c20 7365  ec3(self.m12, se
-00010790: 6c66 2e6d 3232 2c20 7365 6c66 2e6d 3332  lf.m22, self.m32
-000107a0: 290a 2020 2020 2020 2020 7a20 3d20 7665  ).        z = ve
-000107b0: 6333 2873 656c 662e 6d31 332c 2073 656c  c3(self.m13, sel
-000107c0: 662e 6d32 332c 2073 656c 662e 6d33 3329  f.m23, self.m33)
-000107d0: 0a0a 2020 2020 2020 2020 786c 203d 2078  ..        xl = x
-000107e0: 2e6c 656e 6774 6828 290a 2020 2020 2020  .length().      
-000107f0: 2020 786c 203d 2078 6c2a 786c 0a20 2020    xl = xl*xl.   
-00010800: 2020 2020 2079 203d 2079 202d 2028 2878       y = y - ((x
-00010810: 2a79 292f 786c 292a 780a 2020 2020 2020  *y)/xl)*x.      
-00010820: 2020 7a20 3d20 7a20 2d20 2828 782a 7a29    z = z - ((x*z)
-00010830: 2f78 6c29 2a78 0a0a 2020 2020 2020 2020  /xl)*x..        
-00010840: 796c 203d 2079 2e6c 656e 6774 6828 290a  yl = y.length().
-00010850: 2020 2020 2020 2020 796c 203d 2079 6c2a          yl = yl*
-00010860: 796c 0a20 2020 2020 2020 207a 203d 207a  yl.        z = z
-00010870: 202d 2028 2879 2a7a 292f 796c 292a 790a   - ((y*z)/yl)*y.
-00010880: 0a20 2020 2020 2020 2072 6573 203d 206d  .        res = m
-00010890: 6174 3328 290a 2020 2020 2020 2020 7265  at3().        re
-000108a0: 732e 6d31 3120 3d20 782e 780a 2020 2020  s.m11 = x.x.    
-000108b0: 2020 2020 7265 732e 6d31 3220 3d20 792e      res.m12 = y.
-000108c0: 780a 2020 2020 2020 2020 7265 732e 6d31  x.        res.m1
-000108d0: 3320 3d20 7a2e 780a 2020 2020 2020 2020  3 = z.x.        
-000108e0: 7265 732e 6d32 3120 3d20 782e 790a 2020  res.m21 = x.y.  
-000108f0: 2020 2020 2020 7265 732e 6d32 3220 3d20        res.m22 = 
-00010900: 792e 790a 2020 2020 2020 2020 7265 732e  y.y.        res.
-00010910: 6d32 3320 3d20 7a2e 790a 2020 2020 2020  m23 = z.y.      
-00010920: 2020 7265 732e 6d33 3120 3d20 782e 7a0a    res.m31 = x.z.
-00010930: 2020 2020 2020 2020 7265 732e 6d33 3220          res.m32 
-00010940: 3d20 792e 7a0a 2020 2020 2020 2020 7265  = y.z.        re
-00010950: 732e 6d33 3320 3d20 7a2e 7a0a 2020 2020  s.m33 = z.z.    
-00010960: 2020 2020 7265 7475 726e 2072 6573 0a0a      return res..
-00010970: 2020 2020 6465 6620 6465 636f 6d70 6f73      def decompos
-00010980: 6528 7365 6c66 293a 0a20 2020 2020 2020  e(self):.       
-00010990: 2022 2222 4465 636f 6d70 6f73 6573 2074   """Decomposes t
-000109a0: 6865 206d 6174 7269 7820 696e 746f 2061  he matrix into a
-000109b0: 2072 6f74 6174 696f 6e20 616e 6420 7363   rotation and sc
-000109c0: 616c 696e 6720 7061 7274 2e0a 0a20 2020  aling part...   
-000109d0: 2020 2020 2052 6574 7572 6e73 2061 2074       Returns a t
-000109e0: 7570 6c65 2028 726f 7461 7469 6f6e 2c20  uple (rotation, 
-000109f0: 7363 616c 696e 6729 2e20 5468 6520 7363  scaling). The sc
-00010a00: 616c 696e 6720 7061 7274 2069 7320 6769  aling part is gi
-00010a10: 7665 6e0a 2020 2020 2020 2020 6173 2061  ven.        as a
-00010a20: 2076 6563 332c 2074 6865 2072 6f74 6174   vec3, the rotat
-00010a30: 696f 6e20 6973 2073 7469 6c6c 2061 206d  ion is still a m
-00010a40: 6174 332e 0a20 2020 2020 2020 2022 2222  at3..        """
-00010a50: 0a20 2020 2020 2020 2063 6465 6620 6d61  .        cdef ma
-00010a60: 7433 206d 0a20 2020 2020 2020 2063 6465  t3 m.        cde
-00010a70: 6620 7665 6333 2061 2c62 2c63 0a20 2020  f vec3 a,b,c.   
-00010a80: 2020 2020 2063 6465 6620 646f 7562 6c65       cdef double
-00010a90: 2061 6c2c 2062 6c2c 2063 6c0a 0a20 2020   al, bl, cl..   
-00010aa0: 2020 2020 206d 203d 2073 656c 662e 6f72       m = self.or
-00010ab0: 7468 6f28 290a 0a20 2020 2020 2020 2023  tho()..        #
-00010ac0: 2061 2c62 2c63 203d 2043 6f6c 756d 6e20   a,b,c = Column 
-00010ad0: 302c 312c 3220 6f66 206d 0a20 2020 2020  0,1,2 of m.     
-00010ae0: 2020 2061 203d 2076 6563 3328 290a 2020     a = vec3().  
-00010af0: 2020 2020 2020 6220 3d20 7665 6333 2829        b = vec3()
-00010b00: 0a20 2020 2020 2020 2063 203d 2076 6563  .        c = vec
-00010b10: 3328 290a 2020 2020 2020 2020 612e 7820  3().        a.x 
-00010b20: 3d20 6d2e 6d31 310a 2020 2020 2020 2020  = m.m11.        
-00010b30: 612e 7920 3d20 6d2e 6d32 310a 2020 2020  a.y = m.m21.    
-00010b40: 2020 2020 612e 7a20 3d20 6d2e 6d33 310a      a.z = m.m31.
-00010b50: 2020 2020 2020 2020 622e 7820 3d20 6d2e          b.x = m.
-00010b60: 6d31 320a 2020 2020 2020 2020 622e 7920  m12.        b.y 
-00010b70: 3d20 6d2e 6d32 320a 2020 2020 2020 2020  = m.m22.        
-00010b80: 622e 7a20 3d20 6d2e 6d33 320a 2020 2020  b.z = m.m32.    
-00010b90: 2020 2020 632e 7820 3d20 6d2e 6d31 330a      c.x = m.m13.
-00010ba0: 2020 2020 2020 2020 632e 7920 3d20 6d2e          c.y = m.
-00010bb0: 6d32 330a 2020 2020 2020 2020 632e 7a20  m23.        c.z 
-00010bc0: 3d20 6d2e 6d33 330a 0a20 2020 2020 2020  = m.m33..       
-00010bd0: 2023 2061 6c2c 626c 2c63 6c20 3d20 6c65   # al,bl,cl = le
-00010be0: 6e67 7468 206f 6620 612c 622c 6320 283d  ngth of a,b,c (=
-00010bf0: 2073 6361 6c69 6e67 2066 6163 746f 7273   scaling factors
-00010c00: 290a 2020 2020 2020 2020 616c 203d 2073  ).        al = s
-00010c10: 7172 7428 612e 782a 612e 7820 2b20 612e  qrt(a.x*a.x + a.
-00010c20: 792a 612e 7920 2b20 612e 7a2a 612e 7a29  y*a.y + a.z*a.z)
-00010c30: 0a20 2020 2020 2020 2062 6c20 3d20 7371  .        bl = sq
-00010c40: 7274 2862 2e78 2a62 2e78 202b 2062 2e79  rt(b.x*b.x + b.y
-00010c50: 2a62 2e79 202b 2062 2e7a 2a62 2e7a 290a  *b.y + b.z*b.z).
-00010c60: 2020 2020 2020 2020 636c 203d 2073 7172          cl = sqr
-00010c70: 7428 632e 782a 632e 7820 2b20 632e 792a  t(c.x*c.x + c.y*
-00010c80: 632e 7920 2b20 632e 7a2a 632e 7a29 0a20  c.y + c.z*c.z). 
-00010c90: 2020 2020 2020 2069 6620 616c 3c3d 6570         if al<=ep
-00010ca0: 7320 6f72 2062 6c3c 3d65 7073 206f 7220  s or bl<=eps or 
-00010cb0: 636c 3c3d 6570 733a 0a20 2020 2020 2020  cl<=eps:.       
-00010cc0: 2020 2020 2072 6169 7365 205a 6572 6f44       raise ZeroD
-00010cd0: 6976 6973 696f 6e45 7272 6f72 2c22 7472  ivisionError,"tr
-00010ce0: 616e 7366 6f72 6d61 7469 6f6e 2063 6f6e  ansformation con
-00010cf0: 7461 696e 7320 6120 3020 7363 616c 696e  tains a 0 scalin
-00010d00: 6722 0a0a 2020 2020 2020 2020 7363 616c  g"..        scal
-00010d10: 6520 3d20 7665 6333 2861 6c2c 626c 2c63  e = vec3(al,bl,c
-00010d20: 6c29 0a0a 2020 2020 2020 2020 2320 6e6f  l)..        # no
-00010d30: 726d 616c 697a 696e 6720 612c 622c 630a  rmalizing a,b,c.
-00010d40: 2320 2020 2020 2020 2061 2f3d 616c 0a23  #        a/=al.#
-00010d50: 2020 2020 2020 2020 622f 3d62 6c0a 2320          b/=bl.# 
-00010d60: 2020 2020 2020 2063 2f3d 636c 0a20 2020         c/=cl.   
-00010d70: 2020 2020 2061 2e78 203d 2061 2e78 2f61       a.x = a.x/a
-00010d80: 6c0a 2020 2020 2020 2020 612e 7920 3d20  l.        a.y = 
-00010d90: 612e 792f 616c 0a20 2020 2020 2020 2061  a.y/al.        a
-00010da0: 2e7a 203d 2061 2e7a 2f61 6c0a 2020 2020  .z = a.z/al.    
-00010db0: 2020 2020 622e 7820 3d20 622e 782f 626c      b.x = b.x/bl
-00010dc0: 0a20 2020 2020 2020 2062 2e79 203d 2062  .        b.y = b
-00010dd0: 2e79 2f62 6c0a 2020 2020 2020 2020 622e  .y/bl.        b.
-00010de0: 7a20 3d20 622e 7a2f 626c 0a20 2020 2020  z = b.z/bl.     
-00010df0: 2020 2063 2e78 203d 2063 2e78 2f63 6c0a     c.x = c.x/cl.
-00010e00: 2020 2020 2020 2020 632e 7920 3d20 632e          c.y = c.
-00010e10: 792f 636c 0a20 2020 2020 2020 2063 2e7a  y/cl.        c.z
-00010e20: 203d 2063 2e7a 2f63 6c0a 0a20 2020 2020   = c.z/cl..     
-00010e30: 2020 206d 2e6d 3131 203d 2061 2e78 0a20     m.m11 = a.x. 
-00010e40: 2020 2020 2020 206d 2e6d 3231 203d 2061         m.m21 = a
-00010e50: 2e79 0a20 2020 2020 2020 206d 2e6d 3331  .y.        m.m31
-00010e60: 203d 2061 2e7a 0a20 2020 2020 2020 206d   = a.z.        m
-00010e70: 2e6d 3132 203d 2062 2e78 0a20 2020 2020  .m12 = b.x.     
-00010e80: 2020 206d 2e6d 3232 203d 2062 2e79 0a20     m.m22 = b.y. 
-00010e90: 2020 2020 2020 206d 2e6d 3332 203d 2062         m.m32 = b
-00010ea0: 2e7a 0a20 2020 2020 2020 206d 2e6d 3133  .z.        m.m13
-00010eb0: 203d 2063 2e78 0a20 2020 2020 2020 206d   = c.x.        m
-00010ec0: 2e6d 3233 203d 2063 2e79 0a20 2020 2020  .m23 = c.y.     
-00010ed0: 2020 206d 2e6d 3333 203d 2063 2e7a 0a20     m.m33 = c.z. 
-00010ee0: 2020 2020 2020 2069 6620 6d2e 6465 7465         if m.dete
-00010ef0: 726d 696e 616e 7428 293c 302e 303a 0a20  rminant()<0.0:. 
-00010f00: 2020 2020 2020 2020 2020 206d 2e6d 3131             m.m11
-00010f10: 203d 202d 6d2e 6d31 310a 2020 2020 2020   = -m.m11.      
-00010f20: 2020 2020 2020 6d2e 6d32 3120 3d20 2d6d        m.m21 = -m
-00010f30: 2e6d 3231 0a20 2020 2020 2020 2020 2020  .m21.           
-00010f40: 206d 2e6d 3331 203d 202d 6d2e 6d33 310a   m.m31 = -m.m31.
-00010f50: 2020 2020 2020 2020 2020 2020 7363 616c              scal
-00010f60: 652e 7820 3d20 2d73 6361 6c65 2e78 0a0a  e.x = -scale.x..
-00010f70: 2020 2020 2020 2020 7265 7475 726e 2028          return (
-00010f80: 6d2c 2073 6361 6c65 290a 0a0a 2323 2323  m, scale)...####
-00010f90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00010fa0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00010fb0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00010fc0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00010fd0: 2323 0a0a 2320 6d61 7434 6974 6572 0a63  ##..# mat4iter.c
-00010fe0: 6465 6620 636c 6173 7320 6d61 7434 6974  def class mat4it
-00010ff0: 6572 3a0a 2020 2020 2222 226d 6174 2069  er:.    """mat i
-00011000: 7465 7261 746f 722e 2222 220a 2020 2020  terator.""".    
-00011010: 6364 6566 2069 6e74 2069 6478 0a20 2020  cdef int idx.   
-00011020: 2063 6465 6620 6f62 6a65 6374 206d 0a0a   cdef object m..
-00011030: 2020 2020 6465 6620 5f5f 6369 6e69 745f      def __cinit_
-00011040: 5f28 7365 6c66 2c20 6d29 3a0a 2020 2020  _(self, m):.    
-00011050: 2020 2020 7365 6c66 2e69 6478 203d 2030      self.idx = 0
-00011060: 0a20 2020 2020 2020 2073 656c 662e 6d20  .        self.m 
-00011070: 2020 3d20 6d0a 0a20 2020 2064 6566 205f    = m..    def _
-00011080: 5f69 7465 725f 5f28 7365 6c66 293a 0a20  _iter__(self):. 
-00011090: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-000110a0: 6c66 0a0a 2020 2020 6465 6620 5f5f 6e65  lf..    def __ne
-000110b0: 7874 5f5f 2873 656c 6629 3a0a 2020 2020  xt__(self):.    
-000110c0: 2020 2020 6966 2073 656c 662e 6964 783d      if self.idx=
-000110d0: 3d30 3a0a 2020 2020 2020 2020 2020 2020  =0:.            
-000110e0: 7365 6c66 2e69 6478 3d31 0a20 2020 2020  self.idx=1.     
-000110f0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00011100: 6c66 2e6d 5b30 5d0a 2020 2020 2020 2020  lf.m[0].        
-00011110: 656c 6966 2073 656c 662e 6964 783d 3d31  elif self.idx==1
-00011120: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-00011130: 6c66 2e69 6478 3d32 0a20 2020 2020 2020  lf.idx=2.       
-00011140: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00011150: 2e6d 5b31 5d0a 2020 2020 2020 2020 656c  .m[1].        el
-00011160: 6966 2073 656c 662e 6964 783d 3d32 3a0a  if self.idx==2:.
-00011170: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00011180: 2e69 6478 3d33 0a20 2020 2020 2020 2020  .idx=3.         
-00011190: 2020 2072 6574 7572 6e20 7365 6c66 2e6d     return self.m
-000111a0: 5b32 5d0a 2020 2020 2020 2020 656c 6966  [2].        elif
-000111b0: 2073 656c 662e 6964 783d 3d33 3a0a 2020   self.idx==3:.  
-000111c0: 2020 2020 2020 2020 2020 7365 6c66 2e69            self.i
-000111d0: 6478 3d34 0a20 2020 2020 2020 2020 2020  dx=4.           
-000111e0: 2072 6574 7572 6e20 7365 6c66 2e6d 5b33   return self.m[3
-000111f0: 5d0a 2020 2020 2020 2020 656c 7365 3a0a  ].        else:.
-00011200: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00011210: 6520 5374 6f70 4974 6572 6174 696f 6e0a  e StopIteration.
-00011220: 0a23 2043 616c 6375 6c61 7465 7320 6d33  .# Calculates m3
-00011230: 2e64 6574 6572 6d69 6e61 6e74 2829 2077  .determinant() w
-00011240: 6865 7265 206d 3320 6973 2061 206d 6174  here m3 is a mat
-00011250: 3320 7468 6174 2069 7320 6261 7365 6420  3 that is based 
-00011260: 6f6e 206d 340a 2320 7768 6572 6520 726f  on m4.# where ro
-00011270: 7720 6920 616e 6420 636f 6c75 6d6e 206a  w i and column j
-00011280: 2061 7265 206c 6566 7420 6f75 742e 0a63   are left out..c
-00011290: 6465 6620 646f 7562 6c65 205f 7375 6264  def double _subd
-000112a0: 6574 2864 6f75 626c 6520 6d34 5b31 365d  et(double m4[16]
-000112b0: 2c20 7368 6f72 7420 692c 2073 686f 7274  , short i, short
-000112c0: 206a 293a 0a20 2020 2063 6465 6620 646f   j):.    cdef do
-000112d0: 7562 6c65 206d 335b 395d 0a20 2020 2063  uble m3[9].    c
-000112e0: 6465 6620 646f 7562 6c65 2a20 700a 2020  def double* p.  
-000112f0: 2020 6364 6566 2073 686f 7274 206b 2c20    cdef short k, 
-00011300: 6c0a 0a20 2020 2070 203d 206d 330a 2020  l..    p = m3.  
-00011310: 2020 6b3d 300a 2020 2020 7768 696c 6520    k=0.    while 
-00011320: 313a 0a20 2020 2020 2020 2069 6620 6b3d  1:.        if k=
-00011330: 3d69 3a0a 2020 2020 2020 2020 2020 2020  =i:.            
-00011340: 6b3d 6b2b 310a 2020 2020 2020 2020 6966  k=k+1.        if
-00011350: 206b 3d3d 343a 0a20 2020 2020 2020 2020   k==4:.         
-00011360: 2020 2062 7265 616b 0a20 2020 2020 2020     break.       
-00011370: 206c 3d30 0a20 2020 2020 2020 2077 6869   l=0.        whi
-00011380: 6c65 2031 3a0a 2020 2020 2020 2020 2020  le 1:.          
-00011390: 2020 6966 206c 3d3d 6a3a 0a20 2020 2020    if l==j:.     
-000113a0: 2020 2020 2020 2020 2020 206c 3d6c 2b31             l=l+1
-000113b0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-000113c0: 6c3d 3d34 3a0a 2020 2020 2020 2020 2020  l==4:.          
-000113d0: 2020 2020 2020 6272 6561 6b0a 2020 2020        break.    
-000113e0: 2020 2020 2020 2020 705b 305d 3d6d 345b          p[0]=m4[
-000113f0: 6b2a 342b 6c5d 0a20 2020 2020 2020 2020  k*4+l].         
-00011400: 2020 2070 3d70 2b31 0a20 2020 2020 2020     p=p+1.       
-00011410: 2020 2020 206c 3d6c 2b31 0a20 2020 2020       l=l+1.     
-00011420: 2020 206b 3d6b 2b31 0a0a 2020 2020 7265     k=k+1..    re
-00011430: 7475 726e 206d 335b 305d 2a6d 335b 345d  turn m3[0]*m3[4]
-00011440: 2a6d 335b 385d 2b20 5c0a 2020 2020 2020  *m3[8]+ \.      
-00011450: 2020 2020 206d 335b 315d 2a6d 335b 355d       m3[1]*m3[5]
-00011460: 2a6d 335b 365d 2b20 5c0a 2020 2020 2020  *m3[6]+ \.      
-00011470: 2020 2020 206d 335b 325d 2a6d 335b 335d       m3[2]*m3[3]
-00011480: 2a6d 335b 375d 2d20 5c0a 2020 2020 2020  *m3[7]- \.      
-00011490: 2020 2020 206d 335b 365d 2a6d 335b 345d       m3[6]*m3[4]
-000114a0: 2a6d 335b 325d 2d20 5c0a 2020 2020 2020  *m3[2]- \.      
-000114b0: 2020 2020 206d 335b 375d 2a6d 335b 355d       m3[7]*m3[5]
-000114c0: 2a6d 335b 305d 2d20 5c0a 2020 2020 2020  *m3[0]- \.      
-000114d0: 2020 2020 206d 335b 385d 2a6d 335b 335d       m3[8]*m3[3]
-000114e0: 2a6d 335b 315d 0a0a 0a0a 2320 6d61 7434  *m3[1]....# mat4
-000114f0: 0a63 6465 6620 636c 6173 7320 6d61 7434  .cdef class mat4
-00011500: 3a0a 0a20 2020 2063 6465 6620 646f 7562  :..    cdef doub
-00011510: 6c65 206d 3131 2c20 6d31 322c 206d 3133  le m11, m12, m13
-00011520: 2c20 6d31 340a 2020 2020 6364 6566 2064  , m14.    cdef d
-00011530: 6f75 626c 6520 6d32 312c 206d 3232 2c20  ouble m21, m22, 
-00011540: 6d32 332c 206d 3234 0a20 2020 2063 6465  m23, m24.    cde
-00011550: 6620 646f 7562 6c65 206d 3331 2c20 6d33  f double m31, m3
-00011560: 322c 206d 3333 2c20 6d33 340a 2020 2020  2, m33, m34.    
-00011570: 6364 6566 2064 6f75 626c 6520 6d34 312c  cdef double m41,
-00011580: 206d 3432 2c20 6d34 332c 206d 3434 0a0a   m42, m43, m44..
-00011590: 2020 2020 6465 6620 5f5f 6369 6e69 745f      def __cinit_
-000115a0: 5f28 7365 6c66 2c20 2a61 7267 7329 3a0a  _(self, *args):.
-000115b0: 2020 2020 2020 2020 6364 6566 2069 6e74          cdef int
-000115c0: 2061 7267 6c65 6e0a 2020 2020 2020 2020   arglen.        
-000115d0: 6364 6566 206d 6174 3420 420a 2020 2020  cdef mat4 B.    
-000115e0: 2020 2020 6172 676c 656e 203d 206c 656e      arglen = len
-000115f0: 2861 7267 7329 0a0a 2020 2020 2020 2020  (args)..        
-00011600: 2320 4e6f 2061 7267 756d 656e 7473 0a20  # No arguments. 
-00011610: 2020 2020 2020 2069 6620 6172 676c 656e         if arglen
-00011620: 3d3d 303a 0a20 2020 2020 2020 2020 2020  ==0:.           
-00011630: 206d 3131 3d6d 3132 3d6d 3133 3d6d 3134   m11=m12=m13=m14
-00011640: 3d30 2e30 0a20 2020 2020 2020 2020 2020  =0.0.           
-00011650: 206d 3231 3d6d 3232 3d6d 3233 3d6d 3234   m21=m22=m23=m24
-00011660: 3d30 2e30 0a20 2020 2020 2020 2020 2020  =0.0.           
-00011670: 206d 3331 3d6d 3332 3d6d 3333 3d6d 3334   m31=m32=m33=m34
-00011680: 3d30 2e30 0a20 2020 2020 2020 2020 2020  =0.0.           
-00011690: 206d 3431 3d6d 3432 3d6d 3433 3d6d 3434   m41=m42=m43=m44
-000116a0: 3d30 2e30 0a0a 2020 2020 2020 2020 2320  =0.0..        # 
-000116b0: 3120 6172 6775 6d65 6e74 2028 6c69 7374  1 argument (list
-000116c0: 2c20 7363 616c 6172 206f 7220 6d61 7434  , scalar or mat4
-000116d0: 290a 2020 2020 2020 2020 656c 6966 2061  ).        elif a
-000116e0: 7267 6c65 6e3d 3d31 3a0a 2020 2020 2020  rglen==1:.      
-000116f0: 2020 2020 2020 5420 3d20 7479 7065 2861        T = type(a
-00011700: 7267 735b 305d 290a 2020 2020 2020 2020  rgs[0]).        
-00011710: 2020 2020 2320 7363 616c 6172 0a20 2020      # scalar.   
-00011720: 2020 2020 2020 2020 2069 6620 5420 6973           if T is
-00011730: 2066 6c6f 6174 206f 7220 5420 6973 2069   float or T is i
-00011740: 6e74 206f 7220 5420 6973 206c 6f6e 673a  nt or T is long:
-00011750: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00011760: 2073 656c 662e 6d31 3120 3d20 6172 6773   self.m11 = args
-00011770: 5b30 5d0a 2020 2020 2020 2020 2020 2020  [0].            
-00011780: 2020 2020 7365 6c66 2e6d 3132 203d 2030      self.m12 = 0
-00011790: 2e30 0a20 2020 2020 2020 2020 2020 2020  .0.             
-000117a0: 2020 2073 656c 662e 6d31 3320 3d20 302e     self.m13 = 0.
-000117b0: 300a 2020 2020 2020 2020 2020 2020 2020  0.              
-000117c0: 2020 7365 6c66 2e6d 3134 203d 2030 2e30    self.m14 = 0.0
-000117d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000117e0: 2073 656c 662e 6d32 3120 3d20 302e 300a   self.m21 = 0.0.
-000117f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011800: 7365 6c66 2e6d 3232 203d 2073 656c 662e  self.m22 = self.
-00011810: 6d31 310a 2020 2020 2020 2020 2020 2020  m11.            
-00011820: 2020 2020 7365 6c66 2e6d 3233 203d 2030      self.m23 = 0
-00011830: 2e30 0a20 2020 2020 2020 2020 2020 2020  .0.             
-00011840: 2020 2073 656c 662e 6d32 3420 3d20 302e     self.m24 = 0.
-00011850: 300a 2020 2020 2020 2020 2020 2020 2020  0.              
-00011860: 2020 7365 6c66 2e6d 3331 203d 2030 2e30    self.m31 = 0.0
-00011870: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00011880: 2073 656c 662e 6d33 3220 3d20 302e 300a   self.m32 = 0.0.
-00011890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000118a0: 7365 6c66 2e6d 3333 203d 2073 656c 662e  self.m33 = self.
-000118b0: 6d31 310a 2020 2020 2020 2020 2020 2020  m11.            
-000118c0: 2020 2020 7365 6c66 2e6d 3334 203d 2030      self.m34 = 0
-000118d0: 2e30 0a20 2020 2020 2020 2020 2020 2020  .0.             
-000118e0: 2020 2073 656c 662e 6d34 3120 3d20 302e     self.m41 = 0.
-000118f0: 300a 2020 2020 2020 2020 2020 2020 2020  0.              
-00011900: 2020 7365 6c66 2e6d 3432 203d 2030 2e30    self.m42 = 0.0
-00011910: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00011920: 2073 656c 662e 6d34 3320 3d20 302e 300a   self.m43 = 0.0.
-00011930: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011940: 7365 6c66 2e6d 3434 203d 2073 656c 662e  self.m44 = self.
-00011950: 6d31 310a 2020 2020 2020 2020 2020 2020  m11.            
-00011960: 2320 6d61 7434 0a20 2020 2020 2020 2020  # mat4.         
-00011970: 2020 2065 6c69 6620 5420 6973 206d 6174     elif T is mat
-00011980: 343a 0a20 2020 2020 2020 2020 2020 2020  4:.             
-00011990: 2020 2042 203d 2061 7267 735b 305d 0a20     B = args[0]. 
-000119a0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-000119b0: 656c 662e 6d31 3120 3d20 422e 6d31 310a  elf.m11 = B.m11.
-000119c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000119d0: 7365 6c66 2e6d 3132 203d 2042 2e6d 3132  self.m12 = B.m12
-000119e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000119f0: 2073 656c 662e 6d31 3320 3d20 422e 6d31   self.m13 = B.m1
-00011a00: 330a 2020 2020 2020 2020 2020 2020 2020  3.              
-00011a10: 2020 7365 6c66 2e6d 3134 203d 2042 2e6d    self.m14 = B.m
-00011a20: 3134 0a20 2020 2020 2020 2020 2020 2020  14.             
-00011a30: 2020 2073 656c 662e 6d32 3120 3d20 422e     self.m21 = B.
-00011a40: 6d32 310a 2020 2020 2020 2020 2020 2020  m21.            
-00011a50: 2020 2020 7365 6c66 2e6d 3232 203d 2042      self.m22 = B
-00011a60: 2e6d 3232 0a20 2020 2020 2020 2020 2020  .m22.           
-00011a70: 2020 2020 2073 656c 662e 6d32 3320 3d20       self.m23 = 
-00011a80: 422e 6d32 330a 2020 2020 2020 2020 2020  B.m23.          
-00011a90: 2020 2020 2020 7365 6c66 2e6d 3234 203d        self.m24 =
-00011aa0: 2042 2e6d 3234 0a20 2020 2020 2020 2020   B.m24.         
-00011ab0: 2020 2020 2020 2073 656c 662e 6d33 3120         self.m31 
-00011ac0: 3d20 422e 6d33 310a 2020 2020 2020 2020  = B.m31.        
-00011ad0: 2020 2020 2020 2020 7365 6c66 2e6d 3332          self.m32
-00011ae0: 203d 2042 2e6d 3332 0a20 2020 2020 2020   = B.m32.       
-00011af0: 2020 2020 2020 2020 2073 656c 662e 6d33           self.m3
-00011b00: 3320 3d20 422e 6d33 330a 2020 2020 2020  3 = B.m33.      
-00011b10: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
-00011b20: 3334 203d 2042 2e6d 3334 0a20 2020 2020  34 = B.m34.     
-00011b30: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00011b40: 6d34 3120 3d20 422e 6d34 310a 2020 2020  m41 = B.m41.    
-00011b50: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00011b60: 2e6d 3432 203d 2042 2e6d 3432 0a20 2020  .m42 = B.m42.   
-00011b70: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00011b80: 662e 6d34 3320 3d20 422e 6d34 330a 2020  f.m43 = B.m43.  
-00011b90: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00011ba0: 6c66 2e6d 3434 203d 2042 2e6d 3434 0a20  lf.m44 = B.m44. 
-00011bb0: 2020 2020 2020 2020 2020 2023 2053 7472             # Str
-00011bc0: 696e 670a 2020 2020 2020 2020 2020 2020  ing.            
-00011bd0: 656c 6966 2054 2069 7320 7374 7220 6f72  elif T is str or
-00011be0: 2054 2069 7320 756e 6963 6f64 653a 0a20   T is unicode:. 
-00011bf0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00011c00: 3d61 7267 735b 305d 2e72 6570 6c61 6365  =args[0].replace
-00011c10: 2822 2c22 2c22 2022 292e 7265 706c 6163  (","," ").replac
-00011c20: 6528 2220 2022 2c22 2022 292e 7374 7269  e("  "," ").stri
-00011c30: 7028 292e 7370 6c69 7428 2220 2229 0a20  p().split(" "). 
-00011c40: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00011c50: 6620 733d 3d5b 2222 5d3a 0a20 2020 2020  f s==[""]:.     
-00011c60: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00011c70: 3d5b 5d0a 2020 2020 2020 2020 2020 2020  =[].            
-00011c80: 2020 2020 666f 7220 6920 696e 2072 616e      for i in ran
-00011c90: 6765 286c 656e 2873 2929 3a0a 2020 2020  ge(len(s)):.    
-00011ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011cb0: 7472 793a 0a20 2020 2020 2020 2020 2020  try:.           
-00011cc0: 2020 2020 2020 2020 2020 2020 2073 5b69               s[i
-00011cd0: 5d20 3d20 666c 6f61 7428 735b 695d 290a  ] = float(s[i]).
-00011ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011cf0: 2020 2020 6578 6365 7074 3a0a 2020 2020      except:.    
-00011d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011d10: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-00011d20: 7272 6f72 2c22 6d61 7434 2829 2061 7267  rror,"mat4() arg
-00011d30: 2069 7320 6120 6d61 6c66 6f72 6d65 6420   is a malformed 
-00011d40: 7374 7269 6e67 220a 2020 2020 2020 2020  string".        
-00011d50: 2020 2020 2020 2020 4220 3d20 6d61 7434          B = mat4
-00011d60: 2873 290a 2020 2020 2020 2020 2020 2020  (s).            
-00011d70: 2020 2020 7365 6c66 2e6d 3131 203d 2042      self.m11 = B
-00011d80: 2e6d 3131 0a20 2020 2020 2020 2020 2020  .m11.           
-00011d90: 2020 2020 2073 656c 662e 6d31 3220 3d20       self.m12 = 
-00011da0: 422e 6d31 320a 2020 2020 2020 2020 2020  B.m12.          
-00011db0: 2020 2020 2020 7365 6c66 2e6d 3133 203d        self.m13 =
-00011dc0: 2042 2e6d 3133 0a20 2020 2020 2020 2020   B.m13.         
-00011dd0: 2020 2020 2020 2073 656c 662e 6d31 3420         self.m14 
-00011de0: 3d20 422e 6d31 340a 2020 2020 2020 2020  = B.m14.        
-00011df0: 2020 2020 2020 2020 7365 6c66 2e6d 3231          self.m21
-00011e00: 203d 2042 2e6d 3231 0a20 2020 2020 2020   = B.m21.       
-00011e10: 2020 2020 2020 2020 2073 656c 662e 6d32           self.m2
-00011e20: 3220 3d20 422e 6d32 320a 2020 2020 2020  2 = B.m22.      
-00011e30: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
-00011e40: 3233 203d 2042 2e6d 3233 0a20 2020 2020  23 = B.m23.     
-00011e50: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00011e60: 6d32 3420 3d20 422e 6d32 340a 2020 2020  m24 = B.m24.    
-00011e70: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00011e80: 2e6d 3331 203d 2042 2e6d 3331 0a20 2020  .m31 = B.m31.   
-00011e90: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00011ea0: 662e 6d33 3220 3d20 422e 6d33 320a 2020  f.m32 = B.m32.  
-00011eb0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00011ec0: 6c66 2e6d 3333 203d 2042 2e6d 3333 0a20  lf.m33 = B.m33. 
-00011ed0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00011ee0: 656c 662e 6d33 3420 3d20 422e 6d33 340a  elf.m34 = B.m34.
-00011ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011f00: 7365 6c66 2e6d 3431 203d 2042 2e6d 3431  self.m41 = B.m41
-00011f10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00011f20: 2073 656c 662e 6d34 3220 3d20 422e 6d34   self.m42 = B.m4
-00011f30: 320a 2020 2020 2020 2020 2020 2020 2020  2.              
-00011f40: 2020 7365 6c66 2e6d 3433 203d 2042 2e6d    self.m43 = B.m
-00011f50: 3433 0a20 2020 2020 2020 2020 2020 2020  43.             
-00011f60: 2020 2073 656c 662e 6d34 3420 3d20 422e     self.m44 = B.
-00011f70: 6d34 340a 2020 2020 2020 2020 2020 2020  m44.            
-00011f80: 2320 5365 7175 656e 6365 206f 6620 3136  # Sequence of 16
-00011f90: 2066 6c6f 6174 7320 6f72 2034 2034 2d73   floats or 4 4-s
-00011fa0: 6571 7565 6e63 6573 0a20 2020 2020 2020  equences.       
-00011fb0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00011fc0: 2020 2020 2020 2020 2020 2073 6571 203d             seq =
-00011fd0: 2061 7267 735b 305d 0a20 2020 2020 2020   args[0].       
-00011fe0: 2020 2020 2020 2020 2074 7279 3a0a 2020           try:.  
-00011ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012000: 2020 7365 716c 656e 203d 206c 656e 2873    seqlen = len(s
-00012010: 6571 290a 2020 2020 2020 2020 2020 2020  eq).            
-00012020: 2020 2020 6578 6365 7074 3a0a 2020 2020      except:.    
-00012030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012040: 7261 6973 6520 5479 7065 4572 726f 722c  raise TypeError,
-00012050: 226d 6174 3428 2920 6172 6720 6361 6e27  "mat4() arg can'
-00012060: 7420 6265 2063 6f6e 7665 7274 6564 2074  t be converted t
-00012070: 6f20 6d61 7434 220a 0a20 2020 2020 2020  o mat4"..       
-00012080: 2020 2020 2020 2020 2069 6620 7365 716c           if seql
-00012090: 656e 3d3d 3136 3a0a 2020 2020 2020 2020  en==16:.        
-000120a0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000120b0: 2e6d 3131 203d 2073 6571 5b30 5d0a 2020  .m11 = seq[0].  
-000120c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000120d0: 2020 7365 6c66 2e6d 3132 203d 2073 6571    self.m12 = seq
-000120e0: 5b31 5d0a 2020 2020 2020 2020 2020 2020  [1].            
-000120f0: 2020 2020 2020 2020 7365 6c66 2e6d 3133          self.m13
-00012100: 203d 2073 6571 5b32 5d0a 2020 2020 2020   = seq[2].      
-00012110: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00012120: 6c66 2e6d 3134 203d 2073 6571 5b33 5d0a  lf.m14 = seq[3].
-00012130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012140: 2020 2020 7365 6c66 2e6d 3231 203d 2073      self.m21 = s
-00012150: 6571 5b34 5d0a 2020 2020 2020 2020 2020  eq[4].          
-00012160: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
-00012170: 3232 203d 2073 6571 5b35 5d0a 2020 2020  22 = seq[5].    
-00012180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012190: 7365 6c66 2e6d 3233 203d 2073 6571 5b36  self.m23 = seq[6
-000121a0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-000121b0: 2020 2020 2020 7365 6c66 2e6d 3234 203d        self.m24 =
-000121c0: 2073 6571 5b37 5d0a 2020 2020 2020 2020   seq[7].        
-000121d0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000121e0: 2e6d 3331 203d 2073 6571 5b38 5d0a 2020  .m31 = seq[8].  
-000121f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012200: 2020 7365 6c66 2e6d 3332 203d 2073 6571    self.m32 = seq
-00012210: 5b39 5d0a 2020 2020 2020 2020 2020 2020  [9].            
-00012220: 2020 2020 2020 2020 7365 6c66 2e6d 3333          self.m33
-00012230: 203d 2073 6571 5b31 305d 0a20 2020 2020   = seq[10].     
-00012240: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00012250: 656c 662e 6d33 3420 3d20 7365 715b 3131  elf.m34 = seq[11
-00012260: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-00012270: 2020 2020 2020 7365 6c66 2e6d 3431 203d        self.m41 =
-00012280: 2073 6571 5b31 325d 0a20 2020 2020 2020   seq[12].       
-00012290: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-000122a0: 662e 6d34 3220 3d20 7365 715b 3133 5d0a  f.m42 = seq[13].
-000122b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000122c0: 2020 2020 7365 6c66 2e6d 3433 203d 2073      self.m43 = s
-000122d0: 6571 5b31 345d 0a20 2020 2020 2020 2020  eq[14].         
-000122e0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-000122f0: 6d34 3420 3d20 7365 715b 3135 5d0a 2020  m44 = seq[15].  
-00012300: 2020 2020 2020 2020 2020 2020 2020 656c                el
-00012310: 6966 2073 6571 6c65 6e3d 3d34 3a0a 2020  if seqlen==4:.  
-00012320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012330: 2020 6220 3d20 7365 715b 305d 0a20 2020    b = seq[0].   
-00012340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012350: 2073 656c 662e 6d31 3120 3d20 625b 305d   self.m11 = b[0]
-00012360: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00012370: 2020 2020 2073 656c 662e 6d32 3120 3d20       self.m21 = 
-00012380: 625b 315d 0a20 2020 2020 2020 2020 2020  b[1].           
-00012390: 2020 2020 2020 2020 2073 656c 662e 6d33           self.m3
-000123a0: 3120 3d20 625b 325d 0a20 2020 2020 2020  1 = b[2].       
-000123b0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-000123c0: 662e 6d34 3120 3d20 625b 335d 0a20 2020  f.m41 = b[3].   
-000123d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000123e0: 2062 203d 2073 6571 5b31 5d0a 2020 2020   b = seq[1].    
-000123f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012400: 7365 6c66 2e6d 3132 203d 2062 5b30 5d0a  self.m12 = b[0].
-00012410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012420: 2020 2020 7365 6c66 2e6d 3232 203d 2062      self.m22 = b
-00012430: 5b31 5d0a 2020 2020 2020 2020 2020 2020  [1].            
-00012440: 2020 2020 2020 2020 7365 6c66 2e6d 3332          self.m32
-00012450: 203d 2062 5b32 5d0a 2020 2020 2020 2020   = b[2].        
-00012460: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00012470: 2e6d 3432 203d 2062 5b33 5d0a 2020 2020  .m42 = b[3].    
-00012480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012490: 6220 3d20 7365 715b 325d 0a20 2020 2020  b = seq[2].     
-000124a0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-000124b0: 656c 662e 6d31 3320 3d20 625b 305d 0a20  elf.m13 = b[0]. 
-000124c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000124d0: 2020 2073 656c 662e 6d32 3320 3d20 625b     self.m23 = b[
-000124e0: 315d 0a20 2020 2020 2020 2020 2020 2020  1].             
-000124f0: 2020 2020 2020 2073 656c 662e 6d33 3320         self.m33 
-00012500: 3d20 625b 325d 0a20 2020 2020 2020 2020  = b[2].         
-00012510: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00012520: 6d34 3320 3d20 625b 335d 0a20 2020 2020  m43 = b[3].     
-00012530: 2020 2020 2020 2020 2020 2020 2020 2062                 b
-00012540: 203d 2073 6571 5b33 5d0a 2020 2020 2020   = seq[3].      
-00012550: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00012560: 6c66 2e6d 3134 203d 2062 5b30 5d0a 2020  lf.m14 = b[0].  
-00012570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012580: 2020 7365 6c66 2e6d 3234 203d 2062 5b31    self.m24 = b[1
-00012590: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-000125a0: 2020 2020 2020 7365 6c66 2e6d 3334 203d        self.m34 =
-000125b0: 2062 5b32 5d0a 2020 2020 2020 2020 2020   b[2].          
-000125c0: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
-000125d0: 3434 203d 2062 5b33 5d0a 2020 2020 2020  44 = b[3].      
-000125e0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+0000e7b0: 2073 656c 662e 6d32 3120 3d20 760a 2020   self.m21 = v.  
+0000e7c0: 2020 2020 2020 2020 2020 2020 2020 656c                el
+0000e7d0: 6966 206a 3d3d 313a 0a20 2020 2020 2020  if j==1:.       
+0000e7e0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0000e7f0: 662e 6d32 3220 3d20 760a 2020 2020 2020  f.m22 = v.      
+0000e800: 2020 2020 2020 2020 2020 656c 6966 206a            elif j
+0000e810: 3d3d 323a 0a20 2020 2020 2020 2020 2020  ==2:.           
+0000e820: 2020 2020 2020 2020 2073 656c 662e 6d32           self.m2
+0000e830: 3320 3d20 760a 2020 2020 2020 2020 2020  3 = v.          
+0000e840: 2020 656c 6966 2069 3d3d 323a 0a20 2020    elif i==2:.   
+0000e850: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+0000e860: 6a3d 3d30 3a0a 2020 2020 2020 2020 2020  j==0:.          
+0000e870: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+0000e880: 3331 203d 2076 0a20 2020 2020 2020 2020  31 = v.         
+0000e890: 2020 2020 2020 2065 6c69 6620 6a3d 3d31         elif j==1
+0000e8a0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0000e8b0: 2020 2020 2020 7365 6c66 2e6d 3332 203d        self.m32 =
+0000e8c0: 2076 0a20 2020 2020 2020 2020 2020 2020   v.             
+0000e8d0: 2020 2065 6c69 6620 6a3d 3d32 3a0a 2020     elif j==2:.  
+0000e8e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e8f0: 2020 7365 6c66 2e6d 3333 203d 2076 0a20    self.m33 = v. 
+0000e900: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+0000e910: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
+0000e920: 7970 6545 7272 6f72 2c22 696e 6465 7820  ypeError,"index 
+0000e930: 6d75 7374 2062 6520 696e 7465 6765 7220  must be integer 
+0000e940: 6f72 2032 2d74 7570 6c65 220a 0a20 2020  or 2-tuple"..   
+0000e950: 2064 6566 2067 6574 526f 7728 7365 6c66   def getRow(self
+0000e960: 2c20 6964 7829 3a0a 2020 2020 2020 2020  , idx):.        
+0000e970: 2222 2252 6574 7572 6e20 726f 7720 2861  """Return row (a
+0000e980: 7320 7665 6333 292e 2222 220a 2020 2020  s vec3).""".    
+0000e990: 2020 2020 6364 6566 2069 6e74 2069 0a0a      cdef int i..
+0000e9a0: 2020 2020 2020 2020 543d 7479 7065 2869          T=type(i
+0000e9b0: 6478 290a 2020 2020 2020 2020 6966 2054  dx).        if T
+0000e9c0: 213d 696e 7420 616e 6420 5421 3d6c 6f6e  !=int and T!=lon
+0000e9d0: 673a 0a20 2020 2020 2020 2020 2020 2072  g:.            r
+0000e9e0: 6169 7365 2054 7970 6545 7272 6f72 2c22  aise TypeError,"
+0000e9f0: 696e 6465 7820 6d75 7374 2062 6520 696e  index must be in
+0000ea00: 7465 6765 7222 0a0a 2020 2020 2020 2020  teger"..        
+0000ea10: 6920 3d20 6964 780a 2020 2020 2020 2020  i = idx.        
+0000ea20: 6966 2069 3d3d 303a 0a20 2020 2020 2020  if i==0:.       
+0000ea30: 2020 2020 2072 6574 7572 6e20 7665 6333       return vec3
+0000ea40: 2873 656c 662e 6d31 312c 2073 656c 662e  (self.m11, self.
+0000ea50: 6d31 322c 2073 656c 662e 6d31 3329 0a20  m12, self.m13). 
+0000ea60: 2020 2020 2020 2065 6c69 6620 693d 3d31         elif i==1
+0000ea70: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+0000ea80: 7475 726e 2076 6563 3328 7365 6c66 2e6d  turn vec3(self.m
+0000ea90: 3231 2c20 7365 6c66 2e6d 3232 2c20 7365  21, self.m22, se
+0000eaa0: 6c66 2e6d 3233 290a 2020 2020 2020 2020  lf.m23).        
+0000eab0: 656c 6966 2069 3d3d 323a 0a20 2020 2020  elif i==2:.     
+0000eac0: 2020 2020 2020 2072 6574 7572 6e20 7665         return ve
+0000ead0: 6333 2873 656c 662e 6d33 312c 2073 656c  c3(self.m31, sel
+0000eae0: 662e 6d33 322c 2073 656c 662e 6d33 3329  f.m32, self.m33)
+0000eaf0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+0000eb00: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+0000eb10: 2049 6e64 6578 4572 726f 722c 2022 696e   IndexError, "in
+0000eb20: 6465 7820 6f75 7420 6f66 2072 616e 6765  dex out of range
+0000eb30: 220a 0a20 2020 2064 6566 2073 6574 526f  "..    def setRo
+0000eb40: 7728 7365 6c66 2c20 6964 782c 2076 616c  w(self, idx, val
+0000eb50: 7565 293a 0a20 2020 2020 2020 2022 2222  ue):.        """
+0000eb60: 5365 7420 726f 772e 2222 220a 2020 2020  Set row.""".    
+0000eb70: 2020 2020 6364 6566 2069 6e74 2069 0a0a      cdef int i..
+0000eb80: 2020 2020 2020 2020 543d 7479 7065 2869          T=type(i
+0000eb90: 6478 290a 2020 2020 2020 2020 6966 2054  dx).        if T
+0000eba0: 213d 696e 7420 616e 6420 5421 3d6c 6f6e  !=int and T!=lon
+0000ebb0: 673a 0a20 2020 2020 2020 2020 2020 2072  g:.            r
+0000ebc0: 6169 7365 2054 7970 6545 7272 6f72 2c22  aise TypeError,"
+0000ebd0: 696e 6465 7820 6d75 7374 2062 6520 696e  index must be in
+0000ebe0: 7465 6765 7222 0a0a 2020 2020 2020 2020  teger"..        
+0000ebf0: 6966 206c 656e 2876 616c 7565 2921 3d33  if len(value)!=3
+0000ec00: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+0000ec10: 6973 6520 5661 6c75 6545 7272 6f72 2c20  ise ValueError, 
+0000ec20: 2233 2d73 6571 7565 6e63 6520 6578 7065  "3-sequence expe
+0000ec30: 6374 6564 220a 0a20 2020 2020 2020 2069  cted"..        i
+0000ec40: 203d 2069 6478 0a20 2020 2020 2020 2069   = idx.        i
+0000ec50: 6620 693d 3d30 3a0a 2020 2020 2020 2020  f i==0:.        
+0000ec60: 2020 2020 7365 6c66 2e6d 3131 203d 2076      self.m11 = v
+0000ec70: 616c 7565 5b30 5d0a 2020 2020 2020 2020  alue[0].        
+0000ec80: 2020 2020 7365 6c66 2e6d 3132 203d 2076      self.m12 = v
+0000ec90: 616c 7565 5b31 5d0a 2020 2020 2020 2020  alue[1].        
+0000eca0: 2020 2020 7365 6c66 2e6d 3133 203d 2076      self.m13 = v
+0000ecb0: 616c 7565 5b32 5d0a 2020 2020 2020 2020  alue[2].        
+0000ecc0: 656c 6966 2069 3d3d 313a 0a20 2020 2020  elif i==1:.     
+0000ecd0: 2020 2020 2020 2073 656c 662e 6d32 3120         self.m21 
+0000ece0: 3d20 7661 6c75 655b 305d 0a20 2020 2020  = value[0].     
+0000ecf0: 2020 2020 2020 2073 656c 662e 6d32 3220         self.m22 
+0000ed00: 3d20 7661 6c75 655b 315d 0a20 2020 2020  = value[1].     
+0000ed10: 2020 2020 2020 2073 656c 662e 6d32 3320         self.m23 
+0000ed20: 3d20 7661 6c75 655b 325d 0a20 2020 2020  = value[2].     
+0000ed30: 2020 2065 6c69 6620 693d 3d32 3a0a 2020     elif i==2:.  
+0000ed40: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+0000ed50: 3331 203d 2076 616c 7565 5b30 5d0a 2020  31 = value[0].  
+0000ed60: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+0000ed70: 3332 203d 2076 616c 7565 5b31 5d0a 2020  32 = value[1].  
+0000ed80: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+0000ed90: 3333 203d 2076 616c 7565 5b32 5d0a 2020  33 = value[2].  
+0000eda0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0000edb0: 2020 2020 2020 2020 7261 6973 6520 496e          raise In
+0000edc0: 6465 7845 7272 6f72 2c20 2269 6e64 6578  dexError, "index
+0000edd0: 206f 7574 206f 6620 7261 6e67 6522 0a0a   out of range"..
+0000ede0: 0a20 2020 2064 6566 2067 6574 436f 6c75  .    def getColu
+0000edf0: 6d6e 2873 656c 662c 2069 6478 293a 0a20  mn(self, idx):. 
+0000ee00: 2020 2020 2020 2022 2222 5265 7475 726e         """Return
+0000ee10: 2063 6f6c 756d 6e20 2861 7320 7665 6333   column (as vec3
+0000ee20: 292e 2222 220a 2020 2020 2020 2020 6364  ).""".        cd
+0000ee30: 6566 2069 6e74 2069 0a0a 2020 2020 2020  ef int i..      
+0000ee40: 2020 543d 7479 7065 2869 6478 290a 2020    T=type(idx).  
+0000ee50: 2020 2020 2020 6966 2054 213d 696e 7420        if T!=int 
+0000ee60: 616e 6420 5421 3d6c 6f6e 673a 0a20 2020  and T!=long:.   
+0000ee70: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
+0000ee80: 7970 6545 7272 6f72 2c22 696e 6465 7820  ypeError,"index 
+0000ee90: 6d75 7374 2062 6520 696e 7465 6765 7222  must be integer"
+0000eea0: 0a0a 2020 2020 2020 2020 6920 3d20 6964  ..        i = id
+0000eeb0: 780a 2020 2020 2020 2020 6966 2069 3d3d  x.        if i==
+0000eec0: 303a 0a20 2020 2020 2020 2020 2020 2072  0:.            r
+0000eed0: 6574 7572 6e20 7665 6333 2873 656c 662e  eturn vec3(self.
+0000eee0: 6d31 312c 2073 656c 662e 6d32 312c 2073  m11, self.m21, s
+0000eef0: 656c 662e 6d33 3129 0a20 2020 2020 2020  elf.m31).       
+0000ef00: 2065 6c69 6620 693d 3d31 3a0a 2020 2020   elif i==1:.    
+0000ef10: 2020 2020 2020 2020 7265 7475 726e 2076          return v
+0000ef20: 6563 3328 7365 6c66 2e6d 3132 2c20 7365  ec3(self.m12, se
+0000ef30: 6c66 2e6d 3232 2c20 7365 6c66 2e6d 3332  lf.m22, self.m32
+0000ef40: 290a 2020 2020 2020 2020 656c 6966 2069  ).        elif i
+0000ef50: 3d3d 323a 0a20 2020 2020 2020 2020 2020  ==2:.           
+0000ef60: 2072 6574 7572 6e20 7665 6333 2873 656c   return vec3(sel
+0000ef70: 662e 6d31 332c 2073 656c 662e 6d32 332c  f.m13, self.m23,
+0000ef80: 2073 656c 662e 6d33 3329 0a20 2020 2020   self.m33).     
+0000ef90: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0000efa0: 2020 2020 2072 6169 7365 2049 6e64 6578       raise Index
+0000efb0: 4572 726f 722c 2022 696e 6465 7820 6f75  Error, "index ou
+0000efc0: 7420 6f66 2072 616e 6765 220a 0a20 2020  t of range"..   
+0000efd0: 2064 6566 2073 6574 436f 6c75 6d6e 2873   def setColumn(s
+0000efe0: 656c 662c 2069 6478 2c20 7661 6c75 6529  elf, idx, value)
+0000eff0: 3a0a 2020 2020 2020 2020 2222 2253 6574  :.        """Set
+0000f000: 2063 6f6c 756d 6e2e 2222 220a 2020 2020   column.""".    
+0000f010: 2020 2020 6364 6566 2069 6e74 2069 0a0a      cdef int i..
+0000f020: 2020 2020 2020 2020 543d 7479 7065 2869          T=type(i
+0000f030: 6478 290a 2020 2020 2020 2020 6966 2054  dx).        if T
+0000f040: 213d 696e 7420 616e 6420 5421 3d6c 6f6e  !=int and T!=lon
+0000f050: 673a 0a20 2020 2020 2020 2020 2020 2072  g:.            r
+0000f060: 6169 7365 2054 7970 6545 7272 6f72 2c22  aise TypeError,"
+0000f070: 696e 6465 7820 6d75 7374 2062 6520 696e  index must be in
+0000f080: 7465 6765 7222 0a0a 2020 2020 2020 2020  teger"..        
+0000f090: 6966 206c 656e 2876 616c 7565 2921 3d33  if len(value)!=3
+0000f0a0: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+0000f0b0: 6973 6520 5661 6c75 6545 7272 6f72 2c20  ise ValueError, 
+0000f0c0: 2233 2d73 6571 7565 6e63 6520 6578 7065  "3-sequence expe
+0000f0d0: 6374 6564 220a 0a20 2020 2020 2020 2069  cted"..        i
+0000f0e0: 203d 2069 6478 0a20 2020 2020 2020 2069   = idx.        i
+0000f0f0: 6620 693d 3d30 3a0a 2020 2020 2020 2020  f i==0:.        
+0000f100: 2020 2020 7365 6c66 2e6d 3131 203d 2076      self.m11 = v
+0000f110: 616c 7565 5b30 5d0a 2020 2020 2020 2020  alue[0].        
+0000f120: 2020 2020 7365 6c66 2e6d 3231 203d 2076      self.m21 = v
+0000f130: 616c 7565 5b31 5d0a 2020 2020 2020 2020  alue[1].        
+0000f140: 2020 2020 7365 6c66 2e6d 3331 203d 2076      self.m31 = v
+0000f150: 616c 7565 5b32 5d0a 2020 2020 2020 2020  alue[2].        
+0000f160: 656c 6966 2069 3d3d 313a 0a20 2020 2020  elif i==1:.     
+0000f170: 2020 2020 2020 2073 656c 662e 6d31 3220         self.m12 
+0000f180: 3d20 7661 6c75 655b 305d 0a20 2020 2020  = value[0].     
+0000f190: 2020 2020 2020 2073 656c 662e 6d32 3220         self.m22 
+0000f1a0: 3d20 7661 6c75 655b 315d 0a20 2020 2020  = value[1].     
+0000f1b0: 2020 2020 2020 2073 656c 662e 6d33 3220         self.m32 
+0000f1c0: 3d20 7661 6c75 655b 325d 0a20 2020 2020  = value[2].     
+0000f1d0: 2020 2065 6c69 6620 693d 3d32 3a0a 2020     elif i==2:.  
+0000f1e0: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+0000f1f0: 3133 203d 2076 616c 7565 5b30 5d0a 2020  13 = value[0].  
+0000f200: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+0000f210: 3233 203d 2076 616c 7565 5b31 5d0a 2020  23 = value[1].  
+0000f220: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+0000f230: 3333 203d 2076 616c 7565 5b32 5d0a 2020  33 = value[2].  
+0000f240: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0000f250: 2020 2020 2020 2020 7261 6973 6520 496e          raise In
+0000f260: 6465 7845 7272 6f72 2c20 2269 6e64 6578  dexError, "index
+0000f270: 206f 7574 206f 6620 7261 6e67 6522 0a0a   out of range"..
+0000f280: 0a20 2020 2064 6566 2074 6f4c 6973 7428  .    def toList(
+0000f290: 7365 6c66 2c20 726f 776d 616a 6f72 3d30  self, rowmajor=0
+0000f2a0: 293a 0a20 2020 2020 2020 2022 2222 5265  ):.        """Re
+0000f2b0: 7475 726e 2061 206c 6973 7420 636f 6e74  turn a list cont
+0000f2c0: 6169 6e69 6e67 2074 6865 206d 6174 7269  aining the matri
+0000f2d0: 7820 656c 656d 656e 7473 2e0a 0a20 2020  x elements...   
+0000f2e0: 2020 2020 2042 7920 6465 6661 756c 7420       By default 
+0000f2f0: 7468 6520 6c69 7374 2069 7320 696e 2063  the list is in c
+0000f300: 6f6c 756d 6e2d 6d61 6a6f 7220 6f72 6465  olumn-major orde
+0000f310: 722e 2049 6620 796f 7520 7365 7420 7468  r. If you set th
+0000f320: 650a 2020 2020 2020 2020 6f70 7469 6f6e  e.        option
+0000f330: 616c 2061 7267 756d 656e 7420 726f 776d  al argument rowm
+0000f340: 616a 6f72 2074 6f20 312c 2079 6f75 276c  ajor to 1, you'l
+0000f350: 6c20 6765 7420 7468 6520 6c69 7374 2069  l get the list i
+0000f360: 6e20 726f 772d 6d61 6a6f 720a 2020 2020  n row-major.    
+0000f370: 2020 2020 6f72 6465 722e 0a20 2020 2020      order..     
+0000f380: 2020 2022 2222 0a20 2020 2020 2020 2069     """.        i
+0000f390: 6620 726f 776d 616a 6f72 3a0a 2020 2020  f rowmajor:.    
+0000f3a0: 2020 2020 2020 2020 7265 7475 726e 205b          return [
+0000f3b0: 7365 6c66 2e6d 3131 2c20 7365 6c66 2e6d  self.m11, self.m
+0000f3c0: 3132 2c20 7365 6c66 2e6d 3133 2c0a 2020  12, self.m13,.  
+0000f3d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f3e0: 2020 7365 6c66 2e6d 3231 2c20 7365 6c66    self.m21, self
+0000f3f0: 2e6d 3232 2c20 7365 6c66 2e6d 3233 2c0a  .m22, self.m23,.
+0000f400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f410: 2020 2020 7365 6c66 2e6d 3331 2c20 7365      self.m31, se
+0000f420: 6c66 2e6d 3332 2c20 7365 6c66 2e6d 3333  lf.m32, self.m33
+0000f430: 5d0a 2020 2020 2020 2020 656c 7365 3a0a  ].        else:.
+0000f440: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0000f450: 726e 205b 7365 6c66 2e6d 3131 2c20 7365  rn [self.m11, se
+0000f460: 6c66 2e6d 3231 2c20 7365 6c66 2e6d 3331  lf.m21, self.m31
+0000f470: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0000f480: 2020 2020 2020 7365 6c66 2e6d 3132 2c20        self.m12, 
+0000f490: 7365 6c66 2e6d 3232 2c20 7365 6c66 2e6d  self.m22, self.m
+0000f4a0: 3332 2c0a 2020 2020 2020 2020 2020 2020  32,.            
+0000f4b0: 2020 2020 2020 2020 7365 6c66 2e6d 3133          self.m13
+0000f4c0: 2c20 7365 6c66 2e6d 3233 2c20 7365 6c66  , self.m23, self
+0000f4d0: 2e6d 3333 5d0a 0a0a 2020 2020 6465 6620  .m33]...    def 
+0000f4e0: 6964 656e 7469 7479 2873 656c 6629 3a0a  identity(self):.
+0000f4f0: 2020 2020 2020 2020 2222 2252 6574 7572          """Retur
+0000f500: 6e20 6964 656e 7469 7479 206d 6174 7269  n identity matri
+0000f510: 782e 0a20 2020 2020 2020 2022 2222 0a20  x..        """. 
+0000f520: 2020 2020 2020 2063 6465 6620 6d61 7433         cdef mat3
+0000f530: 2072 6573 0a20 2020 2020 2020 2072 6573   res.        res
+0000f540: 203d 206d 6174 3328 290a 2020 2020 2020   = mat3().      
+0000f550: 2020 7265 732e 6d31 3120 3d20 312e 300a    res.m11 = 1.0.
+0000f560: 2020 2020 2020 2020 7265 732e 6d31 3220          res.m12 
+0000f570: 3d20 302e 300a 2020 2020 2020 2020 7265  = 0.0.        re
+0000f580: 732e 6d31 3320 3d20 302e 300a 2020 2020  s.m13 = 0.0.    
+0000f590: 2020 2020 7265 732e 6d32 3120 3d20 302e      res.m21 = 0.
+0000f5a0: 300a 2020 2020 2020 2020 7265 732e 6d32  0.        res.m2
+0000f5b0: 3220 3d20 312e 300a 2020 2020 2020 2020  2 = 1.0.        
+0000f5c0: 7265 732e 6d32 3320 3d20 302e 300a 2020  res.m23 = 0.0.  
+0000f5d0: 2020 2020 2020 7265 732e 6d33 3120 3d20        res.m31 = 
+0000f5e0: 302e 300a 2020 2020 2020 2020 7265 732e  0.0.        res.
+0000f5f0: 6d33 3220 3d20 302e 300a 2020 2020 2020  m32 = 0.0.      
+0000f600: 2020 7265 732e 6d33 3320 3d20 312e 300a    res.m33 = 1.0.
+0000f610: 2020 2020 2020 2020 7265 7475 726e 2072          return r
+0000f620: 6573 0a0a 2020 2020 6465 6620 7472 616e  es..    def tran
+0000f630: 7370 6f73 6528 7365 6c66 293a 0a20 2020  spose(self):.   
+0000f640: 2020 2020 2022 2222 5265 7475 726e 2074       """Return t
+0000f650: 7261 6e73 706f 7365 206d 6174 7269 782e  ranspose matrix.
+0000f660: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0000f670: 2020 2020 2063 6465 6620 6d61 7433 2072       cdef mat3 r
+0000f680: 6573 0a20 2020 2020 2020 2072 6573 203d  es.        res =
+0000f690: 206d 6174 3328 290a 2020 2020 2020 2020   mat3().        
+0000f6a0: 7265 732e 6d31 3120 3d20 7365 6c66 2e6d  res.m11 = self.m
+0000f6b0: 3131 0a20 2020 2020 2020 2072 6573 2e6d  11.        res.m
+0000f6c0: 3132 203d 2073 656c 662e 6d32 310a 2020  12 = self.m21.  
+0000f6d0: 2020 2020 2020 7265 732e 6d31 3320 3d20        res.m13 = 
+0000f6e0: 7365 6c66 2e6d 3331 0a20 2020 2020 2020  self.m31.       
+0000f6f0: 2072 6573 2e6d 3231 203d 2073 656c 662e   res.m21 = self.
+0000f700: 6d31 320a 2020 2020 2020 2020 7265 732e  m12.        res.
+0000f710: 6d32 3220 3d20 7365 6c66 2e6d 3232 0a20  m22 = self.m22. 
+0000f720: 2020 2020 2020 2072 6573 2e6d 3233 203d         res.m23 =
+0000f730: 2073 656c 662e 6d33 320a 2020 2020 2020   self.m32.      
+0000f740: 2020 7265 732e 6d33 3120 3d20 7365 6c66    res.m31 = self
+0000f750: 2e6d 3133 0a20 2020 2020 2020 2072 6573  .m13.        res
+0000f760: 2e6d 3332 203d 2073 656c 662e 6d32 330a  .m32 = self.m23.
+0000f770: 2020 2020 2020 2020 7265 732e 6d33 3320          res.m33 
+0000f780: 3d20 7365 6c66 2e6d 3333 0a20 2020 2020  = self.m33.     
+0000f790: 2020 2072 6574 7572 6e20 7265 730a 0a20     return res.. 
+0000f7a0: 2020 2064 6566 2064 6574 6572 6d69 6e61     def determina
+0000f7b0: 6e74 2873 656c 6629 3a0a 2020 2020 2020  nt(self):.      
+0000f7c0: 2020 2222 2252 6574 7572 6e20 6465 7465    """Return dete
+0000f7d0: 726d 696e 616e 742e 0a20 2020 2020 2020  rminant..       
+0000f7e0: 2022 2222 0a20 2020 2020 2020 2072 6574   """.        ret
+0000f7f0: 7572 6e20 7365 6c66 2e6d 3131 2a73 656c  urn self.m11*sel
+0000f800: 662e 6d32 322a 7365 6c66 2e6d 3333 2b20  f.m22*self.m33+ 
+0000f810: 5c0a 2020 2020 2020 2020 2020 2020 2020  \.              
+0000f820: 2073 656c 662e 6d31 322a 7365 6c66 2e6d   self.m12*self.m
+0000f830: 3233 2a73 656c 662e 6d33 312b 205c 0a20  23*self.m31+ \. 
+0000f840: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0000f850: 6c66 2e6d 3133 2a73 656c 662e 6d32 312a  lf.m13*self.m21*
+0000f860: 7365 6c66 2e6d 3332 2d20 5c0a 2020 2020  self.m32- \.    
+0000f870: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0000f880: 6d33 312a 7365 6c66 2e6d 3232 2a73 656c  m31*self.m22*sel
+0000f890: 662e 6d31 332d 205c 0a20 2020 2020 2020  f.m13- \.       
+0000f8a0: 2020 2020 2020 2020 7365 6c66 2e6d 3332          self.m32
+0000f8b0: 2a73 656c 662e 6d32 332a 7365 6c66 2e6d  *self.m23*self.m
+0000f8c0: 3131 2d20 5c0a 2020 2020 2020 2020 2020  11- \.          
+0000f8d0: 2020 2020 2073 656c 662e 6d33 332a 7365       self.m33*se
+0000f8e0: 6c66 2e6d 3231 2a73 656c 662e 6d31 320a  lf.m21*self.m12.
+0000f8f0: 0a20 2020 2064 6566 2069 6e76 6572 7365  .    def inverse
+0000f900: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+0000f910: 2222 2252 6574 7572 6e20 696e 7665 7273  """Return invers
+0000f920: 6520 6d61 7472 6978 2e22 2222 0a20 2020  e matrix.""".   
+0000f930: 2020 2020 2063 6465 6620 6d61 7433 2072       cdef mat3 r
+0000f940: 6573 0a20 2020 2020 2020 2063 6465 6620  es.        cdef 
+0000f950: 646f 7562 6c65 2064 0a0a 2020 2020 2020  double d..      
+0000f960: 2020 6420 3d20 7365 6c66 2e64 6574 6572    d = self.deter
+0000f970: 6d69 6e61 6e74 2829 0a20 2020 2020 2020  minant().       
+0000f980: 2069 6620 6661 6273 2864 293c 3d65 7073   if fabs(d)<=eps
+0000f990: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+0000f9a0: 6973 6520 5a65 726f 4469 7669 7369 6f6e  ise ZeroDivision
+0000f9b0: 4572 726f 722c 2022 6d61 7472 6978 2069  Error, "matrix i
+0000f9c0: 7320 6e6f 7420 696e 7665 7274 6962 6c65  s not invertible
+0000f9d0: 220a 0a20 2020 2020 2020 2064 203d 2031  "..        d = 1
+0000f9e0: 2e30 2f64 0a0a 2020 2020 2020 2020 7265  .0/d..        re
+0000f9f0: 733d 6d61 7433 2829 0a20 2020 2020 2020  s=mat3().       
+0000fa00: 2072 6573 2e6d 3131 203d 2064 2a28 7365   res.m11 = d*(se
+0000fa10: 6c66 2e6d 3232 2a73 656c 662e 6d33 332d  lf.m22*self.m33-
+0000fa20: 7365 6c66 2e6d 3233 2a73 656c 662e 6d33  self.m23*self.m3
+0000fa30: 3229 0a20 2020 2020 2020 2072 6573 2e6d  2).        res.m
+0000fa40: 3132 203d 2064 2a28 7365 6c66 2e6d 3332  12 = d*(self.m32
+0000fa50: 2a73 656c 662e 6d31 332d 7365 6c66 2e6d  *self.m13-self.m
+0000fa60: 3132 2a73 656c 662e 6d33 3329 0a20 2020  12*self.m33).   
+0000fa70: 2020 2020 2072 6573 2e6d 3133 203d 2064       res.m13 = d
+0000fa80: 2a28 7365 6c66 2e6d 3132 2a73 656c 662e  *(self.m12*self.
+0000fa90: 6d32 332d 7365 6c66 2e6d 3232 2a73 656c  m23-self.m22*sel
+0000faa0: 662e 6d31 3329 0a20 2020 2020 2020 2072  f.m13).        r
+0000fab0: 6573 2e6d 3231 203d 2064 2a28 7365 6c66  es.m21 = d*(self
+0000fac0: 2e6d 3233 2a73 656c 662e 6d33 312d 7365  .m23*self.m31-se
+0000fad0: 6c66 2e6d 3231 2a73 656c 662e 6d33 3329  lf.m21*self.m33)
+0000fae0: 0a20 2020 2020 2020 2072 6573 2e6d 3232  .        res.m22
+0000faf0: 203d 2064 2a28 7365 6c66 2e6d 3131 2a73   = d*(self.m11*s
+0000fb00: 656c 662e 6d33 332d 7365 6c66 2e6d 3331  elf.m33-self.m31
+0000fb10: 2a73 656c 662e 6d31 3329 0a20 2020 2020  *self.m13).     
+0000fb20: 2020 2072 6573 2e6d 3233 203d 2064 2a28     res.m23 = d*(
+0000fb30: 7365 6c66 2e6d 3231 2a73 656c 662e 6d31  self.m21*self.m1
+0000fb40: 332d 7365 6c66 2e6d 3131 2a73 656c 662e  3-self.m11*self.
+0000fb50: 6d32 3329 0a20 2020 2020 2020 2072 6573  m23).        res
+0000fb60: 2e6d 3331 203d 2064 2a28 7365 6c66 2e6d  .m31 = d*(self.m
+0000fb70: 3231 2a73 656c 662e 6d33 322d 7365 6c66  21*self.m32-self
+0000fb80: 2e6d 3331 2a73 656c 662e 6d32 3229 0a20  .m31*self.m22). 
+0000fb90: 2020 2020 2020 2072 6573 2e6d 3332 203d         res.m32 =
+0000fba0: 2064 2a28 7365 6c66 2e6d 3331 2a73 656c   d*(self.m31*sel
+0000fbb0: 662e 6d31 322d 7365 6c66 2e6d 3131 2a73  f.m12-self.m11*s
+0000fbc0: 656c 662e 6d33 3229 0a20 2020 2020 2020  elf.m32).       
+0000fbd0: 2072 6573 2e6d 3333 203d 2064 2a28 7365   res.m33 = d*(se
+0000fbe0: 6c66 2e6d 3131 2a73 656c 662e 6d32 322d  lf.m11*self.m22-
+0000fbf0: 7365 6c66 2e6d 3132 2a73 656c 662e 6d32  self.m12*self.m2
+0000fc00: 3129 0a20 2020 2020 2020 2072 6574 7572  1).        retur
+0000fc10: 6e20 7265 730a 0a20 2020 2064 6566 2073  n res..    def s
+0000fc20: 6361 6c69 6e67 2873 656c 662c 2073 293a  caling(self, s):
+0000fc30: 0a20 2020 2020 2020 2022 2222 5265 7475  .        """Retu
+0000fc40: 726e 2073 6361 6c69 6e67 206d 6174 7269  rn scaling matri
+0000fc50: 782e 2222 220a 2020 2020 2020 2020 6364  x.""".        cd
+0000fc60: 6566 206d 6174 3320 7265 730a 2020 2020  ef mat3 res.    
+0000fc70: 2020 2020 7265 7320 3d20 6d61 7433 2829      res = mat3()
+0000fc80: 0a20 2020 2020 2020 2072 6573 2e6d 3131  .        res.m11
+0000fc90: 203d 2073 5b30 5d0a 2020 2020 2020 2020   = s[0].        
+0000fca0: 7265 732e 6d31 3220 3d20 302e 300a 2020  res.m12 = 0.0.  
+0000fcb0: 2020 2020 2020 7265 732e 6d31 3320 3d20        res.m13 = 
+0000fcc0: 302e 300a 2020 2020 2020 2020 7265 732e  0.0.        res.
+0000fcd0: 6d32 3120 3d20 302e 300a 2020 2020 2020  m21 = 0.0.      
+0000fce0: 2020 7265 732e 6d32 3220 3d20 735b 315d    res.m22 = s[1]
+0000fcf0: 0a20 2020 2020 2020 2072 6573 2e6d 3233  .        res.m23
+0000fd00: 203d 2030 2e30 0a20 2020 2020 2020 2072   = 0.0.        r
+0000fd10: 6573 2e6d 3331 203d 2030 2e30 0a20 2020  es.m31 = 0.0.   
+0000fd20: 2020 2020 2072 6573 2e6d 3332 203d 2030       res.m32 = 0
+0000fd30: 2e30 0a20 2020 2020 2020 2072 6573 2e6d  .0.        res.m
+0000fd40: 3333 203d 2073 5b32 5d0a 2020 2020 2020  33 = s[2].      
+0000fd50: 2020 7265 7475 726e 2072 6573 0a0a 2020    return res..  
+0000fd60: 2020 6465 6620 726f 7461 7469 6f6e 2873    def rotation(s
+0000fd70: 656c 662c 2061 6e67 6c65 2c20 6178 6973  elf, angle, axis
+0000fd80: 293a 0a20 2020 2020 2020 2022 2222 5265  ):.        """Re
+0000fd90: 7475 726e 2072 6f74 6174 696f 6e20 6d61  turn rotation ma
+0000fda0: 7472 6978 2e0a 0a20 2020 2020 2020 2061  trix...        a
+0000fdb0: 6e67 6c65 206d 7573 7420 6265 2067 6976  ngle must be giv
+0000fdc0: 656e 2069 6e20 7261 6469 616e 732e 2061  en in radians. a
+0000fdd0: 7869 7320 6d75 7374 2062 6520 6120 332d  xis must be a 3-
+0000fde0: 7365 7175 656e 6365 2e0a 2020 2020 2020  sequence..      
+0000fdf0: 2020 2222 220a 2020 2020 2020 2020 6364    """.        cd
+0000fe00: 6566 2064 6f75 626c 6520 6361 6e67 6c65  ef double cangle
+0000fe10: 2c20 6178 2c20 6179 2c20 617a 0a20 2020  , ax, ay, az.   
+0000fe20: 2020 2020 2063 6465 6620 646f 7562 6c65       cdef double
+0000fe30: 2073 7172 5f61 2c20 7371 725f 622c 2073   sqr_a, sqr_b, s
+0000fe40: 7172 5f63 2c20 6c65 6e32 0a20 2020 2020  qr_c, len2.     
+0000fe50: 2020 2063 6465 6620 646f 7562 6c65 206b     cdef double k
+0000fe60: 312c 206b 322c 206b 332c 206b 3161 622c  1, k2, k3, k1ab,
+0000fe70: 206b 3161 632c 206b 3162 632c 206b 3361   k1ac, k1bc, k3a
+0000fe80: 2c20 6b33 622c 206b 3363 0a20 2020 2020  , k3b, k3c.     
+0000fe90: 2020 2063 6465 6620 6d61 7433 2072 6573     cdef mat3 res
+0000fea0: 0a0a 2020 2020 2020 2020 6361 6e67 6c65  ..        cangle
+0000feb0: 2020 203d 2061 6e67 6c65 0a20 2020 2020     = angle.     
+0000fec0: 2020 2061 7820 2020 203d 2061 7869 735b     ax    = axis[
+0000fed0: 305d 0a20 2020 2020 2020 2061 7920 2020  0].        ay   
+0000fee0: 203d 2061 7869 735b 315d 0a20 2020 2020   = axis[1].     
+0000fef0: 2020 2061 7a20 2020 203d 2061 7869 735b     az    = axis[
+0000ff00: 325d 0a20 2020 2020 2020 2073 7172 5f61  2].        sqr_a
+0000ff10: 203d 2061 782a 6178 0a20 2020 2020 2020   = ax*ax.       
+0000ff20: 2073 7172 5f62 203d 2061 792a 6179 0a20   sqr_b = ay*ay. 
+0000ff30: 2020 2020 2020 2073 7172 5f63 203d 2061         sqr_c = a
+0000ff40: 7a2a 617a 0a20 2020 2020 2020 206c 656e  z*az.        len
+0000ff50: 3220 203d 2073 7172 5f61 2b73 7172 5f62  2  = sqr_a+sqr_b
+0000ff60: 2b73 7172 5f63 0a0a 2020 2020 2020 2020  +sqr_c..        
+0000ff70: 6b32 2020 2020 3d20 636f 7328 6361 6e67  k2    = cos(cang
+0000ff80: 6c65 290a 2020 2020 2020 2020 6b31 2020  le).        k1  
+0000ff90: 2020 3d20 2831 2e30 2d6b 3229 2f6c 656e    = (1.0-k2)/len
+0000ffa0: 320a 2020 2020 2020 2020 6b33 2020 2020  2.        k3    
+0000ffb0: 3d20 7369 6e28 6361 6e67 6c65 292f 7371  = sin(cangle)/sq
+0000ffc0: 7274 286c 656e 3229 0a20 2020 2020 2020  rt(len2).       
+0000ffd0: 206b 3161 6220 203d 206b 312a 6178 2a61   k1ab  = k1*ax*a
+0000ffe0: 790a 2020 2020 2020 2020 6b31 6163 2020  y.        k1ac  
+0000fff0: 3d20 6b31 2a61 782a 617a 0a20 2020 2020  = k1*ax*az.     
+00010000: 2020 206b 3162 6320 203d 206b 312a 6179     k1bc  = k1*ay
+00010010: 2a61 7a0a 2020 2020 2020 2020 6b33 6120  *az.        k3a 
+00010020: 2020 3d20 6b33 2a61 780a 2020 2020 2020    = k3*ax.      
+00010030: 2020 6b33 6220 2020 3d20 6b33 2a61 790a    k3b   = k3*ay.
+00010040: 2020 2020 2020 2020 6b33 6320 2020 3d20          k3c   = 
+00010050: 6b33 2a61 7a0a 0a20 2020 2020 2020 2072  k3*az..        r
+00010060: 6573 203d 206d 6174 3328 290a 2020 2020  es = mat3().    
+00010070: 2020 2020 7265 732e 6d31 3120 3d20 6b31      res.m11 = k1
+00010080: 2a73 7172 5f61 2b6b 320a 2020 2020 2020  *sqr_a+k2.      
+00010090: 2020 7265 732e 6d31 3220 3d20 6b31 6162    res.m12 = k1ab
+000100a0: 2d6b 3363 0a20 2020 2020 2020 2072 6573  -k3c.        res
+000100b0: 2e6d 3133 203d 206b 3161 632b 6b33 620a  .m13 = k1ac+k3b.
+000100c0: 2020 2020 2020 2020 7265 732e 6d32 3120          res.m21 
+000100d0: 3d20 6b31 6162 2b6b 3363 0a20 2020 2020  = k1ab+k3c.     
+000100e0: 2020 2072 6573 2e6d 3232 203d 206b 312a     res.m22 = k1*
+000100f0: 7371 725f 622b 6b32 0a20 2020 2020 2020  sqr_b+k2.       
+00010100: 2072 6573 2e6d 3233 203d 206b 3162 632d   res.m23 = k1bc-
+00010110: 6b33 610a 2020 2020 2020 2020 7265 732e  k3a.        res.
+00010120: 6d33 3120 3d20 6b31 6163 2d6b 3362 0a20  m31 = k1ac-k3b. 
+00010130: 2020 2020 2020 2072 6573 2e6d 3332 203d         res.m32 =
+00010140: 206b 3162 632b 6b33 610a 2020 2020 2020   k1bc+k3a.      
+00010150: 2020 7265 732e 6d33 3320 3d20 6b31 2a73    res.m33 = k1*s
+00010160: 7172 5f63 2b6b 320a 2020 2020 2020 2020  qr_c+k2.        
+00010170: 7265 7475 726e 2072 6573 0a0a 0a20 2020  return res...   
+00010180: 2064 6566 2073 6361 6c65 2873 656c 662c   def scale(self,
+00010190: 2073 293a 0a20 2020 2020 2020 2022 2222   s):.        """
+000101a0: 436f 6e63 6174 656e 6174 6520 6120 7363  Concatenate a sc
+000101b0: 616c 696e 672e 2222 220a 2020 2020 2020  aling.""".      
+000101c0: 2020 6364 6566 2064 6f75 626c 6520 7378    cdef double sx
+000101d0: 2c20 7379 2c20 737a 0a20 2020 2020 2020  , sy, sz.       
+000101e0: 2073 7820 3d20 735b 305d 0a20 2020 2020   sx = s[0].     
+000101f0: 2020 2073 7920 3d20 735b 315d 0a20 2020     sy = s[1].   
+00010200: 2020 2020 2073 7a20 3d20 735b 325d 0a20       sz = s[2]. 
+00010210: 2020 2020 2020 2073 656c 662e 6d31 3120         self.m11 
+00010220: 3d20 7365 6c66 2e6d 3131 2a73 780a 2020  = self.m11*sx.  
+00010230: 2020 2020 2020 7365 6c66 2e6d 3132 203d        self.m12 =
+00010240: 2073 656c 662e 6d31 322a 7379 0a20 2020   self.m12*sy.   
+00010250: 2020 2020 2073 656c 662e 6d31 3320 3d20       self.m13 = 
+00010260: 7365 6c66 2e6d 3133 2a73 7a0a 2020 2020  self.m13*sz.    
+00010270: 2020 2020 7365 6c66 2e6d 3231 203d 2073      self.m21 = s
+00010280: 656c 662e 6d32 312a 7378 0a20 2020 2020  elf.m21*sx.     
+00010290: 2020 2073 656c 662e 6d32 3220 3d20 7365     self.m22 = se
+000102a0: 6c66 2e6d 3232 2a73 790a 2020 2020 2020  lf.m22*sy.      
+000102b0: 2020 7365 6c66 2e6d 3233 203d 2073 656c    self.m23 = sel
+000102c0: 662e 6d32 332a 737a 0a20 2020 2020 2020  f.m23*sz.       
+000102d0: 2073 656c 662e 6d33 3120 3d20 7365 6c66   self.m31 = self
+000102e0: 2e6d 3331 2a73 780a 2020 2020 2020 2020  .m31*sx.        
+000102f0: 7365 6c66 2e6d 3332 203d 2073 656c 662e  self.m32 = self.
+00010300: 6d33 322a 7379 0a20 2020 2020 2020 2073  m32*sy.        s
+00010310: 656c 662e 6d33 3320 3d20 7365 6c66 2e6d  elf.m33 = self.m
+00010320: 3333 2a73 7a0a 2020 2020 2020 2020 7265  33*sz.        re
+00010330: 7475 726e 2073 656c 660a 0a20 2020 2064  turn self..    d
+00010340: 6566 2072 6f74 6174 6528 7365 6c66 2c20  ef rotate(self, 
+00010350: 616e 676c 652c 2061 7869 7329 3a0a 2020  angle, axis):.  
+00010360: 2020 2020 2020 2222 2243 6f6e 6361 7465        """Concate
+00010370: 6e61 7465 2061 2072 6f74 6174 696f 6e2e  nate a rotation.
+00010380: 0a0a 2020 2020 2020 2020 616e 676c 6520  ..        angle 
+00010390: 6d75 7374 2062 6520 6769 7665 6e20 696e  must be given in
+000103a0: 2072 6164 6961 6e73 2e20 6178 6973 206d   radians. axis m
+000103b0: 7573 7420 6265 2061 2033 2d73 6571 7565  ust be a 3-seque
+000103c0: 6e63 652e 0a20 2020 2020 2020 2022 2222  nce..        """
+000103d0: 0a20 2020 2020 2020 2063 6465 6620 6d61  .        cdef ma
+000103e0: 7433 2052 0a20 2020 2020 2020 2063 6465  t3 R.        cde
+000103f0: 6620 646f 7562 6c65 2063 312c 2063 322c  f double c1, c2,
+00010400: 2063 330a 2020 2020 2020 2020 523d 7365   c3.        R=se
+00010410: 6c66 2e72 6f74 6174 696f 6e28 616e 676c  lf.rotation(angl
+00010420: 652c 2061 7869 7329 0a0a 2020 2020 2020  e, axis)..      
+00010430: 2020 2320 7365 6c66 2a52 2020 2869 6e2d    # self*R  (in-
+00010440: 706c 6163 6529 0a20 2020 2020 2020 2063  place).        c
+00010450: 3120 3d20 7365 6c66 2e6d 3131 0a20 2020  1 = self.m11.   
+00010460: 2020 2020 2063 3220 3d20 7365 6c66 2e6d       c2 = self.m
+00010470: 3132 0a20 2020 2020 2020 2063 3320 3d20  12.        c3 = 
+00010480: 7365 6c66 2e6d 3133 0a20 2020 2020 2020  self.m13.       
+00010490: 2073 656c 662e 6d31 3120 3d20 6331 2a52   self.m11 = c1*R
+000104a0: 2e6d 3131 2b63 322a 522e 6d32 312b 6333  .m11+c2*R.m21+c3
+000104b0: 2a52 2e6d 3331 0a20 2020 2020 2020 2073  *R.m31.        s
+000104c0: 656c 662e 6d31 3220 3d20 6331 2a52 2e6d  elf.m12 = c1*R.m
+000104d0: 3132 2b63 322a 522e 6d32 322b 6333 2a52  12+c2*R.m22+c3*R
+000104e0: 2e6d 3332 0a20 2020 2020 2020 2073 656c  .m32.        sel
+000104f0: 662e 6d31 3320 3d20 6331 2a52 2e6d 3133  f.m13 = c1*R.m13
+00010500: 2b63 322a 522e 6d32 332b 6333 2a52 2e6d  +c2*R.m23+c3*R.m
+00010510: 3333 0a0a 2020 2020 2020 2020 6331 203d  33..        c1 =
+00010520: 2073 656c 662e 6d32 310a 2020 2020 2020   self.m21.      
+00010530: 2020 6332 203d 2073 656c 662e 6d32 320a    c2 = self.m22.
+00010540: 2020 2020 2020 2020 6333 203d 2073 656c          c3 = sel
+00010550: 662e 6d32 330a 2020 2020 2020 2020 7365  f.m23.        se
+00010560: 6c66 2e6d 3231 203d 2063 312a 522e 6d31  lf.m21 = c1*R.m1
+00010570: 312b 6332 2a52 2e6d 3231 2b63 332a 522e  1+c2*R.m21+c3*R.
+00010580: 6d33 310a 2020 2020 2020 2020 7365 6c66  m31.        self
+00010590: 2e6d 3232 203d 2063 312a 522e 6d31 322b  .m22 = c1*R.m12+
+000105a0: 6332 2a52 2e6d 3232 2b63 332a 522e 6d33  c2*R.m22+c3*R.m3
+000105b0: 320a 2020 2020 2020 2020 7365 6c66 2e6d  2.        self.m
+000105c0: 3233 203d 2063 312a 522e 6d31 332b 6332  23 = c1*R.m13+c2
+000105d0: 2a52 2e6d 3233 2b63 332a 522e 6d33 330a  *R.m23+c3*R.m33.
+000105e0: 0a20 2020 2020 2020 2063 3120 3d20 7365  .        c1 = se
+000105f0: 6c66 2e6d 3331 0a20 2020 2020 2020 2063  lf.m31.        c
+00010600: 3220 3d20 7365 6c66 2e6d 3332 0a20 2020  2 = self.m32.   
+00010610: 2020 2020 2063 3320 3d20 7365 6c66 2e6d       c3 = self.m
+00010620: 3333 0a20 2020 2020 2020 2073 656c 662e  33.        self.
+00010630: 6d33 3120 3d20 6331 2a52 2e6d 3131 2b63  m31 = c1*R.m11+c
+00010640: 322a 522e 6d32 312b 6333 2a52 2e6d 3331  2*R.m21+c3*R.m31
+00010650: 0a20 2020 2020 2020 2073 656c 662e 6d33  .        self.m3
+00010660: 3220 3d20 6331 2a52 2e6d 3132 2b63 322a  2 = c1*R.m12+c2*
+00010670: 522e 6d32 322b 6333 2a52 2e6d 3332 0a20  R.m22+c3*R.m32. 
+00010680: 2020 2020 2020 2073 656c 662e 6d33 3320         self.m33 
+00010690: 3d20 6331 2a52 2e6d 3133 2b63 322a 522e  = c1*R.m13+c2*R.
+000106a0: 6d32 332b 6333 2a52 2e6d 3333 0a0a 2020  m23+c3*R.m33..  
+000106b0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+000106c0: 660a 0a20 2020 2064 6566 206f 7274 686f  f..    def ortho
+000106d0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+000106e0: 2222 2252 6574 7572 6e20 6120 6d61 7472  """Return a matr
+000106f0: 6978 2077 6974 6820 6f72 7468 6f67 6f6e  ix with orthogon
+00010700: 616c 2062 6173 6520 7665 6374 6f72 732e  al base vectors.
+00010710: 0a0a 2020 2020 2020 2020 4d61 6b65 7320  ..        Makes 
+00010720: 7468 6520 782d 2c20 792d 2061 6e64 207a  the x-, y- and z
+00010730: 2d61 7869 7320 6f72 7468 6f67 6f6e 616c  -axis orthogonal
+00010740: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+00010750: 2020 2020 2020 6364 6566 206d 6174 3320        cdef mat3 
+00010760: 7265 730a 2020 2020 2020 2020 6364 6566  res.        cdef
+00010770: 2076 6563 3320 782c 792c 7a0a 0a20 2020   vec3 x,y,z..   
+00010780: 2020 2020 2078 203d 2076 6563 3328 7365       x = vec3(se
+00010790: 6c66 2e6d 3131 2c20 7365 6c66 2e6d 3231  lf.m11, self.m21
+000107a0: 2c20 7365 6c66 2e6d 3331 290a 2020 2020  , self.m31).    
+000107b0: 2020 2020 7920 3d20 7665 6333 2873 656c      y = vec3(sel
+000107c0: 662e 6d31 322c 2073 656c 662e 6d32 322c  f.m12, self.m22,
+000107d0: 2073 656c 662e 6d33 3229 0a20 2020 2020   self.m32).     
+000107e0: 2020 207a 203d 2076 6563 3328 7365 6c66     z = vec3(self
+000107f0: 2e6d 3133 2c20 7365 6c66 2e6d 3233 2c20  .m13, self.m23, 
+00010800: 7365 6c66 2e6d 3333 290a 0a20 2020 2020  self.m33)..     
+00010810: 2020 2078 6c20 3d20 782e 6c65 6e67 7468     xl = x.length
+00010820: 2829 0a20 2020 2020 2020 2078 6c20 3d20  ().        xl = 
+00010830: 786c 2a78 6c0a 2020 2020 2020 2020 7920  xl*xl.        y 
+00010840: 3d20 7920 2d20 2828 782a 7929 2f78 6c29  = y - ((x*y)/xl)
+00010850: 2a78 0a20 2020 2020 2020 207a 203d 207a  *x.        z = z
+00010860: 202d 2028 2878 2a7a 292f 786c 292a 780a   - ((x*z)/xl)*x.
+00010870: 0a20 2020 2020 2020 2079 6c20 3d20 792e  .        yl = y.
+00010880: 6c65 6e67 7468 2829 0a20 2020 2020 2020  length().       
+00010890: 2079 6c20 3d20 796c 2a79 6c0a 2020 2020   yl = yl*yl.    
+000108a0: 2020 2020 7a20 3d20 7a20 2d20 2828 792a      z = z - ((y*
+000108b0: 7a29 2f79 6c29 2a79 0a0a 2020 2020 2020  z)/yl)*y..      
+000108c0: 2020 7265 7320 3d20 6d61 7433 2829 0a20    res = mat3(). 
+000108d0: 2020 2020 2020 2072 6573 2e6d 3131 203d         res.m11 =
+000108e0: 2078 2e78 0a20 2020 2020 2020 2072 6573   x.x.        res
+000108f0: 2e6d 3132 203d 2079 2e78 0a20 2020 2020  .m12 = y.x.     
+00010900: 2020 2072 6573 2e6d 3133 203d 207a 2e78     res.m13 = z.x
+00010910: 0a20 2020 2020 2020 2072 6573 2e6d 3231  .        res.m21
+00010920: 203d 2078 2e79 0a20 2020 2020 2020 2072   = x.y.        r
+00010930: 6573 2e6d 3232 203d 2079 2e79 0a20 2020  es.m22 = y.y.   
+00010940: 2020 2020 2072 6573 2e6d 3233 203d 207a       res.m23 = z
+00010950: 2e79 0a20 2020 2020 2020 2072 6573 2e6d  .y.        res.m
+00010960: 3331 203d 2078 2e7a 0a20 2020 2020 2020  31 = x.z.       
+00010970: 2072 6573 2e6d 3332 203d 2079 2e7a 0a20   res.m32 = y.z. 
+00010980: 2020 2020 2020 2072 6573 2e6d 3333 203d         res.m33 =
+00010990: 207a 2e7a 0a20 2020 2020 2020 2072 6574   z.z.        ret
+000109a0: 7572 6e20 7265 730a 0a20 2020 2064 6566  urn res..    def
+000109b0: 2064 6563 6f6d 706f 7365 2873 656c 6629   decompose(self)
+000109c0: 3a0a 2020 2020 2020 2020 2222 2244 6563  :.        """Dec
+000109d0: 6f6d 706f 7365 7320 7468 6520 6d61 7472  omposes the matr
+000109e0: 6978 2069 6e74 6f20 6120 726f 7461 7469  ix into a rotati
+000109f0: 6f6e 2061 6e64 2073 6361 6c69 6e67 2070  on and scaling p
+00010a00: 6172 742e 0a0a 2020 2020 2020 2020 5265  art...        Re
+00010a10: 7475 726e 7320 6120 7475 706c 6520 2872  turns a tuple (r
+00010a20: 6f74 6174 696f 6e2c 2073 6361 6c69 6e67  otation, scaling
+00010a30: 292e 2054 6865 2073 6361 6c69 6e67 2070  ). The scaling p
+00010a40: 6172 7420 6973 2067 6976 656e 0a20 2020  art is given.   
+00010a50: 2020 2020 2061 7320 6120 7665 6333 2c20       as a vec3, 
+00010a60: 7468 6520 726f 7461 7469 6f6e 2069 7320  the rotation is 
+00010a70: 7374 696c 6c20 6120 6d61 7433 2e0a 2020  still a mat3..  
+00010a80: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00010a90: 2020 6364 6566 206d 6174 3320 6d0a 2020    cdef mat3 m.  
+00010aa0: 2020 2020 2020 6364 6566 2076 6563 3320        cdef vec3 
+00010ab0: 612c 622c 630a 2020 2020 2020 2020 6364  a,b,c.        cd
+00010ac0: 6566 2064 6f75 626c 6520 616c 2c20 626c  ef double al, bl
+00010ad0: 2c20 636c 0a0a 2020 2020 2020 2020 6d20  , cl..        m 
+00010ae0: 3d20 7365 6c66 2e6f 7274 686f 2829 0a0a  = self.ortho()..
+00010af0: 2020 2020 2020 2020 2320 612c 622c 6320          # a,b,c 
+00010b00: 3d20 436f 6c75 6d6e 2030 2c31 2c32 206f  = Column 0,1,2 o
+00010b10: 6620 6d0a 2020 2020 2020 2020 6120 3d20  f m.        a = 
+00010b20: 7665 6333 2829 0a20 2020 2020 2020 2062  vec3().        b
+00010b30: 203d 2076 6563 3328 290a 2020 2020 2020   = vec3().      
+00010b40: 2020 6320 3d20 7665 6333 2829 0a20 2020    c = vec3().   
+00010b50: 2020 2020 2061 2e78 203d 206d 2e6d 3131       a.x = m.m11
+00010b60: 0a20 2020 2020 2020 2061 2e79 203d 206d  .        a.y = m
+00010b70: 2e6d 3231 0a20 2020 2020 2020 2061 2e7a  .m21.        a.z
+00010b80: 203d 206d 2e6d 3331 0a20 2020 2020 2020   = m.m31.       
+00010b90: 2062 2e78 203d 206d 2e6d 3132 0a20 2020   b.x = m.m12.   
+00010ba0: 2020 2020 2062 2e79 203d 206d 2e6d 3232       b.y = m.m22
+00010bb0: 0a20 2020 2020 2020 2062 2e7a 203d 206d  .        b.z = m
+00010bc0: 2e6d 3332 0a20 2020 2020 2020 2063 2e78  .m32.        c.x
+00010bd0: 203d 206d 2e6d 3133 0a20 2020 2020 2020   = m.m13.       
+00010be0: 2063 2e79 203d 206d 2e6d 3233 0a20 2020   c.y = m.m23.   
+00010bf0: 2020 2020 2063 2e7a 203d 206d 2e6d 3333       c.z = m.m33
+00010c00: 0a0a 2020 2020 2020 2020 2320 616c 2c62  ..        # al,b
+00010c10: 6c2c 636c 203d 206c 656e 6774 6820 6f66  l,cl = length of
+00010c20: 2061 2c62 2c63 2028 3d20 7363 616c 696e   a,b,c (= scalin
+00010c30: 6720 6661 6374 6f72 7329 0a20 2020 2020  g factors).     
+00010c40: 2020 2061 6c20 3d20 7371 7274 2861 2e78     al = sqrt(a.x
+00010c50: 2a61 2e78 202b 2061 2e79 2a61 2e79 202b  *a.x + a.y*a.y +
+00010c60: 2061 2e7a 2a61 2e7a 290a 2020 2020 2020   a.z*a.z).      
+00010c70: 2020 626c 203d 2073 7172 7428 622e 782a    bl = sqrt(b.x*
+00010c80: 622e 7820 2b20 622e 792a 622e 7920 2b20  b.x + b.y*b.y + 
+00010c90: 622e 7a2a 622e 7a29 0a20 2020 2020 2020  b.z*b.z).       
+00010ca0: 2063 6c20 3d20 7371 7274 2863 2e78 2a63   cl = sqrt(c.x*c
+00010cb0: 2e78 202b 2063 2e79 2a63 2e79 202b 2063  .x + c.y*c.y + c
+00010cc0: 2e7a 2a63 2e7a 290a 2020 2020 2020 2020  .z*c.z).        
+00010cd0: 6966 2061 6c3c 3d65 7073 206f 7220 626c  if al<=eps or bl
+00010ce0: 3c3d 6570 7320 6f72 2063 6c3c 3d65 7073  <=eps or cl<=eps
+00010cf0: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+00010d00: 6973 6520 5a65 726f 4469 7669 7369 6f6e  ise ZeroDivision
+00010d10: 4572 726f 722c 2274 7261 6e73 666f 726d  Error,"transform
+00010d20: 6174 696f 6e20 636f 6e74 6169 6e73 2061  ation contains a
+00010d30: 2030 2073 6361 6c69 6e67 220a 0a20 2020   0 scaling"..   
+00010d40: 2020 2020 2073 6361 6c65 203d 2076 6563       scale = vec
+00010d50: 3328 616c 2c62 6c2c 636c 290a 0a20 2020  3(al,bl,cl)..   
+00010d60: 2020 2020 2023 206e 6f72 6d61 6c69 7a69       # normalizi
+00010d70: 6e67 2061 2c62 2c63 0a23 2020 2020 2020  ng a,b,c.#      
+00010d80: 2020 612f 3d61 6c0a 2320 2020 2020 2020    a/=al.#       
+00010d90: 2062 2f3d 626c 0a23 2020 2020 2020 2020   b/=bl.#        
+00010da0: 632f 3d63 6c0a 2020 2020 2020 2020 612e  c/=cl.        a.
+00010db0: 7820 3d20 612e 782f 616c 0a20 2020 2020  x = a.x/al.     
+00010dc0: 2020 2061 2e79 203d 2061 2e79 2f61 6c0a     a.y = a.y/al.
+00010dd0: 2020 2020 2020 2020 612e 7a20 3d20 612e          a.z = a.
+00010de0: 7a2f 616c 0a20 2020 2020 2020 2062 2e78  z/al.        b.x
+00010df0: 203d 2062 2e78 2f62 6c0a 2020 2020 2020   = b.x/bl.      
+00010e00: 2020 622e 7920 3d20 622e 792f 626c 0a20    b.y = b.y/bl. 
+00010e10: 2020 2020 2020 2062 2e7a 203d 2062 2e7a         b.z = b.z
+00010e20: 2f62 6c0a 2020 2020 2020 2020 632e 7820  /bl.        c.x 
+00010e30: 3d20 632e 782f 636c 0a20 2020 2020 2020  = c.x/cl.       
+00010e40: 2063 2e79 203d 2063 2e79 2f63 6c0a 2020   c.y = c.y/cl.  
+00010e50: 2020 2020 2020 632e 7a20 3d20 632e 7a2f        c.z = c.z/
+00010e60: 636c 0a0a 2020 2020 2020 2020 6d2e 6d31  cl..        m.m1
+00010e70: 3120 3d20 612e 780a 2020 2020 2020 2020  1 = a.x.        
+00010e80: 6d2e 6d32 3120 3d20 612e 790a 2020 2020  m.m21 = a.y.    
+00010e90: 2020 2020 6d2e 6d33 3120 3d20 612e 7a0a      m.m31 = a.z.
+00010ea0: 2020 2020 2020 2020 6d2e 6d31 3220 3d20          m.m12 = 
+00010eb0: 622e 780a 2020 2020 2020 2020 6d2e 6d32  b.x.        m.m2
+00010ec0: 3220 3d20 622e 790a 2020 2020 2020 2020  2 = b.y.        
+00010ed0: 6d2e 6d33 3220 3d20 622e 7a0a 2020 2020  m.m32 = b.z.    
+00010ee0: 2020 2020 6d2e 6d31 3320 3d20 632e 780a      m.m13 = c.x.
+00010ef0: 2020 2020 2020 2020 6d2e 6d32 3320 3d20          m.m23 = 
+00010f00: 632e 790a 2020 2020 2020 2020 6d2e 6d33  c.y.        m.m3
+00010f10: 3320 3d20 632e 7a0a 2020 2020 2020 2020  3 = c.z.        
+00010f20: 6966 206d 2e64 6574 6572 6d69 6e61 6e74  if m.determinant
+00010f30: 2829 3c30 2e30 3a0a 2020 2020 2020 2020  ()<0.0:.        
+00010f40: 2020 2020 6d2e 6d31 3120 3d20 2d6d 2e6d      m.m11 = -m.m
+00010f50: 3131 0a20 2020 2020 2020 2020 2020 206d  11.            m
+00010f60: 2e6d 3231 203d 202d 6d2e 6d32 310a 2020  .m21 = -m.m21.  
+00010f70: 2020 2020 2020 2020 2020 6d2e 6d33 3120            m.m31 
+00010f80: 3d20 2d6d 2e6d 3331 0a20 2020 2020 2020  = -m.m31.       
+00010f90: 2020 2020 2073 6361 6c65 2e78 203d 202d       scale.x = -
+00010fa0: 7363 616c 652e 780a 0a20 2020 2020 2020  scale.x..       
+00010fb0: 2072 6574 7572 6e20 286d 2c20 7363 616c   return (m, scal
+00010fc0: 6529 0a0a 0a23 2323 2323 2323 2323 2323  e)...###########
+00010fd0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00010fe0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00010ff0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00011000: 2323 2323 2323 2323 2323 230a 0a23 206d  ###########..# m
+00011010: 6174 3469 7465 720a 6364 6566 2063 6c61  at4iter.cdef cla
+00011020: 7373 206d 6174 3469 7465 723a 0a20 2020  ss mat4iter:.   
+00011030: 2022 2222 6d61 7420 6974 6572 6174 6f72   """mat iterator
+00011040: 2e22 2222 0a20 2020 2063 6465 6620 696e  .""".    cdef in
+00011050: 7420 6964 780a 2020 2020 6364 6566 206f  t idx.    cdef o
+00011060: 626a 6563 7420 6d0a 0a20 2020 2064 6566  bject m..    def
+00011070: 205f 5f63 696e 6974 5f5f 2873 656c 662c   __cinit__(self,
+00011080: 206d 293a 0a20 2020 2020 2020 2073 656c   m):.        sel
+00011090: 662e 6964 7820 3d20 300a 2020 2020 2020  f.idx = 0.      
+000110a0: 2020 7365 6c66 2e6d 2020 203d 206d 0a0a    self.m   = m..
+000110b0: 2020 2020 6465 6620 5f5f 6974 6572 5f5f      def __iter__
+000110c0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+000110d0: 7265 7475 726e 2073 656c 660a 0a20 2020  return self..   
+000110e0: 2064 6566 205f 5f6e 6578 745f 5f28 7365   def __next__(se
+000110f0: 6c66 293a 0a20 2020 2020 2020 2069 6620  lf):.        if 
+00011100: 7365 6c66 2e69 6478 3d3d 303a 0a20 2020  self.idx==0:.   
+00011110: 2020 2020 2020 2020 2073 656c 662e 6964           self.id
+00011120: 783d 310a 2020 2020 2020 2020 2020 2020  x=1.            
+00011130: 7265 7475 726e 2073 656c 662e 6d5b 305d  return self.m[0]
+00011140: 0a20 2020 2020 2020 2065 6c69 6620 7365  .        elif se
+00011150: 6c66 2e69 6478 3d3d 313a 0a20 2020 2020  lf.idx==1:.     
+00011160: 2020 2020 2020 2073 656c 662e 6964 783d         self.idx=
+00011170: 320a 2020 2020 2020 2020 2020 2020 7265  2.            re
+00011180: 7475 726e 2073 656c 662e 6d5b 315d 0a20  turn self.m[1]. 
+00011190: 2020 2020 2020 2065 6c69 6620 7365 6c66         elif self
+000111a0: 2e69 6478 3d3d 323a 0a20 2020 2020 2020  .idx==2:.       
+000111b0: 2020 2020 2073 656c 662e 6964 783d 330a       self.idx=3.
+000111c0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+000111d0: 726e 2073 656c 662e 6d5b 325d 0a20 2020  rn self.m[2].   
+000111e0: 2020 2020 2065 6c69 6620 7365 6c66 2e69       elif self.i
+000111f0: 6478 3d3d 333a 0a20 2020 2020 2020 2020  dx==3:.         
+00011200: 2020 2073 656c 662e 6964 783d 340a 2020     self.idx=4.  
+00011210: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00011220: 2073 656c 662e 6d5b 335d 0a20 2020 2020   self.m[3].     
+00011230: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00011240: 2020 2020 2072 6169 7365 2053 746f 7049       raise StopI
+00011250: 7465 7261 7469 6f6e 0a0a 2320 4361 6c63  teration..# Calc
+00011260: 756c 6174 6573 206d 332e 6465 7465 726d  ulates m3.determ
+00011270: 696e 616e 7428 2920 7768 6572 6520 6d33  inant() where m3
+00011280: 2069 7320 6120 6d61 7433 2074 6861 7420   is a mat3 that 
+00011290: 6973 2062 6173 6564 206f 6e20 6d34 0a23  is based on m4.#
+000112a0: 2077 6865 7265 2072 6f77 2069 2061 6e64   where row i and
+000112b0: 2063 6f6c 756d 6e20 6a20 6172 6520 6c65   column j are le
+000112c0: 6674 206f 7574 2e0a 6364 6566 2064 6f75  ft out..cdef dou
+000112d0: 626c 6520 5f73 7562 6465 7428 646f 7562  ble _subdet(doub
+000112e0: 6c65 206d 345b 3136 5d2c 2073 686f 7274  le m4[16], short
+000112f0: 2069 2c20 7368 6f72 7420 6a29 3a0a 2020   i, short j):.  
+00011300: 2020 6364 6566 2064 6f75 626c 6520 6d33    cdef double m3
+00011310: 5b39 5d0a 2020 2020 6364 6566 2064 6f75  [9].    cdef dou
+00011320: 626c 652a 2070 0a20 2020 2063 6465 6620  ble* p.    cdef 
+00011330: 7368 6f72 7420 6b2c 206c 0a0a 2020 2020  short k, l..    
+00011340: 7020 3d20 6d33 0a20 2020 206b 3d30 0a20  p = m3.    k=0. 
+00011350: 2020 2077 6869 6c65 2031 3a0a 2020 2020     while 1:.    
+00011360: 2020 2020 6966 206b 3d3d 693a 0a20 2020      if k==i:.   
+00011370: 2020 2020 2020 2020 206b 3d6b 2b31 0a20           k=k+1. 
+00011380: 2020 2020 2020 2069 6620 6b3d 3d34 3a0a         if k==4:.
+00011390: 2020 2020 2020 2020 2020 2020 6272 6561              brea
+000113a0: 6b0a 2020 2020 2020 2020 6c3d 300a 2020  k.        l=0.  
+000113b0: 2020 2020 2020 7768 696c 6520 313a 0a20        while 1:. 
+000113c0: 2020 2020 2020 2020 2020 2069 6620 6c3d             if l=
+000113d0: 3d6a 3a0a 2020 2020 2020 2020 2020 2020  =j:.            
+000113e0: 2020 2020 6c3d 6c2b 310a 2020 2020 2020      l=l+1.      
+000113f0: 2020 2020 2020 6966 206c 3d3d 343a 0a20        if l==4:. 
+00011400: 2020 2020 2020 2020 2020 2020 2020 2062                 b
+00011410: 7265 616b 0a20 2020 2020 2020 2020 2020  reak.           
+00011420: 2070 5b30 5d3d 6d34 5b6b 2a34 2b6c 5d0a   p[0]=m4[k*4+l].
+00011430: 2020 2020 2020 2020 2020 2020 703d 702b              p=p+
+00011440: 310a 2020 2020 2020 2020 2020 2020 6c3d  1.            l=
+00011450: 6c2b 310a 2020 2020 2020 2020 6b3d 6b2b  l+1.        k=k+
+00011460: 310a 0a20 2020 2072 6574 7572 6e20 6d33  1..    return m3
+00011470: 5b30 5d2a 6d33 5b34 5d2a 6d33 5b38 5d2b  [0]*m3[4]*m3[8]+
+00011480: 205c 0a20 2020 2020 2020 2020 2020 6d33   \.           m3
+00011490: 5b31 5d2a 6d33 5b35 5d2a 6d33 5b36 5d2b  [1]*m3[5]*m3[6]+
+000114a0: 205c 0a20 2020 2020 2020 2020 2020 6d33   \.           m3
+000114b0: 5b32 5d2a 6d33 5b33 5d2a 6d33 5b37 5d2d  [2]*m3[3]*m3[7]-
+000114c0: 205c 0a20 2020 2020 2020 2020 2020 6d33   \.           m3
+000114d0: 5b36 5d2a 6d33 5b34 5d2a 6d33 5b32 5d2d  [6]*m3[4]*m3[2]-
+000114e0: 205c 0a20 2020 2020 2020 2020 2020 6d33   \.           m3
+000114f0: 5b37 5d2a 6d33 5b35 5d2a 6d33 5b30 5d2d  [7]*m3[5]*m3[0]-
+00011500: 205c 0a20 2020 2020 2020 2020 2020 6d33   \.           m3
+00011510: 5b38 5d2a 6d33 5b33 5d2a 6d33 5b31 5d0a  [8]*m3[3]*m3[1].
+00011520: 0a0a 0a23 206d 6174 340a 6364 6566 2063  ...# mat4.cdef c
+00011530: 6c61 7373 206d 6174 343a 0a0a 2020 2020  lass mat4:..    
+00011540: 6364 6566 2064 6f75 626c 6520 6d31 312c  cdef double m11,
+00011550: 206d 3132 2c20 6d31 332c 206d 3134 0a20   m12, m13, m14. 
+00011560: 2020 2063 6465 6620 646f 7562 6c65 206d     cdef double m
+00011570: 3231 2c20 6d32 322c 206d 3233 2c20 6d32  21, m22, m23, m2
+00011580: 340a 2020 2020 6364 6566 2064 6f75 626c  4.    cdef doubl
+00011590: 6520 6d33 312c 206d 3332 2c20 6d33 332c  e m31, m32, m33,
+000115a0: 206d 3334 0a20 2020 2063 6465 6620 646f   m34.    cdef do
+000115b0: 7562 6c65 206d 3431 2c20 6d34 322c 206d  uble m41, m42, m
+000115c0: 3433 2c20 6d34 340a 0a20 2020 2064 6566  43, m44..    def
+000115d0: 205f 5f63 696e 6974 5f5f 2873 656c 662c   __cinit__(self,
+000115e0: 202a 6172 6773 293a 0a20 2020 2020 2020   *args):.       
+000115f0: 2063 6465 6620 696e 7420 6172 676c 656e   cdef int arglen
+00011600: 0a20 2020 2020 2020 2063 6465 6620 6d61  .        cdef ma
+00011610: 7434 2042 0a20 2020 2020 2020 2061 7267  t4 B.        arg
+00011620: 6c65 6e20 3d20 6c65 6e28 6172 6773 290a  len = len(args).
+00011630: 0a20 2020 2020 2020 2023 204e 6f20 6172  .        # No ar
+00011640: 6775 6d65 6e74 730a 2020 2020 2020 2020  guments.        
+00011650: 6966 2061 7267 6c65 6e3d 3d30 3a0a 2020  if arglen==0:.  
+00011660: 2020 2020 2020 2020 2020 6d31 313d 6d31            m11=m1
+00011670: 323d 6d31 333d 6d31 343d 302e 300a 2020  2=m13=m14=0.0.  
+00011680: 2020 2020 2020 2020 2020 6d32 313d 6d32            m21=m2
+00011690: 323d 6d32 333d 6d32 343d 302e 300a 2020  2=m23=m24=0.0.  
+000116a0: 2020 2020 2020 2020 2020 6d33 313d 6d33            m31=m3
+000116b0: 323d 6d33 333d 6d33 343d 302e 300a 2020  2=m33=m34=0.0.  
+000116c0: 2020 2020 2020 2020 2020 6d34 313d 6d34            m41=m4
+000116d0: 323d 6d34 333d 6d34 343d 302e 300a 0a20  2=m43=m44=0.0.. 
+000116e0: 2020 2020 2020 2023 2031 2061 7267 756d         # 1 argum
+000116f0: 656e 7420 286c 6973 742c 2073 6361 6c61  ent (list, scala
+00011700: 7220 6f72 206d 6174 3429 0a20 2020 2020  r or mat4).     
+00011710: 2020 2065 6c69 6620 6172 676c 656e 3d3d     elif arglen==
+00011720: 313a 0a20 2020 2020 2020 2020 2020 2054  1:.            T
+00011730: 203d 2074 7970 6528 6172 6773 5b30 5d29   = type(args[0])
+00011740: 0a20 2020 2020 2020 2020 2020 2023 2073  .            # s
+00011750: 6361 6c61 720a 2020 2020 2020 2020 2020  calar.          
+00011760: 2020 6966 2054 2069 7320 666c 6f61 7420    if T is float 
+00011770: 6f72 2054 2069 7320 696e 7420 6f72 2054  or T is int or T
+00011780: 2069 7320 6c6f 6e67 3a0a 2020 2020 2020   is long:.      
+00011790: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+000117a0: 3131 203d 2061 7267 735b 305d 0a20 2020  11 = args[0].   
+000117b0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+000117c0: 662e 6d31 3220 3d20 302e 300a 2020 2020  f.m12 = 0.0.    
+000117d0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000117e0: 2e6d 3133 203d 2030 2e30 0a20 2020 2020  .m13 = 0.0.     
+000117f0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00011800: 6d31 3420 3d20 302e 300a 2020 2020 2020  m14 = 0.0.      
+00011810: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+00011820: 3231 203d 2030 2e30 0a20 2020 2020 2020  21 = 0.0.       
+00011830: 2020 2020 2020 2020 2073 656c 662e 6d32           self.m2
+00011840: 3220 3d20 7365 6c66 2e6d 3131 0a20 2020  2 = self.m11.   
+00011850: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00011860: 662e 6d32 3320 3d20 302e 300a 2020 2020  f.m23 = 0.0.    
+00011870: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00011880: 2e6d 3234 203d 2030 2e30 0a20 2020 2020  .m24 = 0.0.     
+00011890: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000118a0: 6d33 3120 3d20 302e 300a 2020 2020 2020  m31 = 0.0.      
+000118b0: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+000118c0: 3332 203d 2030 2e30 0a20 2020 2020 2020  32 = 0.0.       
+000118d0: 2020 2020 2020 2020 2073 656c 662e 6d33           self.m3
+000118e0: 3320 3d20 7365 6c66 2e6d 3131 0a20 2020  3 = self.m11.   
+000118f0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00011900: 662e 6d33 3420 3d20 302e 300a 2020 2020  f.m34 = 0.0.    
+00011910: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00011920: 2e6d 3431 203d 2030 2e30 0a20 2020 2020  .m41 = 0.0.     
+00011930: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00011940: 6d34 3220 3d20 302e 300a 2020 2020 2020  m42 = 0.0.      
+00011950: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+00011960: 3433 203d 2030 2e30 0a20 2020 2020 2020  43 = 0.0.       
+00011970: 2020 2020 2020 2020 2073 656c 662e 6d34           self.m4
+00011980: 3420 3d20 7365 6c66 2e6d 3131 0a20 2020  4 = self.m11.   
+00011990: 2020 2020 2020 2020 2023 206d 6174 340a           # mat4.
+000119a0: 2020 2020 2020 2020 2020 2020 656c 6966              elif
+000119b0: 2054 2069 7320 6d61 7434 3a0a 2020 2020   T is mat4:.    
+000119c0: 2020 2020 2020 2020 2020 2020 4220 3d20              B = 
+000119d0: 6172 6773 5b30 5d0a 2020 2020 2020 2020  args[0].        
+000119e0: 2020 2020 2020 2020 7365 6c66 2e6d 3131          self.m11
+000119f0: 203d 2042 2e6d 3131 0a20 2020 2020 2020   = B.m11.       
+00011a00: 2020 2020 2020 2020 2073 656c 662e 6d31           self.m1
+00011a10: 3220 3d20 422e 6d31 320a 2020 2020 2020  2 = B.m12.      
+00011a20: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+00011a30: 3133 203d 2042 2e6d 3133 0a20 2020 2020  13 = B.m13.     
+00011a40: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00011a50: 6d31 3420 3d20 422e 6d31 340a 2020 2020  m14 = B.m14.    
+00011a60: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00011a70: 2e6d 3231 203d 2042 2e6d 3231 0a20 2020  .m21 = B.m21.   
+00011a80: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00011a90: 662e 6d32 3220 3d20 422e 6d32 320a 2020  f.m22 = B.m22.  
+00011aa0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00011ab0: 6c66 2e6d 3233 203d 2042 2e6d 3233 0a20  lf.m23 = B.m23. 
+00011ac0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00011ad0: 656c 662e 6d32 3420 3d20 422e 6d32 340a  elf.m24 = B.m24.
+00011ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011af0: 7365 6c66 2e6d 3331 203d 2042 2e6d 3331  self.m31 = B.m31
+00011b00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00011b10: 2073 656c 662e 6d33 3220 3d20 422e 6d33   self.m32 = B.m3
+00011b20: 320a 2020 2020 2020 2020 2020 2020 2020  2.              
+00011b30: 2020 7365 6c66 2e6d 3333 203d 2042 2e6d    self.m33 = B.m
+00011b40: 3333 0a20 2020 2020 2020 2020 2020 2020  33.             
+00011b50: 2020 2073 656c 662e 6d33 3420 3d20 422e     self.m34 = B.
+00011b60: 6d33 340a 2020 2020 2020 2020 2020 2020  m34.            
+00011b70: 2020 2020 7365 6c66 2e6d 3431 203d 2042      self.m41 = B
+00011b80: 2e6d 3431 0a20 2020 2020 2020 2020 2020  .m41.           
+00011b90: 2020 2020 2073 656c 662e 6d34 3220 3d20       self.m42 = 
+00011ba0: 422e 6d34 320a 2020 2020 2020 2020 2020  B.m42.          
+00011bb0: 2020 2020 2020 7365 6c66 2e6d 3433 203d        self.m43 =
+00011bc0: 2042 2e6d 3433 0a20 2020 2020 2020 2020   B.m43.         
+00011bd0: 2020 2020 2020 2073 656c 662e 6d34 3420         self.m44 
+00011be0: 3d20 422e 6d34 340a 2020 2020 2020 2020  = B.m44.        
+00011bf0: 2020 2020 2320 5374 7269 6e67 0a20 2020      # String.   
+00011c00: 2020 2020 2020 2020 2065 6c69 6620 5420           elif T 
+00011c10: 6973 2073 7472 206f 7220 5420 6973 2075  is str or T is u
+00011c20: 6e69 636f 6465 3a0a 2020 2020 2020 2020  nicode:.        
+00011c30: 2020 2020 2020 2020 733d 6172 6773 5b30          s=args[0
+00011c40: 5d2e 7265 706c 6163 6528 222c 222c 2220  ].replace(","," 
+00011c50: 2229 2e72 6570 6c61 6365 2822 2020 222c  ").replace("  ",
+00011c60: 2220 2229 2e73 7472 6970 2829 2e73 706c  " ").strip().spl
+00011c70: 6974 2822 2022 290a 2020 2020 2020 2020  it(" ").        
+00011c80: 2020 2020 2020 2020 6966 2073 3d3d 5b22          if s==["
+00011c90: 225d 3a0a 2020 2020 2020 2020 2020 2020  "]:.            
+00011ca0: 2020 2020 2020 2020 733d 5b5d 0a20 2020          s=[].   
+00011cb0: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+00011cc0: 2069 2069 6e20 7261 6e67 6528 6c65 6e28   i in range(len(
+00011cd0: 7329 293a 0a20 2020 2020 2020 2020 2020  s)):.           
+00011ce0: 2020 2020 2020 2020 2074 7279 3a0a 2020           try:.  
+00011cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011d00: 2020 2020 2020 735b 695d 203d 2066 6c6f        s[i] = flo
+00011d10: 6174 2873 5b69 5d29 0a20 2020 2020 2020  at(s[i]).       
+00011d20: 2020 2020 2020 2020 2020 2020 2065 7863               exc
+00011d30: 6570 743a 0a20 2020 2020 2020 2020 2020  ept:.           
+00011d40: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+00011d50: 7365 2056 616c 7565 4572 726f 722c 226d  se ValueError,"m
+00011d60: 6174 3428 2920 6172 6720 6973 2061 206d  at4() arg is a m
+00011d70: 616c 666f 726d 6564 2073 7472 696e 6722  alformed string"
+00011d80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00011d90: 2042 203d 206d 6174 3428 7329 0a20 2020   B = mat4(s).   
+00011da0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00011db0: 662e 6d31 3120 3d20 422e 6d31 310a 2020  f.m11 = B.m11.  
+00011dc0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00011dd0: 6c66 2e6d 3132 203d 2042 2e6d 3132 0a20  lf.m12 = B.m12. 
+00011de0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00011df0: 656c 662e 6d31 3320 3d20 422e 6d31 330a  elf.m13 = B.m13.
+00011e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011e10: 7365 6c66 2e6d 3134 203d 2042 2e6d 3134  self.m14 = B.m14
+00011e20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00011e30: 2073 656c 662e 6d32 3120 3d20 422e 6d32   self.m21 = B.m2
+00011e40: 310a 2020 2020 2020 2020 2020 2020 2020  1.              
+00011e50: 2020 7365 6c66 2e6d 3232 203d 2042 2e6d    self.m22 = B.m
+00011e60: 3232 0a20 2020 2020 2020 2020 2020 2020  22.             
+00011e70: 2020 2073 656c 662e 6d32 3320 3d20 422e     self.m23 = B.
+00011e80: 6d32 330a 2020 2020 2020 2020 2020 2020  m23.            
+00011e90: 2020 2020 7365 6c66 2e6d 3234 203d 2042      self.m24 = B
+00011ea0: 2e6d 3234 0a20 2020 2020 2020 2020 2020  .m24.           
+00011eb0: 2020 2020 2073 656c 662e 6d33 3120 3d20       self.m31 = 
+00011ec0: 422e 6d33 310a 2020 2020 2020 2020 2020  B.m31.          
+00011ed0: 2020 2020 2020 7365 6c66 2e6d 3332 203d        self.m32 =
+00011ee0: 2042 2e6d 3332 0a20 2020 2020 2020 2020   B.m32.         
+00011ef0: 2020 2020 2020 2073 656c 662e 6d33 3320         self.m33 
+00011f00: 3d20 422e 6d33 330a 2020 2020 2020 2020  = B.m33.        
+00011f10: 2020 2020 2020 2020 7365 6c66 2e6d 3334          self.m34
+00011f20: 203d 2042 2e6d 3334 0a20 2020 2020 2020   = B.m34.       
+00011f30: 2020 2020 2020 2020 2073 656c 662e 6d34           self.m4
+00011f40: 3120 3d20 422e 6d34 310a 2020 2020 2020  1 = B.m41.      
+00011f50: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+00011f60: 3432 203d 2042 2e6d 3432 0a20 2020 2020  42 = B.m42.     
+00011f70: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00011f80: 6d34 3320 3d20 422e 6d34 330a 2020 2020  m43 = B.m43.    
+00011f90: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00011fa0: 2e6d 3434 203d 2042 2e6d 3434 0a20 2020  .m44 = B.m44.   
+00011fb0: 2020 2020 2020 2020 2023 2053 6571 7565           # Seque
+00011fc0: 6e63 6520 6f66 2031 3620 666c 6f61 7473  nce of 16 floats
+00011fd0: 206f 7220 3420 342d 7365 7175 656e 6365   or 4 4-sequence
+00011fe0: 730a 2020 2020 2020 2020 2020 2020 656c  s.            el
+00011ff0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00012000: 2020 2020 7365 7120 3d20 6172 6773 5b30      seq = args[0
+00012010: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+00012020: 2020 7472 793a 0a20 2020 2020 2020 2020    try:.         
+00012030: 2020 2020 2020 2020 2020 2073 6571 6c65             seqle
+00012040: 6e20 3d20 6c65 6e28 7365 7129 0a20 2020  n = len(seq).   
+00012050: 2020 2020 2020 2020 2020 2020 2065 7863               exc
+00012060: 6570 743a 0a20 2020 2020 2020 2020 2020  ept:.           
+00012070: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
+00012080: 7970 6545 7272 6f72 2c22 6d61 7434 2829  ypeError,"mat4()
+00012090: 2061 7267 2063 616e 2774 2062 6520 636f   arg can't be co
+000120a0: 6e76 6572 7465 6420 746f 206d 6174 3422  nverted to mat4"
+000120b0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000120c0: 2020 6966 2073 6571 6c65 6e3d 3d31 363a    if seqlen==16:
+000120d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000120e0: 2020 2020 2073 656c 662e 6d31 3120 3d20       self.m11 = 
+000120f0: 7365 715b 305d 0a20 2020 2020 2020 2020  seq[0].         
+00012100: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00012110: 6d31 3220 3d20 7365 715b 315d 0a20 2020  m12 = seq[1].   
+00012120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012130: 2073 656c 662e 6d31 3320 3d20 7365 715b   self.m13 = seq[
+00012140: 325d 0a20 2020 2020 2020 2020 2020 2020  2].             
+00012150: 2020 2020 2020 2073 656c 662e 6d31 3420         self.m14 
+00012160: 3d20 7365 715b 335d 0a20 2020 2020 2020  = seq[3].       
+00012170: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00012180: 662e 6d32 3120 3d20 7365 715b 345d 0a20  f.m21 = seq[4]. 
+00012190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000121a0: 2020 2073 656c 662e 6d32 3220 3d20 7365     self.m22 = se
+000121b0: 715b 355d 0a20 2020 2020 2020 2020 2020  q[5].           
+000121c0: 2020 2020 2020 2020 2073 656c 662e 6d32           self.m2
+000121d0: 3320 3d20 7365 715b 365d 0a20 2020 2020  3 = seq[6].     
+000121e0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+000121f0: 656c 662e 6d32 3420 3d20 7365 715b 375d  elf.m24 = seq[7]
+00012200: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00012210: 2020 2020 2073 656c 662e 6d33 3120 3d20       self.m31 = 
+00012220: 7365 715b 385d 0a20 2020 2020 2020 2020  seq[8].         
+00012230: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00012240: 6d33 3220 3d20 7365 715b 395d 0a20 2020  m32 = seq[9].   
+00012250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012260: 2073 656c 662e 6d33 3320 3d20 7365 715b   self.m33 = seq[
+00012270: 3130 5d0a 2020 2020 2020 2020 2020 2020  10].            
+00012280: 2020 2020 2020 2020 7365 6c66 2e6d 3334          self.m34
+00012290: 203d 2073 6571 5b31 315d 0a20 2020 2020   = seq[11].     
+000122a0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+000122b0: 656c 662e 6d34 3120 3d20 7365 715b 3132  elf.m41 = seq[12
+000122c0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+000122d0: 2020 2020 2020 7365 6c66 2e6d 3432 203d        self.m42 =
+000122e0: 2073 6571 5b31 335d 0a20 2020 2020 2020   seq[13].       
+000122f0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00012300: 662e 6d34 3320 3d20 7365 715b 3134 5d0a  f.m43 = seq[14].
+00012310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012320: 2020 2020 7365 6c66 2e6d 3434 203d 2073      self.m44 = s
+00012330: 6571 5b31 355d 0a20 2020 2020 2020 2020  eq[15].         
+00012340: 2020 2020 2020 2065 6c69 6620 7365 716c         elif seql
+00012350: 656e 3d3d 343a 0a20 2020 2020 2020 2020  en==4:.         
+00012360: 2020 2020 2020 2020 2020 2062 203d 2073             b = s
+00012370: 6571 5b30 5d0a 2020 2020 2020 2020 2020  eq[0].          
+00012380: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+00012390: 3131 203d 2062 5b30 5d0a 2020 2020 2020  11 = b[0].      
+000123a0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+000123b0: 6c66 2e6d 3231 203d 2062 5b31 5d0a 2020  lf.m21 = b[1].  
+000123c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000123d0: 2020 7365 6c66 2e6d 3331 203d 2062 5b32    self.m31 = b[2
+000123e0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+000123f0: 2020 2020 2020 7365 6c66 2e6d 3431 203d        self.m41 =
+00012400: 2062 5b33 5d0a 2020 2020 2020 2020 2020   b[3].          
+00012410: 2020 2020 2020 2020 2020 6220 3d20 7365            b = se
+00012420: 715b 315d 0a20 2020 2020 2020 2020 2020  q[1].           
+00012430: 2020 2020 2020 2020 2073 656c 662e 6d31           self.m1
+00012440: 3220 3d20 625b 305d 0a20 2020 2020 2020  2 = b[0].       
+00012450: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00012460: 662e 6d32 3220 3d20 625b 315d 0a20 2020  f.m22 = b[1].   
+00012470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012480: 2073 656c 662e 6d33 3220 3d20 625b 325d   self.m32 = b[2]
+00012490: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000124a0: 2020 2020 2073 656c 662e 6d34 3220 3d20       self.m42 = 
+000124b0: 625b 335d 0a20 2020 2020 2020 2020 2020  b[3].           
+000124c0: 2020 2020 2020 2020 2062 203d 2073 6571           b = seq
+000124d0: 5b32 5d0a 2020 2020 2020 2020 2020 2020  [2].            
+000124e0: 2020 2020 2020 2020 7365 6c66 2e6d 3133          self.m13
+000124f0: 203d 2062 5b30 5d0a 2020 2020 2020 2020   = b[0].        
+00012500: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00012510: 2e6d 3233 203d 2062 5b31 5d0a 2020 2020  .m23 = b[1].    
+00012520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012530: 7365 6c66 2e6d 3333 203d 2062 5b32 5d0a  self.m33 = b[2].
+00012540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012550: 2020 2020 7365 6c66 2e6d 3433 203d 2062      self.m43 = b
+00012560: 5b33 5d0a 2020 2020 2020 2020 2020 2020  [3].            
+00012570: 2020 2020 2020 2020 6220 3d20 7365 715b          b = seq[
+00012580: 335d 0a20 2020 2020 2020 2020 2020 2020  3].             
+00012590: 2020 2020 2020 2073 656c 662e 6d31 3420         self.m14 
+000125a0: 3d20 625b 305d 0a20 2020 2020 2020 2020  = b[0].         
+000125b0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000125c0: 6d32 3420 3d20 625b 315d 0a20 2020 2020  m24 = b[1].     
+000125d0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+000125e0: 656c 662e 6d33 3420 3d20 625b 325d 0a20  elf.m34 = b[2]. 
 000125f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012600: 2020 2020 7261 6973 6520 5479 7065 4572      raise TypeEr
-00012610: 726f 722c 2022 6d61 7434 2829 2074 616b  ror, "mat4() tak
-00012620: 6573 2061 7420 6d6f 7374 2031 3620 6172  es at most 16 ar
-00012630: 6775 6d65 6e74 7322 0a0a 2020 2020 2020  guments"..      
-00012640: 2020 2320 3420 6172 6775 6d65 6e74 7320    # 4 arguments 
-00012650: 2863 6f6c 756d 6e73 2061 7320 7365 7175  (columns as sequ
-00012660: 656e 6365 7329 0a20 2020 2020 2020 2065  ences).        e
-00012670: 6c69 6620 6172 676c 656e 3d3d 343a 0a20  lif arglen==4:. 
-00012680: 2020 2020 2020 2020 2020 2061 2c62 2c63             a,b,c
-00012690: 2c64 3d61 7267 730a 2020 2020 2020 2020  ,d=args.        
-000126a0: 2020 2020 7365 6c66 2e6d 3131 203d 2061      self.m11 = a
-000126b0: 5b30 5d0a 2020 2020 2020 2020 2020 2020  [0].            
-000126c0: 7365 6c66 2e6d 3132 203d 2062 5b30 5d0a  self.m12 = b[0].
-000126d0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000126e0: 2e6d 3133 203d 2063 5b30 5d0a 2020 2020  .m13 = c[0].    
-000126f0: 2020 2020 2020 2020 7365 6c66 2e6d 3134          self.m14
-00012700: 203d 2064 5b30 5d0a 2020 2020 2020 2020   = d[0].        
-00012710: 2020 2020 7365 6c66 2e6d 3231 203d 2061      self.m21 = a
-00012720: 5b31 5d0a 2020 2020 2020 2020 2020 2020  [1].            
-00012730: 7365 6c66 2e6d 3232 203d 2062 5b31 5d0a  self.m22 = b[1].
-00012740: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00012750: 2e6d 3233 203d 2063 5b31 5d0a 2020 2020  .m23 = c[1].    
-00012760: 2020 2020 2020 2020 7365 6c66 2e6d 3234          self.m24
-00012770: 203d 2064 5b31 5d0a 2020 2020 2020 2020   = d[1].        
-00012780: 2020 2020 7365 6c66 2e6d 3331 203d 2061      self.m31 = a
-00012790: 5b32 5d0a 2020 2020 2020 2020 2020 2020  [2].            
-000127a0: 7365 6c66 2e6d 3332 203d 2062 5b32 5d0a  self.m32 = b[2].
-000127b0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000127c0: 2e6d 3333 203d 2063 5b32 5d0a 2020 2020  .m33 = c[2].    
-000127d0: 2020 2020 2020 2020 7365 6c66 2e6d 3334          self.m34
-000127e0: 203d 2064 5b32 5d0a 2020 2020 2020 2020   = d[2].        
-000127f0: 2020 2020 7365 6c66 2e6d 3431 203d 2061      self.m41 = a
-00012800: 5b33 5d0a 2020 2020 2020 2020 2020 2020  [3].            
-00012810: 7365 6c66 2e6d 3432 203d 2062 5b33 5d0a  self.m42 = b[3].
-00012820: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00012830: 2e6d 3433 203d 2063 5b33 5d0a 2020 2020  .m43 = c[3].    
-00012840: 2020 2020 2020 2020 7365 6c66 2e6d 3434          self.m44
-00012850: 203d 2064 5b33 5d0a 0a20 2020 2020 2020   = d[3]..       
-00012860: 2023 2031 3620 6172 6775 6d65 6e74 730a   # 16 arguments.
-00012870: 2020 2020 2020 2020 656c 6966 2061 7267          elif arg
-00012880: 6c65 6e3d 3d31 363a 0a20 2020 2020 2020  len==16:.       
-00012890: 2020 2020 2073 656c 662e 6d31 3120 3d20       self.m11 = 
-000128a0: 6172 6773 5b30 5d0a 2020 2020 2020 2020  args[0].        
-000128b0: 2020 2020 7365 6c66 2e6d 3132 203d 2061      self.m12 = a
-000128c0: 7267 735b 315d 0a20 2020 2020 2020 2020  rgs[1].         
-000128d0: 2020 2073 656c 662e 6d31 3320 3d20 6172     self.m13 = ar
-000128e0: 6773 5b32 5d0a 2020 2020 2020 2020 2020  gs[2].          
-000128f0: 2020 7365 6c66 2e6d 3134 203d 2061 7267    self.m14 = arg
-00012900: 735b 335d 0a20 2020 2020 2020 2020 2020  s[3].           
-00012910: 2073 656c 662e 6d32 3120 3d20 6172 6773   self.m21 = args
-00012920: 5b34 5d0a 2020 2020 2020 2020 2020 2020  [4].            
-00012930: 7365 6c66 2e6d 3232 203d 2061 7267 735b  self.m22 = args[
-00012940: 355d 0a20 2020 2020 2020 2020 2020 2073  5].            s
-00012950: 656c 662e 6d32 3320 3d20 6172 6773 5b36  elf.m23 = args[6
-00012960: 5d0a 2020 2020 2020 2020 2020 2020 7365  ].            se
-00012970: 6c66 2e6d 3234 203d 2061 7267 735b 375d  lf.m24 = args[7]
-00012980: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00012990: 662e 6d33 3120 3d20 6172 6773 5b38 5d0a  f.m31 = args[8].
-000129a0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000129b0: 2e6d 3332 203d 2061 7267 735b 395d 0a20  .m32 = args[9]. 
-000129c0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-000129d0: 6d33 3320 3d20 6172 6773 5b31 305d 0a20  m33 = args[10]. 
-000129e0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-000129f0: 6d33 3420 3d20 6172 6773 5b31 315d 0a20  m34 = args[11]. 
-00012a00: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00012a10: 6d34 3120 3d20 6172 6773 5b31 325d 0a20  m41 = args[12]. 
-00012a20: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00012a30: 6d34 3220 3d20 6172 6773 5b31 335d 0a20  m42 = args[13]. 
-00012a40: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00012a50: 6d34 3320 3d20 6172 6773 5b31 345d 0a20  m43 = args[14]. 
-00012a60: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00012a70: 6d34 3420 3d20 6172 6773 5b31 355d 0a0a  m44 = args[15]..
-00012a80: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00012a90: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00012aa0: 5479 7065 4572 726f 722c 226d 6174 3428  TypeError,"mat4(
-00012ab0: 2920 6172 6720 6361 6e27 7420 6265 2063  ) arg can't be c
-00012ac0: 6f6e 7665 7274 6564 2074 6f20 6d61 7434  onverted to mat4
-00012ad0: 220a 0a20 2020 2064 6566 205f 5f72 6564  "..    def __red
-00012ae0: 7563 655f 5f28 7365 6c66 293a 0a20 2020  uce__(self):.   
-00012af0: 2020 2020 2072 6574 7572 6e20 285f 6d61       return (_ma
-00012b00: 7434 636f 6e73 7472 7563 742c 2028 7365  t4construct, (se
-00012b10: 6c66 5b30 5d2c 2073 656c 665b 315d 2c20  lf[0], self[1], 
-00012b20: 7365 6c66 5b32 5d2c 2073 656c 665b 335d  self[2], self[3]
-00012b30: 2929 0a0a 2020 2020 6465 6620 5f5f 7265  ))..    def __re
-00012b40: 7072 5f5f 2873 656c 6629 3a0a 2020 2020  pr__(self):.    
-00012b50: 2020 2020 7265 7475 726e 2027 6d61 7434      return 'mat4
-00012b60: 2825 732c 2025 732c 2025 732c 2025 732c  (%s, %s, %s, %s,
-00012b70: 2025 732c 2025 732c 2025 732c 2025 732c   %s, %s, %s, %s,
-00012b80: 2025 732c 2025 732c 2025 732c 2025 732c   %s, %s, %s, %s,
-00012b90: 2025 732c 2025 732c 2025 732c 2025 7329   %s, %s, %s, %s)
-00012ba0: 2725 280a 2020 2020 2020 2020 2020 2020  '%(.            
-00012bb0: 7265 7072 2873 656c 662e 6d31 3129 2c72  repr(self.m11),r
-00012bc0: 6570 7228 7365 6c66 2e6d 3132 292c 7265  epr(self.m12),re
-00012bd0: 7072 2873 656c 662e 6d31 3329 2c72 6570  pr(self.m13),rep
-00012be0: 7228 7365 6c66 2e6d 3134 292c 0a20 2020  r(self.m14),.   
-00012bf0: 2020 2020 2020 2020 2072 6570 7228 7365           repr(se
-00012c00: 6c66 2e6d 3231 292c 7265 7072 2873 656c  lf.m21),repr(sel
-00012c10: 662e 6d32 3229 2c72 6570 7228 7365 6c66  f.m22),repr(self
-00012c20: 2e6d 3233 292c 7265 7072 2873 656c 662e  .m23),repr(self.
-00012c30: 6d32 3429 2c0a 2020 2020 2020 2020 2020  m24),.          
-00012c40: 2020 7265 7072 2873 656c 662e 6d33 3129    repr(self.m31)
-00012c50: 2c72 6570 7228 7365 6c66 2e6d 3332 292c  ,repr(self.m32),
-00012c60: 7265 7072 2873 656c 662e 6d33 3329 2c72  repr(self.m33),r
-00012c70: 6570 7228 7365 6c66 2e6d 3334 292c 0a20  epr(self.m34),. 
-00012c80: 2020 2020 2020 2020 2020 2072 6570 7228             repr(
-00012c90: 7365 6c66 2e6d 3431 292c 7265 7072 2873  self.m41),repr(s
-00012ca0: 656c 662e 6d34 3229 2c72 6570 7228 7365  elf.m42),repr(se
-00012cb0: 6c66 2e6d 3433 292c 7265 7072 2873 656c  lf.m43),repr(sel
-00012cc0: 662e 6d34 3429 290a 0a20 2020 2064 6566  f.m44))..    def
-00012cd0: 205f 5f73 7472 5f5f 2873 656c 6629 3a0a   __str__(self):.
-00012ce0: 2020 2020 2020 2020 7265 7475 726e 2022          return "
-00012cf0: 5b25 392e 3466 2c20 2539 2e34 662c 2025  [%9.4f, %9.4f, %
-00012d00: 392e 3466 2c20 2539 2e34 665d 5c6e 5b25  9.4f, %9.4f]\n[%
-00012d10: 392e 3466 2c20 2539 2e34 662c 2025 392e  9.4f, %9.4f, %9.
-00012d20: 3466 2c20 2539 2e34 665d 5c6e 5b25 392e  4f, %9.4f]\n[%9.
-00012d30: 3466 2c20 2539 2e34 662c 2025 392e 3466  4f, %9.4f, %9.4f
-00012d40: 2c20 2539 2e34 665d 5c6e 5b25 392e 3466  , %9.4f]\n[%9.4f
-00012d50: 2c20 2539 2e34 662c 2025 392e 3466 2c20  , %9.4f, %9.4f, 
-00012d60: 2539 2e34 665d 2225 280a 2020 2020 2020  %9.4f]"%(.      
-00012d70: 2020 2020 2020 7365 6c66 2e6d 3131 2c20        self.m11, 
-00012d80: 7365 6c66 2e6d 3132 2c20 7365 6c66 2e6d  self.m12, self.m
-00012d90: 3133 2c20 7365 6c66 2e6d 3134 2c0a 2020  13, self.m14,.  
-00012da0: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
-00012db0: 3231 2c20 7365 6c66 2e6d 3232 2c20 7365  21, self.m22, se
-00012dc0: 6c66 2e6d 3233 2c20 7365 6c66 2e6d 3234  lf.m23, self.m24
-00012dd0: 2c0a 2020 2020 2020 2020 2020 2020 7365  ,.            se
-00012de0: 6c66 2e6d 3331 2c20 7365 6c66 2e6d 3332  lf.m31, self.m32
-00012df0: 2c20 7365 6c66 2e6d 3333 2c20 7365 6c66  , self.m33, self
-00012e00: 2e6d 3334 2c0a 2020 2020 2020 2020 2020  .m34,.          
-00012e10: 2020 7365 6c66 2e6d 3431 2c20 7365 6c66    self.m41, self
-00012e20: 2e6d 3432 2c20 7365 6c66 2e6d 3433 2c20  .m42, self.m43, 
-00012e30: 7365 6c66 2e6d 3434 290a 0a20 2020 2064  self.m44)..    d
-00012e40: 6566 205f 5f69 7465 725f 5f28 7365 6c66  ef __iter__(self
-00012e50: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
-00012e60: 6e20 6d61 7434 6974 6572 2873 656c 6629  n mat4iter(self)
-00012e70: 0a0a 2020 2020 6465 6620 5f5f 7269 6368  ..    def __rich
-00012e80: 636d 705f 5f28 612c 622c 6f70 293a 0a20  cmp__(a,b,op):. 
-00012e90: 2020 2020 2020 2063 6465 6620 6d61 7434         cdef mat4
-00012ea0: 206d 612c 206d 620a 2020 2020 2020 2020   ma, mb.        
-00012eb0: 6364 6566 2069 6e74 2063 6f70 0a0a 2020  cdef int cop..  
-00012ec0: 2020 2020 2020 636f 7020 3d20 6f70 0a0a        cop = op..
-00012ed0: 2020 2020 2020 2020 7461 203d 2074 7970          ta = typ
-00012ee0: 6528 6129 0a20 2020 2020 2020 2074 6220  e(a).        tb 
-00012ef0: 3d20 7479 7065 2862 290a 2020 2020 2020  = type(b).      
-00012f00: 2020 6966 2028 7461 213d 6d61 7434 206f    if (ta!=mat4 o
-00012f10: 7220 7462 213d 6d61 7434 293a 0a20 2020  r tb!=mat4):.   
-00012f20: 2020 2020 2020 2020 2069 6620 636f 703d           if cop=
-00012f30: 3d33 3a0a 2020 2020 2020 2020 2020 2020  =3:.            
-00012f40: 2020 2020 7265 7475 726e 2031 0a20 2020      return 1.   
-00012f50: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-00012f60: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00012f70: 6574 7572 6e20 300a 0a20 2020 2020 2020  eturn 0..       
-00012f80: 206d 6120 3d20 610a 2020 2020 2020 2020   ma = a.        
-00012f90: 6d62 203d 2062 0a0a 2020 2020 2020 2020  mb = b..        
-00012fa0: 2320 3c0a 2020 2020 2020 2020 6966 2063  # <.        if c
-00012fb0: 6f70 3d3d 303a 0a20 2020 2020 2020 2020  op==0:.         
-00012fc0: 2020 2072 6574 7572 6e20 300a 2020 2020     return 0.    
-00012fd0: 2020 2020 2320 3c3d 0a20 2020 2020 2020      # <=.       
-00012fe0: 2065 6c69 6620 636f 703d 3d31 3a0a 2020   elif cop==1:.  
-00012ff0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00013000: 2030 0a20 2020 2020 2020 2023 203d 3d0a   0.        # ==.
-00013010: 2020 2020 2020 2020 656c 6966 2063 6f70          elif cop
-00013020: 3d3d 323a 0a20 2020 2020 2020 2020 2020  ==2:.           
-00013030: 2072 6574 7572 6e20 2866 6162 7328 6d61   return (fabs(ma
-00013040: 2e6d 3131 2d6d 622e 6d31 3129 3c3d 6570  .m11-mb.m11)<=ep
-00013050: 7320 616e 6420 6661 6273 286d 612e 6d31  s and fabs(ma.m1
-00013060: 322d 6d62 2e6d 3132 293c 3d65 7073 2061  2-mb.m12)<=eps a
-00013070: 6e64 0a20 2020 2020 2020 2020 2020 2020  nd.             
-00013080: 2020 2020 2020 2066 6162 7328 6d61 2e6d         fabs(ma.m
-00013090: 3133 2d6d 622e 6d31 3329 3c3d 6570 7320  13-mb.m13)<=eps 
-000130a0: 616e 6420 6661 6273 286d 612e 6d31 342d  and fabs(ma.m14-
-000130b0: 6d62 2e6d 3134 293c 3d65 7073 2061 6e64  mb.m14)<=eps and
-000130c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000130d0: 2020 2020 2066 6162 7328 6d61 2e6d 3231       fabs(ma.m21
-000130e0: 2d6d 622e 6d32 3129 3c3d 6570 7320 616e  -mb.m21)<=eps an
-000130f0: 6420 6661 6273 286d 612e 6d32 322d 6d62  d fabs(ma.m22-mb
-00013100: 2e6d 3232 293c 3d65 7073 2061 6e64 0a20  .m22)<=eps and. 
-00013110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013120: 2020 2066 6162 7328 6d61 2e6d 3233 2d6d     fabs(ma.m23-m
-00013130: 622e 6d32 3329 3c3d 6570 7320 616e 6420  b.m23)<=eps and 
-00013140: 6661 6273 286d 612e 6d32 342d 6d62 2e6d  fabs(ma.m24-mb.m
-00013150: 3234 293c 3d65 7073 2061 6e64 0a20 2020  24)<=eps and.   
-00013160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013170: 2066 6162 7328 6d61 2e6d 3331 2d6d 622e   fabs(ma.m31-mb.
-00013180: 6d33 3129 3c3d 6570 7320 616e 6420 6661  m31)<=eps and fa
-00013190: 6273 286d 612e 6d33 322d 6d62 2e6d 3332  bs(ma.m32-mb.m32
-000131a0: 293c 3d65 7073 2061 6e64 0a20 2020 2020  )<=eps and.     
-000131b0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-000131c0: 6162 7328 6d61 2e6d 3333 2d6d 622e 6d33  abs(ma.m33-mb.m3
-000131d0: 3329 3c3d 6570 7320 616e 6420 6661 6273  3)<=eps and fabs
-000131e0: 286d 612e 6d33 342d 6d62 2e6d 3334 293c  (ma.m34-mb.m34)<
-000131f0: 3d65 7073 2061 6e64 0a20 2020 2020 2020  =eps and.       
-00013200: 2020 2020 2020 2020 2020 2020 2066 6162               fab
-00013210: 7328 6d61 2e6d 3431 2d6d 622e 6d34 3129  s(ma.m41-mb.m41)
-00013220: 3c3d 6570 7320 616e 6420 6661 6273 286d  <=eps and fabs(m
-00013230: 612e 6d34 322d 6d62 2e6d 3432 293c 3d65  a.m42-mb.m42)<=e
-00013240: 7073 2061 6e64 0a20 2020 2020 2020 2020  ps and.         
-00013250: 2020 2020 2020 2020 2020 2066 6162 7328             fabs(
-00013260: 6d61 2e6d 3433 2d6d 622e 6d34 3329 3c3d  ma.m43-mb.m43)<=
-00013270: 6570 7320 616e 6420 6661 6273 286d 612e  eps and fabs(ma.
-00013280: 6d34 342d 6d62 2e6d 3434 293c 3d65 7073  m44-mb.m44)<=eps
-00013290: 290a 2020 2020 2020 2020 2320 213d 0a20  ).        # !=. 
-000132a0: 2020 2020 2020 2065 6c69 6620 636f 703d         elif cop=
-000132b0: 3d33 3a0a 2020 2020 2020 2020 2020 2020  =3:.            
-000132c0: 7265 7475 726e 2028 6661 6273 286d 612e  return (fabs(ma.
-000132d0: 6d31 312d 6d62 2e6d 3131 293e 6570 7320  m11-mb.m11)>eps 
-000132e0: 6f72 2066 6162 7328 6d61 2e6d 3132 2d6d  or fabs(ma.m12-m
-000132f0: 622e 6d31 3229 3e65 7073 206f 720a 2020  b.m12)>eps or.  
-00013300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013310: 2020 6661 6273 286d 612e 6d31 332d 6d62    fabs(ma.m13-mb
-00013320: 2e6d 3133 293e 6570 7320 6f72 2066 6162  .m13)>eps or fab
-00013330: 7328 6d61 2e6d 3134 2d6d 622e 6d31 3429  s(ma.m14-mb.m14)
-00013340: 3e65 7073 206f 720a 2020 2020 2020 2020  >eps or.        
-00013350: 2020 2020 2020 2020 2020 2020 6661 6273              fabs
-00013360: 286d 612e 6d32 312d 6d62 2e6d 3231 293e  (ma.m21-mb.m21)>
-00013370: 6570 7320 6f72 2066 6162 7328 6d61 2e6d  eps or fabs(ma.m
-00013380: 3232 2d6d 622e 6d32 3229 3e65 7073 206f  22-mb.m22)>eps o
-00013390: 720a 2020 2020 2020 2020 2020 2020 2020  r.              
-000133a0: 2020 2020 2020 6661 6273 286d 612e 6d32        fabs(ma.m2
-000133b0: 332d 6d62 2e6d 3233 293e 6570 7320 6f72  3-mb.m23)>eps or
-000133c0: 2066 6162 7328 6d61 2e6d 3234 2d6d 622e   fabs(ma.m24-mb.
-000133d0: 6d32 3429 3e65 7073 206f 720a 2020 2020  m24)>eps or.    
-000133e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000133f0: 6661 6273 286d 612e 6d33 312d 6d62 2e6d  fabs(ma.m31-mb.m
-00013400: 3331 293e 6570 7320 6f72 2066 6162 7328  31)>eps or fabs(
-00013410: 6d61 2e6d 3332 2d6d 622e 6d33 3229 3e65  ma.m32-mb.m32)>e
-00013420: 7073 206f 720a 2020 2020 2020 2020 2020  ps or.          
-00013430: 2020 2020 2020 2020 2020 6661 6273 286d            fabs(m
-00013440: 612e 6d33 332d 6d62 2e6d 3333 293e 6570  a.m33-mb.m33)>ep
-00013450: 7320 6f72 2066 6162 7328 6d61 2e6d 3334  s or fabs(ma.m34
-00013460: 2d6d 622e 6d33 3429 3e65 7073 206f 720a  -mb.m34)>eps or.
-00013470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013480: 2020 2020 6661 6273 286d 612e 6d34 312d      fabs(ma.m41-
-00013490: 6d62 2e6d 3431 293e 6570 7320 6f72 2066  mb.m41)>eps or f
-000134a0: 6162 7328 6d61 2e6d 3432 2d6d 622e 6d34  abs(ma.m42-mb.m4
-000134b0: 3229 3e65 7073 206f 720a 2020 2020 2020  2)>eps or.      
-000134c0: 2020 2020 2020 2020 2020 2020 2020 6661                fa
-000134d0: 6273 286d 612e 6d34 332d 6d62 2e6d 3433  bs(ma.m43-mb.m43
-000134e0: 293e 6570 7320 6f72 2066 6162 7328 6d61  )>eps or fabs(ma
-000134f0: 2e6d 3434 2d6d 622e 6d34 3429 3e65 7073  .m44-mb.m44)>eps
-00013500: 290a 2020 2020 2020 2020 2320 3e0a 2020  ).        # >.  
-00013510: 2020 2020 2020 656c 6966 2063 6f70 3d3d        elif cop==
-00013520: 343a 0a20 2020 2020 2020 2020 2020 2072  4:.            r
-00013530: 6574 7572 6e20 300a 2020 2020 2020 2020  eturn 0.        
-00013540: 2320 3e3d 0a20 2020 2020 2020 2065 6c69  # >=.        eli
-00013550: 6620 636f 703d 3d35 3a0a 2020 2020 2020  f cop==5:.      
-00013560: 2020 2020 2020 7265 7475 726e 2030 0a20        return 0. 
-00013570: 2020 2020 2020 2023 2073 6f6e 7374 2028         # sonst (
-00013580: 4665 686c 6572 290a 2020 2020 2020 2020  Fehler).        
-00013590: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-000135a0: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-000135b0: 6f72 2c22 696e 7465 726e 616c 2065 7272  or,"internal err
-000135c0: 6f72 3a20 696c 6c65 6761 6c20 7269 6368  or: illegal rich
-000135d0: 2063 6f6d 7061 7269 736f 6e20 6e75 6d62   comparison numb
-000135e0: 6572 220a 0a0a 2020 2020 6465 6620 5f5f  er"...    def __
-000135f0: 6164 645f 5f28 6d61 7434 2061 2c20 6d61  add__(mat4 a, ma
-00013600: 7434 2062 293a 0a20 2020 2020 2020 2022  t4 b):.        "
-00013610: 2222 4d61 7472 6978 2061 6464 6974 696f  ""Matrix additio
-00013620: 6e2e 0a0a 2020 2020 2020 2020 3e3e 3e20  n...        >>> 
-00013630: 4d3d 6d61 7434 2831 2c32 2c33 2c34 2c35  M=mat4(1,2,3,4,5
-00013640: 2c36 2c37 2c38 2c39 2c31 302c 3131 2c31  ,6,7,8,9,10,11,1
-00013650: 322c 3133 2c31 342c 3135 2c31 3629 0a20  2,13,14,15,16). 
-00013660: 2020 2020 2020 203e 3e3e 2070 7269 6e74         >>> print
-00013670: 204d 2b4d 0a20 2020 2020 2020 205b 2020   M+M.        [  
-00013680: 2032 2e30 3030 302c 2020 2020 342e 3030   2.0000,    4.00
-00013690: 3030 2c20 2020 2036 2e30 3030 302c 2020  00,    6.0000,  
-000136a0: 2020 382e 3030 3030 5d0a 2020 2020 2020    8.0000].      
-000136b0: 2020 5b20 2031 302e 3030 3030 2c20 2020    [  10.0000,   
-000136c0: 3132 2e30 3030 302c 2020 2031 342e 3030  12.0000,   14.00
-000136d0: 3030 2c20 2020 3136 2e30 3030 305d 0a20  00,   16.0000]. 
-000136e0: 2020 2020 2020 205b 2020 3138 2e30 3030         [  18.000
-000136f0: 302c 2020 2032 302e 3030 3030 2c20 2020  0,   20.0000,   
-00013700: 3232 2e30 3030 302c 2020 2032 342e 3030  22.0000,   24.00
-00013710: 3030 5d0a 2020 2020 2020 2020 5b20 2032  00].        [  2
-00013720: 362e 3030 3030 2c20 2020 3238 2e30 3030  6.0000,   28.000
-00013730: 302c 2020 2033 302e 3030 3030 2c20 2020  0,   30.0000,   
-00013740: 3332 2e30 3030 305d 0a20 2020 2020 2020  32.0000].       
-00013750: 2022 2222 0a20 2020 2020 2020 2063 6465   """.        cde
-00013760: 6620 6d61 7434 2072 6573 0a20 2020 2020  f mat4 res.     
-00013770: 2020 2072 6573 203d 206d 6174 3428 290a     res = mat4().
-00013780: 2020 2020 2020 2020 7265 732e 6d31 3120          res.m11 
-00013790: 3d20 612e 6d31 3120 2b20 622e 6d31 310a  = a.m11 + b.m11.
-000137a0: 2020 2020 2020 2020 7265 732e 6d31 3220          res.m12 
-000137b0: 3d20 612e 6d31 3220 2b20 622e 6d31 320a  = a.m12 + b.m12.
-000137c0: 2020 2020 2020 2020 7265 732e 6d31 3320          res.m13 
-000137d0: 3d20 612e 6d31 3320 2b20 622e 6d31 330a  = a.m13 + b.m13.
-000137e0: 2020 2020 2020 2020 7265 732e 6d31 3420          res.m14 
-000137f0: 3d20 612e 6d31 3420 2b20 622e 6d31 340a  = a.m14 + b.m14.
-00013800: 2020 2020 2020 2020 7265 732e 6d32 3120          res.m21 
-00013810: 3d20 612e 6d32 3120 2b20 622e 6d32 310a  = a.m21 + b.m21.
-00013820: 2020 2020 2020 2020 7265 732e 6d32 3220          res.m22 
-00013830: 3d20 612e 6d32 3220 2b20 622e 6d32 320a  = a.m22 + b.m22.
-00013840: 2020 2020 2020 2020 7265 732e 6d32 3320          res.m23 
-00013850: 3d20 612e 6d32 3320 2b20 622e 6d32 330a  = a.m23 + b.m23.
-00013860: 2020 2020 2020 2020 7265 732e 6d32 3420          res.m24 
-00013870: 3d20 612e 6d32 3420 2b20 622e 6d32 340a  = a.m24 + b.m24.
-00013880: 2020 2020 2020 2020 7265 732e 6d33 3120          res.m31 
-00013890: 3d20 612e 6d33 3120 2b20 622e 6d33 310a  = a.m31 + b.m31.
-000138a0: 2020 2020 2020 2020 7265 732e 6d33 3220          res.m32 
-000138b0: 3d20 612e 6d33 3220 2b20 622e 6d33 320a  = a.m32 + b.m32.
-000138c0: 2020 2020 2020 2020 7265 732e 6d33 3320          res.m33 
-000138d0: 3d20 612e 6d33 3320 2b20 622e 6d33 330a  = a.m33 + b.m33.
-000138e0: 2020 2020 2020 2020 7265 732e 6d33 3420          res.m34 
-000138f0: 3d20 612e 6d33 3420 2b20 622e 6d33 340a  = a.m34 + b.m34.
-00013900: 2020 2020 2020 2020 7265 732e 6d34 3120          res.m41 
-00013910: 3d20 612e 6d34 3120 2b20 622e 6d34 310a  = a.m41 + b.m41.
-00013920: 2020 2020 2020 2020 7265 732e 6d34 3220          res.m42 
-00013930: 3d20 612e 6d34 3220 2b20 622e 6d34 320a  = a.m42 + b.m42.
-00013940: 2020 2020 2020 2020 7265 732e 6d34 3320          res.m43 
-00013950: 3d20 612e 6d34 3320 2b20 622e 6d34 330a  = a.m43 + b.m43.
-00013960: 2020 2020 2020 2020 7265 732e 6d34 3420          res.m44 
-00013970: 3d20 612e 6d34 3420 2b20 622e 6d34 340a  = a.m44 + b.m44.
-00013980: 2020 2020 2020 2020 7265 7475 726e 2072          return r
-00013990: 6573 0a0a 2020 2020 6465 6620 5f5f 7375  es..    def __su
-000139a0: 625f 5f28 6d61 7434 2061 2c20 6d61 7434  b__(mat4 a, mat4
-000139b0: 2062 293a 0a20 2020 2020 2020 2022 2222   b):.        """
-000139c0: 4d61 7472 6978 2073 7562 7472 6163 7469  Matrix subtracti
-000139d0: 6f6e 2e0a 0a20 2020 2020 2020 203e 3e3e  on...        >>>
-000139e0: 204d 3d6d 6174 3428 312c 322c 332c 342c   M=mat4(1,2,3,4,
-000139f0: 352c 362c 372c 382c 392c 3130 2c31 312c  5,6,7,8,9,10,11,
-00013a00: 3132 2c31 332c 3134 2c31 352c 3136 290a  12,13,14,15,16).
-00013a10: 2020 2020 2020 2020 3e3e 3e20 7072 696e          >>> prin
-00013a20: 7420 4d2d 4d0a 2020 2020 2020 2020 5b20  t M-M.        [ 
-00013a30: 2020 302e 3030 3030 2c20 2020 2030 2e30    0.0000,    0.0
-00013a40: 3030 302c 2020 2020 302e 3030 3030 2c20  000,    0.0000, 
-00013a50: 2020 2030 2e30 3030 305d 0a20 2020 2020     0.0000].     
-00013a60: 2020 205b 2020 2030 2e30 3030 302c 2020     [   0.0000,  
-00013a70: 2020 302e 3030 3030 2c20 2020 2030 2e30    0.0000,    0.0
-00013a80: 3030 302c 2020 2020 302e 3030 3030 5d0a  000,    0.0000].
-00013a90: 2020 2020 2020 2020 5b20 2020 302e 3030          [   0.00
-00013aa0: 3030 2c20 2020 2030 2e30 3030 302c 2020  00,    0.0000,  
-00013ab0: 2020 302e 3030 3030 2c20 2020 2030 2e30    0.0000,    0.0
-00013ac0: 3030 305d 0a20 2020 2020 2020 205b 2020  000].        [  
-00013ad0: 2030 2e30 3030 302c 2020 2020 302e 3030   0.0000,    0.00
-00013ae0: 3030 2c20 2020 2030 2e30 3030 302c 2020  00,    0.0000,  
-00013af0: 2020 302e 3030 3030 5d0a 2020 2020 2020    0.0000].      
-00013b00: 2020 2222 220a 2020 2020 2020 2020 6364    """.        cd
-00013b10: 6566 206d 6174 3420 7265 730a 2020 2020  ef mat4 res.    
-00013b20: 2020 2020 7265 7320 3d20 6d61 7434 2829      res = mat4()
-00013b30: 0a20 2020 2020 2020 2072 6573 2e6d 3131  .        res.m11
-00013b40: 203d 2061 2e6d 3131 202d 2062 2e6d 3131   = a.m11 - b.m11
-00013b50: 0a20 2020 2020 2020 2072 6573 2e6d 3132  .        res.m12
-00013b60: 203d 2061 2e6d 3132 202d 2062 2e6d 3132   = a.m12 - b.m12
-00013b70: 0a20 2020 2020 2020 2072 6573 2e6d 3133  .        res.m13
-00013b80: 203d 2061 2e6d 3133 202d 2062 2e6d 3133   = a.m13 - b.m13
-00013b90: 0a20 2020 2020 2020 2072 6573 2e6d 3134  .        res.m14
-00013ba0: 203d 2061 2e6d 3134 202d 2062 2e6d 3134   = a.m14 - b.m14
-00013bb0: 0a20 2020 2020 2020 2072 6573 2e6d 3231  .        res.m21
-00013bc0: 203d 2061 2e6d 3231 202d 2062 2e6d 3231   = a.m21 - b.m21
-00013bd0: 0a20 2020 2020 2020 2072 6573 2e6d 3232  .        res.m22
-00013be0: 203d 2061 2e6d 3232 202d 2062 2e6d 3232   = a.m22 - b.m22
-00013bf0: 0a20 2020 2020 2020 2072 6573 2e6d 3233  .        res.m23
-00013c00: 203d 2061 2e6d 3233 202d 2062 2e6d 3233   = a.m23 - b.m23
-00013c10: 0a20 2020 2020 2020 2072 6573 2e6d 3234  .        res.m24
-00013c20: 203d 2061 2e6d 3234 202d 2062 2e6d 3234   = a.m24 - b.m24
-00013c30: 0a20 2020 2020 2020 2072 6573 2e6d 3331  .        res.m31
-00013c40: 203d 2061 2e6d 3331 202d 2062 2e6d 3331   = a.m31 - b.m31
-00013c50: 0a20 2020 2020 2020 2072 6573 2e6d 3332  .        res.m32
-00013c60: 203d 2061 2e6d 3332 202d 2062 2e6d 3332   = a.m32 - b.m32
-00013c70: 0a20 2020 2020 2020 2072 6573 2e6d 3333  .        res.m33
-00013c80: 203d 2061 2e6d 3333 202d 2062 2e6d 3333   = a.m33 - b.m33
-00013c90: 0a20 2020 2020 2020 2072 6573 2e6d 3334  .        res.m34
-00013ca0: 203d 2061 2e6d 3334 202d 2062 2e6d 3334   = a.m34 - b.m34
-00013cb0: 0a20 2020 2020 2020 2072 6573 2e6d 3431  .        res.m41
-00013cc0: 203d 2061 2e6d 3431 202d 2062 2e6d 3431   = a.m41 - b.m41
-00013cd0: 0a20 2020 2020 2020 2072 6573 2e6d 3432  .        res.m42
-00013ce0: 203d 2061 2e6d 3432 202d 2062 2e6d 3432   = a.m42 - b.m42
-00013cf0: 0a20 2020 2020 2020 2072 6573 2e6d 3433  .        res.m43
-00013d00: 203d 2061 2e6d 3433 202d 2062 2e6d 3433   = a.m43 - b.m43
-00013d10: 0a20 2020 2020 2020 2072 6573 2e6d 3434  .        res.m44
-00013d20: 203d 2061 2e6d 3434 202d 2062 2e6d 3434   = a.m44 - b.m44
-00013d30: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00013d40: 7265 730a 0a20 2020 2064 6566 205f 5f6d  res..    def __m
-00013d50: 756c 5f5f 2861 2c20 6229 3a0a 2020 2020  ul__(a, b):.    
-00013d60: 2020 2020 2222 224d 756c 7469 706c 6963      """Multiplic
-00013d70: 6174 696f 6e2e 0a0a 2020 2020 2020 2020  ation...        
-00013d80: 3e3e 3e20 4d3d 6d61 7434 2831 2c32 2c33  >>> M=mat4(1,2,3
-00013d90: 2c34 2c35 2c36 2c37 2c38 2c39 2c31 302c  ,4,5,6,7,8,9,10,
-00013da0: 3131 2c31 322c 3133 2c31 342c 3135 2c31  11,12,13,14,15,1
-00013db0: 3629 0a20 2020 2020 2020 203e 3e3e 2070  6).        >>> p
-00013dc0: 7269 6e74 204d 2a32 2e30 0a20 2020 2020  rint M*2.0.     
-00013dd0: 2020 205b 2020 2032 2e30 3030 302c 2020     [   2.0000,  
-00013de0: 2020 342e 3030 3030 2c20 2020 2036 2e30    4.0000,    6.0
-00013df0: 3030 302c 2020 2020 382e 3030 3030 5d0a  000,    8.0000].
-00013e00: 2020 2020 2020 2020 5b20 2031 302e 3030          [  10.00
-00013e10: 3030 2c20 2020 3132 2e30 3030 302c 2020  00,   12.0000,  
-00013e20: 2031 342e 3030 3030 2c20 2020 3136 2e30   14.0000,   16.0
-00013e30: 3030 305d 0a20 2020 2020 2020 205b 2020  000].        [  
-00013e40: 3138 2e30 3030 302c 2020 2032 302e 3030  18.0000,   20.00
-00013e50: 3030 2c20 2020 3232 2e30 3030 302c 2020  00,   22.0000,  
-00013e60: 2032 342e 3030 3030 5d0a 2020 2020 2020   24.0000].      
-00013e70: 2020 5b20 2032 362e 3030 3030 2c20 2020    [  26.0000,   
-00013e80: 3238 2e30 3030 302c 2020 2033 302e 3030  28.0000,   30.00
-00013e90: 3030 2c20 2020 3332 2e30 3030 305d 0a20  00,   32.0000]. 
-00013ea0: 2020 2020 2020 203e 3e3e 2070 7269 6e74         >>> print
-00013eb0: 2032 2e30 2a4d 0a20 2020 2020 2020 205b   2.0*M.        [
-00013ec0: 2020 2032 2e30 3030 302c 2020 2020 342e     2.0000,    4.
-00013ed0: 3030 3030 2c20 2020 2036 2e30 3030 302c  0000,    6.0000,
-00013ee0: 2020 2020 382e 3030 3030 5d0a 2020 2020      8.0000].    
-00013ef0: 2020 2020 5b20 2031 302e 3030 3030 2c20      [  10.0000, 
-00013f00: 2020 3132 2e30 3030 302c 2020 2031 342e    12.0000,   14.
-00013f10: 3030 3030 2c20 2020 3136 2e30 3030 305d  0000,   16.0000]
-00013f20: 0a20 2020 2020 2020 205b 2020 3138 2e30  .        [  18.0
-00013f30: 3030 302c 2020 2032 302e 3030 3030 2c20  000,   20.0000, 
-00013f40: 2020 3232 2e30 3030 302c 2020 2032 342e    22.0000,   24.
-00013f50: 3030 3030 5d0a 2020 2020 2020 2020 5b20  0000].        [ 
-00013f60: 2032 362e 3030 3030 2c20 2020 3238 2e30   26.0000,   28.0
-00013f70: 3030 302c 2020 2033 302e 3030 3030 2c20  000,   30.0000, 
-00013f80: 2020 3332 2e30 3030 305d 0a20 2020 2020    32.0000].     
-00013f90: 2020 203e 3e3e 2070 7269 6e74 204d 2a4d     >>> print M*M
-00013fa0: 0a20 2020 2020 2020 205b 2020 3930 2e30  .        [  90.0
-00013fb0: 3030 302c 2020 3130 302e 3030 3030 2c20  000,  100.0000, 
-00013fc0: 2031 3130 2e30 3030 302c 2020 3132 302e   110.0000,  120.
-00013fd0: 3030 3030 5d0a 2020 2020 2020 2020 5b20  0000].        [ 
-00013fe0: 3230 322e 3030 3030 2c20 2032 3238 2e30  202.0000,  228.0
-00013ff0: 3030 302c 2020 3235 342e 3030 3030 2c20  000,  254.0000, 
-00014000: 2032 3830 2e30 3030 305d 0a20 2020 2020   280.0000].     
-00014010: 2020 205b 2033 3134 2e30 3030 302c 2020     [ 314.0000,  
-00014020: 3335 362e 3030 3030 2c20 2033 3938 2e30  356.0000,  398.0
-00014030: 3030 302c 2020 3434 302e 3030 3030 5d0a  000,  440.0000].
-00014040: 2020 2020 2020 2020 5b20 3432 362e 3030          [ 426.00
-00014050: 3030 2c20 2034 3834 2e30 3030 302c 2020  00,  484.0000,  
-00014060: 3534 322e 3030 3030 2c20 2036 3030 2e30  542.0000,  600.0
-00014070: 3030 305d 0a20 2020 2020 2020 203e 3e3e  000].        >>>
-00014080: 2070 7269 6e74 204d 2a5f 7665 6333 2831   print M*_vec3(1
-00014090: 2c32 2c33 290a 2020 2020 2020 2020 2830  ,2,3).        (0
-000140a0: 2e31 3736 352c 2030 2e34 3531 302c 2030  .1765, 0.4510, 0
-000140b0: 2e37 3235 3529 0a20 2020 2020 2020 203e  .7255).        >
-000140c0: 3e3e 2070 7269 6e74 205f 7665 6333 2831  >> print _vec3(1
-000140d0: 2c32 2c33 292a 4d0a 2020 2020 2020 2020  ,2,3)*M.        
-000140e0: 2830 2e37 3038 332c 2030 2e38 3035 362c  (0.7083, 0.8056,
-000140f0: 2030 2e39 3032 3829 0a20 2020 2020 2020   0.9028).       
-00014100: 2022 2222 0a20 2020 2020 2020 2063 6465   """.        cde
-00014110: 6620 6d61 7434 206d 612c 206d 622c 2072  f mat4 ma, mb, r
-00014120: 6573 0a20 2020 2020 2020 2063 6465 6620  es.        cdef 
-00014130: 7665 6333 2076 612c 2076 622c 2076 7265  vec3 va, vb, vre
-00014140: 730a 2020 2020 2020 2020 6364 6566 2076  s.        cdef v
-00014150: 6563 3420 7761 2c20 7762 2c20 7772 6573  ec4 wa, wb, wres
-00014160: 0a20 2020 2020 2020 2063 6465 6620 646f  .        cdef do
-00014170: 7562 6c65 2072 2c20 770a 0a20 2020 2020  uble r, w..     
-00014180: 2020 2074 6120 3d20 7479 7065 2861 290a     ta = type(a).
-00014190: 2020 2020 2020 2020 7462 203d 2074 7970          tb = typ
-000141a0: 6528 6229 0a0a 2020 2020 2020 2020 2320  e(b)..        # 
-000141b0: 6d61 7434 206f 6e20 7468 6520 6c65 6674  mat4 on the left
-000141c0: 3f0a 2020 2020 2020 2020 6966 2074 6120  ?.        if ta 
-000141d0: 6973 206d 6174 343a 0a20 2020 2020 2020  is mat4:.       
-000141e0: 2020 2020 206d 6120 3d20 610a 2020 2020       ma = a.    
-000141f0: 2020 2020 2020 2020 2320 6d61 7434 206f          # mat4 o
-00014200: 6e20 7468 6520 7269 6768 743f 0a20 2020  n the right?.   
-00014210: 2020 2020 2020 2020 2069 6620 7462 2069           if tb i
-00014220: 7320 6d61 7434 3a0a 2020 2020 2020 2020  s mat4:.        
-00014230: 2020 2020 2020 2020 2320 6d61 7434 2a6d          # mat4*m
-00014240: 6174 340a 2020 2020 2020 2020 2020 2020  at4.            
-00014250: 2020 2020 7265 7320 3d20 6d61 7434 2829      res = mat4()
-00014260: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00014270: 206d 6220 3d20 620a 2020 2020 2020 2020   mb = b.        
-00014280: 2020 2020 2020 2020 7265 732e 6d31 3120          res.m11 
-00014290: 3d20 6d61 2e6d 3131 2a6d 622e 6d31 312b  = ma.m11*mb.m11+
-000142a0: 6d61 2e6d 3132 2a6d 622e 6d32 312b 6d61  ma.m12*mb.m21+ma
-000142b0: 2e6d 3133 2a6d 622e 6d33 312b 6d61 2e6d  .m13*mb.m31+ma.m
-000142c0: 3134 2a6d 622e 6d34 310a 2020 2020 2020  14*mb.m41.      
-000142d0: 2020 2020 2020 2020 2020 7265 732e 6d31            res.m1
-000142e0: 3220 3d20 6d61 2e6d 3131 2a6d 622e 6d31  2 = ma.m11*mb.m1
-000142f0: 322b 6d61 2e6d 3132 2a6d 622e 6d32 322b  2+ma.m12*mb.m22+
-00014300: 6d61 2e6d 3133 2a6d 622e 6d33 322b 6d61  ma.m13*mb.m32+ma
-00014310: 2e6d 3134 2a6d 622e 6d34 320a 2020 2020  .m14*mb.m42.    
-00014320: 2020 2020 2020 2020 2020 2020 7265 732e              res.
-00014330: 6d31 3320 3d20 6d61 2e6d 3131 2a6d 622e  m13 = ma.m11*mb.
-00014340: 6d31 332b 6d61 2e6d 3132 2a6d 622e 6d32  m13+ma.m12*mb.m2
-00014350: 332b 6d61 2e6d 3133 2a6d 622e 6d33 332b  3+ma.m13*mb.m33+
-00014360: 6d61 2e6d 3134 2a6d 622e 6d34 330a 2020  ma.m14*mb.m43.  
-00014370: 2020 2020 2020 2020 2020 2020 2020 7265                re
-00014380: 732e 6d31 3420 3d20 6d61 2e6d 3131 2a6d  s.m14 = ma.m11*m
-00014390: 622e 6d31 342b 6d61 2e6d 3132 2a6d 622e  b.m14+ma.m12*mb.
-000143a0: 6d32 342b 6d61 2e6d 3133 2a6d 622e 6d33  m24+ma.m13*mb.m3
-000143b0: 342b 6d61 2e6d 3134 2a6d 622e 6d34 340a  4+ma.m14*mb.m44.
-000143c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000143d0: 7265 732e 6d32 3120 3d20 6d61 2e6d 3231  res.m21 = ma.m21
-000143e0: 2a6d 622e 6d31 312b 6d61 2e6d 3232 2a6d  *mb.m11+ma.m22*m
-000143f0: 622e 6d32 312b 6d61 2e6d 3233 2a6d 622e  b.m21+ma.m23*mb.
-00014400: 6d33 312b 6d61 2e6d 3234 2a6d 622e 6d34  m31+ma.m24*mb.m4
-00014410: 310a 2020 2020 2020 2020 2020 2020 2020  1.              
-00014420: 2020 7265 732e 6d32 3220 3d20 6d61 2e6d    res.m22 = ma.m
-00014430: 3231 2a6d 622e 6d31 322b 6d61 2e6d 3232  21*mb.m12+ma.m22
-00014440: 2a6d 622e 6d32 322b 6d61 2e6d 3233 2a6d  *mb.m22+ma.m23*m
-00014450: 622e 6d33 322b 6d61 2e6d 3234 2a6d 622e  b.m32+ma.m24*mb.
-00014460: 6d34 320a 2020 2020 2020 2020 2020 2020  m42.            
-00014470: 2020 2020 7265 732e 6d32 3320 3d20 6d61      res.m23 = ma
-00014480: 2e6d 3231 2a6d 622e 6d31 332b 6d61 2e6d  .m21*mb.m13+ma.m
-00014490: 3232 2a6d 622e 6d32 332b 6d61 2e6d 3233  22*mb.m23+ma.m23
-000144a0: 2a6d 622e 6d33 332b 6d61 2e6d 3234 2a6d  *mb.m33+ma.m24*m
-000144b0: 622e 6d34 330a 2020 2020 2020 2020 2020  b.m43.          
-000144c0: 2020 2020 2020 7265 732e 6d32 3420 3d20        res.m24 = 
-000144d0: 6d61 2e6d 3231 2a6d 622e 6d31 342b 6d61  ma.m21*mb.m14+ma
-000144e0: 2e6d 3232 2a6d 622e 6d32 342b 6d61 2e6d  .m22*mb.m24+ma.m
-000144f0: 3233 2a6d 622e 6d33 342b 6d61 2e6d 3234  23*mb.m34+ma.m24
-00014500: 2a6d 622e 6d34 340a 2020 2020 2020 2020  *mb.m44.        
-00014510: 2020 2020 2020 2020 7265 732e 6d33 3120          res.m31 
-00014520: 3d20 6d61 2e6d 3331 2a6d 622e 6d31 312b  = ma.m31*mb.m11+
-00014530: 6d61 2e6d 3332 2a6d 622e 6d32 312b 6d61  ma.m32*mb.m21+ma
-00014540: 2e6d 3333 2a6d 622e 6d33 312b 6d61 2e6d  .m33*mb.m31+ma.m
-00014550: 3334 2a6d 622e 6d34 310a 2020 2020 2020  34*mb.m41.      
-00014560: 2020 2020 2020 2020 2020 7265 732e 6d33            res.m3
-00014570: 3220 3d20 6d61 2e6d 3331 2a6d 622e 6d31  2 = ma.m31*mb.m1
-00014580: 322b 6d61 2e6d 3332 2a6d 622e 6d32 322b  2+ma.m32*mb.m22+
-00014590: 6d61 2e6d 3333 2a6d 622e 6d33 322b 6d61  ma.m33*mb.m32+ma
-000145a0: 2e6d 3334 2a6d 622e 6d34 320a 2020 2020  .m34*mb.m42.    
-000145b0: 2020 2020 2020 2020 2020 2020 7265 732e              res.
-000145c0: 6d33 3320 3d20 6d61 2e6d 3331 2a6d 622e  m33 = ma.m31*mb.
-000145d0: 6d31 332b 6d61 2e6d 3332 2a6d 622e 6d32  m13+ma.m32*mb.m2
-000145e0: 332b 6d61 2e6d 3333 2a6d 622e 6d33 332b  3+ma.m33*mb.m33+
-000145f0: 6d61 2e6d 3334 2a6d 622e 6d34 330a 2020  ma.m34*mb.m43.  
-00014600: 2020 2020 2020 2020 2020 2020 2020 7265                re
-00014610: 732e 6d33 3420 3d20 6d61 2e6d 3331 2a6d  s.m34 = ma.m31*m
-00014620: 622e 6d31 342b 6d61 2e6d 3332 2a6d 622e  b.m14+ma.m32*mb.
-00014630: 6d32 342b 6d61 2e6d 3333 2a6d 622e 6d33  m24+ma.m33*mb.m3
-00014640: 342b 6d61 2e6d 3334 2a6d 622e 6d34 340a  4+ma.m34*mb.m44.
-00014650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014660: 7265 732e 6d34 3120 3d20 6d61 2e6d 3431  res.m41 = ma.m41
-00014670: 2a6d 622e 6d31 312b 6d61 2e6d 3432 2a6d  *mb.m11+ma.m42*m
-00014680: 622e 6d32 312b 6d61 2e6d 3433 2a6d 622e  b.m21+ma.m43*mb.
-00014690: 6d33 312b 6d61 2e6d 3434 2a6d 622e 6d34  m31+ma.m44*mb.m4
-000146a0: 310a 2020 2020 2020 2020 2020 2020 2020  1.              
-000146b0: 2020 7265 732e 6d34 3220 3d20 6d61 2e6d    res.m42 = ma.m
-000146c0: 3431 2a6d 622e 6d31 322b 6d61 2e6d 3432  41*mb.m12+ma.m42
-000146d0: 2a6d 622e 6d32 322b 6d61 2e6d 3433 2a6d  *mb.m22+ma.m43*m
-000146e0: 622e 6d33 322b 6d61 2e6d 3434 2a6d 622e  b.m32+ma.m44*mb.
-000146f0: 6d34 320a 2020 2020 2020 2020 2020 2020  m42.            
-00014700: 2020 2020 7265 732e 6d34 3320 3d20 6d61      res.m43 = ma
-00014710: 2e6d 3431 2a6d 622e 6d31 332b 6d61 2e6d  .m41*mb.m13+ma.m
-00014720: 3432 2a6d 622e 6d32 332b 6d61 2e6d 3433  42*mb.m23+ma.m43
-00014730: 2a6d 622e 6d33 332b 6d61 2e6d 3434 2a6d  *mb.m33+ma.m44*m
-00014740: 622e 6d34 330a 2020 2020 2020 2020 2020  b.m43.          
-00014750: 2020 2020 2020 7265 732e 6d34 3420 3d20        res.m44 = 
-00014760: 6d61 2e6d 3431 2a6d 622e 6d31 342b 6d61  ma.m41*mb.m14+ma
-00014770: 2e6d 3432 2a6d 622e 6d32 342b 6d61 2e6d  .m42*mb.m24+ma.m
-00014780: 3433 2a6d 622e 6d33 342b 6d61 2e6d 3434  43*mb.m34+ma.m44
-00014790: 2a6d 622e 6d34 340a 2020 2020 2020 2020  *mb.m44.        
-000147a0: 2020 2020 2020 2020 7265 7475 726e 2072          return r
-000147b0: 6573 0a20 2020 2020 2020 2020 2020 2023  es.            #
-000147c0: 2076 6563 3420 6f6e 2074 6865 2072 6967   vec4 on the rig
-000147d0: 6874 3f0a 2020 2020 2020 2020 2020 2020  ht?.            
-000147e0: 656c 6966 2074 6220 6973 2076 6563 343a  elif tb is vec4:
-000147f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00014800: 2023 206d 6174 342a 7665 6334 0a20 2020   # mat4*vec4.   
-00014810: 2020 2020 2020 2020 2020 2020 2077 7265               wre
-00014820: 7320 3d20 7665 6334 2829 0a20 2020 2020  s = vec4().     
-00014830: 2020 2020 2020 2020 2020 2077 6220 2020             wb   
-00014840: 3d20 620a 2020 2020 2020 2020 2020 2020  = b.            
-00014850: 2020 2020 7772 6573 2e78 203d 206d 612e      wres.x = ma.
-00014860: 6d31 312a 7762 2e78 202b 206d 612e 6d31  m11*wb.x + ma.m1
-00014870: 322a 7762 2e79 202b 206d 612e 6d31 332a  2*wb.y + ma.m13*
-00014880: 7762 2e7a 202b 206d 612e 6d31 342a 7762  wb.z + ma.m14*wb
-00014890: 2e77 0a20 2020 2020 2020 2020 2020 2020  .w.             
-000148a0: 2020 2077 7265 732e 7920 3d20 6d61 2e6d     wres.y = ma.m
-000148b0: 3231 2a77 622e 7820 2b20 6d61 2e6d 3232  21*wb.x + ma.m22
-000148c0: 2a77 622e 7920 2b20 6d61 2e6d 3233 2a77  *wb.y + ma.m23*w
-000148d0: 622e 7a20 2b20 6d61 2e6d 3234 2a77 622e  b.z + ma.m24*wb.
-000148e0: 770a 2020 2020 2020 2020 2020 2020 2020  w.              
-000148f0: 2020 7772 6573 2e7a 203d 206d 612e 6d33    wres.z = ma.m3
-00014900: 312a 7762 2e78 202b 206d 612e 6d33 322a  1*wb.x + ma.m32*
-00014910: 7762 2e79 202b 206d 612e 6d33 332a 7762  wb.y + ma.m33*wb
-00014920: 2e7a 202b 206d 612e 6d33 342a 7762 2e77  .z + ma.m34*wb.w
-00014930: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00014940: 2077 7265 732e 7720 3d20 6d61 2e6d 3431   wres.w = ma.m41
-00014950: 2a77 622e 7820 2b20 6d61 2e6d 3432 2a77  *wb.x + ma.m42*w
-00014960: 622e 7920 2b20 6d61 2e6d 3433 2a77 622e  b.y + ma.m43*wb.
-00014970: 7a20 2b20 6d61 2e6d 3434 2a77 622e 770a  z + ma.m44*wb.w.
-00014980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014990: 7265 7475 726e 2077 7265 730a 2020 2020  return wres.    
-000149a0: 2020 2020 2020 2020 2320 7665 6333 206f          # vec3 o
-000149b0: 6e20 7468 6520 7269 6768 743f 0a20 2020  n the right?.   
-000149c0: 2020 2020 2020 2020 2065 6c69 6620 7462           elif tb
-000149d0: 2069 7320 7665 6333 3a0a 2020 2020 2020   is vec3:.      
-000149e0: 2020 2020 2020 2020 2020 2320 6d61 7434            # mat4
-000149f0: 2a76 6563 330a 2020 2020 2020 2020 2020  *vec3.          
-00014a00: 2020 2020 2020 7672 6573 203d 2076 6563        vres = vec
-00014a10: 3328 290a 2020 2020 2020 2020 2020 2020  3().            
-00014a20: 2020 2020 7662 2020 203d 2062 0a20 2020      vb   = b.   
-00014a30: 2020 2020 2020 2020 2020 2020 2076 7265               vre
-00014a40: 732e 7820 3d20 6d61 2e6d 3131 2a76 622e  s.x = ma.m11*vb.
-00014a50: 7820 2b20 6d61 2e6d 3132 2a76 622e 7920  x + ma.m12*vb.y 
-00014a60: 2b20 6d61 2e6d 3133 2a76 622e 7a20 2b20  + ma.m13*vb.z + 
-00014a70: 6d61 2e6d 3134 0a20 2020 2020 2020 2020  ma.m14.         
-00014a80: 2020 2020 2020 2076 7265 732e 7920 3d20         vres.y = 
-00014a90: 6d61 2e6d 3231 2a76 622e 7820 2b20 6d61  ma.m21*vb.x + ma
-00014aa0: 2e6d 3232 2a76 622e 7920 2b20 6d61 2e6d  .m22*vb.y + ma.m
-00014ab0: 3233 2a76 622e 7a20 2b20 6d61 2e6d 3234  23*vb.z + ma.m24
-00014ac0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00014ad0: 2076 7265 732e 7a20 3d20 6d61 2e6d 3331   vres.z = ma.m31
-00014ae0: 2a76 622e 7820 2b20 6d61 2e6d 3332 2a76  *vb.x + ma.m32*v
-00014af0: 622e 7920 2b20 6d61 2e6d 3333 2a76 622e  b.y + ma.m33*vb.
-00014b00: 7a20 2b20 6d61 2e6d 3334 0a20 2020 2020  z + ma.m34.     
-00014b10: 2020 2020 2020 2020 2020 2077 2020 2020             w    
-00014b20: 3d20 6d61 2e6d 3431 2a76 622e 7820 2b20  = ma.m41*vb.x + 
-00014b30: 6d61 2e6d 3432 2a76 622e 7920 2b20 6d61  ma.m42*vb.y + ma
-00014b40: 2e6d 3433 2a76 622e 7a20 2b20 6d61 2e6d  .m43*vb.z + ma.m
-00014b50: 3434 0a20 2020 2020 2020 2020 2020 2020  44.             
-00014b60: 2020 2069 6620 6661 6273 2877 293e 6570     if fabs(w)>ep
-00014b70: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
-00014b80: 2020 2020 2020 2076 7265 732e 7820 3d20         vres.x = 
-00014b90: 7672 6573 2e78 2f77 0a20 2020 2020 2020  vres.x/w.       
-00014ba0: 2020 2020 2020 2020 2020 2020 2076 7265               vre
-00014bb0: 732e 7920 3d20 7672 6573 2e79 2f77 0a20  s.y = vres.y/w. 
-00014bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014bd0: 2020 2076 7265 732e 7a20 3d20 7672 6573     vres.z = vres
-00014be0: 2e7a 2f77 0a20 2020 2020 2020 2020 2020  .z/w.           
-00014bf0: 2020 2020 2072 6574 7572 6e20 7672 6573       return vres
-00014c00: 0a20 2020 2020 2020 2020 2020 2023 2053  .            # S
-00014c10: 6361 6c61 7220 6f6e 2074 6865 2072 6967  calar on the rig
-00014c20: 6874 3f0a 2020 2020 2020 2020 2020 2020  ht?.            
-00014c30: 656c 6966 2074 6220 6973 2066 6c6f 6174  elif tb is float
-00014c40: 206f 7220 7462 2069 7320 696e 7420 6f72   or tb is int or
-00014c50: 2074 6220 6973 206c 6f6e 673a 0a20 2020   tb is long:.   
-00014c60: 2020 2020 2020 2020 2020 2020 2072 6573               res
-00014c70: 203d 206d 6174 3428 290a 2020 2020 2020   = mat4().      
-00014c80: 2020 2020 2020 2020 2020 7220 3d20 620a            r = b.
-00014c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014ca0: 7265 732e 6d31 3120 3d20 6d61 2e6d 3131  res.m11 = ma.m11
-00014cb0: 2a72 0a20 2020 2020 2020 2020 2020 2020  *r.             
-00014cc0: 2020 2072 6573 2e6d 3132 203d 206d 612e     res.m12 = ma.
-00014cd0: 6d31 322a 720a 2020 2020 2020 2020 2020  m12*r.          
-00014ce0: 2020 2020 2020 7265 732e 6d31 3320 3d20        res.m13 = 
-00014cf0: 6d61 2e6d 3133 2a72 0a20 2020 2020 2020  ma.m13*r.       
-00014d00: 2020 2020 2020 2020 2072 6573 2e6d 3134           res.m14
-00014d10: 203d 206d 612e 6d31 342a 720a 2020 2020   = ma.m14*r.    
-00014d20: 2020 2020 2020 2020 2020 2020 7265 732e              res.
-00014d30: 6d32 3120 3d20 6d61 2e6d 3231 2a72 0a20  m21 = ma.m21*r. 
-00014d40: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00014d50: 6573 2e6d 3232 203d 206d 612e 6d32 322a  es.m22 = ma.m22*
-00014d60: 720a 2020 2020 2020 2020 2020 2020 2020  r.              
-00014d70: 2020 7265 732e 6d32 3320 3d20 6d61 2e6d    res.m23 = ma.m
-00014d80: 3233 2a72 0a20 2020 2020 2020 2020 2020  23*r.           
-00014d90: 2020 2020 2072 6573 2e6d 3234 203d 206d       res.m24 = m
-00014da0: 612e 6d32 342a 720a 2020 2020 2020 2020  a.m24*r.        
-00014db0: 2020 2020 2020 2020 7265 732e 6d33 3120          res.m31 
-00014dc0: 3d20 6d61 2e6d 3331 2a72 0a20 2020 2020  = ma.m31*r.     
-00014dd0: 2020 2020 2020 2020 2020 2072 6573 2e6d             res.m
-00014de0: 3332 203d 206d 612e 6d33 322a 720a 2020  32 = ma.m32*r.  
-00014df0: 2020 2020 2020 2020 2020 2020 2020 7265                re
-00014e00: 732e 6d33 3320 3d20 6d61 2e6d 3333 2a72  s.m33 = ma.m33*r
-00014e10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00014e20: 2072 6573 2e6d 3334 203d 206d 612e 6d33   res.m34 = ma.m3
-00014e30: 342a 720a 2020 2020 2020 2020 2020 2020  4*r.            
-00014e40: 2020 2020 7265 732e 6d34 3120 3d20 6d61      res.m41 = ma
-00014e50: 2e6d 3431 2a72 0a20 2020 2020 2020 2020  .m41*r.         
-00014e60: 2020 2020 2020 2072 6573 2e6d 3432 203d         res.m42 =
-00014e70: 206d 612e 6d34 322a 720a 2020 2020 2020   ma.m42*r.      
-00014e80: 2020 2020 2020 2020 2020 7265 732e 6d34            res.m4
-00014e90: 3320 3d20 6d61 2e6d 3433 2a72 0a20 2020  3 = ma.m43*r.   
-00014ea0: 2020 2020 2020 2020 2020 2020 2072 6573               res
-00014eb0: 2e6d 3434 203d 206d 612e 6d34 342a 720a  .m44 = ma.m44*r.
-00014ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014ed0: 7265 7475 726e 2072 6573 0a0a 2020 2020  return res..    
-00014ee0: 2020 2020 2320 7665 6334 206f 6e20 7468      # vec4 on th
-00014ef0: 6520 6c65 6674 3f20 2874 6865 6e20 7468  e left? (then th
-00014f00: 6572 6520 6d75 7374 2062 6520 6120 6d61  ere must be a ma
-00014f10: 7434 206f 6e20 7468 6520 7269 6768 7429  t4 on the right)
-00014f20: 0a20 2020 2020 2020 2065 6c69 6620 7461  .        elif ta
-00014f30: 2069 7320 7665 6334 3a0a 2020 2020 2020   is vec4:.      
-00014f40: 2020 2020 2020 2320 7665 6334 2a6d 6174        # vec4*mat
-00014f50: 340a 2020 2020 2020 2020 2020 2020 7772  4.            wr
-00014f60: 6573 203d 2076 6563 3428 290a 2020 2020  es = vec4().    
-00014f70: 2020 2020 2020 2020 7761 2020 203d 2061          wa   = a
-00014f80: 0a20 2020 2020 2020 2020 2020 206d 6220  .            mb 
-00014f90: 2020 3d20 620a 2020 2020 2020 2020 2020    = b.          
-00014fa0: 2020 7772 6573 2e78 203d 2077 612e 782a    wres.x = wa.x*
-00014fb0: 6d62 2e6d 3131 202b 2077 612e 792a 6d62  mb.m11 + wa.y*mb
-00014fc0: 2e6d 3231 202b 2077 612e 7a2a 6d62 2e6d  .m21 + wa.z*mb.m
-00014fd0: 3331 202b 2077 612e 772a 6d62 2e6d 3431  31 + wa.w*mb.m41
-00014fe0: 0a20 2020 2020 2020 2020 2020 2077 7265  .            wre
-00014ff0: 732e 7920 3d20 7761 2e78 2a6d 622e 6d31  s.y = wa.x*mb.m1
-00015000: 3220 2b20 7761 2e79 2a6d 622e 6d32 3220  2 + wa.y*mb.m22 
-00015010: 2b20 7761 2e7a 2a6d 622e 6d33 3220 2b20  + wa.z*mb.m32 + 
-00015020: 7761 2e77 2a6d 622e 6d34 320a 2020 2020  wa.w*mb.m42.    
-00015030: 2020 2020 2020 2020 7772 6573 2e7a 203d          wres.z =
-00015040: 2077 612e 782a 6d62 2e6d 3133 202b 2077   wa.x*mb.m13 + w
-00015050: 612e 792a 6d62 2e6d 3233 202b 2077 612e  a.y*mb.m23 + wa.
-00015060: 7a2a 6d62 2e6d 3333 202b 2077 612e 772a  z*mb.m33 + wa.w*
-00015070: 6d62 2e6d 3433 0a20 2020 2020 2020 2020  mb.m43.         
-00015080: 2020 2077 7265 732e 7720 3d20 7761 2e78     wres.w = wa.x
-00015090: 2a6d 622e 6d31 3420 2b20 7761 2e79 2a6d  *mb.m14 + wa.y*m
-000150a0: 622e 6d32 3420 2b20 7761 2e7a 2a6d 622e  b.m24 + wa.z*mb.
-000150b0: 6d33 3420 2b20 7761 2e77 2a6d 622e 6d34  m34 + wa.w*mb.m4
-000150c0: 340a 2020 2020 2020 2020 2020 2020 7265  4.            re
-000150d0: 7475 726e 2077 7265 730a 0a20 2020 2020  turn wres..     
-000150e0: 2020 2023 2076 6563 3320 6f6e 2074 6865     # vec3 on the
-000150f0: 206c 6566 743f 2028 7468 656e 2074 6865   left? (then the
-00015100: 7265 206d 7573 7420 6265 2061 206d 6174  re must be a mat
-00015110: 3420 6f6e 2074 6865 2072 6967 6874 290a  4 on the right).
-00015120: 2020 2020 2020 2020 656c 6966 2074 6120          elif ta 
-00015130: 6973 2076 6563 333a 0a20 2020 2020 2020  is vec3:.       
-00015140: 2020 2020 2023 2076 6563 332a 6d61 7434       # vec3*mat4
-00015150: 0a20 2020 2020 2020 2020 2020 2076 7265  .            vre
-00015160: 7320 3d20 7665 6333 2829 0a20 2020 2020  s = vec3().     
-00015170: 2020 2020 2020 2076 6120 2020 3d20 610a         va   = a.
-00015180: 2020 2020 2020 2020 2020 2020 6d62 2020              mb  
-00015190: 203d 2062 0a20 2020 2020 2020 2020 2020   = b.           
-000151a0: 2076 7265 732e 7820 3d20 7661 2e78 2a6d   vres.x = va.x*m
-000151b0: 622e 6d31 3120 2b20 7661 2e79 2a6d 622e  b.m11 + va.y*mb.
-000151c0: 6d32 3120 2b20 7661 2e7a 2a6d 622e 6d33  m21 + va.z*mb.m3
-000151d0: 3120 2b20 6d62 2e6d 3431 0a20 2020 2020  1 + mb.m41.     
-000151e0: 2020 2020 2020 2076 7265 732e 7920 3d20         vres.y = 
-000151f0: 7661 2e78 2a6d 622e 6d31 3220 2b20 7661  va.x*mb.m12 + va
-00015200: 2e79 2a6d 622e 6d32 3220 2b20 7661 2e7a  .y*mb.m22 + va.z
-00015210: 2a6d 622e 6d33 3220 2b20 6d62 2e6d 3432  *mb.m32 + mb.m42
-00015220: 0a20 2020 2020 2020 2020 2020 2076 7265  .            vre
-00015230: 732e 7a20 3d20 7661 2e78 2a6d 622e 6d31  s.z = va.x*mb.m1
-00015240: 3320 2b20 7661 2e79 2a6d 622e 6d32 3320  3 + va.y*mb.m23 
-00015250: 2b20 7661 2e7a 2a6d 622e 6d33 3320 2b20  + va.z*mb.m33 + 
-00015260: 6d62 2e6d 3433 0a20 2020 2020 2020 2020  mb.m43.         
-00015270: 2020 2077 203d 2076 612e 782a 6d62 2e6d     w = va.x*mb.m
-00015280: 3134 202b 2076 612e 792a 6d62 2e6d 3234  14 + va.y*mb.m24
-00015290: 202b 2076 612e 7a2a 6d62 2e6d 3334 202b   + va.z*mb.m34 +
-000152a0: 206d 622e 6d34 340a 2020 2020 2020 2020   mb.m44.        
-000152b0: 2020 2020 6966 2066 6162 7328 7729 3e65      if fabs(w)>e
-000152c0: 7073 3a0a 2020 2020 2020 2020 2020 2020  ps:.            
-000152d0: 2020 2020 7672 6573 2e78 203d 2076 7265      vres.x = vre
-000152e0: 732e 782f 770a 2020 2020 2020 2020 2020  s.x/w.          
-000152f0: 2020 2020 2020 7672 6573 2e79 203d 2076        vres.y = v
-00015300: 7265 732e 792f 770a 2020 2020 2020 2020  res.y/w.        
-00015310: 2020 2020 2020 2020 7672 6573 2e7a 203d          vres.z =
-00015320: 2076 7265 732e 7a2f 770a 2020 2020 2020   vres.z/w.      
-00015330: 2020 2020 2020 7265 7475 726e 2076 7265        return vre
-00015340: 730a 0a20 2020 2020 2020 2023 2053 6361  s..        # Sca
-00015350: 6c61 7220 6f6e 2074 6865 206c 6566 743f  lar on the left?
-00015360: 2028 7468 656e 2074 6865 7265 206d 7573   (then there mus
-00015370: 7420 6265 2061 206d 6174 3420 6f6e 2074  t be a mat4 on t
-00015380: 6865 2072 6967 6874 290a 2020 2020 2020  he right).      
-00015390: 2020 656c 6966 2074 6120 6973 2066 6c6f    elif ta is flo
-000153a0: 6174 206f 7220 7461 2069 7320 696e 7420  at or ta is int 
-000153b0: 6f72 2074 6120 6973 206c 6f6e 673a 0a20  or ta is long:. 
-000153c0: 2020 2020 2020 2020 2020 2072 6573 203d             res =
-000153d0: 206d 6174 3428 290a 2020 2020 2020 2020   mat4().        
-000153e0: 2020 2020 7220 203d 2061 0a20 2020 2020      r  = a.     
-000153f0: 2020 2020 2020 206d 6220 3d20 620a 2020         mb = b.  
-00015400: 2020 2020 2020 2020 2020 7265 732e 6d31            res.m1
-00015410: 3120 3d20 722a 6d62 2e6d 3131 0a20 2020  1 = r*mb.m11.   
-00015420: 2020 2020 2020 2020 2072 6573 2e6d 3132           res.m12
-00015430: 203d 2072 2a6d 622e 6d31 320a 2020 2020   = r*mb.m12.    
-00015440: 2020 2020 2020 2020 7265 732e 6d31 3320          res.m13 
-00015450: 3d20 722a 6d62 2e6d 3133 0a20 2020 2020  = r*mb.m13.     
-00015460: 2020 2020 2020 2072 6573 2e6d 3134 203d         res.m14 =
-00015470: 2072 2a6d 622e 6d31 340a 2020 2020 2020   r*mb.m14.      
-00015480: 2020 2020 2020 7265 732e 6d32 3120 3d20        res.m21 = 
-00015490: 722a 6d62 2e6d 3231 0a20 2020 2020 2020  r*mb.m21.       
-000154a0: 2020 2020 2072 6573 2e6d 3232 203d 2072       res.m22 = r
-000154b0: 2a6d 622e 6d32 320a 2020 2020 2020 2020  *mb.m22.        
-000154c0: 2020 2020 7265 732e 6d32 3320 3d20 722a      res.m23 = r*
-000154d0: 6d62 2e6d 3233 0a20 2020 2020 2020 2020  mb.m23.         
-000154e0: 2020 2072 6573 2e6d 3234 203d 2072 2a6d     res.m24 = r*m
-000154f0: 622e 6d32 340a 2020 2020 2020 2020 2020  b.m24.          
-00015500: 2020 7265 732e 6d33 3120 3d20 722a 6d62    res.m31 = r*mb
-00015510: 2e6d 3331 0a20 2020 2020 2020 2020 2020  .m31.           
-00015520: 2072 6573 2e6d 3332 203d 2072 2a6d 622e   res.m32 = r*mb.
-00015530: 6d33 320a 2020 2020 2020 2020 2020 2020  m32.            
-00015540: 7265 732e 6d33 3320 3d20 722a 6d62 2e6d  res.m33 = r*mb.m
-00015550: 3333 0a20 2020 2020 2020 2020 2020 2072  33.            r
-00015560: 6573 2e6d 3334 203d 2072 2a6d 622e 6d33  es.m34 = r*mb.m3
-00015570: 340a 2020 2020 2020 2020 2020 2020 7265  4.            re
-00015580: 732e 6d34 3120 3d20 722a 6d62 2e6d 3431  s.m41 = r*mb.m41
-00015590: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
-000155a0: 2e6d 3432 203d 2072 2a6d 622e 6d34 320a  .m42 = r*mb.m42.
-000155b0: 2020 2020 2020 2020 2020 2020 7265 732e              res.
-000155c0: 6d34 3320 3d20 722a 6d62 2e6d 3433 0a20  m43 = r*mb.m43. 
-000155d0: 2020 2020 2020 2020 2020 2072 6573 2e6d             res.m
-000155e0: 3434 203d 2072 2a6d 622e 6d34 340a 2020  44 = r*mb.m44.  
-000155f0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00015600: 2072 6573 0a0a 2020 2020 2020 2020 2320   res..        # 
-00015610: 4e6f 2076 616c 6964 2063 6f6d 6269 6e61  No valid combina
-00015620: 7469 6f6e 2066 6f75 6e64 0a20 2020 2020  tion found.     
-00015630: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
-00015640: 6f72 2c20 2275 6e73 7570 706f 7274 6564  or, "unsupported
-00015650: 206f 7065 7261 6e64 2074 7970 6520 666f   operand type fo
-00015660: 7220 2a22 0a0a 2020 2020 6465 6620 5f5f  r *"..    def __
-00015670: 6469 765f 5f28 6d61 7434 2061 2c20 6229  div__(mat4 a, b)
-00015680: 3a0a 2020 2020 2020 2020 2320 5079 7468  :.        # Pyth
-00015690: 6f6e 2032 0a20 2020 2020 2020 2072 6574  on 2.        ret
-000156a0: 7572 6e20 6d61 7434 2e5f 5f74 7275 6564  urn mat4.__trued
-000156b0: 6976 5f5f 2861 2c62 290a 0a20 2020 2064  iv__(a,b)..    d
-000156c0: 6566 205f 5f74 7275 6564 6976 5f5f 286d  ef __truediv__(m
-000156d0: 6174 3420 612c 2062 293a 0a20 2020 2020  at4 a, b):.     
-000156e0: 2020 2022 2222 4469 7669 7369 6f6e 2e0a     """Division..
-000156f0: 0a20 2020 2020 2020 203e 3e3e 204d 3d6d  .        >>> M=m
-00015700: 6174 3428 312c 322c 332c 342c 352c 362c  at4(1,2,3,4,5,6,
-00015710: 372c 382c 392c 3130 2c31 312c 3132 2c31  7,8,9,10,11,12,1
-00015720: 332c 3134 2c31 352c 3136 290a 2020 2020  3,14,15,16).    
-00015730: 2020 2020 3e3e 3e20 7072 696e 7420 4d2f      >>> print M/
-00015740: 322e 300a 2020 2020 2020 2020 5b20 2020  2.0.        [   
-00015750: 302e 3530 3030 2c20 2020 2031 2e30 3030  0.5000,    1.000
-00015760: 302c 2020 2020 312e 3530 3030 2c20 2020  0,    1.5000,   
-00015770: 2032 2e30 3030 305d 0a20 2020 2020 2020   2.0000].       
-00015780: 205b 2020 2032 2e35 3030 302c 2020 2020   [   2.5000,    
-00015790: 332e 3030 3030 2c20 2020 2033 2e35 3030  3.0000,    3.500
-000157a0: 302c 2020 2020 342e 3030 3030 5d0a 2020  0,    4.0000].  
-000157b0: 2020 2020 2020 5b20 2020 342e 3530 3030        [   4.5000
-000157c0: 2c20 2020 2035 2e30 3030 302c 2020 2020  ,    5.0000,    
-000157d0: 352e 3530 3030 2c20 2020 2036 2e30 3030  5.5000,    6.000
-000157e0: 305d 0a20 2020 2020 2020 205b 2020 2036  0].        [   6
-000157f0: 2e35 3030 302c 2020 2020 372e 3030 3030  .5000,    7.0000
-00015800: 2c20 2020 2037 2e35 3030 302c 2020 2020  ,    7.5000,    
-00015810: 382e 3030 3030 5d0a 2020 2020 2020 2020  8.0000].        
-00015820: 2222 220a 2020 2020 2020 2020 6364 6566  """.        cdef
-00015830: 206d 6174 3420 7265 730a 2020 2020 2020   mat4 res.      
-00015840: 2020 6364 6566 2064 6f75 626c 6520 720a    cdef double r.
-00015850: 0a20 2020 2020 2020 2074 6220 3d20 7479  .        tb = ty
-00015860: 7065 2862 290a 0a20 2020 2020 2020 2069  pe(b)..        i
-00015870: 6620 7462 2069 7320 666c 6f61 7420 6f72  f tb is float or
-00015880: 2074 6220 6973 2069 6e74 206f 7220 7462   tb is int or tb
-00015890: 2069 7320 6c6f 6e67 3a0a 2020 2020 2020   is long:.      
-000158a0: 2020 2020 2020 2320 6d61 7434 2f73 6361        # mat4/sca
-000158b0: 6c61 720a 2020 2020 2020 2020 2020 2020  lar.            
-000158c0: 7265 7320 3d20 6d61 7434 2829 0a20 2020  res = mat4().   
-000158d0: 2020 2020 2020 2020 2072 203d 2062 0a20           r = b. 
-000158e0: 2020 2020 2020 2020 2020 2069 6620 6661             if fa
-000158f0: 6273 2872 293c 3d65 7073 3a0a 2020 2020  bs(r)<=eps:.    
-00015900: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00015910: 6520 5a65 726f 4469 7669 7369 6f6e 4572  e ZeroDivisionEr
-00015920: 726f 722c 226d 6174 3420 6469 7669 7369  ror,"mat4 divisi
-00015930: 6f6e 220a 2020 2020 2020 2020 2020 2020  on".            
-00015940: 7265 732e 6d31 3120 3d20 612e 6d31 312f  res.m11 = a.m11/
-00015950: 720a 2020 2020 2020 2020 2020 2020 7265  r.            re
-00015960: 732e 6d31 3220 3d20 612e 6d31 322f 720a  s.m12 = a.m12/r.
-00015970: 2020 2020 2020 2020 2020 2020 7265 732e              res.
-00015980: 6d31 3320 3d20 612e 6d31 332f 720a 2020  m13 = a.m13/r.  
-00015990: 2020 2020 2020 2020 2020 7265 732e 6d31            res.m1
-000159a0: 3420 3d20 612e 6d31 342f 720a 2020 2020  4 = a.m14/r.    
-000159b0: 2020 2020 2020 2020 7265 732e 6d32 3120          res.m21 
-000159c0: 3d20 612e 6d32 312f 720a 2020 2020 2020  = a.m21/r.      
-000159d0: 2020 2020 2020 7265 732e 6d32 3220 3d20        res.m22 = 
-000159e0: 612e 6d32 322f 720a 2020 2020 2020 2020  a.m22/r.        
-000159f0: 2020 2020 7265 732e 6d32 3320 3d20 612e      res.m23 = a.
-00015a00: 6d32 332f 720a 2020 2020 2020 2020 2020  m23/r.          
-00015a10: 2020 7265 732e 6d32 3420 3d20 612e 6d32    res.m24 = a.m2
-00015a20: 342f 720a 2020 2020 2020 2020 2020 2020  4/r.            
-00015a30: 7265 732e 6d33 3120 3d20 612e 6d33 312f  res.m31 = a.m31/
-00015a40: 720a 2020 2020 2020 2020 2020 2020 7265  r.            re
-00015a50: 732e 6d33 3220 3d20 612e 6d33 322f 720a  s.m32 = a.m32/r.
-00015a60: 2020 2020 2020 2020 2020 2020 7265 732e              res.
-00015a70: 6d33 3320 3d20 612e 6d33 332f 720a 2020  m33 = a.m33/r.  
-00015a80: 2020 2020 2020 2020 2020 7265 732e 6d33            res.m3
-00015a90: 3420 3d20 612e 6d33 342f 720a 2020 2020  4 = a.m34/r.    
-00015aa0: 2020 2020 2020 2020 7265 732e 6d34 3120          res.m41 
-00015ab0: 3d20 612e 6d34 312f 720a 2020 2020 2020  = a.m41/r.      
-00015ac0: 2020 2020 2020 7265 732e 6d34 3220 3d20        res.m42 = 
-00015ad0: 612e 6d34 322f 720a 2020 2020 2020 2020  a.m42/r.        
-00015ae0: 2020 2020 7265 732e 6d34 3320 3d20 612e      res.m43 = a.
-00015af0: 6d34 332f 720a 2020 2020 2020 2020 2020  m43/r.          
-00015b00: 2020 7265 732e 6d34 3420 3d20 612e 6d34    res.m44 = a.m4
-00015b10: 342f 720a 2020 2020 2020 2020 2020 2020  4/r.            
-00015b20: 7265 7475 726e 2072 6573 0a20 2020 2020  return res.     
-00015b30: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00015b40: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
-00015b50: 7272 6f72 2c20 2275 6e73 7570 706f 7274  rror, "unsupport
-00015b60: 6564 206f 7065 7261 6e64 2074 7970 6520  ed operand type 
-00015b70: 666f 7220 2f22 0a0a 2020 2020 6465 6620  for /"..    def 
-00015b80: 5f5f 6d6f 645f 5f28 6d61 7434 2073 656c  __mod__(mat4 sel
-00015b90: 662c 206f 7468 6572 293a 0a20 2020 2020  f, other):.     
-00015ba0: 2020 2022 2222 4d6f 6475 6c6f 2e0a 0a20     """Modulo... 
-00015bb0: 2020 2020 2020 203e 3e3e 204d 3d6d 6174         >>> M=mat
-00015bc0: 3428 312c 322c 332c 342c 352c 362c 372c  4(1,2,3,4,5,6,7,
-00015bd0: 382c 392c 3130 2c31 312c 3132 2c31 332c  8,9,10,11,12,13,
-00015be0: 3134 2c31 352c 3136 290a 2020 2020 2020  14,15,16).      
-00015bf0: 2020 3e3e 3e20 7072 696e 7420 4d25 352e    >>> print M%5.
-00015c00: 300a 2020 2020 2020 2020 5b20 2020 312e  0.        [   1.
-00015c10: 3030 3030 2c20 2020 2032 2e30 3030 302c  0000,    2.0000,
-00015c20: 2020 2020 332e 3030 3030 2c20 2020 2034      3.0000,    4
-00015c30: 2e30 3030 305d 0a20 2020 2020 2020 205b  .0000].        [
-00015c40: 2020 2030 2e30 3030 302c 2020 2020 312e     0.0000,    1.
-00015c50: 3030 3030 2c20 2020 2032 2e30 3030 302c  0000,    2.0000,
-00015c60: 2020 2020 332e 3030 3030 5d0a 2020 2020      3.0000].    
-00015c70: 2020 2020 5b20 2020 342e 3030 3030 2c20      [   4.0000, 
-00015c80: 2020 2030 2e30 3030 302c 2020 2020 312e     0.0000,    1.
-00015c90: 3030 3030 2c20 2020 2032 2e30 3030 305d  0000,    2.0000]
-00015ca0: 0a20 2020 2020 2020 205b 2020 2033 2e30  .        [   3.0
-00015cb0: 3030 302c 2020 2020 342e 3030 3030 2c20  000,    4.0000, 
-00015cc0: 2020 2030 2e30 3030 302c 2020 2020 312e     0.0000,    1.
-00015cd0: 3030 3030 5d0a 2020 2020 2020 2020 2222  0000].        ""
-00015ce0: 220a 2020 2020 2020 2020 6364 6566 206d  ".        cdef m
-00015cf0: 6174 3420 6d62 2c20 7265 730a 0a20 2020  at4 mb, res..   
-00015d00: 2020 2020 2074 6220 3d20 7479 7065 286f       tb = type(o
-00015d10: 7468 6572 290a 0a20 2020 2020 2020 2069  ther)..        i
-00015d20: 6620 7462 2069 7320 666c 6f61 7420 6f72  f tb is float or
-00015d30: 2074 6220 6973 2069 6e74 206f 7220 7462   tb is int or tb
-00015d40: 2069 7320 6c6f 6e67 3a0a 2020 2020 2020   is long:.      
-00015d50: 2020 2020 2020 7220 3d20 6f74 6865 720a        r = other.
-00015d60: 2020 2020 2020 2020 2020 2020 6966 2066              if f
-00015d70: 6162 7328 7229 3c3d 6570 733a 0a20 2020  abs(r)<=eps:.   
-00015d80: 2020 2020 2020 2020 2020 2020 2072 6169               rai
-00015d90: 7365 205a 6572 6f44 6976 6973 696f 6e45  se ZeroDivisionE
-00015da0: 7272 6f72 2c22 6d61 7434 206d 6f64 756c  rror,"mat4 modul
-00015db0: 6f22 0a20 2020 2020 2020 2020 2020 2072  o".            r
-00015dc0: 6573 203d 206d 6174 3428 290a 2020 2020  es = mat4().    
-00015dd0: 2020 2020 2020 2020 7265 732e 6d31 3120          res.m11 
-00015de0: 3d20 5f66 6d6f 6428 7365 6c66 2e6d 3131  = _fmod(self.m11
-00015df0: 2c20 7229 0a20 2020 2020 2020 2020 2020  , r).           
-00015e00: 2072 6573 2e6d 3132 203d 205f 666d 6f64   res.m12 = _fmod
-00015e10: 2873 656c 662e 6d31 322c 2072 290a 2020  (self.m12, r).  
-00015e20: 2020 2020 2020 2020 2020 7265 732e 6d31            res.m1
-00015e30: 3320 3d20 5f66 6d6f 6428 7365 6c66 2e6d  3 = _fmod(self.m
-00015e40: 3133 2c20 7229 0a20 2020 2020 2020 2020  13, r).         
-00015e50: 2020 2072 6573 2e6d 3134 203d 205f 666d     res.m14 = _fm
-00015e60: 6f64 2873 656c 662e 6d31 342c 2072 290a  od(self.m14, r).
-00015e70: 2020 2020 2020 2020 2020 2020 7265 732e              res.
-00015e80: 6d32 3120 3d20 5f66 6d6f 6428 7365 6c66  m21 = _fmod(self
-00015e90: 2e6d 3231 2c20 7229 0a20 2020 2020 2020  .m21, r).       
-00015ea0: 2020 2020 2072 6573 2e6d 3232 203d 205f       res.m22 = _
-00015eb0: 666d 6f64 2873 656c 662e 6d32 322c 2072  fmod(self.m22, r
-00015ec0: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
-00015ed0: 732e 6d32 3320 3d20 5f66 6d6f 6428 7365  s.m23 = _fmod(se
-00015ee0: 6c66 2e6d 3233 2c20 7229 0a20 2020 2020  lf.m23, r).     
-00015ef0: 2020 2020 2020 2072 6573 2e6d 3234 203d         res.m24 =
-00015f00: 205f 666d 6f64 2873 656c 662e 6d32 342c   _fmod(self.m24,
-00015f10: 2072 290a 2020 2020 2020 2020 2020 2020   r).            
-00015f20: 7265 732e 6d33 3120 3d20 5f66 6d6f 6428  res.m31 = _fmod(
-00015f30: 7365 6c66 2e6d 3331 2c20 7229 0a20 2020  self.m31, r).   
-00015f40: 2020 2020 2020 2020 2072 6573 2e6d 3332           res.m32
-00015f50: 203d 205f 666d 6f64 2873 656c 662e 6d33   = _fmod(self.m3
-00015f60: 322c 2072 290a 2020 2020 2020 2020 2020  2, r).          
-00015f70: 2020 7265 732e 6d33 3320 3d20 5f66 6d6f    res.m33 = _fmo
-00015f80: 6428 7365 6c66 2e6d 3333 2c20 7229 0a20  d(self.m33, r). 
-00015f90: 2020 2020 2020 2020 2020 2072 6573 2e6d             res.m
-00015fa0: 3334 203d 205f 666d 6f64 2873 656c 662e  34 = _fmod(self.
-00015fb0: 6d33 342c 2072 290a 2020 2020 2020 2020  m34, r).        
-00015fc0: 2020 2020 7265 732e 6d34 3120 3d20 5f66      res.m41 = _f
-00015fd0: 6d6f 6428 7365 6c66 2e6d 3431 2c20 7229  mod(self.m41, r)
-00015fe0: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
-00015ff0: 2e6d 3432 203d 205f 666d 6f64 2873 656c  .m42 = _fmod(sel
-00016000: 662e 6d34 322c 2072 290a 2020 2020 2020  f.m42, r).      
-00016010: 2020 2020 2020 7265 732e 6d34 3320 3d20        res.m43 = 
-00016020: 5f66 6d6f 6428 7365 6c66 2e6d 3433 2c20  _fmod(self.m43, 
-00016030: 7229 0a20 2020 2020 2020 2020 2020 2072  r).            r
-00016040: 6573 2e6d 3434 203d 205f 666d 6f64 2873  es.m44 = _fmod(s
-00016050: 656c 662e 6d34 342c 2072 290a 2020 2020  elf.m44, r).    
-00016060: 2020 2020 2020 2020 7265 7475 726e 2072          return r
-00016070: 6573 0a0a 2020 2020 2020 2020 656c 6966  es..        elif
-00016080: 2074 6220 6973 206d 6174 343a 0a20 2020   tb is mat4:.   
-00016090: 2020 2020 2020 2020 206d 6220 3d20 6f74           mb = ot
-000160a0: 6865 720a 0a20 2020 2020 2020 2020 2020  her..           
-000160b0: 2069 6620 2866 6162 7328 6d62 2e6d 3131   if (fabs(mb.m11
-000160c0: 293c 3d65 7073 206f 7220 6661 6273 286d  )<=eps or fabs(m
-000160d0: 622e 6d31 3229 3c3d 6570 7320 6f72 2066  b.m12)<=eps or f
-000160e0: 6162 7328 6d62 2e6d 3133 293c 3d65 7073  abs(mb.m13)<=eps
-000160f0: 206f 720a 2020 2020 2020 2020 2020 2020   or.            
-00016100: 2020 2020 6661 6273 286d 622e 6d31 3429      fabs(mb.m14)
-00016110: 3c3d 6570 7320 6f72 0a20 2020 2020 2020  <=eps or.       
-00016120: 2020 2020 2020 2020 2066 6162 7328 6d62           fabs(mb
-00016130: 2e6d 3231 293c 3d65 7073 206f 7220 6661  .m21)<=eps or fa
-00016140: 6273 286d 622e 6d32 3229 3c3d 6570 7320  bs(mb.m22)<=eps 
-00016150: 6f72 2066 6162 7328 6d62 2e6d 3233 293c  or fabs(mb.m23)<
-00016160: 3d65 7073 206f 720a 2020 2020 2020 2020  =eps or.        
-00016170: 2020 2020 2020 2020 6661 6273 286d 622e          fabs(mb.
-00016180: 6d32 3429 3c3d 6570 7320 6f72 0a20 2020  m24)<=eps or.   
-00016190: 2020 2020 2020 2020 2020 2020 2066 6162               fab
-000161a0: 7328 6d62 2e6d 3331 293c 3d65 7073 206f  s(mb.m31)<=eps o
-000161b0: 7220 6661 6273 286d 622e 6d33 3229 3c3d  r fabs(mb.m32)<=
-000161c0: 6570 7320 6f72 2066 6162 7328 6d62 2e6d  eps or fabs(mb.m
-000161d0: 3333 293c 3d65 7073 206f 720a 2020 2020  33)<=eps or.    
-000161e0: 2020 2020 2020 2020 2020 2020 6661 6273              fabs
-000161f0: 286d 622e 6d33 3429 3c3d 6570 7320 6f72  (mb.m34)<=eps or
-00016200: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00016210: 2066 6162 7328 6d62 2e6d 3431 293c 3d65   fabs(mb.m41)<=e
-00016220: 7073 206f 7220 6661 6273 286d 622e 6d34  ps or fabs(mb.m4
-00016230: 3229 3c3d 6570 7320 6f72 2066 6162 7328  2)<=eps or fabs(
-00016240: 6d62 2e6d 3433 293c 3d65 7073 206f 720a  mb.m43)<=eps or.
-00016250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016260: 6661 6273 286d 622e 6d34 3429 3c3d 6570  fabs(mb.m44)<=ep
-00016270: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
-00016280: 2020 2020 7261 6973 6520 5a65 726f 4469      raise ZeroDi
-00016290: 7669 7369 6f6e 4572 726f 722c 226d 6174  visionError,"mat
-000162a0: 3420 6d6f 6475 6c6f 220a 0a20 2020 2020  4 modulo"..     
-000162b0: 2020 2020 2020 2072 6573 3d6d 6174 3428         res=mat4(
-000162c0: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
-000162d0: 732e 6d31 3120 3d20 5f66 6d6f 6428 7365  s.m11 = _fmod(se
-000162e0: 6c66 2e6d 3131 2c20 6d62 2e6d 3131 290a  lf.m11, mb.m11).
-000162f0: 2020 2020 2020 2020 2020 2020 7265 732e              res.
-00016300: 6d31 3220 3d20 5f66 6d6f 6428 7365 6c66  m12 = _fmod(self
-00016310: 2e6d 3132 2c20 6d62 2e6d 3132 290a 2020  .m12, mb.m12).  
-00016320: 2020 2020 2020 2020 2020 7265 732e 6d31            res.m1
-00016330: 3320 3d20 5f66 6d6f 6428 7365 6c66 2e6d  3 = _fmod(self.m
-00016340: 3133 2c20 6d62 2e6d 3133 290a 2020 2020  13, mb.m13).    
-00016350: 2020 2020 2020 2020 7265 732e 6d31 3420          res.m14 
-00016360: 3d20 5f66 6d6f 6428 7365 6c66 2e6d 3134  = _fmod(self.m14
-00016370: 2c20 6d62 2e6d 3134 290a 2020 2020 2020  , mb.m14).      
-00016380: 2020 2020 2020 7265 732e 6d32 3120 3d20        res.m21 = 
-00016390: 5f66 6d6f 6428 7365 6c66 2e6d 3231 2c20  _fmod(self.m21, 
-000163a0: 6d62 2e6d 3231 290a 2020 2020 2020 2020  mb.m21).        
-000163b0: 2020 2020 7265 732e 6d32 3220 3d20 5f66      res.m22 = _f
-000163c0: 6d6f 6428 7365 6c66 2e6d 3232 2c20 6d62  mod(self.m22, mb
-000163d0: 2e6d 3232 290a 2020 2020 2020 2020 2020  .m22).          
-000163e0: 2020 7265 732e 6d32 3320 3d20 5f66 6d6f    res.m23 = _fmo
-000163f0: 6428 7365 6c66 2e6d 3233 2c20 6d62 2e6d  d(self.m23, mb.m
-00016400: 3233 290a 2020 2020 2020 2020 2020 2020  23).            
-00016410: 7265 732e 6d32 3420 3d20 5f66 6d6f 6428  res.m24 = _fmod(
-00016420: 7365 6c66 2e6d 3234 2c20 6d62 2e6d 3234  self.m24, mb.m24
-00016430: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
-00016440: 732e 6d33 3120 3d20 5f66 6d6f 6428 7365  s.m31 = _fmod(se
-00016450: 6c66 2e6d 3331 2c20 6d62 2e6d 3331 290a  lf.m31, mb.m31).
-00016460: 2020 2020 2020 2020 2020 2020 7265 732e              res.
-00016470: 6d33 3220 3d20 5f66 6d6f 6428 7365 6c66  m32 = _fmod(self
-00016480: 2e6d 3332 2c20 6d62 2e6d 3332 290a 2020  .m32, mb.m32).  
-00016490: 2020 2020 2020 2020 2020 7265 732e 6d33            res.m3
-000164a0: 3320 3d20 5f66 6d6f 6428 7365 6c66 2e6d  3 = _fmod(self.m
-000164b0: 3333 2c20 6d62 2e6d 3333 290a 2020 2020  33, mb.m33).    
-000164c0: 2020 2020 2020 2020 7265 732e 6d33 3420          res.m34 
-000164d0: 3d20 5f66 6d6f 6428 7365 6c66 2e6d 3334  = _fmod(self.m34
-000164e0: 2c20 6d62 2e6d 3334 290a 2020 2020 2020  , mb.m34).      
-000164f0: 2020 2020 2020 7265 732e 6d34 3120 3d20        res.m41 = 
-00016500: 5f66 6d6f 6428 7365 6c66 2e6d 3431 2c20  _fmod(self.m41, 
-00016510: 6d62 2e6d 3431 290a 2020 2020 2020 2020  mb.m41).        
-00016520: 2020 2020 7265 732e 6d34 3220 3d20 5f66      res.m42 = _f
-00016530: 6d6f 6428 7365 6c66 2e6d 3432 2c20 6d62  mod(self.m42, mb
-00016540: 2e6d 3432 290a 2020 2020 2020 2020 2020  .m42).          
-00016550: 2020 7265 732e 6d34 3320 3d20 5f66 6d6f    res.m43 = _fmo
-00016560: 6428 7365 6c66 2e6d 3433 2c20 6d62 2e6d  d(self.m43, mb.m
-00016570: 3433 290a 2020 2020 2020 2020 2020 2020  43).            
-00016580: 7265 732e 6d34 3420 3d20 5f66 6d6f 6428  res.m44 = _fmod(
-00016590: 7365 6c66 2e6d 3434 2c20 6d62 2e6d 3434  self.m44, mb.m44
-000165a0: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
-000165b0: 7475 726e 2072 6573 0a0a 2020 2020 2020  turn res..      
-000165c0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-000165d0: 2020 2020 7261 6973 6520 5479 7065 4572      raise TypeEr
-000165e0: 726f 722c 2022 756e 7375 7070 6f72 7465  ror, "unsupporte
-000165f0: 6420 6f70 6572 616e 6420 7479 7065 2066  d operand type f
-00016600: 6f72 2025 220a 0a0a 2020 2020 6465 6620  or %"...    def 
-00016610: 5f5f 6e65 675f 5f28 7365 6c66 293a 0a20  __neg__(self):. 
-00016620: 2020 2020 2020 2022 2222 4e65 6761 7469         """Negati
-00016630: 6f6e 2e0a 0a20 2020 2020 2020 203e 3e3e  on...        >>>
-00016640: 204d 3d6d 6174 3428 312c 322c 332c 342c   M=mat4(1,2,3,4,
-00016650: 352c 362c 372c 382c 392c 3130 2c31 312c  5,6,7,8,9,10,11,
-00016660: 3132 2c31 332c 3134 2c31 352c 3136 290a  12,13,14,15,16).
-00016670: 2020 2020 2020 2020 3e3e 3e20 7072 696e          >>> prin
-00016680: 7420 2d4d 0a20 2020 2020 2020 205b 2020  t -M.        [  
-00016690: 2d31 2e30 3030 302c 2020 202d 322e 3030  -1.0000,   -2.00
-000166a0: 3030 2c20 2020 2d33 2e30 3030 302c 2020  00,   -3.0000,  
-000166b0: 202d 342e 3030 3030 5d0a 2020 2020 2020   -4.0000].      
-000166c0: 2020 5b20 202d 352e 3030 3030 2c20 2020    [  -5.0000,   
-000166d0: 2d36 2e30 3030 302c 2020 202d 372e 3030  -6.0000,   -7.00
-000166e0: 3030 2c20 2020 2d38 2e30 3030 305d 0a20  00,   -8.0000]. 
-000166f0: 2020 2020 2020 205b 2020 2d39 2e30 3030         [  -9.000
-00016700: 302c 2020 2d31 302e 3030 3030 2c20 202d  0,  -10.0000,  -
-00016710: 3131 2e30 3030 302c 2020 2d31 322e 3030  11.0000,  -12.00
-00016720: 3030 5d0a 2020 2020 2020 2020 5b20 2d31  00].        [ -1
-00016730: 332e 3030 3030 2c20 202d 3134 2e30 3030  3.0000,  -14.000
-00016740: 302c 2020 2d31 352e 3030 3030 2c20 202d  0,  -15.0000,  -
-00016750: 3136 2e30 3030 305d 0a20 2020 2020 2020  16.0000].       
-00016760: 2022 2222 0a20 2020 2020 2020 2063 6465   """.        cde
-00016770: 6620 6d61 7434 2072 6573 0a20 2020 2020  f mat4 res.     
-00016780: 2020 2072 6573 203d 206d 6174 3428 290a     res = mat4().
-00016790: 2020 2020 2020 2020 7265 732e 6d31 3120          res.m11 
-000167a0: 3d20 2d73 656c 662e 6d31 310a 2020 2020  = -self.m11.    
-000167b0: 2020 2020 7265 732e 6d31 3220 3d20 2d73      res.m12 = -s
-000167c0: 656c 662e 6d31 320a 2020 2020 2020 2020  elf.m12.        
-000167d0: 7265 732e 6d31 3320 3d20 2d73 656c 662e  res.m13 = -self.
-000167e0: 6d31 330a 2020 2020 2020 2020 7265 732e  m13.        res.
-000167f0: 6d31 3420 3d20 2d73 656c 662e 6d31 340a  m14 = -self.m14.
-00016800: 2020 2020 2020 2020 7265 732e 6d32 3120          res.m21 
-00016810: 3d20 2d73 656c 662e 6d32 310a 2020 2020  = -self.m21.    
-00016820: 2020 2020 7265 732e 6d32 3220 3d20 2d73      res.m22 = -s
-00016830: 656c 662e 6d32 320a 2020 2020 2020 2020  elf.m22.        
-00016840: 7265 732e 6d32 3320 3d20 2d73 656c 662e  res.m23 = -self.
-00016850: 6d32 330a 2020 2020 2020 2020 7265 732e  m23.        res.
-00016860: 6d32 3420 3d20 2d73 656c 662e 6d32 340a  m24 = -self.m24.
-00016870: 2020 2020 2020 2020 7265 732e 6d33 3120          res.m31 
-00016880: 3d20 2d73 656c 662e 6d33 310a 2020 2020  = -self.m31.    
-00016890: 2020 2020 7265 732e 6d33 3220 3d20 2d73      res.m32 = -s
-000168a0: 656c 662e 6d33 320a 2020 2020 2020 2020  elf.m32.        
-000168b0: 7265 732e 6d33 3320 3d20 2d73 656c 662e  res.m33 = -self.
-000168c0: 6d33 330a 2020 2020 2020 2020 7265 732e  m33.        res.
-000168d0: 6d33 3420 3d20 2d73 656c 662e 6d33 340a  m34 = -self.m34.
-000168e0: 2020 2020 2020 2020 7265 732e 6d34 3120          res.m41 
-000168f0: 3d20 2d73 656c 662e 6d34 310a 2020 2020  = -self.m41.    
-00016900: 2020 2020 7265 732e 6d34 3220 3d20 2d73      res.m42 = -s
-00016910: 656c 662e 6d34 320a 2020 2020 2020 2020  elf.m42.        
-00016920: 7265 732e 6d34 3320 3d20 2d73 656c 662e  res.m43 = -self.
-00016930: 6d34 330a 2020 2020 2020 2020 7265 732e  m43.        res.
-00016940: 6d34 3420 3d20 2d73 656c 662e 6d34 340a  m44 = -self.m44.
-00016950: 2020 2020 2020 2020 7265 7475 726e 2072          return r
-00016960: 6573 0a0a 2020 2020 6465 6620 5f5f 706f  es..    def __po
-00016970: 735f 5f28 7365 6c66 293a 0a20 2020 2020  s__(self):.     
-00016980: 2020 2022 2222 0a20 2020 2020 2020 203e     """.        >
-00016990: 3e3e 204d 3d6d 6174 3428 312c 322c 332c  >> M=mat4(1,2,3,
-000169a0: 342c 352c 362c 372c 382c 392c 3130 2c31  4,5,6,7,8,9,10,1
-000169b0: 312c 3132 2c31 332c 3134 2c31 352c 3136  1,12,13,14,15,16
-000169c0: 290a 2020 2020 2020 2020 3e3e 3e20 7072  ).        >>> pr
-000169d0: 696e 7420 2b4d 0a20 2020 2020 2020 205b  int +M.        [
-000169e0: 2020 2031 2e30 3030 302c 2020 2020 322e     1.0000,    2.
-000169f0: 3030 3030 2c20 2020 2033 2e30 3030 302c  0000,    3.0000,
-00016a00: 2020 2020 342e 3030 3030 5d0a 2020 2020      4.0000].    
-00016a10: 2020 2020 5b20 2020 352e 3030 3030 2c20      [   5.0000, 
-00016a20: 2020 2036 2e30 3030 302c 2020 2020 372e     6.0000,    7.
-00016a30: 3030 3030 2c20 2020 2038 2e30 3030 305d  0000,    8.0000]
-00016a40: 0a20 2020 2020 2020 205b 2020 2039 2e30  .        [   9.0
-00016a50: 3030 302c 2020 2031 302e 3030 3030 2c20  000,   10.0000, 
-00016a60: 2020 3131 2e30 3030 302c 2020 2031 322e    11.0000,   12.
-00016a70: 3030 3030 5d0a 2020 2020 2020 2020 5b20  0000].        [ 
-00016a80: 2031 332e 3030 3030 2c20 2020 3134 2e30   13.0000,   14.0
-00016a90: 3030 302c 2020 2031 352e 3030 3030 2c20  000,   15.0000, 
-00016aa0: 2020 3136 2e30 3030 305d 0a20 2020 2020    16.0000].     
-00016ab0: 2020 2022 2222 0a20 2020 2020 2020 2063     """.        c
-00016ac0: 6465 6620 6d61 7434 2072 6573 0a20 2020  def mat4 res.   
-00016ad0: 2020 2020 2072 6573 203d 206d 6174 3428       res = mat4(
-00016ae0: 290a 2020 2020 2020 2020 7265 732e 6d31  ).        res.m1
-00016af0: 3120 3d20 7365 6c66 2e6d 3131 0a20 2020  1 = self.m11.   
-00016b00: 2020 2020 2072 6573 2e6d 3132 203d 2073       res.m12 = s
-00016b10: 656c 662e 6d31 320a 2020 2020 2020 2020  elf.m12.        
-00016b20: 7265 732e 6d31 3320 3d20 7365 6c66 2e6d  res.m13 = self.m
-00016b30: 3133 0a20 2020 2020 2020 2072 6573 2e6d  13.        res.m
-00016b40: 3134 203d 2073 656c 662e 6d31 340a 2020  14 = self.m14.  
-00016b50: 2020 2020 2020 7265 732e 6d32 3120 3d20        res.m21 = 
-00016b60: 7365 6c66 2e6d 3231 0a20 2020 2020 2020  self.m21.       
-00016b70: 2072 6573 2e6d 3232 203d 2073 656c 662e   res.m22 = self.
-00016b80: 6d32 320a 2020 2020 2020 2020 7265 732e  m22.        res.
-00016b90: 6d32 3320 3d20 7365 6c66 2e6d 3233 0a20  m23 = self.m23. 
-00016ba0: 2020 2020 2020 2072 6573 2e6d 3234 203d         res.m24 =
-00016bb0: 2073 656c 662e 6d32 340a 2020 2020 2020   self.m24.      
-00016bc0: 2020 7265 732e 6d33 3120 3d20 7365 6c66    res.m31 = self
-00016bd0: 2e6d 3331 0a20 2020 2020 2020 2072 6573  .m31.        res
-00016be0: 2e6d 3332 203d 2073 656c 662e 6d33 320a  .m32 = self.m32.
-00016bf0: 2020 2020 2020 2020 7265 732e 6d33 3320          res.m33 
-00016c00: 3d20 7365 6c66 2e6d 3333 0a20 2020 2020  = self.m33.     
-00016c10: 2020 2072 6573 2e6d 3334 203d 2073 656c     res.m34 = sel
-00016c20: 662e 6d33 340a 2020 2020 2020 2020 7265  f.m34.        re
-00016c30: 732e 6d34 3120 3d20 7365 6c66 2e6d 3431  s.m41 = self.m41
-00016c40: 0a20 2020 2020 2020 2072 6573 2e6d 3432  .        res.m42
-00016c50: 203d 2073 656c 662e 6d34 320a 2020 2020   = self.m42.    
-00016c60: 2020 2020 7265 732e 6d34 3320 3d20 7365      res.m43 = se
-00016c70: 6c66 2e6d 3433 0a20 2020 2020 2020 2072  lf.m43.        r
-00016c80: 6573 2e6d 3434 203d 2073 656c 662e 6d34  es.m44 = self.m4
-00016c90: 340a 2020 2020 2020 2020 7265 7475 726e  4.        return
-00016ca0: 2072 6573 0a0a 2020 2020 6465 6620 5f5f   res..    def __
-00016cb0: 6961 6464 5f5f 2873 656c 662c 206d 6174  iadd__(self, mat
-00016cc0: 3420 6f74 6865 7229 3a0a 2020 2020 2020  4 other):.      
-00016cd0: 2020 2222 2249 6e6c 696e 6520 6d61 7472    """Inline matr
-00016ce0: 6978 2061 6464 6974 696f 6e2e 0a20 2020  ix addition..   
-00016cf0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00016d00: 2073 656c 662e 6d31 3120 3d20 7365 6c66   self.m11 = self
-00016d10: 2e6d 3131 202b 206f 7468 6572 2e6d 3131  .m11 + other.m11
-00016d20: 0a20 2020 2020 2020 2073 656c 662e 6d31  .        self.m1
-00016d30: 3220 3d20 7365 6c66 2e6d 3132 202b 206f  2 = self.m12 + o
-00016d40: 7468 6572 2e6d 3132 0a20 2020 2020 2020  ther.m12.       
-00016d50: 2073 656c 662e 6d31 3320 3d20 7365 6c66   self.m13 = self
-00016d60: 2e6d 3133 202b 206f 7468 6572 2e6d 3133  .m13 + other.m13
-00016d70: 0a20 2020 2020 2020 2073 656c 662e 6d31  .        self.m1
-00016d80: 3420 3d20 7365 6c66 2e6d 3134 202b 206f  4 = self.m14 + o
-00016d90: 7468 6572 2e6d 3134 0a20 2020 2020 2020  ther.m14.       
-00016da0: 2073 656c 662e 6d32 3120 3d20 7365 6c66   self.m21 = self
-00016db0: 2e6d 3231 202b 206f 7468 6572 2e6d 3231  .m21 + other.m21
-00016dc0: 0a20 2020 2020 2020 2073 656c 662e 6d32  .        self.m2
-00016dd0: 3220 3d20 7365 6c66 2e6d 3232 202b 206f  2 = self.m22 + o
-00016de0: 7468 6572 2e6d 3232 0a20 2020 2020 2020  ther.m22.       
-00016df0: 2073 656c 662e 6d32 3320 3d20 7365 6c66   self.m23 = self
-00016e00: 2e6d 3233 202b 206f 7468 6572 2e6d 3233  .m23 + other.m23
-00016e10: 0a20 2020 2020 2020 2073 656c 662e 6d32  .        self.m2
-00016e20: 3420 3d20 7365 6c66 2e6d 3234 202b 206f  4 = self.m24 + o
-00016e30: 7468 6572 2e6d 3234 0a20 2020 2020 2020  ther.m24.       
-00016e40: 2073 656c 662e 6d33 3120 3d20 7365 6c66   self.m31 = self
-00016e50: 2e6d 3331 202b 206f 7468 6572 2e6d 3331  .m31 + other.m31
-00016e60: 0a20 2020 2020 2020 2073 656c 662e 6d33  .        self.m3
-00016e70: 3220 3d20 7365 6c66 2e6d 3332 202b 206f  2 = self.m32 + o
-00016e80: 7468 6572 2e6d 3332 0a20 2020 2020 2020  ther.m32.       
-00016e90: 2073 656c 662e 6d33 3320 3d20 7365 6c66   self.m33 = self
-00016ea0: 2e6d 3333 202b 206f 7468 6572 2e6d 3333  .m33 + other.m33
-00016eb0: 0a20 2020 2020 2020 2073 656c 662e 6d33  .        self.m3
-00016ec0: 3420 3d20 7365 6c66 2e6d 3334 202b 206f  4 = self.m34 + o
-00016ed0: 7468 6572 2e6d 3334 0a20 2020 2020 2020  ther.m34.       
-00016ee0: 2073 656c 662e 6d34 3120 3d20 7365 6c66   self.m41 = self
-00016ef0: 2e6d 3431 202b 206f 7468 6572 2e6d 3431  .m41 + other.m41
-00016f00: 0a20 2020 2020 2020 2073 656c 662e 6d34  .        self.m4
-00016f10: 3220 3d20 7365 6c66 2e6d 3432 202b 206f  2 = self.m42 + o
-00016f20: 7468 6572 2e6d 3432 0a20 2020 2020 2020  ther.m42.       
-00016f30: 2073 656c 662e 6d34 3320 3d20 7365 6c66   self.m43 = self
-00016f40: 2e6d 3433 202b 206f 7468 6572 2e6d 3433  .m43 + other.m43
-00016f50: 0a20 2020 2020 2020 2073 656c 662e 6d34  .        self.m4
-00016f60: 3420 3d20 7365 6c66 2e6d 3434 202b 206f  4 = self.m44 + o
-00016f70: 7468 6572 2e6d 3434 0a20 2020 2020 2020  ther.m44.       
-00016f80: 2072 6574 7572 6e20 7365 6c66 0a0a 2020   return self..  
-00016f90: 2020 6465 6620 5f5f 6973 7562 5f5f 2873    def __isub__(s
-00016fa0: 656c 662c 206d 6174 3420 6f74 6865 7229  elf, mat4 other)
-00016fb0: 3a0a 2020 2020 2020 2020 2222 2249 6e6c  :.        """Inl
-00016fc0: 696e 6520 6d61 7472 6978 2073 7562 7472  ine matrix subtr
-00016fd0: 6163 7469 6f6e 2e0a 2020 2020 2020 2020  action..        
-00016fe0: 2222 220a 2020 2020 2020 2020 7365 6c66  """.        self
-00016ff0: 2e6d 3131 203d 2073 656c 662e 6d31 3120  .m11 = self.m11 
-00017000: 2d20 6f74 6865 722e 6d31 310a 2020 2020  - other.m11.    
-00017010: 2020 2020 7365 6c66 2e6d 3132 203d 2073      self.m12 = s
-00017020: 656c 662e 6d31 3220 2d20 6f74 6865 722e  elf.m12 - other.
-00017030: 6d31 320a 2020 2020 2020 2020 7365 6c66  m12.        self
-00017040: 2e6d 3133 203d 2073 656c 662e 6d31 3320  .m13 = self.m13 
-00017050: 2d20 6f74 6865 722e 6d31 330a 2020 2020  - other.m13.    
-00017060: 2020 2020 7365 6c66 2e6d 3134 203d 2073      self.m14 = s
-00017070: 656c 662e 6d31 3420 2d20 6f74 6865 722e  elf.m14 - other.
-00017080: 6d31 340a 2020 2020 2020 2020 7365 6c66  m14.        self
-00017090: 2e6d 3231 203d 2073 656c 662e 6d32 3120  .m21 = self.m21 
-000170a0: 2d20 6f74 6865 722e 6d32 310a 2020 2020  - other.m21.    
-000170b0: 2020 2020 7365 6c66 2e6d 3232 203d 2073      self.m22 = s
-000170c0: 656c 662e 6d32 3220 2d20 6f74 6865 722e  elf.m22 - other.
-000170d0: 6d32 320a 2020 2020 2020 2020 7365 6c66  m22.        self
-000170e0: 2e6d 3233 203d 2073 656c 662e 6d32 3320  .m23 = self.m23 
-000170f0: 2d20 6f74 6865 722e 6d32 330a 2020 2020  - other.m23.    
-00017100: 2020 2020 7365 6c66 2e6d 3234 203d 2073      self.m24 = s
-00017110: 656c 662e 6d32 3420 2d20 6f74 6865 722e  elf.m24 - other.
-00017120: 6d32 340a 2020 2020 2020 2020 7365 6c66  m24.        self
-00017130: 2e6d 3331 203d 2073 656c 662e 6d33 3120  .m31 = self.m31 
-00017140: 2d20 6f74 6865 722e 6d33 310a 2020 2020  - other.m31.    
-00017150: 2020 2020 7365 6c66 2e6d 3332 203d 2073      self.m32 = s
-00017160: 656c 662e 6d33 3220 2d20 6f74 6865 722e  elf.m32 - other.
-00017170: 6d33 320a 2020 2020 2020 2020 7365 6c66  m32.        self
-00017180: 2e6d 3333 203d 2073 656c 662e 6d33 3320  .m33 = self.m33 
-00017190: 2d20 6f74 6865 722e 6d33 330a 2020 2020  - other.m33.    
-000171a0: 2020 2020 7365 6c66 2e6d 3334 203d 2073      self.m34 = s
-000171b0: 656c 662e 6d33 3420 2d20 6f74 6865 722e  elf.m34 - other.
-000171c0: 6d33 340a 2020 2020 2020 2020 7365 6c66  m34.        self
-000171d0: 2e6d 3431 203d 2073 656c 662e 6d34 3120  .m41 = self.m41 
-000171e0: 2d20 6f74 6865 722e 6d34 310a 2020 2020  - other.m41.    
-000171f0: 2020 2020 7365 6c66 2e6d 3432 203d 2073      self.m42 = s
-00017200: 656c 662e 6d34 3220 2d20 6f74 6865 722e  elf.m42 - other.
-00017210: 6d34 320a 2020 2020 2020 2020 7365 6c66  m42.        self
-00017220: 2e6d 3433 203d 2073 656c 662e 6d34 3320  .m43 = self.m43 
-00017230: 2d20 6f74 6865 722e 6d34 330a 2020 2020  - other.m43.    
-00017240: 2020 2020 7365 6c66 2e6d 3434 203d 2073      self.m44 = s
-00017250: 656c 662e 6d34 3420 2d20 6f74 6865 722e  elf.m44 - other.
-00017260: 6d34 340a 2020 2020 2020 2020 7265 7475  m44.        retu
-00017270: 726e 2073 656c 660a 0a20 2020 2064 6566  rn self..    def
-00017280: 205f 5f69 6d75 6c5f 5f28 7365 6c66 2c20   __imul__(self, 
-00017290: 6f74 6865 7229 3a0a 2020 2020 2020 2020  other):.        
-000172a0: 2222 2249 6e6c 696e 6520 6d75 6c74 6970  """Inline multip
-000172b0: 6c69 6361 7469 6f6e 2028 7363 616c 6172  lication (scalar
-000172c0: 206f 7220 6d61 7472 6978 292e 0a20 2020   or matrix)..   
-000172d0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-000172e0: 2063 6465 6620 646f 7562 6c65 2072 2c20   cdef double r, 
-000172f0: 612c 622c 632c 640a 2020 2020 2020 2020  a,b,c,d.        
-00017300: 6364 6566 206d 6174 3420 6d62 0a0a 2020  cdef mat4 mb..  
-00017310: 2020 2020 2020 7462 203d 2074 7970 6528        tb = type(
-00017320: 6f74 6865 7229 0a20 2020 2020 2020 2069  other).        i
-00017330: 6620 7462 2069 7320 666c 6f61 7420 6f72  f tb is float or
-00017340: 2074 6220 6973 2069 6e74 206f 7220 7462   tb is int or tb
-00017350: 2069 7320 6c6f 6e67 3a0a 2020 2020 2020   is long:.      
-00017360: 2020 2020 2020 723d 6f74 6865 720a 2020        r=other.  
-00017370: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
-00017380: 3131 203d 2073 656c 662e 6d31 312a 720a  11 = self.m11*r.
-00017390: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000173a0: 2e6d 3132 203d 2073 656c 662e 6d31 322a  .m12 = self.m12*
+00012600: 2020 2073 656c 662e 6d34 3420 3d20 625b     self.m44 = b[
+00012610: 335d 0a20 2020 2020 2020 2020 2020 2020  3].             
+00012620: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00012630: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+00012640: 7365 2054 7970 6545 7272 6f72 2c20 226d  se TypeError, "m
+00012650: 6174 3428 2920 7461 6b65 7320 6174 206d  at4() takes at m
+00012660: 6f73 7420 3136 2061 7267 756d 656e 7473  ost 16 arguments
+00012670: 220a 0a20 2020 2020 2020 2023 2034 2061  "..        # 4 a
+00012680: 7267 756d 656e 7473 2028 636f 6c75 6d6e  rguments (column
+00012690: 7320 6173 2073 6571 7565 6e63 6573 290a  s as sequences).
+000126a0: 2020 2020 2020 2020 656c 6966 2061 7267          elif arg
+000126b0: 6c65 6e3d 3d34 3a0a 2020 2020 2020 2020  len==4:.        
+000126c0: 2020 2020 612c 622c 632c 643d 6172 6773      a,b,c,d=args
+000126d0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+000126e0: 662e 6d31 3120 3d20 615b 305d 0a20 2020  f.m11 = a[0].   
+000126f0: 2020 2020 2020 2020 2073 656c 662e 6d31           self.m1
+00012700: 3220 3d20 625b 305d 0a20 2020 2020 2020  2 = b[0].       
+00012710: 2020 2020 2073 656c 662e 6d31 3320 3d20       self.m13 = 
+00012720: 635b 305d 0a20 2020 2020 2020 2020 2020  c[0].           
+00012730: 2073 656c 662e 6d31 3420 3d20 645b 305d   self.m14 = d[0]
+00012740: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00012750: 662e 6d32 3120 3d20 615b 315d 0a20 2020  f.m21 = a[1].   
+00012760: 2020 2020 2020 2020 2073 656c 662e 6d32           self.m2
+00012770: 3220 3d20 625b 315d 0a20 2020 2020 2020  2 = b[1].       
+00012780: 2020 2020 2073 656c 662e 6d32 3320 3d20       self.m23 = 
+00012790: 635b 315d 0a20 2020 2020 2020 2020 2020  c[1].           
+000127a0: 2073 656c 662e 6d32 3420 3d20 645b 315d   self.m24 = d[1]
+000127b0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+000127c0: 662e 6d33 3120 3d20 615b 325d 0a20 2020  f.m31 = a[2].   
+000127d0: 2020 2020 2020 2020 2073 656c 662e 6d33           self.m3
+000127e0: 3220 3d20 625b 325d 0a20 2020 2020 2020  2 = b[2].       
+000127f0: 2020 2020 2073 656c 662e 6d33 3320 3d20       self.m33 = 
+00012800: 635b 325d 0a20 2020 2020 2020 2020 2020  c[2].           
+00012810: 2073 656c 662e 6d33 3420 3d20 645b 325d   self.m34 = d[2]
+00012820: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00012830: 662e 6d34 3120 3d20 615b 335d 0a20 2020  f.m41 = a[3].   
+00012840: 2020 2020 2020 2020 2073 656c 662e 6d34           self.m4
+00012850: 3220 3d20 625b 335d 0a20 2020 2020 2020  2 = b[3].       
+00012860: 2020 2020 2073 656c 662e 6d34 3320 3d20       self.m43 = 
+00012870: 635b 335d 0a20 2020 2020 2020 2020 2020  c[3].           
+00012880: 2073 656c 662e 6d34 3420 3d20 645b 335d   self.m44 = d[3]
+00012890: 0a0a 2020 2020 2020 2020 2320 3136 2061  ..        # 16 a
+000128a0: 7267 756d 656e 7473 0a20 2020 2020 2020  rguments.       
+000128b0: 2065 6c69 6620 6172 676c 656e 3d3d 3136   elif arglen==16
+000128c0: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
+000128d0: 6c66 2e6d 3131 203d 2061 7267 735b 305d  lf.m11 = args[0]
+000128e0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+000128f0: 662e 6d31 3220 3d20 6172 6773 5b31 5d0a  f.m12 = args[1].
+00012900: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00012910: 2e6d 3133 203d 2061 7267 735b 325d 0a20  .m13 = args[2]. 
+00012920: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00012930: 6d31 3420 3d20 6172 6773 5b33 5d0a 2020  m14 = args[3].  
+00012940: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+00012950: 3231 203d 2061 7267 735b 345d 0a20 2020  21 = args[4].   
+00012960: 2020 2020 2020 2020 2073 656c 662e 6d32           self.m2
+00012970: 3220 3d20 6172 6773 5b35 5d0a 2020 2020  2 = args[5].    
+00012980: 2020 2020 2020 2020 7365 6c66 2e6d 3233          self.m23
+00012990: 203d 2061 7267 735b 365d 0a20 2020 2020   = args[6].     
+000129a0: 2020 2020 2020 2073 656c 662e 6d32 3420         self.m24 
+000129b0: 3d20 6172 6773 5b37 5d0a 2020 2020 2020  = args[7].      
+000129c0: 2020 2020 2020 7365 6c66 2e6d 3331 203d        self.m31 =
+000129d0: 2061 7267 735b 385d 0a20 2020 2020 2020   args[8].       
+000129e0: 2020 2020 2073 656c 662e 6d33 3220 3d20       self.m32 = 
+000129f0: 6172 6773 5b39 5d0a 2020 2020 2020 2020  args[9].        
+00012a00: 2020 2020 7365 6c66 2e6d 3333 203d 2061      self.m33 = a
+00012a10: 7267 735b 3130 5d0a 2020 2020 2020 2020  rgs[10].        
+00012a20: 2020 2020 7365 6c66 2e6d 3334 203d 2061      self.m34 = a
+00012a30: 7267 735b 3131 5d0a 2020 2020 2020 2020  rgs[11].        
+00012a40: 2020 2020 7365 6c66 2e6d 3431 203d 2061      self.m41 = a
+00012a50: 7267 735b 3132 5d0a 2020 2020 2020 2020  rgs[12].        
+00012a60: 2020 2020 7365 6c66 2e6d 3432 203d 2061      self.m42 = a
+00012a70: 7267 735b 3133 5d0a 2020 2020 2020 2020  rgs[13].        
+00012a80: 2020 2020 7365 6c66 2e6d 3433 203d 2061      self.m43 = a
+00012a90: 7267 735b 3134 5d0a 2020 2020 2020 2020  rgs[14].        
+00012aa0: 2020 2020 7365 6c66 2e6d 3434 203d 2061      self.m44 = a
+00012ab0: 7267 735b 3135 5d0a 0a20 2020 2020 2020  rgs[15]..       
+00012ac0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00012ad0: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
+00012ae0: 6f72 2c22 6d61 7434 2829 2061 7267 2063  or,"mat4() arg c
+00012af0: 616e 2774 2062 6520 636f 6e76 6572 7465  an't be converte
+00012b00: 6420 746f 206d 6174 3422 0a0a 2020 2020  d to mat4"..    
+00012b10: 6465 6620 5f5f 7265 6475 6365 5f5f 2873  def __reduce__(s
+00012b20: 656c 6629 3a0a 2020 2020 2020 2020 7265  elf):.        re
+00012b30: 7475 726e 2028 5f6d 6174 3463 6f6e 7374  turn (_mat4const
+00012b40: 7275 6374 2c20 2873 656c 665b 305d 2c20  ruct, (self[0], 
+00012b50: 7365 6c66 5b31 5d2c 2073 656c 665b 325d  self[1], self[2]
+00012b60: 2c20 7365 6c66 5b33 5d29 290a 0a20 2020  , self[3]))..   
+00012b70: 2064 6566 205f 5f72 6570 725f 5f28 7365   def __repr__(se
+00012b80: 6c66 293a 0a20 2020 2020 2020 2072 6574  lf):.        ret
+00012b90: 7572 6e20 276d 6174 3428 2573 2c20 2573  urn 'mat4(%s, %s
+00012ba0: 2c20 2573 2c20 2573 2c20 2573 2c20 2573  , %s, %s, %s, %s
+00012bb0: 2c20 2573 2c20 2573 2c20 2573 2c20 2573  , %s, %s, %s, %s
+00012bc0: 2c20 2573 2c20 2573 2c20 2573 2c20 2573  , %s, %s, %s, %s
+00012bd0: 2c20 2573 2c20 2573 2927 2528 0a20 2020  , %s, %s)'%(.   
+00012be0: 2020 2020 2020 2020 2072 6570 7228 7365           repr(se
+00012bf0: 6c66 2e6d 3131 292c 7265 7072 2873 656c  lf.m11),repr(sel
+00012c00: 662e 6d31 3229 2c72 6570 7228 7365 6c66  f.m12),repr(self
+00012c10: 2e6d 3133 292c 7265 7072 2873 656c 662e  .m13),repr(self.
+00012c20: 6d31 3429 2c0a 2020 2020 2020 2020 2020  m14),.          
+00012c30: 2020 7265 7072 2873 656c 662e 6d32 3129    repr(self.m21)
+00012c40: 2c72 6570 7228 7365 6c66 2e6d 3232 292c  ,repr(self.m22),
+00012c50: 7265 7072 2873 656c 662e 6d32 3329 2c72  repr(self.m23),r
+00012c60: 6570 7228 7365 6c66 2e6d 3234 292c 0a20  epr(self.m24),. 
+00012c70: 2020 2020 2020 2020 2020 2072 6570 7228             repr(
+00012c80: 7365 6c66 2e6d 3331 292c 7265 7072 2873  self.m31),repr(s
+00012c90: 656c 662e 6d33 3229 2c72 6570 7228 7365  elf.m32),repr(se
+00012ca0: 6c66 2e6d 3333 292c 7265 7072 2873 656c  lf.m33),repr(sel
+00012cb0: 662e 6d33 3429 2c0a 2020 2020 2020 2020  f.m34),.        
+00012cc0: 2020 2020 7265 7072 2873 656c 662e 6d34      repr(self.m4
+00012cd0: 3129 2c72 6570 7228 7365 6c66 2e6d 3432  1),repr(self.m42
+00012ce0: 292c 7265 7072 2873 656c 662e 6d34 3329  ),repr(self.m43)
+00012cf0: 2c72 6570 7228 7365 6c66 2e6d 3434 2929  ,repr(self.m44))
+00012d00: 0a0a 2020 2020 6465 6620 5f5f 7374 725f  ..    def __str_
+00012d10: 5f28 7365 6c66 293a 0a20 2020 2020 2020  _(self):.       
+00012d20: 2072 6574 7572 6e20 225b 2539 2e34 662c   return "[%9.4f,
+00012d30: 2025 392e 3466 2c20 2539 2e34 662c 2025   %9.4f, %9.4f, %
+00012d40: 392e 3466 5d5c 6e5b 2539 2e34 662c 2025  9.4f]\n[%9.4f, %
+00012d50: 392e 3466 2c20 2539 2e34 662c 2025 392e  9.4f, %9.4f, %9.
+00012d60: 3466 5d5c 6e5b 2539 2e34 662c 2025 392e  4f]\n[%9.4f, %9.
+00012d70: 3466 2c20 2539 2e34 662c 2025 392e 3466  4f, %9.4f, %9.4f
+00012d80: 5d5c 6e5b 2539 2e34 662c 2025 392e 3466  ]\n[%9.4f, %9.4f
+00012d90: 2c20 2539 2e34 662c 2025 392e 3466 5d22  , %9.4f, %9.4f]"
+00012da0: 2528 0a20 2020 2020 2020 2020 2020 2073  %(.            s
+00012db0: 656c 662e 6d31 312c 2073 656c 662e 6d31  elf.m11, self.m1
+00012dc0: 322c 2073 656c 662e 6d31 332c 2073 656c  2, self.m13, sel
+00012dd0: 662e 6d31 342c 0a20 2020 2020 2020 2020  f.m14,.         
+00012de0: 2020 2073 656c 662e 6d32 312c 2073 656c     self.m21, sel
+00012df0: 662e 6d32 322c 2073 656c 662e 6d32 332c  f.m22, self.m23,
+00012e00: 2073 656c 662e 6d32 342c 0a20 2020 2020   self.m24,.     
+00012e10: 2020 2020 2020 2073 656c 662e 6d33 312c         self.m31,
+00012e20: 2073 656c 662e 6d33 322c 2073 656c 662e   self.m32, self.
+00012e30: 6d33 332c 2073 656c 662e 6d33 342c 0a20  m33, self.m34,. 
+00012e40: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00012e50: 6d34 312c 2073 656c 662e 6d34 322c 2073  m41, self.m42, s
+00012e60: 656c 662e 6d34 332c 2073 656c 662e 6d34  elf.m43, self.m4
+00012e70: 3429 0a0a 2020 2020 6465 6620 5f5f 6974  4)..    def __it
+00012e80: 6572 5f5f 2873 656c 6629 3a0a 2020 2020  er__(self):.    
+00012e90: 2020 2020 7265 7475 726e 206d 6174 3469      return mat4i
+00012ea0: 7465 7228 7365 6c66 290a 0a20 2020 2064  ter(self)..    d
+00012eb0: 6566 205f 5f72 6963 6863 6d70 5f5f 2861  ef __richcmp__(a
+00012ec0: 2c62 2c6f 7029 3a0a 2020 2020 2020 2020  ,b,op):.        
+00012ed0: 6364 6566 206d 6174 3420 6d61 2c20 6d62  cdef mat4 ma, mb
+00012ee0: 0a20 2020 2020 2020 2063 6465 6620 696e  .        cdef in
+00012ef0: 7420 636f 700a 0a20 2020 2020 2020 2063  t cop..        c
+00012f00: 6f70 203d 206f 700a 0a20 2020 2020 2020  op = op..       
+00012f10: 2074 6120 3d20 7479 7065 2861 290a 2020   ta = type(a).  
+00012f20: 2020 2020 2020 7462 203d 2074 7970 6528        tb = type(
+00012f30: 6229 0a20 2020 2020 2020 2069 6620 2874  b).        if (t
+00012f40: 6121 3d6d 6174 3420 6f72 2074 6221 3d6d  a!=mat4 or tb!=m
+00012f50: 6174 3429 3a0a 2020 2020 2020 2020 2020  at4):.          
+00012f60: 2020 6966 2063 6f70 3d3d 333a 0a20 2020    if cop==3:.   
+00012f70: 2020 2020 2020 2020 2020 2020 2072 6574               ret
+00012f80: 7572 6e20 310a 2020 2020 2020 2020 2020  urn 1.          
+00012f90: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00012fa0: 2020 2020 2020 2020 7265 7475 726e 2030          return 0
+00012fb0: 0a0a 2020 2020 2020 2020 6d61 203d 2061  ..        ma = a
+00012fc0: 0a20 2020 2020 2020 206d 6220 3d20 620a  .        mb = b.
+00012fd0: 0a20 2020 2020 2020 2023 203c 0a20 2020  .        # <.   
+00012fe0: 2020 2020 2069 6620 636f 703d 3d30 3a0a       if cop==0:.
+00012ff0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00013000: 726e 2030 0a20 2020 2020 2020 2023 203c  rn 0.        # <
+00013010: 3d0a 2020 2020 2020 2020 656c 6966 2063  =.        elif c
+00013020: 6f70 3d3d 313a 0a20 2020 2020 2020 2020  op==1:.         
+00013030: 2020 2072 6574 7572 6e20 300a 2020 2020     return 0.    
+00013040: 2020 2020 2320 3d3d 0a20 2020 2020 2020      # ==.       
+00013050: 2065 6c69 6620 636f 703d 3d32 3a0a 2020   elif cop==2:.  
+00013060: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00013070: 2028 6661 6273 286d 612e 6d31 312d 6d62   (fabs(ma.m11-mb
+00013080: 2e6d 3131 293c 3d65 7073 2061 6e64 2066  .m11)<=eps and f
+00013090: 6162 7328 6d61 2e6d 3132 2d6d 622e 6d31  abs(ma.m12-mb.m1
+000130a0: 3229 3c3d 6570 7320 616e 640a 2020 2020  2)<=eps and.    
+000130b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000130c0: 6661 6273 286d 612e 6d31 332d 6d62 2e6d  fabs(ma.m13-mb.m
+000130d0: 3133 293c 3d65 7073 2061 6e64 2066 6162  13)<=eps and fab
+000130e0: 7328 6d61 2e6d 3134 2d6d 622e 6d31 3429  s(ma.m14-mb.m14)
+000130f0: 3c3d 6570 7320 616e 640a 2020 2020 2020  <=eps and.      
+00013100: 2020 2020 2020 2020 2020 2020 2020 6661                fa
+00013110: 6273 286d 612e 6d32 312d 6d62 2e6d 3231  bs(ma.m21-mb.m21
+00013120: 293c 3d65 7073 2061 6e64 2066 6162 7328  )<=eps and fabs(
+00013130: 6d61 2e6d 3232 2d6d 622e 6d32 3229 3c3d  ma.m22-mb.m22)<=
+00013140: 6570 7320 616e 640a 2020 2020 2020 2020  eps and.        
+00013150: 2020 2020 2020 2020 2020 2020 6661 6273              fabs
+00013160: 286d 612e 6d32 332d 6d62 2e6d 3233 293c  (ma.m23-mb.m23)<
+00013170: 3d65 7073 2061 6e64 2066 6162 7328 6d61  =eps and fabs(ma
+00013180: 2e6d 3234 2d6d 622e 6d32 3429 3c3d 6570  .m24-mb.m24)<=ep
+00013190: 7320 616e 640a 2020 2020 2020 2020 2020  s and.          
+000131a0: 2020 2020 2020 2020 2020 6661 6273 286d            fabs(m
+000131b0: 612e 6d33 312d 6d62 2e6d 3331 293c 3d65  a.m31-mb.m31)<=e
+000131c0: 7073 2061 6e64 2066 6162 7328 6d61 2e6d  ps and fabs(ma.m
+000131d0: 3332 2d6d 622e 6d33 3229 3c3d 6570 7320  32-mb.m32)<=eps 
+000131e0: 616e 640a 2020 2020 2020 2020 2020 2020  and.            
+000131f0: 2020 2020 2020 2020 6661 6273 286d 612e          fabs(ma.
+00013200: 6d33 332d 6d62 2e6d 3333 293c 3d65 7073  m33-mb.m33)<=eps
+00013210: 2061 6e64 2066 6162 7328 6d61 2e6d 3334   and fabs(ma.m34
+00013220: 2d6d 622e 6d33 3429 3c3d 6570 7320 616e  -mb.m34)<=eps an
+00013230: 640a 2020 2020 2020 2020 2020 2020 2020  d.              
+00013240: 2020 2020 2020 6661 6273 286d 612e 6d34        fabs(ma.m4
+00013250: 312d 6d62 2e6d 3431 293c 3d65 7073 2061  1-mb.m41)<=eps a
+00013260: 6e64 2066 6162 7328 6d61 2e6d 3432 2d6d  nd fabs(ma.m42-m
+00013270: 622e 6d34 3229 3c3d 6570 7320 616e 640a  b.m42)<=eps and.
+00013280: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013290: 2020 2020 6661 6273 286d 612e 6d34 332d      fabs(ma.m43-
+000132a0: 6d62 2e6d 3433 293c 3d65 7073 2061 6e64  mb.m43)<=eps and
+000132b0: 2066 6162 7328 6d61 2e6d 3434 2d6d 622e   fabs(ma.m44-mb.
+000132c0: 6d34 3429 3c3d 6570 7329 0a20 2020 2020  m44)<=eps).     
+000132d0: 2020 2023 2021 3d0a 2020 2020 2020 2020     # !=.        
+000132e0: 656c 6966 2063 6f70 3d3d 333a 0a20 2020  elif cop==3:.   
+000132f0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00013300: 2866 6162 7328 6d61 2e6d 3131 2d6d 622e  (fabs(ma.m11-mb.
+00013310: 6d31 3129 3e65 7073 206f 7220 6661 6273  m11)>eps or fabs
+00013320: 286d 612e 6d31 322d 6d62 2e6d 3132 293e  (ma.m12-mb.m12)>
+00013330: 6570 7320 6f72 0a20 2020 2020 2020 2020  eps or.         
+00013340: 2020 2020 2020 2020 2020 2066 6162 7328             fabs(
+00013350: 6d61 2e6d 3133 2d6d 622e 6d31 3329 3e65  ma.m13-mb.m13)>e
+00013360: 7073 206f 7220 6661 6273 286d 612e 6d31  ps or fabs(ma.m1
+00013370: 342d 6d62 2e6d 3134 293e 6570 7320 6f72  4-mb.m14)>eps or
+00013380: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00013390: 2020 2020 2066 6162 7328 6d61 2e6d 3231       fabs(ma.m21
+000133a0: 2d6d 622e 6d32 3129 3e65 7073 206f 7220  -mb.m21)>eps or 
+000133b0: 6661 6273 286d 612e 6d32 322d 6d62 2e6d  fabs(ma.m22-mb.m
+000133c0: 3232 293e 6570 7320 6f72 0a20 2020 2020  22)>eps or.     
+000133d0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+000133e0: 6162 7328 6d61 2e6d 3233 2d6d 622e 6d32  abs(ma.m23-mb.m2
+000133f0: 3329 3e65 7073 206f 7220 6661 6273 286d  3)>eps or fabs(m
+00013400: 612e 6d32 342d 6d62 2e6d 3234 293e 6570  a.m24-mb.m24)>ep
+00013410: 7320 6f72 0a20 2020 2020 2020 2020 2020  s or.           
+00013420: 2020 2020 2020 2020 2066 6162 7328 6d61           fabs(ma
+00013430: 2e6d 3331 2d6d 622e 6d33 3129 3e65 7073  .m31-mb.m31)>eps
+00013440: 206f 7220 6661 6273 286d 612e 6d33 322d   or fabs(ma.m32-
+00013450: 6d62 2e6d 3332 293e 6570 7320 6f72 0a20  mb.m32)>eps or. 
+00013460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013470: 2020 2066 6162 7328 6d61 2e6d 3333 2d6d     fabs(ma.m33-m
+00013480: 622e 6d33 3329 3e65 7073 206f 7220 6661  b.m33)>eps or fa
+00013490: 6273 286d 612e 6d33 342d 6d62 2e6d 3334  bs(ma.m34-mb.m34
+000134a0: 293e 6570 7320 6f72 0a20 2020 2020 2020  )>eps or.       
+000134b0: 2020 2020 2020 2020 2020 2020 2066 6162               fab
+000134c0: 7328 6d61 2e6d 3431 2d6d 622e 6d34 3129  s(ma.m41-mb.m41)
+000134d0: 3e65 7073 206f 7220 6661 6273 286d 612e  >eps or fabs(ma.
+000134e0: 6d34 322d 6d62 2e6d 3432 293e 6570 7320  m42-mb.m42)>eps 
+000134f0: 6f72 0a20 2020 2020 2020 2020 2020 2020  or.             
+00013500: 2020 2020 2020 2066 6162 7328 6d61 2e6d         fabs(ma.m
+00013510: 3433 2d6d 622e 6d34 3329 3e65 7073 206f  43-mb.m43)>eps o
+00013520: 7220 6661 6273 286d 612e 6d34 342d 6d62  r fabs(ma.m44-mb
+00013530: 2e6d 3434 293e 6570 7329 0a20 2020 2020  .m44)>eps).     
+00013540: 2020 2023 203e 0a20 2020 2020 2020 2065     # >.        e
+00013550: 6c69 6620 636f 703d 3d34 3a0a 2020 2020  lif cop==4:.    
+00013560: 2020 2020 2020 2020 7265 7475 726e 2030          return 0
+00013570: 0a20 2020 2020 2020 2023 203e 3d0a 2020  .        # >=.  
+00013580: 2020 2020 2020 656c 6966 2063 6f70 3d3d        elif cop==
+00013590: 353a 0a20 2020 2020 2020 2020 2020 2072  5:.            r
+000135a0: 6574 7572 6e20 300a 2020 2020 2020 2020  eturn 0.        
+000135b0: 2320 736f 6e73 7420 2846 6568 6c65 7229  # sonst (Fehler)
+000135c0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+000135d0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+000135e0: 2056 616c 7565 4572 726f 722c 2269 6e74   ValueError,"int
+000135f0: 6572 6e61 6c20 6572 726f 723a 2069 6c6c  ernal error: ill
+00013600: 6567 616c 2072 6963 6820 636f 6d70 6172  egal rich compar
+00013610: 6973 6f6e 206e 756d 6265 7222 0a0a 0a20  ison number"... 
+00013620: 2020 2064 6566 205f 5f61 6464 5f5f 286d     def __add__(m
+00013630: 6174 3420 612c 206d 6174 3420 6229 3a0a  at4 a, mat4 b):.
+00013640: 2020 2020 2020 2020 2222 224d 6174 7269          """Matri
+00013650: 7820 6164 6469 7469 6f6e 2e0a 0a20 2020  x addition...   
+00013660: 2020 2020 203e 3e3e 204d 3d6d 6174 3428       >>> M=mat4(
+00013670: 312c 322c 332c 342c 352c 362c 372c 382c  1,2,3,4,5,6,7,8,
+00013680: 392c 3130 2c31 312c 3132 2c31 332c 3134  9,10,11,12,13,14
+00013690: 2c31 352c 3136 290a 2020 2020 2020 2020  ,15,16).        
+000136a0: 3e3e 3e20 7072 696e 7428 4d2b 4d29 0a20  >>> print(M+M). 
+000136b0: 2020 2020 2020 205b 2020 2032 2e30 3030         [   2.000
+000136c0: 302c 2020 2020 342e 3030 3030 2c20 2020  0,    4.0000,   
+000136d0: 2036 2e30 3030 302c 2020 2020 382e 3030   6.0000,    8.00
+000136e0: 3030 5d0a 2020 2020 2020 2020 5b20 2031  00].        [  1
+000136f0: 302e 3030 3030 2c20 2020 3132 2e30 3030  0.0000,   12.000
+00013700: 302c 2020 2031 342e 3030 3030 2c20 2020  0,   14.0000,   
+00013710: 3136 2e30 3030 305d 0a20 2020 2020 2020  16.0000].       
+00013720: 205b 2020 3138 2e30 3030 302c 2020 2032   [  18.0000,   2
+00013730: 302e 3030 3030 2c20 2020 3232 2e30 3030  0.0000,   22.000
+00013740: 302c 2020 2032 342e 3030 3030 5d0a 2020  0,   24.0000].  
+00013750: 2020 2020 2020 5b20 2032 362e 3030 3030        [  26.0000
+00013760: 2c20 2020 3238 2e30 3030 302c 2020 2033  ,   28.0000,   3
+00013770: 302e 3030 3030 2c20 2020 3332 2e30 3030  0.0000,   32.000
+00013780: 305d 0a20 2020 2020 2020 2022 2222 0a20  0].        """. 
+00013790: 2020 2020 2020 2063 6465 6620 6d61 7434         cdef mat4
+000137a0: 2072 6573 0a20 2020 2020 2020 2072 6573   res.        res
+000137b0: 203d 206d 6174 3428 290a 2020 2020 2020   = mat4().      
+000137c0: 2020 7265 732e 6d31 3120 3d20 612e 6d31    res.m11 = a.m1
+000137d0: 3120 2b20 622e 6d31 310a 2020 2020 2020  1 + b.m11.      
+000137e0: 2020 7265 732e 6d31 3220 3d20 612e 6d31    res.m12 = a.m1
+000137f0: 3220 2b20 622e 6d31 320a 2020 2020 2020  2 + b.m12.      
+00013800: 2020 7265 732e 6d31 3320 3d20 612e 6d31    res.m13 = a.m1
+00013810: 3320 2b20 622e 6d31 330a 2020 2020 2020  3 + b.m13.      
+00013820: 2020 7265 732e 6d31 3420 3d20 612e 6d31    res.m14 = a.m1
+00013830: 3420 2b20 622e 6d31 340a 2020 2020 2020  4 + b.m14.      
+00013840: 2020 7265 732e 6d32 3120 3d20 612e 6d32    res.m21 = a.m2
+00013850: 3120 2b20 622e 6d32 310a 2020 2020 2020  1 + b.m21.      
+00013860: 2020 7265 732e 6d32 3220 3d20 612e 6d32    res.m22 = a.m2
+00013870: 3220 2b20 622e 6d32 320a 2020 2020 2020  2 + b.m22.      
+00013880: 2020 7265 732e 6d32 3320 3d20 612e 6d32    res.m23 = a.m2
+00013890: 3320 2b20 622e 6d32 330a 2020 2020 2020  3 + b.m23.      
+000138a0: 2020 7265 732e 6d32 3420 3d20 612e 6d32    res.m24 = a.m2
+000138b0: 3420 2b20 622e 6d32 340a 2020 2020 2020  4 + b.m24.      
+000138c0: 2020 7265 732e 6d33 3120 3d20 612e 6d33    res.m31 = a.m3
+000138d0: 3120 2b20 622e 6d33 310a 2020 2020 2020  1 + b.m31.      
+000138e0: 2020 7265 732e 6d33 3220 3d20 612e 6d33    res.m32 = a.m3
+000138f0: 3220 2b20 622e 6d33 320a 2020 2020 2020  2 + b.m32.      
+00013900: 2020 7265 732e 6d33 3320 3d20 612e 6d33    res.m33 = a.m3
+00013910: 3320 2b20 622e 6d33 330a 2020 2020 2020  3 + b.m33.      
+00013920: 2020 7265 732e 6d33 3420 3d20 612e 6d33    res.m34 = a.m3
+00013930: 3420 2b20 622e 6d33 340a 2020 2020 2020  4 + b.m34.      
+00013940: 2020 7265 732e 6d34 3120 3d20 612e 6d34    res.m41 = a.m4
+00013950: 3120 2b20 622e 6d34 310a 2020 2020 2020  1 + b.m41.      
+00013960: 2020 7265 732e 6d34 3220 3d20 612e 6d34    res.m42 = a.m4
+00013970: 3220 2b20 622e 6d34 320a 2020 2020 2020  2 + b.m42.      
+00013980: 2020 7265 732e 6d34 3320 3d20 612e 6d34    res.m43 = a.m4
+00013990: 3320 2b20 622e 6d34 330a 2020 2020 2020  3 + b.m43.      
+000139a0: 2020 7265 732e 6d34 3420 3d20 612e 6d34    res.m44 = a.m4
+000139b0: 3420 2b20 622e 6d34 340a 2020 2020 2020  4 + b.m44.      
+000139c0: 2020 7265 7475 726e 2072 6573 0a0a 2020    return res..  
+000139d0: 2020 6465 6620 5f5f 7375 625f 5f28 6d61    def __sub__(ma
+000139e0: 7434 2061 2c20 6d61 7434 2062 293a 0a20  t4 a, mat4 b):. 
+000139f0: 2020 2020 2020 2022 2222 4d61 7472 6978         """Matrix
+00013a00: 2073 7562 7472 6163 7469 6f6e 2e0a 0a20   subtraction... 
+00013a10: 2020 2020 2020 203e 3e3e 204d 3d6d 6174         >>> M=mat
+00013a20: 3428 312c 322c 332c 342c 352c 362c 372c  4(1,2,3,4,5,6,7,
+00013a30: 382c 392c 3130 2c31 312c 3132 2c31 332c  8,9,10,11,12,13,
+00013a40: 3134 2c31 352c 3136 290a 2020 2020 2020  14,15,16).      
+00013a50: 2020 3e3e 3e20 7072 696e 7428 4d2d 4d29    >>> print(M-M)
+00013a60: 0a20 2020 2020 2020 205b 2020 2030 2e30  .        [   0.0
+00013a70: 3030 302c 2020 2020 302e 3030 3030 2c20  000,    0.0000, 
+00013a80: 2020 2030 2e30 3030 302c 2020 2020 302e     0.0000,    0.
+00013a90: 3030 3030 5d0a 2020 2020 2020 2020 5b20  0000].        [ 
+00013aa0: 2020 302e 3030 3030 2c20 2020 2030 2e30    0.0000,    0.0
+00013ab0: 3030 302c 2020 2020 302e 3030 3030 2c20  000,    0.0000, 
+00013ac0: 2020 2030 2e30 3030 305d 0a20 2020 2020     0.0000].     
+00013ad0: 2020 205b 2020 2030 2e30 3030 302c 2020     [   0.0000,  
+00013ae0: 2020 302e 3030 3030 2c20 2020 2030 2e30    0.0000,    0.0
+00013af0: 3030 302c 2020 2020 302e 3030 3030 5d0a  000,    0.0000].
+00013b00: 2020 2020 2020 2020 5b20 2020 302e 3030          [   0.00
+00013b10: 3030 2c20 2020 2030 2e30 3030 302c 2020  00,    0.0000,  
+00013b20: 2020 302e 3030 3030 2c20 2020 2030 2e30    0.0000,    0.0
+00013b30: 3030 305d 0a20 2020 2020 2020 2022 2222  000].        """
+00013b40: 0a20 2020 2020 2020 2063 6465 6620 6d61  .        cdef ma
+00013b50: 7434 2072 6573 0a20 2020 2020 2020 2072  t4 res.        r
+00013b60: 6573 203d 206d 6174 3428 290a 2020 2020  es = mat4().    
+00013b70: 2020 2020 7265 732e 6d31 3120 3d20 612e      res.m11 = a.
+00013b80: 6d31 3120 2d20 622e 6d31 310a 2020 2020  m11 - b.m11.    
+00013b90: 2020 2020 7265 732e 6d31 3220 3d20 612e      res.m12 = a.
+00013ba0: 6d31 3220 2d20 622e 6d31 320a 2020 2020  m12 - b.m12.    
+00013bb0: 2020 2020 7265 732e 6d31 3320 3d20 612e      res.m13 = a.
+00013bc0: 6d31 3320 2d20 622e 6d31 330a 2020 2020  m13 - b.m13.    
+00013bd0: 2020 2020 7265 732e 6d31 3420 3d20 612e      res.m14 = a.
+00013be0: 6d31 3420 2d20 622e 6d31 340a 2020 2020  m14 - b.m14.    
+00013bf0: 2020 2020 7265 732e 6d32 3120 3d20 612e      res.m21 = a.
+00013c00: 6d32 3120 2d20 622e 6d32 310a 2020 2020  m21 - b.m21.    
+00013c10: 2020 2020 7265 732e 6d32 3220 3d20 612e      res.m22 = a.
+00013c20: 6d32 3220 2d20 622e 6d32 320a 2020 2020  m22 - b.m22.    
+00013c30: 2020 2020 7265 732e 6d32 3320 3d20 612e      res.m23 = a.
+00013c40: 6d32 3320 2d20 622e 6d32 330a 2020 2020  m23 - b.m23.    
+00013c50: 2020 2020 7265 732e 6d32 3420 3d20 612e      res.m24 = a.
+00013c60: 6d32 3420 2d20 622e 6d32 340a 2020 2020  m24 - b.m24.    
+00013c70: 2020 2020 7265 732e 6d33 3120 3d20 612e      res.m31 = a.
+00013c80: 6d33 3120 2d20 622e 6d33 310a 2020 2020  m31 - b.m31.    
+00013c90: 2020 2020 7265 732e 6d33 3220 3d20 612e      res.m32 = a.
+00013ca0: 6d33 3220 2d20 622e 6d33 320a 2020 2020  m32 - b.m32.    
+00013cb0: 2020 2020 7265 732e 6d33 3320 3d20 612e      res.m33 = a.
+00013cc0: 6d33 3320 2d20 622e 6d33 330a 2020 2020  m33 - b.m33.    
+00013cd0: 2020 2020 7265 732e 6d33 3420 3d20 612e      res.m34 = a.
+00013ce0: 6d33 3420 2d20 622e 6d33 340a 2020 2020  m34 - b.m34.    
+00013cf0: 2020 2020 7265 732e 6d34 3120 3d20 612e      res.m41 = a.
+00013d00: 6d34 3120 2d20 622e 6d34 310a 2020 2020  m41 - b.m41.    
+00013d10: 2020 2020 7265 732e 6d34 3220 3d20 612e      res.m42 = a.
+00013d20: 6d34 3220 2d20 622e 6d34 320a 2020 2020  m42 - b.m42.    
+00013d30: 2020 2020 7265 732e 6d34 3320 3d20 612e      res.m43 = a.
+00013d40: 6d34 3320 2d20 622e 6d34 330a 2020 2020  m43 - b.m43.    
+00013d50: 2020 2020 7265 732e 6d34 3420 3d20 612e      res.m44 = a.
+00013d60: 6d34 3420 2d20 622e 6d34 340a 2020 2020  m44 - b.m44.    
+00013d70: 2020 2020 7265 7475 726e 2072 6573 0a0a      return res..
+00013d80: 2020 2020 6465 6620 5f5f 6d75 6c5f 5f28      def __mul__(
+00013d90: 612c 2062 293a 0a20 2020 2020 2020 2022  a, b):.        "
+00013da0: 2222 4d75 6c74 6970 6c69 6361 7469 6f6e  ""Multiplication
+00013db0: 2e0a 0a20 2020 2020 2020 203e 3e3e 204d  ...        >>> M
+00013dc0: 3d6d 6174 3428 312c 322c 332c 342c 352c  =mat4(1,2,3,4,5,
+00013dd0: 362c 372c 382c 392c 3130 2c31 312c 3132  6,7,8,9,10,11,12
+00013de0: 2c31 332c 3134 2c31 352c 3136 290a 2020  ,13,14,15,16).  
+00013df0: 2020 2020 2020 3e3e 3e20 7072 696e 7428        >>> print(
+00013e00: 4d2a 322e 3029 0a20 2020 2020 2020 205b  M*2.0).        [
+00013e10: 2020 2032 2e30 3030 302c 2020 2020 342e     2.0000,    4.
+00013e20: 3030 3030 2c20 2020 2036 2e30 3030 302c  0000,    6.0000,
+00013e30: 2020 2020 382e 3030 3030 5d0a 2020 2020      8.0000].    
+00013e40: 2020 2020 5b20 2031 302e 3030 3030 2c20      [  10.0000, 
+00013e50: 2020 3132 2e30 3030 302c 2020 2031 342e    12.0000,   14.
+00013e60: 3030 3030 2c20 2020 3136 2e30 3030 305d  0000,   16.0000]
+00013e70: 0a20 2020 2020 2020 205b 2020 3138 2e30  .        [  18.0
+00013e80: 3030 302c 2020 2032 302e 3030 3030 2c20  000,   20.0000, 
+00013e90: 2020 3232 2e30 3030 302c 2020 2032 342e    22.0000,   24.
+00013ea0: 3030 3030 5d0a 2020 2020 2020 2020 5b20  0000].        [ 
+00013eb0: 2032 362e 3030 3030 2c20 2020 3238 2e30   26.0000,   28.0
+00013ec0: 3030 302c 2020 2033 302e 3030 3030 2c20  000,   30.0000, 
+00013ed0: 2020 3332 2e30 3030 305d 0a20 2020 2020    32.0000].     
+00013ee0: 2020 203e 3e3e 2070 7269 6e74 2832 2e30     >>> print(2.0
+00013ef0: 2a4d 290a 2020 2020 2020 2020 5b20 2020  *M).        [   
+00013f00: 322e 3030 3030 2c20 2020 2034 2e30 3030  2.0000,    4.000
+00013f10: 302c 2020 2020 362e 3030 3030 2c20 2020  0,    6.0000,   
+00013f20: 2038 2e30 3030 305d 0a20 2020 2020 2020   8.0000].       
+00013f30: 205b 2020 3130 2e30 3030 302c 2020 2031   [  10.0000,   1
+00013f40: 322e 3030 3030 2c20 2020 3134 2e30 3030  2.0000,   14.000
+00013f50: 302c 2020 2031 362e 3030 3030 5d0a 2020  0,   16.0000].  
+00013f60: 2020 2020 2020 5b20 2031 382e 3030 3030        [  18.0000
+00013f70: 2c20 2020 3230 2e30 3030 302c 2020 2032  ,   20.0000,   2
+00013f80: 322e 3030 3030 2c20 2020 3234 2e30 3030  2.0000,   24.000
+00013f90: 305d 0a20 2020 2020 2020 205b 2020 3236  0].        [  26
+00013fa0: 2e30 3030 302c 2020 2032 382e 3030 3030  .0000,   28.0000
+00013fb0: 2c20 2020 3330 2e30 3030 302c 2020 2033  ,   30.0000,   3
+00013fc0: 322e 3030 3030 5d0a 2020 2020 2020 2020  2.0000].        
+00013fd0: 3e3e 3e20 7072 696e 7428 4d2a 4d29 0a20  >>> print(M*M). 
+00013fe0: 2020 2020 2020 205b 2020 3930 2e30 3030         [  90.000
+00013ff0: 302c 2020 3130 302e 3030 3030 2c20 2031  0,  100.0000,  1
+00014000: 3130 2e30 3030 302c 2020 3132 302e 3030  10.0000,  120.00
+00014010: 3030 5d0a 2020 2020 2020 2020 5b20 3230  00].        [ 20
+00014020: 322e 3030 3030 2c20 2032 3238 2e30 3030  2.0000,  228.000
+00014030: 302c 2020 3235 342e 3030 3030 2c20 2032  0,  254.0000,  2
+00014040: 3830 2e30 3030 305d 0a20 2020 2020 2020  80.0000].       
+00014050: 205b 2033 3134 2e30 3030 302c 2020 3335   [ 314.0000,  35
+00014060: 362e 3030 3030 2c20 2033 3938 2e30 3030  6.0000,  398.000
+00014070: 302c 2020 3434 302e 3030 3030 5d0a 2020  0,  440.0000].  
+00014080: 2020 2020 2020 5b20 3432 362e 3030 3030        [ 426.0000
+00014090: 2c20 2034 3834 2e30 3030 302c 2020 3534  ,  484.0000,  54
+000140a0: 322e 3030 3030 2c20 2036 3030 2e30 3030  2.0000,  600.000
+000140b0: 305d 0a20 2020 2020 2020 203e 3e3e 2070  0].        >>> p
+000140c0: 7269 6e74 284d 2a5f 7665 6333 2831 2c32  rint(M*_vec3(1,2
+000140d0: 2c33 2929 0a20 2020 2020 2020 2028 302e  ,3)).        (0.
+000140e0: 3137 3635 2c20 302e 3435 3130 2c20 302e  1765, 0.4510, 0.
+000140f0: 3732 3535 290a 2020 2020 2020 2020 3e3e  7255).        >>
+00014100: 3e20 7072 696e 7428 5f76 6563 3328 312c  > print(_vec3(1,
+00014110: 322c 3329 2a4d 290a 2020 2020 2020 2020  2,3)*M).        
+00014120: 2830 2e37 3038 332c 2030 2e38 3035 362c  (0.7083, 0.8056,
+00014130: 2030 2e39 3032 3829 0a20 2020 2020 2020   0.9028).       
+00014140: 2022 2222 0a20 2020 2020 2020 2063 6465   """.        cde
+00014150: 6620 6d61 7434 206d 612c 206d 622c 2072  f mat4 ma, mb, r
+00014160: 6573 0a20 2020 2020 2020 2063 6465 6620  es.        cdef 
+00014170: 7665 6333 2076 612c 2076 622c 2076 7265  vec3 va, vb, vre
+00014180: 730a 2020 2020 2020 2020 6364 6566 2076  s.        cdef v
+00014190: 6563 3420 7761 2c20 7762 2c20 7772 6573  ec4 wa, wb, wres
+000141a0: 0a20 2020 2020 2020 2063 6465 6620 646f  .        cdef do
+000141b0: 7562 6c65 2072 2c20 770a 0a20 2020 2020  uble r, w..     
+000141c0: 2020 2074 6120 3d20 7479 7065 2861 290a     ta = type(a).
+000141d0: 2020 2020 2020 2020 7462 203d 2074 7970          tb = typ
+000141e0: 6528 6229 0a0a 2020 2020 2020 2020 2320  e(b)..        # 
+000141f0: 6d61 7434 206f 6e20 7468 6520 6c65 6674  mat4 on the left
+00014200: 3f0a 2020 2020 2020 2020 6966 2074 6120  ?.        if ta 
+00014210: 6973 206d 6174 343a 0a20 2020 2020 2020  is mat4:.       
+00014220: 2020 2020 206d 6120 3d20 610a 2020 2020       ma = a.    
+00014230: 2020 2020 2020 2020 2320 6d61 7434 206f          # mat4 o
+00014240: 6e20 7468 6520 7269 6768 743f 0a20 2020  n the right?.   
+00014250: 2020 2020 2020 2020 2069 6620 7462 2069           if tb i
+00014260: 7320 6d61 7434 3a0a 2020 2020 2020 2020  s mat4:.        
+00014270: 2020 2020 2020 2020 2320 6d61 7434 2a6d          # mat4*m
+00014280: 6174 340a 2020 2020 2020 2020 2020 2020  at4.            
+00014290: 2020 2020 7265 7320 3d20 6d61 7434 2829      res = mat4()
+000142a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000142b0: 206d 6220 3d20 620a 2020 2020 2020 2020   mb = b.        
+000142c0: 2020 2020 2020 2020 7265 732e 6d31 3120          res.m11 
+000142d0: 3d20 6d61 2e6d 3131 2a6d 622e 6d31 312b  = ma.m11*mb.m11+
+000142e0: 6d61 2e6d 3132 2a6d 622e 6d32 312b 6d61  ma.m12*mb.m21+ma
+000142f0: 2e6d 3133 2a6d 622e 6d33 312b 6d61 2e6d  .m13*mb.m31+ma.m
+00014300: 3134 2a6d 622e 6d34 310a 2020 2020 2020  14*mb.m41.      
+00014310: 2020 2020 2020 2020 2020 7265 732e 6d31            res.m1
+00014320: 3220 3d20 6d61 2e6d 3131 2a6d 622e 6d31  2 = ma.m11*mb.m1
+00014330: 322b 6d61 2e6d 3132 2a6d 622e 6d32 322b  2+ma.m12*mb.m22+
+00014340: 6d61 2e6d 3133 2a6d 622e 6d33 322b 6d61  ma.m13*mb.m32+ma
+00014350: 2e6d 3134 2a6d 622e 6d34 320a 2020 2020  .m14*mb.m42.    
+00014360: 2020 2020 2020 2020 2020 2020 7265 732e              res.
+00014370: 6d31 3320 3d20 6d61 2e6d 3131 2a6d 622e  m13 = ma.m11*mb.
+00014380: 6d31 332b 6d61 2e6d 3132 2a6d 622e 6d32  m13+ma.m12*mb.m2
+00014390: 332b 6d61 2e6d 3133 2a6d 622e 6d33 332b  3+ma.m13*mb.m33+
+000143a0: 6d61 2e6d 3134 2a6d 622e 6d34 330a 2020  ma.m14*mb.m43.  
+000143b0: 2020 2020 2020 2020 2020 2020 2020 7265                re
+000143c0: 732e 6d31 3420 3d20 6d61 2e6d 3131 2a6d  s.m14 = ma.m11*m
+000143d0: 622e 6d31 342b 6d61 2e6d 3132 2a6d 622e  b.m14+ma.m12*mb.
+000143e0: 6d32 342b 6d61 2e6d 3133 2a6d 622e 6d33  m24+ma.m13*mb.m3
+000143f0: 342b 6d61 2e6d 3134 2a6d 622e 6d34 340a  4+ma.m14*mb.m44.
+00014400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014410: 7265 732e 6d32 3120 3d20 6d61 2e6d 3231  res.m21 = ma.m21
+00014420: 2a6d 622e 6d31 312b 6d61 2e6d 3232 2a6d  *mb.m11+ma.m22*m
+00014430: 622e 6d32 312b 6d61 2e6d 3233 2a6d 622e  b.m21+ma.m23*mb.
+00014440: 6d33 312b 6d61 2e6d 3234 2a6d 622e 6d34  m31+ma.m24*mb.m4
+00014450: 310a 2020 2020 2020 2020 2020 2020 2020  1.              
+00014460: 2020 7265 732e 6d32 3220 3d20 6d61 2e6d    res.m22 = ma.m
+00014470: 3231 2a6d 622e 6d31 322b 6d61 2e6d 3232  21*mb.m12+ma.m22
+00014480: 2a6d 622e 6d32 322b 6d61 2e6d 3233 2a6d  *mb.m22+ma.m23*m
+00014490: 622e 6d33 322b 6d61 2e6d 3234 2a6d 622e  b.m32+ma.m24*mb.
+000144a0: 6d34 320a 2020 2020 2020 2020 2020 2020  m42.            
+000144b0: 2020 2020 7265 732e 6d32 3320 3d20 6d61      res.m23 = ma
+000144c0: 2e6d 3231 2a6d 622e 6d31 332b 6d61 2e6d  .m21*mb.m13+ma.m
+000144d0: 3232 2a6d 622e 6d32 332b 6d61 2e6d 3233  22*mb.m23+ma.m23
+000144e0: 2a6d 622e 6d33 332b 6d61 2e6d 3234 2a6d  *mb.m33+ma.m24*m
+000144f0: 622e 6d34 330a 2020 2020 2020 2020 2020  b.m43.          
+00014500: 2020 2020 2020 7265 732e 6d32 3420 3d20        res.m24 = 
+00014510: 6d61 2e6d 3231 2a6d 622e 6d31 342b 6d61  ma.m21*mb.m14+ma
+00014520: 2e6d 3232 2a6d 622e 6d32 342b 6d61 2e6d  .m22*mb.m24+ma.m
+00014530: 3233 2a6d 622e 6d33 342b 6d61 2e6d 3234  23*mb.m34+ma.m24
+00014540: 2a6d 622e 6d34 340a 2020 2020 2020 2020  *mb.m44.        
+00014550: 2020 2020 2020 2020 7265 732e 6d33 3120          res.m31 
+00014560: 3d20 6d61 2e6d 3331 2a6d 622e 6d31 312b  = ma.m31*mb.m11+
+00014570: 6d61 2e6d 3332 2a6d 622e 6d32 312b 6d61  ma.m32*mb.m21+ma
+00014580: 2e6d 3333 2a6d 622e 6d33 312b 6d61 2e6d  .m33*mb.m31+ma.m
+00014590: 3334 2a6d 622e 6d34 310a 2020 2020 2020  34*mb.m41.      
+000145a0: 2020 2020 2020 2020 2020 7265 732e 6d33            res.m3
+000145b0: 3220 3d20 6d61 2e6d 3331 2a6d 622e 6d31  2 = ma.m31*mb.m1
+000145c0: 322b 6d61 2e6d 3332 2a6d 622e 6d32 322b  2+ma.m32*mb.m22+
+000145d0: 6d61 2e6d 3333 2a6d 622e 6d33 322b 6d61  ma.m33*mb.m32+ma
+000145e0: 2e6d 3334 2a6d 622e 6d34 320a 2020 2020  .m34*mb.m42.    
+000145f0: 2020 2020 2020 2020 2020 2020 7265 732e              res.
+00014600: 6d33 3320 3d20 6d61 2e6d 3331 2a6d 622e  m33 = ma.m31*mb.
+00014610: 6d31 332b 6d61 2e6d 3332 2a6d 622e 6d32  m13+ma.m32*mb.m2
+00014620: 332b 6d61 2e6d 3333 2a6d 622e 6d33 332b  3+ma.m33*mb.m33+
+00014630: 6d61 2e6d 3334 2a6d 622e 6d34 330a 2020  ma.m34*mb.m43.  
+00014640: 2020 2020 2020 2020 2020 2020 2020 7265                re
+00014650: 732e 6d33 3420 3d20 6d61 2e6d 3331 2a6d  s.m34 = ma.m31*m
+00014660: 622e 6d31 342b 6d61 2e6d 3332 2a6d 622e  b.m14+ma.m32*mb.
+00014670: 6d32 342b 6d61 2e6d 3333 2a6d 622e 6d33  m24+ma.m33*mb.m3
+00014680: 342b 6d61 2e6d 3334 2a6d 622e 6d34 340a  4+ma.m34*mb.m44.
+00014690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000146a0: 7265 732e 6d34 3120 3d20 6d61 2e6d 3431  res.m41 = ma.m41
+000146b0: 2a6d 622e 6d31 312b 6d61 2e6d 3432 2a6d  *mb.m11+ma.m42*m
+000146c0: 622e 6d32 312b 6d61 2e6d 3433 2a6d 622e  b.m21+ma.m43*mb.
+000146d0: 6d33 312b 6d61 2e6d 3434 2a6d 622e 6d34  m31+ma.m44*mb.m4
+000146e0: 310a 2020 2020 2020 2020 2020 2020 2020  1.              
+000146f0: 2020 7265 732e 6d34 3220 3d20 6d61 2e6d    res.m42 = ma.m
+00014700: 3431 2a6d 622e 6d31 322b 6d61 2e6d 3432  41*mb.m12+ma.m42
+00014710: 2a6d 622e 6d32 322b 6d61 2e6d 3433 2a6d  *mb.m22+ma.m43*m
+00014720: 622e 6d33 322b 6d61 2e6d 3434 2a6d 622e  b.m32+ma.m44*mb.
+00014730: 6d34 320a 2020 2020 2020 2020 2020 2020  m42.            
+00014740: 2020 2020 7265 732e 6d34 3320 3d20 6d61      res.m43 = ma
+00014750: 2e6d 3431 2a6d 622e 6d31 332b 6d61 2e6d  .m41*mb.m13+ma.m
+00014760: 3432 2a6d 622e 6d32 332b 6d61 2e6d 3433  42*mb.m23+ma.m43
+00014770: 2a6d 622e 6d33 332b 6d61 2e6d 3434 2a6d  *mb.m33+ma.m44*m
+00014780: 622e 6d34 330a 2020 2020 2020 2020 2020  b.m43.          
+00014790: 2020 2020 2020 7265 732e 6d34 3420 3d20        res.m44 = 
+000147a0: 6d61 2e6d 3431 2a6d 622e 6d31 342b 6d61  ma.m41*mb.m14+ma
+000147b0: 2e6d 3432 2a6d 622e 6d32 342b 6d61 2e6d  .m42*mb.m24+ma.m
+000147c0: 3433 2a6d 622e 6d33 342b 6d61 2e6d 3434  43*mb.m34+ma.m44
+000147d0: 2a6d 622e 6d34 340a 2020 2020 2020 2020  *mb.m44.        
+000147e0: 2020 2020 2020 2020 7265 7475 726e 2072          return r
+000147f0: 6573 0a20 2020 2020 2020 2020 2020 2023  es.            #
+00014800: 2076 6563 3420 6f6e 2074 6865 2072 6967   vec4 on the rig
+00014810: 6874 3f0a 2020 2020 2020 2020 2020 2020  ht?.            
+00014820: 656c 6966 2074 6220 6973 2076 6563 343a  elif tb is vec4:
+00014830: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00014840: 2023 206d 6174 342a 7665 6334 0a20 2020   # mat4*vec4.   
+00014850: 2020 2020 2020 2020 2020 2020 2077 7265               wre
+00014860: 7320 3d20 7665 6334 2829 0a20 2020 2020  s = vec4().     
+00014870: 2020 2020 2020 2020 2020 2077 6220 2020             wb   
+00014880: 3d20 620a 2020 2020 2020 2020 2020 2020  = b.            
+00014890: 2020 2020 7772 6573 2e78 203d 206d 612e      wres.x = ma.
+000148a0: 6d31 312a 7762 2e78 202b 206d 612e 6d31  m11*wb.x + ma.m1
+000148b0: 322a 7762 2e79 202b 206d 612e 6d31 332a  2*wb.y + ma.m13*
+000148c0: 7762 2e7a 202b 206d 612e 6d31 342a 7762  wb.z + ma.m14*wb
+000148d0: 2e77 0a20 2020 2020 2020 2020 2020 2020  .w.             
+000148e0: 2020 2077 7265 732e 7920 3d20 6d61 2e6d     wres.y = ma.m
+000148f0: 3231 2a77 622e 7820 2b20 6d61 2e6d 3232  21*wb.x + ma.m22
+00014900: 2a77 622e 7920 2b20 6d61 2e6d 3233 2a77  *wb.y + ma.m23*w
+00014910: 622e 7a20 2b20 6d61 2e6d 3234 2a77 622e  b.z + ma.m24*wb.
+00014920: 770a 2020 2020 2020 2020 2020 2020 2020  w.              
+00014930: 2020 7772 6573 2e7a 203d 206d 612e 6d33    wres.z = ma.m3
+00014940: 312a 7762 2e78 202b 206d 612e 6d33 322a  1*wb.x + ma.m32*
+00014950: 7762 2e79 202b 206d 612e 6d33 332a 7762  wb.y + ma.m33*wb
+00014960: 2e7a 202b 206d 612e 6d33 342a 7762 2e77  .z + ma.m34*wb.w
+00014970: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00014980: 2077 7265 732e 7720 3d20 6d61 2e6d 3431   wres.w = ma.m41
+00014990: 2a77 622e 7820 2b20 6d61 2e6d 3432 2a77  *wb.x + ma.m42*w
+000149a0: 622e 7920 2b20 6d61 2e6d 3433 2a77 622e  b.y + ma.m43*wb.
+000149b0: 7a20 2b20 6d61 2e6d 3434 2a77 622e 770a  z + ma.m44*wb.w.
+000149c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000149d0: 7265 7475 726e 2077 7265 730a 2020 2020  return wres.    
+000149e0: 2020 2020 2020 2020 2320 7665 6333 206f          # vec3 o
+000149f0: 6e20 7468 6520 7269 6768 743f 0a20 2020  n the right?.   
+00014a00: 2020 2020 2020 2020 2065 6c69 6620 7462           elif tb
+00014a10: 2069 7320 7665 6333 3a0a 2020 2020 2020   is vec3:.      
+00014a20: 2020 2020 2020 2020 2020 2320 6d61 7434            # mat4
+00014a30: 2a76 6563 330a 2020 2020 2020 2020 2020  *vec3.          
+00014a40: 2020 2020 2020 7672 6573 203d 2076 6563        vres = vec
+00014a50: 3328 290a 2020 2020 2020 2020 2020 2020  3().            
+00014a60: 2020 2020 7662 2020 203d 2062 0a20 2020      vb   = b.   
+00014a70: 2020 2020 2020 2020 2020 2020 2076 7265               vre
+00014a80: 732e 7820 3d20 6d61 2e6d 3131 2a76 622e  s.x = ma.m11*vb.
+00014a90: 7820 2b20 6d61 2e6d 3132 2a76 622e 7920  x + ma.m12*vb.y 
+00014aa0: 2b20 6d61 2e6d 3133 2a76 622e 7a20 2b20  + ma.m13*vb.z + 
+00014ab0: 6d61 2e6d 3134 0a20 2020 2020 2020 2020  ma.m14.         
+00014ac0: 2020 2020 2020 2076 7265 732e 7920 3d20         vres.y = 
+00014ad0: 6d61 2e6d 3231 2a76 622e 7820 2b20 6d61  ma.m21*vb.x + ma
+00014ae0: 2e6d 3232 2a76 622e 7920 2b20 6d61 2e6d  .m22*vb.y + ma.m
+00014af0: 3233 2a76 622e 7a20 2b20 6d61 2e6d 3234  23*vb.z + ma.m24
+00014b00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00014b10: 2076 7265 732e 7a20 3d20 6d61 2e6d 3331   vres.z = ma.m31
+00014b20: 2a76 622e 7820 2b20 6d61 2e6d 3332 2a76  *vb.x + ma.m32*v
+00014b30: 622e 7920 2b20 6d61 2e6d 3333 2a76 622e  b.y + ma.m33*vb.
+00014b40: 7a20 2b20 6d61 2e6d 3334 0a20 2020 2020  z + ma.m34.     
+00014b50: 2020 2020 2020 2020 2020 2077 2020 2020             w    
+00014b60: 3d20 6d61 2e6d 3431 2a76 622e 7820 2b20  = ma.m41*vb.x + 
+00014b70: 6d61 2e6d 3432 2a76 622e 7920 2b20 6d61  ma.m42*vb.y + ma
+00014b80: 2e6d 3433 2a76 622e 7a20 2b20 6d61 2e6d  .m43*vb.z + ma.m
+00014b90: 3434 0a20 2020 2020 2020 2020 2020 2020  44.             
+00014ba0: 2020 2069 6620 6661 6273 2877 293e 6570     if fabs(w)>ep
+00014bb0: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
+00014bc0: 2020 2020 2020 2076 7265 732e 7820 3d20         vres.x = 
+00014bd0: 7672 6573 2e78 2f77 0a20 2020 2020 2020  vres.x/w.       
+00014be0: 2020 2020 2020 2020 2020 2020 2076 7265               vre
+00014bf0: 732e 7920 3d20 7672 6573 2e79 2f77 0a20  s.y = vres.y/w. 
+00014c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014c10: 2020 2076 7265 732e 7a20 3d20 7672 6573     vres.z = vres
+00014c20: 2e7a 2f77 0a20 2020 2020 2020 2020 2020  .z/w.           
+00014c30: 2020 2020 2072 6574 7572 6e20 7672 6573       return vres
+00014c40: 0a20 2020 2020 2020 2020 2020 2023 2053  .            # S
+00014c50: 6361 6c61 7220 6f6e 2074 6865 2072 6967  calar on the rig
+00014c60: 6874 3f0a 2020 2020 2020 2020 2020 2020  ht?.            
+00014c70: 656c 6966 2074 6220 6973 2066 6c6f 6174  elif tb is float
+00014c80: 206f 7220 7462 2069 7320 696e 7420 6f72   or tb is int or
+00014c90: 2074 6220 6973 206c 6f6e 673a 0a20 2020   tb is long:.   
+00014ca0: 2020 2020 2020 2020 2020 2020 2072 6573               res
+00014cb0: 203d 206d 6174 3428 290a 2020 2020 2020   = mat4().      
+00014cc0: 2020 2020 2020 2020 2020 7220 3d20 620a            r = b.
+00014cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014ce0: 7265 732e 6d31 3120 3d20 6d61 2e6d 3131  res.m11 = ma.m11
+00014cf0: 2a72 0a20 2020 2020 2020 2020 2020 2020  *r.             
+00014d00: 2020 2072 6573 2e6d 3132 203d 206d 612e     res.m12 = ma.
+00014d10: 6d31 322a 720a 2020 2020 2020 2020 2020  m12*r.          
+00014d20: 2020 2020 2020 7265 732e 6d31 3320 3d20        res.m13 = 
+00014d30: 6d61 2e6d 3133 2a72 0a20 2020 2020 2020  ma.m13*r.       
+00014d40: 2020 2020 2020 2020 2072 6573 2e6d 3134           res.m14
+00014d50: 203d 206d 612e 6d31 342a 720a 2020 2020   = ma.m14*r.    
+00014d60: 2020 2020 2020 2020 2020 2020 7265 732e              res.
+00014d70: 6d32 3120 3d20 6d61 2e6d 3231 2a72 0a20  m21 = ma.m21*r. 
+00014d80: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00014d90: 6573 2e6d 3232 203d 206d 612e 6d32 322a  es.m22 = ma.m22*
+00014da0: 720a 2020 2020 2020 2020 2020 2020 2020  r.              
+00014db0: 2020 7265 732e 6d32 3320 3d20 6d61 2e6d    res.m23 = ma.m
+00014dc0: 3233 2a72 0a20 2020 2020 2020 2020 2020  23*r.           
+00014dd0: 2020 2020 2072 6573 2e6d 3234 203d 206d       res.m24 = m
+00014de0: 612e 6d32 342a 720a 2020 2020 2020 2020  a.m24*r.        
+00014df0: 2020 2020 2020 2020 7265 732e 6d33 3120          res.m31 
+00014e00: 3d20 6d61 2e6d 3331 2a72 0a20 2020 2020  = ma.m31*r.     
+00014e10: 2020 2020 2020 2020 2020 2072 6573 2e6d             res.m
+00014e20: 3332 203d 206d 612e 6d33 322a 720a 2020  32 = ma.m32*r.  
+00014e30: 2020 2020 2020 2020 2020 2020 2020 7265                re
+00014e40: 732e 6d33 3320 3d20 6d61 2e6d 3333 2a72  s.m33 = ma.m33*r
+00014e50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00014e60: 2072 6573 2e6d 3334 203d 206d 612e 6d33   res.m34 = ma.m3
+00014e70: 342a 720a 2020 2020 2020 2020 2020 2020  4*r.            
+00014e80: 2020 2020 7265 732e 6d34 3120 3d20 6d61      res.m41 = ma
+00014e90: 2e6d 3431 2a72 0a20 2020 2020 2020 2020  .m41*r.         
+00014ea0: 2020 2020 2020 2072 6573 2e6d 3432 203d         res.m42 =
+00014eb0: 206d 612e 6d34 322a 720a 2020 2020 2020   ma.m42*r.      
+00014ec0: 2020 2020 2020 2020 2020 7265 732e 6d34            res.m4
+00014ed0: 3320 3d20 6d61 2e6d 3433 2a72 0a20 2020  3 = ma.m43*r.   
+00014ee0: 2020 2020 2020 2020 2020 2020 2072 6573               res
+00014ef0: 2e6d 3434 203d 206d 612e 6d34 342a 720a  .m44 = ma.m44*r.
+00014f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014f10: 7265 7475 726e 2072 6573 0a0a 2020 2020  return res..    
+00014f20: 2020 2020 2320 7665 6334 206f 6e20 7468      # vec4 on th
+00014f30: 6520 6c65 6674 3f20 2874 6865 6e20 7468  e left? (then th
+00014f40: 6572 6520 6d75 7374 2062 6520 6120 6d61  ere must be a ma
+00014f50: 7434 206f 6e20 7468 6520 7269 6768 7429  t4 on the right)
+00014f60: 0a20 2020 2020 2020 2065 6c69 6620 7461  .        elif ta
+00014f70: 2069 7320 7665 6334 3a0a 2020 2020 2020   is vec4:.      
+00014f80: 2020 2020 2020 2320 7665 6334 2a6d 6174        # vec4*mat
+00014f90: 340a 2020 2020 2020 2020 2020 2020 7772  4.            wr
+00014fa0: 6573 203d 2076 6563 3428 290a 2020 2020  es = vec4().    
+00014fb0: 2020 2020 2020 2020 7761 2020 203d 2061          wa   = a
+00014fc0: 0a20 2020 2020 2020 2020 2020 206d 6220  .            mb 
+00014fd0: 2020 3d20 620a 2020 2020 2020 2020 2020    = b.          
+00014fe0: 2020 7772 6573 2e78 203d 2077 612e 782a    wres.x = wa.x*
+00014ff0: 6d62 2e6d 3131 202b 2077 612e 792a 6d62  mb.m11 + wa.y*mb
+00015000: 2e6d 3231 202b 2077 612e 7a2a 6d62 2e6d  .m21 + wa.z*mb.m
+00015010: 3331 202b 2077 612e 772a 6d62 2e6d 3431  31 + wa.w*mb.m41
+00015020: 0a20 2020 2020 2020 2020 2020 2077 7265  .            wre
+00015030: 732e 7920 3d20 7761 2e78 2a6d 622e 6d31  s.y = wa.x*mb.m1
+00015040: 3220 2b20 7761 2e79 2a6d 622e 6d32 3220  2 + wa.y*mb.m22 
+00015050: 2b20 7761 2e7a 2a6d 622e 6d33 3220 2b20  + wa.z*mb.m32 + 
+00015060: 7761 2e77 2a6d 622e 6d34 320a 2020 2020  wa.w*mb.m42.    
+00015070: 2020 2020 2020 2020 7772 6573 2e7a 203d          wres.z =
+00015080: 2077 612e 782a 6d62 2e6d 3133 202b 2077   wa.x*mb.m13 + w
+00015090: 612e 792a 6d62 2e6d 3233 202b 2077 612e  a.y*mb.m23 + wa.
+000150a0: 7a2a 6d62 2e6d 3333 202b 2077 612e 772a  z*mb.m33 + wa.w*
+000150b0: 6d62 2e6d 3433 0a20 2020 2020 2020 2020  mb.m43.         
+000150c0: 2020 2077 7265 732e 7720 3d20 7761 2e78     wres.w = wa.x
+000150d0: 2a6d 622e 6d31 3420 2b20 7761 2e79 2a6d  *mb.m14 + wa.y*m
+000150e0: 622e 6d32 3420 2b20 7761 2e7a 2a6d 622e  b.m24 + wa.z*mb.
+000150f0: 6d33 3420 2b20 7761 2e77 2a6d 622e 6d34  m34 + wa.w*mb.m4
+00015100: 340a 2020 2020 2020 2020 2020 2020 7265  4.            re
+00015110: 7475 726e 2077 7265 730a 0a20 2020 2020  turn wres..     
+00015120: 2020 2023 2076 6563 3320 6f6e 2074 6865     # vec3 on the
+00015130: 206c 6566 743f 2028 7468 656e 2074 6865   left? (then the
+00015140: 7265 206d 7573 7420 6265 2061 206d 6174  re must be a mat
+00015150: 3420 6f6e 2074 6865 2072 6967 6874 290a  4 on the right).
+00015160: 2020 2020 2020 2020 656c 6966 2074 6120          elif ta 
+00015170: 6973 2076 6563 333a 0a20 2020 2020 2020  is vec3:.       
+00015180: 2020 2020 2023 2076 6563 332a 6d61 7434       # vec3*mat4
+00015190: 0a20 2020 2020 2020 2020 2020 2076 7265  .            vre
+000151a0: 7320 3d20 7665 6333 2829 0a20 2020 2020  s = vec3().     
+000151b0: 2020 2020 2020 2076 6120 2020 3d20 610a         va   = a.
+000151c0: 2020 2020 2020 2020 2020 2020 6d62 2020              mb  
+000151d0: 203d 2062 0a20 2020 2020 2020 2020 2020   = b.           
+000151e0: 2076 7265 732e 7820 3d20 7661 2e78 2a6d   vres.x = va.x*m
+000151f0: 622e 6d31 3120 2b20 7661 2e79 2a6d 622e  b.m11 + va.y*mb.
+00015200: 6d32 3120 2b20 7661 2e7a 2a6d 622e 6d33  m21 + va.z*mb.m3
+00015210: 3120 2b20 6d62 2e6d 3431 0a20 2020 2020  1 + mb.m41.     
+00015220: 2020 2020 2020 2076 7265 732e 7920 3d20         vres.y = 
+00015230: 7661 2e78 2a6d 622e 6d31 3220 2b20 7661  va.x*mb.m12 + va
+00015240: 2e79 2a6d 622e 6d32 3220 2b20 7661 2e7a  .y*mb.m22 + va.z
+00015250: 2a6d 622e 6d33 3220 2b20 6d62 2e6d 3432  *mb.m32 + mb.m42
+00015260: 0a20 2020 2020 2020 2020 2020 2076 7265  .            vre
+00015270: 732e 7a20 3d20 7661 2e78 2a6d 622e 6d31  s.z = va.x*mb.m1
+00015280: 3320 2b20 7661 2e79 2a6d 622e 6d32 3320  3 + va.y*mb.m23 
+00015290: 2b20 7661 2e7a 2a6d 622e 6d33 3320 2b20  + va.z*mb.m33 + 
+000152a0: 6d62 2e6d 3433 0a20 2020 2020 2020 2020  mb.m43.         
+000152b0: 2020 2077 203d 2076 612e 782a 6d62 2e6d     w = va.x*mb.m
+000152c0: 3134 202b 2076 612e 792a 6d62 2e6d 3234  14 + va.y*mb.m24
+000152d0: 202b 2076 612e 7a2a 6d62 2e6d 3334 202b   + va.z*mb.m34 +
+000152e0: 206d 622e 6d34 340a 2020 2020 2020 2020   mb.m44.        
+000152f0: 2020 2020 6966 2066 6162 7328 7729 3e65      if fabs(w)>e
+00015300: 7073 3a0a 2020 2020 2020 2020 2020 2020  ps:.            
+00015310: 2020 2020 7672 6573 2e78 203d 2076 7265      vres.x = vre
+00015320: 732e 782f 770a 2020 2020 2020 2020 2020  s.x/w.          
+00015330: 2020 2020 2020 7672 6573 2e79 203d 2076        vres.y = v
+00015340: 7265 732e 792f 770a 2020 2020 2020 2020  res.y/w.        
+00015350: 2020 2020 2020 2020 7672 6573 2e7a 203d          vres.z =
+00015360: 2076 7265 732e 7a2f 770a 2020 2020 2020   vres.z/w.      
+00015370: 2020 2020 2020 7265 7475 726e 2076 7265        return vre
+00015380: 730a 0a20 2020 2020 2020 2023 2053 6361  s..        # Sca
+00015390: 6c61 7220 6f6e 2074 6865 206c 6566 743f  lar on the left?
+000153a0: 2028 7468 656e 2074 6865 7265 206d 7573   (then there mus
+000153b0: 7420 6265 2061 206d 6174 3420 6f6e 2074  t be a mat4 on t
+000153c0: 6865 2072 6967 6874 290a 2020 2020 2020  he right).      
+000153d0: 2020 656c 6966 2074 6120 6973 2066 6c6f    elif ta is flo
+000153e0: 6174 206f 7220 7461 2069 7320 696e 7420  at or ta is int 
+000153f0: 6f72 2074 6120 6973 206c 6f6e 673a 0a20  or ta is long:. 
+00015400: 2020 2020 2020 2020 2020 2072 6573 203d             res =
+00015410: 206d 6174 3428 290a 2020 2020 2020 2020   mat4().        
+00015420: 2020 2020 7220 203d 2061 0a20 2020 2020      r  = a.     
+00015430: 2020 2020 2020 206d 6220 3d20 620a 2020         mb = b.  
+00015440: 2020 2020 2020 2020 2020 7265 732e 6d31            res.m1
+00015450: 3120 3d20 722a 6d62 2e6d 3131 0a20 2020  1 = r*mb.m11.   
+00015460: 2020 2020 2020 2020 2072 6573 2e6d 3132           res.m12
+00015470: 203d 2072 2a6d 622e 6d31 320a 2020 2020   = r*mb.m12.    
+00015480: 2020 2020 2020 2020 7265 732e 6d31 3320          res.m13 
+00015490: 3d20 722a 6d62 2e6d 3133 0a20 2020 2020  = r*mb.m13.     
+000154a0: 2020 2020 2020 2072 6573 2e6d 3134 203d         res.m14 =
+000154b0: 2072 2a6d 622e 6d31 340a 2020 2020 2020   r*mb.m14.      
+000154c0: 2020 2020 2020 7265 732e 6d32 3120 3d20        res.m21 = 
+000154d0: 722a 6d62 2e6d 3231 0a20 2020 2020 2020  r*mb.m21.       
+000154e0: 2020 2020 2072 6573 2e6d 3232 203d 2072       res.m22 = r
+000154f0: 2a6d 622e 6d32 320a 2020 2020 2020 2020  *mb.m22.        
+00015500: 2020 2020 7265 732e 6d32 3320 3d20 722a      res.m23 = r*
+00015510: 6d62 2e6d 3233 0a20 2020 2020 2020 2020  mb.m23.         
+00015520: 2020 2072 6573 2e6d 3234 203d 2072 2a6d     res.m24 = r*m
+00015530: 622e 6d32 340a 2020 2020 2020 2020 2020  b.m24.          
+00015540: 2020 7265 732e 6d33 3120 3d20 722a 6d62    res.m31 = r*mb
+00015550: 2e6d 3331 0a20 2020 2020 2020 2020 2020  .m31.           
+00015560: 2072 6573 2e6d 3332 203d 2072 2a6d 622e   res.m32 = r*mb.
+00015570: 6d33 320a 2020 2020 2020 2020 2020 2020  m32.            
+00015580: 7265 732e 6d33 3320 3d20 722a 6d62 2e6d  res.m33 = r*mb.m
+00015590: 3333 0a20 2020 2020 2020 2020 2020 2072  33.            r
+000155a0: 6573 2e6d 3334 203d 2072 2a6d 622e 6d33  es.m34 = r*mb.m3
+000155b0: 340a 2020 2020 2020 2020 2020 2020 7265  4.            re
+000155c0: 732e 6d34 3120 3d20 722a 6d62 2e6d 3431  s.m41 = r*mb.m41
+000155d0: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
+000155e0: 2e6d 3432 203d 2072 2a6d 622e 6d34 320a  .m42 = r*mb.m42.
+000155f0: 2020 2020 2020 2020 2020 2020 7265 732e              res.
+00015600: 6d34 3320 3d20 722a 6d62 2e6d 3433 0a20  m43 = r*mb.m43. 
+00015610: 2020 2020 2020 2020 2020 2072 6573 2e6d             res.m
+00015620: 3434 203d 2072 2a6d 622e 6d34 340a 2020  44 = r*mb.m44.  
+00015630: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00015640: 2072 6573 0a0a 2020 2020 2020 2020 2320   res..        # 
+00015650: 4e6f 2076 616c 6964 2063 6f6d 6269 6e61  No valid combina
+00015660: 7469 6f6e 2066 6f75 6e64 0a20 2020 2020  tion found.     
+00015670: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
+00015680: 6f72 2c20 2275 6e73 7570 706f 7274 6564  or, "unsupported
+00015690: 206f 7065 7261 6e64 2074 7970 6520 666f   operand type fo
+000156a0: 7220 2a22 0a0a 2020 2020 6465 6620 5f5f  r *"..    def __
+000156b0: 6469 765f 5f28 6d61 7434 2061 2c20 6229  div__(mat4 a, b)
+000156c0: 3a0a 2020 2020 2020 2020 2320 5079 7468  :.        # Pyth
+000156d0: 6f6e 2032 0a20 2020 2020 2020 2072 6574  on 2.        ret
+000156e0: 7572 6e20 6d61 7434 2e5f 5f74 7275 6564  urn mat4.__trued
+000156f0: 6976 5f5f 2861 2c62 290a 0a20 2020 2064  iv__(a,b)..    d
+00015700: 6566 205f 5f74 7275 6564 6976 5f5f 286d  ef __truediv__(m
+00015710: 6174 3420 612c 2062 293a 0a20 2020 2020  at4 a, b):.     
+00015720: 2020 2022 2222 4469 7669 7369 6f6e 2e0a     """Division..
+00015730: 0a20 2020 2020 2020 203e 3e3e 204d 3d6d  .        >>> M=m
+00015740: 6174 3428 312c 322c 332c 342c 352c 362c  at4(1,2,3,4,5,6,
+00015750: 372c 382c 392c 3130 2c31 312c 3132 2c31  7,8,9,10,11,12,1
+00015760: 332c 3134 2c31 352c 3136 290a 2020 2020  3,14,15,16).    
+00015770: 2020 2020 3e3e 3e20 7072 696e 7428 4d2f      >>> print(M/
+00015780: 322e 3029 0a20 2020 2020 2020 205b 2020  2.0).        [  
+00015790: 2030 2e35 3030 302c 2020 2020 312e 3030   0.5000,    1.00
+000157a0: 3030 2c20 2020 2031 2e35 3030 302c 2020  00,    1.5000,  
+000157b0: 2020 322e 3030 3030 5d0a 2020 2020 2020    2.0000].      
+000157c0: 2020 5b20 2020 322e 3530 3030 2c20 2020    [   2.5000,   
+000157d0: 2033 2e30 3030 302c 2020 2020 332e 3530   3.0000,    3.50
+000157e0: 3030 2c20 2020 2034 2e30 3030 305d 0a20  00,    4.0000]. 
+000157f0: 2020 2020 2020 205b 2020 2034 2e35 3030         [   4.500
+00015800: 302c 2020 2020 352e 3030 3030 2c20 2020  0,    5.0000,   
+00015810: 2035 2e35 3030 302c 2020 2020 362e 3030   5.5000,    6.00
+00015820: 3030 5d0a 2020 2020 2020 2020 5b20 2020  00].        [   
+00015830: 362e 3530 3030 2c20 2020 2037 2e30 3030  6.5000,    7.000
+00015840: 302c 2020 2020 372e 3530 3030 2c20 2020  0,    7.5000,   
+00015850: 2038 2e30 3030 305d 0a20 2020 2020 2020   8.0000].       
+00015860: 2022 2222 0a20 2020 2020 2020 2063 6465   """.        cde
+00015870: 6620 6d61 7434 2072 6573 0a20 2020 2020  f mat4 res.     
+00015880: 2020 2063 6465 6620 646f 7562 6c65 2072     cdef double r
+00015890: 0a0a 2020 2020 2020 2020 7462 203d 2074  ..        tb = t
+000158a0: 7970 6528 6229 0a0a 2020 2020 2020 2020  ype(b)..        
+000158b0: 6966 2074 6220 6973 2066 6c6f 6174 206f  if tb is float o
+000158c0: 7220 7462 2069 7320 696e 7420 6f72 2074  r tb is int or t
+000158d0: 6220 6973 206c 6f6e 673a 0a20 2020 2020  b is long:.     
+000158e0: 2020 2020 2020 2023 206d 6174 342f 7363         # mat4/sc
+000158f0: 616c 6172 0a20 2020 2020 2020 2020 2020  alar.           
+00015900: 2072 6573 203d 206d 6174 3428 290a 2020   res = mat4().  
+00015910: 2020 2020 2020 2020 2020 7220 3d20 620a            r = b.
+00015920: 2020 2020 2020 2020 2020 2020 6966 2066              if f
+00015930: 6162 7328 7229 3c3d 6570 733a 0a20 2020  abs(r)<=eps:.   
+00015940: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+00015950: 7365 205a 6572 6f44 6976 6973 696f 6e45  se ZeroDivisionE
+00015960: 7272 6f72 2c22 6d61 7434 2064 6976 6973  rror,"mat4 divis
+00015970: 696f 6e22 0a20 2020 2020 2020 2020 2020  ion".           
+00015980: 2072 6573 2e6d 3131 203d 2061 2e6d 3131   res.m11 = a.m11
+00015990: 2f72 0a20 2020 2020 2020 2020 2020 2072  /r.            r
+000159a0: 6573 2e6d 3132 203d 2061 2e6d 3132 2f72  es.m12 = a.m12/r
+000159b0: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
+000159c0: 2e6d 3133 203d 2061 2e6d 3133 2f72 0a20  .m13 = a.m13/r. 
+000159d0: 2020 2020 2020 2020 2020 2072 6573 2e6d             res.m
+000159e0: 3134 203d 2061 2e6d 3134 2f72 0a20 2020  14 = a.m14/r.   
+000159f0: 2020 2020 2020 2020 2072 6573 2e6d 3231           res.m21
+00015a00: 203d 2061 2e6d 3231 2f72 0a20 2020 2020   = a.m21/r.     
+00015a10: 2020 2020 2020 2072 6573 2e6d 3232 203d         res.m22 =
+00015a20: 2061 2e6d 3232 2f72 0a20 2020 2020 2020   a.m22/r.       
+00015a30: 2020 2020 2072 6573 2e6d 3233 203d 2061       res.m23 = a
+00015a40: 2e6d 3233 2f72 0a20 2020 2020 2020 2020  .m23/r.         
+00015a50: 2020 2072 6573 2e6d 3234 203d 2061 2e6d     res.m24 = a.m
+00015a60: 3234 2f72 0a20 2020 2020 2020 2020 2020  24/r.           
+00015a70: 2072 6573 2e6d 3331 203d 2061 2e6d 3331   res.m31 = a.m31
+00015a80: 2f72 0a20 2020 2020 2020 2020 2020 2072  /r.            r
+00015a90: 6573 2e6d 3332 203d 2061 2e6d 3332 2f72  es.m32 = a.m32/r
+00015aa0: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
+00015ab0: 2e6d 3333 203d 2061 2e6d 3333 2f72 0a20  .m33 = a.m33/r. 
+00015ac0: 2020 2020 2020 2020 2020 2072 6573 2e6d             res.m
+00015ad0: 3334 203d 2061 2e6d 3334 2f72 0a20 2020  34 = a.m34/r.   
+00015ae0: 2020 2020 2020 2020 2072 6573 2e6d 3431           res.m41
+00015af0: 203d 2061 2e6d 3431 2f72 0a20 2020 2020   = a.m41/r.     
+00015b00: 2020 2020 2020 2072 6573 2e6d 3432 203d         res.m42 =
+00015b10: 2061 2e6d 3432 2f72 0a20 2020 2020 2020   a.m42/r.       
+00015b20: 2020 2020 2072 6573 2e6d 3433 203d 2061       res.m43 = a
+00015b30: 2e6d 3433 2f72 0a20 2020 2020 2020 2020  .m43/r.         
+00015b40: 2020 2072 6573 2e6d 3434 203d 2061 2e6d     res.m44 = a.m
+00015b50: 3434 2f72 0a20 2020 2020 2020 2020 2020  44/r.           
+00015b60: 2072 6574 7572 6e20 7265 730a 2020 2020   return res.    
+00015b70: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00015b80: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
+00015b90: 4572 726f 722c 2022 756e 7375 7070 6f72  Error, "unsuppor
+00015ba0: 7465 6420 6f70 6572 616e 6420 7479 7065  ted operand type
+00015bb0: 2066 6f72 202f 220a 0a20 2020 2064 6566   for /"..    def
+00015bc0: 205f 5f6d 6f64 5f5f 286d 6174 3420 7365   __mod__(mat4 se
+00015bd0: 6c66 2c20 6f74 6865 7229 3a0a 2020 2020  lf, other):.    
+00015be0: 2020 2020 2222 224d 6f64 756c 6f2e 0a0a      """Modulo...
+00015bf0: 2020 2020 2020 2020 3e3e 3e20 4d3d 6d61          >>> M=ma
+00015c00: 7434 2831 2c32 2c33 2c34 2c35 2c36 2c37  t4(1,2,3,4,5,6,7
+00015c10: 2c38 2c39 2c31 302c 3131 2c31 322c 3133  ,8,9,10,11,12,13
+00015c20: 2c31 342c 3135 2c31 3629 0a20 2020 2020  ,14,15,16).     
+00015c30: 2020 203e 3e3e 2070 7269 6e74 284d 2535     >>> print(M%5
+00015c40: 2e30 290a 2020 2020 2020 2020 5b20 2020  .0).        [   
+00015c50: 312e 3030 3030 2c20 2020 2032 2e30 3030  1.0000,    2.000
+00015c60: 302c 2020 2020 332e 3030 3030 2c20 2020  0,    3.0000,   
+00015c70: 2034 2e30 3030 305d 0a20 2020 2020 2020   4.0000].       
+00015c80: 205b 2020 2030 2e30 3030 302c 2020 2020   [   0.0000,    
+00015c90: 312e 3030 3030 2c20 2020 2032 2e30 3030  1.0000,    2.000
+00015ca0: 302c 2020 2020 332e 3030 3030 5d0a 2020  0,    3.0000].  
+00015cb0: 2020 2020 2020 5b20 2020 342e 3030 3030        [   4.0000
+00015cc0: 2c20 2020 2030 2e30 3030 302c 2020 2020  ,    0.0000,    
+00015cd0: 312e 3030 3030 2c20 2020 2032 2e30 3030  1.0000,    2.000
+00015ce0: 305d 0a20 2020 2020 2020 205b 2020 2033  0].        [   3
+00015cf0: 2e30 3030 302c 2020 2020 342e 3030 3030  .0000,    4.0000
+00015d00: 2c20 2020 2030 2e30 3030 302c 2020 2020  ,    0.0000,    
+00015d10: 312e 3030 3030 5d0a 2020 2020 2020 2020  1.0000].        
+00015d20: 2222 220a 2020 2020 2020 2020 6364 6566  """.        cdef
+00015d30: 206d 6174 3420 6d62 2c20 7265 730a 0a20   mat4 mb, res.. 
+00015d40: 2020 2020 2020 2074 6220 3d20 7479 7065         tb = type
+00015d50: 286f 7468 6572 290a 0a20 2020 2020 2020  (other)..       
+00015d60: 2069 6620 7462 2069 7320 666c 6f61 7420   if tb is float 
+00015d70: 6f72 2074 6220 6973 2069 6e74 206f 7220  or tb is int or 
+00015d80: 7462 2069 7320 6c6f 6e67 3a0a 2020 2020  tb is long:.    
+00015d90: 2020 2020 2020 2020 7220 3d20 6f74 6865          r = othe
+00015da0: 720a 2020 2020 2020 2020 2020 2020 6966  r.            if
+00015db0: 2066 6162 7328 7229 3c3d 6570 733a 0a20   fabs(r)<=eps:. 
+00015dc0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00015dd0: 6169 7365 205a 6572 6f44 6976 6973 696f  aise ZeroDivisio
+00015de0: 6e45 7272 6f72 2c22 6d61 7434 206d 6f64  nError,"mat4 mod
+00015df0: 756c 6f22 0a20 2020 2020 2020 2020 2020  ulo".           
+00015e00: 2072 6573 203d 206d 6174 3428 290a 2020   res = mat4().  
+00015e10: 2020 2020 2020 2020 2020 7265 732e 6d31            res.m1
+00015e20: 3120 3d20 5f66 6d6f 6428 7365 6c66 2e6d  1 = _fmod(self.m
+00015e30: 3131 2c20 7229 0a20 2020 2020 2020 2020  11, r).         
+00015e40: 2020 2072 6573 2e6d 3132 203d 205f 666d     res.m12 = _fm
+00015e50: 6f64 2873 656c 662e 6d31 322c 2072 290a  od(self.m12, r).
+00015e60: 2020 2020 2020 2020 2020 2020 7265 732e              res.
+00015e70: 6d31 3320 3d20 5f66 6d6f 6428 7365 6c66  m13 = _fmod(self
+00015e80: 2e6d 3133 2c20 7229 0a20 2020 2020 2020  .m13, r).       
+00015e90: 2020 2020 2072 6573 2e6d 3134 203d 205f       res.m14 = _
+00015ea0: 666d 6f64 2873 656c 662e 6d31 342c 2072  fmod(self.m14, r
+00015eb0: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
+00015ec0: 732e 6d32 3120 3d20 5f66 6d6f 6428 7365  s.m21 = _fmod(se
+00015ed0: 6c66 2e6d 3231 2c20 7229 0a20 2020 2020  lf.m21, r).     
+00015ee0: 2020 2020 2020 2072 6573 2e6d 3232 203d         res.m22 =
+00015ef0: 205f 666d 6f64 2873 656c 662e 6d32 322c   _fmod(self.m22,
+00015f00: 2072 290a 2020 2020 2020 2020 2020 2020   r).            
+00015f10: 7265 732e 6d32 3320 3d20 5f66 6d6f 6428  res.m23 = _fmod(
+00015f20: 7365 6c66 2e6d 3233 2c20 7229 0a20 2020  self.m23, r).   
+00015f30: 2020 2020 2020 2020 2072 6573 2e6d 3234           res.m24
+00015f40: 203d 205f 666d 6f64 2873 656c 662e 6d32   = _fmod(self.m2
+00015f50: 342c 2072 290a 2020 2020 2020 2020 2020  4, r).          
+00015f60: 2020 7265 732e 6d33 3120 3d20 5f66 6d6f    res.m31 = _fmo
+00015f70: 6428 7365 6c66 2e6d 3331 2c20 7229 0a20  d(self.m31, r). 
+00015f80: 2020 2020 2020 2020 2020 2072 6573 2e6d             res.m
+00015f90: 3332 203d 205f 666d 6f64 2873 656c 662e  32 = _fmod(self.
+00015fa0: 6d33 322c 2072 290a 2020 2020 2020 2020  m32, r).        
+00015fb0: 2020 2020 7265 732e 6d33 3320 3d20 5f66      res.m33 = _f
+00015fc0: 6d6f 6428 7365 6c66 2e6d 3333 2c20 7229  mod(self.m33, r)
+00015fd0: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
+00015fe0: 2e6d 3334 203d 205f 666d 6f64 2873 656c  .m34 = _fmod(sel
+00015ff0: 662e 6d33 342c 2072 290a 2020 2020 2020  f.m34, r).      
+00016000: 2020 2020 2020 7265 732e 6d34 3120 3d20        res.m41 = 
+00016010: 5f66 6d6f 6428 7365 6c66 2e6d 3431 2c20  _fmod(self.m41, 
+00016020: 7229 0a20 2020 2020 2020 2020 2020 2072  r).            r
+00016030: 6573 2e6d 3432 203d 205f 666d 6f64 2873  es.m42 = _fmod(s
+00016040: 656c 662e 6d34 322c 2072 290a 2020 2020  elf.m42, r).    
+00016050: 2020 2020 2020 2020 7265 732e 6d34 3320          res.m43 
+00016060: 3d20 5f66 6d6f 6428 7365 6c66 2e6d 3433  = _fmod(self.m43
+00016070: 2c20 7229 0a20 2020 2020 2020 2020 2020  , r).           
+00016080: 2072 6573 2e6d 3434 203d 205f 666d 6f64   res.m44 = _fmod
+00016090: 2873 656c 662e 6d34 342c 2072 290a 2020  (self.m44, r).  
+000160a0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+000160b0: 2072 6573 0a0a 2020 2020 2020 2020 656c   res..        el
+000160c0: 6966 2074 6220 6973 206d 6174 343a 0a20  if tb is mat4:. 
+000160d0: 2020 2020 2020 2020 2020 206d 6220 3d20             mb = 
+000160e0: 6f74 6865 720a 0a20 2020 2020 2020 2020  other..         
+000160f0: 2020 2069 6620 2866 6162 7328 6d62 2e6d     if (fabs(mb.m
+00016100: 3131 293c 3d65 7073 206f 7220 6661 6273  11)<=eps or fabs
+00016110: 286d 622e 6d31 3229 3c3d 6570 7320 6f72  (mb.m12)<=eps or
+00016120: 2066 6162 7328 6d62 2e6d 3133 293c 3d65   fabs(mb.m13)<=e
+00016130: 7073 206f 720a 2020 2020 2020 2020 2020  ps or.          
+00016140: 2020 2020 2020 6661 6273 286d 622e 6d31        fabs(mb.m1
+00016150: 3429 3c3d 6570 7320 6f72 0a20 2020 2020  4)<=eps or.     
+00016160: 2020 2020 2020 2020 2020 2066 6162 7328             fabs(
+00016170: 6d62 2e6d 3231 293c 3d65 7073 206f 7220  mb.m21)<=eps or 
+00016180: 6661 6273 286d 622e 6d32 3229 3c3d 6570  fabs(mb.m22)<=ep
+00016190: 7320 6f72 2066 6162 7328 6d62 2e6d 3233  s or fabs(mb.m23
+000161a0: 293c 3d65 7073 206f 720a 2020 2020 2020  )<=eps or.      
+000161b0: 2020 2020 2020 2020 2020 6661 6273 286d            fabs(m
+000161c0: 622e 6d32 3429 3c3d 6570 7320 6f72 0a20  b.m24)<=eps or. 
+000161d0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+000161e0: 6162 7328 6d62 2e6d 3331 293c 3d65 7073  abs(mb.m31)<=eps
+000161f0: 206f 7220 6661 6273 286d 622e 6d33 3229   or fabs(mb.m32)
+00016200: 3c3d 6570 7320 6f72 2066 6162 7328 6d62  <=eps or fabs(mb
+00016210: 2e6d 3333 293c 3d65 7073 206f 720a 2020  .m33)<=eps or.  
+00016220: 2020 2020 2020 2020 2020 2020 2020 6661                fa
+00016230: 6273 286d 622e 6d33 3429 3c3d 6570 7320  bs(mb.m34)<=eps 
+00016240: 6f72 0a20 2020 2020 2020 2020 2020 2020  or.             
+00016250: 2020 2066 6162 7328 6d62 2e6d 3431 293c     fabs(mb.m41)<
+00016260: 3d65 7073 206f 7220 6661 6273 286d 622e  =eps or fabs(mb.
+00016270: 6d34 3229 3c3d 6570 7320 6f72 2066 6162  m42)<=eps or fab
+00016280: 7328 6d62 2e6d 3433 293c 3d65 7073 206f  s(mb.m43)<=eps o
+00016290: 720a 2020 2020 2020 2020 2020 2020 2020  r.              
+000162a0: 2020 6661 6273 286d 622e 6d34 3429 3c3d    fabs(mb.m44)<=
+000162b0: 6570 7329 3a0a 2020 2020 2020 2020 2020  eps):.          
+000162c0: 2020 2020 2020 7261 6973 6520 5a65 726f        raise Zero
+000162d0: 4469 7669 7369 6f6e 4572 726f 722c 226d  DivisionError,"m
+000162e0: 6174 3420 6d6f 6475 6c6f 220a 0a20 2020  at4 modulo"..   
+000162f0: 2020 2020 2020 2020 2072 6573 3d6d 6174           res=mat
+00016300: 3428 290a 2020 2020 2020 2020 2020 2020  4().            
+00016310: 7265 732e 6d31 3120 3d20 5f66 6d6f 6428  res.m11 = _fmod(
+00016320: 7365 6c66 2e6d 3131 2c20 6d62 2e6d 3131  self.m11, mb.m11
+00016330: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
+00016340: 732e 6d31 3220 3d20 5f66 6d6f 6428 7365  s.m12 = _fmod(se
+00016350: 6c66 2e6d 3132 2c20 6d62 2e6d 3132 290a  lf.m12, mb.m12).
+00016360: 2020 2020 2020 2020 2020 2020 7265 732e              res.
+00016370: 6d31 3320 3d20 5f66 6d6f 6428 7365 6c66  m13 = _fmod(self
+00016380: 2e6d 3133 2c20 6d62 2e6d 3133 290a 2020  .m13, mb.m13).  
+00016390: 2020 2020 2020 2020 2020 7265 732e 6d31            res.m1
+000163a0: 3420 3d20 5f66 6d6f 6428 7365 6c66 2e6d  4 = _fmod(self.m
+000163b0: 3134 2c20 6d62 2e6d 3134 290a 2020 2020  14, mb.m14).    
+000163c0: 2020 2020 2020 2020 7265 732e 6d32 3120          res.m21 
+000163d0: 3d20 5f66 6d6f 6428 7365 6c66 2e6d 3231  = _fmod(self.m21
+000163e0: 2c20 6d62 2e6d 3231 290a 2020 2020 2020  , mb.m21).      
+000163f0: 2020 2020 2020 7265 732e 6d32 3220 3d20        res.m22 = 
+00016400: 5f66 6d6f 6428 7365 6c66 2e6d 3232 2c20  _fmod(self.m22, 
+00016410: 6d62 2e6d 3232 290a 2020 2020 2020 2020  mb.m22).        
+00016420: 2020 2020 7265 732e 6d32 3320 3d20 5f66      res.m23 = _f
+00016430: 6d6f 6428 7365 6c66 2e6d 3233 2c20 6d62  mod(self.m23, mb
+00016440: 2e6d 3233 290a 2020 2020 2020 2020 2020  .m23).          
+00016450: 2020 7265 732e 6d32 3420 3d20 5f66 6d6f    res.m24 = _fmo
+00016460: 6428 7365 6c66 2e6d 3234 2c20 6d62 2e6d  d(self.m24, mb.m
+00016470: 3234 290a 2020 2020 2020 2020 2020 2020  24).            
+00016480: 7265 732e 6d33 3120 3d20 5f66 6d6f 6428  res.m31 = _fmod(
+00016490: 7365 6c66 2e6d 3331 2c20 6d62 2e6d 3331  self.m31, mb.m31
+000164a0: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
+000164b0: 732e 6d33 3220 3d20 5f66 6d6f 6428 7365  s.m32 = _fmod(se
+000164c0: 6c66 2e6d 3332 2c20 6d62 2e6d 3332 290a  lf.m32, mb.m32).
+000164d0: 2020 2020 2020 2020 2020 2020 7265 732e              res.
+000164e0: 6d33 3320 3d20 5f66 6d6f 6428 7365 6c66  m33 = _fmod(self
+000164f0: 2e6d 3333 2c20 6d62 2e6d 3333 290a 2020  .m33, mb.m33).  
+00016500: 2020 2020 2020 2020 2020 7265 732e 6d33            res.m3
+00016510: 3420 3d20 5f66 6d6f 6428 7365 6c66 2e6d  4 = _fmod(self.m
+00016520: 3334 2c20 6d62 2e6d 3334 290a 2020 2020  34, mb.m34).    
+00016530: 2020 2020 2020 2020 7265 732e 6d34 3120          res.m41 
+00016540: 3d20 5f66 6d6f 6428 7365 6c66 2e6d 3431  = _fmod(self.m41
+00016550: 2c20 6d62 2e6d 3431 290a 2020 2020 2020  , mb.m41).      
+00016560: 2020 2020 2020 7265 732e 6d34 3220 3d20        res.m42 = 
+00016570: 5f66 6d6f 6428 7365 6c66 2e6d 3432 2c20  _fmod(self.m42, 
+00016580: 6d62 2e6d 3432 290a 2020 2020 2020 2020  mb.m42).        
+00016590: 2020 2020 7265 732e 6d34 3320 3d20 5f66      res.m43 = _f
+000165a0: 6d6f 6428 7365 6c66 2e6d 3433 2c20 6d62  mod(self.m43, mb
+000165b0: 2e6d 3433 290a 2020 2020 2020 2020 2020  .m43).          
+000165c0: 2020 7265 732e 6d34 3420 3d20 5f66 6d6f    res.m44 = _fmo
+000165d0: 6428 7365 6c66 2e6d 3434 2c20 6d62 2e6d  d(self.m44, mb.m
+000165e0: 3434 290a 2020 2020 2020 2020 2020 2020  44).            
+000165f0: 7265 7475 726e 2072 6573 0a0a 2020 2020  return res..    
+00016600: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00016610: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
+00016620: 4572 726f 722c 2022 756e 7375 7070 6f72  Error, "unsuppor
+00016630: 7465 6420 6f70 6572 616e 6420 7479 7065  ted operand type
+00016640: 2066 6f72 2025 220a 0a0a 2020 2020 6465   for %"...    de
+00016650: 6620 5f5f 6e65 675f 5f28 7365 6c66 293a  f __neg__(self):
+00016660: 0a20 2020 2020 2020 2022 2222 4e65 6761  .        """Nega
+00016670: 7469 6f6e 2e0a 0a20 2020 2020 2020 203e  tion...        >
+00016680: 3e3e 204d 3d6d 6174 3428 312c 322c 332c  >> M=mat4(1,2,3,
+00016690: 342c 352c 362c 372c 382c 392c 3130 2c31  4,5,6,7,8,9,10,1
+000166a0: 312c 3132 2c31 332c 3134 2c31 352c 3136  1,12,13,14,15,16
+000166b0: 290a 2020 2020 2020 2020 3e3e 3e20 7072  ).        >>> pr
+000166c0: 696e 7428 2d4d 290a 2020 2020 2020 2020  int(-M).        
+000166d0: 5b20 202d 312e 3030 3030 2c20 2020 2d32  [  -1.0000,   -2
+000166e0: 2e30 3030 302c 2020 202d 332e 3030 3030  .0000,   -3.0000
+000166f0: 2c20 2020 2d34 2e30 3030 305d 0a20 2020  ,   -4.0000].   
+00016700: 2020 2020 205b 2020 2d35 2e30 3030 302c       [  -5.0000,
+00016710: 2020 202d 362e 3030 3030 2c20 2020 2d37     -6.0000,   -7
+00016720: 2e30 3030 302c 2020 202d 382e 3030 3030  .0000,   -8.0000
+00016730: 5d0a 2020 2020 2020 2020 5b20 202d 392e  ].        [  -9.
+00016740: 3030 3030 2c20 202d 3130 2e30 3030 302c  0000,  -10.0000,
+00016750: 2020 2d31 312e 3030 3030 2c20 202d 3132    -11.0000,  -12
+00016760: 2e30 3030 305d 0a20 2020 2020 2020 205b  .0000].        [
+00016770: 202d 3133 2e30 3030 302c 2020 2d31 342e   -13.0000,  -14.
+00016780: 3030 3030 2c20 202d 3135 2e30 3030 302c  0000,  -15.0000,
+00016790: 2020 2d31 362e 3030 3030 5d0a 2020 2020    -16.0000].    
+000167a0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+000167b0: 6364 6566 206d 6174 3420 7265 730a 2020  cdef mat4 res.  
+000167c0: 2020 2020 2020 7265 7320 3d20 6d61 7434        res = mat4
+000167d0: 2829 0a20 2020 2020 2020 2072 6573 2e6d  ().        res.m
+000167e0: 3131 203d 202d 7365 6c66 2e6d 3131 0a20  11 = -self.m11. 
+000167f0: 2020 2020 2020 2072 6573 2e6d 3132 203d         res.m12 =
+00016800: 202d 7365 6c66 2e6d 3132 0a20 2020 2020   -self.m12.     
+00016810: 2020 2072 6573 2e6d 3133 203d 202d 7365     res.m13 = -se
+00016820: 6c66 2e6d 3133 0a20 2020 2020 2020 2072  lf.m13.        r
+00016830: 6573 2e6d 3134 203d 202d 7365 6c66 2e6d  es.m14 = -self.m
+00016840: 3134 0a20 2020 2020 2020 2072 6573 2e6d  14.        res.m
+00016850: 3231 203d 202d 7365 6c66 2e6d 3231 0a20  21 = -self.m21. 
+00016860: 2020 2020 2020 2072 6573 2e6d 3232 203d         res.m22 =
+00016870: 202d 7365 6c66 2e6d 3232 0a20 2020 2020   -self.m22.     
+00016880: 2020 2072 6573 2e6d 3233 203d 202d 7365     res.m23 = -se
+00016890: 6c66 2e6d 3233 0a20 2020 2020 2020 2072  lf.m23.        r
+000168a0: 6573 2e6d 3234 203d 202d 7365 6c66 2e6d  es.m24 = -self.m
+000168b0: 3234 0a20 2020 2020 2020 2072 6573 2e6d  24.        res.m
+000168c0: 3331 203d 202d 7365 6c66 2e6d 3331 0a20  31 = -self.m31. 
+000168d0: 2020 2020 2020 2072 6573 2e6d 3332 203d         res.m32 =
+000168e0: 202d 7365 6c66 2e6d 3332 0a20 2020 2020   -self.m32.     
+000168f0: 2020 2072 6573 2e6d 3333 203d 202d 7365     res.m33 = -se
+00016900: 6c66 2e6d 3333 0a20 2020 2020 2020 2072  lf.m33.        r
+00016910: 6573 2e6d 3334 203d 202d 7365 6c66 2e6d  es.m34 = -self.m
+00016920: 3334 0a20 2020 2020 2020 2072 6573 2e6d  34.        res.m
+00016930: 3431 203d 202d 7365 6c66 2e6d 3431 0a20  41 = -self.m41. 
+00016940: 2020 2020 2020 2072 6573 2e6d 3432 203d         res.m42 =
+00016950: 202d 7365 6c66 2e6d 3432 0a20 2020 2020   -self.m42.     
+00016960: 2020 2072 6573 2e6d 3433 203d 202d 7365     res.m43 = -se
+00016970: 6c66 2e6d 3433 0a20 2020 2020 2020 2072  lf.m43.        r
+00016980: 6573 2e6d 3434 203d 202d 7365 6c66 2e6d  es.m44 = -self.m
+00016990: 3434 0a20 2020 2020 2020 2072 6574 7572  44.        retur
+000169a0: 6e20 7265 730a 0a20 2020 2064 6566 205f  n res..    def _
+000169b0: 5f70 6f73 5f5f 2873 656c 6629 3a0a 2020  _pos__(self):.  
+000169c0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+000169d0: 2020 3e3e 3e20 4d3d 6d61 7434 2831 2c32    >>> M=mat4(1,2
+000169e0: 2c33 2c34 2c35 2c36 2c37 2c38 2c39 2c31  ,3,4,5,6,7,8,9,1
+000169f0: 302c 3131 2c31 322c 3133 2c31 342c 3135  0,11,12,13,14,15
+00016a00: 2c31 3629 0a20 2020 2020 2020 203e 3e3e  ,16).        >>>
+00016a10: 2070 7269 6e74 282b 4d29 0a20 2020 2020   print(+M).     
+00016a20: 2020 205b 2020 2031 2e30 3030 302c 2020     [   1.0000,  
+00016a30: 2020 322e 3030 3030 2c20 2020 2033 2e30    2.0000,    3.0
+00016a40: 3030 302c 2020 2020 342e 3030 3030 5d0a  000,    4.0000].
+00016a50: 2020 2020 2020 2020 5b20 2020 352e 3030          [   5.00
+00016a60: 3030 2c20 2020 2036 2e30 3030 302c 2020  00,    6.0000,  
+00016a70: 2020 372e 3030 3030 2c20 2020 2038 2e30    7.0000,    8.0
+00016a80: 3030 305d 0a20 2020 2020 2020 205b 2020  000].        [  
+00016a90: 2039 2e30 3030 302c 2020 2031 302e 3030   9.0000,   10.00
+00016aa0: 3030 2c20 2020 3131 2e30 3030 302c 2020  00,   11.0000,  
+00016ab0: 2031 322e 3030 3030 5d0a 2020 2020 2020   12.0000].      
+00016ac0: 2020 5b20 2031 332e 3030 3030 2c20 2020    [  13.0000,   
+00016ad0: 3134 2e30 3030 302c 2020 2031 352e 3030  14.0000,   15.00
+00016ae0: 3030 2c20 2020 3136 2e30 3030 305d 0a20  00,   16.0000]. 
+00016af0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00016b00: 2020 2063 6465 6620 6d61 7434 2072 6573     cdef mat4 res
+00016b10: 0a20 2020 2020 2020 2072 6573 203d 206d  .        res = m
+00016b20: 6174 3428 290a 2020 2020 2020 2020 7265  at4().        re
+00016b30: 732e 6d31 3120 3d20 7365 6c66 2e6d 3131  s.m11 = self.m11
+00016b40: 0a20 2020 2020 2020 2072 6573 2e6d 3132  .        res.m12
+00016b50: 203d 2073 656c 662e 6d31 320a 2020 2020   = self.m12.    
+00016b60: 2020 2020 7265 732e 6d31 3320 3d20 7365      res.m13 = se
+00016b70: 6c66 2e6d 3133 0a20 2020 2020 2020 2072  lf.m13.        r
+00016b80: 6573 2e6d 3134 203d 2073 656c 662e 6d31  es.m14 = self.m1
+00016b90: 340a 2020 2020 2020 2020 7265 732e 6d32  4.        res.m2
+00016ba0: 3120 3d20 7365 6c66 2e6d 3231 0a20 2020  1 = self.m21.   
+00016bb0: 2020 2020 2072 6573 2e6d 3232 203d 2073       res.m22 = s
+00016bc0: 656c 662e 6d32 320a 2020 2020 2020 2020  elf.m22.        
+00016bd0: 7265 732e 6d32 3320 3d20 7365 6c66 2e6d  res.m23 = self.m
+00016be0: 3233 0a20 2020 2020 2020 2072 6573 2e6d  23.        res.m
+00016bf0: 3234 203d 2073 656c 662e 6d32 340a 2020  24 = self.m24.  
+00016c00: 2020 2020 2020 7265 732e 6d33 3120 3d20        res.m31 = 
+00016c10: 7365 6c66 2e6d 3331 0a20 2020 2020 2020  self.m31.       
+00016c20: 2072 6573 2e6d 3332 203d 2073 656c 662e   res.m32 = self.
+00016c30: 6d33 320a 2020 2020 2020 2020 7265 732e  m32.        res.
+00016c40: 6d33 3320 3d20 7365 6c66 2e6d 3333 0a20  m33 = self.m33. 
+00016c50: 2020 2020 2020 2072 6573 2e6d 3334 203d         res.m34 =
+00016c60: 2073 656c 662e 6d33 340a 2020 2020 2020   self.m34.      
+00016c70: 2020 7265 732e 6d34 3120 3d20 7365 6c66    res.m41 = self
+00016c80: 2e6d 3431 0a20 2020 2020 2020 2072 6573  .m41.        res
+00016c90: 2e6d 3432 203d 2073 656c 662e 6d34 320a  .m42 = self.m42.
+00016ca0: 2020 2020 2020 2020 7265 732e 6d34 3320          res.m43 
+00016cb0: 3d20 7365 6c66 2e6d 3433 0a20 2020 2020  = self.m43.     
+00016cc0: 2020 2072 6573 2e6d 3434 203d 2073 656c     res.m44 = sel
+00016cd0: 662e 6d34 340a 2020 2020 2020 2020 7265  f.m44.        re
+00016ce0: 7475 726e 2072 6573 0a0a 2020 2020 6465  turn res..    de
+00016cf0: 6620 5f5f 6961 6464 5f5f 2873 656c 662c  f __iadd__(self,
+00016d00: 206d 6174 3420 6f74 6865 7229 3a0a 2020   mat4 other):.  
+00016d10: 2020 2020 2020 2222 2249 6e6c 696e 6520        """Inline 
+00016d20: 6d61 7472 6978 2061 6464 6974 696f 6e2e  matrix addition.
+00016d30: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00016d40: 2020 2020 2073 656c 662e 6d31 3120 3d20       self.m11 = 
+00016d50: 7365 6c66 2e6d 3131 202b 206f 7468 6572  self.m11 + other
+00016d60: 2e6d 3131 0a20 2020 2020 2020 2073 656c  .m11.        sel
+00016d70: 662e 6d31 3220 3d20 7365 6c66 2e6d 3132  f.m12 = self.m12
+00016d80: 202b 206f 7468 6572 2e6d 3132 0a20 2020   + other.m12.   
+00016d90: 2020 2020 2073 656c 662e 6d31 3320 3d20       self.m13 = 
+00016da0: 7365 6c66 2e6d 3133 202b 206f 7468 6572  self.m13 + other
+00016db0: 2e6d 3133 0a20 2020 2020 2020 2073 656c  .m13.        sel
+00016dc0: 662e 6d31 3420 3d20 7365 6c66 2e6d 3134  f.m14 = self.m14
+00016dd0: 202b 206f 7468 6572 2e6d 3134 0a20 2020   + other.m14.   
+00016de0: 2020 2020 2073 656c 662e 6d32 3120 3d20       self.m21 = 
+00016df0: 7365 6c66 2e6d 3231 202b 206f 7468 6572  self.m21 + other
+00016e00: 2e6d 3231 0a20 2020 2020 2020 2073 656c  .m21.        sel
+00016e10: 662e 6d32 3220 3d20 7365 6c66 2e6d 3232  f.m22 = self.m22
+00016e20: 202b 206f 7468 6572 2e6d 3232 0a20 2020   + other.m22.   
+00016e30: 2020 2020 2073 656c 662e 6d32 3320 3d20       self.m23 = 
+00016e40: 7365 6c66 2e6d 3233 202b 206f 7468 6572  self.m23 + other
+00016e50: 2e6d 3233 0a20 2020 2020 2020 2073 656c  .m23.        sel
+00016e60: 662e 6d32 3420 3d20 7365 6c66 2e6d 3234  f.m24 = self.m24
+00016e70: 202b 206f 7468 6572 2e6d 3234 0a20 2020   + other.m24.   
+00016e80: 2020 2020 2073 656c 662e 6d33 3120 3d20       self.m31 = 
+00016e90: 7365 6c66 2e6d 3331 202b 206f 7468 6572  self.m31 + other
+00016ea0: 2e6d 3331 0a20 2020 2020 2020 2073 656c  .m31.        sel
+00016eb0: 662e 6d33 3220 3d20 7365 6c66 2e6d 3332  f.m32 = self.m32
+00016ec0: 202b 206f 7468 6572 2e6d 3332 0a20 2020   + other.m32.   
+00016ed0: 2020 2020 2073 656c 662e 6d33 3320 3d20       self.m33 = 
+00016ee0: 7365 6c66 2e6d 3333 202b 206f 7468 6572  self.m33 + other
+00016ef0: 2e6d 3333 0a20 2020 2020 2020 2073 656c  .m33.        sel
+00016f00: 662e 6d33 3420 3d20 7365 6c66 2e6d 3334  f.m34 = self.m34
+00016f10: 202b 206f 7468 6572 2e6d 3334 0a20 2020   + other.m34.   
+00016f20: 2020 2020 2073 656c 662e 6d34 3120 3d20       self.m41 = 
+00016f30: 7365 6c66 2e6d 3431 202b 206f 7468 6572  self.m41 + other
+00016f40: 2e6d 3431 0a20 2020 2020 2020 2073 656c  .m41.        sel
+00016f50: 662e 6d34 3220 3d20 7365 6c66 2e6d 3432  f.m42 = self.m42
+00016f60: 202b 206f 7468 6572 2e6d 3432 0a20 2020   + other.m42.   
+00016f70: 2020 2020 2073 656c 662e 6d34 3320 3d20       self.m43 = 
+00016f80: 7365 6c66 2e6d 3433 202b 206f 7468 6572  self.m43 + other
+00016f90: 2e6d 3433 0a20 2020 2020 2020 2073 656c  .m43.        sel
+00016fa0: 662e 6d34 3420 3d20 7365 6c66 2e6d 3434  f.m44 = self.m44
+00016fb0: 202b 206f 7468 6572 2e6d 3434 0a20 2020   + other.m44.   
+00016fc0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00016fd0: 0a0a 2020 2020 6465 6620 5f5f 6973 7562  ..    def __isub
+00016fe0: 5f5f 2873 656c 662c 206d 6174 3420 6f74  __(self, mat4 ot
+00016ff0: 6865 7229 3a0a 2020 2020 2020 2020 2222  her):.        ""
+00017000: 2249 6e6c 696e 6520 6d61 7472 6978 2073  "Inline matrix s
+00017010: 7562 7472 6163 7469 6f6e 2e0a 2020 2020  ubtraction..    
+00017020: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00017030: 7365 6c66 2e6d 3131 203d 2073 656c 662e  self.m11 = self.
+00017040: 6d31 3120 2d20 6f74 6865 722e 6d31 310a  m11 - other.m11.
+00017050: 2020 2020 2020 2020 7365 6c66 2e6d 3132          self.m12
+00017060: 203d 2073 656c 662e 6d31 3220 2d20 6f74   = self.m12 - ot
+00017070: 6865 722e 6d31 320a 2020 2020 2020 2020  her.m12.        
+00017080: 7365 6c66 2e6d 3133 203d 2073 656c 662e  self.m13 = self.
+00017090: 6d31 3320 2d20 6f74 6865 722e 6d31 330a  m13 - other.m13.
+000170a0: 2020 2020 2020 2020 7365 6c66 2e6d 3134          self.m14
+000170b0: 203d 2073 656c 662e 6d31 3420 2d20 6f74   = self.m14 - ot
+000170c0: 6865 722e 6d31 340a 2020 2020 2020 2020  her.m14.        
+000170d0: 7365 6c66 2e6d 3231 203d 2073 656c 662e  self.m21 = self.
+000170e0: 6d32 3120 2d20 6f74 6865 722e 6d32 310a  m21 - other.m21.
+000170f0: 2020 2020 2020 2020 7365 6c66 2e6d 3232          self.m22
+00017100: 203d 2073 656c 662e 6d32 3220 2d20 6f74   = self.m22 - ot
+00017110: 6865 722e 6d32 320a 2020 2020 2020 2020  her.m22.        
+00017120: 7365 6c66 2e6d 3233 203d 2073 656c 662e  self.m23 = self.
+00017130: 6d32 3320 2d20 6f74 6865 722e 6d32 330a  m23 - other.m23.
+00017140: 2020 2020 2020 2020 7365 6c66 2e6d 3234          self.m24
+00017150: 203d 2073 656c 662e 6d32 3420 2d20 6f74   = self.m24 - ot
+00017160: 6865 722e 6d32 340a 2020 2020 2020 2020  her.m24.        
+00017170: 7365 6c66 2e6d 3331 203d 2073 656c 662e  self.m31 = self.
+00017180: 6d33 3120 2d20 6f74 6865 722e 6d33 310a  m31 - other.m31.
+00017190: 2020 2020 2020 2020 7365 6c66 2e6d 3332          self.m32
+000171a0: 203d 2073 656c 662e 6d33 3220 2d20 6f74   = self.m32 - ot
+000171b0: 6865 722e 6d33 320a 2020 2020 2020 2020  her.m32.        
+000171c0: 7365 6c66 2e6d 3333 203d 2073 656c 662e  self.m33 = self.
+000171d0: 6d33 3320 2d20 6f74 6865 722e 6d33 330a  m33 - other.m33.
+000171e0: 2020 2020 2020 2020 7365 6c66 2e6d 3334          self.m34
+000171f0: 203d 2073 656c 662e 6d33 3420 2d20 6f74   = self.m34 - ot
+00017200: 6865 722e 6d33 340a 2020 2020 2020 2020  her.m34.        
+00017210: 7365 6c66 2e6d 3431 203d 2073 656c 662e  self.m41 = self.
+00017220: 6d34 3120 2d20 6f74 6865 722e 6d34 310a  m41 - other.m41.
+00017230: 2020 2020 2020 2020 7365 6c66 2e6d 3432          self.m42
+00017240: 203d 2073 656c 662e 6d34 3220 2d20 6f74   = self.m42 - ot
+00017250: 6865 722e 6d34 320a 2020 2020 2020 2020  her.m42.        
+00017260: 7365 6c66 2e6d 3433 203d 2073 656c 662e  self.m43 = self.
+00017270: 6d34 3320 2d20 6f74 6865 722e 6d34 330a  m43 - other.m43.
+00017280: 2020 2020 2020 2020 7365 6c66 2e6d 3434          self.m44
+00017290: 203d 2073 656c 662e 6d34 3420 2d20 6f74   = self.m44 - ot
+000172a0: 6865 722e 6d34 340a 2020 2020 2020 2020  her.m44.        
+000172b0: 7265 7475 726e 2073 656c 660a 0a20 2020  return self..   
+000172c0: 2064 6566 205f 5f69 6d75 6c5f 5f28 7365   def __imul__(se
+000172d0: 6c66 2c20 6f74 6865 7229 3a0a 2020 2020  lf, other):.    
+000172e0: 2020 2020 2222 2249 6e6c 696e 6520 6d75      """Inline mu
+000172f0: 6c74 6970 6c69 6361 7469 6f6e 2028 7363  ltiplication (sc
+00017300: 616c 6172 206f 7220 6d61 7472 6978 292e  alar or matrix).
+00017310: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00017320: 2020 2020 2063 6465 6620 646f 7562 6c65       cdef double
+00017330: 2072 2c20 612c 622c 632c 640a 2020 2020   r, a,b,c,d.    
+00017340: 2020 2020 6364 6566 206d 6174 3420 6d62      cdef mat4 mb
+00017350: 0a0a 2020 2020 2020 2020 7462 203d 2074  ..        tb = t
+00017360: 7970 6528 6f74 6865 7229 0a20 2020 2020  ype(other).     
+00017370: 2020 2069 6620 7462 2069 7320 666c 6f61     if tb is floa
+00017380: 7420 6f72 2074 6220 6973 2069 6e74 206f  t or tb is int o
+00017390: 7220 7462 2069 7320 6c6f 6e67 3a0a 2020  r tb is long:.  
+000173a0: 2020 2020 2020 2020 2020 723d 6f74 6865            r=othe
 000173b0: 720a 2020 2020 2020 2020 2020 2020 7365  r.            se
-000173c0: 6c66 2e6d 3133 203d 2073 656c 662e 6d31  lf.m13 = self.m1
-000173d0: 332a 720a 2020 2020 2020 2020 2020 2020  3*r.            
-000173e0: 7365 6c66 2e6d 3134 203d 2073 656c 662e  self.m14 = self.
-000173f0: 6d31 342a 720a 2020 2020 2020 2020 2020  m14*r.          
-00017400: 2020 7365 6c66 2e6d 3231 203d 2073 656c    self.m21 = sel
-00017410: 662e 6d32 312a 720a 2020 2020 2020 2020  f.m21*r.        
-00017420: 2020 2020 7365 6c66 2e6d 3232 203d 2073      self.m22 = s
-00017430: 656c 662e 6d32 322a 720a 2020 2020 2020  elf.m22*r.      
-00017440: 2020 2020 2020 7365 6c66 2e6d 3233 203d        self.m23 =
-00017450: 2073 656c 662e 6d32 332a 720a 2020 2020   self.m23*r.    
-00017460: 2020 2020 2020 2020 7365 6c66 2e6d 3234          self.m24
-00017470: 203d 2073 656c 662e 6d32 342a 720a 2020   = self.m24*r.  
+000173c0: 6c66 2e6d 3131 203d 2073 656c 662e 6d31  lf.m11 = self.m1
+000173d0: 312a 720a 2020 2020 2020 2020 2020 2020  1*r.            
+000173e0: 7365 6c66 2e6d 3132 203d 2073 656c 662e  self.m12 = self.
+000173f0: 6d31 322a 720a 2020 2020 2020 2020 2020  m12*r.          
+00017400: 2020 7365 6c66 2e6d 3133 203d 2073 656c    self.m13 = sel
+00017410: 662e 6d31 332a 720a 2020 2020 2020 2020  f.m13*r.        
+00017420: 2020 2020 7365 6c66 2e6d 3134 203d 2073      self.m14 = s
+00017430: 656c 662e 6d31 342a 720a 2020 2020 2020  elf.m14*r.      
+00017440: 2020 2020 2020 7365 6c66 2e6d 3231 203d        self.m21 =
+00017450: 2073 656c 662e 6d32 312a 720a 2020 2020   self.m21*r.    
+00017460: 2020 2020 2020 2020 7365 6c66 2e6d 3232          self.m22
+00017470: 203d 2073 656c 662e 6d32 322a 720a 2020   = self.m22*r.  
 00017480: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
-00017490: 3331 203d 2073 656c 662e 6d33 312a 720a  31 = self.m31*r.
+00017490: 3233 203d 2073 656c 662e 6d32 332a 720a  23 = self.m23*r.
 000174a0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000174b0: 2e6d 3332 203d 2073 656c 662e 6d33 322a  .m32 = self.m32*
+000174b0: 2e6d 3234 203d 2073 656c 662e 6d32 342a  .m24 = self.m24*
 000174c0: 720a 2020 2020 2020 2020 2020 2020 7365  r.            se
-000174d0: 6c66 2e6d 3333 203d 2073 656c 662e 6d33  lf.m33 = self.m3
-000174e0: 332a 720a 2020 2020 2020 2020 2020 2020  3*r.            
-000174f0: 7365 6c66 2e6d 3334 203d 2073 656c 662e  self.m34 = self.
-00017500: 6d33 342a 720a 2020 2020 2020 2020 2020  m34*r.          
-00017510: 2020 7365 6c66 2e6d 3431 203d 2073 656c    self.m41 = sel
-00017520: 662e 6d34 312a 720a 2020 2020 2020 2020  f.m41*r.        
-00017530: 2020 2020 7365 6c66 2e6d 3432 203d 2073      self.m42 = s
-00017540: 656c 662e 6d34 322a 720a 2020 2020 2020  elf.m42*r.      
-00017550: 2020 2020 2020 7365 6c66 2e6d 3433 203d        self.m43 =
-00017560: 2073 656c 662e 6d34 332a 720a 2020 2020   self.m43*r.    
-00017570: 2020 2020 2020 2020 7365 6c66 2e6d 3434          self.m44
-00017580: 203d 2073 656c 662e 6d34 342a 720a 2020   = self.m44*r.  
-00017590: 2020 2020 2020 2020 2020 7265 7475 726e            return
-000175a0: 2073 656c 660a 2020 2020 2020 2020 656c   self.        el
-000175b0: 6966 2074 6220 6973 206d 6174 343a 0a20  if tb is mat4:. 
-000175c0: 2020 2020 2020 2020 2020 206d 6220 3d20             mb = 
-000175d0: 6f74 6865 720a 2020 2020 2020 2020 2020  other.          
-000175e0: 2020 6120 3d20 7365 6c66 2e6d 3131 0a20    a = self.m11. 
-000175f0: 2020 2020 2020 2020 2020 2062 203d 2073             b = s
-00017600: 656c 662e 6d31 320a 2020 2020 2020 2020  elf.m12.        
-00017610: 2020 2020 6320 3d20 7365 6c66 2e6d 3133      c = self.m13
-00017620: 0a20 2020 2020 2020 2020 2020 2064 203d  .            d =
-00017630: 2073 656c 662e 6d31 340a 2020 2020 2020   self.m14.      
-00017640: 2020 2020 2020 7365 6c66 2e6d 3131 203d        self.m11 =
-00017650: 2061 2a6d 622e 6d31 312b 622a 6d62 2e6d   a*mb.m11+b*mb.m
-00017660: 3231 2b63 2a6d 622e 6d33 312b 642a 6d62  21+c*mb.m31+d*mb
-00017670: 2e6d 3431 0a20 2020 2020 2020 2020 2020  .m41.           
-00017680: 2073 656c 662e 6d31 3220 3d20 612a 6d62   self.m12 = a*mb
-00017690: 2e6d 3132 2b62 2a6d 622e 6d32 322b 632a  .m12+b*mb.m22+c*
-000176a0: 6d62 2e6d 3332 2b64 2a6d 622e 6d34 320a  mb.m32+d*mb.m42.
-000176b0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000176c0: 2e6d 3133 203d 2061 2a6d 622e 6d31 332b  .m13 = a*mb.m13+
-000176d0: 622a 6d62 2e6d 3233 2b63 2a6d 622e 6d33  b*mb.m23+c*mb.m3
-000176e0: 332b 642a 6d62 2e6d 3433 0a20 2020 2020  3+d*mb.m43.     
-000176f0: 2020 2020 2020 2073 656c 662e 6d31 3420         self.m14 
-00017700: 3d20 612a 6d62 2e6d 3134 2b62 2a6d 622e  = a*mb.m14+b*mb.
-00017710: 6d32 342b 632a 6d62 2e6d 3334 2b64 2a6d  m24+c*mb.m34+d*m
-00017720: 622e 6d34 340a 2020 2020 2020 2020 2020  b.m44.          
-00017730: 2020 6120 3d20 7365 6c66 2e6d 3231 0a20    a = self.m21. 
-00017740: 2020 2020 2020 2020 2020 2062 203d 2073             b = s
-00017750: 656c 662e 6d32 320a 2020 2020 2020 2020  elf.m22.        
-00017760: 2020 2020 6320 3d20 7365 6c66 2e6d 3233      c = self.m23
-00017770: 0a20 2020 2020 2020 2020 2020 2064 203d  .            d =
-00017780: 2073 656c 662e 6d32 340a 2020 2020 2020   self.m24.      
-00017790: 2020 2020 2020 7365 6c66 2e6d 3231 203d        self.m21 =
-000177a0: 2061 2a6d 622e 6d31 312b 622a 6d62 2e6d   a*mb.m11+b*mb.m
-000177b0: 3231 2b63 2a6d 622e 6d33 312b 642a 6d62  21+c*mb.m31+d*mb
-000177c0: 2e6d 3431 0a20 2020 2020 2020 2020 2020  .m41.           
-000177d0: 2073 656c 662e 6d32 3220 3d20 612a 6d62   self.m22 = a*mb
-000177e0: 2e6d 3132 2b62 2a6d 622e 6d32 322b 632a  .m12+b*mb.m22+c*
-000177f0: 6d62 2e6d 3332 2b64 2a6d 622e 6d34 320a  mb.m32+d*mb.m42.
-00017800: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00017810: 2e6d 3233 203d 2061 2a6d 622e 6d31 332b  .m23 = a*mb.m13+
-00017820: 622a 6d62 2e6d 3233 2b63 2a6d 622e 6d33  b*mb.m23+c*mb.m3
-00017830: 332b 642a 6d62 2e6d 3433 0a20 2020 2020  3+d*mb.m43.     
-00017840: 2020 2020 2020 2073 656c 662e 6d32 3420         self.m24 
-00017850: 3d20 612a 6d62 2e6d 3134 2b62 2a6d 622e  = a*mb.m14+b*mb.
-00017860: 6d32 342b 632a 6d62 2e6d 3334 2b64 2a6d  m24+c*mb.m34+d*m
-00017870: 622e 6d34 340a 2020 2020 2020 2020 2020  b.m44.          
-00017880: 2020 6120 3d20 7365 6c66 2e6d 3331 0a20    a = self.m31. 
-00017890: 2020 2020 2020 2020 2020 2062 203d 2073             b = s
-000178a0: 656c 662e 6d33 320a 2020 2020 2020 2020  elf.m32.        
-000178b0: 2020 2020 6320 3d20 7365 6c66 2e6d 3333      c = self.m33
-000178c0: 0a20 2020 2020 2020 2020 2020 2064 203d  .            d =
-000178d0: 2073 656c 662e 6d33 340a 2020 2020 2020   self.m34.      
-000178e0: 2020 2020 2020 7365 6c66 2e6d 3331 203d        self.m31 =
-000178f0: 2061 2a6d 622e 6d31 312b 622a 6d62 2e6d   a*mb.m11+b*mb.m
-00017900: 3231 2b63 2a6d 622e 6d33 312b 642a 6d62  21+c*mb.m31+d*mb
-00017910: 2e6d 3431 0a20 2020 2020 2020 2020 2020  .m41.           
-00017920: 2073 656c 662e 6d33 3220 3d20 612a 6d62   self.m32 = a*mb
-00017930: 2e6d 3132 2b62 2a6d 622e 6d32 322b 632a  .m12+b*mb.m22+c*
-00017940: 6d62 2e6d 3332 2b64 2a6d 622e 6d34 320a  mb.m32+d*mb.m42.
-00017950: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00017960: 2e6d 3333 203d 2061 2a6d 622e 6d31 332b  .m33 = a*mb.m13+
-00017970: 622a 6d62 2e6d 3233 2b63 2a6d 622e 6d33  b*mb.m23+c*mb.m3
-00017980: 332b 642a 6d62 2e6d 3433 0a20 2020 2020  3+d*mb.m43.     
-00017990: 2020 2020 2020 2073 656c 662e 6d33 3420         self.m34 
-000179a0: 3d20 612a 6d62 2e6d 3134 2b62 2a6d 622e  = a*mb.m14+b*mb.
-000179b0: 6d32 342b 632a 6d62 2e6d 3334 2b64 2a6d  m24+c*mb.m34+d*m
-000179c0: 622e 6d34 340a 2020 2020 2020 2020 2020  b.m44.          
-000179d0: 2020 6120 3d20 7365 6c66 2e6d 3431 0a20    a = self.m41. 
-000179e0: 2020 2020 2020 2020 2020 2062 203d 2073             b = s
-000179f0: 656c 662e 6d34 320a 2020 2020 2020 2020  elf.m42.        
-00017a00: 2020 2020 6320 3d20 7365 6c66 2e6d 3433      c = self.m43
-00017a10: 0a20 2020 2020 2020 2020 2020 2064 203d  .            d =
-00017a20: 2073 656c 662e 6d34 340a 2020 2020 2020   self.m44.      
-00017a30: 2020 2020 2020 7365 6c66 2e6d 3431 203d        self.m41 =
-00017a40: 2061 2a6d 622e 6d31 312b 622a 6d62 2e6d   a*mb.m11+b*mb.m
-00017a50: 3231 2b63 2a6d 622e 6d33 312b 642a 6d62  21+c*mb.m31+d*mb
-00017a60: 2e6d 3431 0a20 2020 2020 2020 2020 2020  .m41.           
-00017a70: 2073 656c 662e 6d34 3220 3d20 612a 6d62   self.m42 = a*mb
-00017a80: 2e6d 3132 2b62 2a6d 622e 6d32 322b 632a  .m12+b*mb.m22+c*
-00017a90: 6d62 2e6d 3332 2b64 2a6d 622e 6d34 320a  mb.m32+d*mb.m42.
-00017aa0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00017ab0: 2e6d 3433 203d 2061 2a6d 622e 6d31 332b  .m43 = a*mb.m13+
-00017ac0: 622a 6d62 2e6d 3233 2b63 2a6d 622e 6d33  b*mb.m23+c*mb.m3
-00017ad0: 332b 642a 6d62 2e6d 3433 0a20 2020 2020  3+d*mb.m43.     
-00017ae0: 2020 2020 2020 2073 656c 662e 6d34 3420         self.m44 
-00017af0: 3d20 612a 6d62 2e6d 3134 2b62 2a6d 622e  = a*mb.m14+b*mb.
-00017b00: 6d32 342b 632a 6d62 2e6d 3334 2b64 2a6d  m24+c*mb.m34+d*m
-00017b10: 622e 6d34 340a 2020 2020 2020 2020 2020  b.m44.          
-00017b20: 2020 7265 7475 726e 2073 656c 660a 2020    return self.  
-00017b30: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-00017b40: 2020 2020 2020 2020 7261 6973 6520 5479          raise Ty
-00017b50: 7065 4572 726f 722c 2022 756e 7375 7070  peError, "unsupp
-00017b60: 6f72 7465 6420 6f70 6572 616e 6420 7479  orted operand ty
-00017b70: 7065 2066 6f72 202a 3d22 0a0a 2020 2020  pe for *="..    
-00017b80: 6465 6620 5f5f 6964 6976 5f5f 2873 656c  def __idiv__(sel
-00017b90: 662c 206f 7468 6572 293a 0a20 2020 2020  f, other):.     
-00017ba0: 2020 2022 2222 496e 6c69 6e65 2064 6976     """Inline div
-00017bb0: 6973 696f 6e20 7769 7468 2073 6361 6c61  ision with scala
-00017bc0: 722e 0a20 2020 2020 2020 2022 2222 0a20  r..        """. 
-00017bd0: 2020 2020 2020 2063 6465 6620 646f 7562         cdef doub
-00017be0: 6c65 2072 0a20 2020 2020 2020 2074 6220  le r.        tb 
-00017bf0: 3d20 7479 7065 286f 7468 6572 290a 2020  = type(other).  
-00017c00: 2020 2020 2020 6966 2074 6220 6973 2066        if tb is f
-00017c10: 6c6f 6174 206f 7220 7462 2069 7320 696e  loat or tb is in
-00017c20: 7420 6f72 2074 6220 6973 206c 6f6e 673a  t or tb is long:
-00017c30: 0a20 2020 2020 2020 2020 2020 2072 3d6f  .            r=o
-00017c40: 7468 6572 0a20 2020 2020 2020 2020 2020  ther.           
-00017c50: 2069 6620 6661 6273 2872 293c 3d65 7073   if fabs(r)<=eps
-00017c60: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00017c70: 2020 7261 6973 6520 5a65 726f 4469 7669    raise ZeroDivi
-00017c80: 7369 6f6e 4572 726f 722c 226d 6174 3420  sionError,"mat4 
-00017c90: 6469 7669 7369 6f6e 220a 2020 2020 2020  division".      
-00017ca0: 2020 2020 2020 7365 6c66 2e6d 3131 203d        self.m11 =
-00017cb0: 2073 656c 662e 6d31 312f 720a 2020 2020   self.m11/r.    
-00017cc0: 2020 2020 2020 2020 7365 6c66 2e6d 3132          self.m12
-00017cd0: 203d 2073 656c 662e 6d31 322f 720a 2020   = self.m12/r.  
+000174d0: 6c66 2e6d 3331 203d 2073 656c 662e 6d33  lf.m31 = self.m3
+000174e0: 312a 720a 2020 2020 2020 2020 2020 2020  1*r.            
+000174f0: 7365 6c66 2e6d 3332 203d 2073 656c 662e  self.m32 = self.
+00017500: 6d33 322a 720a 2020 2020 2020 2020 2020  m32*r.          
+00017510: 2020 7365 6c66 2e6d 3333 203d 2073 656c    self.m33 = sel
+00017520: 662e 6d33 332a 720a 2020 2020 2020 2020  f.m33*r.        
+00017530: 2020 2020 7365 6c66 2e6d 3334 203d 2073      self.m34 = s
+00017540: 656c 662e 6d33 342a 720a 2020 2020 2020  elf.m34*r.      
+00017550: 2020 2020 2020 7365 6c66 2e6d 3431 203d        self.m41 =
+00017560: 2073 656c 662e 6d34 312a 720a 2020 2020   self.m41*r.    
+00017570: 2020 2020 2020 2020 7365 6c66 2e6d 3432          self.m42
+00017580: 203d 2073 656c 662e 6d34 322a 720a 2020   = self.m42*r.  
+00017590: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+000175a0: 3433 203d 2073 656c 662e 6d34 332a 720a  43 = self.m43*r.
+000175b0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000175c0: 2e6d 3434 203d 2073 656c 662e 6d34 342a  .m44 = self.m44*
+000175d0: 720a 2020 2020 2020 2020 2020 2020 7265  r.            re
+000175e0: 7475 726e 2073 656c 660a 2020 2020 2020  turn self.      
+000175f0: 2020 656c 6966 2074 6220 6973 206d 6174    elif tb is mat
+00017600: 343a 0a20 2020 2020 2020 2020 2020 206d  4:.            m
+00017610: 6220 3d20 6f74 6865 720a 2020 2020 2020  b = other.      
+00017620: 2020 2020 2020 6120 3d20 7365 6c66 2e6d        a = self.m
+00017630: 3131 0a20 2020 2020 2020 2020 2020 2062  11.            b
+00017640: 203d 2073 656c 662e 6d31 320a 2020 2020   = self.m12.    
+00017650: 2020 2020 2020 2020 6320 3d20 7365 6c66          c = self
+00017660: 2e6d 3133 0a20 2020 2020 2020 2020 2020  .m13.           
+00017670: 2064 203d 2073 656c 662e 6d31 340a 2020   d = self.m14.  
+00017680: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+00017690: 3131 203d 2061 2a6d 622e 6d31 312b 622a  11 = a*mb.m11+b*
+000176a0: 6d62 2e6d 3231 2b63 2a6d 622e 6d33 312b  mb.m21+c*mb.m31+
+000176b0: 642a 6d62 2e6d 3431 0a20 2020 2020 2020  d*mb.m41.       
+000176c0: 2020 2020 2073 656c 662e 6d31 3220 3d20       self.m12 = 
+000176d0: 612a 6d62 2e6d 3132 2b62 2a6d 622e 6d32  a*mb.m12+b*mb.m2
+000176e0: 322b 632a 6d62 2e6d 3332 2b64 2a6d 622e  2+c*mb.m32+d*mb.
+000176f0: 6d34 320a 2020 2020 2020 2020 2020 2020  m42.            
+00017700: 7365 6c66 2e6d 3133 203d 2061 2a6d 622e  self.m13 = a*mb.
+00017710: 6d31 332b 622a 6d62 2e6d 3233 2b63 2a6d  m13+b*mb.m23+c*m
+00017720: 622e 6d33 332b 642a 6d62 2e6d 3433 0a20  b.m33+d*mb.m43. 
+00017730: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00017740: 6d31 3420 3d20 612a 6d62 2e6d 3134 2b62  m14 = a*mb.m14+b
+00017750: 2a6d 622e 6d32 342b 632a 6d62 2e6d 3334  *mb.m24+c*mb.m34
+00017760: 2b64 2a6d 622e 6d34 340a 2020 2020 2020  +d*mb.m44.      
+00017770: 2020 2020 2020 6120 3d20 7365 6c66 2e6d        a = self.m
+00017780: 3231 0a20 2020 2020 2020 2020 2020 2062  21.            b
+00017790: 203d 2073 656c 662e 6d32 320a 2020 2020   = self.m22.    
+000177a0: 2020 2020 2020 2020 6320 3d20 7365 6c66          c = self
+000177b0: 2e6d 3233 0a20 2020 2020 2020 2020 2020  .m23.           
+000177c0: 2064 203d 2073 656c 662e 6d32 340a 2020   d = self.m24.  
+000177d0: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+000177e0: 3231 203d 2061 2a6d 622e 6d31 312b 622a  21 = a*mb.m11+b*
+000177f0: 6d62 2e6d 3231 2b63 2a6d 622e 6d33 312b  mb.m21+c*mb.m31+
+00017800: 642a 6d62 2e6d 3431 0a20 2020 2020 2020  d*mb.m41.       
+00017810: 2020 2020 2073 656c 662e 6d32 3220 3d20       self.m22 = 
+00017820: 612a 6d62 2e6d 3132 2b62 2a6d 622e 6d32  a*mb.m12+b*mb.m2
+00017830: 322b 632a 6d62 2e6d 3332 2b64 2a6d 622e  2+c*mb.m32+d*mb.
+00017840: 6d34 320a 2020 2020 2020 2020 2020 2020  m42.            
+00017850: 7365 6c66 2e6d 3233 203d 2061 2a6d 622e  self.m23 = a*mb.
+00017860: 6d31 332b 622a 6d62 2e6d 3233 2b63 2a6d  m13+b*mb.m23+c*m
+00017870: 622e 6d33 332b 642a 6d62 2e6d 3433 0a20  b.m33+d*mb.m43. 
+00017880: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00017890: 6d32 3420 3d20 612a 6d62 2e6d 3134 2b62  m24 = a*mb.m14+b
+000178a0: 2a6d 622e 6d32 342b 632a 6d62 2e6d 3334  *mb.m24+c*mb.m34
+000178b0: 2b64 2a6d 622e 6d34 340a 2020 2020 2020  +d*mb.m44.      
+000178c0: 2020 2020 2020 6120 3d20 7365 6c66 2e6d        a = self.m
+000178d0: 3331 0a20 2020 2020 2020 2020 2020 2062  31.            b
+000178e0: 203d 2073 656c 662e 6d33 320a 2020 2020   = self.m32.    
+000178f0: 2020 2020 2020 2020 6320 3d20 7365 6c66          c = self
+00017900: 2e6d 3333 0a20 2020 2020 2020 2020 2020  .m33.           
+00017910: 2064 203d 2073 656c 662e 6d33 340a 2020   d = self.m34.  
+00017920: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+00017930: 3331 203d 2061 2a6d 622e 6d31 312b 622a  31 = a*mb.m11+b*
+00017940: 6d62 2e6d 3231 2b63 2a6d 622e 6d33 312b  mb.m21+c*mb.m31+
+00017950: 642a 6d62 2e6d 3431 0a20 2020 2020 2020  d*mb.m41.       
+00017960: 2020 2020 2073 656c 662e 6d33 3220 3d20       self.m32 = 
+00017970: 612a 6d62 2e6d 3132 2b62 2a6d 622e 6d32  a*mb.m12+b*mb.m2
+00017980: 322b 632a 6d62 2e6d 3332 2b64 2a6d 622e  2+c*mb.m32+d*mb.
+00017990: 6d34 320a 2020 2020 2020 2020 2020 2020  m42.            
+000179a0: 7365 6c66 2e6d 3333 203d 2061 2a6d 622e  self.m33 = a*mb.
+000179b0: 6d31 332b 622a 6d62 2e6d 3233 2b63 2a6d  m13+b*mb.m23+c*m
+000179c0: 622e 6d33 332b 642a 6d62 2e6d 3433 0a20  b.m33+d*mb.m43. 
+000179d0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000179e0: 6d33 3420 3d20 612a 6d62 2e6d 3134 2b62  m34 = a*mb.m14+b
+000179f0: 2a6d 622e 6d32 342b 632a 6d62 2e6d 3334  *mb.m24+c*mb.m34
+00017a00: 2b64 2a6d 622e 6d34 340a 2020 2020 2020  +d*mb.m44.      
+00017a10: 2020 2020 2020 6120 3d20 7365 6c66 2e6d        a = self.m
+00017a20: 3431 0a20 2020 2020 2020 2020 2020 2062  41.            b
+00017a30: 203d 2073 656c 662e 6d34 320a 2020 2020   = self.m42.    
+00017a40: 2020 2020 2020 2020 6320 3d20 7365 6c66          c = self
+00017a50: 2e6d 3433 0a20 2020 2020 2020 2020 2020  .m43.           
+00017a60: 2064 203d 2073 656c 662e 6d34 340a 2020   d = self.m44.  
+00017a70: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+00017a80: 3431 203d 2061 2a6d 622e 6d31 312b 622a  41 = a*mb.m11+b*
+00017a90: 6d62 2e6d 3231 2b63 2a6d 622e 6d33 312b  mb.m21+c*mb.m31+
+00017aa0: 642a 6d62 2e6d 3431 0a20 2020 2020 2020  d*mb.m41.       
+00017ab0: 2020 2020 2073 656c 662e 6d34 3220 3d20       self.m42 = 
+00017ac0: 612a 6d62 2e6d 3132 2b62 2a6d 622e 6d32  a*mb.m12+b*mb.m2
+00017ad0: 322b 632a 6d62 2e6d 3332 2b64 2a6d 622e  2+c*mb.m32+d*mb.
+00017ae0: 6d34 320a 2020 2020 2020 2020 2020 2020  m42.            
+00017af0: 7365 6c66 2e6d 3433 203d 2061 2a6d 622e  self.m43 = a*mb.
+00017b00: 6d31 332b 622a 6d62 2e6d 3233 2b63 2a6d  m13+b*mb.m23+c*m
+00017b10: 622e 6d33 332b 642a 6d62 2e6d 3433 0a20  b.m33+d*mb.m43. 
+00017b20: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00017b30: 6d34 3420 3d20 612a 6d62 2e6d 3134 2b62  m44 = a*mb.m14+b
+00017b40: 2a6d 622e 6d32 342b 632a 6d62 2e6d 3334  *mb.m24+c*mb.m34
+00017b50: 2b64 2a6d 622e 6d34 340a 2020 2020 2020  +d*mb.m44.      
+00017b60: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00017b70: 660a 2020 2020 2020 2020 656c 7365 3a0a  f.        else:.
+00017b80: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00017b90: 6520 5479 7065 4572 726f 722c 2022 756e  e TypeError, "un
+00017ba0: 7375 7070 6f72 7465 6420 6f70 6572 616e  supported operan
+00017bb0: 6420 7479 7065 2066 6f72 202a 3d22 0a0a  d type for *="..
+00017bc0: 2020 2020 6465 6620 5f5f 6964 6976 5f5f      def __idiv__
+00017bd0: 2873 656c 662c 206f 7468 6572 293a 0a20  (self, other):. 
+00017be0: 2020 2020 2020 2022 2222 496e 6c69 6e65         """Inline
+00017bf0: 2064 6976 6973 696f 6e20 7769 7468 2073   division with s
+00017c00: 6361 6c61 722e 0a20 2020 2020 2020 2022  calar..        "
+00017c10: 2222 0a20 2020 2020 2020 2063 6465 6620  "".        cdef 
+00017c20: 646f 7562 6c65 2072 0a20 2020 2020 2020  double r.       
+00017c30: 2074 6220 3d20 7479 7065 286f 7468 6572   tb = type(other
+00017c40: 290a 2020 2020 2020 2020 6966 2074 6220  ).        if tb 
+00017c50: 6973 2066 6c6f 6174 206f 7220 7462 2069  is float or tb i
+00017c60: 7320 696e 7420 6f72 2074 6220 6973 206c  s int or tb is l
+00017c70: 6f6e 673a 0a20 2020 2020 2020 2020 2020  ong:.           
+00017c80: 2072 3d6f 7468 6572 0a20 2020 2020 2020   r=other.       
+00017c90: 2020 2020 2069 6620 6661 6273 2872 293c       if fabs(r)<
+00017ca0: 3d65 7073 3a0a 2020 2020 2020 2020 2020  =eps:.          
+00017cb0: 2020 2020 2020 7261 6973 6520 5a65 726f        raise Zero
+00017cc0: 4469 7669 7369 6f6e 4572 726f 722c 226d  DivisionError,"m
+00017cd0: 6174 3420 6469 7669 7369 6f6e 220a 2020  at4 division".  
 00017ce0: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
-00017cf0: 3133 203d 2073 656c 662e 6d31 332f 720a  13 = self.m13/r.
+00017cf0: 3131 203d 2073 656c 662e 6d31 312f 720a  11 = self.m11/r.
 00017d00: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00017d10: 2e6d 3134 203d 2073 656c 662e 6d31 342f  .m14 = self.m14/
+00017d10: 2e6d 3132 203d 2073 656c 662e 6d31 322f  .m12 = self.m12/
 00017d20: 720a 2020 2020 2020 2020 2020 2020 7365  r.            se
-00017d30: 6c66 2e6d 3231 203d 2073 656c 662e 6d32  lf.m21 = self.m2
-00017d40: 312f 720a 2020 2020 2020 2020 2020 2020  1/r.            
-00017d50: 7365 6c66 2e6d 3232 203d 2073 656c 662e  self.m22 = self.
-00017d60: 6d32 322f 720a 2020 2020 2020 2020 2020  m22/r.          
-00017d70: 2020 7365 6c66 2e6d 3233 203d 2073 656c    self.m23 = sel
-00017d80: 662e 6d32 332f 720a 2020 2020 2020 2020  f.m23/r.        
-00017d90: 2020 2020 7365 6c66 2e6d 3234 203d 2073      self.m24 = s
-00017da0: 656c 662e 6d32 342f 720a 2020 2020 2020  elf.m24/r.      
-00017db0: 2020 2020 2020 7365 6c66 2e6d 3331 203d        self.m31 =
-00017dc0: 2073 656c 662e 6d33 312f 720a 2020 2020   self.m31/r.    
-00017dd0: 2020 2020 2020 2020 7365 6c66 2e6d 3332          self.m32
-00017de0: 203d 2073 656c 662e 6d33 322f 720a 2020   = self.m32/r.  
+00017d30: 6c66 2e6d 3133 203d 2073 656c 662e 6d31  lf.m13 = self.m1
+00017d40: 332f 720a 2020 2020 2020 2020 2020 2020  3/r.            
+00017d50: 7365 6c66 2e6d 3134 203d 2073 656c 662e  self.m14 = self.
+00017d60: 6d31 342f 720a 2020 2020 2020 2020 2020  m14/r.          
+00017d70: 2020 7365 6c66 2e6d 3231 203d 2073 656c    self.m21 = sel
+00017d80: 662e 6d32 312f 720a 2020 2020 2020 2020  f.m21/r.        
+00017d90: 2020 2020 7365 6c66 2e6d 3232 203d 2073      self.m22 = s
+00017da0: 656c 662e 6d32 322f 720a 2020 2020 2020  elf.m22/r.      
+00017db0: 2020 2020 2020 7365 6c66 2e6d 3233 203d        self.m23 =
+00017dc0: 2073 656c 662e 6d32 332f 720a 2020 2020   self.m23/r.    
+00017dd0: 2020 2020 2020 2020 7365 6c66 2e6d 3234          self.m24
+00017de0: 203d 2073 656c 662e 6d32 342f 720a 2020   = self.m24/r.  
 00017df0: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
-00017e00: 3333 203d 2073 656c 662e 6d33 332f 720a  33 = self.m33/r.
+00017e00: 3331 203d 2073 656c 662e 6d33 312f 720a  31 = self.m31/r.
 00017e10: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00017e20: 2e6d 3334 203d 2073 656c 662e 6d33 342f  .m34 = self.m34/
+00017e20: 2e6d 3332 203d 2073 656c 662e 6d33 322f  .m32 = self.m32/
 00017e30: 720a 2020 2020 2020 2020 2020 2020 7365  r.            se
-00017e40: 6c66 2e6d 3431 203d 2073 656c 662e 6d34  lf.m41 = self.m4
-00017e50: 312f 720a 2020 2020 2020 2020 2020 2020  1/r.            
-00017e60: 7365 6c66 2e6d 3432 203d 2073 656c 662e  self.m42 = self.
-00017e70: 6d34 322f 720a 2020 2020 2020 2020 2020  m42/r.          
-00017e80: 2020 7365 6c66 2e6d 3433 203d 2073 656c    self.m43 = sel
-00017e90: 662e 6d34 332f 720a 2020 2020 2020 2020  f.m43/r.        
-00017ea0: 2020 2020 7365 6c66 2e6d 3434 203d 2073      self.m44 = s
-00017eb0: 656c 662e 6d34 342f 720a 2020 2020 2020  elf.m44/r.      
-00017ec0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00017ed0: 660a 2020 2020 2020 2020 656c 7365 3a0a  f.        else:.
-00017ee0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00017ef0: 6520 5479 7065 4572 726f 722c 2022 756e  e TypeError, "un
-00017f00: 7375 7070 6f72 7465 6420 6f70 6572 616e  supported operan
-00017f10: 6420 7479 7065 2066 6f72 202f 3d22 0a0a  d type for /="..
-00017f20: 2020 2020 6465 6620 5f5f 696d 6f64 5f5f      def __imod__
-00017f30: 2873 656c 662c 2062 293a 0a20 2020 2020  (self, b):.     
-00017f40: 2020 2022 2222 496e 6c69 6e65 206d 6f64     """Inline mod
-00017f50: 756c 6f2e 0a20 2020 2020 2020 2022 2222  ulo..        """
-00017f60: 0a20 2020 2020 2020 2063 6465 6620 6d61  .        cdef ma
-00017f70: 7434 206d 620a 2020 2020 2020 2020 6364  t4 mb.        cd
-00017f80: 6566 2064 6f75 626c 6520 720a 0a20 2020  ef double r..   
-00017f90: 2020 2020 2074 6220 3d20 7479 7065 2862       tb = type(b
-00017fa0: 290a 0a20 2020 2020 2020 2069 6620 7462  )..        if tb
-00017fb0: 2069 7320 666c 6f61 7420 6f72 2074 6220   is float or tb 
-00017fc0: 6973 2069 6e74 206f 7220 7462 2069 7320  is int or tb is 
-00017fd0: 6c6f 6e67 3a0a 2020 2020 2020 2020 2020  long:.          
-00017fe0: 2020 7220 3d20 620a 2020 2020 2020 2020    r = b.        
-00017ff0: 2020 2020 6966 2066 6162 7328 7229 3c3d      if fabs(r)<=
-00018000: 6570 733a 0a20 2020 2020 2020 2020 2020  eps:.           
-00018010: 2020 2020 2072 6169 7365 205a 6572 6f44       raise ZeroD
-00018020: 6976 6973 696f 6e45 7272 6f72 2c22 6d61  ivisionError,"ma
-00018030: 7434 206d 6f64 756c 6f22 0a20 2020 2020  t4 modulo".     
-00018040: 2020 2020 2020 2073 656c 662e 6d31 3120         self.m11 
-00018050: 3d20 5f66 6d6f 6428 7365 6c66 2e6d 3131  = _fmod(self.m11
-00018060: 2c20 7229 0a20 2020 2020 2020 2020 2020  , r).           
-00018070: 2073 656c 662e 6d31 3220 3d20 5f66 6d6f   self.m12 = _fmo
-00018080: 6428 7365 6c66 2e6d 3132 2c20 7229 0a20  d(self.m12, r). 
-00018090: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-000180a0: 6d31 3320 3d20 5f66 6d6f 6428 7365 6c66  m13 = _fmod(self
-000180b0: 2e6d 3133 2c20 7229 0a20 2020 2020 2020  .m13, r).       
-000180c0: 2020 2020 2073 656c 662e 6d31 3420 3d20       self.m14 = 
-000180d0: 5f66 6d6f 6428 7365 6c66 2e6d 3134 2c20  _fmod(self.m14, 
-000180e0: 7229 0a20 2020 2020 2020 2020 2020 2073  r).            s
-000180f0: 656c 662e 6d32 3120 3d20 5f66 6d6f 6428  elf.m21 = _fmod(
-00018100: 7365 6c66 2e6d 3231 2c20 7229 0a20 2020  self.m21, r).   
-00018110: 2020 2020 2020 2020 2073 656c 662e 6d32           self.m2
-00018120: 3220 3d20 5f66 6d6f 6428 7365 6c66 2e6d  2 = _fmod(self.m
-00018130: 3232 2c20 7229 0a20 2020 2020 2020 2020  22, r).         
-00018140: 2020 2073 656c 662e 6d32 3320 3d20 5f66     self.m23 = _f
-00018150: 6d6f 6428 7365 6c66 2e6d 3233 2c20 7229  mod(self.m23, r)
-00018160: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00018170: 662e 6d32 3420 3d20 5f66 6d6f 6428 7365  f.m24 = _fmod(se
-00018180: 6c66 2e6d 3234 2c20 7229 0a20 2020 2020  lf.m24, r).     
-00018190: 2020 2020 2020 2073 656c 662e 6d33 3120         self.m31 
-000181a0: 3d20 5f66 6d6f 6428 7365 6c66 2e6d 3331  = _fmod(self.m31
-000181b0: 2c20 7229 0a20 2020 2020 2020 2020 2020  , r).           
-000181c0: 2073 656c 662e 6d33 3220 3d20 5f66 6d6f   self.m32 = _fmo
-000181d0: 6428 7365 6c66 2e6d 3332 2c20 7229 0a20  d(self.m32, r). 
-000181e0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-000181f0: 6d33 3320 3d20 5f66 6d6f 6428 7365 6c66  m33 = _fmod(self
-00018200: 2e6d 3333 2c20 7229 0a20 2020 2020 2020  .m33, r).       
-00018210: 2020 2020 2073 656c 662e 6d33 3420 3d20       self.m34 = 
-00018220: 5f66 6d6f 6428 7365 6c66 2e6d 3334 2c20  _fmod(self.m34, 
-00018230: 7229 0a20 2020 2020 2020 2020 2020 2073  r).            s
-00018240: 656c 662e 6d34 3120 3d20 5f66 6d6f 6428  elf.m41 = _fmod(
-00018250: 7365 6c66 2e6d 3431 2c20 7229 0a20 2020  self.m41, r).   
-00018260: 2020 2020 2020 2020 2073 656c 662e 6d34           self.m4
-00018270: 3220 3d20 5f66 6d6f 6428 7365 6c66 2e6d  2 = _fmod(self.m
-00018280: 3432 2c20 7229 0a20 2020 2020 2020 2020  42, r).         
-00018290: 2020 2073 656c 662e 6d34 3320 3d20 5f66     self.m43 = _f
-000182a0: 6d6f 6428 7365 6c66 2e6d 3433 2c20 7229  mod(self.m43, r)
-000182b0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-000182c0: 662e 6d34 3420 3d20 5f66 6d6f 6428 7365  f.m44 = _fmod(se
-000182d0: 6c66 2e6d 3434 2c20 7229 0a20 2020 2020  lf.m44, r).     
-000182e0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-000182f0: 6c66 0a20 2020 2020 2020 2065 6c69 6620  lf.        elif 
-00018300: 7462 2069 7320 6d61 7434 3a0a 2020 2020  tb is mat4:.    
-00018310: 2020 2020 2020 2020 6d62 203d 2062 0a20          mb = b. 
-00018320: 2020 2020 2020 2020 2020 2069 6620 2866             if (f
-00018330: 6162 7328 6d62 2e6d 3131 293c 3d65 7073  abs(mb.m11)<=eps
-00018340: 206f 7220 6661 6273 286d 622e 6d31 3229   or fabs(mb.m12)
-00018350: 3c3d 6570 7320 6f72 2066 6162 7328 6d62  <=eps or fabs(mb
-00018360: 2e6d 3133 293c 3d65 7073 206f 720a 2020  .m13)<=eps or.  
-00018370: 2020 2020 2020 2020 2020 2020 2020 6661                fa
-00018380: 6273 286d 622e 6d31 3429 3c3d 6570 7320  bs(mb.m14)<=eps 
-00018390: 6f72 0a20 2020 2020 2020 2020 2020 2020  or.             
-000183a0: 2020 2066 6162 7328 6d62 2e6d 3231 293c     fabs(mb.m21)<
-000183b0: 3d65 7073 206f 7220 6661 6273 286d 622e  =eps or fabs(mb.
-000183c0: 6d32 3229 3c3d 6570 7320 6f72 2066 6162  m22)<=eps or fab
-000183d0: 7328 6d62 2e6d 3233 293c 3d65 7073 206f  s(mb.m23)<=eps o
-000183e0: 720a 2020 2020 2020 2020 2020 2020 2020  r.              
-000183f0: 2020 6661 6273 286d 622e 6d32 3429 3c3d    fabs(mb.m24)<=
-00018400: 6570 7320 6f72 0a20 2020 2020 2020 2020  eps or.         
-00018410: 2020 2020 2020 2066 6162 7328 6d62 2e6d         fabs(mb.m
-00018420: 3331 293c 3d65 7073 206f 7220 6661 6273  31)<=eps or fabs
-00018430: 286d 622e 6d33 3229 3c3d 6570 7320 6f72  (mb.m32)<=eps or
-00018440: 2066 6162 7328 6d62 2e6d 3333 293c 3d65   fabs(mb.m33)<=e
-00018450: 7073 206f 720a 2020 2020 2020 2020 2020  ps or.          
-00018460: 2020 2020 2020 6661 6273 286d 622e 6d33        fabs(mb.m3
-00018470: 3429 3c3d 6570 7320 6f72 0a20 2020 2020  4)<=eps or.     
-00018480: 2020 2020 2020 2020 2020 2066 6162 7328             fabs(
-00018490: 6d62 2e6d 3431 293c 3d65 7073 206f 7220  mb.m41)<=eps or 
-000184a0: 6661 6273 286d 622e 6d34 3229 3c3d 6570  fabs(mb.m42)<=ep
-000184b0: 7320 6f72 2066 6162 7328 6d62 2e6d 3433  s or fabs(mb.m43
-000184c0: 293c 3d65 7073 206f 720a 2020 2020 2020  )<=eps or.      
-000184d0: 2020 2020 2020 2020 2020 6661 6273 286d            fabs(m
-000184e0: 622e 6d34 3429 3c3d 6570 7329 3a0a 2020  b.m44)<=eps):.  
-000184f0: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-00018500: 6973 6520 5a65 726f 4469 7669 7369 6f6e  ise ZeroDivision
-00018510: 4572 726f 722c 226d 6174 3420 6d6f 6475  Error,"mat4 modu
-00018520: 6c6f 220a 2020 2020 2020 2020 2020 2020  lo".            
-00018530: 7365 6c66 2e6d 3131 203d 205f 666d 6f64  self.m11 = _fmod
-00018540: 2873 656c 662e 6d31 312c 206d 622e 6d31  (self.m11, mb.m1
-00018550: 3129 0a20 2020 2020 2020 2020 2020 2073  1).            s
-00018560: 656c 662e 6d31 3220 3d20 5f66 6d6f 6428  elf.m12 = _fmod(
-00018570: 7365 6c66 2e6d 3132 2c20 6d62 2e6d 3132  self.m12, mb.m12
-00018580: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
-00018590: 6c66 2e6d 3133 203d 205f 666d 6f64 2873  lf.m13 = _fmod(s
-000185a0: 656c 662e 6d31 332c 206d 622e 6d31 3329  elf.m13, mb.m13)
-000185b0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-000185c0: 662e 6d31 3420 3d20 5f66 6d6f 6428 7365  f.m14 = _fmod(se
-000185d0: 6c66 2e6d 3134 2c20 6d62 2e6d 3133 290a  lf.m14, mb.m13).
-000185e0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000185f0: 2e6d 3231 203d 205f 666d 6f64 2873 656c  .m21 = _fmod(sel
-00018600: 662e 6d32 312c 206d 622e 6d32 3129 0a20  f.m21, mb.m21). 
-00018610: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00018620: 6d32 3220 3d20 5f66 6d6f 6428 7365 6c66  m22 = _fmod(self
-00018630: 2e6d 3232 2c20 6d62 2e6d 3232 290a 2020  .m22, mb.m22).  
-00018640: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
-00018650: 3233 203d 205f 666d 6f64 2873 656c 662e  23 = _fmod(self.
-00018660: 6d32 332c 206d 622e 6d32 3329 0a20 2020  m23, mb.m23).   
-00018670: 2020 2020 2020 2020 2073 656c 662e 6d32           self.m2
-00018680: 3420 3d20 5f66 6d6f 6428 7365 6c66 2e6d  4 = _fmod(self.m
-00018690: 3234 2c20 6d62 2e6d 3233 290a 2020 2020  24, mb.m23).    
-000186a0: 2020 2020 2020 2020 7365 6c66 2e6d 3331          self.m31
-000186b0: 203d 205f 666d 6f64 2873 656c 662e 6d33   = _fmod(self.m3
-000186c0: 312c 206d 622e 6d33 3129 0a20 2020 2020  1, mb.m31).     
-000186d0: 2020 2020 2020 2073 656c 662e 6d33 3220         self.m32 
-000186e0: 3d20 5f66 6d6f 6428 7365 6c66 2e6d 3332  = _fmod(self.m32
-000186f0: 2c20 6d62 2e6d 3332 290a 2020 2020 2020  , mb.m32).      
-00018700: 2020 2020 2020 7365 6c66 2e6d 3333 203d        self.m33 =
-00018710: 205f 666d 6f64 2873 656c 662e 6d33 332c   _fmod(self.m33,
-00018720: 206d 622e 6d33 3329 0a20 2020 2020 2020   mb.m33).       
-00018730: 2020 2020 2073 656c 662e 6d33 3420 3d20       self.m34 = 
-00018740: 5f66 6d6f 6428 7365 6c66 2e6d 3334 2c20  _fmod(self.m34, 
-00018750: 6d62 2e6d 3333 290a 2020 2020 2020 2020  mb.m33).        
-00018760: 2020 2020 7365 6c66 2e6d 3431 203d 205f      self.m41 = _
-00018770: 666d 6f64 2873 656c 662e 6d34 312c 206d  fmod(self.m41, m
-00018780: 622e 6d34 3129 0a20 2020 2020 2020 2020  b.m41).         
-00018790: 2020 2073 656c 662e 6d34 3220 3d20 5f66     self.m42 = _f
-000187a0: 6d6f 6428 7365 6c66 2e6d 3432 2c20 6d62  mod(self.m42, mb
-000187b0: 2e6d 3432 290a 2020 2020 2020 2020 2020  .m42).          
-000187c0: 2020 7365 6c66 2e6d 3433 203d 205f 666d    self.m43 = _fm
-000187d0: 6f64 2873 656c 662e 6d34 332c 206d 622e  od(self.m43, mb.
-000187e0: 6d34 3329 0a20 2020 2020 2020 2020 2020  m43).           
-000187f0: 2073 656c 662e 6d34 3420 3d20 5f66 6d6f   self.m44 = _fmo
-00018800: 6428 7365 6c66 2e6d 3434 2c20 6d62 2e6d  d(self.m44, mb.m
-00018810: 3433 290a 2020 2020 2020 2020 2020 2020  43).            
-00018820: 7265 7475 726e 2073 656c 660a 2020 2020  return self.    
-00018830: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00018840: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
-00018850: 4572 726f 722c 2022 756e 7375 7070 6f72  Error, "unsuppor
-00018860: 7465 6420 6f70 6572 616e 6420 7479 7065  ted operand type
-00018870: 2066 6f72 2025 3d22 0a0a 2020 2020 6465   for %="..    de
-00018880: 6620 5f5f 6c65 6e5f 5f28 7365 6c66 293a  f __len__(self):
-00018890: 0a20 2020 2020 2020 2022 2222 4c65 6e67  .        """Leng
-000188a0: 7468 206f 6620 7468 6520 7365 7175 656e  th of the sequen
-000188b0: 6365 2028 616c 7761 7973 2034 292e 2222  ce (always 4).""
-000188c0: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
-000188d0: 2034 0a0a 2020 2020 6465 6620 5f5f 6765   4..    def __ge
-000188e0: 7469 7465 6d5f 5f28 6d61 7434 2073 656c  titem__(mat4 sel
-000188f0: 662c 206b 6579 293a 0a20 2020 2020 2020  f, key):.       
-00018900: 2022 2222 5265 7475 726e 2061 2063 6f6c   """Return a col
-00018910: 756d 6e20 6f72 2061 2073 696e 676c 6520  umn or a single 
-00018920: 6d61 7472 6978 2065 6c65 6d65 6e74 2e0a  matrix element..
-00018930: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00018940: 2020 2020 6364 6566 2069 6e74 2069 2c6a      cdef int i,j
-00018950: 0a0a 2020 2020 2020 2020 543d 7479 7065  ..        T=type
-00018960: 286b 6579 290a 2020 2020 2020 2020 6966  (key).        if
-00018970: 2054 2069 7320 696e 7420 6f72 2054 2069   T is int or T i
-00018980: 7320 6c6f 6e67 3a0a 2020 2020 2020 2020  s long:.        
-00018990: 2020 2020 6920 3d20 6b65 790a 2020 2020      i = key.    
-000189a0: 2020 2020 2020 2020 6966 2069 3d3d 303a          if i==0:
-000189b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000189c0: 2072 6574 7572 6e20 7665 6334 2873 656c   return vec4(sel
-000189d0: 662e 6d31 312c 2073 656c 662e 6d32 312c  f.m11, self.m21,
-000189e0: 2073 656c 662e 6d33 312c 2073 656c 662e   self.m31, self.
-000189f0: 6d34 3129 0a20 2020 2020 2020 2020 2020  m41).           
-00018a00: 2065 6c69 6620 693d 3d31 3a0a 2020 2020   elif i==1:.    
-00018a10: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00018a20: 726e 2076 6563 3428 7365 6c66 2e6d 3132  rn vec4(self.m12
-00018a30: 2c20 7365 6c66 2e6d 3232 2c20 7365 6c66  , self.m22, self
-00018a40: 2e6d 3332 2c20 7365 6c66 2e6d 3432 290a  .m32, self.m42).
-00018a50: 2020 2020 2020 2020 2020 2020 656c 6966              elif
-00018a60: 2069 3d3d 323a 0a20 2020 2020 2020 2020   i==2:.         
-00018a70: 2020 2020 2020 2072 6574 7572 6e20 7665         return ve
-00018a80: 6334 2873 656c 662e 6d31 332c 2073 656c  c4(self.m13, sel
-00018a90: 662e 6d32 332c 2073 656c 662e 6d33 332c  f.m23, self.m33,
-00018aa0: 2073 656c 662e 6d34 3329 0a20 2020 2020   self.m43).     
-00018ab0: 2020 2020 2020 2065 6c69 6620 693d 3d33         elif i==3
-00018ac0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00018ad0: 2020 7265 7475 726e 2076 6563 3428 7365    return vec4(se
-00018ae0: 6c66 2e6d 3134 2c20 7365 6c66 2e6d 3234  lf.m14, self.m24
-00018af0: 2c20 7365 6c66 2e6d 3334 2c20 7365 6c66  , self.m34, self
-00018b00: 2e6d 3434 290a 2020 2020 2020 2020 2020  .m44).          
-00018b10: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00018b20: 2020 2020 2020 2020 7261 6973 6520 496e          raise In
-00018b30: 6465 7845 7272 6f72 2c20 2269 6e64 6578  dexError, "index
-00018b40: 206f 7574 206f 6620 7261 6e67 6522 0a20   out of range". 
-00018b50: 2020 2020 2020 2065 6c69 6620 5420 6973         elif T is
-00018b60: 2074 7570 6c65 3a0a 2020 2020 2020 2020   tuple:.        
-00018b70: 2020 2020 6966 206c 656e 286b 6579 2921      if len(key)!
-00018b80: 3d32 3a0a 2020 2020 2020 2020 2020 2020  =2:.            
-00018b90: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-00018ba0: 7272 6f72 2c20 2269 6e64 6578 2074 7570  rror, "index tup
-00018bb0: 6c65 206d 7573 7420 6265 2061 2032 2d74  le must be a 2-t
-00018bc0: 7570 6c65 220a 2020 2020 2020 2020 2020  uple".          
-00018bd0: 2020 6920 3d20 6b65 795b 305d 0a20 2020    i = key[0].   
-00018be0: 2020 2020 2020 2020 206a 203d 206b 6579           j = key
-00018bf0: 5b31 5d0a 2020 2020 2020 2020 2020 2020  [1].            
-00018c00: 6966 2069 3c30 206f 7220 693e 3320 6f72  if i<0 or i>3 or
-00018c10: 206a 3c30 206f 7220 6a3e 333a 0a20 2020   j<0 or j>3:.   
-00018c20: 2020 2020 2020 2020 2020 2020 2072 6169               rai
-00018c30: 7365 2049 6e64 6578 4572 726f 722c 2022  se IndexError, "
-00018c40: 696e 6465 7820 6f75 7420 6f66 2072 616e  index out of ran
-00018c50: 6765 220a 0a20 2020 2020 2020 2020 2020  ge"..           
-00018c60: 2069 6620 693d 3d30 3a0a 2020 2020 2020   if i==0:.      
-00018c70: 2020 2020 2020 2020 2020 6966 206a 3d3d            if j==
-00018c80: 303a 0a20 2020 2020 2020 2020 2020 2020  0:.             
-00018c90: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00018ca0: 6c66 2e6d 3131 0a20 2020 2020 2020 2020  lf.m11.         
-00018cb0: 2020 2020 2020 2065 6c69 6620 6a3d 3d31         elif j==1
-00018cc0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00018cd0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00018ce0: 662e 6d31 320a 2020 2020 2020 2020 2020  f.m12.          
-00018cf0: 2020 2020 2020 656c 6966 206a 3d3d 323a        elif j==2:
-00018d00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00018d10: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00018d20: 2e6d 3133 0a20 2020 2020 2020 2020 2020  .m13.           
-00018d30: 2020 2020 2065 6c69 6620 6a3d 3d33 3a0a       elif j==3:.
-00018d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018d50: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-00018d60: 6d31 340a 2020 2020 2020 2020 2020 2020  m14.            
-00018d70: 656c 6966 2069 3d3d 313a 0a20 2020 2020  elif i==1:.     
-00018d80: 2020 2020 2020 2020 2020 2069 6620 6a3d             if j=
-00018d90: 3d30 3a0a 2020 2020 2020 2020 2020 2020  =0:.            
-00018da0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00018db0: 656c 662e 6d32 310a 2020 2020 2020 2020  elf.m21.        
-00018dc0: 2020 2020 2020 2020 656c 6966 206a 3d3d          elif j==
-00018dd0: 313a 0a20 2020 2020 2020 2020 2020 2020  1:.             
-00018de0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00018df0: 6c66 2e6d 3232 0a20 2020 2020 2020 2020  lf.m22.         
-00018e00: 2020 2020 2020 2065 6c69 6620 6a3d 3d32         elif j==2
-00018e10: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00018e20: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00018e30: 662e 6d32 330a 2020 2020 2020 2020 2020  f.m23.          
-00018e40: 2020 2020 2020 656c 6966 206a 3d3d 333a        elif j==3:
-00018e50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00018e60: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00018e70: 2e6d 3234 0a20 2020 2020 2020 2020 2020  .m24.           
-00018e80: 2065 6c69 6620 693d 3d32 3a0a 2020 2020   elif i==2:.    
-00018e90: 2020 2020 2020 2020 2020 2020 6966 206a              if j
-00018ea0: 3d3d 303a 0a20 2020 2020 2020 2020 2020  ==0:.           
-00018eb0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00018ec0: 7365 6c66 2e6d 3331 0a20 2020 2020 2020  self.m31.       
-00018ed0: 2020 2020 2020 2020 2065 6c69 6620 6a3d           elif j=
-00018ee0: 3d31 3a0a 2020 2020 2020 2020 2020 2020  =1:.            
-00018ef0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00018f00: 656c 662e 6d33 320a 2020 2020 2020 2020  elf.m32.        
-00018f10: 2020 2020 2020 2020 656c 6966 206a 3d3d          elif j==
-00018f20: 323a 0a20 2020 2020 2020 2020 2020 2020  2:.             
-00018f30: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00018f40: 6c66 2e6d 3333 0a20 2020 2020 2020 2020  lf.m33.         
-00018f50: 2020 2020 2020 2065 6c69 6620 6a3d 3d33         elif j==3
-00018f60: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00018f70: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00018f80: 662e 6d33 340a 2020 2020 2020 2020 2020  f.m34.          
-00018f90: 2020 656c 6966 2069 3d3d 333a 0a20 2020    elif i==3:.   
-00018fa0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00018fb0: 6a3d 3d30 3a0a 2020 2020 2020 2020 2020  j==0:.          
-00018fc0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00018fd0: 2073 656c 662e 6d34 310a 2020 2020 2020   self.m41.      
-00018fe0: 2020 2020 2020 2020 2020 656c 6966 206a            elif j
-00018ff0: 3d3d 313a 0a20 2020 2020 2020 2020 2020  ==1:.           
-00019000: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00019010: 7365 6c66 2e6d 3432 0a20 2020 2020 2020  self.m42.       
-00019020: 2020 2020 2020 2020 2065 6c69 6620 6a3d           elif j=
-00019030: 3d32 3a0a 2020 2020 2020 2020 2020 2020  =2:.            
-00019040: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00019050: 656c 662e 6d34 330a 2020 2020 2020 2020  elf.m43.        
-00019060: 2020 2020 2020 2020 656c 6966 206a 3d3d          elif j==
-00019070: 333a 0a20 2020 2020 2020 2020 2020 2020  3:.             
-00019080: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00019090: 6c66 2e6d 3434 0a20 2020 2020 2020 2065  lf.m44.        e
-000190a0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-000190b0: 2072 6169 7365 2054 7970 6545 7272 6f72   raise TypeError
-000190c0: 2c22 696e 6465 7820 6d75 7374 2062 6520  ,"index must be 
-000190d0: 696e 7465 6765 7220 6f72 2032 2d74 7570  integer or 2-tup
-000190e0: 6c65 220a 0a20 2020 2064 6566 205f 5f73  le"..    def __s
-000190f0: 6574 6974 656d 5f5f 2873 656c 662c 206b  etitem__(self, k
-00019100: 6579 2c20 7661 6c75 6529 3a0a 2020 2020  ey, value):.    
-00019110: 2020 2020 2222 2253 6574 2061 2063 6f6c      """Set a col
-00019120: 756d 6e20 6f72 2061 2073 696e 676c 6520  umn or a single 
-00019130: 6d61 7472 6978 2065 6c65 6d65 6e74 2e0a  matrix element..
-00019140: 0a20 2020 2020 2020 2054 6865 2063 6f6c  .        The col
-00019150: 756d 6e20 6d75 7374 2062 6520 6769 7665  umn must be give
-00019160: 6e20 6173 2061 2034 2d73 6571 7565 6e63  n as a 4-sequenc
-00019170: 6520 2874 6869 7320 696e 636c 7564 6573  e (this includes
-00019180: 2076 6563 3420 6173 2077 656c 6c29 2e0a   vec4 as well)..
-00019190: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-000191a0: 2020 2020 6364 6566 2069 6e74 2069 2c6a      cdef int i,j
-000191b0: 0a20 2020 2020 2020 2063 6465 6620 646f  .        cdef do
-000191c0: 7562 6c65 2076 0a0a 2020 2020 2020 2020  uble v..        
-000191d0: 543d 7479 7065 286b 6579 290a 2020 2020  T=type(key).    
-000191e0: 2020 2020 6966 2054 2069 7320 696e 7420      if T is int 
-000191f0: 6f72 2054 2069 7320 6c6f 6e67 3a0a 2020  or T is long:.  
-00019200: 2020 2020 2020 2020 2020 6966 206c 656e            if len
-00019210: 2876 616c 7565 2921 3d34 3a0a 2020 2020  (value)!=4:.    
-00019220: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00019230: 6520 5661 6c75 6545 7272 6f72 2c20 2234  e ValueError, "4
-00019240: 2d73 6571 7565 6e63 6520 6578 7065 6374  -sequence expect
-00019250: 6564 220a 2020 2020 2020 2020 2020 2020  ed".            
-00019260: 6920 3d20 6b65 790a 2020 2020 2020 2020  i = key.        
-00019270: 2020 2020 6966 2069 3d3d 303a 0a20 2020      if i==0:.   
-00019280: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00019290: 662e 6d31 3120 3d20 7661 6c75 655b 305d  f.m11 = value[0]
-000192a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000192b0: 2073 656c 662e 6d32 3120 3d20 7661 6c75   self.m21 = valu
-000192c0: 655b 315d 0a20 2020 2020 2020 2020 2020  e[1].           
-000192d0: 2020 2020 2073 656c 662e 6d33 3120 3d20       self.m31 = 
-000192e0: 7661 6c75 655b 325d 0a20 2020 2020 2020  value[2].       
-000192f0: 2020 2020 2020 2020 2073 656c 662e 6d34           self.m4
-00019300: 3120 3d20 7661 6c75 655b 335d 0a20 2020  1 = value[3].   
-00019310: 2020 2020 2020 2020 2065 6c69 6620 693d           elif i=
-00019320: 3d31 3a0a 2020 2020 2020 2020 2020 2020  =1:.            
-00019330: 2020 2020 7365 6c66 2e6d 3132 203d 2076      self.m12 = v
-00019340: 616c 7565 5b30 5d0a 2020 2020 2020 2020  alue[0].        
-00019350: 2020 2020 2020 2020 7365 6c66 2e6d 3232          self.m22
-00019360: 203d 2076 616c 7565 5b31 5d0a 2020 2020   = value[1].    
-00019370: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00019380: 2e6d 3332 203d 2076 616c 7565 5b32 5d0a  .m32 = value[2].
-00019390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000193a0: 7365 6c66 2e6d 3432 203d 2076 616c 7565  self.m42 = value
-000193b0: 5b33 5d0a 2020 2020 2020 2020 2020 2020  [3].            
-000193c0: 656c 6966 2069 3d3d 323a 0a20 2020 2020  elif i==2:.     
-000193d0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-000193e0: 6d31 3320 3d20 7661 6c75 655b 305d 0a20  m13 = value[0]. 
-000193f0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00019400: 656c 662e 6d32 3320 3d20 7661 6c75 655b  elf.m23 = value[
-00019410: 315d 0a20 2020 2020 2020 2020 2020 2020  1].             
-00019420: 2020 2073 656c 662e 6d33 3320 3d20 7661     self.m33 = va
-00019430: 6c75 655b 325d 0a20 2020 2020 2020 2020  lue[2].         
-00019440: 2020 2020 2020 2073 656c 662e 6d34 3320         self.m43 
-00019450: 3d20 7661 6c75 655b 335d 0a20 2020 2020  = value[3].     
-00019460: 2020 2020 2020 2065 6c69 6620 693d 3d33         elif i==3
-00019470: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00019480: 2020 7365 6c66 2e6d 3134 203d 2076 616c    self.m14 = val
-00019490: 7565 5b30 5d0a 2020 2020 2020 2020 2020  ue[0].          
-000194a0: 2020 2020 2020 7365 6c66 2e6d 3234 203d        self.m24 =
-000194b0: 2076 616c 7565 5b31 5d0a 2020 2020 2020   value[1].      
-000194c0: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
-000194d0: 3334 203d 2076 616c 7565 5b32 5d0a 2020  34 = value[2].  
-000194e0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-000194f0: 6c66 2e6d 3434 203d 2076 616c 7565 5b33  lf.m44 = value[3
-00019500: 5d0a 2020 2020 2020 2020 2020 2020 656c  ].            el
-00019510: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00019520: 2020 2020 7261 6973 6520 496e 6465 7845      raise IndexE
-00019530: 7272 6f72 2c20 2269 6e64 6578 206f 7574  rror, "index out
-00019540: 206f 6620 7261 6e67 6522 0a20 2020 2020   of range".     
-00019550: 2020 2065 6c69 6620 5420 6973 2074 7570     elif T is tup
-00019560: 6c65 3a0a 2020 2020 2020 2020 2020 2020  le:.            
-00019570: 6966 206c 656e 286b 6579 2921 3d32 3a0a  if len(key)!=2:.
-00019580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019590: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
-000195a0: 2c20 2269 6e64 6578 2074 7570 6c65 206d  , "index tuple m
-000195b0: 7573 7420 6265 2061 2032 2d74 7570 6c65  ust be a 2-tuple
-000195c0: 220a 2020 2020 2020 2020 2020 2020 6920  ".            i 
-000195d0: 3d20 6b65 795b 305d 0a20 2020 2020 2020  = key[0].       
-000195e0: 2020 2020 206a 203d 206b 6579 5b31 5d0a       j = key[1].
-000195f0: 2020 2020 2020 2020 2020 2020 7620 3d20              v = 
-00019600: 7661 6c75 650a 2020 2020 2020 2020 2020  value.          
-00019610: 2020 6966 2069 3c30 206f 7220 693e 3320    if i<0 or i>3 
-00019620: 6f72 206a 3c30 206f 7220 6a3e 333a 0a20  or j<0 or j>3:. 
-00019630: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00019640: 6169 7365 2049 6e64 6578 4572 726f 722c  aise IndexError,
-00019650: 2022 696e 6465 7820 6f75 7420 6f66 2072   "index out of r
-00019660: 616e 6765 220a 0a20 2020 2020 2020 2020  ange"..         
-00019670: 2020 2069 6620 693d 3d30 3a0a 2020 2020     if i==0:.    
-00019680: 2020 2020 2020 2020 2020 2020 6966 206a              if j
-00019690: 3d3d 303a 0a20 2020 2020 2020 2020 2020  ==0:.           
-000196a0: 2020 2020 2020 2020 2073 656c 662e 6d31           self.m1
-000196b0: 3120 3d20 760a 2020 2020 2020 2020 2020  1 = v.          
-000196c0: 2020 2020 2020 656c 6966 206a 3d3d 313a        elif j==1:
-000196d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000196e0: 2020 2020 2073 656c 662e 6d31 3220 3d20       self.m12 = 
-000196f0: 760a 2020 2020 2020 2020 2020 2020 2020  v.              
-00019700: 2020 656c 6966 206a 3d3d 323a 0a20 2020    elif j==2:.   
-00019710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019720: 2073 656c 662e 6d31 3320 3d20 760a 2020   self.m13 = v.  
-00019730: 2020 2020 2020 2020 2020 2020 2020 656c                el
-00019740: 6966 206a 3d3d 333a 0a20 2020 2020 2020  if j==3:.       
-00019750: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00019760: 662e 6d31 3420 3d20 760a 2020 2020 2020  f.m14 = v.      
-00019770: 2020 2020 2020 656c 6966 2069 3d3d 313a        elif i==1:
-00019780: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00019790: 2069 6620 6a3d 3d30 3a0a 2020 2020 2020   if j==0:.      
-000197a0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-000197b0: 6c66 2e6d 3231 203d 2076 0a20 2020 2020  lf.m21 = v.     
-000197c0: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
-000197d0: 6a3d 3d31 3a0a 2020 2020 2020 2020 2020  j==1:.          
-000197e0: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
-000197f0: 3232 203d 2076 0a20 2020 2020 2020 2020  22 = v.         
-00019800: 2020 2020 2020 2065 6c69 6620 6a3d 3d32         elif j==2
-00019810: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00019820: 2020 2020 2020 7365 6c66 2e6d 3233 203d        self.m23 =
-00019830: 2076 0a20 2020 2020 2020 2020 2020 2020   v.             
-00019840: 2020 2065 6c69 6620 6a3d 3d33 3a0a 2020     elif j==3:.  
-00019850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019860: 2020 7365 6c66 2e6d 3234 203d 2076 0a20    self.m24 = v. 
-00019870: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
-00019880: 693d 3d32 3a0a 2020 2020 2020 2020 2020  i==2:.          
-00019890: 2020 2020 2020 6966 206a 3d3d 303a 0a20        if j==0:. 
-000198a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000198b0: 2020 2073 656c 662e 6d33 3120 3d20 760a     self.m31 = v.
-000198c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000198d0: 656c 6966 206a 3d3d 313a 0a20 2020 2020  elif j==1:.     
-000198e0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-000198f0: 656c 662e 6d33 3220 3d20 760a 2020 2020  elf.m32 = v.    
-00019900: 2020 2020 2020 2020 2020 2020 656c 6966              elif
-00019910: 206a 3d3d 323a 0a20 2020 2020 2020 2020   j==2:.         
-00019920: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00019930: 6d33 3320 3d20 760a 2020 2020 2020 2020  m33 = v.        
-00019940: 2020 2020 2020 2020 656c 6966 206a 3d3d          elif j==
-00019950: 333a 0a20 2020 2020 2020 2020 2020 2020  3:.             
-00019960: 2020 2020 2020 2073 656c 662e 6d33 3420         self.m34 
-00019970: 3d20 760a 2020 2020 2020 2020 2020 2020  = v.            
-00019980: 656c 6966 2069 3d3d 333a 0a20 2020 2020  elif i==3:.     
-00019990: 2020 2020 2020 2020 2020 2069 6620 6a3d             if j=
-000199a0: 3d30 3a0a 2020 2020 2020 2020 2020 2020  =0:.            
-000199b0: 2020 2020 2020 2020 7365 6c66 2e6d 3431          self.m41
-000199c0: 203d 2076 0a20 2020 2020 2020 2020 2020   = v.           
-000199d0: 2020 2020 2065 6c69 6620 6a3d 3d31 3a0a       elif j==1:.
-000199e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000199f0: 2020 2020 7365 6c66 2e6d 3432 203d 2076      self.m42 = v
-00019a00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00019a10: 2065 6c69 6620 6a3d 3d32 3a0a 2020 2020   elif j==2:.    
-00019a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019a30: 7365 6c66 2e6d 3433 203d 2076 0a20 2020  self.m43 = v.   
-00019a40: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
-00019a50: 6620 6a3d 3d33 3a0a 2020 2020 2020 2020  f j==3:.        
-00019a60: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00019a70: 2e6d 3434 203d 2076 0a20 2020 2020 2020  .m44 = v.       
-00019a80: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00019a90: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
-00019aa0: 6f72 2c22 696e 6465 7820 6d75 7374 2062  or,"index must b
-00019ab0: 6520 696e 7465 6765 7220 6f72 2032 2d74  e integer or 2-t
-00019ac0: 7570 6c65 220a 0a20 2020 2064 6566 2067  uple"..    def g
-00019ad0: 6574 526f 7728 7365 6c66 2c20 6964 7829  etRow(self, idx)
-00019ae0: 3a0a 2020 2020 2020 2020 2222 2252 6574  :.        """Ret
-00019af0: 7572 6e20 726f 7720 2861 7320 7665 6334  urn row (as vec4
-00019b00: 292e 2222 220a 2020 2020 2020 2020 6364  ).""".        cd
-00019b10: 6566 2069 6e74 2069 0a0a 2020 2020 2020  ef int i..      
-00019b20: 2020 543d 7479 7065 2869 6478 290a 2020    T=type(idx).  
-00019b30: 2020 2020 2020 6966 2054 213d 696e 7420        if T!=int 
-00019b40: 616e 6420 5421 3d6c 6f6e 673a 0a20 2020  and T!=long:.   
-00019b50: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
-00019b60: 7970 6545 7272 6f72 2c22 696e 6465 7820  ypeError,"index 
-00019b70: 6d75 7374 2062 6520 696e 7465 6765 7222  must be integer"
-00019b80: 0a0a 2020 2020 2020 2020 6920 3d20 6964  ..        i = id
-00019b90: 780a 2020 2020 2020 2020 6966 2069 3d3d  x.        if i==
-00019ba0: 303a 0a20 2020 2020 2020 2020 2020 2072  0:.            r
-00019bb0: 6574 7572 6e20 7665 6334 2873 656c 662e  eturn vec4(self.
-00019bc0: 6d31 312c 2073 656c 662e 6d31 322c 2073  m11, self.m12, s
-00019bd0: 656c 662e 6d31 332c 2073 656c 662e 6d31  elf.m13, self.m1
-00019be0: 3429 0a20 2020 2020 2020 2065 6c69 6620  4).        elif 
-00019bf0: 693d 3d31 3a0a 2020 2020 2020 2020 2020  i==1:.          
-00019c00: 2020 7265 7475 726e 2076 6563 3428 7365    return vec4(se
-00019c10: 6c66 2e6d 3231 2c20 7365 6c66 2e6d 3232  lf.m21, self.m22
-00019c20: 2c20 7365 6c66 2e6d 3233 2c20 7365 6c66  , self.m23, self
-00019c30: 2e6d 3234 290a 2020 2020 2020 2020 656c  .m24).        el
-00019c40: 6966 2069 3d3d 323a 0a20 2020 2020 2020  if i==2:.       
-00019c50: 2020 2020 2072 6574 7572 6e20 7665 6334       return vec4
-00019c60: 2873 656c 662e 6d33 312c 2073 656c 662e  (self.m31, self.
-00019c70: 6d33 322c 2073 656c 662e 6d33 332c 2073  m32, self.m33, s
-00019c80: 656c 662e 6d33 3429 0a20 2020 2020 2020  elf.m34).       
-00019c90: 2065 6c69 6620 693d 3d33 3a0a 2020 2020   elif i==3:.    
-00019ca0: 2020 2020 2020 2020 7265 7475 726e 2076          return v
-00019cb0: 6563 3428 7365 6c66 2e6d 3431 2c20 7365  ec4(self.m41, se
-00019cc0: 6c66 2e6d 3432 2c20 7365 6c66 2e6d 3433  lf.m42, self.m43
-00019cd0: 2c20 7365 6c66 2e6d 3434 290a 2020 2020  , self.m44).    
-00019ce0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00019cf0: 2020 2020 2020 7261 6973 6520 496e 6465        raise Inde
-00019d00: 7845 7272 6f72 2c20 2269 6e64 6578 206f  xError, "index o
-00019d10: 7574 206f 6620 7261 6e67 6522 0a0a 2020  ut of range"..  
-00019d20: 2020 6465 6620 7365 7452 6f77 2873 656c    def setRow(sel
-00019d30: 662c 2069 6478 2c20 7661 6c75 6529 3a0a  f, idx, value):.
-00019d40: 2020 2020 2020 2020 2222 2253 6574 2072          """Set r
-00019d50: 6f77 2e22 2222 0a20 2020 2020 2020 2063  ow.""".        c
-00019d60: 6465 6620 696e 7420 690a 0a20 2020 2020  def int i..     
-00019d70: 2020 2054 3d74 7970 6528 6964 7829 0a20     T=type(idx). 
-00019d80: 2020 2020 2020 2069 6620 5421 3d69 6e74         if T!=int
-00019d90: 2061 6e64 2054 213d 6c6f 6e67 3a0a 2020   and T!=long:.  
-00019da0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00019db0: 5479 7065 4572 726f 722c 2269 6e64 6578  TypeError,"index
-00019dc0: 206d 7573 7420 6265 2069 6e74 6567 6572   must be integer
-00019dd0: 220a 0a20 2020 2020 2020 2069 6620 6c65  "..        if le
-00019de0: 6e28 7661 6c75 6529 213d 343a 0a20 2020  n(value)!=4:.   
-00019df0: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-00019e00: 616c 7565 4572 726f 722c 2022 342d 7365  alueError, "4-se
-00019e10: 7175 656e 6365 2065 7870 6563 7465 6422  quence expected"
-00019e20: 0a0a 2020 2020 2020 2020 6920 3d20 6964  ..        i = id
-00019e30: 780a 2020 2020 2020 2020 6966 2069 3d3d  x.        if i==
-00019e40: 303a 0a20 2020 2020 2020 2020 2020 2073  0:.            s
-00019e50: 656c 662e 6d31 3120 3d20 7661 6c75 655b  elf.m11 = value[
-00019e60: 305d 0a20 2020 2020 2020 2020 2020 2073  0].            s
-00019e70: 656c 662e 6d31 3220 3d20 7661 6c75 655b  elf.m12 = value[
-00019e80: 315d 0a20 2020 2020 2020 2020 2020 2073  1].            s
-00019e90: 656c 662e 6d31 3320 3d20 7661 6c75 655b  elf.m13 = value[
-00019ea0: 325d 0a20 2020 2020 2020 2020 2020 2073  2].            s
-00019eb0: 656c 662e 6d31 3420 3d20 7661 6c75 655b  elf.m14 = value[
-00019ec0: 335d 0a20 2020 2020 2020 2065 6c69 6620  3].        elif 
-00019ed0: 693d 3d31 3a0a 2020 2020 2020 2020 2020  i==1:.          
-00019ee0: 2020 7365 6c66 2e6d 3231 203d 2076 616c    self.m21 = val
-00019ef0: 7565 5b30 5d0a 2020 2020 2020 2020 2020  ue[0].          
-00019f00: 2020 7365 6c66 2e6d 3232 203d 2076 616c    self.m22 = val
-00019f10: 7565 5b31 5d0a 2020 2020 2020 2020 2020  ue[1].          
-00019f20: 2020 7365 6c66 2e6d 3233 203d 2076 616c    self.m23 = val
-00019f30: 7565 5b32 5d0a 2020 2020 2020 2020 2020  ue[2].          
-00019f40: 2020 7365 6c66 2e6d 3234 203d 2076 616c    self.m24 = val
-00019f50: 7565 5b33 5d0a 2020 2020 2020 2020 656c  ue[3].        el
-00019f60: 6966 2069 3d3d 323a 0a20 2020 2020 2020  if i==2:.       
-00019f70: 2020 2020 2073 656c 662e 6d33 3120 3d20       self.m31 = 
-00019f80: 7661 6c75 655b 305d 0a20 2020 2020 2020  value[0].       
-00019f90: 2020 2020 2073 656c 662e 6d33 3220 3d20       self.m32 = 
-00019fa0: 7661 6c75 655b 315d 0a20 2020 2020 2020  value[1].       
-00019fb0: 2020 2020 2073 656c 662e 6d33 3320 3d20       self.m33 = 
-00019fc0: 7661 6c75 655b 325d 0a20 2020 2020 2020  value[2].       
-00019fd0: 2020 2020 2073 656c 662e 6d33 3420 3d20       self.m34 = 
-00019fe0: 7661 6c75 655b 335d 0a20 2020 2020 2020  value[3].       
-00019ff0: 2065 6c69 6620 693d 3d33 3a0a 2020 2020   elif i==3:.    
-0001a000: 2020 2020 2020 2020 7365 6c66 2e6d 3431          self.m41
-0001a010: 203d 2076 616c 7565 5b30 5d0a 2020 2020   = value[0].    
-0001a020: 2020 2020 2020 2020 7365 6c66 2e6d 3432          self.m42
-0001a030: 203d 2076 616c 7565 5b31 5d0a 2020 2020   = value[1].    
-0001a040: 2020 2020 2020 2020 7365 6c66 2e6d 3433          self.m43
-0001a050: 203d 2076 616c 7565 5b32 5d0a 2020 2020   = value[2].    
-0001a060: 2020 2020 2020 2020 7365 6c66 2e6d 3434          self.m44
-0001a070: 203d 2076 616c 7565 5b33 5d0a 2020 2020   = value[3].    
-0001a080: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-0001a090: 2020 2020 2020 7261 6973 6520 496e 6465        raise Inde
-0001a0a0: 7845 7272 6f72 2c20 2269 6e64 6578 206f  xError, "index o
-0001a0b0: 7574 206f 6620 7261 6e67 6522 0a0a 2020  ut of range"..  
-0001a0c0: 2020 6465 6620 6765 7443 6f6c 756d 6e28    def getColumn(
-0001a0d0: 7365 6c66 2c20 6964 7829 3a0a 2020 2020  self, idx):.    
-0001a0e0: 2020 2020 2222 2252 6574 7572 6e20 636f      """Return co
-0001a0f0: 6c75 6d6e 2028 6173 2076 6563 3429 2e22  lumn (as vec4)."
-0001a100: 2222 0a20 2020 2020 2020 2063 6465 6620  "".        cdef 
-0001a110: 696e 7420 690a 0a20 2020 2020 2020 2054  int i..        T
-0001a120: 3d74 7970 6528 6964 7829 0a20 2020 2020  =type(idx).     
-0001a130: 2020 2069 6620 5421 3d69 6e74 2061 6e64     if T!=int and
-0001a140: 2054 213d 6c6f 6e67 3a0a 2020 2020 2020   T!=long:.      
-0001a150: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
-0001a160: 4572 726f 722c 2269 6e64 6578 206d 7573  Error,"index mus
-0001a170: 7420 6265 2069 6e74 6567 6572 220a 0a20  t be integer".. 
-0001a180: 2020 2020 2020 2069 203d 2069 6478 0a20         i = idx. 
-0001a190: 2020 2020 2020 2069 6620 693d 3d30 3a0a         if i==0:.
-0001a1a0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0001a1b0: 726e 2076 6563 3428 7365 6c66 2e6d 3131  rn vec4(self.m11
-0001a1c0: 2c20 7365 6c66 2e6d 3231 2c20 7365 6c66  , self.m21, self
-0001a1d0: 2e6d 3331 2c20 7365 6c66 2e6d 3431 290a  .m31, self.m41).
-0001a1e0: 2020 2020 2020 2020 656c 6966 2069 3d3d          elif i==
-0001a1f0: 313a 0a20 2020 2020 2020 2020 2020 2072  1:.            r
-0001a200: 6574 7572 6e20 7665 6334 2873 656c 662e  eturn vec4(self.
-0001a210: 6d31 322c 2073 656c 662e 6d32 322c 2073  m12, self.m22, s
-0001a220: 656c 662e 6d33 322c 2073 656c 662e 6d34  elf.m32, self.m4
-0001a230: 3229 0a20 2020 2020 2020 2065 6c69 6620  2).        elif 
-0001a240: 693d 3d32 3a0a 2020 2020 2020 2020 2020  i==2:.          
-0001a250: 2020 7265 7475 726e 2076 6563 3428 7365    return vec4(se
-0001a260: 6c66 2e6d 3133 2c20 7365 6c66 2e6d 3233  lf.m13, self.m23
-0001a270: 2c20 7365 6c66 2e6d 3333 2c20 7365 6c66  , self.m33, self
-0001a280: 2e6d 3433 290a 2020 2020 2020 2020 656c  .m43).        el
-0001a290: 6966 2069 3d3d 333a 0a20 2020 2020 2020  if i==3:.       
-0001a2a0: 2020 2020 2072 6574 7572 6e20 7665 6334       return vec4
-0001a2b0: 2873 656c 662e 6d31 342c 2073 656c 662e  (self.m14, self.
-0001a2c0: 6d32 342c 2073 656c 662e 6d33 342c 2073  m24, self.m34, s
-0001a2d0: 656c 662e 6d34 3429 0a20 2020 2020 2020  elf.m44).       
-0001a2e0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-0001a2f0: 2020 2072 6169 7365 2049 6e64 6578 4572     raise IndexEr
-0001a300: 726f 722c 2022 696e 6465 7820 6f75 7420  ror, "index out 
-0001a310: 6f66 2072 616e 6765 220a 0a20 2020 2064  of range"..    d
-0001a320: 6566 2073 6574 436f 6c75 6d6e 2873 656c  ef setColumn(sel
-0001a330: 662c 2069 6478 2c20 7661 6c75 6529 3a0a  f, idx, value):.
-0001a340: 2020 2020 2020 2020 2222 2253 6574 2063          """Set c
-0001a350: 6f6c 756d 6e2e 2222 220a 2020 2020 2020  olumn.""".      
-0001a360: 2020 6364 6566 2069 6e74 2069 0a0a 2020    cdef int i..  
-0001a370: 2020 2020 2020 543d 7479 7065 2869 6478        T=type(idx
-0001a380: 290a 2020 2020 2020 2020 6966 2054 213d  ).        if T!=
-0001a390: 696e 7420 616e 6420 5421 3d6c 6f6e 673a  int and T!=long:
-0001a3a0: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-0001a3b0: 7365 2054 7970 6545 7272 6f72 2c22 696e  se TypeError,"in
-0001a3c0: 6465 7820 6d75 7374 2062 6520 696e 7465  dex must be inte
-0001a3d0: 6765 7222 0a0a 2020 2020 2020 2020 6966  ger"..        if
-0001a3e0: 206c 656e 2876 616c 7565 2921 3d34 3a0a   len(value)!=4:.
-0001a3f0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-0001a400: 6520 5661 6c75 6545 7272 6f72 2c20 2234  e ValueError, "4
-0001a410: 2d73 6571 7565 6e63 6520 6578 7065 6374  -sequence expect
-0001a420: 6564 220a 0a20 2020 2020 2020 2069 203d  ed"..        i =
-0001a430: 2069 6478 0a20 2020 2020 2020 2069 6620   idx.        if 
-0001a440: 693d 3d30 3a0a 2020 2020 2020 2020 2020  i==0:.          
-0001a450: 2020 7365 6c66 2e6d 3131 203d 2076 616c    self.m11 = val
-0001a460: 7565 5b30 5d0a 2020 2020 2020 2020 2020  ue[0].          
-0001a470: 2020 7365 6c66 2e6d 3231 203d 2076 616c    self.m21 = val
-0001a480: 7565 5b31 5d0a 2020 2020 2020 2020 2020  ue[1].          
-0001a490: 2020 7365 6c66 2e6d 3331 203d 2076 616c    self.m31 = val
-0001a4a0: 7565 5b32 5d0a 2020 2020 2020 2020 2020  ue[2].          
-0001a4b0: 2020 7365 6c66 2e6d 3431 203d 2076 616c    self.m41 = val
-0001a4c0: 7565 5b33 5d0a 2020 2020 2020 2020 656c  ue[3].        el
-0001a4d0: 6966 2069 3d3d 313a 0a20 2020 2020 2020  if i==1:.       
-0001a4e0: 2020 2020 2073 656c 662e 6d31 3220 3d20       self.m12 = 
-0001a4f0: 7661 6c75 655b 305d 0a20 2020 2020 2020  value[0].       
-0001a500: 2020 2020 2073 656c 662e 6d32 3220 3d20       self.m22 = 
-0001a510: 7661 6c75 655b 315d 0a20 2020 2020 2020  value[1].       
-0001a520: 2020 2020 2073 656c 662e 6d33 3220 3d20       self.m32 = 
-0001a530: 7661 6c75 655b 325d 0a20 2020 2020 2020  value[2].       
-0001a540: 2020 2020 2073 656c 662e 6d34 3220 3d20       self.m42 = 
-0001a550: 7661 6c75 655b 335d 0a20 2020 2020 2020  value[3].       
-0001a560: 2065 6c69 6620 693d 3d32 3a0a 2020 2020   elif i==2:.    
-0001a570: 2020 2020 2020 2020 7365 6c66 2e6d 3133          self.m13
-0001a580: 203d 2076 616c 7565 5b30 5d0a 2020 2020   = value[0].    
-0001a590: 2020 2020 2020 2020 7365 6c66 2e6d 3233          self.m23
-0001a5a0: 203d 2076 616c 7565 5b31 5d0a 2020 2020   = value[1].    
-0001a5b0: 2020 2020 2020 2020 7365 6c66 2e6d 3333          self.m33
-0001a5c0: 203d 2076 616c 7565 5b32 5d0a 2020 2020   = value[2].    
-0001a5d0: 2020 2020 2020 2020 7365 6c66 2e6d 3433          self.m43
-0001a5e0: 203d 2076 616c 7565 5b33 5d0a 2020 2020   = value[3].    
-0001a5f0: 2020 2020 656c 6966 2069 3d3d 333a 0a20      elif i==3:. 
-0001a600: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0001a610: 6d31 3420 3d20 7661 6c75 655b 305d 0a20  m14 = value[0]. 
-0001a620: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0001a630: 6d32 3420 3d20 7661 6c75 655b 315d 0a20  m24 = value[1]. 
-0001a640: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0001a650: 6d33 3420 3d20 7661 6c75 655b 325d 0a20  m34 = value[2]. 
-0001a660: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0001a670: 6d34 3420 3d20 7661 6c75 655b 335d 0a20  m44 = value[3]. 
-0001a680: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-0001a690: 2020 2020 2020 2020 2072 6169 7365 2049           raise I
-0001a6a0: 6e64 6578 4572 726f 722c 2022 696e 6465  ndexError, "inde
-0001a6b0: 7820 6f75 7420 6f66 2072 616e 6765 220a  x out of range".
-0001a6c0: 0a0a 2020 2020 6465 6620 746f 4c69 7374  ..    def toList
-0001a6d0: 2873 656c 662c 2072 6f77 6d61 6a6f 723d  (self, rowmajor=
-0001a6e0: 3029 3a0a 2020 2020 2020 2020 2222 2252  0):.        """R
-0001a6f0: 6574 7572 6e20 6120 6c69 7374 2063 6f6e  eturn a list con
-0001a700: 7461 696e 696e 6720 7468 6520 6d61 7472  taining the matr
-0001a710: 6978 2065 6c65 6d65 6e74 732e 0a0a 2020  ix elements...  
-0001a720: 2020 2020 2020 4279 2064 6566 6175 6c74        By default
-0001a730: 2074 6865 206c 6973 7420 6973 2069 6e20   the list is in 
-0001a740: 636f 6c75 6d6e 2d6d 616a 6f72 206f 7264  column-major ord
-0001a750: 6572 2028 7768 6963 6820 6361 6e20 6469  er (which can di
-0001a760: 7265 6374 6c79 2062 650a 2020 2020 2020  rectly be.      
-0001a770: 2020 7573 6564 2069 6e20 4f70 656e 474c    used in OpenGL
-0001a780: 206f 7220 5265 6e64 6572 4d61 6e29 2e20   or RenderMan). 
-0001a790: 4966 2079 6f75 2073 6574 2074 6865 206f  If you set the o
-0001a7a0: 7074 696f 6e61 6c20 6172 6775 6d65 6e74  ptional argument
-0001a7b0: 0a20 2020 2020 2020 2072 6f77 6d61 6a6f  .        rowmajo
-0001a7c0: 7220 746f 2031 2c20 796f 7527 6c6c 2067  r to 1, you'll g
-0001a7d0: 6574 2074 6865 206c 6973 7420 696e 2072  et the list in r
-0001a7e0: 6f77 2d6d 616a 6f72 206f 7264 6572 2e0a  ow-major order..
-0001a7f0: 0a20 2020 2020 2020 203e 3e3e 204d 3d6d  .        >>> M=m
-0001a800: 6174 3428 312c 322c 332c 342c 352c 362c  at4(1,2,3,4,5,6,
-0001a810: 372c 382c 392c 3130 2c31 312c 3132 2c31  7,8,9,10,11,12,1
-0001a820: 332c 3134 2c31 352c 3136 290a 2020 2020  3,14,15,16).    
-0001a830: 2020 2020 3e3e 3e20 7072 696e 7420 4d2e      >>> print M.
-0001a840: 746f 4c69 7374 2829 0a20 2020 2020 2020  toList().       
-0001a850: 205b 312c 2035 2c20 392c 2031 332c 2032   [1, 5, 9, 13, 2
-0001a860: 2c20 362c 2031 302c 2031 342c 2033 2c20  , 6, 10, 14, 3, 
-0001a870: 372c 2031 312c 2031 352c 2034 2c20 382c  7, 11, 15, 4, 8,
-0001a880: 2031 322c 2031 365d 0a20 2020 2020 2020   12, 16].       
-0001a890: 203e 3e3e 2070 7269 6e74 204d 2e74 6f4c   >>> print M.toL
-0001a8a0: 6973 7428 726f 776d 616a 6f72 3d31 290a  ist(rowmajor=1).
-0001a8b0: 2020 2020 2020 2020 5b31 2c20 322c 2033          [1, 2, 3
-0001a8c0: 2c20 342c 2035 2c20 362c 2037 2c20 382c  , 4, 5, 6, 7, 8,
-0001a8d0: 2039 2c20 3130 2c20 3131 2c20 3132 2c20   9, 10, 11, 12, 
-0001a8e0: 3133 2c20 3134 2c20 3135 2c20 3136 5d0a  13, 14, 15, 16].
-0001a8f0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0001a900: 2020 2020 6966 2072 6f77 6d61 6a6f 723a      if rowmajor:
-0001a910: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-0001a920: 7572 6e20 5b73 656c 662e 6d31 312c 2073  urn [self.m11, s
-0001a930: 656c 662e 6d31 322c 2073 656c 662e 6d31  elf.m12, self.m1
-0001a940: 332c 2073 656c 662e 6d31 342c 0a20 2020  3, self.m14,.   
-0001a950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a960: 2073 656c 662e 6d32 312c 2073 656c 662e   self.m21, self.
-0001a970: 6d32 322c 2073 656c 662e 6d32 332c 2073  m22, self.m23, s
-0001a980: 656c 662e 6d32 342c 0a20 2020 2020 2020  elf.m24,.       
-0001a990: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0001a9a0: 662e 6d33 312c 2073 656c 662e 6d33 322c  f.m31, self.m32,
-0001a9b0: 2073 656c 662e 6d33 332c 2073 656c 662e   self.m33, self.
-0001a9c0: 6d33 342c 0a20 2020 2020 2020 2020 2020  m34,.           
-0001a9d0: 2020 2020 2020 2020 2073 656c 662e 6d34           self.m4
-0001a9e0: 312c 2073 656c 662e 6d34 322c 2073 656c  1, self.m42, sel
-0001a9f0: 662e 6d34 332c 2073 656c 662e 6d34 345d  f.m43, self.m44]
-0001aa00: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-0001aa10: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0001aa20: 6e20 5b73 656c 662e 6d31 312c 2073 656c  n [self.m11, sel
-0001aa30: 662e 6d32 312c 2073 656c 662e 6d33 312c  f.m21, self.m31,
-0001aa40: 2073 656c 662e 6d34 312c 0a20 2020 2020   self.m41,.     
-0001aa50: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0001aa60: 656c 662e 6d31 322c 2073 656c 662e 6d32  elf.m12, self.m2
-0001aa70: 322c 2073 656c 662e 6d33 322c 2073 656c  2, self.m32, sel
-0001aa80: 662e 6d34 322c 0a20 2020 2020 2020 2020  f.m42,.         
-0001aa90: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0001aaa0: 6d31 332c 2073 656c 662e 6d32 332c 2073  m13, self.m23, s
-0001aab0: 656c 662e 6d33 332c 2073 656c 662e 6d34  elf.m33, self.m4
-0001aac0: 332c 0a20 2020 2020 2020 2020 2020 2020  3,.             
-0001aad0: 2020 2020 2020 2073 656c 662e 6d31 342c         self.m14,
-0001aae0: 2073 656c 662e 6d32 342c 2073 656c 662e   self.m24, self.
-0001aaf0: 6d33 342c 2073 656c 662e 6d34 345d 0a0a  m34, self.m44]..
-0001ab00: 0a20 2020 2064 6566 2069 6465 6e74 6974  .    def identit
-0001ab10: 7928 7365 6c66 293a 0a20 2020 2020 2020  y(self):.       
-0001ab20: 2022 2222 5265 7475 726e 2069 6465 6e74   """Return ident
-0001ab30: 6974 7920 6d61 7472 6978 2e0a 0a20 2020  ity matrix...   
-0001ab40: 2020 2020 203e 3e3e 2070 7269 6e74 206d       >>> print m
-0001ab50: 6174 3428 292e 6964 656e 7469 7479 2829  at4().identity()
-0001ab60: 0a20 2020 2020 2020 205b 2020 2031 2e30  .        [   1.0
-0001ab70: 3030 302c 2020 2020 302e 3030 3030 2c20  000,    0.0000, 
-0001ab80: 2020 2030 2e30 3030 302c 2020 2020 302e     0.0000,    0.
-0001ab90: 3030 3030 5d0a 2020 2020 2020 2020 5b20  0000].        [ 
-0001aba0: 2020 302e 3030 3030 2c20 2020 2031 2e30    0.0000,    1.0
-0001abb0: 3030 302c 2020 2020 302e 3030 3030 2c20  000,    0.0000, 
-0001abc0: 2020 2030 2e30 3030 305d 0a20 2020 2020     0.0000].     
-0001abd0: 2020 205b 2020 2030 2e30 3030 302c 2020     [   0.0000,  
-0001abe0: 2020 302e 3030 3030 2c20 2020 2031 2e30    0.0000,    1.0
-0001abf0: 3030 302c 2020 2020 302e 3030 3030 5d0a  000,    0.0000].
-0001ac00: 2020 2020 2020 2020 5b20 2020 302e 3030          [   0.00
-0001ac10: 3030 2c20 2020 2030 2e30 3030 302c 2020  00,    0.0000,  
-0001ac20: 2020 302e 3030 3030 2c20 2020 2031 2e30    0.0000,    1.0
-0001ac30: 3030 305d 0a20 2020 2020 2020 2022 2222  000].        """
-0001ac40: 0a20 2020 2020 2020 2063 6465 6620 6d61  .        cdef ma
-0001ac50: 7434 2072 6573 0a20 2020 2020 2020 2072  t4 res.        r
-0001ac60: 6573 203d 206d 6174 3428 290a 2020 2020  es = mat4().    
-0001ac70: 2020 2020 7265 732e 6d31 3120 3d20 312e      res.m11 = 1.
-0001ac80: 300a 2020 2020 2020 2020 7265 732e 6d31  0.        res.m1
-0001ac90: 3220 3d20 302e 300a 2020 2020 2020 2020  2 = 0.0.        
-0001aca0: 7265 732e 6d31 3320 3d20 302e 300a 2020  res.m13 = 0.0.  
-0001acb0: 2020 2020 2020 7265 732e 6d31 3420 3d20        res.m14 = 
-0001acc0: 302e 300a 2020 2020 2020 2020 7265 732e  0.0.        res.
-0001acd0: 6d32 3120 3d20 302e 300a 2020 2020 2020  m21 = 0.0.      
-0001ace0: 2020 7265 732e 6d32 3220 3d20 312e 300a    res.m22 = 1.0.
-0001acf0: 2020 2020 2020 2020 7265 732e 6d32 3320          res.m23 
-0001ad00: 3d20 302e 300a 2020 2020 2020 2020 7265  = 0.0.        re
-0001ad10: 732e 6d32 3420 3d20 302e 300a 2020 2020  s.m24 = 0.0.    
-0001ad20: 2020 2020 7265 732e 6d33 3120 3d20 302e      res.m31 = 0.
-0001ad30: 300a 2020 2020 2020 2020 7265 732e 6d33  0.        res.m3
-0001ad40: 3220 3d20 302e 300a 2020 2020 2020 2020  2 = 0.0.        
-0001ad50: 7265 732e 6d33 3320 3d20 312e 300a 2020  res.m33 = 1.0.  
-0001ad60: 2020 2020 2020 7265 732e 6d33 3420 3d20        res.m34 = 
-0001ad70: 302e 300a 2020 2020 2020 2020 7265 732e  0.0.        res.
-0001ad80: 6d34 3120 3d20 302e 300a 2020 2020 2020  m41 = 0.0.      
-0001ad90: 2020 7265 732e 6d34 3220 3d20 302e 300a    res.m42 = 0.0.
-0001ada0: 2020 2020 2020 2020 7265 732e 6d34 3320          res.m43 
-0001adb0: 3d20 302e 300a 2020 2020 2020 2020 7265  = 0.0.        re
-0001adc0: 732e 6d34 3420 3d20 312e 300a 2020 2020  s.m44 = 1.0.    
-0001add0: 2020 2020 7265 7475 726e 2072 6573 0a0a      return res..
-0001ade0: 2020 2020 6465 6620 7472 616e 7370 6f73      def transpos
-0001adf0: 6528 7365 6c66 293a 0a20 2020 2020 2020  e(self):.       
-0001ae00: 2022 2222 5265 7475 726e 2074 7261 6e73   """Return trans
-0001ae10: 706f 7365 206d 6174 7269 782e 0a0a 2020  pose matrix...  
-0001ae20: 2020 2020 2020 3e3e 3e20 4d3d 6d61 7434        >>> M=mat4
-0001ae30: 2831 2c32 2c33 2c34 2c35 2c36 2c37 2c38  (1,2,3,4,5,6,7,8
-0001ae40: 2c39 2c31 302c 3131 2c31 322c 3133 2c31  ,9,10,11,12,13,1
-0001ae50: 342c 3135 2c31 3629 0a20 2020 2020 2020  4,15,16).       
-0001ae60: 203e 3e3e 2070 7269 6e74 204d 2e74 7261   >>> print M.tra
-0001ae70: 6e73 706f 7365 2829 0a20 2020 2020 2020  nspose().       
-0001ae80: 205b 2020 2031 2e30 3030 302c 2020 2020   [   1.0000,    
-0001ae90: 352e 3030 3030 2c20 2020 2039 2e30 3030  5.0000,    9.000
-0001aea0: 302c 2020 2031 332e 3030 3030 5d0a 2020  0,   13.0000].  
-0001aeb0: 2020 2020 2020 5b20 2020 322e 3030 3030        [   2.0000
-0001aec0: 2c20 2020 2036 2e30 3030 302c 2020 2031  ,    6.0000,   1
-0001aed0: 302e 3030 3030 2c20 2020 3134 2e30 3030  0.0000,   14.000
-0001aee0: 305d 0a20 2020 2020 2020 205b 2020 2033  0].        [   3
-0001aef0: 2e30 3030 302c 2020 2020 372e 3030 3030  .0000,    7.0000
-0001af00: 2c20 2020 3131 2e30 3030 302c 2020 2031  ,   11.0000,   1
-0001af10: 352e 3030 3030 5d0a 2020 2020 2020 2020  5.0000].        
-0001af20: 5b20 2020 342e 3030 3030 2c20 2020 2038  [   4.0000,    8
-0001af30: 2e30 3030 302c 2020 2031 322e 3030 3030  .0000,   12.0000
-0001af40: 2c20 2020 3136 2e30 3030 305d 0a20 2020  ,   16.0000].   
-0001af50: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0001af60: 2063 6465 6620 6d61 7434 2072 6573 0a20   cdef mat4 res. 
-0001af70: 2020 2020 2020 2072 6573 203d 206d 6174         res = mat
-0001af80: 3428 290a 2020 2020 2020 2020 7265 732e  4().        res.
-0001af90: 6d31 3120 3d20 7365 6c66 2e6d 3131 0a20  m11 = self.m11. 
-0001afa0: 2020 2020 2020 2072 6573 2e6d 3132 203d         res.m12 =
-0001afb0: 2073 656c 662e 6d32 310a 2020 2020 2020   self.m21.      
-0001afc0: 2020 7265 732e 6d31 3320 3d20 7365 6c66    res.m13 = self
-0001afd0: 2e6d 3331 0a20 2020 2020 2020 2072 6573  .m31.        res
-0001afe0: 2e6d 3134 203d 2073 656c 662e 6d34 310a  .m14 = self.m41.
-0001aff0: 2020 2020 2020 2020 7265 732e 6d32 3120          res.m21 
-0001b000: 3d20 7365 6c66 2e6d 3132 0a20 2020 2020  = self.m12.     
-0001b010: 2020 2072 6573 2e6d 3232 203d 2073 656c     res.m22 = sel
-0001b020: 662e 6d32 320a 2020 2020 2020 2020 7265  f.m22.        re
-0001b030: 732e 6d32 3320 3d20 7365 6c66 2e6d 3332  s.m23 = self.m32
-0001b040: 0a20 2020 2020 2020 2072 6573 2e6d 3234  .        res.m24
-0001b050: 203d 2073 656c 662e 6d34 320a 2020 2020   = self.m42.    
-0001b060: 2020 2020 7265 732e 6d33 3120 3d20 7365      res.m31 = se
-0001b070: 6c66 2e6d 3133 0a20 2020 2020 2020 2072  lf.m13.        r
-0001b080: 6573 2e6d 3332 203d 2073 656c 662e 6d32  es.m32 = self.m2
-0001b090: 330a 2020 2020 2020 2020 7265 732e 6d33  3.        res.m3
-0001b0a0: 3320 3d20 7365 6c66 2e6d 3333 0a20 2020  3 = self.m33.   
-0001b0b0: 2020 2020 2072 6573 2e6d 3334 203d 2073       res.m34 = s
-0001b0c0: 656c 662e 6d34 330a 2020 2020 2020 2020  elf.m43.        
-0001b0d0: 7265 732e 6d34 3120 3d20 7365 6c66 2e6d  res.m41 = self.m
-0001b0e0: 3134 0a20 2020 2020 2020 2072 6573 2e6d  14.        res.m
-0001b0f0: 3432 203d 2073 656c 662e 6d32 340a 2020  42 = self.m24.  
-0001b100: 2020 2020 2020 7265 732e 6d34 3320 3d20        res.m43 = 
-0001b110: 7365 6c66 2e6d 3334 0a20 2020 2020 2020  self.m34.       
-0001b120: 2072 6573 2e6d 3434 203d 2073 656c 662e   res.m44 = self.
-0001b130: 6d34 340a 2020 2020 2020 2020 7265 7475  m44.        retu
-0001b140: 726e 2072 6573 0a0a 2020 2020 6465 6620  rn res..    def 
-0001b150: 6465 7465 726d 696e 616e 7428 7365 6c66  determinant(self
-0001b160: 293a 0a20 2020 2020 2020 2022 2222 5265  ):.        """Re
-0001b170: 7475 726e 2064 6574 6572 6d69 6e61 6e74  turn determinant
-0001b180: 2e0a 0a20 2020 2020 2020 203e 3e3e 204d  ...        >>> M
-0001b190: 3d6d 6174 3428 322e 302c 302c 302c 302c  =mat4(2.0,0,0,0,
-0001b1a0: 2030 2c32 2e30 2c30 2c30 2c20 302c 302c   0,2.0,0,0, 0,0,
-0001b1b0: 322e 302c 302c 2030 2c30 2c30 2c32 2e30  2.0,0, 0,0,0,2.0
-0001b1c0: 290a 2020 2020 2020 2020 3e3e 3e20 7072  ).        >>> pr
-0001b1d0: 696e 7420 4d2e 6465 7465 726d 696e 616e  int M.determinan
-0001b1e0: 7428 290a 2020 2020 2020 2020 3136 2e30  t().        16.0
-0001b1f0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0001b200: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-0001b210: 2e6d 3131 2a73 656c 662e 6d32 322a 7365  .m11*self.m22*se
-0001b220: 6c66 2e6d 3333 2a73 656c 662e 6d34 3420  lf.m33*self.m44 
-0001b230: 5c0a 2020 2020 2020 2020 2020 2020 2020  \.              
-0001b240: 202d 7365 6c66 2e6d 3131 2a73 656c 662e   -self.m11*self.
-0001b250: 6d32 322a 7365 6c66 2e6d 3334 2a73 656c  m22*self.m34*sel
-0001b260: 662e 6d34 3320 5c0a 2020 2020 2020 2020  f.m43 \.        
-0001b270: 2020 2020 2020 202b 7365 6c66 2e6d 3131         +self.m11
-0001b280: 2a73 656c 662e 6d32 332a 7365 6c66 2e6d  *self.m23*self.m
-0001b290: 3334 2a73 656c 662e 6d34 3220 5c0a 2020  34*self.m42 \.  
-0001b2a0: 2020 2020 2020 2020 2020 2020 202d 7365               -se
-0001b2b0: 6c66 2e6d 3131 2a73 656c 662e 6d32 332a  lf.m11*self.m23*
-0001b2c0: 7365 6c66 2e6d 3332 2a73 656c 662e 6d34  self.m32*self.m4
-0001b2d0: 3420 5c0a 2020 2020 2020 2020 2020 2020  4 \.            
-0001b2e0: 2020 202b 7365 6c66 2e6d 3131 2a73 656c     +self.m11*sel
-0001b2f0: 662e 6d32 342a 7365 6c66 2e6d 3332 2a73  f.m24*self.m32*s
-0001b300: 656c 662e 6d34 3320 5c0a 2020 2020 2020  elf.m43 \.      
-0001b310: 2020 2020 2020 2020 202d 7365 6c66 2e6d           -self.m
-0001b320: 3131 2a73 656c 662e 6d32 342a 7365 6c66  11*self.m24*self
-0001b330: 2e6d 3333 2a73 656c 662e 6d34 3220 5c0a  .m33*self.m42 \.
-0001b340: 2020 2020 2020 2020 2020 2020 2020 202d                 -
-0001b350: 7365 6c66 2e6d 3132 2a73 656c 662e 6d32  self.m12*self.m2
-0001b360: 332a 7365 6c66 2e6d 3334 2a73 656c 662e  3*self.m34*self.
-0001b370: 6d34 3120 5c0a 2020 2020 2020 2020 2020  m41 \.          
-0001b380: 2020 2020 202b 7365 6c66 2e6d 3132 2a73       +self.m12*s
-0001b390: 656c 662e 6d32 332a 7365 6c66 2e6d 3331  elf.m23*self.m31
-0001b3a0: 2a73 656c 662e 6d34 3420 5c0a 2020 2020  *self.m44 \.    
-0001b3b0: 2020 2020 2020 2020 2020 202d 7365 6c66             -self
-0001b3c0: 2e6d 3132 2a73 656c 662e 6d32 342a 7365  .m12*self.m24*se
-0001b3d0: 6c66 2e6d 3331 2a73 656c 662e 6d34 3320  lf.m31*self.m43 
-0001b3e0: 5c0a 2020 2020 2020 2020 2020 2020 2020  \.              
-0001b3f0: 202b 7365 6c66 2e6d 3132 2a73 656c 662e   +self.m12*self.
-0001b400: 6d32 342a 7365 6c66 2e6d 3333 2a73 656c  m24*self.m33*sel
-0001b410: 662e 6d34 3120 5c0a 2020 2020 2020 2020  f.m41 \.        
-0001b420: 2020 2020 2020 202d 7365 6c66 2e6d 3132         -self.m12
-0001b430: 2a73 656c 662e 6d32 312a 7365 6c66 2e6d  *self.m21*self.m
-0001b440: 3333 2a73 656c 662e 6d34 3420 5c0a 2020  33*self.m44 \.  
-0001b450: 2020 2020 2020 2020 2020 2020 202b 7365               +se
-0001b460: 6c66 2e6d 3132 2a73 656c 662e 6d32 312a  lf.m12*self.m21*
-0001b470: 7365 6c66 2e6d 3334 2a73 656c 662e 6d34  self.m34*self.m4
-0001b480: 3320 5c0a 2020 2020 2020 2020 2020 2020  3 \.            
-0001b490: 2020 202b 7365 6c66 2e6d 3133 2a73 656c     +self.m13*sel
-0001b4a0: 662e 6d32 342a 7365 6c66 2e6d 3331 2a73  f.m24*self.m31*s
-0001b4b0: 656c 662e 6d34 3220 5c0a 2020 2020 2020  elf.m42 \.      
-0001b4c0: 2020 2020 2020 2020 202d 7365 6c66 2e6d           -self.m
-0001b4d0: 3133 2a73 656c 662e 6d32 342a 7365 6c66  13*self.m24*self
-0001b4e0: 2e6d 3332 2a73 656c 662e 6d34 3120 5c0a  .m32*self.m41 \.
-0001b4f0: 2020 2020 2020 2020 2020 2020 2020 202b                 +
-0001b500: 7365 6c66 2e6d 3133 2a73 656c 662e 6d32  self.m13*self.m2
-0001b510: 312a 7365 6c66 2e6d 3332 2a73 656c 662e  1*self.m32*self.
-0001b520: 6d34 3420 5c0a 2020 2020 2020 2020 2020  m44 \.          
-0001b530: 2020 2020 202d 7365 6c66 2e6d 3133 2a73       -self.m13*s
-0001b540: 656c 662e 6d32 312a 7365 6c66 2e6d 3334  elf.m21*self.m34
-0001b550: 2a73 656c 662e 6d34 3220 5c0a 2020 2020  *self.m42 \.    
-0001b560: 2020 2020 2020 2020 2020 202b 7365 6c66             +self
-0001b570: 2e6d 3133 2a73 656c 662e 6d32 322a 7365  .m13*self.m22*se
-0001b580: 6c66 2e6d 3334 2a73 656c 662e 6d34 3120  lf.m34*self.m41 
-0001b590: 5c0a 2020 2020 2020 2020 2020 2020 2020  \.              
-0001b5a0: 202d 7365 6c66 2e6d 3133 2a73 656c 662e   -self.m13*self.
-0001b5b0: 6d32 322a 7365 6c66 2e6d 3331 2a73 656c  m22*self.m31*sel
-0001b5c0: 662e 6d34 3420 5c0a 2020 2020 2020 2020  f.m44 \.        
-0001b5d0: 2020 2020 2020 202d 7365 6c66 2e6d 3134         -self.m14
-0001b5e0: 2a73 656c 662e 6d32 312a 7365 6c66 2e6d  *self.m21*self.m
-0001b5f0: 3332 2a73 656c 662e 6d34 3320 5c0a 2020  32*self.m43 \.  
-0001b600: 2020 2020 2020 2020 2020 2020 202b 7365               +se
-0001b610: 6c66 2e6d 3134 2a73 656c 662e 6d32 312a  lf.m14*self.m21*
-0001b620: 7365 6c66 2e6d 3333 2a73 656c 662e 6d34  self.m33*self.m4
-0001b630: 3220 5c0a 2020 2020 2020 2020 2020 2020  2 \.            
-0001b640: 2020 202d 7365 6c66 2e6d 3134 2a73 656c     -self.m14*sel
-0001b650: 662e 6d32 322a 7365 6c66 2e6d 3333 2a73  f.m22*self.m33*s
-0001b660: 656c 662e 6d34 3120 5c0a 2020 2020 2020  elf.m41 \.      
-0001b670: 2020 2020 2020 2020 202b 7365 6c66 2e6d           +self.m
-0001b680: 3134 2a73 656c 662e 6d32 322a 7365 6c66  14*self.m22*self
-0001b690: 2e6d 3331 2a73 656c 662e 6d34 3320 5c0a  .m31*self.m43 \.
-0001b6a0: 2020 2020 2020 2020 2020 2020 2020 202d                 -
-0001b6b0: 7365 6c66 2e6d 3134 2a73 656c 662e 6d32  self.m14*self.m2
-0001b6c0: 332a 7365 6c66 2e6d 3331 2a73 656c 662e  3*self.m31*self.
-0001b6d0: 6d34 3220 5c0a 2020 2020 2020 2020 2020  m42 \.          
-0001b6e0: 2020 2020 202b 7365 6c66 2e6d 3134 2a73       +self.m14*s
-0001b6f0: 656c 662e 6d32 332a 7365 6c66 2e6d 3332  elf.m23*self.m32
-0001b700: 2a73 656c 662e 6d34 310a 0a20 2020 2064  *self.m41..    d
-0001b710: 6566 205f 7375 626d 6174 2873 656c 662c  ef _submat(self,
-0001b720: 206d 6174 3320 4d33 2c20 692c 6a29 3a0a   mat3 M3, i,j):.
-0001b730: 2020 2020 2020 2020 6364 6566 2069 6e74          cdef int
-0001b740: 206b 2c6c 0a20 2020 2020 2020 2063 6465   k,l.        cde
-0001b750: 6620 646f 7562 6c65 2076 0a0a 2320 2020  f double v..#   
-0001b760: 2020 2020 204d 3d6d 6174 3328 290a 2020       M=mat3().  
-0001b770: 2020 2020 2020 6b3d 300a 2020 2020 2020        k=0.      
-0001b780: 2020 7768 696c 6520 6b3c 333a 0a20 2020    while k<3:.   
-0001b790: 2020 2020 2020 2020 206c 3d30 0a20 2020           l=0.   
-0001b7a0: 2020 2020 2020 2020 2077 6869 6c65 206c           while l
-0001b7b0: 3c33 3a0a 2020 2020 2020 2020 2020 2020  <3:.            
-0001b7c0: 2020 2020 743d 286b 2c6c 290a 2020 2020      t=(k,l).    
-0001b7d0: 2020 2020 2020 2020 2020 2020 6966 206b              if k
-0001b7e0: 3e3d 693a 0a20 2020 2020 2020 2020 2020  >=i:.           
-0001b7f0: 2020 2020 2020 2020 2074 3d28 6b2b 312c           t=(k+1,
-0001b800: 745b 315d 290a 2020 2020 2020 2020 2020  t[1]).          
-0001b810: 2020 2020 2020 6966 206c 3e3d 6a3a 0a20        if l>=j:. 
-0001b820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b830: 2020 2074 3d28 745b 305d 2c6c 2b31 290a     t=(t[0],l+1).
-0001b840: 0a23 2020 2020 2020 2020 2020 2020 2020  .#              
-0001b850: 2020 4d33 5b6b 2c6c 5d20 3d20 7365 6c66    M3[k,l] = self
-0001b860: 5b74 5d0a 2020 2020 2020 2020 2020 2020  [t].            
-0001b870: 2020 2020 7620 3d20 7365 6c66 5b74 5d0a      v = self[t].
-0001b880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b890: 6966 206b 3d3d 3020 616e 6420 6c3d 3d30  if k==0 and l==0
-0001b8a0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0001b8b0: 2020 2020 2020 4d33 2e6d 3131 203d 2076        M3.m11 = v
-0001b8c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001b8d0: 2069 6620 6b3d 3d30 2061 6e64 206c 3d3d   if k==0 and l==
-0001b8e0: 313a 0a20 2020 2020 2020 2020 2020 2020  1:.             
-0001b8f0: 2020 2020 2020 204d 332e 6d31 3220 3d20         M3.m12 = 
-0001b900: 760a 2020 2020 2020 2020 2020 2020 2020  v.              
-0001b910: 2020 6966 206b 3d3d 3020 616e 6420 6c3d    if k==0 and l=
-0001b920: 3d32 3a0a 2020 2020 2020 2020 2020 2020  =2:.            
-0001b930: 2020 2020 2020 2020 4d33 2e6d 3133 203d          M3.m13 =
-0001b940: 2076 0a20 2020 2020 2020 2020 2020 2020   v.             
-0001b950: 2020 2069 6620 6b3d 3d31 2061 6e64 206c     if k==1 and l
-0001b960: 3d3d 303a 0a20 2020 2020 2020 2020 2020  ==0:.           
-0001b970: 2020 2020 2020 2020 204d 332e 6d32 3120           M3.m21 
-0001b980: 3d20 760a 2020 2020 2020 2020 2020 2020  = v.            
-0001b990: 2020 2020 6966 206b 3d3d 3120 616e 6420      if k==1 and 
-0001b9a0: 6c3d 3d31 3a0a 2020 2020 2020 2020 2020  l==1:.          
-0001b9b0: 2020 2020 2020 2020 2020 4d33 2e6d 3232            M3.m22
-0001b9c0: 203d 2076 0a20 2020 2020 2020 2020 2020   = v.           
-0001b9d0: 2020 2020 2069 6620 6b3d 3d31 2061 6e64       if k==1 and
-0001b9e0: 206c 3d3d 323a 0a20 2020 2020 2020 2020   l==2:.         
-0001b9f0: 2020 2020 2020 2020 2020 204d 332e 6d32             M3.m2
-0001ba00: 3320 3d20 760a 2020 2020 2020 2020 2020  3 = v.          
-0001ba10: 2020 2020 2020 6966 206b 3d3d 3220 616e        if k==2 an
-0001ba20: 6420 6c3d 3d30 3a0a 2020 2020 2020 2020  d l==0:.        
-0001ba30: 2020 2020 2020 2020 2020 2020 4d33 2e6d              M3.m
-0001ba40: 3331 203d 2076 0a20 2020 2020 2020 2020  31 = v.         
-0001ba50: 2020 2020 2020 2069 6620 6b3d 3d32 2061         if k==2 a
-0001ba60: 6e64 206c 3d3d 313a 0a20 2020 2020 2020  nd l==1:.       
-0001ba70: 2020 2020 2020 2020 2020 2020 204d 332e               M3.
-0001ba80: 6d33 3220 3d20 760a 2020 2020 2020 2020  m32 = v.        
-0001ba90: 2020 2020 2020 2020 6966 206b 3d3d 3220          if k==2 
-0001baa0: 616e 6420 6c3d 3d32 3a0a 2020 2020 2020  and l==2:.      
-0001bab0: 2020 2020 2020 2020 2020 2020 2020 4d33                M3
-0001bac0: 2e6d 3333 203d 2076 0a0a 2020 2020 2020  .m33 = v..      
-0001bad0: 2020 2020 2020 2020 2020 6c3d 6c2b 310a            l=l+1.
-0001bae0: 2020 2020 2020 2020 2020 2020 6b3d 6b2b              k=k+
-0001baf0: 310a 2020 2020 2020 2020 7265 7475 726e  1.        return
-0001bb00: 204d 330a 0a20 2020 2064 6566 2069 6e76   M3..    def inv
-0001bb10: 6572 7365 2873 656c 6629 3a0a 2020 2020  erse(self):.    
-0001bb20: 2020 2020 2222 2252 6574 7572 6e20 696e      """Return in
-0001bb30: 7665 7273 6520 6d61 7472 6978 2e0a 0a20  verse matrix... 
-0001bb40: 2020 2020 2020 203e 3e3e 204d 3d6d 6174         >>> M=mat
-0001bb50: 3428 302c 2d32 2e30 2c30 2c30 2c20 322e  4(0,-2.0,0,0, 2.
-0001bb60: 302c 302c 302c 302c 2030 2c30 2c32 2c30  0,0,0,0, 0,0,2,0
-0001bb70: 2c20 302c 302c 302c 3229 0a20 2020 2020  , 0,0,0,2).     
-0001bb80: 2020 203e 3e3e 2070 7269 6e74 204d 2e69     >>> print M.i
-0001bb90: 6e76 6572 7365 2829 0a20 2020 2020 2020  nverse().       
-0001bba0: 205b 2020 2030 2e30 3030 302c 2020 2020   [   0.0000,    
-0001bbb0: 302e 3530 3030 2c20 2020 2030 2e30 3030  0.5000,    0.000
-0001bbc0: 302c 2020 2020 302e 3030 3030 5d0a 2020  0,    0.0000].  
-0001bbd0: 2020 2020 2020 5b20 202d 302e 3530 3030        [  -0.5000
-0001bbe0: 2c20 2020 2030 2e30 3030 302c 2020 2020  ,    0.0000,    
-0001bbf0: 302e 3030 3030 2c20 2020 2030 2e30 3030  0.0000,    0.000
-0001bc00: 305d 0a20 2020 2020 2020 205b 2020 2030  0].        [   0
-0001bc10: 2e30 3030 302c 2020 2020 302e 3030 3030  .0000,    0.0000
-0001bc20: 2c20 2020 2030 2e35 3030 302c 2020 2020  ,    0.5000,    
-0001bc30: 302e 3030 3030 5d0a 2020 2020 2020 2020  0.0000].        
-0001bc40: 5b20 2020 302e 3030 3030 2c20 2020 2030  [   0.0000,    0
-0001bc50: 2e30 3030 302c 2020 2020 302e 3030 3030  .0000,    0.0000
-0001bc60: 2c20 2020 2030 2e35 3030 305d 0a20 2020  ,    0.5000].   
-0001bc70: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0001bc80: 2063 6465 6620 6d61 7434 2072 6573 0a20   cdef mat4 res. 
-0001bc90: 2020 2020 2020 2063 6465 6620 7368 6f72         cdef shor
-0001bca0: 7420 692c 6a2c 2073 6967 6e0a 2020 2020  t i,j, sign.    
-0001bcb0: 2020 2020 6364 6566 2064 6f75 626c 6520      cdef double 
-0001bcc0: 6d34 5b31 365d 0a20 2020 2020 2020 2063  m4[16].        c
-0001bcd0: 6465 6620 646f 7562 6c65 206d 345f 7265  def double m4_re
-0001bce0: 735b 3136 5d0a 2020 2020 2020 2020 6364  s[16].        cd
-0001bcf0: 6566 2064 6f75 626c 6520 6465 742c 2064  ef double det, d
-0001bd00: 0a0a 2020 2020 2020 2020 6d34 5b30 5d20  ..        m4[0] 
-0001bd10: 3d20 7365 6c66 2e6d 3131 0a20 2020 2020  = self.m11.     
-0001bd20: 2020 206d 345b 315d 203d 2073 656c 662e     m4[1] = self.
-0001bd30: 6d31 320a 2020 2020 2020 2020 6d34 5b32  m12.        m4[2
-0001bd40: 5d20 3d20 7365 6c66 2e6d 3133 0a20 2020  ] = self.m13.   
-0001bd50: 2020 2020 206d 345b 335d 203d 2073 656c       m4[3] = sel
-0001bd60: 662e 6d31 340a 2020 2020 2020 2020 6d34  f.m14.        m4
-0001bd70: 5b34 5d20 3d20 7365 6c66 2e6d 3231 0a20  [4] = self.m21. 
-0001bd80: 2020 2020 2020 206d 345b 355d 203d 2073         m4[5] = s
-0001bd90: 656c 662e 6d32 320a 2020 2020 2020 2020  elf.m22.        
-0001bda0: 6d34 5b36 5d20 3d20 7365 6c66 2e6d 3233  m4[6] = self.m23
-0001bdb0: 0a20 2020 2020 2020 206d 345b 375d 203d  .        m4[7] =
-0001bdc0: 2073 656c 662e 6d32 340a 2020 2020 2020   self.m24.      
-0001bdd0: 2020 6d34 5b38 5d20 3d20 7365 6c66 2e6d    m4[8] = self.m
-0001bde0: 3331 0a20 2020 2020 2020 206d 345b 395d  31.        m4[9]
-0001bdf0: 203d 2073 656c 662e 6d33 320a 2020 2020   = self.m32.    
-0001be00: 2020 2020 6d34 5b31 305d 203d 2073 656c      m4[10] = sel
-0001be10: 662e 6d33 330a 2020 2020 2020 2020 6d34  f.m33.        m4
-0001be20: 5b31 315d 203d 2073 656c 662e 6d33 340a  [11] = self.m34.
-0001be30: 2020 2020 2020 2020 6d34 5b31 325d 203d          m4[12] =
-0001be40: 2073 656c 662e 6d34 310a 2020 2020 2020   self.m41.      
-0001be50: 2020 6d34 5b31 335d 203d 2073 656c 662e    m4[13] = self.
-0001be60: 6d34 320a 2020 2020 2020 2020 6d34 5b31  m42.        m4[1
-0001be70: 345d 203d 2073 656c 662e 6d34 330a 2020  4] = self.m43.  
-0001be80: 2020 2020 2020 6d34 5b31 355d 203d 2073        m4[15] = s
-0001be90: 656c 662e 6d34 340a 0a20 2020 2020 2020  elf.m44..       
-0001bea0: 2064 6574 3d73 656c 662e 6465 7465 726d   det=self.determ
-0001beb0: 696e 616e 7428 290a 2020 2020 2020 2020  inant().        
-0001bec0: 6966 2066 6162 7328 6465 7429 3c3d 6570  if fabs(det)<=ep
-0001bed0: 733a 0a20 2020 2020 2020 2020 2020 2072  s:.            r
-0001bee0: 6169 7365 205a 6572 6f44 6976 6973 696f  aise ZeroDivisio
-0001bef0: 6e45 7272 6f72 2c22 6d61 7472 6978 206e  nError,"matrix n
-0001bf00: 6f74 2069 6e76 6572 7469 626c 6522 0a0a  ot invertible"..
-0001bf10: 2020 2020 2020 2020 693d 300a 2020 2020          i=0.    
-0001bf20: 2020 2020 7768 696c 6520 693c 343a 0a20      while i<4:. 
-0001bf30: 2020 2020 2020 2020 2020 206a 3d30 0a20             j=0. 
-0001bf40: 2020 2020 2020 2020 2020 2077 6869 6c65             while
-0001bf50: 206a 3c34 3a0a 2020 2020 2020 2020 2020   j<4:.          
-0001bf60: 2020 2020 2020 7369 676e 3d31 2d28 2869        sign=1-((i
-0001bf70: 2b6a 2925 3229 2a32 0a20 2020 2020 2020  +j)%2)*2.       
-0001bf80: 2020 2020 2020 2020 2064 203d 205f 7375           d = _su
-0001bf90: 6264 6574 286d 342c 692c 6a29 0a20 2020  bdet(m4,i,j).   
-0001bfa0: 2020 2020 2020 2020 2020 2020 206d 345f               m4_
-0001bfb0: 7265 735b 6a2a 342b 695d 3d73 6967 6e2a  res[j*4+i]=sign*
-0001bfc0: 642f 6465 740a 2020 2020 2020 2020 2020  d/det.          
-0001bfd0: 2020 2020 2020 6a3d 6a2b 310a 2020 2020        j=j+1.    
-0001bfe0: 2020 2020 2020 2020 693d 692b 310a 0a20          i=i+1.. 
-0001bff0: 2020 2020 2020 2072 6573 203d 206d 6174         res = mat
-0001c000: 3428 290a 2020 2020 2020 2020 7265 732e  4().        res.
-0001c010: 6d31 3120 3d20 6d34 5f72 6573 5b30 5d0a  m11 = m4_res[0].
-0001c020: 2020 2020 2020 2020 7265 732e 6d31 3220          res.m12 
-0001c030: 3d20 6d34 5f72 6573 5b31 5d0a 2020 2020  = m4_res[1].    
-0001c040: 2020 2020 7265 732e 6d31 3320 3d20 6d34      res.m13 = m4
-0001c050: 5f72 6573 5b32 5d0a 2020 2020 2020 2020  _res[2].        
-0001c060: 7265 732e 6d31 3420 3d20 6d34 5f72 6573  res.m14 = m4_res
-0001c070: 5b33 5d0a 2020 2020 2020 2020 7265 732e  [3].        res.
-0001c080: 6d32 3120 3d20 6d34 5f72 6573 5b34 5d0a  m21 = m4_res[4].
-0001c090: 2020 2020 2020 2020 7265 732e 6d32 3220          res.m22 
-0001c0a0: 3d20 6d34 5f72 6573 5b35 5d0a 2020 2020  = m4_res[5].    
-0001c0b0: 2020 2020 7265 732e 6d32 3320 3d20 6d34      res.m23 = m4
-0001c0c0: 5f72 6573 5b36 5d0a 2020 2020 2020 2020  _res[6].        
-0001c0d0: 7265 732e 6d32 3420 3d20 6d34 5f72 6573  res.m24 = m4_res
-0001c0e0: 5b37 5d0a 2020 2020 2020 2020 7265 732e  [7].        res.
-0001c0f0: 6d33 3120 3d20 6d34 5f72 6573 5b38 5d0a  m31 = m4_res[8].
-0001c100: 2020 2020 2020 2020 7265 732e 6d33 3220          res.m32 
-0001c110: 3d20 6d34 5f72 6573 5b39 5d0a 2020 2020  = m4_res[9].    
-0001c120: 2020 2020 7265 732e 6d33 3320 3d20 6d34      res.m33 = m4
-0001c130: 5f72 6573 5b31 305d 0a20 2020 2020 2020  _res[10].       
-0001c140: 2072 6573 2e6d 3334 203d 206d 345f 7265   res.m34 = m4_re
-0001c150: 735b 3131 5d0a 2020 2020 2020 2020 7265  s[11].        re
-0001c160: 732e 6d34 3120 3d20 6d34 5f72 6573 5b31  s.m41 = m4_res[1
-0001c170: 325d 0a20 2020 2020 2020 2072 6573 2e6d  2].        res.m
-0001c180: 3432 203d 206d 345f 7265 735b 3133 5d0a  42 = m4_res[13].
-0001c190: 2020 2020 2020 2020 7265 732e 6d34 3320          res.m43 
-0001c1a0: 3d20 6d34 5f72 6573 5b31 345d 0a20 2020  = m4_res[14].   
-0001c1b0: 2020 2020 2072 6573 2e6d 3434 203d 206d       res.m44 = m
-0001c1c0: 345f 7265 735b 3135 5d0a 2020 2020 2020  4_res[15].      
-0001c1d0: 2020 7265 7475 726e 2072 6573 0a0a 0a20    return res... 
-0001c1e0: 2020 2064 6566 2074 7261 6e73 6c61 7469     def translati
-0001c1f0: 6f6e 2873 656c 662c 2074 293a 0a20 2020  on(self, t):.   
-0001c200: 2020 2020 2022 2222 5265 7475 726e 2074       """Return t
-0001c210: 7261 6e73 6c61 7469 6f6e 206d 6174 7269  ranslation matri
-0001c220: 782e 0a0a 2020 2020 2020 2020 7420 6d75  x...        t mu
-0001c230: 7374 2062 6520 6120 332d 7365 7175 656e  st be a 3-sequen
-0001c240: 6365 2028 652e 672e 2061 2076 6563 3329  ce (e.g. a vec3)
-0001c250: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-0001c260: 2020 2020 2020 6364 6566 206d 6174 3420        cdef mat4 
-0001c270: 7265 730a 2020 2020 2020 2020 7265 7320  res.        res 
-0001c280: 3d20 6d61 7434 2829 0a20 2020 2020 2020  = mat4().       
-0001c290: 2072 6573 2e6d 3131 203d 2031 2e30 0a20   res.m11 = 1.0. 
-0001c2a0: 2020 2020 2020 2072 6573 2e6d 3132 203d         res.m12 =
-0001c2b0: 2030 2e30 0a20 2020 2020 2020 2072 6573   0.0.        res
-0001c2c0: 2e6d 3133 203d 2030 2e30 0a20 2020 2020  .m13 = 0.0.     
-0001c2d0: 2020 2072 6573 2e6d 3134 203d 2074 5b30     res.m14 = t[0
-0001c2e0: 5d0a 2020 2020 2020 2020 7265 732e 6d32  ].        res.m2
-0001c2f0: 3120 3d20 302e 300a 2020 2020 2020 2020  1 = 0.0.        
-0001c300: 7265 732e 6d32 3220 3d20 312e 300a 2020  res.m22 = 1.0.  
-0001c310: 2020 2020 2020 7265 732e 6d32 3320 3d20        res.m23 = 
-0001c320: 302e 300a 2020 2020 2020 2020 7265 732e  0.0.        res.
-0001c330: 6d32 3420 3d20 745b 315d 0a20 2020 2020  m24 = t[1].     
-0001c340: 2020 2072 6573 2e6d 3331 203d 2030 2e30     res.m31 = 0.0
-0001c350: 0a20 2020 2020 2020 2072 6573 2e6d 3332  .        res.m32
-0001c360: 203d 2030 2e30 0a20 2020 2020 2020 2072   = 0.0.        r
-0001c370: 6573 2e6d 3333 203d 2031 2e30 0a20 2020  es.m33 = 1.0.   
-0001c380: 2020 2020 2072 6573 2e6d 3334 203d 2074       res.m34 = t
-0001c390: 5b32 5d0a 2020 2020 2020 2020 7265 732e  [2].        res.
-0001c3a0: 6d34 3120 3d20 302e 300a 2020 2020 2020  m41 = 0.0.      
-0001c3b0: 2020 7265 732e 6d34 3220 3d20 302e 300a    res.m42 = 0.0.
-0001c3c0: 2020 2020 2020 2020 7265 732e 6d34 3320          res.m43 
-0001c3d0: 3d20 302e 300a 2020 2020 2020 2020 7265  = 0.0.        re
-0001c3e0: 732e 6d34 3420 3d20 312e 300a 2020 2020  s.m44 = 1.0.    
-0001c3f0: 2020 2020 7265 7475 726e 2072 6573 0a0a      return res..
-0001c400: 2020 2020 6465 6620 7363 616c 696e 6728      def scaling(
-0001c410: 7365 6c66 2c20 7329 3a0a 2020 2020 2020  self, s):.      
-0001c420: 2020 2222 2252 6574 7572 6e20 7363 616c    """Return scal
-0001c430: 696e 6720 6d61 7472 6978 2e0a 0a20 2020  ing matrix...   
-0001c440: 2020 2020 2073 206d 7573 7420 6265 2061       s must be a
-0001c450: 2033 2d73 6571 7565 6e63 6520 2865 2e67   3-sequence (e.g
-0001c460: 2e20 6120 7665 6333 292e 0a20 2020 2020  . a vec3)..     
-0001c470: 2020 2022 2222 0a20 2020 2020 2020 2063     """.        c
-0001c480: 6465 6620 6d61 7434 2072 6573 0a20 2020  def mat4 res.   
-0001c490: 2020 2020 2072 6573 203d 206d 6174 3428       res = mat4(
-0001c4a0: 290a 2020 2020 2020 2020 7265 732e 6d31  ).        res.m1
-0001c4b0: 3120 3d20 735b 305d 0a20 2020 2020 2020  1 = s[0].       
-0001c4c0: 2072 6573 2e6d 3132 203d 2030 2e30 0a20   res.m12 = 0.0. 
-0001c4d0: 2020 2020 2020 2072 6573 2e6d 3133 203d         res.m13 =
-0001c4e0: 2030 2e30 0a20 2020 2020 2020 2072 6573   0.0.        res
-0001c4f0: 2e6d 3134 203d 2030 2e30 0a20 2020 2020  .m14 = 0.0.     
-0001c500: 2020 2072 6573 2e6d 3231 203d 2030 2e30     res.m21 = 0.0
-0001c510: 0a20 2020 2020 2020 2072 6573 2e6d 3232  .        res.m22
-0001c520: 203d 2073 5b31 5d0a 2020 2020 2020 2020   = s[1].        
-0001c530: 7265 732e 6d32 3320 3d20 302e 300a 2020  res.m23 = 0.0.  
-0001c540: 2020 2020 2020 7265 732e 6d32 3420 3d20        res.m24 = 
-0001c550: 302e 300a 2020 2020 2020 2020 7265 732e  0.0.        res.
-0001c560: 6d33 3120 3d20 302e 300a 2020 2020 2020  m31 = 0.0.      
-0001c570: 2020 7265 732e 6d33 3220 3d20 302e 300a    res.m32 = 0.0.
-0001c580: 2020 2020 2020 2020 7265 732e 6d33 3320          res.m33 
-0001c590: 3d20 735b 325d 0a20 2020 2020 2020 2072  = s[2].        r
-0001c5a0: 6573 2e6d 3334 203d 2030 2e30 0a20 2020  es.m34 = 0.0.   
-0001c5b0: 2020 2020 2072 6573 2e6d 3431 203d 2030       res.m41 = 0
-0001c5c0: 2e30 0a20 2020 2020 2020 2072 6573 2e6d  .0.        res.m
-0001c5d0: 3432 203d 2030 2e30 0a20 2020 2020 2020  42 = 0.0.       
-0001c5e0: 2072 6573 2e6d 3433 203d 2030 2e30 0a20   res.m43 = 0.0. 
-0001c5f0: 2020 2020 2020 2072 6573 2e6d 3434 203d         res.m44 =
-0001c600: 2031 2e30 0a20 2020 2020 2020 2072 6574   1.0.        ret
-0001c610: 7572 6e20 7265 730a 0a20 2020 2064 6566  urn res..    def
-0001c620: 2072 6f74 6174 696f 6e28 7365 6c66 2c20   rotation(self, 
-0001c630: 616e 676c 652c 2061 7869 7329 3a0a 2020  angle, axis):.  
-0001c640: 2020 2020 2020 2222 2252 6574 7572 6e20        """Return 
-0001c650: 726f 7461 7469 6f6e 206d 6174 7269 782e  rotation matrix.
-0001c660: 0a0a 2020 2020 2020 2020 616e 676c 6520  ..        angle 
-0001c670: 6d75 7374 2062 6520 6769 7665 6e20 696e  must be given in
-0001c680: 2072 6164 6961 6e73 2e20 6178 6973 206d   radians. axis m
-0001c690: 7573 7420 6265 2061 2033 2d73 6571 7565  ust be a 3-seque
-0001c6a0: 6e63 652e 0a20 2020 2020 2020 2022 2222  nce..        """
-0001c6b0: 0a20 2020 2020 2020 2063 6465 6620 646f  .        cdef do
-0001c6c0: 7562 6c65 2063 616e 676c 652c 2061 782c  uble cangle, ax,
-0001c6d0: 2061 792c 2061 7a0a 2020 2020 2020 2020   ay, az.        
-0001c6e0: 6364 6566 2064 6f75 626c 6520 7371 725f  cdef double sqr_
-0001c6f0: 612c 2073 7172 5f62 2c20 7371 725f 632c  a, sqr_b, sqr_c,
-0001c700: 206c 656e 320a 2020 2020 2020 2020 6364   len2.        cd
-0001c710: 6566 2064 6f75 626c 6520 6b31 2c20 6b32  ef double k1, k2
-0001c720: 2c20 6b33 2c20 6b31 6162 2c20 6b31 6163  , k3, k1ab, k1ac
-0001c730: 2c20 6b31 6263 2c20 6b33 612c 206b 3362  , k1bc, k3a, k3b
-0001c740: 2c20 6b33 630a 2020 2020 2020 2020 6364  , k3c.        cd
-0001c750: 6566 206d 6174 3420 7265 730a 0a20 2020  ef mat4 res..   
-0001c760: 2020 2020 2063 616e 676c 6520 2020 3d20       cangle   = 
-0001c770: 616e 676c 650a 2020 2020 2020 2020 6178  angle.        ax
-0001c780: 2020 2020 3d20 6178 6973 5b30 5d0a 2020      = axis[0].  
-0001c790: 2020 2020 2020 6179 2020 2020 3d20 6178        ay    = ax
-0001c7a0: 6973 5b31 5d0a 2020 2020 2020 2020 617a  is[1].        az
-0001c7b0: 2020 2020 3d20 6178 6973 5b32 5d0a 2020      = axis[2].  
-0001c7c0: 2020 2020 2020 7371 725f 6120 3d20 6178        sqr_a = ax
-0001c7d0: 2a61 780a 2020 2020 2020 2020 7371 725f  *ax.        sqr_
-0001c7e0: 6220 3d20 6179 2a61 790a 2020 2020 2020  b = ay*ay.      
-0001c7f0: 2020 7371 725f 6320 3d20 617a 2a61 7a0a    sqr_c = az*az.
-0001c800: 2020 2020 2020 2020 6c65 6e32 2020 3d20          len2  = 
-0001c810: 7371 725f 612b 7371 725f 622b 7371 725f  sqr_a+sqr_b+sqr_
-0001c820: 630a 0a20 2020 2020 2020 206b 3220 2020  c..        k2   
-0001c830: 203d 2063 6f73 2863 616e 676c 6529 0a20   = cos(cangle). 
-0001c840: 2020 2020 2020 206b 3120 2020 203d 2028         k1    = (
-0001c850: 312e 302d 6b32 292f 6c65 6e32 0a20 2020  1.0-k2)/len2.   
-0001c860: 2020 2020 206b 3320 2020 203d 2073 696e       k3    = sin
-0001c870: 2863 616e 676c 6529 2f73 7172 7428 6c65  (cangle)/sqrt(le
-0001c880: 6e32 290a 2020 2020 2020 2020 6b31 6162  n2).        k1ab
-0001c890: 2020 3d20 6b31 2a61 782a 6179 0a20 2020    = k1*ax*ay.   
-0001c8a0: 2020 2020 206b 3161 6320 203d 206b 312a       k1ac  = k1*
-0001c8b0: 6178 2a61 7a0a 2020 2020 2020 2020 6b31  ax*az.        k1
-0001c8c0: 6263 2020 3d20 6b31 2a61 792a 617a 0a20  bc  = k1*ay*az. 
-0001c8d0: 2020 2020 2020 206b 3361 2020 203d 206b         k3a   = k
-0001c8e0: 332a 6178 0a20 2020 2020 2020 206b 3362  3*ax.        k3b
-0001c8f0: 2020 203d 206b 332a 6179 0a20 2020 2020     = k3*ay.     
-0001c900: 2020 206b 3363 2020 203d 206b 332a 617a     k3c   = k3*az
-0001c910: 0a0a 2020 2020 2020 2020 7265 7320 3d20  ..        res = 
-0001c920: 6d61 7434 2829 0a20 2020 2020 2020 2072  mat4().        r
-0001c930: 6573 2e6d 3131 203d 206b 312a 7371 725f  es.m11 = k1*sqr_
-0001c940: 612b 6b32 0a20 2020 2020 2020 2072 6573  a+k2.        res
-0001c950: 2e6d 3132 203d 206b 3161 622d 6b33 630a  .m12 = k1ab-k3c.
-0001c960: 2020 2020 2020 2020 7265 732e 6d31 3320          res.m13 
-0001c970: 3d20 6b31 6163 2b6b 3362 0a20 2020 2020  = k1ac+k3b.     
-0001c980: 2020 2072 6573 2e6d 3134 203d 2030 2e30     res.m14 = 0.0
-0001c990: 0a20 2020 2020 2020 2072 6573 2e6d 3231  .        res.m21
-0001c9a0: 203d 206b 3161 622b 6b33 630a 2020 2020   = k1ab+k3c.    
-0001c9b0: 2020 2020 7265 732e 6d32 3220 3d20 6b31      res.m22 = k1
-0001c9c0: 2a73 7172 5f62 2b6b 320a 2020 2020 2020  *sqr_b+k2.      
-0001c9d0: 2020 7265 732e 6d32 3320 3d20 6b31 6263    res.m23 = k1bc
-0001c9e0: 2d6b 3361 0a20 2020 2020 2020 2072 6573  -k3a.        res
-0001c9f0: 2e6d 3234 203d 2030 2e30 0a20 2020 2020  .m24 = 0.0.     
-0001ca00: 2020 2072 6573 2e6d 3331 203d 206b 3161     res.m31 = k1a
-0001ca10: 632d 6b33 620a 2020 2020 2020 2020 7265  c-k3b.        re
-0001ca20: 732e 6d33 3220 3d20 6b31 6263 2b6b 3361  s.m32 = k1bc+k3a
-0001ca30: 0a20 2020 2020 2020 2072 6573 2e6d 3333  .        res.m33
-0001ca40: 203d 206b 312a 7371 725f 632b 6b32 0a20   = k1*sqr_c+k2. 
-0001ca50: 2020 2020 2020 2072 6573 2e6d 3334 203d         res.m34 =
-0001ca60: 2030 2e30 0a20 2020 2020 2020 2072 6573   0.0.        res
-0001ca70: 2e6d 3431 203d 2030 2e30 0a20 2020 2020  .m41 = 0.0.     
-0001ca80: 2020 2072 6573 2e6d 3432 203d 2030 2e30     res.m42 = 0.0
-0001ca90: 0a20 2020 2020 2020 2072 6573 2e6d 3433  .        res.m43
-0001caa0: 203d 2030 2e30 0a20 2020 2020 2020 2072   = 0.0.        r
-0001cab0: 6573 2e6d 3434 203d 2031 2e30 0a20 2020  es.m44 = 1.0.   
-0001cac0: 2020 2020 2072 6574 7572 6e20 7265 730a       return res.
-0001cad0: 0a0a 2020 2020 6465 6620 7472 616e 736c  ..    def transl
-0001cae0: 6174 6528 7365 6c66 2c20 7429 3a0a 2020  ate(self, t):.  
-0001caf0: 2020 2020 2020 2222 2243 6f6e 6361 7465        """Concate
-0001cb00: 6e61 7465 2061 2074 7261 6e73 6c61 7469  nate a translati
-0001cb10: 6f6e 2e0a 0a20 2020 2020 2020 2074 206d  on...        t m
-0001cb20: 7573 7420 6265 2061 2033 2d73 6571 7565  ust be a 3-seque
-0001cb30: 6e63 6520 2865 2e67 2e20 6120 7665 6333  nce (e.g. a vec3
-0001cb40: 292e 0a20 2020 2020 2020 2022 2222 0a20  )..        """. 
-0001cb50: 2020 2020 2020 2063 6465 6620 646f 7562         cdef doub
-0001cb60: 6c65 2074 782c 2074 792c 2074 7a0a 2020  le tx, ty, tz.  
-0001cb70: 2020 2020 2020 7478 203d 2074 5b30 5d0a        tx = t[0].
-0001cb80: 2020 2020 2020 2020 7479 203d 2074 5b31          ty = t[1
-0001cb90: 5d0a 2020 2020 2020 2020 747a 203d 2074  ].        tz = t
-0001cba0: 5b32 5d0a 0a20 2020 2020 2020 2073 656c  [2]..        sel
-0001cbb0: 662e 6d31 3420 3d20 7365 6c66 2e6d 3131  f.m14 = self.m11
-0001cbc0: 2a74 7820 2b20 7365 6c66 2e6d 3132 2a74  *tx + self.m12*t
-0001cbd0: 7920 2b20 7365 6c66 2e6d 3133 2a74 7a20  y + self.m13*tz 
-0001cbe0: 2b20 7365 6c66 2e6d 3134 0a20 2020 2020  + self.m14.     
-0001cbf0: 2020 2073 656c 662e 6d32 3420 3d20 7365     self.m24 = se
-0001cc00: 6c66 2e6d 3231 2a74 7820 2b20 7365 6c66  lf.m21*tx + self
-0001cc10: 2e6d 3232 2a74 7920 2b20 7365 6c66 2e6d  .m22*ty + self.m
-0001cc20: 3233 2a74 7a20 2b20 7365 6c66 2e6d 3234  23*tz + self.m24
-0001cc30: 0a20 2020 2020 2020 2073 656c 662e 6d33  .        self.m3
-0001cc40: 3420 3d20 7365 6c66 2e6d 3331 2a74 7820  4 = self.m31*tx 
-0001cc50: 2b20 7365 6c66 2e6d 3332 2a74 7920 2b20  + self.m32*ty + 
-0001cc60: 7365 6c66 2e6d 3333 2a74 7a20 2b20 7365  self.m33*tz + se
-0001cc70: 6c66 2e6d 3334 0a20 2020 2020 2020 2073  lf.m34.        s
-0001cc80: 656c 662e 6d34 3420 3d20 7365 6c66 2e6d  elf.m44 = self.m
-0001cc90: 3431 2a74 7820 2b20 7365 6c66 2e6d 3432  41*tx + self.m42
-0001cca0: 2a74 7920 2b20 7365 6c66 2e6d 3433 2a74  *ty + self.m43*t
-0001ccb0: 7a20 2b20 7365 6c66 2e6d 3434 0a20 2020  z + self.m44.   
-0001ccc0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-0001ccd0: 0a0a 2020 2020 6465 6620 7363 616c 6528  ..    def scale(
-0001cce0: 7365 6c66 2c20 7329 3a0a 2020 2020 2020  self, s):.      
-0001ccf0: 2020 2222 2243 6f6e 6361 7465 6e61 7465    """Concatenate
-0001cd00: 2061 2073 6361 6c69 6e67 2e0a 0a20 2020   a scaling...   
-0001cd10: 2020 2020 2073 206d 7573 7420 6265 2061       s must be a
-0001cd20: 2033 2d73 6571 7565 6e63 6520 2865 2e67   3-sequence (e.g
-0001cd30: 2e20 6120 7665 6333 292e 0a20 2020 2020  . a vec3)..     
-0001cd40: 2020 2022 2222 0a20 2020 2020 2020 2063     """.        c
-0001cd50: 6465 6620 646f 7562 6c65 2073 782c 2073  def double sx, s
-0001cd60: 792c 2073 7a0a 2020 2020 2020 2020 7378  y, sz.        sx
-0001cd70: 203d 2073 5b30 5d0a 2020 2020 2020 2020   = s[0].        
-0001cd80: 7379 203d 2073 5b31 5d0a 2020 2020 2020  sy = s[1].      
-0001cd90: 2020 737a 203d 2073 5b32 5d0a 2020 2020    sz = s[2].    
-0001cda0: 2020 2020 7365 6c66 2e6d 3131 203d 2073      self.m11 = s
-0001cdb0: 656c 662e 6d31 312a 7378 0a20 2020 2020  elf.m11*sx.     
-0001cdc0: 2020 2073 656c 662e 6d31 3220 3d20 7365     self.m12 = se
-0001cdd0: 6c66 2e6d 3132 2a73 790a 2020 2020 2020  lf.m12*sy.      
-0001cde0: 2020 7365 6c66 2e6d 3133 203d 2073 656c    self.m13 = sel
-0001cdf0: 662e 6d31 332a 737a 0a20 2020 2020 2020  f.m13*sz.       
-0001ce00: 2073 656c 662e 6d32 3120 3d20 7365 6c66   self.m21 = self
-0001ce10: 2e6d 3231 2a73 780a 2020 2020 2020 2020  .m21*sx.        
-0001ce20: 7365 6c66 2e6d 3232 203d 2073 656c 662e  self.m22 = self.
-0001ce30: 6d32 322a 7379 0a20 2020 2020 2020 2073  m22*sy.        s
-0001ce40: 656c 662e 6d32 3320 3d20 7365 6c66 2e6d  elf.m23 = self.m
-0001ce50: 3233 2a73 7a0a 2020 2020 2020 2020 7365  23*sz.        se
-0001ce60: 6c66 2e6d 3331 203d 2073 656c 662e 6d33  lf.m31 = self.m3
-0001ce70: 312a 7378 0a20 2020 2020 2020 2073 656c  1*sx.        sel
-0001ce80: 662e 6d33 3220 3d20 7365 6c66 2e6d 3332  f.m32 = self.m32
-0001ce90: 2a73 790a 2020 2020 2020 2020 7365 6c66  *sy.        self
-0001cea0: 2e6d 3333 203d 2073 656c 662e 6d33 332a  .m33 = self.m33*
-0001ceb0: 737a 0a20 2020 2020 2020 2073 656c 662e  sz.        self.
-0001cec0: 6d34 3120 3d20 7365 6c66 2e6d 3431 2a73  m41 = self.m41*s
-0001ced0: 780a 2020 2020 2020 2020 7365 6c66 2e6d  x.        self.m
-0001cee0: 3432 203d 2073 656c 662e 6d34 322a 7379  42 = self.m42*sy
-0001cef0: 0a20 2020 2020 2020 2073 656c 662e 6d34  .        self.m4
-0001cf00: 3320 3d20 7365 6c66 2e6d 3433 2a73 7a0a  3 = self.m43*sz.
-0001cf10: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0001cf20: 656c 660a 0a20 2020 2064 6566 2072 6f74  elf..    def rot
-0001cf30: 6174 6528 7365 6c66 2c20 616e 676c 652c  ate(self, angle,
-0001cf40: 2061 7869 7329 3a0a 2020 2020 2020 2020   axis):.        
-0001cf50: 2222 2243 6f6e 6361 7465 6e61 7465 2061  """Concatenate a
-0001cf60: 2072 6f74 6174 696f 6e2e 0a0a 2020 2020   rotation...    
-0001cf70: 2020 2020 616e 676c 6520 6d75 7374 2062      angle must b
-0001cf80: 6520 6769 7665 6e20 696e 2072 6164 6961  e given in radia
-0001cf90: 6e73 2e20 6178 6973 206d 7573 7420 6265  ns. axis must be
-0001cfa0: 2061 2033 2d73 6571 7565 6e63 652e 0a20   a 3-sequence.. 
-0001cfb0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0001cfc0: 2020 2063 6465 6620 6d61 7434 2052 0a20     cdef mat4 R. 
-0001cfd0: 2020 2020 2020 2063 6465 6620 646f 7562         cdef doub
-0001cfe0: 6c65 2063 312c 2063 322c 2063 332c 2063  le c1, c2, c3, c
-0001cff0: 340a 2020 2020 2020 2020 523d 7365 6c66  4.        R=self
-0001d000: 2e72 6f74 6174 696f 6e28 616e 676c 652c  .rotation(angle,
-0001d010: 2061 7869 7329 0a0a 2020 2020 2020 2020   axis)..        
-0001d020: 2320 7365 6c66 2a52 2020 2869 6e2d 706c  # self*R  (in-pl
-0001d030: 6163 6529 0a20 2020 2020 2020 2063 3120  ace).        c1 
-0001d040: 3d20 7365 6c66 2e6d 3131 0a20 2020 2020  = self.m11.     
-0001d050: 2020 2063 3220 3d20 7365 6c66 2e6d 3132     c2 = self.m12
-0001d060: 0a20 2020 2020 2020 2063 3320 3d20 7365  .        c3 = se
-0001d070: 6c66 2e6d 3133 0a20 2020 2020 2020 2063  lf.m13.        c
-0001d080: 3420 3d20 7365 6c66 2e6d 3134 0a20 2020  4 = self.m14.   
-0001d090: 2020 2020 2073 656c 662e 6d31 3120 3d20       self.m11 = 
-0001d0a0: 6331 2a52 2e6d 3131 2b63 322a 522e 6d32  c1*R.m11+c2*R.m2
-0001d0b0: 312b 6333 2a52 2e6d 3331 2b63 342a 522e  1+c3*R.m31+c4*R.
-0001d0c0: 6d34 310a 2020 2020 2020 2020 7365 6c66  m41.        self
-0001d0d0: 2e6d 3132 203d 2063 312a 522e 6d31 322b  .m12 = c1*R.m12+
-0001d0e0: 6332 2a52 2e6d 3232 2b63 332a 522e 6d33  c2*R.m22+c3*R.m3
-0001d0f0: 322b 6334 2a52 2e6d 3432 0a20 2020 2020  2+c4*R.m42.     
-0001d100: 2020 2073 656c 662e 6d31 3320 3d20 6331     self.m13 = c1
-0001d110: 2a52 2e6d 3133 2b63 322a 522e 6d32 332b  *R.m13+c2*R.m23+
-0001d120: 6333 2a52 2e6d 3333 2b63 342a 522e 6d34  c3*R.m33+c4*R.m4
-0001d130: 330a 2020 2020 2020 2020 7365 6c66 2e6d  3.        self.m
-0001d140: 3134 203d 2063 312a 522e 6d31 342b 6332  14 = c1*R.m14+c2
-0001d150: 2a52 2e6d 3234 2b63 332a 522e 6d33 342b  *R.m24+c3*R.m34+
-0001d160: 6334 2a52 2e6d 3434 0a0a 2020 2020 2020  c4*R.m44..      
-0001d170: 2020 6331 203d 2073 656c 662e 6d32 310a    c1 = self.m21.
-0001d180: 2020 2020 2020 2020 6332 203d 2073 656c          c2 = sel
-0001d190: 662e 6d32 320a 2020 2020 2020 2020 6333  f.m22.        c3
-0001d1a0: 203d 2073 656c 662e 6d32 330a 2020 2020   = self.m23.    
-0001d1b0: 2020 2020 6334 203d 2073 656c 662e 6d32      c4 = self.m2
-0001d1c0: 340a 2020 2020 2020 2020 7365 6c66 2e6d  4.        self.m
-0001d1d0: 3231 203d 2063 312a 522e 6d31 312b 6332  21 = c1*R.m11+c2
-0001d1e0: 2a52 2e6d 3231 2b63 332a 522e 6d33 312b  *R.m21+c3*R.m31+
-0001d1f0: 6334 2a52 2e6d 3431 0a20 2020 2020 2020  c4*R.m41.       
-0001d200: 2073 656c 662e 6d32 3220 3d20 6331 2a52   self.m22 = c1*R
-0001d210: 2e6d 3132 2b63 322a 522e 6d32 322b 6333  .m12+c2*R.m22+c3
-0001d220: 2a52 2e6d 3332 2b63 342a 522e 6d34 320a  *R.m32+c4*R.m42.
-0001d230: 2020 2020 2020 2020 7365 6c66 2e6d 3233          self.m23
-0001d240: 203d 2063 312a 522e 6d31 332b 6332 2a52   = c1*R.m13+c2*R
-0001d250: 2e6d 3233 2b63 332a 522e 6d33 332b 6334  .m23+c3*R.m33+c4
-0001d260: 2a52 2e6d 3433 0a20 2020 2020 2020 2073  *R.m43.        s
-0001d270: 656c 662e 6d32 3420 3d20 6331 2a52 2e6d  elf.m24 = c1*R.m
-0001d280: 3134 2b63 322a 522e 6d32 342b 6333 2a52  14+c2*R.m24+c3*R
-0001d290: 2e6d 3334 2b63 342a 522e 6d34 340a 0a20  .m34+c4*R.m44.. 
-0001d2a0: 2020 2020 2020 2063 3120 3d20 7365 6c66         c1 = self
-0001d2b0: 2e6d 3331 0a20 2020 2020 2020 2063 3220  .m31.        c2 
-0001d2c0: 3d20 7365 6c66 2e6d 3332 0a20 2020 2020  = self.m32.     
-0001d2d0: 2020 2063 3320 3d20 7365 6c66 2e6d 3333     c3 = self.m33
-0001d2e0: 0a20 2020 2020 2020 2063 3420 3d20 7365  .        c4 = se
-0001d2f0: 6c66 2e6d 3334 0a20 2020 2020 2020 2073  lf.m34.        s
-0001d300: 656c 662e 6d33 3120 3d20 6331 2a52 2e6d  elf.m31 = c1*R.m
-0001d310: 3131 2b63 322a 522e 6d32 312b 6333 2a52  11+c2*R.m21+c3*R
-0001d320: 2e6d 3331 2b63 342a 522e 6d34 310a 2020  .m31+c4*R.m41.  
-0001d330: 2020 2020 2020 7365 6c66 2e6d 3332 203d        self.m32 =
-0001d340: 2063 312a 522e 6d31 322b 6332 2a52 2e6d   c1*R.m12+c2*R.m
-0001d350: 3232 2b63 332a 522e 6d33 322b 6334 2a52  22+c3*R.m32+c4*R
-0001d360: 2e6d 3432 0a20 2020 2020 2020 2073 656c  .m42.        sel
-0001d370: 662e 6d33 3320 3d20 6331 2a52 2e6d 3133  f.m33 = c1*R.m13
-0001d380: 2b63 322a 522e 6d32 332b 6333 2a52 2e6d  +c2*R.m23+c3*R.m
-0001d390: 3333 2b63 342a 522e 6d34 330a 2020 2020  33+c4*R.m43.    
-0001d3a0: 2020 2020 7365 6c66 2e6d 3334 203d 2063      self.m34 = c
-0001d3b0: 312a 522e 6d31 342b 6332 2a52 2e6d 3234  1*R.m14+c2*R.m24
-0001d3c0: 2b63 332a 522e 6d33 342b 6334 2a52 2e6d  +c3*R.m34+c4*R.m
-0001d3d0: 3434 0a0a 2020 2020 2020 2020 6331 203d  44..        c1 =
-0001d3e0: 2073 656c 662e 6d34 310a 2020 2020 2020   self.m41.      
-0001d3f0: 2020 6332 203d 2073 656c 662e 6d34 320a    c2 = self.m42.
-0001d400: 2020 2020 2020 2020 6333 203d 2073 656c          c3 = sel
-0001d410: 662e 6d34 330a 2020 2020 2020 2020 6334  f.m43.        c4
-0001d420: 203d 2073 656c 662e 6d34 340a 2020 2020   = self.m44.    
-0001d430: 2020 2020 7365 6c66 2e6d 3431 203d 2063      self.m41 = c
-0001d440: 312a 522e 6d31 312b 6332 2a52 2e6d 3231  1*R.m11+c2*R.m21
-0001d450: 2b63 332a 522e 6d33 312b 6334 2a52 2e6d  +c3*R.m31+c4*R.m
-0001d460: 3431 0a20 2020 2020 2020 2073 656c 662e  41.        self.
-0001d470: 6d34 3220 3d20 6331 2a52 2e6d 3132 2b63  m42 = c1*R.m12+c
-0001d480: 322a 522e 6d32 322b 6333 2a52 2e6d 3332  2*R.m22+c3*R.m32
-0001d490: 2b63 342a 522e 6d34 320a 2020 2020 2020  +c4*R.m42.      
-0001d4a0: 2020 7365 6c66 2e6d 3433 203d 2063 312a    self.m43 = c1*
-0001d4b0: 522e 6d31 332b 6332 2a52 2e6d 3233 2b63  R.m13+c2*R.m23+c
-0001d4c0: 332a 522e 6d33 332b 6334 2a52 2e6d 3433  3*R.m33+c4*R.m43
-0001d4d0: 0a20 2020 2020 2020 2073 656c 662e 6d34  .        self.m4
-0001d4e0: 3420 3d20 6331 2a52 2e6d 3134 2b63 322a  4 = c1*R.m14+c2*
-0001d4f0: 522e 6d32 342b 6333 2a52 2e6d 3334 2b63  R.m24+c3*R.m34+c
-0001d500: 342a 522e 6d34 340a 0a20 2020 2020 2020  4*R.m44..       
-0001d510: 2072 6574 7572 6e20 7365 6c66 0a0a 2020   return self..  
-0001d520: 2020 6465 6620 6f72 7468 6f67 7261 7068    def orthograph
-0001d530: 6963 2873 656c 662c 206c 6566 742c 2072  ic(self, left, r
-0001d540: 6967 6874 2c20 626f 7474 6f6d 2c20 746f  ight, bottom, to
-0001d550: 702c 206e 6561 722c 2066 6172 293a 0a20  p, near, far):. 
-0001d560: 2020 2020 2020 2022 2222 6571 7569 7661         """equiva
-0001d570: 6c65 6e74 2074 6f20 7468 6520 4f70 656e  lent to the Open
-0001d580: 474c 2063 6f6d 6d61 6e64 2067 6c4f 7274  GL command glOrt
-0001d590: 686f 2829 2222 220a 2020 2020 2020 2020  ho()""".        
-0001d5a0: 6364 6566 206d 6174 3420 7265 730a 2020  cdef mat4 res.  
-0001d5b0: 2020 2020 2020 6364 6566 2064 6f75 626c        cdef doubl
-0001d5c0: 6520 6c2c 722c 622c 742c 6e2c 662c 2072  e l,r,b,t,n,f, r
-0001d5d0: 5f6c 2c20 745f 622c 2066 5f6e 0a0a 2020  _l, t_b, f_n..  
-0001d5e0: 2020 2020 2020 6c20 3d20 6c65 6674 0a20        l = left. 
-0001d5f0: 2020 2020 2020 2072 203d 2072 6967 6874         r = right
-0001d600: 0a20 2020 2020 2020 2062 203d 2062 6f74  .        b = bot
-0001d610: 746f 6d0a 2020 2020 2020 2020 7420 3d20  tom.        t = 
-0001d620: 746f 700a 2020 2020 2020 2020 6e20 3d20  top.        n = 
-0001d630: 6e65 6172 0a20 2020 2020 2020 2066 203d  near.        f =
-0001d640: 2066 6172 0a0a 2020 2020 2020 2020 725f   far..        r_
-0001d650: 6c20 3d20 722d 6c0a 2020 2020 2020 2020  l = r-l.        
-0001d660: 745f 6220 3d20 742d 620a 2020 2020 2020  t_b = t-b.      
-0001d670: 2020 665f 6e20 3d20 662d 6e0a 0a20 2020    f_n = f-n..   
-0001d680: 2020 2020 2069 6620 725f 6c3c 3d65 7073       if r_l<=eps
-0001d690: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
-0001d6a0: 6973 6520 5661 6c75 6545 7272 6f72 2c20  ise ValueError, 
-0001d6b0: 2272 6967 6874 2d76 616c 7565 206d 7573  "right-value mus
-0001d6c0: 7420 6265 2067 7265 6174 6572 2074 6861  t be greater tha
-0001d6d0: 6e20 6c65 6674 2d76 616c 7565 220a 2020  n left-value".  
-0001d6e0: 2020 2020 2020 6966 2074 5f62 3c3d 6570        if t_b<=ep
-0001d6f0: 733a 0a20 2020 2020 2020 2020 2020 2072  s:.            r
-0001d700: 6169 7365 2056 616c 7565 4572 726f 722c  aise ValueError,
-0001d710: 2022 746f 702d 7661 6c75 6520 6d75 7374   "top-value must
-0001d720: 2062 6520 6772 6561 7465 7220 7468 616e   be greater than
-0001d730: 2062 6f74 746f 6d2d 7661 6c75 6522 0a20   bottom-value". 
-0001d740: 2020 2020 2020 2069 6620 665f 6e3c 3d65         if f_n<=e
-0001d750: 7073 3a0a 2020 2020 2020 2020 2020 2020  ps:.            
-0001d760: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
-0001d770: 2c20 2266 6172 2d76 616c 7565 206d 7573  , "far-value mus
-0001d780: 7420 6265 2067 7265 6174 6572 2074 6861  t be greater tha
-0001d790: 6e20 6e65 6172 2d76 616c 7565 220a 0a20  n near-value".. 
-0001d7a0: 2020 2020 2020 2072 6573 203d 206d 6174         res = mat
-0001d7b0: 3428 290a 0a20 2020 2020 2020 2072 6573  4()..        res
-0001d7c0: 2e6d 3131 203d 2032 2e30 2f72 5f6c 0a20  .m11 = 2.0/r_l. 
-0001d7d0: 2020 2020 2020 2072 6573 2e6d 3132 203d         res.m12 =
-0001d7e0: 2030 2e30 0a20 2020 2020 2020 2072 6573   0.0.        res
-0001d7f0: 2e6d 3133 203d 2030 2e30 0a20 2020 2020  .m13 = 0.0.     
-0001d800: 2020 2072 6573 2e6d 3134 203d 202d 2872     res.m14 = -(r
-0001d810: 2b6c 292f 725f 6c0a 2020 2020 2020 2020  +l)/r_l.        
-0001d820: 7265 732e 6d32 3120 3d20 302e 300a 2020  res.m21 = 0.0.  
-0001d830: 2020 2020 2020 7265 732e 6d32 3220 3d20        res.m22 = 
-0001d840: 322e 302f 745f 620a 2020 2020 2020 2020  2.0/t_b.        
-0001d850: 7265 732e 6d32 3320 3d20 302e 300a 2020  res.m23 = 0.0.  
-0001d860: 2020 2020 2020 7265 732e 6d32 3420 3d20        res.m24 = 
-0001d870: 2d28 742b 6229 2f74 5f62 0a20 2020 2020  -(t+b)/t_b.     
-0001d880: 2020 2072 6573 2e6d 3331 203d 2030 2e30     res.m31 = 0.0
-0001d890: 0a20 2020 2020 2020 2072 6573 2e6d 3332  .        res.m32
-0001d8a0: 203d 2030 2e30 0a20 2020 2020 2020 2072   = 0.0.        r
-0001d8b0: 6573 2e6d 3333 203d 202d 322e 302f 665f  es.m33 = -2.0/f_
-0001d8c0: 6e0a 2020 2020 2020 2020 7265 732e 6d33  n.        res.m3
-0001d8d0: 3420 3d20 2d28 662b 6e29 2f66 5f6e 0a20  4 = -(f+n)/f_n. 
-0001d8e0: 2020 2020 2020 2072 6573 2e6d 3431 203d         res.m41 =
-0001d8f0: 2030 2e30 0a20 2020 2020 2020 2072 6573   0.0.        res
-0001d900: 2e6d 3432 203d 2030 2e30 0a20 2020 2020  .m42 = 0.0.     
-0001d910: 2020 2072 6573 2e6d 3433 203d 2030 2e30     res.m43 = 0.0
-0001d920: 0a20 2020 2020 2020 2072 6573 2e6d 3434  .        res.m44
-0001d930: 203d 2031 2e30 0a20 2020 2020 2020 2072   = 1.0.        r
-0001d940: 6574 7572 6e20 7265 730a 0a20 2020 2064  eturn res..    d
-0001d950: 6566 2066 7275 7374 756d 2873 656c 662c  ef frustum(self,
-0001d960: 206c 6566 742c 2072 6967 6874 2c20 626f   left, right, bo
-0001d970: 7474 6f6d 2c20 746f 702c 206e 6561 722c  ttom, top, near,
-0001d980: 2066 6172 293a 0a20 2020 2020 2020 2022   far):.        "
-0001d990: 2222 6571 7569 7661 6c65 6e74 2074 6f20  ""equivalent to 
-0001d9a0: 7468 6520 4f70 656e 474c 2063 6f6d 6d61  the OpenGL comma
-0001d9b0: 6e64 2067 6c46 7275 7374 756d 2829 2222  nd glFrustum()""
-0001d9c0: 220a 2020 2020 2020 2020 6364 6566 206d  ".        cdef m
-0001d9d0: 6174 3420 7265 730a 2020 2020 2020 2020  at4 res.        
-0001d9e0: 6364 6566 2064 6f75 626c 6520 6c2c 722c  cdef double l,r,
-0001d9f0: 622c 742c 6e2c 662c 2072 5f6c 2c20 745f  b,t,n,f, r_l, t_
-0001da00: 622c 2066 5f6e 0a0a 2020 2020 2020 2020  b, f_n..        
-0001da10: 6c20 3d20 6c65 6674 0a20 2020 2020 2020  l = left.       
-0001da20: 2072 203d 2072 6967 6874 0a20 2020 2020   r = right.     
-0001da30: 2020 2062 203d 2062 6f74 746f 6d0a 2020     b = bottom.  
-0001da40: 2020 2020 2020 7420 3d20 746f 700a 2020        t = top.  
-0001da50: 2020 2020 2020 6e20 3d20 6e65 6172 0a20        n = near. 
-0001da60: 2020 2020 2020 2066 203d 2066 6172 0a0a         f = far..
-0001da70: 2020 2020 2020 2020 725f 6c20 3d20 722d          r_l = r-
-0001da80: 6c0a 2020 2020 2020 2020 745f 6220 3d20  l.        t_b = 
-0001da90: 742d 620a 2020 2020 2020 2020 665f 6e20  t-b.        f_n 
-0001daa0: 3d20 662d 6e0a 0a20 2020 2020 2020 2069  = f-n..        i
-0001dab0: 6620 725f 6c3c 3d65 7073 3a0a 2020 2020  f r_l<=eps:.    
-0001dac0: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-0001dad0: 6c75 6545 7272 6f72 2c20 2272 6967 6874  lueError, "right
-0001dae0: 2d76 616c 7565 206d 7573 7420 6265 2067  -value must be g
-0001daf0: 7265 6174 6572 2074 6861 6e20 6c65 6674  reater than left
-0001db00: 2d76 616c 7565 220a 2020 2020 2020 2020  -value".        
-0001db10: 6966 2074 5f62 3c3d 6570 733a 0a20 2020  if t_b<=eps:.   
-0001db20: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-0001db30: 616c 7565 4572 726f 722c 2022 746f 702d  alueError, "top-
-0001db40: 7661 6c75 6520 6d75 7374 2062 6520 6772  value must be gr
-0001db50: 6561 7465 7220 7468 616e 2062 6f74 746f  eater than botto
-0001db60: 6d2d 7661 6c75 6522 0a20 2020 2020 2020  m-value".       
-0001db70: 2069 6620 665f 6e3c 3d65 7073 3a0a 2020   if f_n<=eps:.  
-0001db80: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-0001db90: 5661 6c75 6545 7272 6f72 2c20 2266 6172  ValueError, "far
-0001dba0: 2d76 616c 7565 206d 7573 7420 6265 2067  -value must be g
-0001dbb0: 7265 6174 6572 2074 6861 6e20 6e65 6172  reater than near
-0001dbc0: 2d76 616c 7565 220a 0a20 2020 2020 2020  -value"..       
-0001dbd0: 2072 6573 203d 206d 6174 3428 290a 0a20   res = mat4().. 
-0001dbe0: 2020 2020 2020 2072 6573 2e6d 3131 203d         res.m11 =
-0001dbf0: 2028 322e 302a 6e29 2f72 5f6c 0a20 2020   (2.0*n)/r_l.   
-0001dc00: 2020 2020 2072 6573 2e6d 3132 203d 2030       res.m12 = 0
-0001dc10: 2e30 0a20 2020 2020 2020 2072 6573 2e6d  .0.        res.m
-0001dc20: 3133 203d 2028 722b 6c29 2f72 5f6c 0a20  13 = (r+l)/r_l. 
-0001dc30: 2020 2020 2020 2072 6573 2e6d 3134 203d         res.m14 =
-0001dc40: 2030 2e30 0a20 2020 2020 2020 2072 6573   0.0.        res
-0001dc50: 2e6d 3231 203d 2030 2e30 0a20 2020 2020  .m21 = 0.0.     
-0001dc60: 2020 2072 6573 2e6d 3232 203d 2028 322e     res.m22 = (2.
-0001dc70: 302a 6e29 2f74 5f62 0a20 2020 2020 2020  0*n)/t_b.       
-0001dc80: 2072 6573 2e6d 3233 203d 2028 742b 6229   res.m23 = (t+b)
-0001dc90: 2f74 5f62 0a20 2020 2020 2020 2072 6573  /t_b.        res
-0001dca0: 2e6d 3234 203d 2030 2e30 0a20 2020 2020  .m24 = 0.0.     
-0001dcb0: 2020 2072 6573 2e6d 3331 203d 2030 2e30     res.m31 = 0.0
-0001dcc0: 0a20 2020 2020 2020 2072 6573 2e6d 3332  .        res.m32
-0001dcd0: 203d 2030 2e30 0a20 2020 2020 2020 2072   = 0.0.        r
-0001dce0: 6573 2e6d 3333 203d 202d 2866 2b6e 292f  es.m33 = -(f+n)/
-0001dcf0: 665f 6e0a 2020 2020 2020 2020 7265 732e  f_n.        res.
-0001dd00: 6d33 3420 3d20 282d 322e 302a 662a 6e29  m34 = (-2.0*f*n)
-0001dd10: 2f66 5f6e 0a20 2020 2020 2020 2072 6573  /f_n.        res
-0001dd20: 2e6d 3431 203d 2030 2e30 0a20 2020 2020  .m41 = 0.0.     
-0001dd30: 2020 2072 6573 2e6d 3432 203d 2030 2e30     res.m42 = 0.0
-0001dd40: 0a20 2020 2020 2020 2072 6573 2e6d 3433  .        res.m43
-0001dd50: 203d 202d 312e 300a 2020 2020 2020 2020   = -1.0.        
-0001dd60: 7265 732e 6d34 3420 3d20 302e 300a 2020  res.m44 = 0.0.  
-0001dd70: 2020 2020 2020 7265 7475 726e 2072 6573        return res
-0001dd80: 0a0a 2020 2020 6465 6620 7065 7273 7065  ..    def perspe
-0001dd90: 6374 6976 6528 7365 6c66 2c20 666f 7679  ctive(self, fovy
-0001dda0: 2c20 6173 7065 6374 2c20 6e65 6172 2c20  , aspect, near, 
-0001ddb0: 6661 7229 3a0a 2020 2020 2020 2020 2222  far):.        ""
-0001ddc0: 2276 6f6e 204d 6573 6120 c3bc 6265 726e  "von Mesa ..bern
-0001ddd0: 6f6d 6d65 6e20 2867 6c75 2e63 2922 2222  ommen (glu.c)"""
-0001dde0: 0a20 2020 2020 2020 2063 6465 6620 646f  .        cdef do
-0001ddf0: 7562 6c65 2066 2c20 610a 2020 2020 2020  uble f, a.      
-0001de00: 2020 6364 6566 2064 6f75 626c 6520 746f    cdef double to
-0001de10: 702c 2062 6f74 746f 6d2c 206c 6566 742c  p, bottom, left,
-0001de20: 2072 6967 6874 0a0a 2020 2020 2020 2020   right..        
-0001de30: 6620 3d20 666f 7679 0a20 2020 2020 2020  f = fovy.       
-0001de40: 2061 203d 2061 7370 6563 740a 0a20 2020   a = aspect..   
-0001de50: 2020 2020 2074 6f70 2020 2020 3d20 6e65       top    = ne
-0001de60: 6172 202a 2074 616e 2866 202a 2033 2e31  ar * tan(f * 3.1
-0001de70: 3431 3539 3236 3533 3538 3937 3933 3120  415926535897931 
-0001de80: 2f20 3336 302e 3029 0a20 2020 2020 2020  / 360.0).       
-0001de90: 2062 6f74 746f 6d20 3d20 2d74 6f70 0a20   bottom = -top. 
-0001dea0: 2020 2020 2020 206c 6566 7420 2020 3d20         left   = 
-0001deb0: 626f 7474 6f6d 202a 2061 0a20 2020 2020  bottom * a.     
-0001dec0: 2020 2072 6967 6874 2020 3d20 746f 7020     right  = top 
-0001ded0: 2a20 610a 0a20 2020 2020 2020 2072 6574  * a..        ret
-0001dee0: 7572 6e20 7365 6c66 2e66 7275 7374 756d  urn self.frustum
-0001def0: 286c 6566 742c 2072 6967 6874 2c20 626f  (left, right, bo
-0001df00: 7474 6f6d 2c20 746f 702c 206e 6561 722c  ttom, top, near,
-0001df10: 2066 6172 290a 0a20 2020 2064 6566 206c   far)..    def l
-0001df20: 6f6f 6b41 7428 7365 6c66 2c20 706f 732c  ookAt(self, pos,
-0001df30: 2074 6172 6765 742c 2075 703d 2830 2c30   target, up=(0,0
-0001df40: 2c31 2929 3a0a 2020 2020 2020 2020 2222  ,1)):.        ""
-0001df50: 224c 6f6f 6b20 6672 6f6d 2070 6f73 2074  "Look from pos t
-0001df60: 6f20 7461 7267 6574 2e0a 0a20 2020 2020  o target...     
-0001df70: 2020 2054 6865 2072 6573 756c 7469 6e67     The resulting
-0001df80: 2074 7261 6e73 666f 726d 6174 696f 6e20   transformation 
-0001df90: 6d6f 7665 7320 7468 6520 6f72 6967 696e  moves the origin
-0001dfa0: 2074 6f20 706f 7320 616e 640a 2020 2020   to pos and.    
-0001dfb0: 2020 2020 726f 7461 7465 7320 736f 2074      rotates so t
-0001dfc0: 6861 7420 5468 6520 7a2d 6178 6973 2070  hat The z-axis p
-0001dfd0: 6f69 6e74 7320 746f 2074 6172 6765 742e  oints to target.
-0001dfe0: 2054 6865 2079 2d61 7869 7320 6973 0a20   The y-axis is. 
-0001dff0: 2020 2020 2020 2061 7320 636c 6f73 6520         as close 
-0001e000: 6173 2070 6f73 7369 626c 6520 746f 2074  as possible to t
-0001e010: 6865 2075 7020 7665 6374 6f72 2e0a 2020  he up vector..  
-0001e020: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0001e030: 2020 6364 6566 206d 6174 3420 7265 730a    cdef mat4 res.
-0001e040: 2020 2020 2020 2020 6364 6566 2076 6563          cdef vec
-0001e050: 3320 7269 6768 742c 7675 702c 6469 720a  3 right,vup,dir.
-0001e060: 0a20 2020 2020 2020 2070 6f73 2020 2020  .        pos    
-0001e070: 3d20 7665 6333 2870 6f73 290a 2020 2020  = vec3(pos).    
-0001e080: 2020 2020 7461 7267 6574 203d 2076 6563      target = vec
-0001e090: 3328 7461 7267 6574 290a 2020 2020 2020  3(target).      
-0001e0a0: 2020 7675 7020 2020 203d 2076 6563 3328    vup    = vec3(
-0001e0b0: 7570 290a 0a20 2020 2020 2020 2064 6972  up)..        dir
-0001e0c0: 203d 2028 7461 7267 6574 202d 2070 6f73   = (target - pos
-0001e0d0: 292e 6e6f 726d 616c 697a 6528 290a 2020  ).normalize().  
-0001e0e0: 2020 2020 2020 7675 7020 3d20 7675 702e        vup = vup.
-0001e0f0: 6e6f 726d 616c 697a 6528 290a 2020 2020  normalize().    
-0001e100: 2020 2020 7675 7020 3d20 7675 7020 2d20      vup = vup - 
-0001e110: 2876 7570 202a 2064 6972 2920 2a20 6469  (vup * dir) * di
-0001e120: 720a 2020 2020 2020 2020 7472 793a 0a20  r.        try:. 
-0001e130: 2020 2020 2020 2020 2020 2076 7570 2020             vup  
-0001e140: 3d20 7675 702e 6e6f 726d 616c 697a 6528  = vup.normalize(
-0001e150: 290a 2020 2020 2020 2020 6578 6365 7074  ).        except
-0001e160: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
-0001e170: 5765 2772 6520 6c6f 6f6b 696e 6720 616c  We're looking al
-0001e180: 6f6e 6720 7468 6520 7570 2064 6972 6563  ong the up direc
-0001e190: 7469 6f6e 2c20 736f 2063 686f 6f73 650a  tion, so choose.
-0001e1a0: 2020 2020 2020 2020 2020 2020 2320 616e              # an
-0001e1b0: 2061 7262 6974 7261 7279 2064 6972 6563   arbitrary direc
-0001e1c0: 7469 6f6e 2074 6861 7420 6973 2070 6572  tion that is per
-0001e1d0: 7065 6e64 6963 756c 6172 2074 6f20 6469  pendicular to di
-0001e1e0: 720a 2020 2020 2020 2020 2020 2020 2320  r.            # 
-0001e1f0: 6173 206e 6577 2075 702e 0a20 2020 2020  as new up..     
-0001e200: 2020 2020 2020 2076 7570 203d 2064 6972         vup = dir
-0001e210: 2e6f 7274 686f 2829 0a0a 2020 2020 2020  .ortho()..      
-0001e220: 2020 7269 6768 7420 3d20 7675 702e 6372    right = vup.cr
-0001e230: 6f73 7328 6469 7229 2e6e 6f72 6d61 6c69  oss(dir).normali
-0001e240: 7a65 2829 0a0a 2020 2020 2020 2020 7265  ze()..        re
-0001e250: 7320 3d20 6d61 7434 2829 0a20 2020 2020  s = mat4().     
-0001e260: 2020 2072 6573 2e6d 3131 203d 2072 6967     res.m11 = rig
-0001e270: 6874 2e78 0a20 2020 2020 2020 2072 6573  ht.x.        res
-0001e280: 2e6d 3231 203d 2072 6967 6874 2e79 0a20  .m21 = right.y. 
-0001e290: 2020 2020 2020 2072 6573 2e6d 3331 203d         res.m31 =
-0001e2a0: 2072 6967 6874 2e7a 0a20 2020 2020 2020   right.z.       
-0001e2b0: 2072 6573 2e6d 3431 203d 2030 2e30 0a20   res.m41 = 0.0. 
-0001e2c0: 2020 2020 2020 2072 6573 2e6d 3132 203d         res.m12 =
-0001e2d0: 2076 7570 2e78 0a20 2020 2020 2020 2072   vup.x.        r
-0001e2e0: 6573 2e6d 3232 203d 2076 7570 2e79 0a20  es.m22 = vup.y. 
-0001e2f0: 2020 2020 2020 2072 6573 2e6d 3332 203d         res.m32 =
-0001e300: 2076 7570 2e7a 0a20 2020 2020 2020 2072   vup.z.        r
-0001e310: 6573 2e6d 3432 203d 2030 2e30 0a20 2020  es.m42 = 0.0.   
-0001e320: 2020 2020 2072 6573 2e6d 3133 203d 2064       res.m13 = d
-0001e330: 6972 2e78 0a20 2020 2020 2020 2072 6573  ir.x.        res
-0001e340: 2e6d 3233 203d 2064 6972 2e79 0a20 2020  .m23 = dir.y.   
-0001e350: 2020 2020 2072 6573 2e6d 3333 203d 2064       res.m33 = d
-0001e360: 6972 2e7a 0a20 2020 2020 2020 2072 6573  ir.z.        res
-0001e370: 2e6d 3433 203d 2030 2e30 0a20 2020 2020  .m43 = 0.0.     
-0001e380: 2020 2072 6573 2e6d 3134 203d 2070 6f73     res.m14 = pos
-0001e390: 2e78 0a20 2020 2020 2020 2072 6573 2e6d  .x.        res.m
-0001e3a0: 3234 203d 2070 6f73 2e79 0a20 2020 2020  24 = pos.y.     
-0001e3b0: 2020 2072 6573 2e6d 3334 203d 2070 6f73     res.m34 = pos
-0001e3c0: 2e7a 0a20 2020 2020 2020 2072 6573 2e6d  .z.        res.m
-0001e3d0: 3434 203d 2031 2e30 0a20 2020 2020 2020  44 = 1.0.       
-0001e3e0: 2072 6574 7572 6e20 7265 730a 0a20 2020   return res..   
-0001e3f0: 2064 6566 206f 7274 686f 2873 656c 6629   def ortho(self)
-0001e400: 3a0a 2020 2020 2020 2020 2222 2252 6574  :.        """Ret
-0001e410: 7572 6e20 6120 6d61 7472 6978 2077 6974  urn a matrix wit
-0001e420: 6820 6f72 7468 6f67 6f6e 616c 2062 6173  h orthogonal bas
-0001e430: 6520 7665 6374 6f72 732e 0a0a 2020 2020  e vectors...    
-0001e440: 2020 2020 4d61 6b65 7320 7468 6520 782d      Makes the x-
-0001e450: 2c20 792d 2061 6e64 207a 2d61 7869 7320  , y- and z-axis 
-0001e460: 6f72 7468 6f67 6f6e 616c 2e0a 2020 2020  orthogonal..    
-0001e470: 2020 2020 5468 6520 666f 7572 7468 2063      The fourth c
-0001e480: 6f6c 756d 6e20 616e 6420 726f 7720 7265  olumn and row re
-0001e490: 6d61 696e 2075 6e74 6f75 6368 6564 2e0a  main untouched..
-0001e4a0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0001e4b0: 2020 2020 6364 6566 206d 6174 3420 7265      cdef mat4 re
-0001e4c0: 730a 2020 2020 2020 2020 6364 6566 2076  s.        cdef v
-0001e4d0: 6563 3320 782c 792c 7a0a 0a20 2020 2020  ec3 x,y,z..     
-0001e4e0: 2020 2078 203d 2076 6563 3328 7365 6c66     x = vec3(self
-0001e4f0: 2e6d 3131 2c20 7365 6c66 2e6d 3231 2c20  .m11, self.m21, 
-0001e500: 7365 6c66 2e6d 3331 290a 2020 2020 2020  self.m31).      
-0001e510: 2020 7920 3d20 7665 6333 2873 656c 662e    y = vec3(self.
-0001e520: 6d31 322c 2073 656c 662e 6d32 322c 2073  m12, self.m22, s
-0001e530: 656c 662e 6d33 3229 0a20 2020 2020 2020  elf.m32).       
-0001e540: 207a 203d 2076 6563 3328 7365 6c66 2e6d   z = vec3(self.m
-0001e550: 3133 2c20 7365 6c66 2e6d 3233 2c20 7365  13, self.m23, se
-0001e560: 6c66 2e6d 3333 290a 0a20 2020 2020 2020  lf.m33)..       
-0001e570: 2078 6c20 3d20 782e 6c65 6e67 7468 2829   xl = x.length()
-0001e580: 0a20 2020 2020 2020 2078 6c20 3d20 786c  .        xl = xl
-0001e590: 2a78 6c0a 2020 2020 2020 2020 7920 3d20  *xl.        y = 
-0001e5a0: 7920 2d20 2828 782a 7929 2f78 6c29 2a78  y - ((x*y)/xl)*x
-0001e5b0: 0a20 2020 2020 2020 207a 203d 207a 202d  .        z = z -
-0001e5c0: 2028 2878 2a7a 292f 786c 292a 780a 0a20   ((x*z)/xl)*x.. 
-0001e5d0: 2020 2020 2020 2079 6c20 3d20 792e 6c65         yl = y.le
-0001e5e0: 6e67 7468 2829 0a20 2020 2020 2020 2079  ngth().        y
-0001e5f0: 6c20 3d20 796c 2a79 6c0a 2020 2020 2020  l = yl*yl.      
-0001e600: 2020 7a20 3d20 7a20 2d20 2828 792a 7a29    z = z - ((y*z)
-0001e610: 2f79 6c29 2a79 0a0a 2020 2020 2020 2020  /yl)*y..        
-0001e620: 7265 7320 3d20 6d61 7434 2829 0a20 2020  res = mat4().   
-0001e630: 2020 2020 2072 6573 2e6d 3131 203d 2078       res.m11 = x
-0001e640: 2e78 0a20 2020 2020 2020 2072 6573 2e6d  .x.        res.m
-0001e650: 3132 203d 2079 2e78 0a20 2020 2020 2020  12 = y.x.       
-0001e660: 2072 6573 2e6d 3133 203d 207a 2e78 0a20   res.m13 = z.x. 
-0001e670: 2020 2020 2020 2072 6573 2e6d 3134 203d         res.m14 =
-0001e680: 2073 656c 662e 6d31 340a 2020 2020 2020   self.m14.      
-0001e690: 2020 7265 732e 6d32 3120 3d20 782e 790a    res.m21 = x.y.
-0001e6a0: 2020 2020 2020 2020 7265 732e 6d32 3220          res.m22 
-0001e6b0: 3d20 792e 790a 2020 2020 2020 2020 7265  = y.y.        re
-0001e6c0: 732e 6d32 3320 3d20 7a2e 790a 2020 2020  s.m23 = z.y.    
-0001e6d0: 2020 2020 7265 732e 6d32 3420 3d20 7365      res.m24 = se
-0001e6e0: 6c66 2e6d 3234 0a20 2020 2020 2020 2072  lf.m24.        r
-0001e6f0: 6573 2e6d 3331 203d 2078 2e7a 0a20 2020  es.m31 = x.z.   
-0001e700: 2020 2020 2072 6573 2e6d 3332 203d 2079       res.m32 = y
-0001e710: 2e7a 0a20 2020 2020 2020 2072 6573 2e6d  .z.        res.m
-0001e720: 3333 203d 207a 2e7a 0a20 2020 2020 2020  33 = z.z.       
-0001e730: 2072 6573 2e6d 3334 203d 2073 656c 662e   res.m34 = self.
-0001e740: 6d33 340a 2020 2020 2020 2020 7265 732e  m34.        res.
-0001e750: 6d34 3120 3d20 7365 6c66 2e6d 3431 0a20  m41 = self.m41. 
-0001e760: 2020 2020 2020 2072 6573 2e6d 3432 203d         res.m42 =
-0001e770: 2073 656c 662e 6d34 320a 2020 2020 2020   self.m42.      
-0001e780: 2020 7265 732e 6d34 3320 3d20 7365 6c66    res.m43 = self
-0001e790: 2e6d 3433 0a20 2020 2020 2020 2072 6573  .m43.        res
-0001e7a0: 2e6d 3434 203d 2073 656c 662e 6d34 340a  .m44 = self.m44.
-0001e7b0: 2020 2020 2020 2020 7265 7475 726e 2072          return r
-0001e7c0: 6573 0a0a 2020 2020 6465 6620 6465 636f  es..    def deco
-0001e7d0: 6d70 6f73 6528 7365 6c66 293a 0a20 2020  mpose(self):.   
-0001e7e0: 2020 2020 2022 2222 4465 636f 6d70 6f73       """Decompos
-0001e7f0: 6573 2074 6865 206d 6174 7269 7820 696e  es the matrix in
-0001e800: 746f 2061 2074 7261 6e73 6c61 7469 6f6e  to a translation
-0001e810: 2c20 726f 7461 7469 6f6e 2061 6e64 2073  , rotation and s
-0001e820: 6361 6c69 6e67 2070 6172 742e 0a0a 2020  caling part...  
-0001e830: 2020 2020 2020 5265 7475 726e 7320 6120        Returns a 
-0001e840: 7475 706c 6520 2874 7261 6e73 6c61 7469  tuple (translati
-0001e850: 6f6e 2c20 726f 7461 7469 6f6e 2c20 7363  on, rotation, sc
-0001e860: 616c 696e 6729 2e20 5468 650a 2020 2020  aling). The.    
-0001e870: 2020 2020 7472 616e 736c 6174 696f 6e20      translation 
-0001e880: 616e 6420 7363 616c 696e 6720 7061 7274  and scaling part
-0001e890: 7320 6172 6520 6769 7665 6e20 6173 2076  s are given as v
-0001e8a0: 6563 3327 732c 2074 6865 2072 6f74 6174  ec3's, the rotat
-0001e8b0: 696f 6e0a 2020 2020 2020 2020 6973 2073  ion.        is s
-0001e8c0: 7469 6c6c 2067 6976 656e 2061 7320 6120  till given as a 
-0001e8d0: 6d61 7434 2e0a 2020 2020 2020 2020 2222  mat4..        ""
-0001e8e0: 220a 2020 2020 2020 2020 6364 6566 206d  ".        cdef m
-0001e8f0: 6174 3420 6d0a 2020 2020 2020 2020 6364  at4 m.        cd
-0001e900: 6566 2076 6563 3320 612c 622c 630a 2020  ef vec3 a,b,c.  
-0001e910: 2020 2020 2020 6364 6566 2064 6f75 626c        cdef doubl
-0001e920: 6520 616c 2c20 626c 2c20 636c 0a0a 2020  e al, bl, cl..  
-0001e930: 2020 2020 2020 6d20 3d20 7365 6c66 2e6f        m = self.o
-0001e940: 7274 686f 2829 0a20 2020 2020 2020 206d  rtho().        m
-0001e950: 2e6d 3134 203d 2030 2e30 0a20 2020 2020  .m14 = 0.0.     
-0001e960: 2020 206d 2e6d 3234 203d 2030 2e30 0a20     m.m24 = 0.0. 
-0001e970: 2020 2020 2020 206d 2e6d 3334 203d 2030         m.m34 = 0
-0001e980: 2e30 0a20 2020 2020 2020 206d 2e6d 3434  .0.        m.m44
-0001e990: 203d 2031 2e30 0a20 2020 2020 2020 206d   = 1.0.        m
-0001e9a0: 2e6d 3431 203d 2030 2e30 0a20 2020 2020  .m41 = 0.0.     
-0001e9b0: 2020 206d 2e6d 3432 203d 2030 2e30 0a20     m.m42 = 0.0. 
-0001e9c0: 2020 2020 2020 206d 2e6d 3433 203d 2030         m.m43 = 0
-0001e9d0: 2e30 0a0a 2020 2020 2020 2020 2320 612c  .0..        # a,
-0001e9e0: 622c 6320 3d20 436f 6c75 6d6e 2030 2c31  b,c = Column 0,1
-0001e9f0: 2c32 206f 6620 6d0a 2020 2020 2020 2020  ,2 of m.        
-0001ea00: 6120 3d20 7665 6333 2829 0a20 2020 2020  a = vec3().     
-0001ea10: 2020 2062 203d 2076 6563 3328 290a 2020     b = vec3().  
-0001ea20: 2020 2020 2020 6320 3d20 7665 6333 2829        c = vec3()
-0001ea30: 0a20 2020 2020 2020 2061 2e78 203d 206d  .        a.x = m
-0001ea40: 2e6d 3131 0a20 2020 2020 2020 2061 2e79  .m11.        a.y
-0001ea50: 203d 206d 2e6d 3231 0a20 2020 2020 2020   = m.m21.       
-0001ea60: 2061 2e7a 203d 206d 2e6d 3331 0a20 2020   a.z = m.m31.   
-0001ea70: 2020 2020 2062 2e78 203d 206d 2e6d 3132       b.x = m.m12
-0001ea80: 0a20 2020 2020 2020 2062 2e79 203d 206d  .        b.y = m
-0001ea90: 2e6d 3232 0a20 2020 2020 2020 2062 2e7a  .m22.        b.z
-0001eaa0: 203d 206d 2e6d 3332 0a20 2020 2020 2020   = m.m32.       
-0001eab0: 2063 2e78 203d 206d 2e6d 3133 0a20 2020   c.x = m.m13.   
-0001eac0: 2020 2020 2063 2e79 203d 206d 2e6d 3233       c.y = m.m23
-0001ead0: 0a20 2020 2020 2020 2063 2e7a 203d 206d  .        c.z = m
-0001eae0: 2e6d 3333 0a0a 2020 2020 2020 2020 2320  .m33..        # 
-0001eaf0: 616c 2c62 6c2c 636c 203d 206c 656e 6774  al,bl,cl = lengt
-0001eb00: 6820 6f66 2061 2c62 2c63 2028 3d20 7363  h of a,b,c (= sc
-0001eb10: 616c 696e 6720 6661 6374 6f72 7329 0a20  aling factors). 
-0001eb20: 2020 2020 2020 2061 6c20 3d20 7371 7274         al = sqrt
-0001eb30: 2861 2e78 2a61 2e78 202b 2061 2e79 2a61  (a.x*a.x + a.y*a
-0001eb40: 2e79 202b 2061 2e7a 2a61 2e7a 290a 2020  .y + a.z*a.z).  
-0001eb50: 2020 2020 2020 626c 203d 2073 7172 7428        bl = sqrt(
-0001eb60: 622e 782a 622e 7820 2b20 622e 792a 622e  b.x*b.x + b.y*b.
-0001eb70: 7920 2b20 622e 7a2a 622e 7a29 0a20 2020  y + b.z*b.z).   
-0001eb80: 2020 2020 2063 6c20 3d20 7371 7274 2863       cl = sqrt(c
-0001eb90: 2e78 2a63 2e78 202b 2063 2e79 2a63 2e79  .x*c.x + c.y*c.y
-0001eba0: 202b 2063 2e7a 2a63 2e7a 290a 2020 2020   + c.z*c.z).    
-0001ebb0: 2020 2020 6966 2061 6c3c 3d65 7073 206f      if al<=eps o
-0001ebc0: 7220 626c 3c3d 6570 7320 6f72 2063 6c3c  r bl<=eps or cl<
-0001ebd0: 3d65 7073 3a0a 2020 2020 2020 2020 2020  =eps:.          
-0001ebe0: 2020 7261 6973 6520 5a65 726f 4469 7669    raise ZeroDivi
-0001ebf0: 7369 6f6e 4572 726f 722c 2274 7261 6e73  sionError,"trans
-0001ec00: 666f 726d 6174 696f 6e20 636f 6e74 6169  formation contai
-0001ec10: 6e73 2061 2030 2073 6361 6c69 6e67 220a  ns a 0 scaling".
-0001ec20: 0a20 2020 2020 2020 2073 6361 6c65 203d  .        scale =
-0001ec30: 2076 6563 3328 616c 2c62 6c2c 636c 290a   vec3(al,bl,cl).
-0001ec40: 0a20 2020 2020 2020 2023 206e 6f72 6d61  .        # norma
-0001ec50: 6c69 7a69 6e67 2061 2c62 2c63 0a23 2020  lizing a,b,c.#  
-0001ec60: 2020 2020 2020 612f 3d61 6c0a 2320 2020        a/=al.#   
-0001ec70: 2020 2020 2062 2f3d 626c 0a23 2020 2020       b/=bl.#    
-0001ec80: 2020 2020 632f 3d63 6c0a 2020 2020 2020      c/=cl.      
-0001ec90: 2020 612e 7820 3d20 612e 782f 616c 0a20    a.x = a.x/al. 
-0001eca0: 2020 2020 2020 2061 2e79 203d 2061 2e79         a.y = a.y
-0001ecb0: 2f61 6c0a 2020 2020 2020 2020 612e 7a20  /al.        a.z 
-0001ecc0: 3d20 612e 7a2f 616c 0a20 2020 2020 2020  = a.z/al.       
-0001ecd0: 2062 2e78 203d 2062 2e78 2f62 6c0a 2020   b.x = b.x/bl.  
-0001ece0: 2020 2020 2020 622e 7920 3d20 622e 792f        b.y = b.y/
-0001ecf0: 626c 0a20 2020 2020 2020 2062 2e7a 203d  bl.        b.z =
-0001ed00: 2062 2e7a 2f62 6c0a 2020 2020 2020 2020   b.z/bl.        
-0001ed10: 632e 7820 3d20 632e 782f 636c 0a20 2020  c.x = c.x/cl.   
-0001ed20: 2020 2020 2063 2e79 203d 2063 2e79 2f63       c.y = c.y/c
-0001ed30: 6c0a 2020 2020 2020 2020 632e 7a20 3d20  l.        c.z = 
-0001ed40: 632e 7a2f 636c 0a0a 2020 2020 2020 2020  c.z/cl..        
-0001ed50: 6d2e 6d31 3120 3d20 612e 780a 2020 2020  m.m11 = a.x.    
-0001ed60: 2020 2020 6d2e 6d32 3120 3d20 612e 790a      m.m21 = a.y.
-0001ed70: 2020 2020 2020 2020 6d2e 6d33 3120 3d20          m.m31 = 
-0001ed80: 612e 7a0a 2020 2020 2020 2020 6d2e 6d31  a.z.        m.m1
-0001ed90: 3220 3d20 622e 780a 2020 2020 2020 2020  2 = b.x.        
-0001eda0: 6d2e 6d32 3220 3d20 622e 790a 2020 2020  m.m22 = b.y.    
-0001edb0: 2020 2020 6d2e 6d33 3220 3d20 622e 7a0a      m.m32 = b.z.
-0001edc0: 2020 2020 2020 2020 6d2e 6d31 3320 3d20          m.m13 = 
-0001edd0: 632e 780a 2020 2020 2020 2020 6d2e 6d32  c.x.        m.m2
-0001ede0: 3320 3d20 632e 790a 2020 2020 2020 2020  3 = c.y.        
-0001edf0: 6d2e 6d33 3320 3d20 632e 7a0a 2020 2020  m.m33 = c.z.    
-0001ee00: 2020 2020 6966 206d 2e64 6574 6572 6d69      if m.determi
-0001ee10: 6e61 6e74 2829 3c30 2e30 3a0a 2020 2020  nant()<0.0:.    
-0001ee20: 2020 2020 2020 2020 6d2e 6d31 3120 3d20          m.m11 = 
-0001ee30: 2d6d 2e6d 3131 0a20 2020 2020 2020 2020  -m.m11.         
-0001ee40: 2020 206d 2e6d 3231 203d 202d 6d2e 6d32     m.m21 = -m.m2
-0001ee50: 310a 2020 2020 2020 2020 2020 2020 6d2e  1.            m.
-0001ee60: 6d33 3120 3d20 2d6d 2e6d 3331 0a20 2020  m31 = -m.m31.   
-0001ee70: 2020 2020 2020 2020 2073 6361 6c65 2e78           scale.x
-0001ee80: 203d 202d 7363 616c 652e 780a 0a20 2020   = -scale.x..   
-0001ee90: 2020 2020 2072 6574 7572 6e20 2876 6563       return (vec
-0001eea0: 3328 7365 6c66 2e6d 3134 2c20 7365 6c66  3(self.m14, self
-0001eeb0: 2e6d 3234 2c20 7365 6c66 2e6d 3334 292c  .m24, self.m34),
-0001eec0: 206d 2c20 7363 616c 6529 0a0a 2020 2020   m, scale)..    
-0001eed0: 6465 6620 6765 744d 6174 3328 7365 6c66  def getMat3(self
-0001eee0: 293a 0a20 2020 2020 2020 2022 2222 436f  ):.        """Co
-0001eef0: 6e76 6572 7420 746f 206d 6174 3320 6279  nvert to mat3 by
-0001ef00: 2064 6973 6361 7264 696e 6720 3474 6820   discarding 4th 
-0001ef10: 726f 7720 616e 6420 636f 6c75 6d6e 2e0a  row and column..
-0001ef20: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0001ef30: 2020 2020 6364 6566 206d 6174 3320 7265      cdef mat3 re
-0001ef40: 730a 2020 2020 2020 2020 7265 7320 3d20  s.        res = 
-0001ef50: 6d61 7433 2829 0a20 2020 2020 2020 2072  mat3().        r
-0001ef60: 6573 2e6d 3131 203d 2073 656c 662e 6d31  es.m11 = self.m1
-0001ef70: 310a 2020 2020 2020 2020 7265 732e 6d31  1.        res.m1
-0001ef80: 3220 3d20 7365 6c66 2e6d 3132 0a20 2020  2 = self.m12.   
-0001ef90: 2020 2020 2072 6573 2e6d 3133 203d 2073       res.m13 = s
-0001efa0: 656c 662e 6d31 330a 2020 2020 2020 2020  elf.m13.        
-0001efb0: 7265 732e 6d32 3120 3d20 7365 6c66 2e6d  res.m21 = self.m
-0001efc0: 3231 0a20 2020 2020 2020 2072 6573 2e6d  21.        res.m
-0001efd0: 3232 203d 2073 656c 662e 6d32 320a 2020  22 = self.m22.  
-0001efe0: 2020 2020 2020 7265 732e 6d32 3320 3d20        res.m23 = 
-0001eff0: 7365 6c66 2e6d 3233 0a20 2020 2020 2020  self.m23.       
-0001f000: 2072 6573 2e6d 3331 203d 2073 656c 662e   res.m31 = self.
-0001f010: 6d33 310a 2020 2020 2020 2020 7265 732e  m31.        res.
-0001f020: 6d33 3220 3d20 7365 6c66 2e6d 3332 0a20  m32 = self.m32. 
-0001f030: 2020 2020 2020 2072 6573 2e6d 3333 203d         res.m33 =
-0001f040: 2073 656c 662e 6d33 330a 2020 2020 2020   self.m33.      
-0001f050: 2020 7265 7475 726e 2072 6573 0a0a 2020    return res..  
-0001f060: 2020 6465 6620 7365 744d 6174 3328 7365    def setMat3(se
-0001f070: 6c66 2c20 6d61 7433 206d 293a 0a20 2020  lf, mat3 m):.   
-0001f080: 2020 2020 2022 2222 5365 7420 7468 6520       """Set the 
-0001f090: 6d61 7433 2070 6172 7420 6f66 2073 656c  mat3 part of sel
-0001f0a0: 662e 0a20 2020 2020 2020 2022 2222 0a20  f..        """. 
-0001f0b0: 2020 2020 2020 2073 656c 662e 6d31 3120         self.m11 
-0001f0c0: 3d20 6d2e 6d31 310a 2020 2020 2020 2020  = m.m11.        
-0001f0d0: 7365 6c66 2e6d 3132 203d 206d 2e6d 3132  self.m12 = m.m12
-0001f0e0: 0a20 2020 2020 2020 2073 656c 662e 6d31  .        self.m1
-0001f0f0: 3320 3d20 6d2e 6d31 330a 2020 2020 2020  3 = m.m13.      
-0001f100: 2020 7365 6c66 2e6d 3231 203d 206d 2e6d    self.m21 = m.m
-0001f110: 3231 0a20 2020 2020 2020 2073 656c 662e  21.        self.
-0001f120: 6d32 3220 3d20 6d2e 6d32 320a 2020 2020  m22 = m.m22.    
-0001f130: 2020 2020 7365 6c66 2e6d 3233 203d 206d      self.m23 = m
-0001f140: 2e6d 3233 0a20 2020 2020 2020 2073 656c  .m23.        sel
-0001f150: 662e 6d33 3120 3d20 6d2e 6d33 310a 2020  f.m31 = m.m31.  
-0001f160: 2020 2020 2020 7365 6c66 2e6d 3332 203d        self.m32 =
-0001f170: 206d 2e6d 3332 0a20 2020 2020 2020 2073   m.m32.        s
-0001f180: 656c 662e 6d33 3320 3d20 6d2e 6d33 330a  elf.m33 = m.m33.
-0001f190: 0a23 2323 2323 2323 2323 2323 2323 2323  .###############
-0001f1a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001f1b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001f1c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001f1d0: 2323 2323 2323 230a 0a23 2071 7561 740a  #######..# quat.
-0001f1e0: 6364 6566 2063 6c61 7373 2071 7561 743a  cdef class quat:
-0001f1f0: 0a20 2020 2022 2222 5175 6174 6572 6e69  .    """Quaterni
-0001f200: 6f6e 2063 6c61 7373 2e0a 0a20 2020 2051  on class...    Q
-0001f210: 7561 7465 726e 696f 6e73 2061 7265 2061  uaternions are a
-0001f220: 6e20 6578 7465 6e73 696f 6e20 746f 2063  n extension to c
-0001f230: 6f6d 706c 6578 206e 756d 6265 7273 2061  omplex numbers a
-0001f240: 6e64 2063 616e 2062 6520 7573 6564 0a20  nd can be used. 
-0001f250: 2020 2074 6f20 7374 6f72 6520 726f 7461     to store rota
-0001f260: 7469 6f6e 732e 2054 6865 7920 6172 6520  tions. They are 
-0001f270: 636f 6d70 6f73 6564 206f 6620 666f 7572  composed of four
-0001f280: 2066 6c6f 6174 7320 7768 6963 6820 6361   floats which ca
-0001f290: 6e20 6265 0a20 2020 2073 6565 6e20 6173  n be.    seen as
-0001f2a0: 2061 6e20 616e 676c 6520 616e 6420 616e   an angle and an
-0001f2b0: 2061 7869 7320 6f66 2072 6f74 6174 696f   axis of rotatio
-0001f2c0: 6e2e 0a20 2020 2022 2222 0a0a 2020 2020  n..    """..    
-0001f2d0: 6364 6566 2064 6f75 626c 6520 772c 782c  cdef double w,x,
-0001f2e0: 792c 7a0a 0a20 2020 2064 6566 205f 5f63  y,z..    def __c
-0001f2f0: 696e 6974 5f5f 2873 656c 662c 202a 6172  init__(self, *ar
-0001f300: 6773 293a 0a20 2020 2020 2020 2022 2222  gs):.        """
-0001f310: 436f 6e73 7472 7563 746f 722e 0a0a 2020  Constructor...  
-0001f320: 2020 2020 2020 3020 6172 6775 6d65 6e74        0 argument
-0001f330: 733a 207a 6572 6f65 730a 2020 2020 2020  s: zeroes.      
-0001f340: 2020 3120 666c 6f61 7420 6172 6775 6d65    1 float argume
-0001f350: 6e74 3a20 2077 2063 6f6d 706f 6e65 6e74  nt:  w component
-0001f360: 2c20 782c 792c 7a20 3d20 2830 2c30 2c30  , x,y,z = (0,0,0
-0001f370: 290a 2020 2020 2020 2020 3120 7175 6174  ).        1 quat
-0001f380: 2061 7267 756d 656e 743a 204d 616b 6520   argument: Make 
-0001f390: 6120 636f 7079 0a20 2020 2020 2020 2031  a copy.        1
-0001f3a0: 206d 6174 3320 6172 6775 6d65 6e74 3a20   mat3 argument: 
-0001f3b0: 496e 6974 6961 6c69 7a65 2062 7920 726f  Initialize by ro
-0001f3c0: 7461 7469 6f6e 206d 6174 7269 780a 2020  tation matrix.  
-0001f3d0: 2020 2020 2020 3120 6d61 7434 2061 7267        1 mat4 arg
-0001f3e0: 756d 656e 743a 2049 6e69 7469 616c 697a  ument: Initializ
-0001f3f0: 6520 6279 2072 6f74 6174 696f 6e20 6d61  e by rotation ma
-0001f400: 7472 6978 0a20 2020 2020 2020 2032 2061  trix.        2 a
-0001f410: 7267 756d 656e 7473 3a20 616e 676c 6520  rguments: angle 
-0001f420: 2620 6178 6973 2028 646f 6573 6e27 7420  & axis (doesn't 
-0001f430: 6861 7665 2074 6f20 6265 206f 6620 756e  have to be of un
-0001f440: 6974 206c 656e 6774 6829 0a20 2020 2020  it length).     
-0001f450: 2020 2034 2061 7267 756d 656e 7473 3a20     4 arguments: 
-0001f460: 636f 6d70 6f6e 656e 7473 2077 2c78 2c79  components w,x,y
-0001f470: 2c7a 0a20 2020 2020 2020 2022 2222 0a0a  ,z.        """..
-0001f480: 2020 2020 2020 2020 6364 6566 2069 6e74          cdef int
-0001f490: 2061 7267 6c65 6e2c 2073 6571 6c65 6e0a   arglen, seqlen.
-0001f4a0: 2020 2020 2020 2020 6364 6566 2071 7561          cdef qua
-0001f4b0: 7420 710a 2020 2020 2020 2020 6172 676c  t q.        argl
-0001f4c0: 656e 203d 206c 656e 2861 7267 7329 0a0a  en = len(args)..
-0001f4d0: 2020 2020 2020 2020 2320 3020 6172 6775          # 0 argu
-0001f4e0: 6d65 6e74 730a 2020 2020 2020 2020 6966  ments.        if
-0001f4f0: 2061 7267 6c65 6e3d 3d30 3a0a 2020 2020   arglen==0:.    
-0001f500: 2020 2020 2020 2020 7365 6c66 2e77 203d          self.w =
-0001f510: 2030 2e30 0a20 2020 2020 2020 2020 2020   0.0.           
-0001f520: 2073 656c 662e 7820 3d20 302e 300a 2020   self.x = 0.0.  
-0001f530: 2020 2020 2020 2020 2020 7365 6c66 2e79            self.y
-0001f540: 203d 2030 2e30 0a20 2020 2020 2020 2020   = 0.0.         
-0001f550: 2020 2073 656c 662e 7a20 3d20 302e 300a     self.z = 0.0.
-0001f560: 0a20 2020 2020 2020 2023 2031 2061 7267  .        # 1 arg
-0001f570: 756d 656e 740a 2020 2020 2020 2020 656c  ument.        el
-0001f580: 6966 2061 7267 6c65 6e3d 3d31 3a0a 2020  if arglen==1:.  
-0001f590: 2020 2020 2020 2020 2020 5420 3d20 7479            T = ty
-0001f5a0: 7065 2861 7267 735b 305d 290a 2020 2020  pe(args[0]).    
-0001f5b0: 2020 2020 2020 2020 2320 7363 616c 6172          # scalar
-0001f5c0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0001f5d0: 5420 6973 2066 6c6f 6174 206f 7220 5420  T is float or T 
-0001f5e0: 6973 2069 6e74 206f 7220 5420 6973 206c  is int or T is l
-0001f5f0: 6f6e 673a 0a20 2020 2020 2020 2020 2020  ong:.           
-0001f600: 2020 2020 2073 656c 662e 7720 3d20 6172       self.w = ar
-0001f610: 6773 5b30 5d0a 2020 2020 2020 2020 2020  gs[0].          
-0001f620: 2020 2020 2020 7365 6c66 2e78 203d 2030        self.x = 0
-0001f630: 2e30 0a20 2020 2020 2020 2020 2020 2020  .0.             
-0001f640: 2020 2073 656c 662e 7920 3d20 302e 300a     self.y = 0.0.
-0001f650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f660: 7365 6c66 2e7a 203d 2030 2e30 0a20 2020  self.z = 0.0.   
-0001f670: 2020 2020 2020 2020 2023 2071 7561 740a           # quat.
-0001f680: 2020 2020 2020 2020 2020 2020 656c 6966              elif
-0001f690: 2054 2069 7320 7175 6174 3a0a 2020 2020   T is quat:.    
-0001f6a0: 2020 2020 2020 2020 2020 2020 7120 3d20              q = 
-0001f6b0: 6172 6773 5b30 5d0a 2020 2020 2020 2020  args[0].        
-0001f6c0: 2020 2020 2020 2020 7365 6c66 2e77 203d          self.w =
-0001f6d0: 2071 2e77 0a20 2020 2020 2020 2020 2020   q.w.           
-0001f6e0: 2020 2020 2073 656c 662e 7820 3d20 712e       self.x = q.
-0001f6f0: 780a 2020 2020 2020 2020 2020 2020 2020  x.              
-0001f700: 2020 7365 6c66 2e79 203d 2071 2e79 0a20    self.y = q.y. 
-0001f710: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0001f720: 656c 662e 7a20 3d20 712e 7a0a 2020 2020  elf.z = q.z.    
-0001f730: 2020 2020 2020 2020 2320 5374 7269 6e67          # String
-0001f740: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
-0001f750: 6620 5420 6973 2073 7472 206f 7220 5420  f T is str or T 
-0001f760: 6973 2075 6e69 636f 6465 3a0a 2020 2020  is unicode:.    
-0001f770: 2020 2020 2020 2020 2020 2020 733d 6172              s=ar
-0001f780: 6773 5b30 5d2e 7265 706c 6163 6528 222c  gs[0].replace(",
-0001f790: 222c 2220 2229 2e72 6570 6c61 6365 2822  "," ").replace("
-0001f7a0: 2020 222c 2220 2229 2e73 7472 6970 2829    "," ").strip()
-0001f7b0: 2e73 706c 6974 2822 2022 290a 2020 2020  .split(" ").    
-0001f7c0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-0001f7d0: 3d3d 5b22 225d 3a0a 2020 2020 2020 2020  ==[""]:.        
-0001f7e0: 2020 2020 2020 2020 2020 2020 733d 5b5d              s=[]
-0001f7f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001f800: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
-0001f810: 6c65 6e28 7329 293a 0a20 2020 2020 2020  len(s)):.       
-0001f820: 2020 2020 2020 2020 2020 2020 2074 7279               try
-0001f830: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0001f840: 2020 2020 2020 2020 2020 735b 695d 203d            s[i] =
-0001f850: 2066 6c6f 6174 2873 5b69 5d29 0a20 2020   float(s[i]).   
-0001f860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f870: 2065 7863 6570 743a 0a20 2020 2020 2020   except:.       
+00017e40: 6c66 2e6d 3333 203d 2073 656c 662e 6d33  lf.m33 = self.m3
+00017e50: 332f 720a 2020 2020 2020 2020 2020 2020  3/r.            
+00017e60: 7365 6c66 2e6d 3334 203d 2073 656c 662e  self.m34 = self.
+00017e70: 6d33 342f 720a 2020 2020 2020 2020 2020  m34/r.          
+00017e80: 2020 7365 6c66 2e6d 3431 203d 2073 656c    self.m41 = sel
+00017e90: 662e 6d34 312f 720a 2020 2020 2020 2020  f.m41/r.        
+00017ea0: 2020 2020 7365 6c66 2e6d 3432 203d 2073      self.m42 = s
+00017eb0: 656c 662e 6d34 322f 720a 2020 2020 2020  elf.m42/r.      
+00017ec0: 2020 2020 2020 7365 6c66 2e6d 3433 203d        self.m43 =
+00017ed0: 2073 656c 662e 6d34 332f 720a 2020 2020   self.m43/r.    
+00017ee0: 2020 2020 2020 2020 7365 6c66 2e6d 3434          self.m44
+00017ef0: 203d 2073 656c 662e 6d34 342f 720a 2020   = self.m44/r.  
+00017f00: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00017f10: 2073 656c 660a 2020 2020 2020 2020 656c   self.        el
+00017f20: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00017f30: 7261 6973 6520 5479 7065 4572 726f 722c  raise TypeError,
+00017f40: 2022 756e 7375 7070 6f72 7465 6420 6f70   "unsupported op
+00017f50: 6572 616e 6420 7479 7065 2066 6f72 202f  erand type for /
+00017f60: 3d22 0a0a 2020 2020 6465 6620 5f5f 696d  ="..    def __im
+00017f70: 6f64 5f5f 2873 656c 662c 2062 293a 0a20  od__(self, b):. 
+00017f80: 2020 2020 2020 2022 2222 496e 6c69 6e65         """Inline
+00017f90: 206d 6f64 756c 6f2e 0a20 2020 2020 2020   modulo..       
+00017fa0: 2022 2222 0a20 2020 2020 2020 2063 6465   """.        cde
+00017fb0: 6620 6d61 7434 206d 620a 2020 2020 2020  f mat4 mb.      
+00017fc0: 2020 6364 6566 2064 6f75 626c 6520 720a    cdef double r.
+00017fd0: 0a20 2020 2020 2020 2074 6220 3d20 7479  .        tb = ty
+00017fe0: 7065 2862 290a 0a20 2020 2020 2020 2069  pe(b)..        i
+00017ff0: 6620 7462 2069 7320 666c 6f61 7420 6f72  f tb is float or
+00018000: 2074 6220 6973 2069 6e74 206f 7220 7462   tb is int or tb
+00018010: 2069 7320 6c6f 6e67 3a0a 2020 2020 2020   is long:.      
+00018020: 2020 2020 2020 7220 3d20 620a 2020 2020        r = b.    
+00018030: 2020 2020 2020 2020 6966 2066 6162 7328          if fabs(
+00018040: 7229 3c3d 6570 733a 0a20 2020 2020 2020  r)<=eps:.       
+00018050: 2020 2020 2020 2020 2072 6169 7365 205a           raise Z
+00018060: 6572 6f44 6976 6973 696f 6e45 7272 6f72  eroDivisionError
+00018070: 2c22 6d61 7434 206d 6f64 756c 6f22 0a20  ,"mat4 modulo". 
+00018080: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00018090: 6d31 3120 3d20 5f66 6d6f 6428 7365 6c66  m11 = _fmod(self
+000180a0: 2e6d 3131 2c20 7229 0a20 2020 2020 2020  .m11, r).       
+000180b0: 2020 2020 2073 656c 662e 6d31 3220 3d20       self.m12 = 
+000180c0: 5f66 6d6f 6428 7365 6c66 2e6d 3132 2c20  _fmod(self.m12, 
+000180d0: 7229 0a20 2020 2020 2020 2020 2020 2073  r).            s
+000180e0: 656c 662e 6d31 3320 3d20 5f66 6d6f 6428  elf.m13 = _fmod(
+000180f0: 7365 6c66 2e6d 3133 2c20 7229 0a20 2020  self.m13, r).   
+00018100: 2020 2020 2020 2020 2073 656c 662e 6d31           self.m1
+00018110: 3420 3d20 5f66 6d6f 6428 7365 6c66 2e6d  4 = _fmod(self.m
+00018120: 3134 2c20 7229 0a20 2020 2020 2020 2020  14, r).         
+00018130: 2020 2073 656c 662e 6d32 3120 3d20 5f66     self.m21 = _f
+00018140: 6d6f 6428 7365 6c66 2e6d 3231 2c20 7229  mod(self.m21, r)
+00018150: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00018160: 662e 6d32 3220 3d20 5f66 6d6f 6428 7365  f.m22 = _fmod(se
+00018170: 6c66 2e6d 3232 2c20 7229 0a20 2020 2020  lf.m22, r).     
+00018180: 2020 2020 2020 2073 656c 662e 6d32 3320         self.m23 
+00018190: 3d20 5f66 6d6f 6428 7365 6c66 2e6d 3233  = _fmod(self.m23
+000181a0: 2c20 7229 0a20 2020 2020 2020 2020 2020  , r).           
+000181b0: 2073 656c 662e 6d32 3420 3d20 5f66 6d6f   self.m24 = _fmo
+000181c0: 6428 7365 6c66 2e6d 3234 2c20 7229 0a20  d(self.m24, r). 
+000181d0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000181e0: 6d33 3120 3d20 5f66 6d6f 6428 7365 6c66  m31 = _fmod(self
+000181f0: 2e6d 3331 2c20 7229 0a20 2020 2020 2020  .m31, r).       
+00018200: 2020 2020 2073 656c 662e 6d33 3220 3d20       self.m32 = 
+00018210: 5f66 6d6f 6428 7365 6c66 2e6d 3332 2c20  _fmod(self.m32, 
+00018220: 7229 0a20 2020 2020 2020 2020 2020 2073  r).            s
+00018230: 656c 662e 6d33 3320 3d20 5f66 6d6f 6428  elf.m33 = _fmod(
+00018240: 7365 6c66 2e6d 3333 2c20 7229 0a20 2020  self.m33, r).   
+00018250: 2020 2020 2020 2020 2073 656c 662e 6d33           self.m3
+00018260: 3420 3d20 5f66 6d6f 6428 7365 6c66 2e6d  4 = _fmod(self.m
+00018270: 3334 2c20 7229 0a20 2020 2020 2020 2020  34, r).         
+00018280: 2020 2073 656c 662e 6d34 3120 3d20 5f66     self.m41 = _f
+00018290: 6d6f 6428 7365 6c66 2e6d 3431 2c20 7229  mod(self.m41, r)
+000182a0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+000182b0: 662e 6d34 3220 3d20 5f66 6d6f 6428 7365  f.m42 = _fmod(se
+000182c0: 6c66 2e6d 3432 2c20 7229 0a20 2020 2020  lf.m42, r).     
+000182d0: 2020 2020 2020 2073 656c 662e 6d34 3320         self.m43 
+000182e0: 3d20 5f66 6d6f 6428 7365 6c66 2e6d 3433  = _fmod(self.m43
+000182f0: 2c20 7229 0a20 2020 2020 2020 2020 2020  , r).           
+00018300: 2073 656c 662e 6d34 3420 3d20 5f66 6d6f   self.m44 = _fmo
+00018310: 6428 7365 6c66 2e6d 3434 2c20 7229 0a20  d(self.m44, r). 
+00018320: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00018330: 6e20 7365 6c66 0a20 2020 2020 2020 2065  n self.        e
+00018340: 6c69 6620 7462 2069 7320 6d61 7434 3a0a  lif tb is mat4:.
+00018350: 2020 2020 2020 2020 2020 2020 6d62 203d              mb =
+00018360: 2062 0a20 2020 2020 2020 2020 2020 2069   b.            i
+00018370: 6620 2866 6162 7328 6d62 2e6d 3131 293c  f (fabs(mb.m11)<
+00018380: 3d65 7073 206f 7220 6661 6273 286d 622e  =eps or fabs(mb.
+00018390: 6d31 3229 3c3d 6570 7320 6f72 2066 6162  m12)<=eps or fab
+000183a0: 7328 6d62 2e6d 3133 293c 3d65 7073 206f  s(mb.m13)<=eps o
+000183b0: 720a 2020 2020 2020 2020 2020 2020 2020  r.              
+000183c0: 2020 6661 6273 286d 622e 6d31 3429 3c3d    fabs(mb.m14)<=
+000183d0: 6570 7320 6f72 0a20 2020 2020 2020 2020  eps or.         
+000183e0: 2020 2020 2020 2066 6162 7328 6d62 2e6d         fabs(mb.m
+000183f0: 3231 293c 3d65 7073 206f 7220 6661 6273  21)<=eps or fabs
+00018400: 286d 622e 6d32 3229 3c3d 6570 7320 6f72  (mb.m22)<=eps or
+00018410: 2066 6162 7328 6d62 2e6d 3233 293c 3d65   fabs(mb.m23)<=e
+00018420: 7073 206f 720a 2020 2020 2020 2020 2020  ps or.          
+00018430: 2020 2020 2020 6661 6273 286d 622e 6d32        fabs(mb.m2
+00018440: 3429 3c3d 6570 7320 6f72 0a20 2020 2020  4)<=eps or.     
+00018450: 2020 2020 2020 2020 2020 2066 6162 7328             fabs(
+00018460: 6d62 2e6d 3331 293c 3d65 7073 206f 7220  mb.m31)<=eps or 
+00018470: 6661 6273 286d 622e 6d33 3229 3c3d 6570  fabs(mb.m32)<=ep
+00018480: 7320 6f72 2066 6162 7328 6d62 2e6d 3333  s or fabs(mb.m33
+00018490: 293c 3d65 7073 206f 720a 2020 2020 2020  )<=eps or.      
+000184a0: 2020 2020 2020 2020 2020 6661 6273 286d            fabs(m
+000184b0: 622e 6d33 3429 3c3d 6570 7320 6f72 0a20  b.m34)<=eps or. 
+000184c0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+000184d0: 6162 7328 6d62 2e6d 3431 293c 3d65 7073  abs(mb.m41)<=eps
+000184e0: 206f 7220 6661 6273 286d 622e 6d34 3229   or fabs(mb.m42)
+000184f0: 3c3d 6570 7320 6f72 2066 6162 7328 6d62  <=eps or fabs(mb
+00018500: 2e6d 3433 293c 3d65 7073 206f 720a 2020  .m43)<=eps or.  
+00018510: 2020 2020 2020 2020 2020 2020 2020 6661                fa
+00018520: 6273 286d 622e 6d34 3429 3c3d 6570 7329  bs(mb.m44)<=eps)
+00018530: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00018540: 2020 7261 6973 6520 5a65 726f 4469 7669    raise ZeroDivi
+00018550: 7369 6f6e 4572 726f 722c 226d 6174 3420  sionError,"mat4 
+00018560: 6d6f 6475 6c6f 220a 2020 2020 2020 2020  modulo".        
+00018570: 2020 2020 7365 6c66 2e6d 3131 203d 205f      self.m11 = _
+00018580: 666d 6f64 2873 656c 662e 6d31 312c 206d  fmod(self.m11, m
+00018590: 622e 6d31 3129 0a20 2020 2020 2020 2020  b.m11).         
+000185a0: 2020 2073 656c 662e 6d31 3220 3d20 5f66     self.m12 = _f
+000185b0: 6d6f 6428 7365 6c66 2e6d 3132 2c20 6d62  mod(self.m12, mb
+000185c0: 2e6d 3132 290a 2020 2020 2020 2020 2020  .m12).          
+000185d0: 2020 7365 6c66 2e6d 3133 203d 205f 666d    self.m13 = _fm
+000185e0: 6f64 2873 656c 662e 6d31 332c 206d 622e  od(self.m13, mb.
+000185f0: 6d31 3329 0a20 2020 2020 2020 2020 2020  m13).           
+00018600: 2073 656c 662e 6d31 3420 3d20 5f66 6d6f   self.m14 = _fmo
+00018610: 6428 7365 6c66 2e6d 3134 2c20 6d62 2e6d  d(self.m14, mb.m
+00018620: 3133 290a 2020 2020 2020 2020 2020 2020  13).            
+00018630: 7365 6c66 2e6d 3231 203d 205f 666d 6f64  self.m21 = _fmod
+00018640: 2873 656c 662e 6d32 312c 206d 622e 6d32  (self.m21, mb.m2
+00018650: 3129 0a20 2020 2020 2020 2020 2020 2073  1).            s
+00018660: 656c 662e 6d32 3220 3d20 5f66 6d6f 6428  elf.m22 = _fmod(
+00018670: 7365 6c66 2e6d 3232 2c20 6d62 2e6d 3232  self.m22, mb.m22
+00018680: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
+00018690: 6c66 2e6d 3233 203d 205f 666d 6f64 2873  lf.m23 = _fmod(s
+000186a0: 656c 662e 6d32 332c 206d 622e 6d32 3329  elf.m23, mb.m23)
+000186b0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+000186c0: 662e 6d32 3420 3d20 5f66 6d6f 6428 7365  f.m24 = _fmod(se
+000186d0: 6c66 2e6d 3234 2c20 6d62 2e6d 3233 290a  lf.m24, mb.m23).
+000186e0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000186f0: 2e6d 3331 203d 205f 666d 6f64 2873 656c  .m31 = _fmod(sel
+00018700: 662e 6d33 312c 206d 622e 6d33 3129 0a20  f.m31, mb.m31). 
+00018710: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00018720: 6d33 3220 3d20 5f66 6d6f 6428 7365 6c66  m32 = _fmod(self
+00018730: 2e6d 3332 2c20 6d62 2e6d 3332 290a 2020  .m32, mb.m32).  
+00018740: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+00018750: 3333 203d 205f 666d 6f64 2873 656c 662e  33 = _fmod(self.
+00018760: 6d33 332c 206d 622e 6d33 3329 0a20 2020  m33, mb.m33).   
+00018770: 2020 2020 2020 2020 2073 656c 662e 6d33           self.m3
+00018780: 3420 3d20 5f66 6d6f 6428 7365 6c66 2e6d  4 = _fmod(self.m
+00018790: 3334 2c20 6d62 2e6d 3333 290a 2020 2020  34, mb.m33).    
+000187a0: 2020 2020 2020 2020 7365 6c66 2e6d 3431          self.m41
+000187b0: 203d 205f 666d 6f64 2873 656c 662e 6d34   = _fmod(self.m4
+000187c0: 312c 206d 622e 6d34 3129 0a20 2020 2020  1, mb.m41).     
+000187d0: 2020 2020 2020 2073 656c 662e 6d34 3220         self.m42 
+000187e0: 3d20 5f66 6d6f 6428 7365 6c66 2e6d 3432  = _fmod(self.m42
+000187f0: 2c20 6d62 2e6d 3432 290a 2020 2020 2020  , mb.m42).      
+00018800: 2020 2020 2020 7365 6c66 2e6d 3433 203d        self.m43 =
+00018810: 205f 666d 6f64 2873 656c 662e 6d34 332c   _fmod(self.m43,
+00018820: 206d 622e 6d34 3329 0a20 2020 2020 2020   mb.m43).       
+00018830: 2020 2020 2073 656c 662e 6d34 3420 3d20       self.m44 = 
+00018840: 5f66 6d6f 6428 7365 6c66 2e6d 3434 2c20  _fmod(self.m44, 
+00018850: 6d62 2e6d 3433 290a 2020 2020 2020 2020  mb.m43).        
+00018860: 2020 2020 7265 7475 726e 2073 656c 660a      return self.
+00018870: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00018880: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00018890: 5479 7065 4572 726f 722c 2022 756e 7375  TypeError, "unsu
+000188a0: 7070 6f72 7465 6420 6f70 6572 616e 6420  pported operand 
+000188b0: 7479 7065 2066 6f72 2025 3d22 0a0a 2020  type for %="..  
+000188c0: 2020 6465 6620 5f5f 6c65 6e5f 5f28 7365    def __len__(se
+000188d0: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
+000188e0: 4c65 6e67 7468 206f 6620 7468 6520 7365  Length of the se
+000188f0: 7175 656e 6365 2028 616c 7761 7973 2034  quence (always 4
+00018900: 292e 2222 220a 2020 2020 2020 2020 7265  ).""".        re
+00018910: 7475 726e 2034 0a0a 2020 2020 6465 6620  turn 4..    def 
+00018920: 5f5f 6765 7469 7465 6d5f 5f28 6d61 7434  __getitem__(mat4
+00018930: 2073 656c 662c 206b 6579 293a 0a20 2020   self, key):.   
+00018940: 2020 2020 2022 2222 5265 7475 726e 2061       """Return a
+00018950: 2063 6f6c 756d 6e20 6f72 2061 2073 696e   column or a sin
+00018960: 676c 6520 6d61 7472 6978 2065 6c65 6d65  gle matrix eleme
+00018970: 6e74 2e0a 2020 2020 2020 2020 2222 220a  nt..        """.
+00018980: 2020 2020 2020 2020 6364 6566 2069 6e74          cdef int
+00018990: 2069 2c6a 0a0a 2020 2020 2020 2020 543d   i,j..        T=
+000189a0: 7479 7065 286b 6579 290a 2020 2020 2020  type(key).      
+000189b0: 2020 6966 2054 2069 7320 696e 7420 6f72    if T is int or
+000189c0: 2054 2069 7320 6c6f 6e67 3a0a 2020 2020   T is long:.    
+000189d0: 2020 2020 2020 2020 6920 3d20 6b65 790a          i = key.
+000189e0: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+000189f0: 3d3d 303a 0a20 2020 2020 2020 2020 2020  ==0:.           
+00018a00: 2020 2020 2072 6574 7572 6e20 7665 6334       return vec4
+00018a10: 2873 656c 662e 6d31 312c 2073 656c 662e  (self.m11, self.
+00018a20: 6d32 312c 2073 656c 662e 6d33 312c 2073  m21, self.m31, s
+00018a30: 656c 662e 6d34 3129 0a20 2020 2020 2020  elf.m41).       
+00018a40: 2020 2020 2065 6c69 6620 693d 3d31 3a0a       elif i==1:.
+00018a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018a60: 7265 7475 726e 2076 6563 3428 7365 6c66  return vec4(self
+00018a70: 2e6d 3132 2c20 7365 6c66 2e6d 3232 2c20  .m12, self.m22, 
+00018a80: 7365 6c66 2e6d 3332 2c20 7365 6c66 2e6d  self.m32, self.m
+00018a90: 3432 290a 2020 2020 2020 2020 2020 2020  42).            
+00018aa0: 656c 6966 2069 3d3d 323a 0a20 2020 2020  elif i==2:.     
+00018ab0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00018ac0: 6e20 7665 6334 2873 656c 662e 6d31 332c  n vec4(self.m13,
+00018ad0: 2073 656c 662e 6d32 332c 2073 656c 662e   self.m23, self.
+00018ae0: 6d33 332c 2073 656c 662e 6d34 3329 0a20  m33, self.m43). 
+00018af0: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
+00018b00: 693d 3d33 3a0a 2020 2020 2020 2020 2020  i==3:.          
+00018b10: 2020 2020 2020 7265 7475 726e 2076 6563        return vec
+00018b20: 3428 7365 6c66 2e6d 3134 2c20 7365 6c66  4(self.m14, self
+00018b30: 2e6d 3234 2c20 7365 6c66 2e6d 3334 2c20  .m24, self.m34, 
+00018b40: 7365 6c66 2e6d 3434 290a 2020 2020 2020  self.m44).      
+00018b50: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00018b60: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00018b70: 6520 496e 6465 7845 7272 6f72 2c20 2269  e IndexError, "i
+00018b80: 6e64 6578 206f 7574 206f 6620 7261 6e67  ndex out of rang
+00018b90: 6522 0a20 2020 2020 2020 2065 6c69 6620  e".        elif 
+00018ba0: 5420 6973 2074 7570 6c65 3a0a 2020 2020  T is tuple:.    
+00018bb0: 2020 2020 2020 2020 6966 206c 656e 286b          if len(k
+00018bc0: 6579 2921 3d32 3a0a 2020 2020 2020 2020  ey)!=2:.        
+00018bd0: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+00018be0: 6c75 6545 7272 6f72 2c20 2269 6e64 6578  lueError, "index
+00018bf0: 2074 7570 6c65 206d 7573 7420 6265 2061   tuple must be a
+00018c00: 2032 2d74 7570 6c65 220a 2020 2020 2020   2-tuple".      
+00018c10: 2020 2020 2020 6920 3d20 6b65 795b 305d        i = key[0]
+00018c20: 0a20 2020 2020 2020 2020 2020 206a 203d  .            j =
+00018c30: 206b 6579 5b31 5d0a 2020 2020 2020 2020   key[1].        
+00018c40: 2020 2020 6966 2069 3c30 206f 7220 693e      if i<0 or i>
+00018c50: 3320 6f72 206a 3c30 206f 7220 6a3e 333a  3 or j<0 or j>3:
+00018c60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00018c70: 2072 6169 7365 2049 6e64 6578 4572 726f   raise IndexErro
+00018c80: 722c 2022 696e 6465 7820 6f75 7420 6f66  r, "index out of
+00018c90: 2072 616e 6765 220a 0a20 2020 2020 2020   range"..       
+00018ca0: 2020 2020 2069 6620 693d 3d30 3a0a 2020       if i==0:.  
+00018cb0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00018cc0: 206a 3d3d 303a 0a20 2020 2020 2020 2020   j==0:.         
+00018cd0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00018ce0: 6e20 7365 6c66 2e6d 3131 0a20 2020 2020  n self.m11.     
+00018cf0: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
+00018d00: 6a3d 3d31 3a0a 2020 2020 2020 2020 2020  j==1:.          
+00018d10: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00018d20: 2073 656c 662e 6d31 320a 2020 2020 2020   self.m12.      
+00018d30: 2020 2020 2020 2020 2020 656c 6966 206a            elif j
+00018d40: 3d3d 323a 0a20 2020 2020 2020 2020 2020  ==2:.           
+00018d50: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00018d60: 7365 6c66 2e6d 3133 0a20 2020 2020 2020  self.m13.       
+00018d70: 2020 2020 2020 2020 2065 6c69 6620 6a3d           elif j=
+00018d80: 3d33 3a0a 2020 2020 2020 2020 2020 2020  =3:.            
+00018d90: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00018da0: 656c 662e 6d31 340a 2020 2020 2020 2020  elf.m14.        
+00018db0: 2020 2020 656c 6966 2069 3d3d 313a 0a20      elif i==1:. 
+00018dc0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00018dd0: 6620 6a3d 3d30 3a0a 2020 2020 2020 2020  f j==0:.        
+00018de0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00018df0: 726e 2073 656c 662e 6d32 310a 2020 2020  rn self.m21.    
+00018e00: 2020 2020 2020 2020 2020 2020 656c 6966              elif
+00018e10: 206a 3d3d 313a 0a20 2020 2020 2020 2020   j==1:.         
+00018e20: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00018e30: 6e20 7365 6c66 2e6d 3232 0a20 2020 2020  n self.m22.     
+00018e40: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
+00018e50: 6a3d 3d32 3a0a 2020 2020 2020 2020 2020  j==2:.          
+00018e60: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00018e70: 2073 656c 662e 6d32 330a 2020 2020 2020   self.m23.      
+00018e80: 2020 2020 2020 2020 2020 656c 6966 206a            elif j
+00018e90: 3d3d 333a 0a20 2020 2020 2020 2020 2020  ==3:.           
+00018ea0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00018eb0: 7365 6c66 2e6d 3234 0a20 2020 2020 2020  self.m24.       
+00018ec0: 2020 2020 2065 6c69 6620 693d 3d32 3a0a       elif i==2:.
+00018ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018ee0: 6966 206a 3d3d 303a 0a20 2020 2020 2020  if j==0:.       
+00018ef0: 2020 2020 2020 2020 2020 2020 2072 6574               ret
+00018f00: 7572 6e20 7365 6c66 2e6d 3331 0a20 2020  urn self.m31.   
+00018f10: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
+00018f20: 6620 6a3d 3d31 3a0a 2020 2020 2020 2020  f j==1:.        
+00018f30: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00018f40: 726e 2073 656c 662e 6d33 320a 2020 2020  rn self.m32.    
+00018f50: 2020 2020 2020 2020 2020 2020 656c 6966              elif
+00018f60: 206a 3d3d 323a 0a20 2020 2020 2020 2020   j==2:.         
+00018f70: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00018f80: 6e20 7365 6c66 2e6d 3333 0a20 2020 2020  n self.m33.     
+00018f90: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
+00018fa0: 6a3d 3d33 3a0a 2020 2020 2020 2020 2020  j==3:.          
+00018fb0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00018fc0: 2073 656c 662e 6d33 340a 2020 2020 2020   self.m34.      
+00018fd0: 2020 2020 2020 656c 6966 2069 3d3d 333a        elif i==3:
+00018fe0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00018ff0: 2069 6620 6a3d 3d30 3a0a 2020 2020 2020   if j==0:.      
+00019000: 2020 2020 2020 2020 2020 2020 2020 7265                re
+00019010: 7475 726e 2073 656c 662e 6d34 310a 2020  turn self.m41.  
+00019020: 2020 2020 2020 2020 2020 2020 2020 656c                el
+00019030: 6966 206a 3d3d 313a 0a20 2020 2020 2020  if j==1:.       
+00019040: 2020 2020 2020 2020 2020 2020 2072 6574               ret
+00019050: 7572 6e20 7365 6c66 2e6d 3432 0a20 2020  urn self.m42.   
+00019060: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
+00019070: 6620 6a3d 3d32 3a0a 2020 2020 2020 2020  f j==2:.        
+00019080: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00019090: 726e 2073 656c 662e 6d34 330a 2020 2020  rn self.m43.    
+000190a0: 2020 2020 2020 2020 2020 2020 656c 6966              elif
+000190b0: 206a 3d3d 333a 0a20 2020 2020 2020 2020   j==3:.         
+000190c0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+000190d0: 6e20 7365 6c66 2e6d 3434 0a20 2020 2020  n self.m44.     
+000190e0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+000190f0: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
+00019100: 7272 6f72 2c22 696e 6465 7820 6d75 7374  rror,"index must
+00019110: 2062 6520 696e 7465 6765 7220 6f72 2032   be integer or 2
+00019120: 2d74 7570 6c65 220a 0a20 2020 2064 6566  -tuple"..    def
+00019130: 205f 5f73 6574 6974 656d 5f5f 2873 656c   __setitem__(sel
+00019140: 662c 206b 6579 2c20 7661 6c75 6529 3a0a  f, key, value):.
+00019150: 2020 2020 2020 2020 2222 2253 6574 2061          """Set a
+00019160: 2063 6f6c 756d 6e20 6f72 2061 2073 696e   column or a sin
+00019170: 676c 6520 6d61 7472 6978 2065 6c65 6d65  gle matrix eleme
+00019180: 6e74 2e0a 0a20 2020 2020 2020 2054 6865  nt...        The
+00019190: 2063 6f6c 756d 6e20 6d75 7374 2062 6520   column must be 
+000191a0: 6769 7665 6e20 6173 2061 2034 2d73 6571  given as a 4-seq
+000191b0: 7565 6e63 6520 2874 6869 7320 696e 636c  uence (this incl
+000191c0: 7564 6573 2076 6563 3420 6173 2077 656c  udes vec4 as wel
+000191d0: 6c29 2e0a 2020 2020 2020 2020 2222 220a  l)..        """.
+000191e0: 2020 2020 2020 2020 6364 6566 2069 6e74          cdef int
+000191f0: 2069 2c6a 0a20 2020 2020 2020 2063 6465   i,j.        cde
+00019200: 6620 646f 7562 6c65 2076 0a0a 2020 2020  f double v..    
+00019210: 2020 2020 543d 7479 7065 286b 6579 290a      T=type(key).
+00019220: 2020 2020 2020 2020 6966 2054 2069 7320          if T is 
+00019230: 696e 7420 6f72 2054 2069 7320 6c6f 6e67  int or T is long
+00019240: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+00019250: 206c 656e 2876 616c 7565 2921 3d34 3a0a   len(value)!=4:.
+00019260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019270: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+00019280: 2c20 2234 2d73 6571 7565 6e63 6520 6578  , "4-sequence ex
+00019290: 7065 6374 6564 220a 2020 2020 2020 2020  pected".        
+000192a0: 2020 2020 6920 3d20 6b65 790a 2020 2020      i = key.    
+000192b0: 2020 2020 2020 2020 6966 2069 3d3d 303a          if i==0:
+000192c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000192d0: 2073 656c 662e 6d31 3120 3d20 7661 6c75   self.m11 = valu
+000192e0: 655b 305d 0a20 2020 2020 2020 2020 2020  e[0].           
+000192f0: 2020 2020 2073 656c 662e 6d32 3120 3d20       self.m21 = 
+00019300: 7661 6c75 655b 315d 0a20 2020 2020 2020  value[1].       
+00019310: 2020 2020 2020 2020 2073 656c 662e 6d33           self.m3
+00019320: 3120 3d20 7661 6c75 655b 325d 0a20 2020  1 = value[2].   
+00019330: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00019340: 662e 6d34 3120 3d20 7661 6c75 655b 335d  f.m41 = value[3]
+00019350: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
+00019360: 6620 693d 3d31 3a0a 2020 2020 2020 2020  f i==1:.        
+00019370: 2020 2020 2020 2020 7365 6c66 2e6d 3132          self.m12
+00019380: 203d 2076 616c 7565 5b30 5d0a 2020 2020   = value[0].    
+00019390: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000193a0: 2e6d 3232 203d 2076 616c 7565 5b31 5d0a  .m22 = value[1].
+000193b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000193c0: 7365 6c66 2e6d 3332 203d 2076 616c 7565  self.m32 = value
+000193d0: 5b32 5d0a 2020 2020 2020 2020 2020 2020  [2].            
+000193e0: 2020 2020 7365 6c66 2e6d 3432 203d 2076      self.m42 = v
+000193f0: 616c 7565 5b33 5d0a 2020 2020 2020 2020  alue[3].        
+00019400: 2020 2020 656c 6966 2069 3d3d 323a 0a20      elif i==2:. 
+00019410: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00019420: 656c 662e 6d31 3320 3d20 7661 6c75 655b  elf.m13 = value[
+00019430: 305d 0a20 2020 2020 2020 2020 2020 2020  0].             
+00019440: 2020 2073 656c 662e 6d32 3320 3d20 7661     self.m23 = va
+00019450: 6c75 655b 315d 0a20 2020 2020 2020 2020  lue[1].         
+00019460: 2020 2020 2020 2073 656c 662e 6d33 3320         self.m33 
+00019470: 3d20 7661 6c75 655b 325d 0a20 2020 2020  = value[2].     
+00019480: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00019490: 6d34 3320 3d20 7661 6c75 655b 335d 0a20  m43 = value[3]. 
+000194a0: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
+000194b0: 693d 3d33 3a0a 2020 2020 2020 2020 2020  i==3:.          
+000194c0: 2020 2020 2020 7365 6c66 2e6d 3134 203d        self.m14 =
+000194d0: 2076 616c 7565 5b30 5d0a 2020 2020 2020   value[0].      
+000194e0: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+000194f0: 3234 203d 2076 616c 7565 5b31 5d0a 2020  24 = value[1].  
+00019500: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00019510: 6c66 2e6d 3334 203d 2076 616c 7565 5b32  lf.m34 = value[2
+00019520: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+00019530: 2020 7365 6c66 2e6d 3434 203d 2076 616c    self.m44 = val
+00019540: 7565 5b33 5d0a 2020 2020 2020 2020 2020  ue[3].          
+00019550: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00019560: 2020 2020 2020 2020 7261 6973 6520 496e          raise In
+00019570: 6465 7845 7272 6f72 2c20 2269 6e64 6578  dexError, "index
+00019580: 206f 7574 206f 6620 7261 6e67 6522 0a20   out of range". 
+00019590: 2020 2020 2020 2065 6c69 6620 5420 6973         elif T is
+000195a0: 2074 7570 6c65 3a0a 2020 2020 2020 2020   tuple:.        
+000195b0: 2020 2020 6966 206c 656e 286b 6579 2921      if len(key)!
+000195c0: 3d32 3a0a 2020 2020 2020 2020 2020 2020  =2:.            
+000195d0: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+000195e0: 7272 6f72 2c20 2269 6e64 6578 2074 7570  rror, "index tup
+000195f0: 6c65 206d 7573 7420 6265 2061 2032 2d74  le must be a 2-t
+00019600: 7570 6c65 220a 2020 2020 2020 2020 2020  uple".          
+00019610: 2020 6920 3d20 6b65 795b 305d 0a20 2020    i = key[0].   
+00019620: 2020 2020 2020 2020 206a 203d 206b 6579           j = key
+00019630: 5b31 5d0a 2020 2020 2020 2020 2020 2020  [1].            
+00019640: 7620 3d20 7661 6c75 650a 2020 2020 2020  v = value.      
+00019650: 2020 2020 2020 6966 2069 3c30 206f 7220        if i<0 or 
+00019660: 693e 3320 6f72 206a 3c30 206f 7220 6a3e  i>3 or j<0 or j>
+00019670: 333a 0a20 2020 2020 2020 2020 2020 2020  3:.             
+00019680: 2020 2072 6169 7365 2049 6e64 6578 4572     raise IndexEr
+00019690: 726f 722c 2022 696e 6465 7820 6f75 7420  ror, "index out 
+000196a0: 6f66 2072 616e 6765 220a 0a20 2020 2020  of range"..     
+000196b0: 2020 2020 2020 2069 6620 693d 3d30 3a0a         if i==0:.
+000196c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000196d0: 6966 206a 3d3d 303a 0a20 2020 2020 2020  if j==0:.       
+000196e0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+000196f0: 662e 6d31 3120 3d20 760a 2020 2020 2020  f.m11 = v.      
+00019700: 2020 2020 2020 2020 2020 656c 6966 206a            elif j
+00019710: 3d3d 313a 0a20 2020 2020 2020 2020 2020  ==1:.           
+00019720: 2020 2020 2020 2020 2073 656c 662e 6d31           self.m1
+00019730: 3220 3d20 760a 2020 2020 2020 2020 2020  2 = v.          
+00019740: 2020 2020 2020 656c 6966 206a 3d3d 323a        elif j==2:
+00019750: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00019760: 2020 2020 2073 656c 662e 6d31 3320 3d20       self.m13 = 
+00019770: 760a 2020 2020 2020 2020 2020 2020 2020  v.              
+00019780: 2020 656c 6966 206a 3d3d 333a 0a20 2020    elif j==3:.   
+00019790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000197a0: 2073 656c 662e 6d31 3420 3d20 760a 2020   self.m14 = v.  
+000197b0: 2020 2020 2020 2020 2020 656c 6966 2069            elif i
+000197c0: 3d3d 313a 0a20 2020 2020 2020 2020 2020  ==1:.           
+000197d0: 2020 2020 2069 6620 6a3d 3d30 3a0a 2020       if j==0:.  
+000197e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000197f0: 2020 7365 6c66 2e6d 3231 203d 2076 0a20    self.m21 = v. 
+00019800: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00019810: 6c69 6620 6a3d 3d31 3a0a 2020 2020 2020  lif j==1:.      
+00019820: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00019830: 6c66 2e6d 3232 203d 2076 0a20 2020 2020  lf.m22 = v.     
+00019840: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
+00019850: 6a3d 3d32 3a0a 2020 2020 2020 2020 2020  j==2:.          
+00019860: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+00019870: 3233 203d 2076 0a20 2020 2020 2020 2020  23 = v.         
+00019880: 2020 2020 2020 2065 6c69 6620 6a3d 3d33         elif j==3
+00019890: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000198a0: 2020 2020 2020 7365 6c66 2e6d 3234 203d        self.m24 =
+000198b0: 2076 0a20 2020 2020 2020 2020 2020 2065   v.            e
+000198c0: 6c69 6620 693d 3d32 3a0a 2020 2020 2020  lif i==2:.      
+000198d0: 2020 2020 2020 2020 2020 6966 206a 3d3d            if j==
+000198e0: 303a 0a20 2020 2020 2020 2020 2020 2020  0:.             
+000198f0: 2020 2020 2020 2073 656c 662e 6d33 3120         self.m31 
+00019900: 3d20 760a 2020 2020 2020 2020 2020 2020  = v.            
+00019910: 2020 2020 656c 6966 206a 3d3d 313a 0a20      elif j==1:. 
+00019920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019930: 2020 2073 656c 662e 6d33 3220 3d20 760a     self.m32 = v.
+00019940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019950: 656c 6966 206a 3d3d 323a 0a20 2020 2020  elif j==2:.     
+00019960: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00019970: 656c 662e 6d33 3320 3d20 760a 2020 2020  elf.m33 = v.    
+00019980: 2020 2020 2020 2020 2020 2020 656c 6966              elif
+00019990: 206a 3d3d 333a 0a20 2020 2020 2020 2020   j==3:.         
+000199a0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000199b0: 6d33 3420 3d20 760a 2020 2020 2020 2020  m34 = v.        
+000199c0: 2020 2020 656c 6966 2069 3d3d 333a 0a20      elif i==3:. 
+000199d0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+000199e0: 6620 6a3d 3d30 3a0a 2020 2020 2020 2020  f j==0:.        
+000199f0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00019a00: 2e6d 3431 203d 2076 0a20 2020 2020 2020  .m41 = v.       
+00019a10: 2020 2020 2020 2020 2065 6c69 6620 6a3d           elif j=
+00019a20: 3d31 3a0a 2020 2020 2020 2020 2020 2020  =1:.            
+00019a30: 2020 2020 2020 2020 7365 6c66 2e6d 3432          self.m42
+00019a40: 203d 2076 0a20 2020 2020 2020 2020 2020   = v.           
+00019a50: 2020 2020 2065 6c69 6620 6a3d 3d32 3a0a       elif j==2:.
+00019a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019a70: 2020 2020 7365 6c66 2e6d 3433 203d 2076      self.m43 = v
+00019a80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00019a90: 2065 6c69 6620 6a3d 3d33 3a0a 2020 2020   elif j==3:.    
+00019aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019ab0: 7365 6c66 2e6d 3434 203d 2076 0a20 2020  self.m44 = v.   
+00019ac0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00019ad0: 2020 2020 2020 2072 6169 7365 2054 7970         raise Typ
+00019ae0: 6545 7272 6f72 2c22 696e 6465 7820 6d75  eError,"index mu
+00019af0: 7374 2062 6520 696e 7465 6765 7220 6f72  st be integer or
+00019b00: 2032 2d74 7570 6c65 220a 0a20 2020 2064   2-tuple"..    d
+00019b10: 6566 2067 6574 526f 7728 7365 6c66 2c20  ef getRow(self, 
+00019b20: 6964 7829 3a0a 2020 2020 2020 2020 2222  idx):.        ""
+00019b30: 2252 6574 7572 6e20 726f 7720 2861 7320  "Return row (as 
+00019b40: 7665 6334 292e 2222 220a 2020 2020 2020  vec4).""".      
+00019b50: 2020 6364 6566 2069 6e74 2069 0a0a 2020    cdef int i..  
+00019b60: 2020 2020 2020 543d 7479 7065 2869 6478        T=type(idx
+00019b70: 290a 2020 2020 2020 2020 6966 2054 213d  ).        if T!=
+00019b80: 696e 7420 616e 6420 5421 3d6c 6f6e 673a  int and T!=long:
+00019b90: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+00019ba0: 7365 2054 7970 6545 7272 6f72 2c22 696e  se TypeError,"in
+00019bb0: 6465 7820 6d75 7374 2062 6520 696e 7465  dex must be inte
+00019bc0: 6765 7222 0a0a 2020 2020 2020 2020 6920  ger"..        i 
+00019bd0: 3d20 6964 780a 2020 2020 2020 2020 6966  = idx.        if
+00019be0: 2069 3d3d 303a 0a20 2020 2020 2020 2020   i==0:.         
+00019bf0: 2020 2072 6574 7572 6e20 7665 6334 2873     return vec4(s
+00019c00: 656c 662e 6d31 312c 2073 656c 662e 6d31  elf.m11, self.m1
+00019c10: 322c 2073 656c 662e 6d31 332c 2073 656c  2, self.m13, sel
+00019c20: 662e 6d31 3429 0a20 2020 2020 2020 2065  f.m14).        e
+00019c30: 6c69 6620 693d 3d31 3a0a 2020 2020 2020  lif i==1:.      
+00019c40: 2020 2020 2020 7265 7475 726e 2076 6563        return vec
+00019c50: 3428 7365 6c66 2e6d 3231 2c20 7365 6c66  4(self.m21, self
+00019c60: 2e6d 3232 2c20 7365 6c66 2e6d 3233 2c20  .m22, self.m23, 
+00019c70: 7365 6c66 2e6d 3234 290a 2020 2020 2020  self.m24).      
+00019c80: 2020 656c 6966 2069 3d3d 323a 0a20 2020    elif i==2:.   
+00019c90: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00019ca0: 7665 6334 2873 656c 662e 6d33 312c 2073  vec4(self.m31, s
+00019cb0: 656c 662e 6d33 322c 2073 656c 662e 6d33  elf.m32, self.m3
+00019cc0: 332c 2073 656c 662e 6d33 3429 0a20 2020  3, self.m34).   
+00019cd0: 2020 2020 2065 6c69 6620 693d 3d33 3a0a       elif i==3:.
+00019ce0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00019cf0: 726e 2076 6563 3428 7365 6c66 2e6d 3431  rn vec4(self.m41
+00019d00: 2c20 7365 6c66 2e6d 3432 2c20 7365 6c66  , self.m42, self
+00019d10: 2e6d 3433 2c20 7365 6c66 2e6d 3434 290a  .m43, self.m44).
+00019d20: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00019d30: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00019d40: 496e 6465 7845 7272 6f72 2c20 2269 6e64  IndexError, "ind
+00019d50: 6578 206f 7574 206f 6620 7261 6e67 6522  ex out of range"
+00019d60: 0a0a 2020 2020 6465 6620 7365 7452 6f77  ..    def setRow
+00019d70: 2873 656c 662c 2069 6478 2c20 7661 6c75  (self, idx, valu
+00019d80: 6529 3a0a 2020 2020 2020 2020 2222 2253  e):.        """S
+00019d90: 6574 2072 6f77 2e22 2222 0a20 2020 2020  et row.""".     
+00019da0: 2020 2063 6465 6620 696e 7420 690a 0a20     cdef int i.. 
+00019db0: 2020 2020 2020 2054 3d74 7970 6528 6964         T=type(id
+00019dc0: 7829 0a20 2020 2020 2020 2069 6620 5421  x).        if T!
+00019dd0: 3d69 6e74 2061 6e64 2054 213d 6c6f 6e67  =int and T!=long
+00019de0: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+00019df0: 6973 6520 5479 7065 4572 726f 722c 2269  ise TypeError,"i
+00019e00: 6e64 6578 206d 7573 7420 6265 2069 6e74  ndex must be int
+00019e10: 6567 6572 220a 0a20 2020 2020 2020 2069  eger"..        i
+00019e20: 6620 6c65 6e28 7661 6c75 6529 213d 343a  f len(value)!=4:
+00019e30: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+00019e40: 7365 2056 616c 7565 4572 726f 722c 2022  se ValueError, "
+00019e50: 342d 7365 7175 656e 6365 2065 7870 6563  4-sequence expec
+00019e60: 7465 6422 0a0a 2020 2020 2020 2020 6920  ted"..        i 
+00019e70: 3d20 6964 780a 2020 2020 2020 2020 6966  = idx.        if
+00019e80: 2069 3d3d 303a 0a20 2020 2020 2020 2020   i==0:.         
+00019e90: 2020 2073 656c 662e 6d31 3120 3d20 7661     self.m11 = va
+00019ea0: 6c75 655b 305d 0a20 2020 2020 2020 2020  lue[0].         
+00019eb0: 2020 2073 656c 662e 6d31 3220 3d20 7661     self.m12 = va
+00019ec0: 6c75 655b 315d 0a20 2020 2020 2020 2020  lue[1].         
+00019ed0: 2020 2073 656c 662e 6d31 3320 3d20 7661     self.m13 = va
+00019ee0: 6c75 655b 325d 0a20 2020 2020 2020 2020  lue[2].         
+00019ef0: 2020 2073 656c 662e 6d31 3420 3d20 7661     self.m14 = va
+00019f00: 6c75 655b 335d 0a20 2020 2020 2020 2065  lue[3].        e
+00019f10: 6c69 6620 693d 3d31 3a0a 2020 2020 2020  lif i==1:.      
+00019f20: 2020 2020 2020 7365 6c66 2e6d 3231 203d        self.m21 =
+00019f30: 2076 616c 7565 5b30 5d0a 2020 2020 2020   value[0].      
+00019f40: 2020 2020 2020 7365 6c66 2e6d 3232 203d        self.m22 =
+00019f50: 2076 616c 7565 5b31 5d0a 2020 2020 2020   value[1].      
+00019f60: 2020 2020 2020 7365 6c66 2e6d 3233 203d        self.m23 =
+00019f70: 2076 616c 7565 5b32 5d0a 2020 2020 2020   value[2].      
+00019f80: 2020 2020 2020 7365 6c66 2e6d 3234 203d        self.m24 =
+00019f90: 2076 616c 7565 5b33 5d0a 2020 2020 2020   value[3].      
+00019fa0: 2020 656c 6966 2069 3d3d 323a 0a20 2020    elif i==2:.   
+00019fb0: 2020 2020 2020 2020 2073 656c 662e 6d33           self.m3
+00019fc0: 3120 3d20 7661 6c75 655b 305d 0a20 2020  1 = value[0].   
+00019fd0: 2020 2020 2020 2020 2073 656c 662e 6d33           self.m3
+00019fe0: 3220 3d20 7661 6c75 655b 315d 0a20 2020  2 = value[1].   
+00019ff0: 2020 2020 2020 2020 2073 656c 662e 6d33           self.m3
+0001a000: 3320 3d20 7661 6c75 655b 325d 0a20 2020  3 = value[2].   
+0001a010: 2020 2020 2020 2020 2073 656c 662e 6d33           self.m3
+0001a020: 3420 3d20 7661 6c75 655b 335d 0a20 2020  4 = value[3].   
+0001a030: 2020 2020 2065 6c69 6620 693d 3d33 3a0a       elif i==3:.
+0001a040: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0001a050: 2e6d 3431 203d 2076 616c 7565 5b30 5d0a  .m41 = value[0].
+0001a060: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0001a070: 2e6d 3432 203d 2076 616c 7565 5b31 5d0a  .m42 = value[1].
+0001a080: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0001a090: 2e6d 3433 203d 2076 616c 7565 5b32 5d0a  .m43 = value[2].
+0001a0a0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0001a0b0: 2e6d 3434 203d 2076 616c 7565 5b33 5d0a  .m44 = value[3].
+0001a0c0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+0001a0d0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+0001a0e0: 496e 6465 7845 7272 6f72 2c20 2269 6e64  IndexError, "ind
+0001a0f0: 6578 206f 7574 206f 6620 7261 6e67 6522  ex out of range"
+0001a100: 0a0a 2020 2020 6465 6620 6765 7443 6f6c  ..    def getCol
+0001a110: 756d 6e28 7365 6c66 2c20 6964 7829 3a0a  umn(self, idx):.
+0001a120: 2020 2020 2020 2020 2222 2252 6574 7572          """Retur
+0001a130: 6e20 636f 6c75 6d6e 2028 6173 2076 6563  n column (as vec
+0001a140: 3429 2e22 2222 0a20 2020 2020 2020 2063  4).""".        c
+0001a150: 6465 6620 696e 7420 690a 0a20 2020 2020  def int i..     
+0001a160: 2020 2054 3d74 7970 6528 6964 7829 0a20     T=type(idx). 
+0001a170: 2020 2020 2020 2069 6620 5421 3d69 6e74         if T!=int
+0001a180: 2061 6e64 2054 213d 6c6f 6e67 3a0a 2020   and T!=long:.  
+0001a190: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+0001a1a0: 5479 7065 4572 726f 722c 2269 6e64 6578  TypeError,"index
+0001a1b0: 206d 7573 7420 6265 2069 6e74 6567 6572   must be integer
+0001a1c0: 220a 0a20 2020 2020 2020 2069 203d 2069  "..        i = i
+0001a1d0: 6478 0a20 2020 2020 2020 2069 6620 693d  dx.        if i=
+0001a1e0: 3d30 3a0a 2020 2020 2020 2020 2020 2020  =0:.            
+0001a1f0: 7265 7475 726e 2076 6563 3428 7365 6c66  return vec4(self
+0001a200: 2e6d 3131 2c20 7365 6c66 2e6d 3231 2c20  .m11, self.m21, 
+0001a210: 7365 6c66 2e6d 3331 2c20 7365 6c66 2e6d  self.m31, self.m
+0001a220: 3431 290a 2020 2020 2020 2020 656c 6966  41).        elif
+0001a230: 2069 3d3d 313a 0a20 2020 2020 2020 2020   i==1:.         
+0001a240: 2020 2072 6574 7572 6e20 7665 6334 2873     return vec4(s
+0001a250: 656c 662e 6d31 322c 2073 656c 662e 6d32  elf.m12, self.m2
+0001a260: 322c 2073 656c 662e 6d33 322c 2073 656c  2, self.m32, sel
+0001a270: 662e 6d34 3229 0a20 2020 2020 2020 2065  f.m42).        e
+0001a280: 6c69 6620 693d 3d32 3a0a 2020 2020 2020  lif i==2:.      
+0001a290: 2020 2020 2020 7265 7475 726e 2076 6563        return vec
+0001a2a0: 3428 7365 6c66 2e6d 3133 2c20 7365 6c66  4(self.m13, self
+0001a2b0: 2e6d 3233 2c20 7365 6c66 2e6d 3333 2c20  .m23, self.m33, 
+0001a2c0: 7365 6c66 2e6d 3433 290a 2020 2020 2020  self.m43).      
+0001a2d0: 2020 656c 6966 2069 3d3d 333a 0a20 2020    elif i==3:.   
+0001a2e0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+0001a2f0: 7665 6334 2873 656c 662e 6d31 342c 2073  vec4(self.m14, s
+0001a300: 656c 662e 6d32 342c 2073 656c 662e 6d33  elf.m24, self.m3
+0001a310: 342c 2073 656c 662e 6d34 3429 0a20 2020  4, self.m44).   
+0001a320: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+0001a330: 2020 2020 2020 2072 6169 7365 2049 6e64         raise Ind
+0001a340: 6578 4572 726f 722c 2022 696e 6465 7820  exError, "index 
+0001a350: 6f75 7420 6f66 2072 616e 6765 220a 0a20  out of range".. 
+0001a360: 2020 2064 6566 2073 6574 436f 6c75 6d6e     def setColumn
+0001a370: 2873 656c 662c 2069 6478 2c20 7661 6c75  (self, idx, valu
+0001a380: 6529 3a0a 2020 2020 2020 2020 2222 2253  e):.        """S
+0001a390: 6574 2063 6f6c 756d 6e2e 2222 220a 2020  et column.""".  
+0001a3a0: 2020 2020 2020 6364 6566 2069 6e74 2069        cdef int i
+0001a3b0: 0a0a 2020 2020 2020 2020 543d 7479 7065  ..        T=type
+0001a3c0: 2869 6478 290a 2020 2020 2020 2020 6966  (idx).        if
+0001a3d0: 2054 213d 696e 7420 616e 6420 5421 3d6c   T!=int and T!=l
+0001a3e0: 6f6e 673a 0a20 2020 2020 2020 2020 2020  ong:.           
+0001a3f0: 2072 6169 7365 2054 7970 6545 7272 6f72   raise TypeError
+0001a400: 2c22 696e 6465 7820 6d75 7374 2062 6520  ,"index must be 
+0001a410: 696e 7465 6765 7222 0a0a 2020 2020 2020  integer"..      
+0001a420: 2020 6966 206c 656e 2876 616c 7565 2921    if len(value)!
+0001a430: 3d34 3a0a 2020 2020 2020 2020 2020 2020  =4:.            
+0001a440: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+0001a450: 2c20 2234 2d73 6571 7565 6e63 6520 6578  , "4-sequence ex
+0001a460: 7065 6374 6564 220a 0a20 2020 2020 2020  pected"..       
+0001a470: 2069 203d 2069 6478 0a20 2020 2020 2020   i = idx.       
+0001a480: 2069 6620 693d 3d30 3a0a 2020 2020 2020   if i==0:.      
+0001a490: 2020 2020 2020 7365 6c66 2e6d 3131 203d        self.m11 =
+0001a4a0: 2076 616c 7565 5b30 5d0a 2020 2020 2020   value[0].      
+0001a4b0: 2020 2020 2020 7365 6c66 2e6d 3231 203d        self.m21 =
+0001a4c0: 2076 616c 7565 5b31 5d0a 2020 2020 2020   value[1].      
+0001a4d0: 2020 2020 2020 7365 6c66 2e6d 3331 203d        self.m31 =
+0001a4e0: 2076 616c 7565 5b32 5d0a 2020 2020 2020   value[2].      
+0001a4f0: 2020 2020 2020 7365 6c66 2e6d 3431 203d        self.m41 =
+0001a500: 2076 616c 7565 5b33 5d0a 2020 2020 2020   value[3].      
+0001a510: 2020 656c 6966 2069 3d3d 313a 0a20 2020    elif i==1:.   
+0001a520: 2020 2020 2020 2020 2073 656c 662e 6d31           self.m1
+0001a530: 3220 3d20 7661 6c75 655b 305d 0a20 2020  2 = value[0].   
+0001a540: 2020 2020 2020 2020 2073 656c 662e 6d32           self.m2
+0001a550: 3220 3d20 7661 6c75 655b 315d 0a20 2020  2 = value[1].   
+0001a560: 2020 2020 2020 2020 2073 656c 662e 6d33           self.m3
+0001a570: 3220 3d20 7661 6c75 655b 325d 0a20 2020  2 = value[2].   
+0001a580: 2020 2020 2020 2020 2073 656c 662e 6d34           self.m4
+0001a590: 3220 3d20 7661 6c75 655b 335d 0a20 2020  2 = value[3].   
+0001a5a0: 2020 2020 2065 6c69 6620 693d 3d32 3a0a       elif i==2:.
+0001a5b0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0001a5c0: 2e6d 3133 203d 2076 616c 7565 5b30 5d0a  .m13 = value[0].
+0001a5d0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0001a5e0: 2e6d 3233 203d 2076 616c 7565 5b31 5d0a  .m23 = value[1].
+0001a5f0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0001a600: 2e6d 3333 203d 2076 616c 7565 5b32 5d0a  .m33 = value[2].
+0001a610: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0001a620: 2e6d 3433 203d 2076 616c 7565 5b33 5d0a  .m43 = value[3].
+0001a630: 2020 2020 2020 2020 656c 6966 2069 3d3d          elif i==
+0001a640: 333a 0a20 2020 2020 2020 2020 2020 2073  3:.            s
+0001a650: 656c 662e 6d31 3420 3d20 7661 6c75 655b  elf.m14 = value[
+0001a660: 305d 0a20 2020 2020 2020 2020 2020 2073  0].            s
+0001a670: 656c 662e 6d32 3420 3d20 7661 6c75 655b  elf.m24 = value[
+0001a680: 315d 0a20 2020 2020 2020 2020 2020 2073  1].            s
+0001a690: 656c 662e 6d33 3420 3d20 7661 6c75 655b  elf.m34 = value[
+0001a6a0: 325d 0a20 2020 2020 2020 2020 2020 2073  2].            s
+0001a6b0: 656c 662e 6d34 3420 3d20 7661 6c75 655b  elf.m44 = value[
+0001a6c0: 335d 0a20 2020 2020 2020 2065 6c73 653a  3].        else:
+0001a6d0: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+0001a6e0: 7365 2049 6e64 6578 4572 726f 722c 2022  se IndexError, "
+0001a6f0: 696e 6465 7820 6f75 7420 6f66 2072 616e  index out of ran
+0001a700: 6765 220a 0a0a 2020 2020 6465 6620 746f  ge"...    def to
+0001a710: 4c69 7374 2873 656c 662c 2072 6f77 6d61  List(self, rowma
+0001a720: 6a6f 723d 3029 3a0a 2020 2020 2020 2020  jor=0):.        
+0001a730: 2222 2252 6574 7572 6e20 6120 6c69 7374  """Return a list
+0001a740: 2063 6f6e 7461 696e 696e 6720 7468 6520   containing the 
+0001a750: 6d61 7472 6978 2065 6c65 6d65 6e74 732e  matrix elements.
+0001a760: 0a0a 2020 2020 2020 2020 4279 2064 6566  ..        By def
+0001a770: 6175 6c74 2074 6865 206c 6973 7420 6973  ault the list is
+0001a780: 2069 6e20 636f 6c75 6d6e 2d6d 616a 6f72   in column-major
+0001a790: 206f 7264 6572 2028 7768 6963 6820 6361   order (which ca
+0001a7a0: 6e20 6469 7265 6374 6c79 2062 650a 2020  n directly be.  
+0001a7b0: 2020 2020 2020 7573 6564 2069 6e20 4f70        used in Op
+0001a7c0: 656e 474c 206f 7220 5265 6e64 6572 4d61  enGL or RenderMa
+0001a7d0: 6e29 2e20 4966 2079 6f75 2073 6574 2074  n). If you set t
+0001a7e0: 6865 206f 7074 696f 6e61 6c20 6172 6775  he optional argu
+0001a7f0: 6d65 6e74 0a20 2020 2020 2020 2072 6f77  ment.        row
+0001a800: 6d61 6a6f 7220 746f 2031 2c20 796f 7527  major to 1, you'
+0001a810: 6c6c 2067 6574 2074 6865 206c 6973 7420  ll get the list 
+0001a820: 696e 2072 6f77 2d6d 616a 6f72 206f 7264  in row-major ord
+0001a830: 6572 2e0a 0a20 2020 2020 2020 203e 3e3e  er...        >>>
+0001a840: 204d 3d6d 6174 3428 312c 322c 332c 342c   M=mat4(1,2,3,4,
+0001a850: 352c 362c 372c 382c 392c 3130 2c31 312c  5,6,7,8,9,10,11,
+0001a860: 3132 2c31 332c 3134 2c31 352c 3136 290a  12,13,14,15,16).
+0001a870: 2020 2020 2020 2020 3e3e 3e20 7072 696e          >>> prin
+0001a880: 7428 4d2e 746f 4c69 7374 2829 290a 2020  t(M.toList()).  
+0001a890: 2020 2020 2020 5b31 2c20 352c 2039 2c20        [1, 5, 9, 
+0001a8a0: 3133 2c20 322c 2036 2c20 3130 2c20 3134  13, 2, 6, 10, 14
+0001a8b0: 2c20 332c 2037 2c20 3131 2c20 3135 2c20  , 3, 7, 11, 15, 
+0001a8c0: 342c 2038 2c20 3132 2c20 3136 5d0a 2020  4, 8, 12, 16].  
+0001a8d0: 2020 2020 2020 3e3e 3e20 7072 696e 7428        >>> print(
+0001a8e0: 4d2e 746f 4c69 7374 2872 6f77 6d61 6a6f  M.toList(rowmajo
+0001a8f0: 723d 3129 290a 2020 2020 2020 2020 5b31  r=1)).        [1
+0001a900: 2c20 322c 2033 2c20 342c 2035 2c20 362c  , 2, 3, 4, 5, 6,
+0001a910: 2037 2c20 382c 2039 2c20 3130 2c20 3131   7, 8, 9, 10, 11
+0001a920: 2c20 3132 2c20 3133 2c20 3134 2c20 3135  , 12, 13, 14, 15
+0001a930: 2c20 3136 5d0a 2020 2020 2020 2020 2222  , 16].        ""
+0001a940: 220a 2020 2020 2020 2020 6966 2072 6f77  ".        if row
+0001a950: 6d61 6a6f 723a 0a20 2020 2020 2020 2020  major:.         
+0001a960: 2020 2072 6574 7572 6e20 5b73 656c 662e     return [self.
+0001a970: 6d31 312c 2073 656c 662e 6d31 322c 2073  m11, self.m12, s
+0001a980: 656c 662e 6d31 332c 2073 656c 662e 6d31  elf.m13, self.m1
+0001a990: 342c 0a20 2020 2020 2020 2020 2020 2020  4,.             
+0001a9a0: 2020 2020 2020 2073 656c 662e 6d32 312c         self.m21,
+0001a9b0: 2073 656c 662e 6d32 322c 2073 656c 662e   self.m22, self.
+0001a9c0: 6d32 332c 2073 656c 662e 6d32 342c 0a20  m23, self.m24,. 
+0001a9d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a9e0: 2020 2073 656c 662e 6d33 312c 2073 656c     self.m31, sel
+0001a9f0: 662e 6d33 322c 2073 656c 662e 6d33 332c  f.m32, self.m33,
+0001aa00: 2073 656c 662e 6d33 342c 0a20 2020 2020   self.m34,.     
+0001aa10: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0001aa20: 656c 662e 6d34 312c 2073 656c 662e 6d34  elf.m41, self.m4
+0001aa30: 322c 2073 656c 662e 6d34 332c 2073 656c  2, self.m43, sel
+0001aa40: 662e 6d34 345d 0a20 2020 2020 2020 2065  f.m44].        e
+0001aa50: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+0001aa60: 2072 6574 7572 6e20 5b73 656c 662e 6d31   return [self.m1
+0001aa70: 312c 2073 656c 662e 6d32 312c 2073 656c  1, self.m21, sel
+0001aa80: 662e 6d33 312c 2073 656c 662e 6d34 312c  f.m31, self.m41,
+0001aa90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001aaa0: 2020 2020 2073 656c 662e 6d31 322c 2073       self.m12, s
+0001aab0: 656c 662e 6d32 322c 2073 656c 662e 6d33  elf.m22, self.m3
+0001aac0: 322c 2073 656c 662e 6d34 322c 0a20 2020  2, self.m42,.   
+0001aad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001aae0: 2073 656c 662e 6d31 332c 2073 656c 662e   self.m13, self.
+0001aaf0: 6d32 332c 2073 656c 662e 6d33 332c 2073  m23, self.m33, s
+0001ab00: 656c 662e 6d34 332c 0a20 2020 2020 2020  elf.m43,.       
+0001ab10: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0001ab20: 662e 6d31 342c 2073 656c 662e 6d32 342c  f.m14, self.m24,
+0001ab30: 2073 656c 662e 6d33 342c 2073 656c 662e   self.m34, self.
+0001ab40: 6d34 345d 0a0a 0a20 2020 2064 6566 2069  m44]...    def i
+0001ab50: 6465 6e74 6974 7928 7365 6c66 293a 0a20  dentity(self):. 
+0001ab60: 2020 2020 2020 2022 2222 5265 7475 726e         """Return
+0001ab70: 2069 6465 6e74 6974 7920 6d61 7472 6978   identity matrix
+0001ab80: 2e0a 0a20 2020 2020 2020 203e 3e3e 2070  ...        >>> p
+0001ab90: 7269 6e74 286d 6174 3428 292e 6964 656e  rint(mat4().iden
+0001aba0: 7469 7479 2829 290a 2020 2020 2020 2020  tity()).        
+0001abb0: 5b20 2020 312e 3030 3030 2c20 2020 2030  [   1.0000,    0
+0001abc0: 2e30 3030 302c 2020 2020 302e 3030 3030  .0000,    0.0000
+0001abd0: 2c20 2020 2030 2e30 3030 305d 0a20 2020  ,    0.0000].   
+0001abe0: 2020 2020 205b 2020 2030 2e30 3030 302c       [   0.0000,
+0001abf0: 2020 2020 312e 3030 3030 2c20 2020 2030      1.0000,    0
+0001ac00: 2e30 3030 302c 2020 2020 302e 3030 3030  .0000,    0.0000
+0001ac10: 5d0a 2020 2020 2020 2020 5b20 2020 302e  ].        [   0.
+0001ac20: 3030 3030 2c20 2020 2030 2e30 3030 302c  0000,    0.0000,
+0001ac30: 2020 2020 312e 3030 3030 2c20 2020 2030      1.0000,    0
+0001ac40: 2e30 3030 305d 0a20 2020 2020 2020 205b  .0000].        [
+0001ac50: 2020 2030 2e30 3030 302c 2020 2020 302e     0.0000,    0.
+0001ac60: 3030 3030 2c20 2020 2030 2e30 3030 302c  0000,    0.0000,
+0001ac70: 2020 2020 312e 3030 3030 5d0a 2020 2020      1.0000].    
+0001ac80: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0001ac90: 6364 6566 206d 6174 3420 7265 730a 2020  cdef mat4 res.  
+0001aca0: 2020 2020 2020 7265 7320 3d20 6d61 7434        res = mat4
+0001acb0: 2829 0a20 2020 2020 2020 2072 6573 2e6d  ().        res.m
+0001acc0: 3131 203d 2031 2e30 0a20 2020 2020 2020  11 = 1.0.       
+0001acd0: 2072 6573 2e6d 3132 203d 2030 2e30 0a20   res.m12 = 0.0. 
+0001ace0: 2020 2020 2020 2072 6573 2e6d 3133 203d         res.m13 =
+0001acf0: 2030 2e30 0a20 2020 2020 2020 2072 6573   0.0.        res
+0001ad00: 2e6d 3134 203d 2030 2e30 0a20 2020 2020  .m14 = 0.0.     
+0001ad10: 2020 2072 6573 2e6d 3231 203d 2030 2e30     res.m21 = 0.0
+0001ad20: 0a20 2020 2020 2020 2072 6573 2e6d 3232  .        res.m22
+0001ad30: 203d 2031 2e30 0a20 2020 2020 2020 2072   = 1.0.        r
+0001ad40: 6573 2e6d 3233 203d 2030 2e30 0a20 2020  es.m23 = 0.0.   
+0001ad50: 2020 2020 2072 6573 2e6d 3234 203d 2030       res.m24 = 0
+0001ad60: 2e30 0a20 2020 2020 2020 2072 6573 2e6d  .0.        res.m
+0001ad70: 3331 203d 2030 2e30 0a20 2020 2020 2020  31 = 0.0.       
+0001ad80: 2072 6573 2e6d 3332 203d 2030 2e30 0a20   res.m32 = 0.0. 
+0001ad90: 2020 2020 2020 2072 6573 2e6d 3333 203d         res.m33 =
+0001ada0: 2031 2e30 0a20 2020 2020 2020 2072 6573   1.0.        res
+0001adb0: 2e6d 3334 203d 2030 2e30 0a20 2020 2020  .m34 = 0.0.     
+0001adc0: 2020 2072 6573 2e6d 3431 203d 2030 2e30     res.m41 = 0.0
+0001add0: 0a20 2020 2020 2020 2072 6573 2e6d 3432  .        res.m42
+0001ade0: 203d 2030 2e30 0a20 2020 2020 2020 2072   = 0.0.        r
+0001adf0: 6573 2e6d 3433 203d 2030 2e30 0a20 2020  es.m43 = 0.0.   
+0001ae00: 2020 2020 2072 6573 2e6d 3434 203d 2031       res.m44 = 1
+0001ae10: 2e30 0a20 2020 2020 2020 2072 6574 7572  .0.        retur
+0001ae20: 6e20 7265 730a 0a20 2020 2064 6566 2074  n res..    def t
+0001ae30: 7261 6e73 706f 7365 2873 656c 6629 3a0a  ranspose(self):.
+0001ae40: 2020 2020 2020 2020 2222 2252 6574 7572          """Retur
+0001ae50: 6e20 7472 616e 7370 6f73 6520 6d61 7472  n transpose matr
+0001ae60: 6978 2e0a 0a20 2020 2020 2020 203e 3e3e  ix...        >>>
+0001ae70: 204d 3d6d 6174 3428 312c 322c 332c 342c   M=mat4(1,2,3,4,
+0001ae80: 352c 362c 372c 382c 392c 3130 2c31 312c  5,6,7,8,9,10,11,
+0001ae90: 3132 2c31 332c 3134 2c31 352c 3136 290a  12,13,14,15,16).
+0001aea0: 2020 2020 2020 2020 3e3e 3e20 7072 696e          >>> prin
+0001aeb0: 7428 4d2e 7472 616e 7370 6f73 6528 2929  t(M.transpose())
+0001aec0: 0a20 2020 2020 2020 205b 2020 2031 2e30  .        [   1.0
+0001aed0: 3030 302c 2020 2020 352e 3030 3030 2c20  000,    5.0000, 
+0001aee0: 2020 2039 2e30 3030 302c 2020 2031 332e     9.0000,   13.
+0001aef0: 3030 3030 5d0a 2020 2020 2020 2020 5b20  0000].        [ 
+0001af00: 2020 322e 3030 3030 2c20 2020 2036 2e30    2.0000,    6.0
+0001af10: 3030 302c 2020 2031 302e 3030 3030 2c20  000,   10.0000, 
+0001af20: 2020 3134 2e30 3030 305d 0a20 2020 2020    14.0000].     
+0001af30: 2020 205b 2020 2033 2e30 3030 302c 2020     [   3.0000,  
+0001af40: 2020 372e 3030 3030 2c20 2020 3131 2e30    7.0000,   11.0
+0001af50: 3030 302c 2020 2031 352e 3030 3030 5d0a  000,   15.0000].
+0001af60: 2020 2020 2020 2020 5b20 2020 342e 3030          [   4.00
+0001af70: 3030 2c20 2020 2038 2e30 3030 302c 2020  00,    8.0000,  
+0001af80: 2031 322e 3030 3030 2c20 2020 3136 2e30   12.0000,   16.0
+0001af90: 3030 305d 0a20 2020 2020 2020 2022 2222  000].        """
+0001afa0: 0a20 2020 2020 2020 2063 6465 6620 6d61  .        cdef ma
+0001afb0: 7434 2072 6573 0a20 2020 2020 2020 2072  t4 res.        r
+0001afc0: 6573 203d 206d 6174 3428 290a 2020 2020  es = mat4().    
+0001afd0: 2020 2020 7265 732e 6d31 3120 3d20 7365      res.m11 = se
+0001afe0: 6c66 2e6d 3131 0a20 2020 2020 2020 2072  lf.m11.        r
+0001aff0: 6573 2e6d 3132 203d 2073 656c 662e 6d32  es.m12 = self.m2
+0001b000: 310a 2020 2020 2020 2020 7265 732e 6d31  1.        res.m1
+0001b010: 3320 3d20 7365 6c66 2e6d 3331 0a20 2020  3 = self.m31.   
+0001b020: 2020 2020 2072 6573 2e6d 3134 203d 2073       res.m14 = s
+0001b030: 656c 662e 6d34 310a 2020 2020 2020 2020  elf.m41.        
+0001b040: 7265 732e 6d32 3120 3d20 7365 6c66 2e6d  res.m21 = self.m
+0001b050: 3132 0a20 2020 2020 2020 2072 6573 2e6d  12.        res.m
+0001b060: 3232 203d 2073 656c 662e 6d32 320a 2020  22 = self.m22.  
+0001b070: 2020 2020 2020 7265 732e 6d32 3320 3d20        res.m23 = 
+0001b080: 7365 6c66 2e6d 3332 0a20 2020 2020 2020  self.m32.       
+0001b090: 2072 6573 2e6d 3234 203d 2073 656c 662e   res.m24 = self.
+0001b0a0: 6d34 320a 2020 2020 2020 2020 7265 732e  m42.        res.
+0001b0b0: 6d33 3120 3d20 7365 6c66 2e6d 3133 0a20  m31 = self.m13. 
+0001b0c0: 2020 2020 2020 2072 6573 2e6d 3332 203d         res.m32 =
+0001b0d0: 2073 656c 662e 6d32 330a 2020 2020 2020   self.m23.      
+0001b0e0: 2020 7265 732e 6d33 3320 3d20 7365 6c66    res.m33 = self
+0001b0f0: 2e6d 3333 0a20 2020 2020 2020 2072 6573  .m33.        res
+0001b100: 2e6d 3334 203d 2073 656c 662e 6d34 330a  .m34 = self.m43.
+0001b110: 2020 2020 2020 2020 7265 732e 6d34 3120          res.m41 
+0001b120: 3d20 7365 6c66 2e6d 3134 0a20 2020 2020  = self.m14.     
+0001b130: 2020 2072 6573 2e6d 3432 203d 2073 656c     res.m42 = sel
+0001b140: 662e 6d32 340a 2020 2020 2020 2020 7265  f.m24.        re
+0001b150: 732e 6d34 3320 3d20 7365 6c66 2e6d 3334  s.m43 = self.m34
+0001b160: 0a20 2020 2020 2020 2072 6573 2e6d 3434  .        res.m44
+0001b170: 203d 2073 656c 662e 6d34 340a 2020 2020   = self.m44.    
+0001b180: 2020 2020 7265 7475 726e 2072 6573 0a0a      return res..
+0001b190: 2020 2020 6465 6620 6465 7465 726d 696e      def determin
+0001b1a0: 616e 7428 7365 6c66 293a 0a20 2020 2020  ant(self):.     
+0001b1b0: 2020 2022 2222 5265 7475 726e 2064 6574     """Return det
+0001b1c0: 6572 6d69 6e61 6e74 2e0a 0a20 2020 2020  erminant...     
+0001b1d0: 2020 203e 3e3e 204d 3d6d 6174 3428 322e     >>> M=mat4(2.
+0001b1e0: 302c 302c 302c 302c 2030 2c32 2e30 2c30  0,0,0,0, 0,2.0,0
+0001b1f0: 2c30 2c20 302c 302c 322e 302c 302c 2030  ,0, 0,0,2.0,0, 0
+0001b200: 2c30 2c30 2c32 2e30 290a 2020 2020 2020  ,0,0,2.0).      
+0001b210: 2020 3e3e 3e20 7072 696e 7428 4d2e 6465    >>> print(M.de
+0001b220: 7465 726d 696e 616e 7428 2929 0a20 2020  terminant()).   
+0001b230: 2020 2020 2031 362e 300a 2020 2020 2020       16.0.      
+0001b240: 2020 2222 220a 2020 2020 2020 2020 7265    """.        re
+0001b250: 7475 726e 2073 656c 662e 6d31 312a 7365  turn self.m11*se
+0001b260: 6c66 2e6d 3232 2a73 656c 662e 6d33 332a  lf.m22*self.m33*
+0001b270: 7365 6c66 2e6d 3434 205c 0a20 2020 2020  self.m44 \.     
+0001b280: 2020 2020 2020 2020 2020 2d73 656c 662e            -self.
+0001b290: 6d31 312a 7365 6c66 2e6d 3232 2a73 656c  m11*self.m22*sel
+0001b2a0: 662e 6d33 342a 7365 6c66 2e6d 3433 205c  f.m34*self.m43 \
+0001b2b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001b2c0: 2b73 656c 662e 6d31 312a 7365 6c66 2e6d  +self.m11*self.m
+0001b2d0: 3233 2a73 656c 662e 6d33 342a 7365 6c66  23*self.m34*self
+0001b2e0: 2e6d 3432 205c 0a20 2020 2020 2020 2020  .m42 \.         
+0001b2f0: 2020 2020 2020 2d73 656c 662e 6d31 312a        -self.m11*
+0001b300: 7365 6c66 2e6d 3233 2a73 656c 662e 6d33  self.m23*self.m3
+0001b310: 322a 7365 6c66 2e6d 3434 205c 0a20 2020  2*self.m44 \.   
+0001b320: 2020 2020 2020 2020 2020 2020 2b73 656c              +sel
+0001b330: 662e 6d31 312a 7365 6c66 2e6d 3234 2a73  f.m11*self.m24*s
+0001b340: 656c 662e 6d33 322a 7365 6c66 2e6d 3433  elf.m32*self.m43
+0001b350: 205c 0a20 2020 2020 2020 2020 2020 2020   \.             
+0001b360: 2020 2d73 656c 662e 6d31 312a 7365 6c66    -self.m11*self
+0001b370: 2e6d 3234 2a73 656c 662e 6d33 332a 7365  .m24*self.m33*se
+0001b380: 6c66 2e6d 3432 205c 0a20 2020 2020 2020  lf.m42 \.       
+0001b390: 2020 2020 2020 2020 2d73 656c 662e 6d31          -self.m1
+0001b3a0: 322a 7365 6c66 2e6d 3233 2a73 656c 662e  2*self.m23*self.
+0001b3b0: 6d33 342a 7365 6c66 2e6d 3431 205c 0a20  m34*self.m41 \. 
+0001b3c0: 2020 2020 2020 2020 2020 2020 2020 2b73                +s
+0001b3d0: 656c 662e 6d31 322a 7365 6c66 2e6d 3233  elf.m12*self.m23
+0001b3e0: 2a73 656c 662e 6d33 312a 7365 6c66 2e6d  *self.m31*self.m
+0001b3f0: 3434 205c 0a20 2020 2020 2020 2020 2020  44 \.           
+0001b400: 2020 2020 2d73 656c 662e 6d31 322a 7365      -self.m12*se
+0001b410: 6c66 2e6d 3234 2a73 656c 662e 6d33 312a  lf.m24*self.m31*
+0001b420: 7365 6c66 2e6d 3433 205c 0a20 2020 2020  self.m43 \.     
+0001b430: 2020 2020 2020 2020 2020 2b73 656c 662e            +self.
+0001b440: 6d31 322a 7365 6c66 2e6d 3234 2a73 656c  m12*self.m24*sel
+0001b450: 662e 6d33 332a 7365 6c66 2e6d 3431 205c  f.m33*self.m41 \
+0001b460: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001b470: 2d73 656c 662e 6d31 322a 7365 6c66 2e6d  -self.m12*self.m
+0001b480: 3231 2a73 656c 662e 6d33 332a 7365 6c66  21*self.m33*self
+0001b490: 2e6d 3434 205c 0a20 2020 2020 2020 2020  .m44 \.         
+0001b4a0: 2020 2020 2020 2b73 656c 662e 6d31 322a        +self.m12*
+0001b4b0: 7365 6c66 2e6d 3231 2a73 656c 662e 6d33  self.m21*self.m3
+0001b4c0: 342a 7365 6c66 2e6d 3433 205c 0a20 2020  4*self.m43 \.   
+0001b4d0: 2020 2020 2020 2020 2020 2020 2b73 656c              +sel
+0001b4e0: 662e 6d31 332a 7365 6c66 2e6d 3234 2a73  f.m13*self.m24*s
+0001b4f0: 656c 662e 6d33 312a 7365 6c66 2e6d 3432  elf.m31*self.m42
+0001b500: 205c 0a20 2020 2020 2020 2020 2020 2020   \.             
+0001b510: 2020 2d73 656c 662e 6d31 332a 7365 6c66    -self.m13*self
+0001b520: 2e6d 3234 2a73 656c 662e 6d33 322a 7365  .m24*self.m32*se
+0001b530: 6c66 2e6d 3431 205c 0a20 2020 2020 2020  lf.m41 \.       
+0001b540: 2020 2020 2020 2020 2b73 656c 662e 6d31          +self.m1
+0001b550: 332a 7365 6c66 2e6d 3231 2a73 656c 662e  3*self.m21*self.
+0001b560: 6d33 322a 7365 6c66 2e6d 3434 205c 0a20  m32*self.m44 \. 
+0001b570: 2020 2020 2020 2020 2020 2020 2020 2d73                -s
+0001b580: 656c 662e 6d31 332a 7365 6c66 2e6d 3231  elf.m13*self.m21
+0001b590: 2a73 656c 662e 6d33 342a 7365 6c66 2e6d  *self.m34*self.m
+0001b5a0: 3432 205c 0a20 2020 2020 2020 2020 2020  42 \.           
+0001b5b0: 2020 2020 2b73 656c 662e 6d31 332a 7365      +self.m13*se
+0001b5c0: 6c66 2e6d 3232 2a73 656c 662e 6d33 342a  lf.m22*self.m34*
+0001b5d0: 7365 6c66 2e6d 3431 205c 0a20 2020 2020  self.m41 \.     
+0001b5e0: 2020 2020 2020 2020 2020 2d73 656c 662e            -self.
+0001b5f0: 6d31 332a 7365 6c66 2e6d 3232 2a73 656c  m13*self.m22*sel
+0001b600: 662e 6d33 312a 7365 6c66 2e6d 3434 205c  f.m31*self.m44 \
+0001b610: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001b620: 2d73 656c 662e 6d31 342a 7365 6c66 2e6d  -self.m14*self.m
+0001b630: 3231 2a73 656c 662e 6d33 322a 7365 6c66  21*self.m32*self
+0001b640: 2e6d 3433 205c 0a20 2020 2020 2020 2020  .m43 \.         
+0001b650: 2020 2020 2020 2b73 656c 662e 6d31 342a        +self.m14*
+0001b660: 7365 6c66 2e6d 3231 2a73 656c 662e 6d33  self.m21*self.m3
+0001b670: 332a 7365 6c66 2e6d 3432 205c 0a20 2020  3*self.m42 \.   
+0001b680: 2020 2020 2020 2020 2020 2020 2d73 656c              -sel
+0001b690: 662e 6d31 342a 7365 6c66 2e6d 3232 2a73  f.m14*self.m22*s
+0001b6a0: 656c 662e 6d33 332a 7365 6c66 2e6d 3431  elf.m33*self.m41
+0001b6b0: 205c 0a20 2020 2020 2020 2020 2020 2020   \.             
+0001b6c0: 2020 2b73 656c 662e 6d31 342a 7365 6c66    +self.m14*self
+0001b6d0: 2e6d 3232 2a73 656c 662e 6d33 312a 7365  .m22*self.m31*se
+0001b6e0: 6c66 2e6d 3433 205c 0a20 2020 2020 2020  lf.m43 \.       
+0001b6f0: 2020 2020 2020 2020 2d73 656c 662e 6d31          -self.m1
+0001b700: 342a 7365 6c66 2e6d 3233 2a73 656c 662e  4*self.m23*self.
+0001b710: 6d33 312a 7365 6c66 2e6d 3432 205c 0a20  m31*self.m42 \. 
+0001b720: 2020 2020 2020 2020 2020 2020 2020 2b73                +s
+0001b730: 656c 662e 6d31 342a 7365 6c66 2e6d 3233  elf.m14*self.m23
+0001b740: 2a73 656c 662e 6d33 322a 7365 6c66 2e6d  *self.m32*self.m
+0001b750: 3431 0a0a 2020 2020 6465 6620 5f73 7562  41..    def _sub
+0001b760: 6d61 7428 7365 6c66 2c20 6d61 7433 204d  mat(self, mat3 M
+0001b770: 332c 2069 2c6a 293a 0a20 2020 2020 2020  3, i,j):.       
+0001b780: 2063 6465 6620 696e 7420 6b2c 6c0a 2020   cdef int k,l.  
+0001b790: 2020 2020 2020 6364 6566 2064 6f75 626c        cdef doubl
+0001b7a0: 6520 760a 0a23 2020 2020 2020 2020 4d3d  e v..#        M=
+0001b7b0: 6d61 7433 2829 0a20 2020 2020 2020 206b  mat3().        k
+0001b7c0: 3d30 0a20 2020 2020 2020 2077 6869 6c65  =0.        while
+0001b7d0: 206b 3c33 3a0a 2020 2020 2020 2020 2020   k<3:.          
+0001b7e0: 2020 6c3d 300a 2020 2020 2020 2020 2020    l=0.          
+0001b7f0: 2020 7768 696c 6520 6c3c 333a 0a20 2020    while l<3:.   
+0001b800: 2020 2020 2020 2020 2020 2020 2074 3d28               t=(
+0001b810: 6b2c 6c29 0a20 2020 2020 2020 2020 2020  k,l).           
+0001b820: 2020 2020 2069 6620 6b3e 3d69 3a0a 2020       if k>=i:.  
+0001b830: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b840: 2020 743d 286b 2b31 2c74 5b31 5d29 0a20    t=(k+1,t[1]). 
+0001b850: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0001b860: 6620 6c3e 3d6a 3a0a 2020 2020 2020 2020  f l>=j:.        
+0001b870: 2020 2020 2020 2020 2020 2020 743d 2874              t=(t
+0001b880: 5b30 5d2c 6c2b 3129 0a0a 2320 2020 2020  [0],l+1)..#     
+0001b890: 2020 2020 2020 2020 2020 204d 335b 6b2c             M3[k,
+0001b8a0: 6c5d 203d 2073 656c 665b 745d 0a20 2020  l] = self[t].   
+0001b8b0: 2020 2020 2020 2020 2020 2020 2076 203d               v =
+0001b8c0: 2073 656c 665b 745d 0a20 2020 2020 2020   self[t].       
+0001b8d0: 2020 2020 2020 2020 2069 6620 6b3d 3d30           if k==0
+0001b8e0: 2061 6e64 206c 3d3d 303a 0a20 2020 2020   and l==0:.     
+0001b8f0: 2020 2020 2020 2020 2020 2020 2020 204d                 M
+0001b900: 332e 6d31 3120 3d20 760a 2020 2020 2020  3.m11 = v.      
+0001b910: 2020 2020 2020 2020 2020 6966 206b 3d3d            if k==
+0001b920: 3020 616e 6420 6c3d 3d31 3a0a 2020 2020  0 and l==1:.    
+0001b930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b940: 4d33 2e6d 3132 203d 2076 0a20 2020 2020  M3.m12 = v.     
+0001b950: 2020 2020 2020 2020 2020 2069 6620 6b3d             if k=
+0001b960: 3d30 2061 6e64 206c 3d3d 323a 0a20 2020  =0 and l==2:.   
+0001b970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b980: 204d 332e 6d31 3320 3d20 760a 2020 2020   M3.m13 = v.    
+0001b990: 2020 2020 2020 2020 2020 2020 6966 206b              if k
+0001b9a0: 3d3d 3120 616e 6420 6c3d 3d30 3a0a 2020  ==1 and l==0:.  
+0001b9b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b9c0: 2020 4d33 2e6d 3231 203d 2076 0a20 2020    M3.m21 = v.   
+0001b9d0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+0001b9e0: 6b3d 3d31 2061 6e64 206c 3d3d 313a 0a20  k==1 and l==1:. 
+0001b9f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ba00: 2020 204d 332e 6d32 3220 3d20 760a 2020     M3.m22 = v.  
+0001ba10: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0001ba20: 206b 3d3d 3120 616e 6420 6c3d 3d32 3a0a   k==1 and l==2:.
+0001ba30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ba40: 2020 2020 4d33 2e6d 3233 203d 2076 0a20      M3.m23 = v. 
+0001ba50: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0001ba60: 6620 6b3d 3d32 2061 6e64 206c 3d3d 303a  f k==2 and l==0:
+0001ba70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001ba80: 2020 2020 204d 332e 6d33 3120 3d20 760a       M3.m31 = v.
+0001ba90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001baa0: 6966 206b 3d3d 3220 616e 6420 6c3d 3d31  if k==2 and l==1
+0001bab0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0001bac0: 2020 2020 2020 4d33 2e6d 3332 203d 2076        M3.m32 = v
+0001bad0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001bae0: 2069 6620 6b3d 3d32 2061 6e64 206c 3d3d   if k==2 and l==
+0001baf0: 323a 0a20 2020 2020 2020 2020 2020 2020  2:.             
+0001bb00: 2020 2020 2020 204d 332e 6d33 3320 3d20         M3.m33 = 
+0001bb10: 760a 0a20 2020 2020 2020 2020 2020 2020  v..             
+0001bb20: 2020 206c 3d6c 2b31 0a20 2020 2020 2020     l=l+1.       
+0001bb30: 2020 2020 206b 3d6b 2b31 0a20 2020 2020       k=k+1.     
+0001bb40: 2020 2072 6574 7572 6e20 4d33 0a0a 2020     return M3..  
+0001bb50: 2020 6465 6620 696e 7665 7273 6528 7365    def inverse(se
+0001bb60: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
+0001bb70: 5265 7475 726e 2069 6e76 6572 7365 206d  Return inverse m
+0001bb80: 6174 7269 782e 0a0a 2020 2020 2020 2020  atrix...        
+0001bb90: 3e3e 3e20 4d3d 6d61 7434 2830 2c2d 322e  >>> M=mat4(0,-2.
+0001bba0: 302c 302c 302c 2032 2e30 2c30 2c30 2c30  0,0,0, 2.0,0,0,0
+0001bbb0: 2c20 302c 302c 322c 302c 2030 2c30 2c30  , 0,0,2,0, 0,0,0
+0001bbc0: 2c32 290a 2020 2020 2020 2020 3e3e 3e20  ,2).        >>> 
+0001bbd0: 7072 696e 7428 4d2e 696e 7665 7273 6528  print(M.inverse(
+0001bbe0: 2929 0a20 2020 2020 2020 205b 2020 2030  )).        [   0
+0001bbf0: 2e30 3030 302c 2020 2020 302e 3530 3030  .0000,    0.5000
+0001bc00: 2c20 2020 2030 2e30 3030 302c 2020 2020  ,    0.0000,    
+0001bc10: 302e 3030 3030 5d0a 2020 2020 2020 2020  0.0000].        
+0001bc20: 5b20 202d 302e 3530 3030 2c20 2020 2030  [  -0.5000,    0
+0001bc30: 2e30 3030 302c 2020 2020 302e 3030 3030  .0000,    0.0000
+0001bc40: 2c20 2020 2030 2e30 3030 305d 0a20 2020  ,    0.0000].   
+0001bc50: 2020 2020 205b 2020 2030 2e30 3030 302c       [   0.0000,
+0001bc60: 2020 2020 302e 3030 3030 2c20 2020 2030      0.0000,    0
+0001bc70: 2e35 3030 302c 2020 2020 302e 3030 3030  .5000,    0.0000
+0001bc80: 5d0a 2020 2020 2020 2020 5b20 2020 302e  ].        [   0.
+0001bc90: 3030 3030 2c20 2020 2030 2e30 3030 302c  0000,    0.0000,
+0001bca0: 2020 2020 302e 3030 3030 2c20 2020 2030      0.0000,    0
+0001bcb0: 2e35 3030 305d 0a20 2020 2020 2020 2022  .5000].        "
+0001bcc0: 2222 0a20 2020 2020 2020 2063 6465 6620  "".        cdef 
+0001bcd0: 6d61 7434 2072 6573 0a20 2020 2020 2020  mat4 res.       
+0001bce0: 2063 6465 6620 7368 6f72 7420 692c 6a2c   cdef short i,j,
+0001bcf0: 2073 6967 6e0a 2020 2020 2020 2020 6364   sign.        cd
+0001bd00: 6566 2064 6f75 626c 6520 6d34 5b31 365d  ef double m4[16]
+0001bd10: 0a20 2020 2020 2020 2063 6465 6620 646f  .        cdef do
+0001bd20: 7562 6c65 206d 345f 7265 735b 3136 5d0a  uble m4_res[16].
+0001bd30: 2020 2020 2020 2020 6364 6566 2064 6f75          cdef dou
+0001bd40: 626c 6520 6465 742c 2064 0a0a 2020 2020  ble det, d..    
+0001bd50: 2020 2020 6d34 5b30 5d20 3d20 7365 6c66      m4[0] = self
+0001bd60: 2e6d 3131 0a20 2020 2020 2020 206d 345b  .m11.        m4[
+0001bd70: 315d 203d 2073 656c 662e 6d31 320a 2020  1] = self.m12.  
+0001bd80: 2020 2020 2020 6d34 5b32 5d20 3d20 7365        m4[2] = se
+0001bd90: 6c66 2e6d 3133 0a20 2020 2020 2020 206d  lf.m13.        m
+0001bda0: 345b 335d 203d 2073 656c 662e 6d31 340a  4[3] = self.m14.
+0001bdb0: 2020 2020 2020 2020 6d34 5b34 5d20 3d20          m4[4] = 
+0001bdc0: 7365 6c66 2e6d 3231 0a20 2020 2020 2020  self.m21.       
+0001bdd0: 206d 345b 355d 203d 2073 656c 662e 6d32   m4[5] = self.m2
+0001bde0: 320a 2020 2020 2020 2020 6d34 5b36 5d20  2.        m4[6] 
+0001bdf0: 3d20 7365 6c66 2e6d 3233 0a20 2020 2020  = self.m23.     
+0001be00: 2020 206d 345b 375d 203d 2073 656c 662e     m4[7] = self.
+0001be10: 6d32 340a 2020 2020 2020 2020 6d34 5b38  m24.        m4[8
+0001be20: 5d20 3d20 7365 6c66 2e6d 3331 0a20 2020  ] = self.m31.   
+0001be30: 2020 2020 206d 345b 395d 203d 2073 656c       m4[9] = sel
+0001be40: 662e 6d33 320a 2020 2020 2020 2020 6d34  f.m32.        m4
+0001be50: 5b31 305d 203d 2073 656c 662e 6d33 330a  [10] = self.m33.
+0001be60: 2020 2020 2020 2020 6d34 5b31 315d 203d          m4[11] =
+0001be70: 2073 656c 662e 6d33 340a 2020 2020 2020   self.m34.      
+0001be80: 2020 6d34 5b31 325d 203d 2073 656c 662e    m4[12] = self.
+0001be90: 6d34 310a 2020 2020 2020 2020 6d34 5b31  m41.        m4[1
+0001bea0: 335d 203d 2073 656c 662e 6d34 320a 2020  3] = self.m42.  
+0001beb0: 2020 2020 2020 6d34 5b31 345d 203d 2073        m4[14] = s
+0001bec0: 656c 662e 6d34 330a 2020 2020 2020 2020  elf.m43.        
+0001bed0: 6d34 5b31 355d 203d 2073 656c 662e 6d34  m4[15] = self.m4
+0001bee0: 340a 0a20 2020 2020 2020 2064 6574 3d73  4..        det=s
+0001bef0: 656c 662e 6465 7465 726d 696e 616e 7428  elf.determinant(
+0001bf00: 290a 2020 2020 2020 2020 6966 2066 6162  ).        if fab
+0001bf10: 7328 6465 7429 3c3d 6570 733a 0a20 2020  s(det)<=eps:.   
+0001bf20: 2020 2020 2020 2020 2072 6169 7365 205a           raise Z
+0001bf30: 6572 6f44 6976 6973 696f 6e45 7272 6f72  eroDivisionError
+0001bf40: 2c22 6d61 7472 6978 206e 6f74 2069 6e76  ,"matrix not inv
+0001bf50: 6572 7469 626c 6522 0a0a 2020 2020 2020  ertible"..      
+0001bf60: 2020 693d 300a 2020 2020 2020 2020 7768    i=0.        wh
+0001bf70: 696c 6520 693c 343a 0a20 2020 2020 2020  ile i<4:.       
+0001bf80: 2020 2020 206a 3d30 0a20 2020 2020 2020       j=0.       
+0001bf90: 2020 2020 2077 6869 6c65 206a 3c34 3a0a       while j<4:.
+0001bfa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bfb0: 7369 676e 3d31 2d28 2869 2b6a 2925 3229  sign=1-((i+j)%2)
+0001bfc0: 2a32 0a20 2020 2020 2020 2020 2020 2020  *2.             
+0001bfd0: 2020 2064 203d 205f 7375 6264 6574 286d     d = _subdet(m
+0001bfe0: 342c 692c 6a29 0a20 2020 2020 2020 2020  4,i,j).         
+0001bff0: 2020 2020 2020 206d 345f 7265 735b 6a2a         m4_res[j*
+0001c000: 342b 695d 3d73 6967 6e2a 642f 6465 740a  4+i]=sign*d/det.
+0001c010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c020: 6a3d 6a2b 310a 2020 2020 2020 2020 2020  j=j+1.          
+0001c030: 2020 693d 692b 310a 0a20 2020 2020 2020    i=i+1..       
+0001c040: 2072 6573 203d 206d 6174 3428 290a 2020   res = mat4().  
+0001c050: 2020 2020 2020 7265 732e 6d31 3120 3d20        res.m11 = 
+0001c060: 6d34 5f72 6573 5b30 5d0a 2020 2020 2020  m4_res[0].      
+0001c070: 2020 7265 732e 6d31 3220 3d20 6d34 5f72    res.m12 = m4_r
+0001c080: 6573 5b31 5d0a 2020 2020 2020 2020 7265  es[1].        re
+0001c090: 732e 6d31 3320 3d20 6d34 5f72 6573 5b32  s.m13 = m4_res[2
+0001c0a0: 5d0a 2020 2020 2020 2020 7265 732e 6d31  ].        res.m1
+0001c0b0: 3420 3d20 6d34 5f72 6573 5b33 5d0a 2020  4 = m4_res[3].  
+0001c0c0: 2020 2020 2020 7265 732e 6d32 3120 3d20        res.m21 = 
+0001c0d0: 6d34 5f72 6573 5b34 5d0a 2020 2020 2020  m4_res[4].      
+0001c0e0: 2020 7265 732e 6d32 3220 3d20 6d34 5f72    res.m22 = m4_r
+0001c0f0: 6573 5b35 5d0a 2020 2020 2020 2020 7265  es[5].        re
+0001c100: 732e 6d32 3320 3d20 6d34 5f72 6573 5b36  s.m23 = m4_res[6
+0001c110: 5d0a 2020 2020 2020 2020 7265 732e 6d32  ].        res.m2
+0001c120: 3420 3d20 6d34 5f72 6573 5b37 5d0a 2020  4 = m4_res[7].  
+0001c130: 2020 2020 2020 7265 732e 6d33 3120 3d20        res.m31 = 
+0001c140: 6d34 5f72 6573 5b38 5d0a 2020 2020 2020  m4_res[8].      
+0001c150: 2020 7265 732e 6d33 3220 3d20 6d34 5f72    res.m32 = m4_r
+0001c160: 6573 5b39 5d0a 2020 2020 2020 2020 7265  es[9].        re
+0001c170: 732e 6d33 3320 3d20 6d34 5f72 6573 5b31  s.m33 = m4_res[1
+0001c180: 305d 0a20 2020 2020 2020 2072 6573 2e6d  0].        res.m
+0001c190: 3334 203d 206d 345f 7265 735b 3131 5d0a  34 = m4_res[11].
+0001c1a0: 2020 2020 2020 2020 7265 732e 6d34 3120          res.m41 
+0001c1b0: 3d20 6d34 5f72 6573 5b31 325d 0a20 2020  = m4_res[12].   
+0001c1c0: 2020 2020 2072 6573 2e6d 3432 203d 206d       res.m42 = m
+0001c1d0: 345f 7265 735b 3133 5d0a 2020 2020 2020  4_res[13].      
+0001c1e0: 2020 7265 732e 6d34 3320 3d20 6d34 5f72    res.m43 = m4_r
+0001c1f0: 6573 5b31 345d 0a20 2020 2020 2020 2072  es[14].        r
+0001c200: 6573 2e6d 3434 203d 206d 345f 7265 735b  es.m44 = m4_res[
+0001c210: 3135 5d0a 2020 2020 2020 2020 7265 7475  15].        retu
+0001c220: 726e 2072 6573 0a0a 0a20 2020 2064 6566  rn res...    def
+0001c230: 2074 7261 6e73 6c61 7469 6f6e 2873 656c   translation(sel
+0001c240: 662c 2074 293a 0a20 2020 2020 2020 2022  f, t):.        "
+0001c250: 2222 5265 7475 726e 2074 7261 6e73 6c61  ""Return transla
+0001c260: 7469 6f6e 206d 6174 7269 782e 0a0a 2020  tion matrix...  
+0001c270: 2020 2020 2020 7420 6d75 7374 2062 6520        t must be 
+0001c280: 6120 332d 7365 7175 656e 6365 2028 652e  a 3-sequence (e.
+0001c290: 672e 2061 2076 6563 3329 2e0a 2020 2020  g. a vec3)..    
+0001c2a0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0001c2b0: 6364 6566 206d 6174 3420 7265 730a 2020  cdef mat4 res.  
+0001c2c0: 2020 2020 2020 7265 7320 3d20 6d61 7434        res = mat4
+0001c2d0: 2829 0a20 2020 2020 2020 2072 6573 2e6d  ().        res.m
+0001c2e0: 3131 203d 2031 2e30 0a20 2020 2020 2020  11 = 1.0.       
+0001c2f0: 2072 6573 2e6d 3132 203d 2030 2e30 0a20   res.m12 = 0.0. 
+0001c300: 2020 2020 2020 2072 6573 2e6d 3133 203d         res.m13 =
+0001c310: 2030 2e30 0a20 2020 2020 2020 2072 6573   0.0.        res
+0001c320: 2e6d 3134 203d 2074 5b30 5d0a 2020 2020  .m14 = t[0].    
+0001c330: 2020 2020 7265 732e 6d32 3120 3d20 302e      res.m21 = 0.
+0001c340: 300a 2020 2020 2020 2020 7265 732e 6d32  0.        res.m2
+0001c350: 3220 3d20 312e 300a 2020 2020 2020 2020  2 = 1.0.        
+0001c360: 7265 732e 6d32 3320 3d20 302e 300a 2020  res.m23 = 0.0.  
+0001c370: 2020 2020 2020 7265 732e 6d32 3420 3d20        res.m24 = 
+0001c380: 745b 315d 0a20 2020 2020 2020 2072 6573  t[1].        res
+0001c390: 2e6d 3331 203d 2030 2e30 0a20 2020 2020  .m31 = 0.0.     
+0001c3a0: 2020 2072 6573 2e6d 3332 203d 2030 2e30     res.m32 = 0.0
+0001c3b0: 0a20 2020 2020 2020 2072 6573 2e6d 3333  .        res.m33
+0001c3c0: 203d 2031 2e30 0a20 2020 2020 2020 2072   = 1.0.        r
+0001c3d0: 6573 2e6d 3334 203d 2074 5b32 5d0a 2020  es.m34 = t[2].  
+0001c3e0: 2020 2020 2020 7265 732e 6d34 3120 3d20        res.m41 = 
+0001c3f0: 302e 300a 2020 2020 2020 2020 7265 732e  0.0.        res.
+0001c400: 6d34 3220 3d20 302e 300a 2020 2020 2020  m42 = 0.0.      
+0001c410: 2020 7265 732e 6d34 3320 3d20 302e 300a    res.m43 = 0.0.
+0001c420: 2020 2020 2020 2020 7265 732e 6d34 3420          res.m44 
+0001c430: 3d20 312e 300a 2020 2020 2020 2020 7265  = 1.0.        re
+0001c440: 7475 726e 2072 6573 0a0a 2020 2020 6465  turn res..    de
+0001c450: 6620 7363 616c 696e 6728 7365 6c66 2c20  f scaling(self, 
+0001c460: 7329 3a0a 2020 2020 2020 2020 2222 2252  s):.        """R
+0001c470: 6574 7572 6e20 7363 616c 696e 6720 6d61  eturn scaling ma
+0001c480: 7472 6978 2e0a 0a20 2020 2020 2020 2073  trix...        s
+0001c490: 206d 7573 7420 6265 2061 2033 2d73 6571   must be a 3-seq
+0001c4a0: 7565 6e63 6520 2865 2e67 2e20 6120 7665  uence (e.g. a ve
+0001c4b0: 6333 292e 0a20 2020 2020 2020 2022 2222  c3)..        """
+0001c4c0: 0a20 2020 2020 2020 2063 6465 6620 6d61  .        cdef ma
+0001c4d0: 7434 2072 6573 0a20 2020 2020 2020 2072  t4 res.        r
+0001c4e0: 6573 203d 206d 6174 3428 290a 2020 2020  es = mat4().    
+0001c4f0: 2020 2020 7265 732e 6d31 3120 3d20 735b      res.m11 = s[
+0001c500: 305d 0a20 2020 2020 2020 2072 6573 2e6d  0].        res.m
+0001c510: 3132 203d 2030 2e30 0a20 2020 2020 2020  12 = 0.0.       
+0001c520: 2072 6573 2e6d 3133 203d 2030 2e30 0a20   res.m13 = 0.0. 
+0001c530: 2020 2020 2020 2072 6573 2e6d 3134 203d         res.m14 =
+0001c540: 2030 2e30 0a20 2020 2020 2020 2072 6573   0.0.        res
+0001c550: 2e6d 3231 203d 2030 2e30 0a20 2020 2020  .m21 = 0.0.     
+0001c560: 2020 2072 6573 2e6d 3232 203d 2073 5b31     res.m22 = s[1
+0001c570: 5d0a 2020 2020 2020 2020 7265 732e 6d32  ].        res.m2
+0001c580: 3320 3d20 302e 300a 2020 2020 2020 2020  3 = 0.0.        
+0001c590: 7265 732e 6d32 3420 3d20 302e 300a 2020  res.m24 = 0.0.  
+0001c5a0: 2020 2020 2020 7265 732e 6d33 3120 3d20        res.m31 = 
+0001c5b0: 302e 300a 2020 2020 2020 2020 7265 732e  0.0.        res.
+0001c5c0: 6d33 3220 3d20 302e 300a 2020 2020 2020  m32 = 0.0.      
+0001c5d0: 2020 7265 732e 6d33 3320 3d20 735b 325d    res.m33 = s[2]
+0001c5e0: 0a20 2020 2020 2020 2072 6573 2e6d 3334  .        res.m34
+0001c5f0: 203d 2030 2e30 0a20 2020 2020 2020 2072   = 0.0.        r
+0001c600: 6573 2e6d 3431 203d 2030 2e30 0a20 2020  es.m41 = 0.0.   
+0001c610: 2020 2020 2072 6573 2e6d 3432 203d 2030       res.m42 = 0
+0001c620: 2e30 0a20 2020 2020 2020 2072 6573 2e6d  .0.        res.m
+0001c630: 3433 203d 2030 2e30 0a20 2020 2020 2020  43 = 0.0.       
+0001c640: 2072 6573 2e6d 3434 203d 2031 2e30 0a20   res.m44 = 1.0. 
+0001c650: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
+0001c660: 730a 0a20 2020 2064 6566 2072 6f74 6174  s..    def rotat
+0001c670: 696f 6e28 7365 6c66 2c20 616e 676c 652c  ion(self, angle,
+0001c680: 2061 7869 7329 3a0a 2020 2020 2020 2020   axis):.        
+0001c690: 2222 2252 6574 7572 6e20 726f 7461 7469  """Return rotati
+0001c6a0: 6f6e 206d 6174 7269 782e 0a0a 2020 2020  on matrix...    
+0001c6b0: 2020 2020 616e 676c 6520 6d75 7374 2062      angle must b
+0001c6c0: 6520 6769 7665 6e20 696e 2072 6164 6961  e given in radia
+0001c6d0: 6e73 2e20 6178 6973 206d 7573 7420 6265  ns. axis must be
+0001c6e0: 2061 2033 2d73 6571 7565 6e63 652e 0a20   a 3-sequence.. 
+0001c6f0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0001c700: 2020 2063 6465 6620 646f 7562 6c65 2063     cdef double c
+0001c710: 616e 676c 652c 2061 782c 2061 792c 2061  angle, ax, ay, a
+0001c720: 7a0a 2020 2020 2020 2020 6364 6566 2064  z.        cdef d
+0001c730: 6f75 626c 6520 7371 725f 612c 2073 7172  ouble sqr_a, sqr
+0001c740: 5f62 2c20 7371 725f 632c 206c 656e 320a  _b, sqr_c, len2.
+0001c750: 2020 2020 2020 2020 6364 6566 2064 6f75          cdef dou
+0001c760: 626c 6520 6b31 2c20 6b32 2c20 6b33 2c20  ble k1, k2, k3, 
+0001c770: 6b31 6162 2c20 6b31 6163 2c20 6b31 6263  k1ab, k1ac, k1bc
+0001c780: 2c20 6b33 612c 206b 3362 2c20 6b33 630a  , k3a, k3b, k3c.
+0001c790: 2020 2020 2020 2020 6364 6566 206d 6174          cdef mat
+0001c7a0: 3420 7265 730a 0a20 2020 2020 2020 2063  4 res..        c
+0001c7b0: 616e 676c 6520 2020 3d20 616e 676c 650a  angle   = angle.
+0001c7c0: 2020 2020 2020 2020 6178 2020 2020 3d20          ax    = 
+0001c7d0: 6178 6973 5b30 5d0a 2020 2020 2020 2020  axis[0].        
+0001c7e0: 6179 2020 2020 3d20 6178 6973 5b31 5d0a  ay    = axis[1].
+0001c7f0: 2020 2020 2020 2020 617a 2020 2020 3d20          az    = 
+0001c800: 6178 6973 5b32 5d0a 2020 2020 2020 2020  axis[2].        
+0001c810: 7371 725f 6120 3d20 6178 2a61 780a 2020  sqr_a = ax*ax.  
+0001c820: 2020 2020 2020 7371 725f 6220 3d20 6179        sqr_b = ay
+0001c830: 2a61 790a 2020 2020 2020 2020 7371 725f  *ay.        sqr_
+0001c840: 6320 3d20 617a 2a61 7a0a 2020 2020 2020  c = az*az.      
+0001c850: 2020 6c65 6e32 2020 3d20 7371 725f 612b    len2  = sqr_a+
+0001c860: 7371 725f 622b 7371 725f 630a 0a20 2020  sqr_b+sqr_c..   
+0001c870: 2020 2020 206b 3220 2020 203d 2063 6f73       k2    = cos
+0001c880: 2863 616e 676c 6529 0a20 2020 2020 2020  (cangle).       
+0001c890: 206b 3120 2020 203d 2028 312e 302d 6b32   k1    = (1.0-k2
+0001c8a0: 292f 6c65 6e32 0a20 2020 2020 2020 206b  )/len2.        k
+0001c8b0: 3320 2020 203d 2073 696e 2863 616e 676c  3    = sin(cangl
+0001c8c0: 6529 2f73 7172 7428 6c65 6e32 290a 2020  e)/sqrt(len2).  
+0001c8d0: 2020 2020 2020 6b31 6162 2020 3d20 6b31        k1ab  = k1
+0001c8e0: 2a61 782a 6179 0a20 2020 2020 2020 206b  *ax*ay.        k
+0001c8f0: 3161 6320 203d 206b 312a 6178 2a61 7a0a  1ac  = k1*ax*az.
+0001c900: 2020 2020 2020 2020 6b31 6263 2020 3d20          k1bc  = 
+0001c910: 6b31 2a61 792a 617a 0a20 2020 2020 2020  k1*ay*az.       
+0001c920: 206b 3361 2020 203d 206b 332a 6178 0a20   k3a   = k3*ax. 
+0001c930: 2020 2020 2020 206b 3362 2020 203d 206b         k3b   = k
+0001c940: 332a 6179 0a20 2020 2020 2020 206b 3363  3*ay.        k3c
+0001c950: 2020 203d 206b 332a 617a 0a0a 2020 2020     = k3*az..    
+0001c960: 2020 2020 7265 7320 3d20 6d61 7434 2829      res = mat4()
+0001c970: 0a20 2020 2020 2020 2072 6573 2e6d 3131  .        res.m11
+0001c980: 203d 206b 312a 7371 725f 612b 6b32 0a20   = k1*sqr_a+k2. 
+0001c990: 2020 2020 2020 2072 6573 2e6d 3132 203d         res.m12 =
+0001c9a0: 206b 3161 622d 6b33 630a 2020 2020 2020   k1ab-k3c.      
+0001c9b0: 2020 7265 732e 6d31 3320 3d20 6b31 6163    res.m13 = k1ac
+0001c9c0: 2b6b 3362 0a20 2020 2020 2020 2072 6573  +k3b.        res
+0001c9d0: 2e6d 3134 203d 2030 2e30 0a20 2020 2020  .m14 = 0.0.     
+0001c9e0: 2020 2072 6573 2e6d 3231 203d 206b 3161     res.m21 = k1a
+0001c9f0: 622b 6b33 630a 2020 2020 2020 2020 7265  b+k3c.        re
+0001ca00: 732e 6d32 3220 3d20 6b31 2a73 7172 5f62  s.m22 = k1*sqr_b
+0001ca10: 2b6b 320a 2020 2020 2020 2020 7265 732e  +k2.        res.
+0001ca20: 6d32 3320 3d20 6b31 6263 2d6b 3361 0a20  m23 = k1bc-k3a. 
+0001ca30: 2020 2020 2020 2072 6573 2e6d 3234 203d         res.m24 =
+0001ca40: 2030 2e30 0a20 2020 2020 2020 2072 6573   0.0.        res
+0001ca50: 2e6d 3331 203d 206b 3161 632d 6b33 620a  .m31 = k1ac-k3b.
+0001ca60: 2020 2020 2020 2020 7265 732e 6d33 3220          res.m32 
+0001ca70: 3d20 6b31 6263 2b6b 3361 0a20 2020 2020  = k1bc+k3a.     
+0001ca80: 2020 2072 6573 2e6d 3333 203d 206b 312a     res.m33 = k1*
+0001ca90: 7371 725f 632b 6b32 0a20 2020 2020 2020  sqr_c+k2.       
+0001caa0: 2072 6573 2e6d 3334 203d 2030 2e30 0a20   res.m34 = 0.0. 
+0001cab0: 2020 2020 2020 2072 6573 2e6d 3431 203d         res.m41 =
+0001cac0: 2030 2e30 0a20 2020 2020 2020 2072 6573   0.0.        res
+0001cad0: 2e6d 3432 203d 2030 2e30 0a20 2020 2020  .m42 = 0.0.     
+0001cae0: 2020 2072 6573 2e6d 3433 203d 2030 2e30     res.m43 = 0.0
+0001caf0: 0a20 2020 2020 2020 2072 6573 2e6d 3434  .        res.m44
+0001cb00: 203d 2031 2e30 0a20 2020 2020 2020 2072   = 1.0.        r
+0001cb10: 6574 7572 6e20 7265 730a 0a0a 2020 2020  eturn res...    
+0001cb20: 6465 6620 7472 616e 736c 6174 6528 7365  def translate(se
+0001cb30: 6c66 2c20 7429 3a0a 2020 2020 2020 2020  lf, t):.        
+0001cb40: 2222 2243 6f6e 6361 7465 6e61 7465 2061  """Concatenate a
+0001cb50: 2074 7261 6e73 6c61 7469 6f6e 2e0a 0a20   translation... 
+0001cb60: 2020 2020 2020 2074 206d 7573 7420 6265         t must be
+0001cb70: 2061 2033 2d73 6571 7565 6e63 6520 2865   a 3-sequence (e
+0001cb80: 2e67 2e20 6120 7665 6333 292e 0a20 2020  .g. a vec3)..   
+0001cb90: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0001cba0: 2063 6465 6620 646f 7562 6c65 2074 782c   cdef double tx,
+0001cbb0: 2074 792c 2074 7a0a 2020 2020 2020 2020   ty, tz.        
+0001cbc0: 7478 203d 2074 5b30 5d0a 2020 2020 2020  tx = t[0].      
+0001cbd0: 2020 7479 203d 2074 5b31 5d0a 2020 2020    ty = t[1].    
+0001cbe0: 2020 2020 747a 203d 2074 5b32 5d0a 0a20      tz = t[2].. 
+0001cbf0: 2020 2020 2020 2073 656c 662e 6d31 3420         self.m14 
+0001cc00: 3d20 7365 6c66 2e6d 3131 2a74 7820 2b20  = self.m11*tx + 
+0001cc10: 7365 6c66 2e6d 3132 2a74 7920 2b20 7365  self.m12*ty + se
+0001cc20: 6c66 2e6d 3133 2a74 7a20 2b20 7365 6c66  lf.m13*tz + self
+0001cc30: 2e6d 3134 0a20 2020 2020 2020 2073 656c  .m14.        sel
+0001cc40: 662e 6d32 3420 3d20 7365 6c66 2e6d 3231  f.m24 = self.m21
+0001cc50: 2a74 7820 2b20 7365 6c66 2e6d 3232 2a74  *tx + self.m22*t
+0001cc60: 7920 2b20 7365 6c66 2e6d 3233 2a74 7a20  y + self.m23*tz 
+0001cc70: 2b20 7365 6c66 2e6d 3234 0a20 2020 2020  + self.m24.     
+0001cc80: 2020 2073 656c 662e 6d33 3420 3d20 7365     self.m34 = se
+0001cc90: 6c66 2e6d 3331 2a74 7820 2b20 7365 6c66  lf.m31*tx + self
+0001cca0: 2e6d 3332 2a74 7920 2b20 7365 6c66 2e6d  .m32*ty + self.m
+0001ccb0: 3333 2a74 7a20 2b20 7365 6c66 2e6d 3334  33*tz + self.m34
+0001ccc0: 0a20 2020 2020 2020 2073 656c 662e 6d34  .        self.m4
+0001ccd0: 3420 3d20 7365 6c66 2e6d 3431 2a74 7820  4 = self.m41*tx 
+0001cce0: 2b20 7365 6c66 2e6d 3432 2a74 7920 2b20  + self.m42*ty + 
+0001ccf0: 7365 6c66 2e6d 3433 2a74 7a20 2b20 7365  self.m43*tz + se
+0001cd00: 6c66 2e6d 3434 0a20 2020 2020 2020 2072  lf.m44.        r
+0001cd10: 6574 7572 6e20 7365 6c66 0a0a 2020 2020  eturn self..    
+0001cd20: 6465 6620 7363 616c 6528 7365 6c66 2c20  def scale(self, 
+0001cd30: 7329 3a0a 2020 2020 2020 2020 2222 2243  s):.        """C
+0001cd40: 6f6e 6361 7465 6e61 7465 2061 2073 6361  oncatenate a sca
+0001cd50: 6c69 6e67 2e0a 0a20 2020 2020 2020 2073  ling...        s
+0001cd60: 206d 7573 7420 6265 2061 2033 2d73 6571   must be a 3-seq
+0001cd70: 7565 6e63 6520 2865 2e67 2e20 6120 7665  uence (e.g. a ve
+0001cd80: 6333 292e 0a20 2020 2020 2020 2022 2222  c3)..        """
+0001cd90: 0a20 2020 2020 2020 2063 6465 6620 646f  .        cdef do
+0001cda0: 7562 6c65 2073 782c 2073 792c 2073 7a0a  uble sx, sy, sz.
+0001cdb0: 2020 2020 2020 2020 7378 203d 2073 5b30          sx = s[0
+0001cdc0: 5d0a 2020 2020 2020 2020 7379 203d 2073  ].        sy = s
+0001cdd0: 5b31 5d0a 2020 2020 2020 2020 737a 203d  [1].        sz =
+0001cde0: 2073 5b32 5d0a 2020 2020 2020 2020 7365   s[2].        se
+0001cdf0: 6c66 2e6d 3131 203d 2073 656c 662e 6d31  lf.m11 = self.m1
+0001ce00: 312a 7378 0a20 2020 2020 2020 2073 656c  1*sx.        sel
+0001ce10: 662e 6d31 3220 3d20 7365 6c66 2e6d 3132  f.m12 = self.m12
+0001ce20: 2a73 790a 2020 2020 2020 2020 7365 6c66  *sy.        self
+0001ce30: 2e6d 3133 203d 2073 656c 662e 6d31 332a  .m13 = self.m13*
+0001ce40: 737a 0a20 2020 2020 2020 2073 656c 662e  sz.        self.
+0001ce50: 6d32 3120 3d20 7365 6c66 2e6d 3231 2a73  m21 = self.m21*s
+0001ce60: 780a 2020 2020 2020 2020 7365 6c66 2e6d  x.        self.m
+0001ce70: 3232 203d 2073 656c 662e 6d32 322a 7379  22 = self.m22*sy
+0001ce80: 0a20 2020 2020 2020 2073 656c 662e 6d32  .        self.m2
+0001ce90: 3320 3d20 7365 6c66 2e6d 3233 2a73 7a0a  3 = self.m23*sz.
+0001cea0: 2020 2020 2020 2020 7365 6c66 2e6d 3331          self.m31
+0001ceb0: 203d 2073 656c 662e 6d33 312a 7378 0a20   = self.m31*sx. 
+0001cec0: 2020 2020 2020 2073 656c 662e 6d33 3220         self.m32 
+0001ced0: 3d20 7365 6c66 2e6d 3332 2a73 790a 2020  = self.m32*sy.  
+0001cee0: 2020 2020 2020 7365 6c66 2e6d 3333 203d        self.m33 =
+0001cef0: 2073 656c 662e 6d33 332a 737a 0a20 2020   self.m33*sz.   
+0001cf00: 2020 2020 2073 656c 662e 6d34 3120 3d20       self.m41 = 
+0001cf10: 7365 6c66 2e6d 3431 2a73 780a 2020 2020  self.m41*sx.    
+0001cf20: 2020 2020 7365 6c66 2e6d 3432 203d 2073      self.m42 = s
+0001cf30: 656c 662e 6d34 322a 7379 0a20 2020 2020  elf.m42*sy.     
+0001cf40: 2020 2073 656c 662e 6d34 3320 3d20 7365     self.m43 = se
+0001cf50: 6c66 2e6d 3433 2a73 7a0a 2020 2020 2020  lf.m43*sz.      
+0001cf60: 2020 7265 7475 726e 2073 656c 660a 0a20    return self.. 
+0001cf70: 2020 2064 6566 2072 6f74 6174 6528 7365     def rotate(se
+0001cf80: 6c66 2c20 616e 676c 652c 2061 7869 7329  lf, angle, axis)
+0001cf90: 3a0a 2020 2020 2020 2020 2222 2243 6f6e  :.        """Con
+0001cfa0: 6361 7465 6e61 7465 2061 2072 6f74 6174  catenate a rotat
+0001cfb0: 696f 6e2e 0a0a 2020 2020 2020 2020 616e  ion...        an
+0001cfc0: 676c 6520 6d75 7374 2062 6520 6769 7665  gle must be give
+0001cfd0: 6e20 696e 2072 6164 6961 6e73 2e20 6178  n in radians. ax
+0001cfe0: 6973 206d 7573 7420 6265 2061 2033 2d73  is must be a 3-s
+0001cff0: 6571 7565 6e63 652e 0a20 2020 2020 2020  equence..       
+0001d000: 2022 2222 0a20 2020 2020 2020 2063 6465   """.        cde
+0001d010: 6620 6d61 7434 2052 0a20 2020 2020 2020  f mat4 R.       
+0001d020: 2063 6465 6620 646f 7562 6c65 2063 312c   cdef double c1,
+0001d030: 2063 322c 2063 332c 2063 340a 2020 2020   c2, c3, c4.    
+0001d040: 2020 2020 523d 7365 6c66 2e72 6f74 6174      R=self.rotat
+0001d050: 696f 6e28 616e 676c 652c 2061 7869 7329  ion(angle, axis)
+0001d060: 0a0a 2020 2020 2020 2020 2320 7365 6c66  ..        # self
+0001d070: 2a52 2020 2869 6e2d 706c 6163 6529 0a20  *R  (in-place). 
+0001d080: 2020 2020 2020 2063 3120 3d20 7365 6c66         c1 = self
+0001d090: 2e6d 3131 0a20 2020 2020 2020 2063 3220  .m11.        c2 
+0001d0a0: 3d20 7365 6c66 2e6d 3132 0a20 2020 2020  = self.m12.     
+0001d0b0: 2020 2063 3320 3d20 7365 6c66 2e6d 3133     c3 = self.m13
+0001d0c0: 0a20 2020 2020 2020 2063 3420 3d20 7365  .        c4 = se
+0001d0d0: 6c66 2e6d 3134 0a20 2020 2020 2020 2073  lf.m14.        s
+0001d0e0: 656c 662e 6d31 3120 3d20 6331 2a52 2e6d  elf.m11 = c1*R.m
+0001d0f0: 3131 2b63 322a 522e 6d32 312b 6333 2a52  11+c2*R.m21+c3*R
+0001d100: 2e6d 3331 2b63 342a 522e 6d34 310a 2020  .m31+c4*R.m41.  
+0001d110: 2020 2020 2020 7365 6c66 2e6d 3132 203d        self.m12 =
+0001d120: 2063 312a 522e 6d31 322b 6332 2a52 2e6d   c1*R.m12+c2*R.m
+0001d130: 3232 2b63 332a 522e 6d33 322b 6334 2a52  22+c3*R.m32+c4*R
+0001d140: 2e6d 3432 0a20 2020 2020 2020 2073 656c  .m42.        sel
+0001d150: 662e 6d31 3320 3d20 6331 2a52 2e6d 3133  f.m13 = c1*R.m13
+0001d160: 2b63 322a 522e 6d32 332b 6333 2a52 2e6d  +c2*R.m23+c3*R.m
+0001d170: 3333 2b63 342a 522e 6d34 330a 2020 2020  33+c4*R.m43.    
+0001d180: 2020 2020 7365 6c66 2e6d 3134 203d 2063      self.m14 = c
+0001d190: 312a 522e 6d31 342b 6332 2a52 2e6d 3234  1*R.m14+c2*R.m24
+0001d1a0: 2b63 332a 522e 6d33 342b 6334 2a52 2e6d  +c3*R.m34+c4*R.m
+0001d1b0: 3434 0a0a 2020 2020 2020 2020 6331 203d  44..        c1 =
+0001d1c0: 2073 656c 662e 6d32 310a 2020 2020 2020   self.m21.      
+0001d1d0: 2020 6332 203d 2073 656c 662e 6d32 320a    c2 = self.m22.
+0001d1e0: 2020 2020 2020 2020 6333 203d 2073 656c          c3 = sel
+0001d1f0: 662e 6d32 330a 2020 2020 2020 2020 6334  f.m23.        c4
+0001d200: 203d 2073 656c 662e 6d32 340a 2020 2020   = self.m24.    
+0001d210: 2020 2020 7365 6c66 2e6d 3231 203d 2063      self.m21 = c
+0001d220: 312a 522e 6d31 312b 6332 2a52 2e6d 3231  1*R.m11+c2*R.m21
+0001d230: 2b63 332a 522e 6d33 312b 6334 2a52 2e6d  +c3*R.m31+c4*R.m
+0001d240: 3431 0a20 2020 2020 2020 2073 656c 662e  41.        self.
+0001d250: 6d32 3220 3d20 6331 2a52 2e6d 3132 2b63  m22 = c1*R.m12+c
+0001d260: 322a 522e 6d32 322b 6333 2a52 2e6d 3332  2*R.m22+c3*R.m32
+0001d270: 2b63 342a 522e 6d34 320a 2020 2020 2020  +c4*R.m42.      
+0001d280: 2020 7365 6c66 2e6d 3233 203d 2063 312a    self.m23 = c1*
+0001d290: 522e 6d31 332b 6332 2a52 2e6d 3233 2b63  R.m13+c2*R.m23+c
+0001d2a0: 332a 522e 6d33 332b 6334 2a52 2e6d 3433  3*R.m33+c4*R.m43
+0001d2b0: 0a20 2020 2020 2020 2073 656c 662e 6d32  .        self.m2
+0001d2c0: 3420 3d20 6331 2a52 2e6d 3134 2b63 322a  4 = c1*R.m14+c2*
+0001d2d0: 522e 6d32 342b 6333 2a52 2e6d 3334 2b63  R.m24+c3*R.m34+c
+0001d2e0: 342a 522e 6d34 340a 0a20 2020 2020 2020  4*R.m44..       
+0001d2f0: 2063 3120 3d20 7365 6c66 2e6d 3331 0a20   c1 = self.m31. 
+0001d300: 2020 2020 2020 2063 3220 3d20 7365 6c66         c2 = self
+0001d310: 2e6d 3332 0a20 2020 2020 2020 2063 3320  .m32.        c3 
+0001d320: 3d20 7365 6c66 2e6d 3333 0a20 2020 2020  = self.m33.     
+0001d330: 2020 2063 3420 3d20 7365 6c66 2e6d 3334     c4 = self.m34
+0001d340: 0a20 2020 2020 2020 2073 656c 662e 6d33  .        self.m3
+0001d350: 3120 3d20 6331 2a52 2e6d 3131 2b63 322a  1 = c1*R.m11+c2*
+0001d360: 522e 6d32 312b 6333 2a52 2e6d 3331 2b63  R.m21+c3*R.m31+c
+0001d370: 342a 522e 6d34 310a 2020 2020 2020 2020  4*R.m41.        
+0001d380: 7365 6c66 2e6d 3332 203d 2063 312a 522e  self.m32 = c1*R.
+0001d390: 6d31 322b 6332 2a52 2e6d 3232 2b63 332a  m12+c2*R.m22+c3*
+0001d3a0: 522e 6d33 322b 6334 2a52 2e6d 3432 0a20  R.m32+c4*R.m42. 
+0001d3b0: 2020 2020 2020 2073 656c 662e 6d33 3320         self.m33 
+0001d3c0: 3d20 6331 2a52 2e6d 3133 2b63 322a 522e  = c1*R.m13+c2*R.
+0001d3d0: 6d32 332b 6333 2a52 2e6d 3333 2b63 342a  m23+c3*R.m33+c4*
+0001d3e0: 522e 6d34 330a 2020 2020 2020 2020 7365  R.m43.        se
+0001d3f0: 6c66 2e6d 3334 203d 2063 312a 522e 6d31  lf.m34 = c1*R.m1
+0001d400: 342b 6332 2a52 2e6d 3234 2b63 332a 522e  4+c2*R.m24+c3*R.
+0001d410: 6d33 342b 6334 2a52 2e6d 3434 0a0a 2020  m34+c4*R.m44..  
+0001d420: 2020 2020 2020 6331 203d 2073 656c 662e        c1 = self.
+0001d430: 6d34 310a 2020 2020 2020 2020 6332 203d  m41.        c2 =
+0001d440: 2073 656c 662e 6d34 320a 2020 2020 2020   self.m42.      
+0001d450: 2020 6333 203d 2073 656c 662e 6d34 330a    c3 = self.m43.
+0001d460: 2020 2020 2020 2020 6334 203d 2073 656c          c4 = sel
+0001d470: 662e 6d34 340a 2020 2020 2020 2020 7365  f.m44.        se
+0001d480: 6c66 2e6d 3431 203d 2063 312a 522e 6d31  lf.m41 = c1*R.m1
+0001d490: 312b 6332 2a52 2e6d 3231 2b63 332a 522e  1+c2*R.m21+c3*R.
+0001d4a0: 6d33 312b 6334 2a52 2e6d 3431 0a20 2020  m31+c4*R.m41.   
+0001d4b0: 2020 2020 2073 656c 662e 6d34 3220 3d20       self.m42 = 
+0001d4c0: 6331 2a52 2e6d 3132 2b63 322a 522e 6d32  c1*R.m12+c2*R.m2
+0001d4d0: 322b 6333 2a52 2e6d 3332 2b63 342a 522e  2+c3*R.m32+c4*R.
+0001d4e0: 6d34 320a 2020 2020 2020 2020 7365 6c66  m42.        self
+0001d4f0: 2e6d 3433 203d 2063 312a 522e 6d31 332b  .m43 = c1*R.m13+
+0001d500: 6332 2a52 2e6d 3233 2b63 332a 522e 6d33  c2*R.m23+c3*R.m3
+0001d510: 332b 6334 2a52 2e6d 3433 0a20 2020 2020  3+c4*R.m43.     
+0001d520: 2020 2073 656c 662e 6d34 3420 3d20 6331     self.m44 = c1
+0001d530: 2a52 2e6d 3134 2b63 322a 522e 6d32 342b  *R.m14+c2*R.m24+
+0001d540: 6333 2a52 2e6d 3334 2b63 342a 522e 6d34  c3*R.m34+c4*R.m4
+0001d550: 340a 0a20 2020 2020 2020 2072 6574 7572  4..        retur
+0001d560: 6e20 7365 6c66 0a0a 2020 2020 6465 6620  n self..    def 
+0001d570: 6f72 7468 6f67 7261 7068 6963 2873 656c  orthographic(sel
+0001d580: 662c 206c 6566 742c 2072 6967 6874 2c20  f, left, right, 
+0001d590: 626f 7474 6f6d 2c20 746f 702c 206e 6561  bottom, top, nea
+0001d5a0: 722c 2066 6172 293a 0a20 2020 2020 2020  r, far):.       
+0001d5b0: 2022 2222 6571 7569 7661 6c65 6e74 2074   """equivalent t
+0001d5c0: 6f20 7468 6520 4f70 656e 474c 2063 6f6d  o the OpenGL com
+0001d5d0: 6d61 6e64 2067 6c4f 7274 686f 2829 2222  mand glOrtho()""
+0001d5e0: 220a 2020 2020 2020 2020 6364 6566 206d  ".        cdef m
+0001d5f0: 6174 3420 7265 730a 2020 2020 2020 2020  at4 res.        
+0001d600: 6364 6566 2064 6f75 626c 6520 6c2c 722c  cdef double l,r,
+0001d610: 622c 742c 6e2c 662c 2072 5f6c 2c20 745f  b,t,n,f, r_l, t_
+0001d620: 622c 2066 5f6e 0a0a 2020 2020 2020 2020  b, f_n..        
+0001d630: 6c20 3d20 6c65 6674 0a20 2020 2020 2020  l = left.       
+0001d640: 2072 203d 2072 6967 6874 0a20 2020 2020   r = right.     
+0001d650: 2020 2062 203d 2062 6f74 746f 6d0a 2020     b = bottom.  
+0001d660: 2020 2020 2020 7420 3d20 746f 700a 2020        t = top.  
+0001d670: 2020 2020 2020 6e20 3d20 6e65 6172 0a20        n = near. 
+0001d680: 2020 2020 2020 2066 203d 2066 6172 0a0a         f = far..
+0001d690: 2020 2020 2020 2020 725f 6c20 3d20 722d          r_l = r-
+0001d6a0: 6c0a 2020 2020 2020 2020 745f 6220 3d20  l.        t_b = 
+0001d6b0: 742d 620a 2020 2020 2020 2020 665f 6e20  t-b.        f_n 
+0001d6c0: 3d20 662d 6e0a 0a20 2020 2020 2020 2069  = f-n..        i
+0001d6d0: 6620 725f 6c3c 3d65 7073 3a0a 2020 2020  f r_l<=eps:.    
+0001d6e0: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+0001d6f0: 6c75 6545 7272 6f72 2c20 2272 6967 6874  lueError, "right
+0001d700: 2d76 616c 7565 206d 7573 7420 6265 2067  -value must be g
+0001d710: 7265 6174 6572 2074 6861 6e20 6c65 6674  reater than left
+0001d720: 2d76 616c 7565 220a 2020 2020 2020 2020  -value".        
+0001d730: 6966 2074 5f62 3c3d 6570 733a 0a20 2020  if t_b<=eps:.   
+0001d740: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+0001d750: 616c 7565 4572 726f 722c 2022 746f 702d  alueError, "top-
+0001d760: 7661 6c75 6520 6d75 7374 2062 6520 6772  value must be gr
+0001d770: 6561 7465 7220 7468 616e 2062 6f74 746f  eater than botto
+0001d780: 6d2d 7661 6c75 6522 0a20 2020 2020 2020  m-value".       
+0001d790: 2069 6620 665f 6e3c 3d65 7073 3a0a 2020   if f_n<=eps:.  
+0001d7a0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+0001d7b0: 5661 6c75 6545 7272 6f72 2c20 2266 6172  ValueError, "far
+0001d7c0: 2d76 616c 7565 206d 7573 7420 6265 2067  -value must be g
+0001d7d0: 7265 6174 6572 2074 6861 6e20 6e65 6172  reater than near
+0001d7e0: 2d76 616c 7565 220a 0a20 2020 2020 2020  -value"..       
+0001d7f0: 2072 6573 203d 206d 6174 3428 290a 0a20   res = mat4().. 
+0001d800: 2020 2020 2020 2072 6573 2e6d 3131 203d         res.m11 =
+0001d810: 2032 2e30 2f72 5f6c 0a20 2020 2020 2020   2.0/r_l.       
+0001d820: 2072 6573 2e6d 3132 203d 2030 2e30 0a20   res.m12 = 0.0. 
+0001d830: 2020 2020 2020 2072 6573 2e6d 3133 203d         res.m13 =
+0001d840: 2030 2e30 0a20 2020 2020 2020 2072 6573   0.0.        res
+0001d850: 2e6d 3134 203d 202d 2872 2b6c 292f 725f  .m14 = -(r+l)/r_
+0001d860: 6c0a 2020 2020 2020 2020 7265 732e 6d32  l.        res.m2
+0001d870: 3120 3d20 302e 300a 2020 2020 2020 2020  1 = 0.0.        
+0001d880: 7265 732e 6d32 3220 3d20 322e 302f 745f  res.m22 = 2.0/t_
+0001d890: 620a 2020 2020 2020 2020 7265 732e 6d32  b.        res.m2
+0001d8a0: 3320 3d20 302e 300a 2020 2020 2020 2020  3 = 0.0.        
+0001d8b0: 7265 732e 6d32 3420 3d20 2d28 742b 6229  res.m24 = -(t+b)
+0001d8c0: 2f74 5f62 0a20 2020 2020 2020 2072 6573  /t_b.        res
+0001d8d0: 2e6d 3331 203d 2030 2e30 0a20 2020 2020  .m31 = 0.0.     
+0001d8e0: 2020 2072 6573 2e6d 3332 203d 2030 2e30     res.m32 = 0.0
+0001d8f0: 0a20 2020 2020 2020 2072 6573 2e6d 3333  .        res.m33
+0001d900: 203d 202d 322e 302f 665f 6e0a 2020 2020   = -2.0/f_n.    
+0001d910: 2020 2020 7265 732e 6d33 3420 3d20 2d28      res.m34 = -(
+0001d920: 662b 6e29 2f66 5f6e 0a20 2020 2020 2020  f+n)/f_n.       
+0001d930: 2072 6573 2e6d 3431 203d 2030 2e30 0a20   res.m41 = 0.0. 
+0001d940: 2020 2020 2020 2072 6573 2e6d 3432 203d         res.m42 =
+0001d950: 2030 2e30 0a20 2020 2020 2020 2072 6573   0.0.        res
+0001d960: 2e6d 3433 203d 2030 2e30 0a20 2020 2020  .m43 = 0.0.     
+0001d970: 2020 2072 6573 2e6d 3434 203d 2031 2e30     res.m44 = 1.0
+0001d980: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0001d990: 7265 730a 0a20 2020 2064 6566 2066 7275  res..    def fru
+0001d9a0: 7374 756d 2873 656c 662c 206c 6566 742c  stum(self, left,
+0001d9b0: 2072 6967 6874 2c20 626f 7474 6f6d 2c20   right, bottom, 
+0001d9c0: 746f 702c 206e 6561 722c 2066 6172 293a  top, near, far):
+0001d9d0: 0a20 2020 2020 2020 2022 2222 6571 7569  .        """equi
+0001d9e0: 7661 6c65 6e74 2074 6f20 7468 6520 4f70  valent to the Op
+0001d9f0: 656e 474c 2063 6f6d 6d61 6e64 2067 6c46  enGL command glF
+0001da00: 7275 7374 756d 2829 2222 220a 2020 2020  rustum()""".    
+0001da10: 2020 2020 6364 6566 206d 6174 3420 7265      cdef mat4 re
+0001da20: 730a 2020 2020 2020 2020 6364 6566 2064  s.        cdef d
+0001da30: 6f75 626c 6520 6c2c 722c 622c 742c 6e2c  ouble l,r,b,t,n,
+0001da40: 662c 2072 5f6c 2c20 745f 622c 2066 5f6e  f, r_l, t_b, f_n
+0001da50: 0a0a 2020 2020 2020 2020 6c20 3d20 6c65  ..        l = le
+0001da60: 6674 0a20 2020 2020 2020 2072 203d 2072  ft.        r = r
+0001da70: 6967 6874 0a20 2020 2020 2020 2062 203d  ight.        b =
+0001da80: 2062 6f74 746f 6d0a 2020 2020 2020 2020   bottom.        
+0001da90: 7420 3d20 746f 700a 2020 2020 2020 2020  t = top.        
+0001daa0: 6e20 3d20 6e65 6172 0a20 2020 2020 2020  n = near.       
+0001dab0: 2066 203d 2066 6172 0a0a 2020 2020 2020   f = far..      
+0001dac0: 2020 725f 6c20 3d20 722d 6c0a 2020 2020    r_l = r-l.    
+0001dad0: 2020 2020 745f 6220 3d20 742d 620a 2020      t_b = t-b.  
+0001dae0: 2020 2020 2020 665f 6e20 3d20 662d 6e0a        f_n = f-n.
+0001daf0: 0a20 2020 2020 2020 2069 6620 725f 6c3c  .        if r_l<
+0001db00: 3d65 7073 3a0a 2020 2020 2020 2020 2020  =eps:.          
+0001db10: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+0001db20: 6f72 2c20 2272 6967 6874 2d76 616c 7565  or, "right-value
+0001db30: 206d 7573 7420 6265 2067 7265 6174 6572   must be greater
+0001db40: 2074 6861 6e20 6c65 6674 2d76 616c 7565   than left-value
+0001db50: 220a 2020 2020 2020 2020 6966 2074 5f62  ".        if t_b
+0001db60: 3c3d 6570 733a 0a20 2020 2020 2020 2020  <=eps:.         
+0001db70: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+0001db80: 726f 722c 2022 746f 702d 7661 6c75 6520  ror, "top-value 
+0001db90: 6d75 7374 2062 6520 6772 6561 7465 7220  must be greater 
+0001dba0: 7468 616e 2062 6f74 746f 6d2d 7661 6c75  than bottom-valu
+0001dbb0: 6522 0a20 2020 2020 2020 2069 6620 665f  e".        if f_
+0001dbc0: 6e3c 3d65 7073 3a0a 2020 2020 2020 2020  n<=eps:.        
+0001dbd0: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+0001dbe0: 7272 6f72 2c20 2266 6172 2d76 616c 7565  rror, "far-value
+0001dbf0: 206d 7573 7420 6265 2067 7265 6174 6572   must be greater
+0001dc00: 2074 6861 6e20 6e65 6172 2d76 616c 7565   than near-value
+0001dc10: 220a 0a20 2020 2020 2020 2072 6573 203d  "..        res =
+0001dc20: 206d 6174 3428 290a 0a20 2020 2020 2020   mat4()..       
+0001dc30: 2072 6573 2e6d 3131 203d 2028 322e 302a   res.m11 = (2.0*
+0001dc40: 6e29 2f72 5f6c 0a20 2020 2020 2020 2072  n)/r_l.        r
+0001dc50: 6573 2e6d 3132 203d 2030 2e30 0a20 2020  es.m12 = 0.0.   
+0001dc60: 2020 2020 2072 6573 2e6d 3133 203d 2028       res.m13 = (
+0001dc70: 722b 6c29 2f72 5f6c 0a20 2020 2020 2020  r+l)/r_l.       
+0001dc80: 2072 6573 2e6d 3134 203d 2030 2e30 0a20   res.m14 = 0.0. 
+0001dc90: 2020 2020 2020 2072 6573 2e6d 3231 203d         res.m21 =
+0001dca0: 2030 2e30 0a20 2020 2020 2020 2072 6573   0.0.        res
+0001dcb0: 2e6d 3232 203d 2028 322e 302a 6e29 2f74  .m22 = (2.0*n)/t
+0001dcc0: 5f62 0a20 2020 2020 2020 2072 6573 2e6d  _b.        res.m
+0001dcd0: 3233 203d 2028 742b 6229 2f74 5f62 0a20  23 = (t+b)/t_b. 
+0001dce0: 2020 2020 2020 2072 6573 2e6d 3234 203d         res.m24 =
+0001dcf0: 2030 2e30 0a20 2020 2020 2020 2072 6573   0.0.        res
+0001dd00: 2e6d 3331 203d 2030 2e30 0a20 2020 2020  .m31 = 0.0.     
+0001dd10: 2020 2072 6573 2e6d 3332 203d 2030 2e30     res.m32 = 0.0
+0001dd20: 0a20 2020 2020 2020 2072 6573 2e6d 3333  .        res.m33
+0001dd30: 203d 202d 2866 2b6e 292f 665f 6e0a 2020   = -(f+n)/f_n.  
+0001dd40: 2020 2020 2020 7265 732e 6d33 3420 3d20        res.m34 = 
+0001dd50: 282d 322e 302a 662a 6e29 2f66 5f6e 0a20  (-2.0*f*n)/f_n. 
+0001dd60: 2020 2020 2020 2072 6573 2e6d 3431 203d         res.m41 =
+0001dd70: 2030 2e30 0a20 2020 2020 2020 2072 6573   0.0.        res
+0001dd80: 2e6d 3432 203d 2030 2e30 0a20 2020 2020  .m42 = 0.0.     
+0001dd90: 2020 2072 6573 2e6d 3433 203d 202d 312e     res.m43 = -1.
+0001dda0: 300a 2020 2020 2020 2020 7265 732e 6d34  0.        res.m4
+0001ddb0: 3420 3d20 302e 300a 2020 2020 2020 2020  4 = 0.0.        
+0001ddc0: 7265 7475 726e 2072 6573 0a0a 2020 2020  return res..    
+0001ddd0: 6465 6620 7065 7273 7065 6374 6976 6528  def perspective(
+0001dde0: 7365 6c66 2c20 666f 7679 2c20 6173 7065  self, fovy, aspe
+0001ddf0: 6374 2c20 6e65 6172 2c20 6661 7229 3a0a  ct, near, far):.
+0001de00: 2020 2020 2020 2020 2222 2276 6f6e 204d          """von M
+0001de10: 6573 6120 c3bc 6265 726e 6f6d 6d65 6e20  esa ..bernommen 
+0001de20: 2867 6c75 2e63 2922 2222 0a20 2020 2020  (glu.c)""".     
+0001de30: 2020 2063 6465 6620 646f 7562 6c65 2066     cdef double f
+0001de40: 2c20 610a 2020 2020 2020 2020 6364 6566  , a.        cdef
+0001de50: 2064 6f75 626c 6520 746f 702c 2062 6f74   double top, bot
+0001de60: 746f 6d2c 206c 6566 742c 2072 6967 6874  tom, left, right
+0001de70: 0a0a 2020 2020 2020 2020 6620 3d20 666f  ..        f = fo
+0001de80: 7679 0a20 2020 2020 2020 2061 203d 2061  vy.        a = a
+0001de90: 7370 6563 740a 0a20 2020 2020 2020 2074  spect..        t
+0001dea0: 6f70 2020 2020 3d20 6e65 6172 202a 2074  op    = near * t
+0001deb0: 616e 2866 202a 2033 2e31 3431 3539 3236  an(f * 3.1415926
+0001dec0: 3533 3538 3937 3933 3120 2f20 3336 302e  535897931 / 360.
+0001ded0: 3029 0a20 2020 2020 2020 2062 6f74 746f  0).        botto
+0001dee0: 6d20 3d20 2d74 6f70 0a20 2020 2020 2020  m = -top.       
+0001def0: 206c 6566 7420 2020 3d20 626f 7474 6f6d   left   = bottom
+0001df00: 202a 2061 0a20 2020 2020 2020 2072 6967   * a.        rig
+0001df10: 6874 2020 3d20 746f 7020 2a20 610a 0a20  ht  = top * a.. 
+0001df20: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+0001df30: 6c66 2e66 7275 7374 756d 286c 6566 742c  lf.frustum(left,
+0001df40: 2072 6967 6874 2c20 626f 7474 6f6d 2c20   right, bottom, 
+0001df50: 746f 702c 206e 6561 722c 2066 6172 290a  top, near, far).
+0001df60: 0a20 2020 2064 6566 206c 6f6f 6b41 7428  .    def lookAt(
+0001df70: 7365 6c66 2c20 706f 732c 2074 6172 6765  self, pos, targe
+0001df80: 742c 2075 703d 2830 2c30 2c31 2929 3a0a  t, up=(0,0,1)):.
+0001df90: 2020 2020 2020 2020 2222 224c 6f6f 6b20          """Look 
+0001dfa0: 6672 6f6d 2070 6f73 2074 6f20 7461 7267  from pos to targ
+0001dfb0: 6574 2e0a 0a20 2020 2020 2020 2054 6865  et...        The
+0001dfc0: 2072 6573 756c 7469 6e67 2074 7261 6e73   resulting trans
+0001dfd0: 666f 726d 6174 696f 6e20 6d6f 7665 7320  formation moves 
+0001dfe0: 7468 6520 6f72 6967 696e 2074 6f20 706f  the origin to po
+0001dff0: 7320 616e 640a 2020 2020 2020 2020 726f  s and.        ro
+0001e000: 7461 7465 7320 736f 2074 6861 7420 5468  tates so that Th
+0001e010: 6520 7a2d 6178 6973 2070 6f69 6e74 7320  e z-axis points 
+0001e020: 746f 2074 6172 6765 742e 2054 6865 2079  to target. The y
+0001e030: 2d61 7869 7320 6973 0a20 2020 2020 2020  -axis is.       
+0001e040: 2061 7320 636c 6f73 6520 6173 2070 6f73   as close as pos
+0001e050: 7369 626c 6520 746f 2074 6865 2075 7020  sible to the up 
+0001e060: 7665 6374 6f72 2e0a 2020 2020 2020 2020  vector..        
+0001e070: 2222 220a 2020 2020 2020 2020 6364 6566  """.        cdef
+0001e080: 206d 6174 3420 7265 730a 2020 2020 2020   mat4 res.      
+0001e090: 2020 6364 6566 2076 6563 3320 7269 6768    cdef vec3 righ
+0001e0a0: 742c 7675 702c 6469 720a 0a20 2020 2020  t,vup,dir..     
+0001e0b0: 2020 2070 6f73 2020 2020 3d20 7665 6333     pos    = vec3
+0001e0c0: 2870 6f73 290a 2020 2020 2020 2020 7461  (pos).        ta
+0001e0d0: 7267 6574 203d 2076 6563 3328 7461 7267  rget = vec3(targ
+0001e0e0: 6574 290a 2020 2020 2020 2020 7675 7020  et).        vup 
+0001e0f0: 2020 203d 2076 6563 3328 7570 290a 0a20     = vec3(up).. 
+0001e100: 2020 2020 2020 2064 6972 203d 2028 7461         dir = (ta
+0001e110: 7267 6574 202d 2070 6f73 292e 6e6f 726d  rget - pos).norm
+0001e120: 616c 697a 6528 290a 2020 2020 2020 2020  alize().        
+0001e130: 7675 7020 3d20 7675 702e 6e6f 726d 616c  vup = vup.normal
+0001e140: 697a 6528 290a 2020 2020 2020 2020 7675  ize().        vu
+0001e150: 7020 3d20 7675 7020 2d20 2876 7570 202a  p = vup - (vup *
+0001e160: 2064 6972 2920 2a20 6469 720a 2020 2020   dir) * dir.    
+0001e170: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
+0001e180: 2020 2020 2076 7570 2020 3d20 7675 702e       vup  = vup.
+0001e190: 6e6f 726d 616c 697a 6528 290a 2020 2020  normalize().    
+0001e1a0: 2020 2020 6578 6365 7074 3a0a 2020 2020      except:.    
+0001e1b0: 2020 2020 2020 2020 2320 5765 2772 6520          # We're 
+0001e1c0: 6c6f 6f6b 696e 6720 616c 6f6e 6720 7468  looking along th
+0001e1d0: 6520 7570 2064 6972 6563 7469 6f6e 2c20  e up direction, 
+0001e1e0: 736f 2063 686f 6f73 650a 2020 2020 2020  so choose.      
+0001e1f0: 2020 2020 2020 2320 616e 2061 7262 6974        # an arbit
+0001e200: 7261 7279 2064 6972 6563 7469 6f6e 2074  rary direction t
+0001e210: 6861 7420 6973 2070 6572 7065 6e64 6963  hat is perpendic
+0001e220: 756c 6172 2074 6f20 6469 720a 2020 2020  ular to dir.    
+0001e230: 2020 2020 2020 2020 2320 6173 206e 6577          # as new
+0001e240: 2075 702e 0a20 2020 2020 2020 2020 2020   up..           
+0001e250: 2076 7570 203d 2064 6972 2e6f 7274 686f   vup = dir.ortho
+0001e260: 2829 0a0a 2020 2020 2020 2020 7269 6768  ()..        righ
+0001e270: 7420 3d20 7675 702e 6372 6f73 7328 6469  t = vup.cross(di
+0001e280: 7229 2e6e 6f72 6d61 6c69 7a65 2829 0a0a  r).normalize()..
+0001e290: 2020 2020 2020 2020 7265 7320 3d20 6d61          res = ma
+0001e2a0: 7434 2829 0a20 2020 2020 2020 2072 6573  t4().        res
+0001e2b0: 2e6d 3131 203d 2072 6967 6874 2e78 0a20  .m11 = right.x. 
+0001e2c0: 2020 2020 2020 2072 6573 2e6d 3231 203d         res.m21 =
+0001e2d0: 2072 6967 6874 2e79 0a20 2020 2020 2020   right.y.       
+0001e2e0: 2072 6573 2e6d 3331 203d 2072 6967 6874   res.m31 = right
+0001e2f0: 2e7a 0a20 2020 2020 2020 2072 6573 2e6d  .z.        res.m
+0001e300: 3431 203d 2030 2e30 0a20 2020 2020 2020  41 = 0.0.       
+0001e310: 2072 6573 2e6d 3132 203d 2076 7570 2e78   res.m12 = vup.x
+0001e320: 0a20 2020 2020 2020 2072 6573 2e6d 3232  .        res.m22
+0001e330: 203d 2076 7570 2e79 0a20 2020 2020 2020   = vup.y.       
+0001e340: 2072 6573 2e6d 3332 203d 2076 7570 2e7a   res.m32 = vup.z
+0001e350: 0a20 2020 2020 2020 2072 6573 2e6d 3432  .        res.m42
+0001e360: 203d 2030 2e30 0a20 2020 2020 2020 2072   = 0.0.        r
+0001e370: 6573 2e6d 3133 203d 2064 6972 2e78 0a20  es.m13 = dir.x. 
+0001e380: 2020 2020 2020 2072 6573 2e6d 3233 203d         res.m23 =
+0001e390: 2064 6972 2e79 0a20 2020 2020 2020 2072   dir.y.        r
+0001e3a0: 6573 2e6d 3333 203d 2064 6972 2e7a 0a20  es.m33 = dir.z. 
+0001e3b0: 2020 2020 2020 2072 6573 2e6d 3433 203d         res.m43 =
+0001e3c0: 2030 2e30 0a20 2020 2020 2020 2072 6573   0.0.        res
+0001e3d0: 2e6d 3134 203d 2070 6f73 2e78 0a20 2020  .m14 = pos.x.   
+0001e3e0: 2020 2020 2072 6573 2e6d 3234 203d 2070       res.m24 = p
+0001e3f0: 6f73 2e79 0a20 2020 2020 2020 2072 6573  os.y.        res
+0001e400: 2e6d 3334 203d 2070 6f73 2e7a 0a20 2020  .m34 = pos.z.   
+0001e410: 2020 2020 2072 6573 2e6d 3434 203d 2031       res.m44 = 1
+0001e420: 2e30 0a20 2020 2020 2020 2072 6574 7572  .0.        retur
+0001e430: 6e20 7265 730a 0a20 2020 2064 6566 206f  n res..    def o
+0001e440: 7274 686f 2873 656c 6629 3a0a 2020 2020  rtho(self):.    
+0001e450: 2020 2020 2222 2252 6574 7572 6e20 6120      """Return a 
+0001e460: 6d61 7472 6978 2077 6974 6820 6f72 7468  matrix with orth
+0001e470: 6f67 6f6e 616c 2062 6173 6520 7665 6374  ogonal base vect
+0001e480: 6f72 732e 0a0a 2020 2020 2020 2020 4d61  ors...        Ma
+0001e490: 6b65 7320 7468 6520 782d 2c20 792d 2061  kes the x-, y- a
+0001e4a0: 6e64 207a 2d61 7869 7320 6f72 7468 6f67  nd z-axis orthog
+0001e4b0: 6f6e 616c 2e0a 2020 2020 2020 2020 5468  onal..        Th
+0001e4c0: 6520 666f 7572 7468 2063 6f6c 756d 6e20  e fourth column 
+0001e4d0: 616e 6420 726f 7720 7265 6d61 696e 2075  and row remain u
+0001e4e0: 6e74 6f75 6368 6564 2e0a 2020 2020 2020  ntouched..      
+0001e4f0: 2020 2222 220a 2020 2020 2020 2020 6364    """.        cd
+0001e500: 6566 206d 6174 3420 7265 730a 2020 2020  ef mat4 res.    
+0001e510: 2020 2020 6364 6566 2076 6563 3320 782c      cdef vec3 x,
+0001e520: 792c 7a0a 0a20 2020 2020 2020 2078 203d  y,z..        x =
+0001e530: 2076 6563 3328 7365 6c66 2e6d 3131 2c20   vec3(self.m11, 
+0001e540: 7365 6c66 2e6d 3231 2c20 7365 6c66 2e6d  self.m21, self.m
+0001e550: 3331 290a 2020 2020 2020 2020 7920 3d20  31).        y = 
+0001e560: 7665 6333 2873 656c 662e 6d31 322c 2073  vec3(self.m12, s
+0001e570: 656c 662e 6d32 322c 2073 656c 662e 6d33  elf.m22, self.m3
+0001e580: 3229 0a20 2020 2020 2020 207a 203d 2076  2).        z = v
+0001e590: 6563 3328 7365 6c66 2e6d 3133 2c20 7365  ec3(self.m13, se
+0001e5a0: 6c66 2e6d 3233 2c20 7365 6c66 2e6d 3333  lf.m23, self.m33
+0001e5b0: 290a 0a20 2020 2020 2020 2078 6c20 3d20  )..        xl = 
+0001e5c0: 782e 6c65 6e67 7468 2829 0a20 2020 2020  x.length().     
+0001e5d0: 2020 2078 6c20 3d20 786c 2a78 6c0a 2020     xl = xl*xl.  
+0001e5e0: 2020 2020 2020 7920 3d20 7920 2d20 2828        y = y - ((
+0001e5f0: 782a 7929 2f78 6c29 2a78 0a20 2020 2020  x*y)/xl)*x.     
+0001e600: 2020 207a 203d 207a 202d 2028 2878 2a7a     z = z - ((x*z
+0001e610: 292f 786c 292a 780a 0a20 2020 2020 2020  )/xl)*x..       
+0001e620: 2079 6c20 3d20 792e 6c65 6e67 7468 2829   yl = y.length()
+0001e630: 0a20 2020 2020 2020 2079 6c20 3d20 796c  .        yl = yl
+0001e640: 2a79 6c0a 2020 2020 2020 2020 7a20 3d20  *yl.        z = 
+0001e650: 7a20 2d20 2828 792a 7a29 2f79 6c29 2a79  z - ((y*z)/yl)*y
+0001e660: 0a0a 2020 2020 2020 2020 7265 7320 3d20  ..        res = 
+0001e670: 6d61 7434 2829 0a20 2020 2020 2020 2072  mat4().        r
+0001e680: 6573 2e6d 3131 203d 2078 2e78 0a20 2020  es.m11 = x.x.   
+0001e690: 2020 2020 2072 6573 2e6d 3132 203d 2079       res.m12 = y
+0001e6a0: 2e78 0a20 2020 2020 2020 2072 6573 2e6d  .x.        res.m
+0001e6b0: 3133 203d 207a 2e78 0a20 2020 2020 2020  13 = z.x.       
+0001e6c0: 2072 6573 2e6d 3134 203d 2073 656c 662e   res.m14 = self.
+0001e6d0: 6d31 340a 2020 2020 2020 2020 7265 732e  m14.        res.
+0001e6e0: 6d32 3120 3d20 782e 790a 2020 2020 2020  m21 = x.y.      
+0001e6f0: 2020 7265 732e 6d32 3220 3d20 792e 790a    res.m22 = y.y.
+0001e700: 2020 2020 2020 2020 7265 732e 6d32 3320          res.m23 
+0001e710: 3d20 7a2e 790a 2020 2020 2020 2020 7265  = z.y.        re
+0001e720: 732e 6d32 3420 3d20 7365 6c66 2e6d 3234  s.m24 = self.m24
+0001e730: 0a20 2020 2020 2020 2072 6573 2e6d 3331  .        res.m31
+0001e740: 203d 2078 2e7a 0a20 2020 2020 2020 2072   = x.z.        r
+0001e750: 6573 2e6d 3332 203d 2079 2e7a 0a20 2020  es.m32 = y.z.   
+0001e760: 2020 2020 2072 6573 2e6d 3333 203d 207a       res.m33 = z
+0001e770: 2e7a 0a20 2020 2020 2020 2072 6573 2e6d  .z.        res.m
+0001e780: 3334 203d 2073 656c 662e 6d33 340a 2020  34 = self.m34.  
+0001e790: 2020 2020 2020 7265 732e 6d34 3120 3d20        res.m41 = 
+0001e7a0: 7365 6c66 2e6d 3431 0a20 2020 2020 2020  self.m41.       
+0001e7b0: 2072 6573 2e6d 3432 203d 2073 656c 662e   res.m42 = self.
+0001e7c0: 6d34 320a 2020 2020 2020 2020 7265 732e  m42.        res.
+0001e7d0: 6d34 3320 3d20 7365 6c66 2e6d 3433 0a20  m43 = self.m43. 
+0001e7e0: 2020 2020 2020 2072 6573 2e6d 3434 203d         res.m44 =
+0001e7f0: 2073 656c 662e 6d34 340a 2020 2020 2020   self.m44.      
+0001e800: 2020 7265 7475 726e 2072 6573 0a0a 2020    return res..  
+0001e810: 2020 6465 6620 6465 636f 6d70 6f73 6528    def decompose(
+0001e820: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
+0001e830: 2222 4465 636f 6d70 6f73 6573 2074 6865  ""Decomposes the
+0001e840: 206d 6174 7269 7820 696e 746f 2061 2074   matrix into a t
+0001e850: 7261 6e73 6c61 7469 6f6e 2c20 726f 7461  ranslation, rota
+0001e860: 7469 6f6e 2061 6e64 2073 6361 6c69 6e67  tion and scaling
+0001e870: 2070 6172 742e 0a0a 2020 2020 2020 2020   part...        
+0001e880: 5265 7475 726e 7320 6120 7475 706c 6520  Returns a tuple 
+0001e890: 2874 7261 6e73 6c61 7469 6f6e 2c20 726f  (translation, ro
+0001e8a0: 7461 7469 6f6e 2c20 7363 616c 696e 6729  tation, scaling)
+0001e8b0: 2e20 5468 650a 2020 2020 2020 2020 7472  . The.        tr
+0001e8c0: 616e 736c 6174 696f 6e20 616e 6420 7363  anslation and sc
+0001e8d0: 616c 696e 6720 7061 7274 7320 6172 6520  aling parts are 
+0001e8e0: 6769 7665 6e20 6173 2076 6563 3327 732c  given as vec3's,
+0001e8f0: 2074 6865 2072 6f74 6174 696f 6e0a 2020   the rotation.  
+0001e900: 2020 2020 2020 6973 2073 7469 6c6c 2067        is still g
+0001e910: 6976 656e 2061 7320 6120 6d61 7434 2e0a  iven as a mat4..
+0001e920: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0001e930: 2020 2020 6364 6566 206d 6174 3420 6d0a      cdef mat4 m.
+0001e940: 2020 2020 2020 2020 6364 6566 2076 6563          cdef vec
+0001e950: 3320 612c 622c 630a 2020 2020 2020 2020  3 a,b,c.        
+0001e960: 6364 6566 2064 6f75 626c 6520 616c 2c20  cdef double al, 
+0001e970: 626c 2c20 636c 0a0a 2020 2020 2020 2020  bl, cl..        
+0001e980: 6d20 3d20 7365 6c66 2e6f 7274 686f 2829  m = self.ortho()
+0001e990: 0a20 2020 2020 2020 206d 2e6d 3134 203d  .        m.m14 =
+0001e9a0: 2030 2e30 0a20 2020 2020 2020 206d 2e6d   0.0.        m.m
+0001e9b0: 3234 203d 2030 2e30 0a20 2020 2020 2020  24 = 0.0.       
+0001e9c0: 206d 2e6d 3334 203d 2030 2e30 0a20 2020   m.m34 = 0.0.   
+0001e9d0: 2020 2020 206d 2e6d 3434 203d 2031 2e30       m.m44 = 1.0
+0001e9e0: 0a20 2020 2020 2020 206d 2e6d 3431 203d  .        m.m41 =
+0001e9f0: 2030 2e30 0a20 2020 2020 2020 206d 2e6d   0.0.        m.m
+0001ea00: 3432 203d 2030 2e30 0a20 2020 2020 2020  42 = 0.0.       
+0001ea10: 206d 2e6d 3433 203d 2030 2e30 0a0a 2020   m.m43 = 0.0..  
+0001ea20: 2020 2020 2020 2320 612c 622c 6320 3d20        # a,b,c = 
+0001ea30: 436f 6c75 6d6e 2030 2c31 2c32 206f 6620  Column 0,1,2 of 
+0001ea40: 6d0a 2020 2020 2020 2020 6120 3d20 7665  m.        a = ve
+0001ea50: 6333 2829 0a20 2020 2020 2020 2062 203d  c3().        b =
+0001ea60: 2076 6563 3328 290a 2020 2020 2020 2020   vec3().        
+0001ea70: 6320 3d20 7665 6333 2829 0a20 2020 2020  c = vec3().     
+0001ea80: 2020 2061 2e78 203d 206d 2e6d 3131 0a20     a.x = m.m11. 
+0001ea90: 2020 2020 2020 2061 2e79 203d 206d 2e6d         a.y = m.m
+0001eaa0: 3231 0a20 2020 2020 2020 2061 2e7a 203d  21.        a.z =
+0001eab0: 206d 2e6d 3331 0a20 2020 2020 2020 2062   m.m31.        b
+0001eac0: 2e78 203d 206d 2e6d 3132 0a20 2020 2020  .x = m.m12.     
+0001ead0: 2020 2062 2e79 203d 206d 2e6d 3232 0a20     b.y = m.m22. 
+0001eae0: 2020 2020 2020 2062 2e7a 203d 206d 2e6d         b.z = m.m
+0001eaf0: 3332 0a20 2020 2020 2020 2063 2e78 203d  32.        c.x =
+0001eb00: 206d 2e6d 3133 0a20 2020 2020 2020 2063   m.m13.        c
+0001eb10: 2e79 203d 206d 2e6d 3233 0a20 2020 2020  .y = m.m23.     
+0001eb20: 2020 2063 2e7a 203d 206d 2e6d 3333 0a0a     c.z = m.m33..
+0001eb30: 2020 2020 2020 2020 2320 616c 2c62 6c2c          # al,bl,
+0001eb40: 636c 203d 206c 656e 6774 6820 6f66 2061  cl = length of a
+0001eb50: 2c62 2c63 2028 3d20 7363 616c 696e 6720  ,b,c (= scaling 
+0001eb60: 6661 6374 6f72 7329 0a20 2020 2020 2020  factors).       
+0001eb70: 2061 6c20 3d20 7371 7274 2861 2e78 2a61   al = sqrt(a.x*a
+0001eb80: 2e78 202b 2061 2e79 2a61 2e79 202b 2061  .x + a.y*a.y + a
+0001eb90: 2e7a 2a61 2e7a 290a 2020 2020 2020 2020  .z*a.z).        
+0001eba0: 626c 203d 2073 7172 7428 622e 782a 622e  bl = sqrt(b.x*b.
+0001ebb0: 7820 2b20 622e 792a 622e 7920 2b20 622e  x + b.y*b.y + b.
+0001ebc0: 7a2a 622e 7a29 0a20 2020 2020 2020 2063  z*b.z).        c
+0001ebd0: 6c20 3d20 7371 7274 2863 2e78 2a63 2e78  l = sqrt(c.x*c.x
+0001ebe0: 202b 2063 2e79 2a63 2e79 202b 2063 2e7a   + c.y*c.y + c.z
+0001ebf0: 2a63 2e7a 290a 2020 2020 2020 2020 6966  *c.z).        if
+0001ec00: 2061 6c3c 3d65 7073 206f 7220 626c 3c3d   al<=eps or bl<=
+0001ec10: 6570 7320 6f72 2063 6c3c 3d65 7073 3a0a  eps or cl<=eps:.
+0001ec20: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+0001ec30: 6520 5a65 726f 4469 7669 7369 6f6e 4572  e ZeroDivisionEr
+0001ec40: 726f 722c 2274 7261 6e73 666f 726d 6174  ror,"transformat
+0001ec50: 696f 6e20 636f 6e74 6169 6e73 2061 2030  ion contains a 0
+0001ec60: 2073 6361 6c69 6e67 220a 0a20 2020 2020   scaling"..     
+0001ec70: 2020 2073 6361 6c65 203d 2076 6563 3328     scale = vec3(
+0001ec80: 616c 2c62 6c2c 636c 290a 0a20 2020 2020  al,bl,cl)..     
+0001ec90: 2020 2023 206e 6f72 6d61 6c69 7a69 6e67     # normalizing
+0001eca0: 2061 2c62 2c63 0a23 2020 2020 2020 2020   a,b,c.#        
+0001ecb0: 612f 3d61 6c0a 2320 2020 2020 2020 2062  a/=al.#        b
+0001ecc0: 2f3d 626c 0a23 2020 2020 2020 2020 632f  /=bl.#        c/
+0001ecd0: 3d63 6c0a 2020 2020 2020 2020 612e 7820  =cl.        a.x 
+0001ece0: 3d20 612e 782f 616c 0a20 2020 2020 2020  = a.x/al.       
+0001ecf0: 2061 2e79 203d 2061 2e79 2f61 6c0a 2020   a.y = a.y/al.  
+0001ed00: 2020 2020 2020 612e 7a20 3d20 612e 7a2f        a.z = a.z/
+0001ed10: 616c 0a20 2020 2020 2020 2062 2e78 203d  al.        b.x =
+0001ed20: 2062 2e78 2f62 6c0a 2020 2020 2020 2020   b.x/bl.        
+0001ed30: 622e 7920 3d20 622e 792f 626c 0a20 2020  b.y = b.y/bl.   
+0001ed40: 2020 2020 2062 2e7a 203d 2062 2e7a 2f62       b.z = b.z/b
+0001ed50: 6c0a 2020 2020 2020 2020 632e 7820 3d20  l.        c.x = 
+0001ed60: 632e 782f 636c 0a20 2020 2020 2020 2063  c.x/cl.        c
+0001ed70: 2e79 203d 2063 2e79 2f63 6c0a 2020 2020  .y = c.y/cl.    
+0001ed80: 2020 2020 632e 7a20 3d20 632e 7a2f 636c      c.z = c.z/cl
+0001ed90: 0a0a 2020 2020 2020 2020 6d2e 6d31 3120  ..        m.m11 
+0001eda0: 3d20 612e 780a 2020 2020 2020 2020 6d2e  = a.x.        m.
+0001edb0: 6d32 3120 3d20 612e 790a 2020 2020 2020  m21 = a.y.      
+0001edc0: 2020 6d2e 6d33 3120 3d20 612e 7a0a 2020    m.m31 = a.z.  
+0001edd0: 2020 2020 2020 6d2e 6d31 3220 3d20 622e        m.m12 = b.
+0001ede0: 780a 2020 2020 2020 2020 6d2e 6d32 3220  x.        m.m22 
+0001edf0: 3d20 622e 790a 2020 2020 2020 2020 6d2e  = b.y.        m.
+0001ee00: 6d33 3220 3d20 622e 7a0a 2020 2020 2020  m32 = b.z.      
+0001ee10: 2020 6d2e 6d31 3320 3d20 632e 780a 2020    m.m13 = c.x.  
+0001ee20: 2020 2020 2020 6d2e 6d32 3320 3d20 632e        m.m23 = c.
+0001ee30: 790a 2020 2020 2020 2020 6d2e 6d33 3320  y.        m.m33 
+0001ee40: 3d20 632e 7a0a 2020 2020 2020 2020 6966  = c.z.        if
+0001ee50: 206d 2e64 6574 6572 6d69 6e61 6e74 2829   m.determinant()
+0001ee60: 3c30 2e30 3a0a 2020 2020 2020 2020 2020  <0.0:.          
+0001ee70: 2020 6d2e 6d31 3120 3d20 2d6d 2e6d 3131    m.m11 = -m.m11
+0001ee80: 0a20 2020 2020 2020 2020 2020 206d 2e6d  .            m.m
+0001ee90: 3231 203d 202d 6d2e 6d32 310a 2020 2020  21 = -m.m21.    
+0001eea0: 2020 2020 2020 2020 6d2e 6d33 3120 3d20          m.m31 = 
+0001eeb0: 2d6d 2e6d 3331 0a20 2020 2020 2020 2020  -m.m31.         
+0001eec0: 2020 2073 6361 6c65 2e78 203d 202d 7363     scale.x = -sc
+0001eed0: 616c 652e 780a 0a20 2020 2020 2020 2072  ale.x..        r
+0001eee0: 6574 7572 6e20 2876 6563 3328 7365 6c66  eturn (vec3(self
+0001eef0: 2e6d 3134 2c20 7365 6c66 2e6d 3234 2c20  .m14, self.m24, 
+0001ef00: 7365 6c66 2e6d 3334 292c 206d 2c20 7363  self.m34), m, sc
+0001ef10: 616c 6529 0a0a 2020 2020 6465 6620 6765  ale)..    def ge
+0001ef20: 744d 6174 3328 7365 6c66 293a 0a20 2020  tMat3(self):.   
+0001ef30: 2020 2020 2022 2222 436f 6e76 6572 7420       """Convert 
+0001ef40: 746f 206d 6174 3320 6279 2064 6973 6361  to mat3 by disca
+0001ef50: 7264 696e 6720 3474 6820 726f 7720 616e  rding 4th row an
+0001ef60: 6420 636f 6c75 6d6e 2e0a 2020 2020 2020  d column..      
+0001ef70: 2020 2222 220a 2020 2020 2020 2020 6364    """.        cd
+0001ef80: 6566 206d 6174 3320 7265 730a 2020 2020  ef mat3 res.    
+0001ef90: 2020 2020 7265 7320 3d20 6d61 7433 2829      res = mat3()
+0001efa0: 0a20 2020 2020 2020 2072 6573 2e6d 3131  .        res.m11
+0001efb0: 203d 2073 656c 662e 6d31 310a 2020 2020   = self.m11.    
+0001efc0: 2020 2020 7265 732e 6d31 3220 3d20 7365      res.m12 = se
+0001efd0: 6c66 2e6d 3132 0a20 2020 2020 2020 2072  lf.m12.        r
+0001efe0: 6573 2e6d 3133 203d 2073 656c 662e 6d31  es.m13 = self.m1
+0001eff0: 330a 2020 2020 2020 2020 7265 732e 6d32  3.        res.m2
+0001f000: 3120 3d20 7365 6c66 2e6d 3231 0a20 2020  1 = self.m21.   
+0001f010: 2020 2020 2072 6573 2e6d 3232 203d 2073       res.m22 = s
+0001f020: 656c 662e 6d32 320a 2020 2020 2020 2020  elf.m22.        
+0001f030: 7265 732e 6d32 3320 3d20 7365 6c66 2e6d  res.m23 = self.m
+0001f040: 3233 0a20 2020 2020 2020 2072 6573 2e6d  23.        res.m
+0001f050: 3331 203d 2073 656c 662e 6d33 310a 2020  31 = self.m31.  
+0001f060: 2020 2020 2020 7265 732e 6d33 3220 3d20        res.m32 = 
+0001f070: 7365 6c66 2e6d 3332 0a20 2020 2020 2020  self.m32.       
+0001f080: 2072 6573 2e6d 3333 203d 2073 656c 662e   res.m33 = self.
+0001f090: 6d33 330a 2020 2020 2020 2020 7265 7475  m33.        retu
+0001f0a0: 726e 2072 6573 0a0a 2020 2020 6465 6620  rn res..    def 
+0001f0b0: 7365 744d 6174 3328 7365 6c66 2c20 6d61  setMat3(self, ma
+0001f0c0: 7433 206d 293a 0a20 2020 2020 2020 2022  t3 m):.        "
+0001f0d0: 2222 5365 7420 7468 6520 6d61 7433 2070  ""Set the mat3 p
+0001f0e0: 6172 7420 6f66 2073 656c 662e 0a20 2020  art of self..   
+0001f0f0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0001f100: 2073 656c 662e 6d31 3120 3d20 6d2e 6d31   self.m11 = m.m1
+0001f110: 310a 2020 2020 2020 2020 7365 6c66 2e6d  1.        self.m
+0001f120: 3132 203d 206d 2e6d 3132 0a20 2020 2020  12 = m.m12.     
+0001f130: 2020 2073 656c 662e 6d31 3320 3d20 6d2e     self.m13 = m.
+0001f140: 6d31 330a 2020 2020 2020 2020 7365 6c66  m13.        self
+0001f150: 2e6d 3231 203d 206d 2e6d 3231 0a20 2020  .m21 = m.m21.   
+0001f160: 2020 2020 2073 656c 662e 6d32 3220 3d20       self.m22 = 
+0001f170: 6d2e 6d32 320a 2020 2020 2020 2020 7365  m.m22.        se
+0001f180: 6c66 2e6d 3233 203d 206d 2e6d 3233 0a20  lf.m23 = m.m23. 
+0001f190: 2020 2020 2020 2073 656c 662e 6d33 3120         self.m31 
+0001f1a0: 3d20 6d2e 6d33 310a 2020 2020 2020 2020  = m.m31.        
+0001f1b0: 7365 6c66 2e6d 3332 203d 206d 2e6d 3332  self.m32 = m.m32
+0001f1c0: 0a20 2020 2020 2020 2073 656c 662e 6d33  .        self.m3
+0001f1d0: 3320 3d20 6d2e 6d33 330a 0a23 2323 2323  3 = m.m33..#####
+0001f1e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001f1f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001f200: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001f210: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001f220: 230a 0a23 2071 7561 740a 6364 6566 2063  #..# quat.cdef c
+0001f230: 6c61 7373 2071 7561 743a 0a20 2020 2022  lass quat:.    "
+0001f240: 2222 5175 6174 6572 6e69 6f6e 2063 6c61  ""Quaternion cla
+0001f250: 7373 2e0a 0a20 2020 2051 7561 7465 726e  ss...    Quatern
+0001f260: 696f 6e73 2061 7265 2061 6e20 6578 7465  ions are an exte
+0001f270: 6e73 696f 6e20 746f 2063 6f6d 706c 6578  nsion to complex
+0001f280: 206e 756d 6265 7273 2061 6e64 2063 616e   numbers and can
+0001f290: 2062 6520 7573 6564 0a20 2020 2074 6f20   be used.    to 
+0001f2a0: 7374 6f72 6520 726f 7461 7469 6f6e 732e  store rotations.
+0001f2b0: 2054 6865 7920 6172 6520 636f 6d70 6f73   They are compos
+0001f2c0: 6564 206f 6620 666f 7572 2066 6c6f 6174  ed of four float
+0001f2d0: 7320 7768 6963 6820 6361 6e20 6265 0a20  s which can be. 
+0001f2e0: 2020 2073 6565 6e20 6173 2061 6e20 616e     seen as an an
+0001f2f0: 676c 6520 616e 6420 616e 2061 7869 7320  gle and an axis 
+0001f300: 6f66 2072 6f74 6174 696f 6e2e 0a20 2020  of rotation..   
+0001f310: 2022 2222 0a0a 2020 2020 6364 6566 2064   """..    cdef d
+0001f320: 6f75 626c 6520 772c 782c 792c 7a0a 0a20  ouble w,x,y,z.. 
+0001f330: 2020 2064 6566 205f 5f63 696e 6974 5f5f     def __cinit__
+0001f340: 2873 656c 662c 202a 6172 6773 293a 0a20  (self, *args):. 
+0001f350: 2020 2020 2020 2022 2222 436f 6e73 7472         """Constr
+0001f360: 7563 746f 722e 0a0a 2020 2020 2020 2020  uctor...        
+0001f370: 3020 6172 6775 6d65 6e74 733a 207a 6572  0 arguments: zer
+0001f380: 6f65 730a 2020 2020 2020 2020 3120 666c  oes.        1 fl
+0001f390: 6f61 7420 6172 6775 6d65 6e74 3a20 2077  oat argument:  w
+0001f3a0: 2063 6f6d 706f 6e65 6e74 2c20 782c 792c   component, x,y,
+0001f3b0: 7a20 3d20 2830 2c30 2c30 290a 2020 2020  z = (0,0,0).    
+0001f3c0: 2020 2020 3120 7175 6174 2061 7267 756d      1 quat argum
+0001f3d0: 656e 743a 204d 616b 6520 6120 636f 7079  ent: Make a copy
+0001f3e0: 0a20 2020 2020 2020 2031 206d 6174 3320  .        1 mat3 
+0001f3f0: 6172 6775 6d65 6e74 3a20 496e 6974 6961  argument: Initia
+0001f400: 6c69 7a65 2062 7920 726f 7461 7469 6f6e  lize by rotation
+0001f410: 206d 6174 7269 780a 2020 2020 2020 2020   matrix.        
+0001f420: 3120 6d61 7434 2061 7267 756d 656e 743a  1 mat4 argument:
+0001f430: 2049 6e69 7469 616c 697a 6520 6279 2072   Initialize by r
+0001f440: 6f74 6174 696f 6e20 6d61 7472 6978 0a20  otation matrix. 
+0001f450: 2020 2020 2020 2032 2061 7267 756d 656e         2 argumen
+0001f460: 7473 3a20 616e 676c 6520 2620 6178 6973  ts: angle & axis
+0001f470: 2028 646f 6573 6e27 7420 6861 7665 2074   (doesn't have t
+0001f480: 6f20 6265 206f 6620 756e 6974 206c 656e  o be of unit len
+0001f490: 6774 6829 0a20 2020 2020 2020 2034 2061  gth).        4 a
+0001f4a0: 7267 756d 656e 7473 3a20 636f 6d70 6f6e  rguments: compon
+0001f4b0: 656e 7473 2077 2c78 2c79 2c7a 0a20 2020  ents w,x,y,z.   
+0001f4c0: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
+0001f4d0: 2020 6364 6566 2069 6e74 2061 7267 6c65    cdef int argle
+0001f4e0: 6e2c 2073 6571 6c65 6e0a 2020 2020 2020  n, seqlen.      
+0001f4f0: 2020 6364 6566 2071 7561 7420 710a 2020    cdef quat q.  
+0001f500: 2020 2020 2020 6172 676c 656e 203d 206c        arglen = l
+0001f510: 656e 2861 7267 7329 0a0a 2020 2020 2020  en(args)..      
+0001f520: 2020 2320 3020 6172 6775 6d65 6e74 730a    # 0 arguments.
+0001f530: 2020 2020 2020 2020 6966 2061 7267 6c65          if argle
+0001f540: 6e3d 3d30 3a0a 2020 2020 2020 2020 2020  n==0:.          
+0001f550: 2020 7365 6c66 2e77 203d 2030 2e30 0a20    self.w = 0.0. 
+0001f560: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0001f570: 7820 3d20 302e 300a 2020 2020 2020 2020  x = 0.0.        
+0001f580: 2020 2020 7365 6c66 2e79 203d 2030 2e30      self.y = 0.0
+0001f590: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0001f5a0: 662e 7a20 3d20 302e 300a 0a20 2020 2020  f.z = 0.0..     
+0001f5b0: 2020 2023 2031 2061 7267 756d 656e 740a     # 1 argument.
+0001f5c0: 2020 2020 2020 2020 656c 6966 2061 7267          elif arg
+0001f5d0: 6c65 6e3d 3d31 3a0a 2020 2020 2020 2020  len==1:.        
+0001f5e0: 2020 2020 5420 3d20 7479 7065 2861 7267      T = type(arg
+0001f5f0: 735b 305d 290a 2020 2020 2020 2020 2020  s[0]).          
+0001f600: 2020 2320 7363 616c 6172 0a20 2020 2020    # scalar.     
+0001f610: 2020 2020 2020 2069 6620 5420 6973 2066         if T is f
+0001f620: 6c6f 6174 206f 7220 5420 6973 2069 6e74  loat or T is int
+0001f630: 206f 7220 5420 6973 206c 6f6e 673a 0a20   or T is long:. 
+0001f640: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0001f650: 656c 662e 7720 3d20 6172 6773 5b30 5d0a  elf.w = args[0].
+0001f660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f670: 7365 6c66 2e78 203d 2030 2e30 0a20 2020  self.x = 0.0.   
+0001f680: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0001f690: 662e 7920 3d20 302e 300a 2020 2020 2020  f.y = 0.0.      
+0001f6a0: 2020 2020 2020 2020 2020 7365 6c66 2e7a            self.z
+0001f6b0: 203d 2030 2e30 0a20 2020 2020 2020 2020   = 0.0.         
+0001f6c0: 2020 2023 2071 7561 740a 2020 2020 2020     # quat.      
+0001f6d0: 2020 2020 2020 656c 6966 2054 2069 7320        elif T is 
+0001f6e0: 7175 6174 3a0a 2020 2020 2020 2020 2020  quat:.          
+0001f6f0: 2020 2020 2020 7120 3d20 6172 6773 5b30        q = args[0
+0001f700: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+0001f710: 2020 7365 6c66 2e77 203d 2071 2e77 0a20    self.w = q.w. 
+0001f720: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0001f730: 656c 662e 7820 3d20 712e 780a 2020 2020  elf.x = q.x.    
+0001f740: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0001f750: 2e79 203d 2071 2e79 0a20 2020 2020 2020  .y = q.y.       
+0001f760: 2020 2020 2020 2020 2073 656c 662e 7a20           self.z 
+0001f770: 3d20 712e 7a0a 2020 2020 2020 2020 2020  = q.z.          
+0001f780: 2020 2320 5374 7269 6e67 0a20 2020 2020    # String.     
+0001f790: 2020 2020 2020 2065 6c69 6620 5420 6973         elif T is
+0001f7a0: 2073 7472 206f 7220 5420 6973 2075 6e69   str or T is uni
+0001f7b0: 636f 6465 3a0a 2020 2020 2020 2020 2020  code:.          
+0001f7c0: 2020 2020 2020 733d 6172 6773 5b30 5d2e        s=args[0].
+0001f7d0: 7265 706c 6163 6528 222c 222c 2220 2229  replace(","," ")
+0001f7e0: 2e72 6570 6c61 6365 2822 2020 222c 2220  .replace("  "," 
+0001f7f0: 2229 2e73 7472 6970 2829 2e73 706c 6974  ").strip().split
+0001f800: 2822 2022 290a 2020 2020 2020 2020 2020  (" ").          
+0001f810: 2020 2020 2020 6966 2073 3d3d 5b22 225d        if s==[""]
+0001f820: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0001f830: 2020 2020 2020 733d 5b5d 0a20 2020 2020        s=[].     
+0001f840: 2020 2020 2020 2020 2020 2066 6f72 2069             for i
+0001f850: 2069 6e20 7261 6e67 6528 6c65 6e28 7329   in range(len(s)
+0001f860: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+0001f870: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
 0001f880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f890: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-0001f8a0: 722c 2271 7561 7428 2920 6172 6720 6973  r,"quat() arg is
-0001f8b0: 2061 206d 616c 666f 726d 6564 2073 7472   a malformed str
-0001f8c0: 696e 6722 0a20 2020 2020 2020 2020 2020  ing".           
-0001f8d0: 2020 2020 2071 203d 2071 7561 7428 7329       q = quat(s)
-0001f8e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001f8f0: 2073 656c 662e 7720 3d20 712e 770a 2020   self.w = q.w.  
-0001f900: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0001f910: 6c66 2e78 203d 2071 2e78 0a20 2020 2020  lf.x = q.x.     
-0001f920: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0001f930: 7920 3d20 712e 790a 2020 2020 2020 2020  y = q.y.        
-0001f940: 2020 2020 2020 2020 7365 6c66 2e7a 203d          self.z =
-0001f950: 2071 2e7a 0a20 2020 2020 2020 2020 2020   q.z.           
-0001f960: 2023 2053 6571 7565 6e63 6520 6f66 2066   # Sequence of f
-0001f970: 6c6f 6174 730a 2020 2020 2020 2020 2020  loats.          
-0001f980: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-0001f990: 2020 2020 2020 2020 7365 7120 3d20 6172          seq = ar
-0001f9a0: 6773 5b30 5d0a 2020 2020 2020 2020 2020  gs[0].          
-0001f9b0: 2020 2020 2020 7472 793a 0a20 2020 2020        try:.     
-0001f9c0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0001f9d0: 6571 6c65 6e20 3d20 6c65 6e28 7365 7129  eqlen = len(seq)
-0001f9e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001f9f0: 2065 7863 6570 743a 0a20 2020 2020 2020   except:.       
-0001fa00: 2020 2020 2020 2020 2020 2020 2072 6169               rai
-0001fa10: 7365 2054 7970 6545 7272 6f72 2c22 7175  se TypeError,"qu
-0001fa20: 6174 2829 2061 7267 2063 616e 2774 2062  at() arg can't b
-0001fa30: 6520 636f 6e76 6572 7465 6420 746f 2071  e converted to q
-0001fa40: 7561 7422 0a0a 2020 2020 2020 2020 2020  uat"..          
-0001fa50: 2020 2020 2020 6966 2073 6571 6c65 6e3d        if seqlen=
-0001fa60: 3d30 3a0a 2020 2020 2020 2020 2020 2020  =0:.            
-0001fa70: 2020 2020 2020 2020 7365 6c66 2e77 203d          self.w =
-0001fa80: 2030 2e30 0a20 2020 2020 2020 2020 2020   0.0.           
-0001fa90: 2020 2020 2020 2020 2073 656c 662e 7820           self.x 
-0001faa0: 3d20 302e 300a 2020 2020 2020 2020 2020  = 0.0.          
-0001fab0: 2020 2020 2020 2020 2020 7365 6c66 2e79            self.y
-0001fac0: 203d 2030 2e30 0a20 2020 2020 2020 2020   = 0.0.         
-0001fad0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0001fae0: 7a20 3d20 302e 300a 2020 2020 2020 2020  z = 0.0.        
-0001faf0: 2020 2020 2020 2020 656c 6966 2073 6571          elif seq
-0001fb00: 6c65 6e3d 3d31 3a0a 2020 2020 2020 2020  len==1:.        
-0001fb10: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0001fb20: 2e77 203d 2073 6571 5b30 5d0a 2020 2020  .w = seq[0].    
-0001fb30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fb40: 7365 6c66 2e78 203d 2030 2e30 0a20 2020  self.x = 0.0.   
-0001fb50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fb60: 2073 656c 662e 7920 3d20 302e 300a 2020   self.y = 0.0.  
-0001fb70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fb80: 2020 7365 6c66 2e7a 203d 2030 2e30 0a20    self.z = 0.0. 
-0001fb90: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0001fba0: 6c69 6620 7365 716c 656e 3d3d 343a 0a20  lif seqlen==4:. 
-0001fbb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fbc0: 2020 2073 656c 662e 7720 3d20 7365 715b     self.w = seq[
-0001fbd0: 305d 0a20 2020 2020 2020 2020 2020 2020  0].             
-0001fbe0: 2020 2020 2020 2073 656c 662e 7820 3d20         self.x = 
-0001fbf0: 7365 715b 315d 0a20 2020 2020 2020 2020  seq[1].         
-0001fc00: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0001fc10: 7920 3d20 7365 715b 325d 0a20 2020 2020  y = seq[2].     
-0001fc20: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0001fc30: 656c 662e 7a20 3d20 7365 715b 335d 0a20  elf.z = seq[3]. 
-0001fc40: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0001fc50: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0001fc60: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
-0001fc70: 7970 6545 7272 6f72 2c20 2271 7561 7428  ypeError, "quat(
-0001fc80: 2920 6172 6720 6361 6e27 7420 6265 2063  ) arg can't be c
-0001fc90: 6f6e 7665 7274 6564 2074 6f20 7175 6174  onverted to quat
-0001fca0: 220a 0a20 2020 2020 2020 2023 2032 2061  "..        # 2 a
-0001fcb0: 7267 756d 656e 7473 2028 616e 676c 6520  rguments (angle 
-0001fcc0: 2620 6178 6973 290a 2020 2020 2020 2020  & axis).        
-0001fcd0: 656c 6966 2061 7267 6c65 6e3d 3d32 3a0a  elif arglen==2:.
-0001fce0: 2020 2020 2020 2020 2020 2020 616e 676c              angl
-0001fcf0: 652c 2061 7869 7320 3d20 6172 6773 0a20  e, axis = args. 
-0001fd00: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0001fd10: 6672 6f6d 416e 676c 6541 7869 7328 616e  fromAngleAxis(an
-0001fd20: 676c 652c 6178 6973 290a 0a20 2020 2020  gle,axis)..     
-0001fd30: 2020 2023 2034 2061 7267 756d 656e 7473     # 4 arguments
-0001fd40: 0a20 2020 2020 2020 2065 6c69 6620 6172  .        elif ar
-0001fd50: 676c 656e 3d3d 343a 0a20 2020 2020 2020  glen==4:.       
-0001fd60: 2020 2020 2073 656c 662e 7720 3d20 6172       self.w = ar
-0001fd70: 6773 5b30 5d0a 2020 2020 2020 2020 2020  gs[0].          
-0001fd80: 2020 7365 6c66 2e78 203d 2061 7267 735b    self.x = args[
-0001fd90: 315d 0a20 2020 2020 2020 2020 2020 2073  1].            s
-0001fda0: 656c 662e 7920 3d20 6172 6773 5b32 5d0a  elf.y = args[2].
-0001fdb0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0001fdc0: 2e7a 203d 2061 7267 735b 335d 0a0a 2020  .z = args[3]..  
-0001fdd0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-0001fde0: 2020 2020 2020 2020 7261 6973 6520 5479          raise Ty
-0001fdf0: 7065 4572 726f 722c 2022 7175 6174 2829  peError, "quat()
-0001fe00: 2061 7267 2063 616e 2774 2062 6520 636f   arg can't be co
-0001fe10: 6e76 6572 7465 6420 746f 2071 7561 7422  nverted to quat"
-0001fe20: 0a0a 2020 2020 6465 6620 5f5f 7265 6475  ..    def __redu
-0001fe30: 6365 5f5f 2873 656c 6629 3a0a 2020 2020  ce__(self):.    
-0001fe40: 2020 2020 7265 7475 726e 2028 5f71 7561      return (_qua
-0001fe50: 7463 6f6e 7374 7275 6374 2c20 2873 656c  tconstruct, (sel
-0001fe60: 662e 772c 2073 656c 662e 782c 2073 656c  f.w, self.x, sel
-0001fe70: 662e 792c 2073 656c 662e 7a29 290a 0a20  f.y, self.z)).. 
-0001fe80: 2020 2064 6566 205f 5f72 6570 725f 5f28     def __repr__(
-0001fe90: 7365 6c66 293a 0a20 2020 2020 2020 2072  self):.        r
-0001fea0: 6574 7572 6e20 2771 7561 7428 2573 2c20  eturn 'quat(%s, 
-0001feb0: 2573 2c20 2573 2c20 2573 2927 2528 7265  %s, %s, %s)'%(re
-0001fec0: 7072 2873 656c 662e 7729 2c72 6570 7228  pr(self.w),repr(
-0001fed0: 7365 6c66 2e78 292c 7265 7072 2873 656c  self.x),repr(sel
-0001fee0: 662e 7929 2c72 6570 7228 7365 6c66 2e7a  f.y),repr(self.z
-0001fef0: 2929 0a0a 2020 2020 6465 6620 5f5f 7374  ))..    def __st
-0001ff00: 725f 5f28 7365 6c66 293a 0a20 2020 2020  r__(self):.     
-0001ff10: 2020 2072 6574 7572 6e20 2228 2531 2e34     return "(%1.4
-0001ff20: 662c 2025 312e 3466 2c20 2531 2e34 662c  f, %1.4f, %1.4f,
-0001ff30: 2025 312e 3466 2922 2528 7365 6c66 2e77   %1.4f)"%(self.w
-0001ff40: 2c20 7365 6c66 2e78 2c20 7365 6c66 2e79  , self.x, self.y
-0001ff50: 2c20 7365 6c66 2e7a 290a 0a0a 2020 2020  , self.z)...    
-0001ff60: 6465 6620 5f5f 7269 6368 636d 705f 5f28  def __richcmp__(
-0001ff70: 612c 622c 6f70 293a 0a20 2020 2020 2020  a,b,op):.       
-0001ff80: 2063 6465 6620 7175 6174 2076 612c 2076   cdef quat va, v
-0001ff90: 620a 2020 2020 2020 2020 6364 6566 2069  b.        cdef i
-0001ffa0: 6e74 2063 6f70 0a0a 2020 2020 2020 2020  nt cop..        
-0001ffb0: 636f 7020 3d20 6f70 0a0a 2020 2020 2020  cop = op..      
-0001ffc0: 2020 7461 203d 2074 7970 6528 6129 0a20    ta = type(a). 
-0001ffd0: 2020 2020 2020 2074 6220 3d20 7479 7065         tb = type
-0001ffe0: 2862 290a 2020 2020 2020 2020 6966 2028  (b).        if (
-0001fff0: 7461 213d 7175 6174 206f 7220 7462 213d  ta!=quat or tb!=
-00020000: 7175 6174 293a 0a20 2020 2020 2020 2020  quat):.         
-00020010: 2020 2069 6620 636f 703d 3d33 3a0a 2020     if cop==3:.  
-00020020: 2020 2020 2020 2020 2020 2020 2020 7265                re
-00020030: 7475 726e 2031 0a20 2020 2020 2020 2020  turn 1.         
-00020040: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00020050: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00020060: 300a 0a20 2020 2020 2020 2076 6120 3d20  0..        va = 
-00020070: 610a 2020 2020 2020 2020 7662 203d 2062  a.        vb = b
-00020080: 0a0a 2020 2020 2020 2020 2320 3c0a 2020  ..        # <.  
-00020090: 2020 2020 2020 6966 2063 6f70 3d3d 303a        if cop==0:
-000200a0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-000200b0: 7572 6e20 300a 2020 2020 2020 2020 2320  urn 0.        # 
-000200c0: 3c3d 0a20 2020 2020 2020 2065 6c69 6620  <=.        elif 
-000200d0: 636f 703d 3d31 3a0a 2020 2020 2020 2020  cop==1:.        
-000200e0: 2020 2020 7265 7475 726e 2030 0a20 2020      return 0.   
-000200f0: 2020 2020 2023 203d 3d0a 2020 2020 2020       # ==.      
-00020100: 2020 656c 6966 2063 6f70 3d3d 323a 0a20    elif cop==2:. 
-00020110: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00020120: 6e20 2866 6162 7328 7661 2e77 2d76 622e  n (fabs(va.w-vb.
-00020130: 7729 3c3d 6570 7320 616e 6420 6661 6273  w)<=eps and fabs
-00020140: 2876 612e 782d 7662 2e78 293c 3d65 7073  (va.x-vb.x)<=eps
-00020150: 2061 6e64 2066 6162 7328 7661 2e79 2d76   and fabs(va.y-v
-00020160: 622e 7929 3c3d 6570 7320 616e 6420 6661  b.y)<=eps and fa
-00020170: 6273 2876 612e 7a2d 7662 2e7a 293c 3d65  bs(va.z-vb.z)<=e
-00020180: 7073 290a 2020 2020 2020 2020 2320 213d  ps).        # !=
-00020190: 0a20 2020 2020 2020 2065 6c69 6620 636f  .        elif co
-000201a0: 703d 3d33 3a0a 2020 2020 2020 2020 2020  p==3:.          
-000201b0: 2020 7265 7475 726e 2028 6661 6273 2876    return (fabs(v
-000201c0: 612e 772d 7662 2e77 293e 6570 7320 6f72  a.w-vb.w)>eps or
-000201d0: 2066 6162 7328 7661 2e78 2d76 622e 7829   fabs(va.x-vb.x)
-000201e0: 3e65 7073 206f 7220 6661 6273 2876 612e  >eps or fabs(va.
-000201f0: 792d 7662 2e79 293e 6570 7320 616e 6420  y-vb.y)>eps and 
-00020200: 6661 6273 2876 612e 7a2d 7662 2e7a 293e  fabs(va.z-vb.z)>
-00020210: 6570 7329 0a20 2020 2020 2020 2023 203e  eps).        # >
-00020220: 0a20 2020 2020 2020 2065 6c69 6620 636f  .        elif co
-00020230: 703d 3d34 3a0a 2020 2020 2020 2020 2020  p==4:.          
-00020240: 2020 7265 7475 726e 2030 0a20 2020 2020    return 0.     
-00020250: 2020 2023 203e 3d0a 2020 2020 2020 2020     # >=.        
-00020260: 656c 6966 2063 6f70 3d3d 353a 0a20 2020  elif cop==5:.   
-00020270: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00020280: 300a 2020 2020 2020 2020 2320 736f 6e73  0.        # sons
-00020290: 7420 2846 6568 6c65 7229 0a20 2020 2020  t (Fehler).     
-000202a0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-000202b0: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-000202c0: 4572 726f 722c 2269 6e74 6572 6e61 6c20  Error,"internal 
-000202d0: 6572 726f 723a 2069 6c6c 6567 616c 2072  error: illegal r
-000202e0: 6963 6820 636f 6d70 6172 6973 6f6e 206e  ich comparison n
-000202f0: 756d 6265 7222 0a0a 2020 2020 6465 6620  umber"..    def 
-00020300: 5f5f 6164 645f 5f28 7175 6174 2061 2c20  __add__(quat a, 
-00020310: 7175 6174 2062 293a 0a20 2020 2020 2020  quat b):.       
-00020320: 2022 2222 4164 6469 7469 6f6e 2e0a 0a20   """Addition... 
-00020330: 2020 2020 2020 203e 3e3e 2071 3d71 7561         >>> q=qua
-00020340: 7428 302e 3936 3839 2c20 302e 3231 3630  t(0.9689, 0.2160
-00020350: 2c20 302e 3130 3830 2c20 302e 3035 3430  , 0.1080, 0.0540
-00020360: 290a 2020 2020 2020 2020 3e3e 3e20 7072  ).        >>> pr
-00020370: 696e 7420 712b 710a 2020 2020 2020 2020  int q+q.        
-00020380: 2831 2e39 3337 382c 2030 2e34 3332 302c  (1.9378, 0.4320,
-00020390: 2030 2e32 3136 302c 2030 2e31 3038 3029   0.2160, 0.1080)
-000203a0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-000203b0: 2020 2020 2063 6465 6620 7175 6174 2072       cdef quat r
-000203c0: 6573 0a20 2020 2020 2020 2072 6573 203d  es.        res =
-000203d0: 2071 7561 7428 290a 2020 2020 2020 2020   quat().        
-000203e0: 7265 732e 7720 3d20 612e 772b 622e 770a  res.w = a.w+b.w.
-000203f0: 2020 2020 2020 2020 7265 732e 7820 3d20          res.x = 
-00020400: 612e 782b 622e 780a 2020 2020 2020 2020  a.x+b.x.        
-00020410: 7265 732e 7920 3d20 612e 792b 622e 790a  res.y = a.y+b.y.
-00020420: 2020 2020 2020 2020 7265 732e 7a20 3d20          res.z = 
-00020430: 612e 7a2b 622e 7a0a 2020 2020 2020 2020  a.z+b.z.        
-00020440: 7265 7475 726e 2072 6573 0a0a 2020 2020  return res..    
-00020450: 6465 6620 5f5f 7375 625f 5f28 7175 6174  def __sub__(quat
-00020460: 2061 2c20 7175 6174 2062 293a 0a20 2020   a, quat b):.   
-00020470: 2020 2020 2022 2222 5375 6274 7261 6374       """Subtract
-00020480: 696f 6e2e 0a0a 2020 2020 2020 2020 3e3e  ion...        >>
-00020490: 3e20 713d 7175 6174 2830 2e39 3638 392c  > q=quat(0.9689,
-000204a0: 2030 2e32 3136 302c 2030 2e31 3038 302c   0.2160, 0.1080,
-000204b0: 2030 2e30 3534 3029 0a20 2020 2020 2020   0.0540).       
-000204c0: 203e 3e3e 2070 7269 6e74 2071 2d71 0a20   >>> print q-q. 
-000204d0: 2020 2020 2020 2028 302e 3030 3030 2c20         (0.0000, 
-000204e0: 302e 3030 3030 2c20 302e 3030 3030 2c20  0.0000, 0.0000, 
-000204f0: 302e 3030 3030 290a 2020 2020 2020 2020  0.0000).        
-00020500: 2222 220a 2020 2020 2020 2020 6364 6566  """.        cdef
-00020510: 2071 7561 7420 7265 730a 2020 2020 2020   quat res.      
-00020520: 2020 7265 7320 3d20 7175 6174 2829 0a20    res = quat(). 
-00020530: 2020 2020 2020 2072 6573 2e77 203d 2061         res.w = a
-00020540: 2e77 2d62 2e77 0a20 2020 2020 2020 2072  .w-b.w.        r
-00020550: 6573 2e78 203d 2061 2e78 2d62 2e78 0a20  es.x = a.x-b.x. 
-00020560: 2020 2020 2020 2072 6573 2e79 203d 2061         res.y = a
-00020570: 2e79 2d62 2e79 0a20 2020 2020 2020 2072  .y-b.y.        r
-00020580: 6573 2e7a 203d 2061 2e7a 2d62 2e7a 0a20  es.z = a.z-b.z. 
-00020590: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
-000205a0: 730a 0a20 2020 2064 6566 205f 5f6d 756c  s..    def __mul
-000205b0: 5f5f 2861 2c20 6229 3a0a 2020 2020 2020  __(a, b):.      
-000205c0: 2020 2222 224d 756c 7469 706c 6963 6174    """Multiplicat
-000205d0: 696f 6e2e 0a0a 2020 2020 2020 2020 3e3e  ion...        >>
-000205e0: 3e20 713d 7175 6174 2830 2e39 3638 392c  > q=quat(0.9689,
-000205f0: 2030 2e32 3136 302c 2030 2e31 3038 302c   0.2160, 0.1080,
-00020600: 2030 2e30 3534 3029 0a20 2020 2020 2020   0.0540).       
-00020610: 203e 3e3e 2070 7269 6e74 2071 2a32 2e30   >>> print q*2.0
-00020620: 0a20 2020 2020 2020 2028 312e 3933 3738  .        (1.9378
-00020630: 2c20 302e 3433 3230 2c20 302e 3231 3630  , 0.4320, 0.2160
-00020640: 2c20 302e 3130 3830 290a 2020 2020 2020  , 0.1080).      
-00020650: 2020 3e3e 3e20 7072 696e 7420 322e 302a    >>> print 2.0*
-00020660: 710a 2020 2020 2020 2020 2831 2e39 3337  q.        (1.937
-00020670: 382c 2030 2e34 3332 302c 2030 2e32 3136  8, 0.4320, 0.216
-00020680: 302c 2030 2e31 3038 3029 0a20 2020 2020  0, 0.1080).     
-00020690: 2020 203e 3e3e 2070 7269 6e74 2071 2a71     >>> print q*q
-000206a0: 0a20 2020 2020 2020 2028 302e 3837 3735  .        (0.8775
-000206b0: 2c20 302e 3431 3836 2c20 302e 3230 3933  , 0.4186, 0.2093
-000206c0: 2c20 302e 3130 3436 290a 2020 2020 2020  , 0.1046).      
-000206d0: 2020 2222 220a 2020 2020 2020 2020 6364    """.        cd
-000206e0: 6566 2071 7561 7420 7265 732c 2076 612c  ef quat res, va,
-000206f0: 2076 620a 2020 2020 2020 2020 6364 6566   vb.        cdef
-00020700: 2064 6f75 626c 6520 720a 0a20 2020 2020   double r..     
-00020710: 2020 2074 6120 3d20 7479 7065 2861 290a     ta = type(a).
-00020720: 2020 2020 2020 2020 7462 203d 2074 7970          tb = typ
-00020730: 6528 6229 0a0a 2020 2020 2020 2020 6966  e(b)..        if
-00020740: 2074 6120 6973 2071 7561 743a 0a20 2020   ta is quat:.   
-00020750: 2020 2020 2020 2020 2076 6120 3d20 610a           va = a.
-00020760: 2020 2020 2020 2020 2020 2020 6966 2074              if t
-00020770: 6220 6973 2071 7561 743a 0a20 2020 2020  b is quat:.     
-00020780: 2020 2020 2020 2020 2020 2023 2071 7561             # qua
-00020790: 742a 7175 6174 0a20 2020 2020 2020 2020  t*quat.         
-000207a0: 2020 2020 2020 2076 6220 3d20 620a 2020         vb = b.  
-000207b0: 2020 2020 2020 2020 2020 2020 2020 7265                re
-000207c0: 7320 3d20 7175 6174 2829 0a20 2020 2020  s = quat().     
-000207d0: 2020 2020 2020 2020 2020 2072 6573 2e77             res.w
-000207e0: 203d 2076 612e 772a 7662 2e77 202d 2076   = va.w*vb.w - v
-000207f0: 612e 782a 7662 2e78 202d 2076 612e 792a  a.x*vb.x - va.y*
-00020800: 7662 2e79 202d 2076 612e 7a2a 7662 2e7a  vb.y - va.z*vb.z
-00020810: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00020820: 2072 6573 2e78 203d 2076 612e 772a 7662   res.x = va.w*vb
-00020830: 2e78 202b 2076 612e 782a 7662 2e77 202b  .x + va.x*vb.w +
-00020840: 2076 612e 792a 7662 2e7a 202d 2076 612e   va.y*vb.z - va.
-00020850: 7a2a 7662 2e79 0a20 2020 2020 2020 2020  z*vb.y.         
-00020860: 2020 2020 2020 2072 6573 2e79 203d 2076         res.y = v
-00020870: 612e 772a 7662 2e79 202b 2076 612e 792a  a.w*vb.y + va.y*
-00020880: 7662 2e77 202d 2076 612e 782a 7662 2e7a  vb.w - va.x*vb.z
-00020890: 202b 2076 612e 7a2a 7662 2e78 0a20 2020   + va.z*vb.x.   
-000208a0: 2020 2020 2020 2020 2020 2020 2072 6573               res
-000208b0: 2e7a 203d 2076 612e 772a 7662 2e7a 202b  .z = va.w*vb.z +
-000208c0: 2076 612e 7a2a 7662 2e77 202b 2076 612e   va.z*vb.w + va.
-000208d0: 782a 7662 2e79 202d 2076 612e 792a 7662  x*vb.y - va.y*vb
-000208e0: 2e78 0a20 2020 2020 2020 2020 2020 2020  .x.             
-000208f0: 2020 2072 6574 7572 6e20 7265 730a 2020     return res.  
-00020900: 2020 2020 2020 2020 2020 656c 6966 2074            elif t
-00020910: 6220 6973 2066 6c6f 6174 206f 7220 7462  b is float or tb
-00020920: 2069 7320 696e 7420 6f72 2074 6220 6973   is int or tb is
-00020930: 206c 6f6e 673a 0a20 2020 2020 2020 2020   long:.         
-00020940: 2020 2020 2020 2023 2071 7561 742a 7363         # quat*sc
-00020950: 616c 6172 0a20 2020 2020 2020 2020 2020  alar.           
-00020960: 2020 2020 2072 6573 203d 2071 7561 7428       res = quat(
-00020970: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00020980: 2020 7220 2020 3d20 620a 2020 2020 2020    r   = b.      
-00020990: 2020 2020 2020 2020 2020 7265 732e 7720            res.w 
-000209a0: 3d20 7661 2e77 2a72 0a20 2020 2020 2020  = va.w*r.       
-000209b0: 2020 2020 2020 2020 2072 6573 2e78 203d           res.x =
-000209c0: 2076 612e 782a 720a 2020 2020 2020 2020   va.x*r.        
-000209d0: 2020 2020 2020 2020 7265 732e 7920 3d20          res.y = 
-000209e0: 7661 2e79 2a72 0a20 2020 2020 2020 2020  va.y*r.         
-000209f0: 2020 2020 2020 2072 6573 2e7a 203d 2076         res.z = v
-00020a00: 612e 7a2a 720a 2020 2020 2020 2020 2020  a.z*r.          
-00020a10: 2020 2020 2020 7265 7475 726e 2072 6573        return res
-00020a20: 0a20 2020 2020 2020 2065 6c69 6620 7461  .        elif ta
-00020a30: 2069 7320 666c 6f61 7420 6f72 2074 6120   is float or ta 
-00020a40: 6973 2069 6e74 206f 7220 7461 2069 7320  is int or ta is 
-00020a50: 6c6f 6e67 3a0a 2020 2020 2020 2020 2020  long:.          
-00020a60: 2020 6966 2074 6220 6973 2071 7561 743a    if tb is quat:
-00020a70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00020a80: 2023 2073 6361 6c61 722a 7175 6174 0a20   # scalar*quat. 
-00020a90: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00020aa0: 6573 203d 2071 7561 7428 290a 2020 2020  es = quat().    
-00020ab0: 2020 2020 2020 2020 2020 2020 7662 2020              vb  
-00020ac0: 3d20 620a 2020 2020 2020 2020 2020 2020  = b.            
-00020ad0: 2020 2020 7220 2020 3d20 610a 2020 2020      r   = a.    
-00020ae0: 2020 2020 2020 2020 2020 2020 7265 732e              res.
-00020af0: 7720 3d20 722a 7662 2e77 0a20 2020 2020  w = r*vb.w.     
-00020b00: 2020 2020 2020 2020 2020 2072 6573 2e78             res.x
-00020b10: 203d 2072 2a76 622e 780a 2020 2020 2020   = r*vb.x.      
-00020b20: 2020 2020 2020 2020 2020 7265 732e 7920            res.y 
-00020b30: 3d20 722a 7662 2e79 0a20 2020 2020 2020  = r*vb.y.       
-00020b40: 2020 2020 2020 2020 2072 6573 2e7a 203d           res.z =
-00020b50: 2072 2a76 622e 7a0a 2020 2020 2020 2020   r*vb.z.        
-00020b60: 2020 2020 2020 2020 7265 7475 726e 2072          return r
-00020b70: 6573 0a0a 2020 2020 2020 2020 7261 6973  es..        rais
-00020b80: 6520 5479 7065 4572 726f 722c 2022 756e  e TypeError, "un
-00020b90: 7375 7070 6f72 7465 6420 6f70 6572 616e  supported operan
-00020ba0: 6420 7479 7065 2066 6f72 202a 220a 0a20  d type for *".. 
-00020bb0: 2020 2064 6566 205f 5f64 6976 5f5f 2871     def __div__(q
-00020bc0: 7561 7420 612c 2062 293a 0a20 2020 2020  uat a, b):.     
-00020bd0: 2020 2023 2050 7974 686f 6e20 320a 2020     # Python 2.  
-00020be0: 2020 2020 2020 7265 7475 726e 2071 7561        return qua
-00020bf0: 742e 5f5f 7472 7565 6469 765f 5f28 612c  t.__truediv__(a,
-00020c00: 6229 0a0a 2020 2020 6465 6620 5f5f 7472  b)..    def __tr
-00020c10: 7565 6469 765f 5f28 7175 6174 2061 2c20  uediv__(quat a, 
-00020c20: 6229 3a0a 2020 2020 2020 2020 2222 2244  b):.        """D
-00020c30: 6976 6973 696f 6e2e 0a0a 2020 2020 2020  ivision...      
-00020c40: 2020 3e3e 3e20 713d 7175 6174 2830 2e39    >>> q=quat(0.9
-00020c50: 3638 392c 2030 2e32 3136 302c 2030 2e31  689, 0.2160, 0.1
-00020c60: 3038 302c 2030 2e30 3534 3029 0a20 2020  080, 0.0540).   
-00020c70: 2020 2020 203e 3e3e 2070 7269 6e74 2071       >>> print q
-00020c80: 2f32 2e30 0a20 2020 2020 2020 2028 302e  /2.0.        (0.
-00020c90: 3438 3434 2c20 302e 3130 3830 2c20 302e  4844, 0.1080, 0.
-00020ca0: 3035 3430 2c20 302e 3032 3730 290a 2020  0540, 0.0270).  
-00020cb0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00020cc0: 2020 6364 6566 2071 7561 7420 7265 730a    cdef quat res.
-00020cd0: 2020 2020 2020 2020 6364 6566 2064 6f75          cdef dou
-00020ce0: 626c 6520 720a 0a20 2020 2020 2020 2074  ble r..        t
-00020cf0: 6220 3d20 7479 7065 2862 290a 0a20 2020  b = type(b)..   
-00020d00: 2020 2020 2069 6620 7462 2069 7320 666c       if tb is fl
-00020d10: 6f61 7420 6f72 2074 6220 6973 2069 6e74  oat or tb is int
-00020d20: 206f 7220 7462 2069 7320 6c6f 6e67 3a0a   or tb is long:.
-00020d30: 2020 2020 2020 2020 2020 2020 2320 7175              # qu
-00020d40: 6174 2f73 6361 6c61 720a 2020 2020 2020  at/scalar.      
-00020d50: 2020 2020 2020 7265 7320 3d20 7175 6174        res = quat
-00020d60: 2829 0a20 2020 2020 2020 2020 2020 2072  ().            r
-00020d70: 203d 2062 0a20 2020 2020 2020 2020 2020   = b.           
-00020d80: 2069 6620 6661 6273 2872 293c 3d65 7073   if fabs(r)<=eps
-00020d90: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00020da0: 2020 7261 6973 6520 5a65 726f 4469 7669    raise ZeroDivi
-00020db0: 7369 6f6e 4572 726f 722c 2271 7561 7420  sionError,"quat 
-00020dc0: 6469 7669 7369 6f6e 220a 2020 2020 2020  division".      
-00020dd0: 2020 2020 2020 7265 732e 7720 3d20 612e        res.w = a.
-00020de0: 772f 720a 2020 2020 2020 2020 2020 2020  w/r.            
-00020df0: 7265 732e 7820 3d20 612e 782f 720a 2020  res.x = a.x/r.  
-00020e00: 2020 2020 2020 2020 2020 7265 732e 7920            res.y 
-00020e10: 3d20 612e 792f 720a 2020 2020 2020 2020  = a.y/r.        
-00020e20: 2020 2020 7265 732e 7a20 3d20 612e 7a2f      res.z = a.z/
-00020e30: 720a 2020 2020 2020 2020 2020 2020 7265  r.            re
-00020e40: 7475 726e 2072 6573 0a20 2020 2020 2020  turn res.       
-00020e50: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00020e60: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
-00020e70: 6f72 2c20 2275 6e73 7570 706f 7274 6564  or, "unsupported
-00020e80: 206f 7065 7261 6e64 2074 7970 6520 666f   operand type fo
-00020e90: 7220 2f22 0a0a 2020 2020 6465 6620 5f5f  r /"..    def __
-00020ea0: 706f 775f 5f28 7175 6174 2073 656c 662c  pow__(quat self,
-00020eb0: 206f 7468 6572 2c20 6d6f 6475 6c6f 293a   other, modulo):
-00020ec0: 0a20 2020 2020 2020 2022 2222 5265 7475  .        """Retu
-00020ed0: 726e 2073 656c 662a 2a71 2e22 2222 0a20  rn self**q.""". 
-00020ee0: 2020 2020 2020 2063 6465 6620 7175 6174         cdef quat
-00020ef0: 2071 0a20 2020 2020 2020 2069 6620 6d6f   q.        if mo
-00020f00: 6475 6c6f 213d 4e6f 6e65 3a0a 2020 2020  dulo!=None:.    
-00020f10: 2020 2020 2020 2020 7261 6973 6520 5479          raise Ty
-00020f20: 7065 4572 726f 722c 2022 756e 7375 7070  peError, "unsupp
-00020f30: 6f72 7465 6420 6f70 6572 6174 696f 6e22  orted operation"
-00020f40: 0a20 2020 2020 2020 2071 203d 2071 7561  .        q = qua
-00020f50: 7428 6f74 6865 7229 0a20 2020 2020 2020  t(other).       
-00020f60: 2072 6574 7572 6e20 2871 2a73 656c 662e   return (q*self.
-00020f70: 6c6f 6728 2929 2e65 7870 2829 0a0a 2020  log()).exp()..  
-00020f80: 2020 6465 6620 5f5f 6e65 675f 5f28 7365    def __neg__(se
-00020f90: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
-00020fa0: 4e65 6761 7469 6f6e 2e0a 0a20 2020 2020  Negation...     
-00020fb0: 2020 203e 3e3e 2071 3d71 7561 7428 302e     >>> q=quat(0.
-00020fc0: 3936 3839 2c20 302e 3231 3630 2c20 302e  9689, 0.2160, 0.
-00020fd0: 3130 3830 2c20 302e 3035 3430 290a 2020  1080, 0.0540).  
-00020fe0: 2020 2020 2020 3e3e 3e20 7072 696e 7420        >>> print 
-00020ff0: 2d71 0a20 2020 2020 2020 2028 2d30 2e39  -q.        (-0.9
-00021000: 3638 392c 202d 302e 3231 3630 2c20 2d30  689, -0.2160, -0
-00021010: 2e31 3038 302c 202d 302e 3035 3430 290a  .1080, -0.0540).
-00021020: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00021030: 2020 2020 6364 6566 2071 7561 7420 7265      cdef quat re
-00021040: 730a 2020 2020 2020 2020 7265 7320 3d20  s.        res = 
-00021050: 7175 6174 2829 0a20 2020 2020 2020 2072  quat().        r
-00021060: 6573 2e77 203d 202d 7365 6c66 2e77 0a20  es.w = -self.w. 
-00021070: 2020 2020 2020 2072 6573 2e78 203d 202d         res.x = -
-00021080: 7365 6c66 2e78 0a20 2020 2020 2020 2072  self.x.        r
-00021090: 6573 2e79 203d 202d 7365 6c66 2e79 0a20  es.y = -self.y. 
-000210a0: 2020 2020 2020 2072 6573 2e7a 203d 202d         res.z = -
-000210b0: 7365 6c66 2e7a 0a20 2020 2020 2020 2072  self.z.        r
-000210c0: 6574 7572 6e20 7265 730a 0a20 2020 2064  eturn res..    d
-000210d0: 6566 205f 5f70 6f73 5f5f 2873 656c 6629  ef __pos__(self)
-000210e0: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-000210f0: 2020 2020 2020 3e3e 3e20 713d 7175 6174        >>> q=quat
-00021100: 2830 2e39 3638 392c 2030 2e32 3136 302c  (0.9689, 0.2160,
-00021110: 2030 2e31 3038 302c 2030 2e30 3534 3029   0.1080, 0.0540)
-00021120: 0a20 2020 2020 2020 203e 3e3e 2070 7269  .        >>> pri
-00021130: 6e74 202b 710a 2020 2020 2020 2020 2830  nt +q.        (0
-00021140: 2e39 3638 392c 2030 2e32 3136 302c 2030  .9689, 0.2160, 0
-00021150: 2e31 3038 302c 2030 2e30 3534 3029 0a20  .1080, 0.0540). 
-00021160: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00021170: 2020 2063 6465 6620 7175 6174 2072 6573     cdef quat res
-00021180: 0a20 2020 2020 2020 2072 6573 203d 2071  .        res = q
-00021190: 7561 7428 290a 2020 2020 2020 2020 7265  uat().        re
-000211a0: 732e 7720 3d20 7365 6c66 2e77 0a20 2020  s.w = self.w.   
-000211b0: 2020 2020 2072 6573 2e78 203d 2073 656c       res.x = sel
-000211c0: 662e 780a 2020 2020 2020 2020 7265 732e  f.x.        res.
-000211d0: 7920 3d20 7365 6c66 2e79 0a20 2020 2020  y = self.y.     
-000211e0: 2020 2072 6573 2e7a 203d 2073 656c 662e     res.z = self.
-000211f0: 7a0a 2020 2020 2020 2020 7265 7475 726e  z.        return
-00021200: 2072 6573 0a0a 2020 2020 6465 6620 5f5f   res..    def __
-00021210: 6961 6464 5f5f 2873 656c 662c 2071 7561  iadd__(self, qua
-00021220: 7420 6f74 6865 7229 3a0a 2020 2020 2020  t other):.      
-00021230: 2020 2222 2249 6e6c 696e 6520 7175 6174    """Inline quat
-00021240: 6572 6e69 6f6e 2061 6464 6974 696f 6e2e  ernion addition.
-00021250: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00021260: 2020 2020 2073 656c 662e 773d 7365 6c66       self.w=self
-00021270: 2e77 2b6f 7468 6572 2e77 0a20 2020 2020  .w+other.w.     
-00021280: 2020 2073 656c 662e 783d 7365 6c66 2e78     self.x=self.x
-00021290: 2b6f 7468 6572 2e78 0a20 2020 2020 2020  +other.x.       
-000212a0: 2073 656c 662e 793d 7365 6c66 2e79 2b6f   self.y=self.y+o
-000212b0: 7468 6572 2e79 0a20 2020 2020 2020 2073  ther.y.        s
-000212c0: 656c 662e 7a3d 7365 6c66 2e7a 2b6f 7468  elf.z=self.z+oth
-000212d0: 6572 2e7a 0a20 2020 2020 2020 2072 6574  er.z.        ret
-000212e0: 7572 6e20 7365 6c66 0a0a 2020 2020 6465  urn self..    de
-000212f0: 6620 5f5f 6973 7562 5f5f 2873 656c 662c  f __isub__(self,
-00021300: 2071 7561 7420 6f74 6865 7229 3a0a 2020   quat other):.  
-00021310: 2020 2020 2020 2222 2249 6e6c 696e 6520        """Inline 
-00021320: 7175 6174 6572 6e69 6f6e 2073 7562 7472  quaternion subtr
-00021330: 6163 7469 6f6e 2e0a 2020 2020 2020 2020  action..        
-00021340: 2222 220a 2020 2020 2020 2020 7365 6c66  """.        self
-00021350: 2e77 3d73 656c 662e 772d 6f74 6865 722e  .w=self.w-other.
-00021360: 770a 2020 2020 2020 2020 7365 6c66 2e78  w.        self.x
-00021370: 3d73 656c 662e 782d 6f74 6865 722e 780a  =self.x-other.x.
-00021380: 2020 2020 2020 2020 7365 6c66 2e79 3d73          self.y=s
-00021390: 656c 662e 792d 6f74 6865 722e 790a 2020  elf.y-other.y.  
-000213a0: 2020 2020 2020 7365 6c66 2e7a 3d73 656c        self.z=sel
-000213b0: 662e 7a2d 6f74 6865 722e 7a0a 2020 2020  f.z-other.z.    
-000213c0: 2020 2020 7265 7475 726e 2073 656c 660a      return self.
-000213d0: 0a20 2020 2064 6566 205f 5f69 6d75 6c5f  .    def __imul_
-000213e0: 5f28 7365 6c66 2c20 6f74 6865 7229 3a0a  _(self, other):.
-000213f0: 2020 2020 2020 2020 2222 2249 6e6c 696e          """Inlin
-00021400: 6520 6d75 6c74 6970 6c69 6361 7469 6f6e  e multiplication
-00021410: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-00021420: 2020 2020 2020 6364 6566 2071 7561 7420        cdef quat 
-00021430: 7662 0a20 2020 2020 2020 2063 6465 6620  vb.        cdef 
-00021440: 646f 7562 6c65 2072 0a20 2020 2020 2020  double r.       
-00021450: 2063 6465 6620 646f 7562 6c65 2077 2c78   cdef double w,x
-00021460: 2c79 2c7a 0a0a 2020 2020 2020 2020 5420  ,y,z..        T 
-00021470: 3d20 7479 7065 286f 7468 6572 290a 0a20  = type(other).. 
-00021480: 2020 2020 2020 2069 6620 5420 6973 2071         if T is q
-00021490: 7561 743a 0a20 2020 2020 2020 2020 2020  uat:.           
-000214a0: 2023 2071 7561 742a 3d71 7561 740a 2020   # quat*=quat.  
-000214b0: 2020 2020 2020 2020 2020 7662 203d 206f            vb = o
-000214c0: 7468 6572 0a20 2020 2020 2020 2020 2020  ther.           
-000214d0: 2077 203d 2073 656c 662e 772a 7662 2e77   w = self.w*vb.w
-000214e0: 202d 2073 656c 662e 782a 7662 2e78 202d   - self.x*vb.x -
-000214f0: 2073 656c 662e 792a 7662 2e79 202d 2073   self.y*vb.y - s
-00021500: 656c 662e 7a2a 7662 2e7a 0a20 2020 2020  elf.z*vb.z.     
-00021510: 2020 2020 2020 2078 203d 2073 656c 662e         x = self.
-00021520: 772a 7662 2e78 202b 2073 656c 662e 782a  w*vb.x + self.x*
-00021530: 7662 2e77 202b 2073 656c 662e 792a 7662  vb.w + self.y*vb
-00021540: 2e7a 202d 2073 656c 662e 7a2a 7662 2e79  .z - self.z*vb.y
-00021550: 0a20 2020 2020 2020 2020 2020 2079 203d  .            y =
-00021560: 2073 656c 662e 772a 7662 2e79 202b 2073   self.w*vb.y + s
-00021570: 656c 662e 792a 7662 2e77 202d 2073 656c  elf.y*vb.w - sel
-00021580: 662e 782a 7662 2e7a 202b 2073 656c 662e  f.x*vb.z + self.
-00021590: 7a2a 7662 2e78 0a20 2020 2020 2020 2020  z*vb.x.         
-000215a0: 2020 207a 203d 2073 656c 662e 772a 7662     z = self.w*vb
-000215b0: 2e7a 202b 2073 656c 662e 7a2a 7662 2e77  .z + self.z*vb.w
-000215c0: 202b 2073 656c 662e 782a 7662 2e79 202d   + self.x*vb.y -
-000215d0: 2073 656c 662e 792a 7662 2e78 0a20 2020   self.y*vb.x.   
-000215e0: 2020 2020 2020 2020 2073 656c 662e 7720           self.w 
-000215f0: 3d20 770a 2020 2020 2020 2020 2020 2020  = w.            
-00021600: 7365 6c66 2e78 203d 2078 0a20 2020 2020  self.x = x.     
-00021610: 2020 2020 2020 2073 656c 662e 7920 3d20         self.y = 
-00021620: 790a 2020 2020 2020 2020 2020 2020 7365  y.            se
-00021630: 6c66 2e7a 203d 207a 0a20 2020 2020 2020  lf.z = z.       
-00021640: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00021650: 0a0a 2020 2020 2020 2020 656c 6966 2054  ..        elif T
-00021660: 2069 7320 666c 6f61 7420 6f72 2054 2069   is float or T i
-00021670: 7320 696e 7420 6f72 2054 2069 7320 6c6f  s int or T is lo
-00021680: 6e67 3a0a 2020 2020 2020 2020 2020 2020  ng:.            
-00021690: 2320 7175 6174 2a3d 7363 616c 6172 0a20  # quat*=scalar. 
-000216a0: 2020 2020 2020 2020 2020 2072 2020 203d             r   =
-000216b0: 206f 7468 6572 0a20 2020 2020 2020 2020   other.         
-000216c0: 2020 2073 656c 662e 7720 3d20 7365 6c66     self.w = self
-000216d0: 2e77 2a72 0a20 2020 2020 2020 2020 2020  .w*r.           
-000216e0: 2073 656c 662e 7820 3d20 7365 6c66 2e78   self.x = self.x
-000216f0: 2a72 0a20 2020 2020 2020 2020 2020 2073  *r.            s
-00021700: 656c 662e 7920 3d20 7365 6c66 2e79 2a72  elf.y = self.y*r
-00021710: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00021720: 662e 7a20 3d20 7365 6c66 2e7a 2a72 0a20  f.z = self.z*r. 
-00021730: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00021740: 6e20 7365 6c66 0a0a 2020 2020 2020 2020  n self..        
-00021750: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00021760: 2020 7261 6973 6520 5479 7065 4572 726f    raise TypeErro
-00021770: 722c 2022 756e 7375 7070 6f72 7465 6420  r, "unsupported 
-00021780: 6f70 6572 616e 6420 7479 7065 2066 6f72  operand type for
-00021790: 202a 3d22 0a0a 2020 2020 6465 6620 5f5f   *="..    def __
-000217a0: 6964 6976 5f5f 2873 656c 662c 206f 7468  idiv__(self, oth
-000217b0: 6572 293a 0a20 2020 2020 2020 2022 2222  er):.        """
-000217c0: 496e 6c69 6e65 2064 6976 6973 696f 6e20  Inline division 
-000217d0: 7769 7468 2073 6361 6c61 722e 0a20 2020  with scalar..   
-000217e0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-000217f0: 2063 6465 6620 646f 7562 6c65 2072 0a20   cdef double r. 
-00021800: 2020 2020 2020 2074 6220 3d20 7479 7065         tb = type
-00021810: 286f 7468 6572 290a 2020 2020 2020 2020  (other).        
-00021820: 6966 2074 6220 6973 2066 6c6f 6174 206f  if tb is float o
-00021830: 7220 7462 2069 7320 696e 7420 6f72 2074  r tb is int or t
-00021840: 6220 6973 206c 6f6e 673a 0a20 2020 2020  b is long:.     
-00021850: 2020 2020 2020 2072 3d6f 7468 6572 0a20         r=other. 
-00021860: 2020 2020 2020 2020 2020 2069 6620 6661             if fa
-00021870: 6273 2872 293c 3d65 7073 3a0a 2020 2020  bs(r)<=eps:.    
-00021880: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00021890: 6520 5a65 726f 4469 7669 7369 6f6e 4572  e ZeroDivisionEr
-000218a0: 726f 722c 2271 7561 7420 6469 7669 7369  ror,"quat divisi
-000218b0: 6f6e 220a 2020 2020 2020 2020 2020 2020  on".            
-000218c0: 7365 6c66 2e77 3d73 656c 662e 772f 720a  self.w=self.w/r.
-000218d0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000218e0: 2e78 3d73 656c 662e 782f 720a 2020 2020  .x=self.x/r.    
-000218f0: 2020 2020 2020 2020 7365 6c66 2e79 3d73          self.y=s
-00021900: 656c 662e 792f 720a 2020 2020 2020 2020  elf.y/r.        
-00021910: 2020 2020 7365 6c66 2e7a 3d73 656c 662e      self.z=self.
-00021920: 7a2f 720a 2020 2020 2020 2020 2020 2020  z/r.            
-00021930: 7265 7475 726e 2073 656c 660a 2020 2020  return self.    
-00021940: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00021950: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
-00021960: 4572 726f 722c 2022 756e 7375 7070 6f72  Error, "unsuppor
-00021970: 7465 6420 6f70 6572 616e 6420 7479 7065  ted operand type
-00021980: 2066 6f72 202f 3d22 0a0a 2020 2020 6465   for /="..    de
-00021990: 6620 5f5f 6765 7461 7474 725f 5f28 7365  f __getattr__(se
-000219a0: 6c66 2c20 6e61 6d65 293a 0a20 2020 2020  lf, name):.     
-000219b0: 2020 2069 6620 6e61 6d65 3d3d 2277 223a     if name=="w":
-000219c0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-000219d0: 7572 6e20 7365 6c66 2e77 0a20 2020 2020  urn self.w.     
-000219e0: 2020 2065 6c69 6620 6e61 6d65 3d3d 2278     elif name=="x
-000219f0: 223a 0a20 2020 2020 2020 2020 2020 2072  ":.            r
-00021a00: 6574 7572 6e20 7365 6c66 2e78 0a20 2020  eturn self.x.   
-00021a10: 2020 2020 2065 6c69 6620 6e61 6d65 3d3d       elif name==
-00021a20: 2279 223a 0a20 2020 2020 2020 2020 2020  "y":.           
-00021a30: 2072 6574 7572 6e20 7365 6c66 2e79 0a20   return self.y. 
-00021a40: 2020 2020 2020 2065 6c69 6620 6e61 6d65         elif name
-00021a50: 3d3d 227a 223a 0a20 2020 2020 2020 2020  =="z":.         
-00021a60: 2020 2072 6574 7572 6e20 7365 6c66 2e7a     return self.z
-00021a70: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-00021a80: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00021a90: 2041 7474 7269 6275 7465 4572 726f 722c   AttributeError,
-00021aa0: 2271 7561 7420 6861 7320 6e6f 2061 7474  "quat has no att
-00021ab0: 7269 6275 7465 2027 222b 6e61 6d65 2b22  ribute '"+name+"
-00021ac0: 2722 0a0a 2020 2020 6465 6620 5f5f 7365  '"..    def __se
-00021ad0: 7461 7474 725f 5f28 7365 6c66 2c20 6e61  tattr__(self, na
-00021ae0: 6d65 2c20 7661 6c29 3a0a 2020 2020 2020  me, val):.      
-00021af0: 2020 6966 206e 616d 653d 3d22 7722 3a0a    if name=="w":.
-00021b00: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00021b10: 2e77 203d 2076 616c 0a20 2020 2020 2020  .w = val.       
-00021b20: 2065 6c69 6620 6e61 6d65 3d3d 2278 223a   elif name=="x":
-00021b30: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00021b40: 662e 7820 3d20 7661 6c0a 2020 2020 2020  f.x = val.      
-00021b50: 2020 656c 6966 206e 616d 653d 3d22 7922    elif name=="y"
-00021b60: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-00021b70: 6c66 2e79 203d 2076 616c 0a20 2020 2020  lf.y = val.     
-00021b80: 2020 2065 6c69 6620 6e61 6d65 3d3d 227a     elif name=="z
-00021b90: 223a 0a20 2020 2020 2020 2020 2020 2073  ":.            s
-00021ba0: 656c 662e 7a20 3d20 7661 6c0a 2020 2020  elf.z = val.    
-00021bb0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00021bc0: 2020 2020 2020 7261 6973 6520 4174 7472        raise Attr
-00021bd0: 6962 7574 6545 7272 6f72 2c22 7175 6174  ibuteError,"quat
-00021be0: 2068 6173 206e 6f20 7772 6974 6162 6c65   has no writable
-00021bf0: 2061 7474 7269 6275 7465 2027 222b 6e61   attribute '"+na
-00021c00: 6d65 2b22 2722 0a0a 0a20 2020 2064 6566  me+"'"...    def
-00021c10: 205f 5f61 6273 5f5f 2873 656c 6629 3a0a   __abs__(self):.
-00021c20: 2020 2020 2020 2020 2222 2252 6574 7572          """Retur
-00021c30: 6e20 6d61 676e 6974 7564 652e 0a0a 2020  n magnitude...  
-00021c40: 2020 2020 2020 3e3e 3e20 713d 7175 6174        >>> q=quat
-00021c50: 2830 2e39 3638 392c 2030 2e32 3136 302c  (0.9689, 0.2160,
-00021c60: 2030 2e31 3038 302c 2030 2e30 3534 3029   0.1080, 0.0540)
-00021c70: 0a20 2020 2020 2020 203e 3e3e 2070 7269  .        >>> pri
-00021c80: 6e74 2072 6f75 6e64 2861 6273 2871 292c  nt round(abs(q),
-00021c90: 3529 0a20 2020 2020 2020 2031 2e30 0a20  5).        1.0. 
-00021ca0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00021cb0: 2020 2063 6465 6620 646f 7562 6c65 2061     cdef double a
-00021cc0: 0a20 2020 2020 2020 2061 203d 2073 656c  .        a = sel
-00021cd0: 662e 772a 7365 6c66 2e77 202b 2073 656c  f.w*self.w + sel
-00021ce0: 662e 782a 7365 6c66 2e78 202b 2073 656c  f.x*self.x + sel
-00021cf0: 662e 792a 7365 6c66 2e79 202b 2073 656c  f.y*self.y + sel
-00021d00: 662e 7a2a 7365 6c66 2e7a 0a20 2020 2020  f.z*self.z.     
-00021d10: 2020 2072 6574 7572 6e20 7371 7274 2861     return sqrt(a
-00021d20: 290a 0a20 2020 2064 6566 2063 6f6e 6a75  )..    def conju
-00021d30: 6761 7465 2873 656c 6629 3a0a 2020 2020  gate(self):.    
-00021d40: 2020 2020 2222 2252 6574 7572 6e20 636f      """Return co
-00021d50: 6e6a 7567 6174 652e 0a0a 2020 2020 2020  njugate...      
-00021d60: 2020 3e3e 3e20 713d 7175 6174 2830 2e39    >>> q=quat(0.9
-00021d70: 3638 392c 2030 2e32 3136 302c 2030 2e31  689, 0.2160, 0.1
-00021d80: 3038 302c 2030 2e30 3534 3029 0a20 2020  080, 0.0540).   
-00021d90: 2020 2020 203e 3e3e 2070 7269 6e74 2071       >>> print q
-00021da0: 2e63 6f6e 6a75 6761 7465 2829 0a20 2020  .conjugate().   
-00021db0: 2020 2020 2028 302e 3936 3839 2c20 2d30       (0.9689, -0
-00021dc0: 2e32 3136 302c 202d 302e 3130 3830 2c20  .2160, -0.1080, 
-00021dd0: 2d30 2e30 3534 3029 0a20 2020 2020 2020  -0.0540).       
-00021de0: 2022 2222 0a20 2020 2020 2020 2063 6465   """.        cde
-00021df0: 6620 7175 6174 2072 6573 0a20 2020 2020  f quat res.     
-00021e00: 2020 2072 6573 3d71 7561 7428 290a 2020     res=quat().  
-00021e10: 2020 2020 2020 7265 732e 7720 3d20 7365        res.w = se
-00021e20: 6c66 2e77 0a20 2020 2020 2020 2072 6573  lf.w.        res
-00021e30: 2e78 203d 202d 7365 6c66 2e78 0a20 2020  .x = -self.x.   
-00021e40: 2020 2020 2072 6573 2e79 203d 202d 7365       res.y = -se
-00021e50: 6c66 2e79 0a20 2020 2020 2020 2072 6573  lf.y.        res
-00021e60: 2e7a 203d 202d 7365 6c66 2e7a 0a20 2020  .z = -self.z.   
-00021e70: 2020 2020 2072 6574 7572 6e20 7265 730a       return res.
-00021e80: 0a20 2020 2064 6566 206e 6f72 6d61 6c69  .    def normali
-00021e90: 7a65 2873 656c 6629 3a0a 2020 2020 2020  ze(self):.      
-00021ea0: 2020 2222 2252 6574 7572 6e20 6e6f 726d    """Return norm
-00021eb0: 616c 697a 6564 2071 7561 7465 726e 696f  alized quaternio
-00021ec0: 6e2e 0a0a 2020 2020 2020 2020 3e3e 3e20  n...        >>> 
-00021ed0: 713d 7175 6174 2830 2e39 2c20 302e 352c  q=quat(0.9, 0.5,
-00021ee0: 2030 2e32 2c20 302e 3329 0a20 2020 2020   0.2, 0.3).     
-00021ef0: 2020 203e 3e3e 2071 3d71 2e6e 6f72 6d61     >>> q=q.norma
-00021f00: 6c69 7a65 2829 0a20 2020 2020 2020 203e  lize().        >
-00021f10: 3e3e 2070 7269 6e74 2071 0a20 2020 2020  >> print q.     
-00021f20: 2020 2028 302e 3832 3530 2c20 302e 3435     (0.8250, 0.45
-00021f30: 3833 2c20 302e 3138 3333 2c20 302e 3237  83, 0.1833, 0.27
-00021f40: 3530 290a 2020 2020 2020 2020 3e3e 3e20  50).        >>> 
-00021f50: 7072 696e 7420 6162 7328 7129 0a20 2020  print abs(q).   
-00021f60: 2020 2020 2031 2e30 0a20 2020 2020 2020       1.0.       
-00021f70: 2022 2222 0a20 2020 2020 2020 2063 6465   """.        cde
-00021f80: 6620 7175 6174 2072 6573 0a20 2020 2020  f quat res.     
-00021f90: 2020 2063 6465 6620 646f 7562 6c65 206e     cdef double n
-00021fa0: 6c65 6e0a 0a20 2020 2020 2020 206e 6c65  len..        nle
-00021fb0: 6e20 3d20 7371 7274 2873 656c 662e 772a  n = sqrt(self.w*
-00021fc0: 7365 6c66 2e77 2b73 656c 662e 782a 7365  self.w+self.x*se
-00021fd0: 6c66 2e78 2b73 656c 662e 792a 7365 6c66  lf.x+self.y*self
-00021fe0: 2e79 2b73 656c 662e 7a2a 7365 6c66 2e7a  .y+self.z*self.z
-00021ff0: 290a 2020 2020 2020 2020 6966 206e 6c65  ).        if nle
-00022000: 6e3c 3d65 7073 3a0a 2020 2020 2020 2020  n<=eps:.        
-00022010: 2020 2020 7261 6973 6520 5a65 726f 4469      raise ZeroDi
-00022020: 7669 7369 6f6e 4572 726f 722c 2271 7561  visionError,"qua
-00022030: 7420 6469 7669 7369 6f6e 220a 0a20 2020  t division"..   
-00022040: 2020 2020 206e 6c65 6e20 3d20 312e 302f       nlen = 1.0/
-00022050: 6e6c 656e 0a20 2020 2020 2020 2072 6573  nlen.        res
-00022060: 203d 2071 7561 7428 290a 2020 2020 2020   = quat().      
-00022070: 2020 7265 732e 7720 3d20 7365 6c66 2e77    res.w = self.w
-00022080: 2a6e 6c65 6e0a 2020 2020 2020 2020 7265  *nlen.        re
-00022090: 732e 7820 3d20 7365 6c66 2e78 2a6e 6c65  s.x = self.x*nle
-000220a0: 6e0a 2020 2020 2020 2020 7265 732e 7920  n.        res.y 
-000220b0: 3d20 7365 6c66 2e79 2a6e 6c65 6e0a 2020  = self.y*nlen.  
-000220c0: 2020 2020 2020 7265 732e 7a20 3d20 7365        res.z = se
-000220d0: 6c66 2e7a 2a6e 6c65 6e0a 2020 2020 2020  lf.z*nlen.      
-000220e0: 2020 7265 7475 726e 2072 6573 0a0a 2020    return res..  
-000220f0: 2020 6465 6620 696e 7665 7273 6528 7365    def inverse(se
-00022100: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
-00022110: 5265 7475 726e 2069 6e76 6572 7365 2e0a  Return inverse..
-00022120: 0a20 2020 2020 2020 203e 3e3e 2071 3d71  .        >>> q=q
-00022130: 7561 7428 302e 392c 2030 2e35 2c20 302e  uat(0.9, 0.5, 0.
-00022140: 322c 2030 2e33 290a 2020 2020 2020 2020  2, 0.3).        
-00022150: 3e3e 3e20 7072 696e 7420 712e 696e 7665  >>> print q.inve
-00022160: 7273 6528 290a 2020 2020 2020 2020 2830  rse().        (0
-00022170: 2e37 3536 332c 202d 302e 3432 3032 2c20  .7563, -0.4202, 
-00022180: 2d30 2e31 3638 312c 202d 302e 3235 3231  -0.1681, -0.2521
-00022190: 290a 2020 2020 2020 2020 2222 220a 2020  ).        """.  
-000221a0: 2020 2020 2020 6364 6566 2071 7561 7420        cdef quat 
-000221b0: 7265 730a 0a20 2020 2020 2020 206c 656e  res..        len
-000221c0: 5f32 203d 2073 656c 662e 772a 7365 6c66  _2 = self.w*self
-000221d0: 2e77 2b73 656c 662e 782a 7365 6c66 2e78  .w+self.x*self.x
-000221e0: 2b73 656c 662e 792a 7365 6c66 2e79 2b73  +self.y*self.y+s
-000221f0: 656c 662e 7a2a 7365 6c66 2e7a 0a20 2020  elf.z*self.z.   
-00022200: 2020 2020 2069 6620 6661 6273 286c 656e       if fabs(len
-00022210: 5f32 293c 3d65 7073 3a0a 2020 2020 2020  _2)<=eps:.      
-00022220: 2020 2020 2020 7261 6973 6520 5a65 726f        raise Zero
-00022230: 4469 7669 7369 6f6e 4572 726f 722c 2271  DivisionError,"q
-00022240: 7561 7420 6973 206e 6f74 2069 6e76 6572  uat is not inver
-00022250: 7469 626c 6522 0a0a 2020 2020 2020 2020  tible"..        
-00022260: 6c65 6e5f 3220 3d20 312e 302f 6c65 6e5f  len_2 = 1.0/len_
-00022270: 320a 2020 2020 2020 2020 7265 7320 3d20  2.        res = 
-00022280: 7175 6174 2829 0a20 2020 2020 2020 2072  quat().        r
-00022290: 6573 2e77 203d 2020 7365 6c66 2e77 2a6c  es.w =  self.w*l
-000222a0: 656e 5f32 0a20 2020 2020 2020 2072 6573  en_2.        res
-000222b0: 2e78 203d 202d 7365 6c66 2e78 2a6c 656e  .x = -self.x*len
-000222c0: 5f32 0a20 2020 2020 2020 2072 6573 2e79  _2.        res.y
-000222d0: 203d 202d 7365 6c66 2e79 2a6c 656e 5f32   = -self.y*len_2
-000222e0: 0a20 2020 2020 2020 2072 6573 2e7a 203d  .        res.z =
-000222f0: 202d 7365 6c66 2e7a 2a6c 656e 5f32 0a20   -self.z*len_2. 
-00022300: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
-00022310: 730a 0a20 2020 2064 6566 2074 6f41 6e67  s..    def toAng
-00022320: 6c65 4178 6973 2873 656c 6629 3a0a 2020  leAxis(self):.  
-00022330: 2020 2020 2020 2222 2252 6574 7572 6e20        """Return 
-00022340: 616e 676c 6520 2869 6e20 7261 6469 616e  angle (in radian
-00022350: 7329 2061 6e64 2072 6f74 6174 696f 6e20  s) and rotation 
-00022360: 6178 6973 2e0a 0a20 2020 2020 2020 203e  axis...        >
-00022370: 3e3e 2071 3d71 7561 7428 302e 392c 2030  >> q=quat(0.9, 0
-00022380: 2e35 2c20 302e 322c 2030 2e33 290a 2020  .5, 0.2, 0.3).  
-00022390: 2020 2020 2020 3e3e 3e20 616e 676c 652c        >>> angle,
-000223a0: 2061 7869 7320 3d20 712e 746f 416e 676c   axis = q.toAngl
-000223b0: 6541 7869 7328 290a 2020 2020 2020 2020  eAxis().        
-000223c0: 3e3e 3e20 7072 696e 7420 726f 756e 6428  >>> print round(
-000223d0: 616e 676c 652c 3429 0a20 2020 2020 2020  angle,4).       
-000223e0: 2031 2e32 3031 310a 2020 2020 2020 2020   1.2011.        
-000223f0: 3e3e 3e20 7072 696e 7420 6178 6973 0a20  >>> print axis. 
-00022400: 2020 2020 2020 2028 302e 3831 3131 2c20         (0.8111, 
-00022410: 302e 3332 3434 2c20 302e 3438 3637 290a  0.3244, 0.4867).
-00022420: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00022430: 2020 2020 6364 6566 2071 7561 7420 710a      cdef quat q.
-00022440: 2020 2020 2020 2020 6364 6566 2064 6f75          cdef dou
-00022450: 626c 6520 732c 770a 0a20 2020 2020 2020  ble s,w..       
-00022460: 2071 203d 2073 656c 662e 6e6f 726d 616c   q = self.normal
-00022470: 697a 6528 290a 0a20 2020 2020 2020 2023  ize()..        #
-00022480: 2043 6c61 6d70 206e 7365 6c66 2e77 2028   Clamp nself.w (
-00022490: 7369 6e63 6520 7468 6520 7175 6174 2068  since the quat h
-000224a0: 6173 2074 6f20 6265 206e 6f72 6d61 6c69  as to be normali
-000224b0: 7a65 6420 6974 2073 686f 756c 640a 2020  zed it should.  
-000224c0: 2020 2020 2020 2320 6265 2062 6574 7765        # be betwe
-000224d0: 656e 202d 3120 616e 6420 3120 616e 7977  en -1 and 1 anyw
-000224e0: 6179 2c20 6275 7420 6974 206d 6967 6874  ay, but it might
-000224f0: 2062 6520 736c 6967 6874 6c79 206f 6666   be slightly off
-00022500: 2064 7565 0a20 2020 2020 2020 2023 2074   due.        # t
-00022510: 6f20 6e75 6d65 7269 6361 6c20 696e 6163  o numerical inac
-00022520: 6375 7261 6369 6573 290a 2020 2020 2020  curacies).      
-00022530: 2020 6966 2071 2e77 3c2d 312e 303a 0a20    if q.w<-1.0:. 
-00022540: 2020 2020 2020 2020 2020 2077 203d 202d             w = -
-00022550: 312e 300a 2020 2020 2020 2020 656c 6966  1.0.        elif
-00022560: 2071 2e77 3e31 2e30 3a0a 2020 2020 2020   q.w>1.0:.      
-00022570: 2020 2020 2020 7720 3d20 312e 300a 2020        w = 1.0.  
-00022580: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-00022590: 2020 2020 2020 2020 7720 3d20 712e 770a          w = q.w.
-000225a0: 0a20 2020 2020 2020 2077 203d 2061 636f  .        w = aco
-000225b0: 7328 7729 0a20 2020 2020 2020 2073 203d  s(w).        s =
-000225c0: 2073 696e 2877 290a 2020 2020 2020 2020   sin(w).        
-000225d0: 6966 2073 3c3d 6570 733a 0a20 2020 2020  if s<=eps:.     
-000225e0: 2020 2020 2020 2072 6574 7572 6e20 2830         return (0
-000225f0: 2e30 2c20 7665 6333 2830 2e30 2c30 2e30  .0, vec3(0.0,0.0
-00022600: 2c30 2e30 2929 0a0a 2020 2020 2020 2020  ,0.0))..        
-00022610: 7265 7475 726e 2028 322e 302a 772c 2076  return (2.0*w, v
-00022620: 6563 3328 712e 782f 732c 2071 2e79 2f73  ec3(q.x/s, q.y/s
-00022630: 2c20 712e 7a2f 7329 290a 0a20 2020 2064  , q.z/s))..    d
-00022640: 6566 2066 726f 6d41 6e67 6c65 4178 6973  ef fromAngleAxis
-00022650: 2873 656c 662c 2061 6e67 6c65 2c20 6178  (self, angle, ax
-00022660: 6973 293a 0a20 2020 2020 2020 2022 2222  is):.        """
-00022670: 496e 6974 6961 6c69 7a65 2073 656c 6620  Initialize self 
-00022680: 6672 6f6d 2061 6e20 616e 676c 6520 2869  from an angle (i
-00022690: 6e20 7261 6469 616e 7329 2061 6e64 2061  n radians) and a
-000226a0: 6e20 6178 6973 2061 6e64 2072 6574 7572  n axis and retur
-000226b0: 6e73 2073 656c 662e 2222 220a 2020 2020  ns self.""".    
-000226c0: 2020 2020 6364 6566 2064 6f75 626c 6520      cdef double 
-000226d0: 612c 6e2c 2078 2c79 2c7a 0a20 2020 2020  a,n, x,y,z.     
-000226e0: 2020 2063 6465 6620 7175 6174 2071 0a0a     cdef quat q..
-000226f0: 2020 2020 2020 2020 6120 3d20 616e 676c          a = angl
-00022700: 652f 322e 300a 2020 2020 2020 2020 7365  e/2.0.        se
-00022710: 6c66 2e77 203d 2063 6f73 2861 290a 0a20  lf.w = cos(a).. 
-00022720: 2020 2020 2020 2078 203d 2061 7869 735b         x = axis[
-00022730: 305d 0a20 2020 2020 2020 2079 203d 2061  0].        y = a
-00022740: 7869 735b 315d 0a20 2020 2020 2020 207a  xis[1].        z
-00022750: 203d 2061 7869 735b 325d 0a20 2020 2020   = axis[2].     
-00022760: 2020 206e 203d 2078 2a78 2b79 2a79 2b7a     n = x*x+y*y+z
-00022770: 2a7a 0a20 2020 2020 2020 2069 6620 6e3c  *z.        if n<
-00022780: 3d65 7073 3a0a 2020 2020 2020 2020 2020  =eps:.          
-00022790: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-000227a0: 6f72 2c22 6178 6973 206d 7573 746e 2774  or,"axis mustn't
-000227b0: 2062 6520 7468 6520 6e75 6c6c 2076 6563   be the null vec
-000227c0: 746f 7222 0a0a 2020 2020 2020 2020 7320  tor"..        s 
-000227d0: 3d20 7369 6e28 6129 2f6e 0a20 2020 2020  = sin(a)/n.     
-000227e0: 2020 2073 656c 662e 7820 3d20 782a 730a     self.x = x*s.
-000227f0: 2020 2020 2020 2020 7365 6c66 2e79 203d          self.y =
-00022800: 2079 2a73 0a20 2020 2020 2020 2073 656c   y*s.        sel
-00022810: 662e 7a20 3d20 7a2a 730a 0a20 2020 2020  f.z = z*s..     
-00022820: 2020 2023 204e 6f72 6d61 6c69 7a65 2074     # Normalize t
-00022830: 6865 2071 7561 740a 2020 2020 2020 2020  he quat.        
-00022840: 7120 3d20 7365 6c66 2e6e 6f72 6d61 6c69  q = self.normali
-00022850: 7a65 2829 0a20 2020 2020 2020 2073 656c  ze().        sel
-00022860: 662e 7720 3d20 712e 770a 2020 2020 2020  f.w = q.w.      
-00022870: 2020 7365 6c66 2e78 203d 2071 2e78 0a20    self.x = q.x. 
-00022880: 2020 2020 2020 2073 656c 662e 7920 3d20         self.y = 
-00022890: 712e 790a 2020 2020 2020 2020 7365 6c66  q.y.        self
-000228a0: 2e7a 203d 2071 2e7a 0a20 2020 2020 2020  .z = q.z.       
-000228b0: 2072 6574 7572 6e20 7365 6c66 0a0a 2020   return self..  
-000228c0: 2020 6465 6620 746f 4d61 7433 2873 656c    def toMat3(sel
-000228d0: 6629 3a0a 2020 2020 2020 2020 2222 2252  f):.        """R
-000228e0: 6574 7572 6e20 726f 7461 7469 6f6e 206d  eturn rotation m
-000228f0: 6174 7269 7820 6173 206d 6174 332e 2222  atrix as mat3.""
-00022900: 220a 2020 2020 2020 2020 6364 6566 206d  ".        cdef m
-00022910: 6174 3320 7265 730a 2020 2020 2020 2020  at3 res.        
-00022920: 6364 6566 2078 782c 7979 2c7a 7a2c 7879  cdef xx,yy,zz,xy
-00022930: 2c7a 772c 787a 2c79 772c 797a 2c78 770a  ,zw,xz,yw,yz,xw.
-00022940: 0a20 2020 2020 2020 2078 7820 3d20 322e  .        xx = 2.
-00022950: 302a 7365 6c66 2e78 2a73 656c 662e 780a  0*self.x*self.x.
-00022960: 2020 2020 2020 2020 7979 203d 2032 2e30          yy = 2.0
-00022970: 2a73 656c 662e 792a 7365 6c66 2e79 0a20  *self.y*self.y. 
-00022980: 2020 2020 2020 207a 7a20 3d20 322e 302a         zz = 2.0*
-00022990: 7365 6c66 2e7a 2a73 656c 662e 7a0a 2020  self.z*self.z.  
-000229a0: 2020 2020 2020 7879 203d 2032 2e30 2a73        xy = 2.0*s
-000229b0: 656c 662e 782a 7365 6c66 2e79 0a20 2020  elf.x*self.y.   
-000229c0: 2020 2020 207a 7720 3d20 322e 302a 7365       zw = 2.0*se
-000229d0: 6c66 2e7a 2a73 656c 662e 770a 2020 2020  lf.z*self.w.    
-000229e0: 2020 2020 787a 203d 2032 2e30 2a73 656c      xz = 2.0*sel
-000229f0: 662e 782a 7365 6c66 2e7a 0a20 2020 2020  f.x*self.z.     
-00022a00: 2020 2079 7720 3d20 322e 302a 7365 6c66     yw = 2.0*self
-00022a10: 2e79 2a73 656c 662e 770a 2020 2020 2020  .y*self.w.      
-00022a20: 2020 797a 203d 2032 2e30 2a73 656c 662e    yz = 2.0*self.
-00022a30: 792a 7365 6c66 2e7a 0a20 2020 2020 2020  y*self.z.       
-00022a40: 2078 7720 3d20 322e 302a 7365 6c66 2e78   xw = 2.0*self.x
-00022a50: 2a73 656c 662e 770a 0a20 2020 2020 2020  *self.w..       
-00022a60: 2072 6573 203d 206d 6174 3328 290a 2020   res = mat3().  
-00022a70: 2020 2020 2020 7265 732e 6d31 3120 3d20        res.m11 = 
-00022a80: 312e 302d 7979 2d7a 7a0a 2020 2020 2020  1.0-yy-zz.      
-00022a90: 2020 7265 732e 6d31 3220 3d20 7879 2d7a    res.m12 = xy-z
-00022aa0: 770a 2020 2020 2020 2020 7265 732e 6d31  w.        res.m1
-00022ab0: 3320 3d20 787a 2b79 770a 2020 2020 2020  3 = xz+yw.      
-00022ac0: 2020 7265 732e 6d32 3120 3d20 7879 2b7a    res.m21 = xy+z
-00022ad0: 770a 2020 2020 2020 2020 7265 732e 6d32  w.        res.m2
-00022ae0: 3220 3d20 312e 302d 7878 2d7a 7a0a 2020  2 = 1.0-xx-zz.  
-00022af0: 2020 2020 2020 7265 732e 6d32 3320 3d20        res.m23 = 
-00022b00: 797a 2d78 770a 2020 2020 2020 2020 7265  yz-xw.        re
-00022b10: 732e 6d33 3120 3d20 787a 2d79 770a 2020  s.m31 = xz-yw.  
-00022b20: 2020 2020 2020 7265 732e 6d33 3220 3d20        res.m32 = 
-00022b30: 797a 2b78 770a 2020 2020 2020 2020 7265  yz+xw.        re
-00022b40: 732e 6d33 3320 3d20 312e 302d 7878 2d79  s.m33 = 1.0-xx-y
-00022b50: 790a 2020 2020 2020 2020 7265 7475 726e  y.        return
-00022b60: 2072 6573 0a0a 2020 2020 6465 6620 746f   res..    def to
-00022b70: 4d61 7434 2873 656c 6629 3a0a 2020 2020  Mat4(self):.    
-00022b80: 2020 2020 2222 2252 6574 7572 6e20 726f      """Return ro
-00022b90: 7461 7469 6f6e 206d 6174 7269 7820 6173  tation matrix as
-00022ba0: 206d 6174 342e 2222 220a 2020 2020 2020   mat4.""".      
-00022bb0: 2020 6364 6566 206d 6174 3420 7265 730a    cdef mat4 res.
-00022bc0: 2020 2020 2020 2020 6364 6566 2078 782c          cdef xx,
-00022bd0: 7979 2c7a 7a2c 7879 2c7a 772c 787a 2c79  yy,zz,xy,zw,xz,y
-00022be0: 772c 797a 2c78 770a 0a20 2020 2020 2020  w,yz,xw..       
-00022bf0: 2078 7820 3d20 322e 302a 7365 6c66 2e78   xx = 2.0*self.x
-00022c00: 2a73 656c 662e 780a 2020 2020 2020 2020  *self.x.        
-00022c10: 7979 203d 2032 2e30 2a73 656c 662e 792a  yy = 2.0*self.y*
-00022c20: 7365 6c66 2e79 0a20 2020 2020 2020 207a  self.y.        z
-00022c30: 7a20 3d20 322e 302a 7365 6c66 2e7a 2a73  z = 2.0*self.z*s
-00022c40: 656c 662e 7a0a 2020 2020 2020 2020 7879  elf.z.        xy
-00022c50: 203d 2032 2e30 2a73 656c 662e 782a 7365   = 2.0*self.x*se
-00022c60: 6c66 2e79 0a20 2020 2020 2020 207a 7720  lf.y.        zw 
-00022c70: 3d20 322e 302a 7365 6c66 2e7a 2a73 656c  = 2.0*self.z*sel
-00022c80: 662e 770a 2020 2020 2020 2020 787a 203d  f.w.        xz =
-00022c90: 2032 2e30 2a73 656c 662e 782a 7365 6c66   2.0*self.x*self
-00022ca0: 2e7a 0a20 2020 2020 2020 2079 7720 3d20  .z.        yw = 
-00022cb0: 322e 302a 7365 6c66 2e79 2a73 656c 662e  2.0*self.y*self.
-00022cc0: 770a 2020 2020 2020 2020 797a 203d 2032  w.        yz = 2
-00022cd0: 2e30 2a73 656c 662e 792a 7365 6c66 2e7a  .0*self.y*self.z
-00022ce0: 0a20 2020 2020 2020 2078 7720 3d20 322e  .        xw = 2.
-00022cf0: 302a 7365 6c66 2e78 2a73 656c 662e 770a  0*self.x*self.w.
-00022d00: 0a20 2020 2020 2020 2072 6573 203d 206d  .        res = m
-00022d10: 6174 3428 290a 0a20 2020 2020 2020 2072  at4()..        r
-00022d20: 6573 2e6d 3131 203d 2031 2e30 2d79 792d  es.m11 = 1.0-yy-
-00022d30: 7a7a 0a20 2020 2020 2020 2072 6573 2e6d  zz.        res.m
-00022d40: 3132 203d 2078 792d 7a77 0a20 2020 2020  12 = xy-zw.     
-00022d50: 2020 2072 6573 2e6d 3133 203d 2078 7a2b     res.m13 = xz+
-00022d60: 7977 0a20 2020 2020 2020 2072 6573 2e6d  yw.        res.m
-00022d70: 3134 203d 2030 2e30 0a20 2020 2020 2020  14 = 0.0.       
-00022d80: 2072 6573 2e6d 3231 203d 2078 792b 7a77   res.m21 = xy+zw
-00022d90: 0a20 2020 2020 2020 2072 6573 2e6d 3232  .        res.m22
-00022da0: 203d 2031 2e30 2d78 782d 7a7a 0a20 2020   = 1.0-xx-zz.   
-00022db0: 2020 2020 2072 6573 2e6d 3233 203d 2079       res.m23 = y
-00022dc0: 7a2d 7877 0a20 2020 2020 2020 2072 6573  z-xw.        res
-00022dd0: 2e6d 3234 203d 2030 2e30 0a20 2020 2020  .m24 = 0.0.     
-00022de0: 2020 2072 6573 2e6d 3331 203d 2078 7a2d     res.m31 = xz-
-00022df0: 7977 0a20 2020 2020 2020 2072 6573 2e6d  yw.        res.m
-00022e00: 3332 203d 2079 7a2b 7877 0a20 2020 2020  32 = yz+xw.     
-00022e10: 2020 2072 6573 2e6d 3333 203d 2031 2e30     res.m33 = 1.0
-00022e20: 2d78 782d 7979 0a20 2020 2020 2020 2072  -xx-yy.        r
-00022e30: 6573 2e6d 3334 203d 2030 2e30 0a20 2020  es.m34 = 0.0.   
-00022e40: 2020 2020 2072 6573 2e6d 3431 203d 2030       res.m41 = 0
-00022e50: 2e30 0a20 2020 2020 2020 2072 6573 2e6d  .0.        res.m
-00022e60: 3432 203d 2030 2e30 0a20 2020 2020 2020  42 = 0.0.       
-00022e70: 2072 6573 2e6d 3433 203d 2030 2e30 0a20   res.m43 = 0.0. 
-00022e80: 2020 2020 2020 2072 6573 2e6d 3434 203d         res.m44 =
-00022e90: 2031 2e30 0a20 2020 2020 2020 2072 6574   1.0.        ret
-00022ea0: 7572 6e20 7265 730a 0a20 2020 2064 6566  urn res..    def
-00022eb0: 2066 726f 6d4d 6174 2873 656c 662c 206d   fromMat(self, m
-00022ec0: 293a 0a20 2020 2020 2020 2022 2222 496e  ):.        """In
-00022ed0: 6974 6961 6c69 7a65 2073 656c 6620 6672  itialize self fr
-00022ee0: 6f6d 2065 6974 6865 7220 6120 6d61 7433  om either a mat3
-00022ef0: 206f 7220 6d61 7434 2061 6e64 2072 6574   or mat4 and ret
-00022f00: 7572 6e73 2073 656c 662e 2222 220a 2020  urns self.""".  
-00022f10: 2020 2020 2020 6364 6566 2064 6f75 626c        cdef doubl
-00022f20: 6520 6431 2c64 322c 6433 2c61 6431 2c61  e d1,d2,d3,ad1,a
-00022f30: 6432 2c61 6433 2c74 2c73 0a0a 2020 2020  d2,ad3,t,s..    
-00022f40: 2020 2020 6431 203d 206d 5b30 2c30 5d0a      d1 = m[0,0].
-00022f50: 2020 2020 2020 2020 6432 203d 206d 5b31          d2 = m[1
-00022f60: 2c31 5d0a 2020 2020 2020 2020 6433 203d  ,1].        d3 =
-00022f70: 206d 5b32 2c32 5d0a 2020 2020 2020 2020   m[2,2].        
-00022f80: 7420 3d20 6431 2b64 322b 6433 2b31 2e30  t = d1+d2+d3+1.0
-00022f90: 0a20 2020 2020 2020 2069 6620 743e 302e  .        if t>0.
-00022fa0: 303a 0a20 2020 2020 2020 2020 2020 2073  0:.            s
-00022fb0: 203d 2030 2e35 2f73 7172 7428 7429 0a20   = 0.5/sqrt(t). 
-00022fc0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00022fd0: 7720 3d20 302e 3235 2f73 0a20 2020 2020  w = 0.25/s.     
-00022fe0: 2020 2020 2020 2073 656c 662e 7820 3d20         self.x = 
-00022ff0: 286d 5b32 2c31 5d2d 6d5b 312c 325d 292a  (m[2,1]-m[1,2])*
-00023000: 730a 2020 2020 2020 2020 2020 2020 7365  s.            se
-00023010: 6c66 2e79 203d 2028 6d5b 302c 325d 2d6d  lf.y = (m[0,2]-m
-00023020: 5b32 2c30 5d29 2a73 0a20 2020 2020 2020  [2,0])*s.       
-00023030: 2020 2020 2073 656c 662e 7a20 3d20 286d       self.z = (m
-00023040: 5b31 2c30 5d2d 6d5b 302c 315d 292a 730a  [1,0]-m[0,1])*s.
-00023050: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00023060: 2020 2020 2020 2020 2020 6164 3120 3d20            ad1 = 
-00023070: 6661 6273 2864 3129 0a20 2020 2020 2020  fabs(d1).       
-00023080: 2020 2020 2061 6432 203d 2066 6162 7328       ad2 = fabs(
-00023090: 6432 290a 2020 2020 2020 2020 2020 2020  d2).            
-000230a0: 6164 3320 3d20 6661 6273 2864 3329 0a20  ad3 = fabs(d3). 
-000230b0: 2020 2020 2020 2020 2020 2069 6620 6164             if ad
-000230c0: 313e 3d61 6432 2061 6e64 2061 6431 3e3d  1>=ad2 and ad1>=
-000230d0: 6164 333a 0a20 2020 2020 2020 2020 2020  ad3:.           
-000230e0: 2020 2020 2073 203d 2073 7172 7428 312e       s = sqrt(1.
-000230f0: 302b 6431 2d64 322d 6433 292a 322e 300a  0+d1-d2-d3)*2.0.
-00023100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023110: 7365 6c66 2e78 203d 2030 2e35 2f73 0a20  self.x = 0.5/s. 
-00023120: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00023130: 656c 662e 7920 3d20 286d 5b30 2c31 5d2b  elf.y = (m[0,1]+
-00023140: 6d5b 312c 305d 292f 730a 2020 2020 2020  m[1,0])/s.      
-00023150: 2020 2020 2020 2020 2020 7365 6c66 2e7a            self.z
-00023160: 203d 2028 6d5b 302c 325d 2b6d 5b32 2c30   = (m[0,2]+m[2,0
-00023170: 5d29 2f73 0a20 2020 2020 2020 2020 2020  ])/s.           
-00023180: 2020 2020 2073 656c 662e 7720 3d20 286d       self.w = (m
-00023190: 5b31 2c32 5d2b 6d5b 322c 315d 292f 730a  [1,2]+m[2,1])/s.
-000231a0: 2020 2020 2020 2020 2020 2020 656c 6966              elif
-000231b0: 2061 6432 3e3d 6164 3120 616e 6420 6164   ad2>=ad1 and ad
-000231c0: 323e 3d61 6433 3a0a 2020 2020 2020 2020  2>=ad3:.        
-000231d0: 2020 2020 2020 2020 7320 3d20 7371 7274          s = sqrt
-000231e0: 2831 2e30 2b64 322d 6431 2d64 3329 2a32  (1.0+d2-d1-d3)*2
-000231f0: 2e30 0a20 2020 2020 2020 2020 2020 2020  .0.             
-00023200: 2020 2073 656c 662e 7820 3d20 286d 5b30     self.x = (m[0
-00023210: 2c31 5d2b 6d5b 312c 305d 292f 730a 2020  ,1]+m[1,0])/s.  
-00023220: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00023230: 6c66 2e79 203d 2030 2e35 2f73 0a20 2020  lf.y = 0.5/s.   
-00023240: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00023250: 662e 7a20 3d20 286d 5b31 2c32 5d2b 6d5b  f.z = (m[1,2]+m[
-00023260: 322c 315d 292f 730a 2020 2020 2020 2020  2,1])/s.        
-00023270: 2020 2020 2020 2020 7365 6c66 2e77 203d          self.w =
-00023280: 2028 6d5b 302c 325d 2b6d 5b32 2c30 5d29   (m[0,2]+m[2,0])
-00023290: 2f73 0a20 2020 2020 2020 2020 2020 2065  /s.            e
-000232a0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-000232b0: 2020 2020 2073 203d 2073 7172 7428 312e       s = sqrt(1.
-000232c0: 302b 6433 2d64 312d 6432 292a 322e 300a  0+d3-d1-d2)*2.0.
-000232d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000232e0: 7365 6c66 2e78 203d 2028 6d5b 302c 325d  self.x = (m[0,2]
-000232f0: 2b6d 5b32 2c30 5d29 2f73 0a20 2020 2020  +m[2,0])/s.     
-00023300: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00023310: 7920 3d20 286d 5b31 2c32 5d2b 6d5b 322c  y = (m[1,2]+m[2,
-00023320: 315d 292f 730a 2020 2020 2020 2020 2020  1])/s.          
-00023330: 2020 2020 2020 7365 6c66 2e7a 203d 2030        self.z = 0
-00023340: 2e35 2f73 0a20 2020 2020 2020 2020 2020  .5/s.           
-00023350: 2020 2020 2073 656c 662e 7720 3d20 286d       self.w = (m
-00023360: 5b30 2c31 5d2b 6d5b 312c 305d 292f 730a  [0,1]+m[1,0])/s.
-00023370: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00023380: 7365 6c66 0a0a 2020 2020 6465 6620 646f  self..    def do
-00023390: 7428 7365 6c66 2c20 7175 6174 2062 293a  t(self, quat b):
-000233a0: 0a20 2020 2020 2020 2022 2222 5265 7475  .        """Retu
-000233b0: 726e 2074 6865 2064 6f74 2070 726f 6475  rn the dot produ
-000233c0: 6374 206f 6620 7365 6c66 2061 6e64 2062  ct of self and b
-000233d0: 2e22 2222 0a20 2020 2020 2020 2072 6574  .""".        ret
-000233e0: 7572 6e20 7365 6c66 2e77 2a62 2e77 202b  urn self.w*b.w +
-000233f0: 2073 656c 662e 782a 622e 7820 2b20 7365   self.x*b.x + se
-00023400: 6c66 2e79 2a62 2e79 202b 2073 656c 662e  lf.y*b.y + self.
-00023410: 7a2a 622e 7a0a 0a20 2020 2064 6566 206c  z*b.z..    def l
-00023420: 6f67 2873 656c 6629 3a0a 2020 2020 2020  og(self):.      
-00023430: 2020 2222 2252 6574 7572 6e20 7468 6520    """Return the 
-00023440: 6e61 7475 7261 6c20 6c6f 6761 7269 7468  natural logarith
-00023450: 6d20 6f66 2073 656c 662e 2222 220a 0a20  m of self.""".. 
-00023460: 2020 2020 2020 2063 6465 6620 646f 7562         cdef doub
-00023470: 6c65 2062 2c20 742c 2066 2c20 6374 2c20  le b, t, f, ct, 
-00023480: 720a 2020 2020 2020 2020 6364 6566 2071  r.        cdef q
-00023490: 7561 7420 7265 730a 0a20 2020 2020 2020  uat res..       
-000234a0: 2062 203d 2073 7172 7428 7365 6c66 2e78   b = sqrt(self.x
-000234b0: 2a73 656c 662e 7820 2b20 7365 6c66 2e79  *self.x + self.y
-000234c0: 2a73 656c 662e 7920 2b20 7365 6c66 2e7a  *self.y + self.z
-000234d0: 2a73 656c 662e 7a29 0a20 2020 2020 2020  *self.z).       
-000234e0: 2072 6573 203d 2071 7561 7428 290a 2020   res = quat().  
-000234f0: 2020 2020 2020 6966 2066 6162 7328 6229        if fabs(b)
-00023500: 3c3d 6570 733a 0a20 2020 2020 2020 2020  <=eps:.         
-00023510: 2020 2072 6573 2e78 203d 2030 2e30 0a20     res.x = 0.0. 
-00023520: 2020 2020 2020 2020 2020 2072 6573 2e79             res.y
-00023530: 203d 2030 2e30 0a20 2020 2020 2020 2020   = 0.0.         
-00023540: 2020 2072 6573 2e7a 203d 2030 2e30 0a20     res.z = 0.0. 
-00023550: 2020 2020 2020 2020 2020 2069 6620 7365             if se
-00023560: 6c66 2e77 3c3d 6570 733a 0a20 2020 2020  lf.w<=eps:.     
-00023570: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00023580: 2056 616c 7565 4572 726f 722c 2022 6d61   ValueError, "ma
-00023590: 7468 2064 6f6d 6169 6e20 6572 726f 7222  th domain error"
-000235a0: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
-000235b0: 2e77 203d 206c 6f67 2873 656c 662e 7729  .w = log(self.w)
-000235c0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-000235d0: 2020 2020 2020 2020 2020 2074 203d 2061             t = a
-000235e0: 7461 6e32 2862 2c20 7365 6c66 2e77 290a  tan2(b, self.w).
-000235f0: 2020 2020 2020 2020 2020 2020 6620 3d20              f = 
-00023600: 742f 620a 2020 2020 2020 2020 2020 2020  t/b.            
-00023610: 7265 732e 7820 3d20 662a 7365 6c66 2e78  res.x = f*self.x
-00023620: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
-00023630: 2e79 203d 2066 2a73 656c 662e 790a 2020  .y = f*self.y.  
-00023640: 2020 2020 2020 2020 2020 7265 732e 7a20            res.z 
-00023650: 3d20 662a 7365 6c66 2e7a 0a20 2020 2020  = f*self.z.     
-00023660: 2020 2020 2020 2063 7420 3d20 636f 7328         ct = cos(
-00023670: 7429 0a20 2020 2020 2020 2020 2020 2069  t).            i
-00023680: 6620 6661 6273 2863 7429 3c3d 6570 733a  f fabs(ct)<=eps:
-00023690: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000236a0: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-000236b0: 722c 2022 6d61 7468 2064 6f6d 6169 6e20  r, "math domain 
-000236c0: 6572 726f 7222 0a20 2020 2020 2020 2020  error".         
-000236d0: 2020 2072 203d 2073 656c 662e 772f 6374     r = self.w/ct
-000236e0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-000236f0: 723c 3d65 7073 3a0a 2020 2020 2020 2020  r<=eps:.        
-00023700: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-00023710: 6c75 6545 7272 6f72 2c20 226d 6174 6820  lueError, "math 
-00023720: 646f 6d61 696e 2065 7272 6f72 220a 2020  domain error".  
-00023730: 2020 2020 2020 2020 2020 7265 732e 7720            res.w 
-00023740: 3d20 6c6f 6728 7229 0a0a 2020 2020 2020  = log(r)..      
-00023750: 2020 7265 7475 726e 2072 6573 0a0a 2020    return res..  
-00023760: 2020 6465 6620 6578 7028 7365 6c66 293a    def exp(self):
-00023770: 0a20 2020 2020 2020 2022 2222 5265 7475  .        """Retu
-00023780: 726e 2074 6865 2065 7870 6f6e 656e 7469  rn the exponenti
-00023790: 616c 206f 6620 7365 6c66 2e22 2222 0a0a  al of self."""..
-000237a0: 2020 2020 2020 2020 6364 6566 2064 6f75          cdef dou
-000237b0: 626c 6520 622c 2066 0a20 2020 2020 2020  ble b, f.       
-000237c0: 2063 6465 6620 7175 6174 2072 6573 0a0a   cdef quat res..
-000237d0: 2020 2020 2020 2020 6220 3d20 7371 7274          b = sqrt
-000237e0: 2873 656c 662e 782a 7365 6c66 2e78 202b  (self.x*self.x +
-000237f0: 2073 656c 662e 792a 7365 6c66 2e79 202b   self.y*self.y +
-00023800: 2073 656c 662e 7a2a 7365 6c66 2e7a 290a   self.z*self.z).
-00023810: 2020 2020 2020 2020 7265 7320 3d20 7175          res = qu
-00023820: 6174 2829 0a20 2020 2020 2020 2069 6620  at().        if 
-00023830: 6661 6273 2862 293c 3d65 7073 3a0a 2020  fabs(b)<=eps:.  
-00023840: 2020 2020 2020 2020 2020 7265 732e 7820            res.x 
-00023850: 3d20 302e 300a 2020 2020 2020 2020 2020  = 0.0.          
-00023860: 2020 7265 732e 7920 3d20 302e 300a 2020    res.y = 0.0.  
-00023870: 2020 2020 2020 2020 2020 7265 732e 7a20            res.z 
-00023880: 3d20 302e 300a 2020 2020 2020 2020 2020  = 0.0.          
-00023890: 2020 7265 732e 7720 3d20 6578 7028 7365    res.w = exp(se
-000238a0: 6c66 2e77 290a 2020 2020 2020 2020 656c  lf.w).        el
-000238b0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-000238c0: 6620 3d20 7369 6e28 6229 2f62 0a20 2020  f = sin(b)/b.   
-000238d0: 2020 2020 2020 2020 2072 6573 2e78 203d           res.x =
-000238e0: 2066 2a73 656c 662e 780a 2020 2020 2020   f*self.x.      
-000238f0: 2020 2020 2020 7265 732e 7920 3d20 662a        res.y = f*
-00023900: 7365 6c66 2e79 0a20 2020 2020 2020 2020  self.y.         
-00023910: 2020 2072 6573 2e7a 203d 2066 2a73 656c     res.z = f*sel
-00023920: 662e 7a0a 2020 2020 2020 2020 2020 2020  f.z.            
-00023930: 7265 732e 7720 3d20 6578 7028 7365 6c66  res.w = exp(self
-00023940: 2e77 292a 636f 7328 6229 0a0a 2020 2020  .w)*cos(b)..    
-00023950: 2020 2020 7265 7475 726e 2072 6573 0a0a      return res..
-00023960: 0a64 6566 2073 6c65 7270 2864 6f75 626c  .def slerp(doubl
-00023970: 6520 742c 2071 7561 7420 7130 2c20 7175  e t, quat q0, qu
-00023980: 6174 2071 3129 3a0a 2020 2020 2222 2253  at q1):.    """S
-00023990: 7068 6572 6963 616c 206c 696e 6561 7220  pherical linear 
-000239a0: 696e 7465 7270 6f6c 6174 696f 6e20 6265  interpolation be
-000239b0: 7477 6565 6e20 7477 6f20 7175 6174 6572  tween two quater
-000239c0: 6e69 6f6e 732e 0a0a 2020 2020 5468 6520  nions...    The 
-000239d0: 7265 7475 726e 2076 616c 7565 2069 7320  return value is 
-000239e0: 616e 2069 6e74 6572 706f 6c61 7469 6f6e  an interpolation
-000239f0: 2062 6574 7765 656e 2071 3020 616e 6420   between q0 and 
-00023a00: 7131 2e20 466f 7220 743d 302e 300a 2020  q1. For t=0.0.  
-00023a10: 2020 7468 6520 7265 7475 726e 2076 616c    the return val
-00023a20: 7565 2065 7175 616c 7320 7130 2c20 666f  ue equals q0, fo
-00023a30: 7220 743d 312e 3020 6974 2065 7175 616c  r t=1.0 it equal
-00023a40: 7320 7131 2e0a 2020 2020 7130 2061 6e64  s q1..    q0 and
-00023a50: 2071 3120 6d75 7374 2062 6520 756e 6974   q1 must be unit
-00023a60: 2071 7561 7465 726e 696f 6e73 2e0a 2020   quaternions..  
-00023a70: 2020 2222 220a 2020 2020 6364 6566 2064    """.    cdef d
-00023a80: 6f75 626c 6520 6f2c 736f 2c61 2c62 0a0a  ouble o,so,a,b..
-00023a90: 2020 2020 6f20 3d20 6163 6f73 2871 302e      o = acos(q0.
-00023aa0: 646f 7428 7131 2929 0a20 2020 2073 6f20  dot(q1)).    so 
-00023ab0: 3d20 7369 6e28 6f29 0a0a 2020 2020 6966  = sin(o)..    if
-00023ac0: 2028 6661 6273 2873 6f29 3c65 7073 293a   (fabs(so)<eps):
-00023ad0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00023ae0: 7175 6174 2871 3029 0a0a 2020 2020 6120  quat(q0)..    a 
-00023af0: 3d20 7369 6e28 6f2a 2831 2e30 2d74 2929  = sin(o*(1.0-t))
-00023b00: 202f 2073 6f0a 2020 2020 6220 3d20 7369   / so.    b = si
-00023b10: 6e28 6f2a 7429 202f 2073 6f0a 2020 2020  n(o*t) / so.    
-00023b20: 7265 7475 726e 2071 302a 6120 2b20 7131  return q0*a + q1
-00023b30: 2a62 0a0a 6465 6620 7371 7561 6428 646f  *b..def squad(do
-00023b40: 7562 6c65 2074 2c20 7175 6174 2061 2c20  uble t, quat a, 
-00023b50: 7175 6174 2062 2c20 7175 6174 2063 2c20  quat b, quat c, 
-00023b60: 7175 6174 2064 293a 0a20 2020 2022 2222  quat d):.    """
-00023b70: 5370 6865 7269 6361 6c20 6375 6269 6320  Spherical cubic 
-00023b80: 696e 7465 7270 6f6c 6174 696f 6e2e 2222  interpolation.""
-00023b90: 220a 2020 2020 7265 7475 726e 2073 6c65  ".    return sle
-00023ba0: 7270 2832 2a74 2a28 312e 302d 7429 2c20  rp(2*t*(1.0-t), 
-00023bb0: 736c 6572 7028 742c 612c 6429 2c20 736c  slerp(t,a,d), sl
-00023bc0: 6572 7028 742c 622c 6329 290a 0a23 2323  erp(t,b,c))..###
-00023bd0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00023be0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00023bf0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00023c00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00023c10: 2323 230a 0a69 6d70 6f72 7420 7379 730a  ###..import sys.
-00023c20: 6966 2073 7973 2e76 6572 7369 6f6e 5f69  if sys.version_i
-00023c30: 6e66 6f5b 305d 203e 3d20 333a 0a20 2020  nfo[0] >= 3:.   
-00023c40: 2069 6d70 6f72 7420 636f 7079 7265 6720   import copyreg 
-00023c50: 6173 2063 6f70 795f 7265 670a 656c 7365  as copy_reg.else
-00023c60: 3a0a 2020 2020 696d 706f 7274 2063 6f70  :.    import cop
-00023c70: 795f 7265 670a 0a64 6566 205f 7665 6333  y_reg..def _vec3
-00023c80: 636f 6e73 7472 7563 7428 782c 792c 7a29  construct(x,y,z)
-00023c90: 3a0a 2020 2020 7265 7475 726e 2076 6563  :.    return vec
-00023ca0: 3328 782c 792c 7a29 0a0a 6465 6620 5f76  3(x,y,z)..def _v
-00023cb0: 6563 3463 6f6e 7374 7275 6374 2878 2c79  ec4construct(x,y
-00023cc0: 2c7a 2c77 293a 0a20 2020 2072 6574 7572  ,z,w):.    retur
-00023cd0: 6e20 7665 6334 2878 2c79 2c7a 2c77 290a  n vec4(x,y,z,w).
-00023ce0: 0a64 6566 205f 6d61 7433 636f 6e73 7472  .def _mat3constr
-00023cf0: 7563 7428 6231 2c62 322c 6233 293a 0a20  uct(b1,b2,b3):. 
-00023d00: 2020 2072 6574 7572 6e20 6d61 7433 2862     return mat3(b
-00023d10: 312c 6232 2c62 3329 0a0a 6465 6620 5f6d  1,b2,b3)..def _m
-00023d20: 6174 3463 6f6e 7374 7275 6374 2862 312c  at4construct(b1,
-00023d30: 6232 2c62 332c 6234 293a 0a20 2020 2072  b2,b3,b4):.    r
-00023d40: 6574 7572 6e20 6d61 7434 2862 312c 6232  eturn mat4(b1,b2
-00023d50: 2c62 332c 6234 290a 0a64 6566 205f 7175  ,b3,b4)..def _qu
-00023d60: 6174 636f 6e73 7472 7563 7428 772c 782c  atconstruct(w,x,
-00023d70: 792c 7a29 3a0a 2020 2020 7265 7475 726e  y,z):.    return
-00023d80: 2071 7561 7428 772c 782c 792c 7a29 0a0a   quat(w,x,y,z)..
-00023d90: 636f 7079 5f72 6567 2e63 6f6e 7374 7275  copy_reg.constru
-00023da0: 6374 6f72 285f 7665 6333 636f 6e73 7472  ctor(_vec3constr
-00023db0: 7563 7429 0a63 6f70 795f 7265 672e 636f  uct).copy_reg.co
-00023dc0: 6e73 7472 7563 746f 7228 5f76 6563 3463  nstructor(_vec4c
-00023dd0: 6f6e 7374 7275 6374 290a 636f 7079 5f72  onstruct).copy_r
-00023de0: 6567 2e63 6f6e 7374 7275 6374 6f72 285f  eg.constructor(_
-00023df0: 6d61 7433 636f 6e73 7472 7563 7429 0a63  mat3construct).c
-00023e00: 6f70 795f 7265 672e 636f 6e73 7472 7563  opy_reg.construc
-00023e10: 746f 7228 5f6d 6174 3463 6f6e 7374 7275  tor(_mat4constru
-00023e20: 6374 290a 636f 7079 5f72 6567 2e63 6f6e  ct).copy_reg.con
-00023e30: 7374 7275 6374 6f72 285f 7175 6174 636f  structor(_quatco
-00023e40: 6e73 7472 7563 7429 0a                   nstruct).
+0001f890: 2020 2020 735b 695d 203d 2066 6c6f 6174      s[i] = float
+0001f8a0: 2873 5b69 5d29 0a20 2020 2020 2020 2020  (s[i]).         
+0001f8b0: 2020 2020 2020 2020 2020 2065 7863 6570             excep
+0001f8c0: 743a 0a20 2020 2020 2020 2020 2020 2020  t:.             
+0001f8d0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+0001f8e0: 2056 616c 7565 4572 726f 722c 2271 7561   ValueError,"qua
+0001f8f0: 7428 2920 6172 6720 6973 2061 206d 616c  t() arg is a mal
+0001f900: 666f 726d 6564 2073 7472 696e 6722 0a20  formed string". 
+0001f910: 2020 2020 2020 2020 2020 2020 2020 2071                 q
+0001f920: 203d 2071 7561 7428 7329 0a20 2020 2020   = quat(s).     
+0001f930: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0001f940: 7720 3d20 712e 770a 2020 2020 2020 2020  w = q.w.        
+0001f950: 2020 2020 2020 2020 7365 6c66 2e78 203d          self.x =
+0001f960: 2071 2e78 0a20 2020 2020 2020 2020 2020   q.x.           
+0001f970: 2020 2020 2073 656c 662e 7920 3d20 712e       self.y = q.
+0001f980: 790a 2020 2020 2020 2020 2020 2020 2020  y.              
+0001f990: 2020 7365 6c66 2e7a 203d 2071 2e7a 0a20    self.z = q.z. 
+0001f9a0: 2020 2020 2020 2020 2020 2023 2053 6571             # Seq
+0001f9b0: 7565 6e63 6520 6f66 2066 6c6f 6174 730a  uence of floats.
+0001f9c0: 2020 2020 2020 2020 2020 2020 656c 7365              else
+0001f9d0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0001f9e0: 2020 7365 7120 3d20 6172 6773 5b30 5d0a    seq = args[0].
+0001f9f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fa00: 7472 793a 0a20 2020 2020 2020 2020 2020  try:.           
+0001fa10: 2020 2020 2020 2020 2073 6571 6c65 6e20           seqlen 
+0001fa20: 3d20 6c65 6e28 7365 7129 0a20 2020 2020  = len(seq).     
+0001fa30: 2020 2020 2020 2020 2020 2065 7863 6570             excep
+0001fa40: 743a 0a20 2020 2020 2020 2020 2020 2020  t:.             
+0001fa50: 2020 2020 2020 2072 6169 7365 2054 7970         raise Typ
+0001fa60: 6545 7272 6f72 2c22 7175 6174 2829 2061  eError,"quat() a
+0001fa70: 7267 2063 616e 2774 2062 6520 636f 6e76  rg can't be conv
+0001fa80: 6572 7465 6420 746f 2071 7561 7422 0a0a  erted to quat"..
+0001fa90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001faa0: 6966 2073 6571 6c65 6e3d 3d30 3a0a 2020  if seqlen==0:.  
+0001fab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fac0: 2020 7365 6c66 2e77 203d 2030 2e30 0a20    self.w = 0.0. 
+0001fad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fae0: 2020 2073 656c 662e 7820 3d20 302e 300a     self.x = 0.0.
+0001faf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fb00: 2020 2020 7365 6c66 2e79 203d 2030 2e30      self.y = 0.0
+0001fb10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001fb20: 2020 2020 2073 656c 662e 7a20 3d20 302e       self.z = 0.
+0001fb30: 300a 2020 2020 2020 2020 2020 2020 2020  0.              
+0001fb40: 2020 656c 6966 2073 6571 6c65 6e3d 3d31    elif seqlen==1
+0001fb50: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0001fb60: 2020 2020 2020 7365 6c66 2e77 203d 2073        self.w = s
+0001fb70: 6571 5b30 5d0a 2020 2020 2020 2020 2020  eq[0].          
+0001fb80: 2020 2020 2020 2020 2020 7365 6c66 2e78            self.x
+0001fb90: 203d 2030 2e30 0a20 2020 2020 2020 2020   = 0.0.         
+0001fba0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0001fbb0: 7920 3d20 302e 300a 2020 2020 2020 2020  y = 0.0.        
+0001fbc0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0001fbd0: 2e7a 203d 2030 2e30 0a20 2020 2020 2020  .z = 0.0.       
+0001fbe0: 2020 2020 2020 2020 2065 6c69 6620 7365           elif se
+0001fbf0: 716c 656e 3d3d 343a 0a20 2020 2020 2020  qlen==4:.       
+0001fc00: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0001fc10: 662e 7720 3d20 7365 715b 305d 0a20 2020  f.w = seq[0].   
+0001fc20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fc30: 2073 656c 662e 7820 3d20 7365 715b 315d   self.x = seq[1]
+0001fc40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001fc50: 2020 2020 2073 656c 662e 7920 3d20 7365       self.y = se
+0001fc60: 715b 325d 0a20 2020 2020 2020 2020 2020  q[2].           
+0001fc70: 2020 2020 2020 2020 2073 656c 662e 7a20           self.z 
+0001fc80: 3d20 7365 715b 335d 0a20 2020 2020 2020  = seq[3].       
+0001fc90: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+0001fca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fcb0: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
+0001fcc0: 6f72 2c20 2271 7561 7428 2920 6172 6720  or, "quat() arg 
+0001fcd0: 6361 6e27 7420 6265 2063 6f6e 7665 7274  can't be convert
+0001fce0: 6564 2074 6f20 7175 6174 220a 0a20 2020  ed to quat"..   
+0001fcf0: 2020 2020 2023 2032 2061 7267 756d 656e       # 2 argumen
+0001fd00: 7473 2028 616e 676c 6520 2620 6178 6973  ts (angle & axis
+0001fd10: 290a 2020 2020 2020 2020 656c 6966 2061  ).        elif a
+0001fd20: 7267 6c65 6e3d 3d32 3a0a 2020 2020 2020  rglen==2:.      
+0001fd30: 2020 2020 2020 616e 676c 652c 2061 7869        angle, axi
+0001fd40: 7320 3d20 6172 6773 0a20 2020 2020 2020  s = args.       
+0001fd50: 2020 2020 2073 656c 662e 6672 6f6d 416e       self.fromAn
+0001fd60: 676c 6541 7869 7328 616e 676c 652c 6178  gleAxis(angle,ax
+0001fd70: 6973 290a 0a20 2020 2020 2020 2023 2034  is)..        # 4
+0001fd80: 2061 7267 756d 656e 7473 0a20 2020 2020   arguments.     
+0001fd90: 2020 2065 6c69 6620 6172 676c 656e 3d3d     elif arglen==
+0001fda0: 343a 0a20 2020 2020 2020 2020 2020 2073  4:.            s
+0001fdb0: 656c 662e 7720 3d20 6172 6773 5b30 5d0a  elf.w = args[0].
+0001fdc0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0001fdd0: 2e78 203d 2061 7267 735b 315d 0a20 2020  .x = args[1].   
+0001fde0: 2020 2020 2020 2020 2073 656c 662e 7920           self.y 
+0001fdf0: 3d20 6172 6773 5b32 5d0a 2020 2020 2020  = args[2].      
+0001fe00: 2020 2020 2020 7365 6c66 2e7a 203d 2061        self.z = a
+0001fe10: 7267 735b 335d 0a0a 2020 2020 2020 2020  rgs[3]..        
+0001fe20: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0001fe30: 2020 7261 6973 6520 5479 7065 4572 726f    raise TypeErro
+0001fe40: 722c 2022 7175 6174 2829 2061 7267 2063  r, "quat() arg c
+0001fe50: 616e 2774 2062 6520 636f 6e76 6572 7465  an't be converte
+0001fe60: 6420 746f 2071 7561 7422 0a0a 2020 2020  d to quat"..    
+0001fe70: 6465 6620 5f5f 7265 6475 6365 5f5f 2873  def __reduce__(s
+0001fe80: 656c 6629 3a0a 2020 2020 2020 2020 7265  elf):.        re
+0001fe90: 7475 726e 2028 5f71 7561 7463 6f6e 7374  turn (_quatconst
+0001fea0: 7275 6374 2c20 2873 656c 662e 772c 2073  ruct, (self.w, s
+0001feb0: 656c 662e 782c 2073 656c 662e 792c 2073  elf.x, self.y, s
+0001fec0: 656c 662e 7a29 290a 0a20 2020 2064 6566  elf.z))..    def
+0001fed0: 205f 5f72 6570 725f 5f28 7365 6c66 293a   __repr__(self):
+0001fee0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0001fef0: 2771 7561 7428 2573 2c20 2573 2c20 2573  'quat(%s, %s, %s
+0001ff00: 2c20 2573 2927 2528 7265 7072 2873 656c  , %s)'%(repr(sel
+0001ff10: 662e 7729 2c72 6570 7228 7365 6c66 2e78  f.w),repr(self.x
+0001ff20: 292c 7265 7072 2873 656c 662e 7929 2c72  ),repr(self.y),r
+0001ff30: 6570 7228 7365 6c66 2e7a 2929 0a0a 2020  epr(self.z))..  
+0001ff40: 2020 6465 6620 5f5f 7374 725f 5f28 7365    def __str__(se
+0001ff50: 6c66 293a 0a20 2020 2020 2020 2072 6574  lf):.        ret
+0001ff60: 7572 6e20 2228 2531 2e34 662c 2025 312e  urn "(%1.4f, %1.
+0001ff70: 3466 2c20 2531 2e34 662c 2025 312e 3466  4f, %1.4f, %1.4f
+0001ff80: 2922 2528 7365 6c66 2e77 2c20 7365 6c66  )"%(self.w, self
+0001ff90: 2e78 2c20 7365 6c66 2e79 2c20 7365 6c66  .x, self.y, self
+0001ffa0: 2e7a 290a 0a0a 2020 2020 6465 6620 5f5f  .z)...    def __
+0001ffb0: 7269 6368 636d 705f 5f28 612c 622c 6f70  richcmp__(a,b,op
+0001ffc0: 293a 0a20 2020 2020 2020 2063 6465 6620  ):.        cdef 
+0001ffd0: 7175 6174 2076 612c 2076 620a 2020 2020  quat va, vb.    
+0001ffe0: 2020 2020 6364 6566 2069 6e74 2063 6f70      cdef int cop
+0001fff0: 0a0a 2020 2020 2020 2020 636f 7020 3d20  ..        cop = 
+00020000: 6f70 0a0a 2020 2020 2020 2020 7461 203d  op..        ta =
+00020010: 2074 7970 6528 6129 0a20 2020 2020 2020   type(a).       
+00020020: 2074 6220 3d20 7479 7065 2862 290a 2020   tb = type(b).  
+00020030: 2020 2020 2020 6966 2028 7461 213d 7175        if (ta!=qu
+00020040: 6174 206f 7220 7462 213d 7175 6174 293a  at or tb!=quat):
+00020050: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00020060: 636f 703d 3d33 3a0a 2020 2020 2020 2020  cop==3:.        
+00020070: 2020 2020 2020 2020 7265 7475 726e 2031          return 1
+00020080: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
+00020090: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+000200a0: 2020 2072 6574 7572 6e20 300a 0a20 2020     return 0..   
+000200b0: 2020 2020 2076 6120 3d20 610a 2020 2020       va = a.    
+000200c0: 2020 2020 7662 203d 2062 0a0a 2020 2020      vb = b..    
+000200d0: 2020 2020 2320 3c0a 2020 2020 2020 2020      # <.        
+000200e0: 6966 2063 6f70 3d3d 303a 0a20 2020 2020  if cop==0:.     
+000200f0: 2020 2020 2020 2072 6574 7572 6e20 300a         return 0.
+00020100: 2020 2020 2020 2020 2320 3c3d 0a20 2020          # <=.   
+00020110: 2020 2020 2065 6c69 6620 636f 703d 3d31       elif cop==1
+00020120: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+00020130: 7475 726e 2030 0a20 2020 2020 2020 2023  turn 0.        #
+00020140: 203d 3d0a 2020 2020 2020 2020 656c 6966   ==.        elif
+00020150: 2063 6f70 3d3d 323a 0a20 2020 2020 2020   cop==2:.       
+00020160: 2020 2020 2072 6574 7572 6e20 2866 6162       return (fab
+00020170: 7328 7661 2e77 2d76 622e 7729 3c3d 6570  s(va.w-vb.w)<=ep
+00020180: 7320 616e 6420 6661 6273 2876 612e 782d  s and fabs(va.x-
+00020190: 7662 2e78 293c 3d65 7073 2061 6e64 2066  vb.x)<=eps and f
+000201a0: 6162 7328 7661 2e79 2d76 622e 7929 3c3d  abs(va.y-vb.y)<=
+000201b0: 6570 7320 616e 6420 6661 6273 2876 612e  eps and fabs(va.
+000201c0: 7a2d 7662 2e7a 293c 3d65 7073 290a 2020  z-vb.z)<=eps).  
+000201d0: 2020 2020 2020 2320 213d 0a20 2020 2020        # !=.     
+000201e0: 2020 2065 6c69 6620 636f 703d 3d33 3a0a     elif cop==3:.
+000201f0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00020200: 726e 2028 6661 6273 2876 612e 772d 7662  rn (fabs(va.w-vb
+00020210: 2e77 293e 6570 7320 6f72 2066 6162 7328  .w)>eps or fabs(
+00020220: 7661 2e78 2d76 622e 7829 3e65 7073 206f  va.x-vb.x)>eps o
+00020230: 7220 6661 6273 2876 612e 792d 7662 2e79  r fabs(va.y-vb.y
+00020240: 293e 6570 7320 616e 6420 6661 6273 2876  )>eps and fabs(v
+00020250: 612e 7a2d 7662 2e7a 293e 6570 7329 0a20  a.z-vb.z)>eps). 
+00020260: 2020 2020 2020 2023 203e 0a20 2020 2020         # >.     
+00020270: 2020 2065 6c69 6620 636f 703d 3d34 3a0a     elif cop==4:.
+00020280: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00020290: 726e 2030 0a20 2020 2020 2020 2023 203e  rn 0.        # >
+000202a0: 3d0a 2020 2020 2020 2020 656c 6966 2063  =.        elif c
+000202b0: 6f70 3d3d 353a 0a20 2020 2020 2020 2020  op==5:.         
+000202c0: 2020 2072 6574 7572 6e20 300a 2020 2020     return 0.    
+000202d0: 2020 2020 2320 736f 6e73 7420 2846 6568      # sonst (Feh
+000202e0: 6c65 7229 0a20 2020 2020 2020 2065 6c73  ler).        els
+000202f0: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
+00020300: 6169 7365 2056 616c 7565 4572 726f 722c  aise ValueError,
+00020310: 2269 6e74 6572 6e61 6c20 6572 726f 723a  "internal error:
+00020320: 2069 6c6c 6567 616c 2072 6963 6820 636f   illegal rich co
+00020330: 6d70 6172 6973 6f6e 206e 756d 6265 7222  mparison number"
+00020340: 0a0a 2020 2020 6465 6620 5f5f 6164 645f  ..    def __add_
+00020350: 5f28 7175 6174 2061 2c20 7175 6174 2062  _(quat a, quat b
+00020360: 293a 0a20 2020 2020 2020 2022 2222 4164  ):.        """Ad
+00020370: 6469 7469 6f6e 2e0a 0a20 2020 2020 2020  dition...       
+00020380: 203e 3e3e 2071 3d71 7561 7428 302e 3936   >>> q=quat(0.96
+00020390: 3839 2c20 302e 3231 3630 2c20 302e 3130  89, 0.2160, 0.10
+000203a0: 3830 2c20 302e 3035 3430 290a 2020 2020  80, 0.0540).    
+000203b0: 2020 2020 3e3e 3e20 7072 696e 7428 712b      >>> print(q+
+000203c0: 7129 0a20 2020 2020 2020 2028 312e 3933  q).        (1.93
+000203d0: 3738 2c20 302e 3433 3230 2c20 302e 3231  78, 0.4320, 0.21
+000203e0: 3630 2c20 302e 3130 3830 290a 2020 2020  60, 0.1080).    
+000203f0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00020400: 6364 6566 2071 7561 7420 7265 730a 2020  cdef quat res.  
+00020410: 2020 2020 2020 7265 7320 3d20 7175 6174        res = quat
+00020420: 2829 0a20 2020 2020 2020 2072 6573 2e77  ().        res.w
+00020430: 203d 2061 2e77 2b62 2e77 0a20 2020 2020   = a.w+b.w.     
+00020440: 2020 2072 6573 2e78 203d 2061 2e78 2b62     res.x = a.x+b
+00020450: 2e78 0a20 2020 2020 2020 2072 6573 2e79  .x.        res.y
+00020460: 203d 2061 2e79 2b62 2e79 0a20 2020 2020   = a.y+b.y.     
+00020470: 2020 2072 6573 2e7a 203d 2061 2e7a 2b62     res.z = a.z+b
+00020480: 2e7a 0a20 2020 2020 2020 2072 6574 7572  .z.        retur
+00020490: 6e20 7265 730a 0a20 2020 2064 6566 205f  n res..    def _
+000204a0: 5f73 7562 5f5f 2871 7561 7420 612c 2071  _sub__(quat a, q
+000204b0: 7561 7420 6229 3a0a 2020 2020 2020 2020  uat b):.        
+000204c0: 2222 2253 7562 7472 6163 7469 6f6e 2e0a  """Subtraction..
+000204d0: 0a20 2020 2020 2020 203e 3e3e 2071 3d71  .        >>> q=q
+000204e0: 7561 7428 302e 3936 3839 2c20 302e 3231  uat(0.9689, 0.21
+000204f0: 3630 2c20 302e 3130 3830 2c20 302e 3035  60, 0.1080, 0.05
+00020500: 3430 290a 2020 2020 2020 2020 3e3e 3e20  40).        >>> 
+00020510: 7072 696e 7428 712d 7129 0a20 2020 2020  print(q-q).     
+00020520: 2020 2028 302e 3030 3030 2c20 302e 3030     (0.0000, 0.00
+00020530: 3030 2c20 302e 3030 3030 2c20 302e 3030  00, 0.0000, 0.00
+00020540: 3030 290a 2020 2020 2020 2020 2222 220a  00).        """.
+00020550: 2020 2020 2020 2020 6364 6566 2071 7561          cdef qua
+00020560: 7420 7265 730a 2020 2020 2020 2020 7265  t res.        re
+00020570: 7320 3d20 7175 6174 2829 0a20 2020 2020  s = quat().     
+00020580: 2020 2072 6573 2e77 203d 2061 2e77 2d62     res.w = a.w-b
+00020590: 2e77 0a20 2020 2020 2020 2072 6573 2e78  .w.        res.x
+000205a0: 203d 2061 2e78 2d62 2e78 0a20 2020 2020   = a.x-b.x.     
+000205b0: 2020 2072 6573 2e79 203d 2061 2e79 2d62     res.y = a.y-b
+000205c0: 2e79 0a20 2020 2020 2020 2072 6573 2e7a  .y.        res.z
+000205d0: 203d 2061 2e7a 2d62 2e7a 0a20 2020 2020   = a.z-b.z.     
+000205e0: 2020 2072 6574 7572 6e20 7265 730a 0a20     return res.. 
+000205f0: 2020 2064 6566 205f 5f6d 756c 5f5f 2861     def __mul__(a
+00020600: 2c20 6229 3a0a 2020 2020 2020 2020 2222  , b):.        ""
+00020610: 224d 756c 7469 706c 6963 6174 696f 6e2e  "Multiplication.
+00020620: 0a0a 2020 2020 2020 2020 3e3e 3e20 713d  ..        >>> q=
+00020630: 7175 6174 2830 2e39 3638 392c 2030 2e32  quat(0.9689, 0.2
+00020640: 3136 302c 2030 2e31 3038 302c 2030 2e30  160, 0.1080, 0.0
+00020650: 3534 3029 0a20 2020 2020 2020 203e 3e3e  540).        >>>
+00020660: 2070 7269 6e74 2871 2a32 2e30 290a 2020   print(q*2.0).  
+00020670: 2020 2020 2020 2831 2e39 3337 382c 2030        (1.9378, 0
+00020680: 2e34 3332 302c 2030 2e32 3136 302c 2030  .4320, 0.2160, 0
+00020690: 2e31 3038 3029 0a20 2020 2020 2020 203e  .1080).        >
+000206a0: 3e3e 2070 7269 6e74 2832 2e30 2a71 290a  >> print(2.0*q).
+000206b0: 2020 2020 2020 2020 2831 2e39 3337 382c          (1.9378,
+000206c0: 2030 2e34 3332 302c 2030 2e32 3136 302c   0.4320, 0.2160,
+000206d0: 2030 2e31 3038 3029 0a20 2020 2020 2020   0.1080).       
+000206e0: 203e 3e3e 2070 7269 6e74 2871 2a71 290a   >>> print(q*q).
+000206f0: 2020 2020 2020 2020 2830 2e38 3737 352c          (0.8775,
+00020700: 2030 2e34 3138 362c 2030 2e32 3039 332c   0.4186, 0.2093,
+00020710: 2030 2e31 3034 3629 0a20 2020 2020 2020   0.1046).       
+00020720: 2022 2222 0a20 2020 2020 2020 2063 6465   """.        cde
+00020730: 6620 7175 6174 2072 6573 2c20 7661 2c20  f quat res, va, 
+00020740: 7662 0a20 2020 2020 2020 2063 6465 6620  vb.        cdef 
+00020750: 646f 7562 6c65 2072 0a0a 2020 2020 2020  double r..      
+00020760: 2020 7461 203d 2074 7970 6528 6129 0a20    ta = type(a). 
+00020770: 2020 2020 2020 2074 6220 3d20 7479 7065         tb = type
+00020780: 2862 290a 0a20 2020 2020 2020 2069 6620  (b)..        if 
+00020790: 7461 2069 7320 7175 6174 3a0a 2020 2020  ta is quat:.    
+000207a0: 2020 2020 2020 2020 7661 203d 2061 0a20          va = a. 
+000207b0: 2020 2020 2020 2020 2020 2069 6620 7462             if tb
+000207c0: 2069 7320 7175 6174 3a0a 2020 2020 2020   is quat:.      
+000207d0: 2020 2020 2020 2020 2020 2320 7175 6174            # quat
+000207e0: 2a71 7561 740a 2020 2020 2020 2020 2020  *quat.          
+000207f0: 2020 2020 2020 7662 203d 2062 0a20 2020        vb = b.   
+00020800: 2020 2020 2020 2020 2020 2020 2072 6573               res
+00020810: 203d 2071 7561 7428 290a 2020 2020 2020   = quat().      
+00020820: 2020 2020 2020 2020 2020 7265 732e 7720            res.w 
+00020830: 3d20 7661 2e77 2a76 622e 7720 2d20 7661  = va.w*vb.w - va
+00020840: 2e78 2a76 622e 7820 2d20 7661 2e79 2a76  .x*vb.x - va.y*v
+00020850: 622e 7920 2d20 7661 2e7a 2a76 622e 7a0a  b.y - va.z*vb.z.
+00020860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020870: 7265 732e 7820 3d20 7661 2e77 2a76 622e  res.x = va.w*vb.
+00020880: 7820 2b20 7661 2e78 2a76 622e 7720 2b20  x + va.x*vb.w + 
+00020890: 7661 2e79 2a76 622e 7a20 2d20 7661 2e7a  va.y*vb.z - va.z
+000208a0: 2a76 622e 790a 2020 2020 2020 2020 2020  *vb.y.          
+000208b0: 2020 2020 2020 7265 732e 7920 3d20 7661        res.y = va
+000208c0: 2e77 2a76 622e 7920 2b20 7661 2e79 2a76  .w*vb.y + va.y*v
+000208d0: 622e 7720 2d20 7661 2e78 2a76 622e 7a20  b.w - va.x*vb.z 
+000208e0: 2b20 7661 2e7a 2a76 622e 780a 2020 2020  + va.z*vb.x.    
+000208f0: 2020 2020 2020 2020 2020 2020 7265 732e              res.
+00020900: 7a20 3d20 7661 2e77 2a76 622e 7a20 2b20  z = va.w*vb.z + 
+00020910: 7661 2e7a 2a76 622e 7720 2b20 7661 2e78  va.z*vb.w + va.x
+00020920: 2a76 622e 7920 2d20 7661 2e79 2a76 622e  *vb.y - va.y*vb.
+00020930: 780a 2020 2020 2020 2020 2020 2020 2020  x.              
+00020940: 2020 7265 7475 726e 2072 6573 0a20 2020    return res.   
+00020950: 2020 2020 2020 2020 2065 6c69 6620 7462           elif tb
+00020960: 2069 7320 666c 6f61 7420 6f72 2074 6220   is float or tb 
+00020970: 6973 2069 6e74 206f 7220 7462 2069 7320  is int or tb is 
+00020980: 6c6f 6e67 3a0a 2020 2020 2020 2020 2020  long:.          
+00020990: 2020 2020 2020 2320 7175 6174 2a73 6361        # quat*sca
+000209a0: 6c61 720a 2020 2020 2020 2020 2020 2020  lar.            
+000209b0: 2020 2020 7265 7320 3d20 7175 6174 2829      res = quat()
+000209c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000209d0: 2072 2020 203d 2062 0a20 2020 2020 2020   r   = b.       
+000209e0: 2020 2020 2020 2020 2072 6573 2e77 203d           res.w =
+000209f0: 2076 612e 772a 720a 2020 2020 2020 2020   va.w*r.        
+00020a00: 2020 2020 2020 2020 7265 732e 7820 3d20          res.x = 
+00020a10: 7661 2e78 2a72 0a20 2020 2020 2020 2020  va.x*r.         
+00020a20: 2020 2020 2020 2072 6573 2e79 203d 2076         res.y = v
+00020a30: 612e 792a 720a 2020 2020 2020 2020 2020  a.y*r.          
+00020a40: 2020 2020 2020 7265 732e 7a20 3d20 7661        res.z = va
+00020a50: 2e7a 2a72 0a20 2020 2020 2020 2020 2020  .z*r.           
+00020a60: 2020 2020 2072 6574 7572 6e20 7265 730a       return res.
+00020a70: 2020 2020 2020 2020 656c 6966 2074 6120          elif ta 
+00020a80: 6973 2066 6c6f 6174 206f 7220 7461 2069  is float or ta i
+00020a90: 7320 696e 7420 6f72 2074 6120 6973 206c  s int or ta is l
+00020aa0: 6f6e 673a 0a20 2020 2020 2020 2020 2020  ong:.           
+00020ab0: 2069 6620 7462 2069 7320 7175 6174 3a0a   if tb is quat:.
+00020ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020ad0: 2320 7363 616c 6172 2a71 7561 740a 2020  # scalar*quat.  
+00020ae0: 2020 2020 2020 2020 2020 2020 2020 7265                re
+00020af0: 7320 3d20 7175 6174 2829 0a20 2020 2020  s = quat().     
+00020b00: 2020 2020 2020 2020 2020 2076 6220 203d             vb  =
+00020b10: 2062 0a20 2020 2020 2020 2020 2020 2020   b.             
+00020b20: 2020 2072 2020 203d 2061 0a20 2020 2020     r   = a.     
+00020b30: 2020 2020 2020 2020 2020 2072 6573 2e77             res.w
+00020b40: 203d 2072 2a76 622e 770a 2020 2020 2020   = r*vb.w.      
+00020b50: 2020 2020 2020 2020 2020 7265 732e 7820            res.x 
+00020b60: 3d20 722a 7662 2e78 0a20 2020 2020 2020  = r*vb.x.       
+00020b70: 2020 2020 2020 2020 2072 6573 2e79 203d           res.y =
+00020b80: 2072 2a76 622e 790a 2020 2020 2020 2020   r*vb.y.        
+00020b90: 2020 2020 2020 2020 7265 732e 7a20 3d20          res.z = 
+00020ba0: 722a 7662 2e7a 0a20 2020 2020 2020 2020  r*vb.z.         
+00020bb0: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
+00020bc0: 730a 0a20 2020 2020 2020 2072 6169 7365  s..        raise
+00020bd0: 2054 7970 6545 7272 6f72 2c20 2275 6e73   TypeError, "uns
+00020be0: 7570 706f 7274 6564 206f 7065 7261 6e64  upported operand
+00020bf0: 2074 7970 6520 666f 7220 2a22 0a0a 2020   type for *"..  
+00020c00: 2020 6465 6620 5f5f 6469 765f 5f28 7175    def __div__(qu
+00020c10: 6174 2061 2c20 6229 3a0a 2020 2020 2020  at a, b):.      
+00020c20: 2020 2320 5079 7468 6f6e 2032 0a20 2020    # Python 2.   
+00020c30: 2020 2020 2072 6574 7572 6e20 7175 6174       return quat
+00020c40: 2e5f 5f74 7275 6564 6976 5f5f 2861 2c62  .__truediv__(a,b
+00020c50: 290a 0a20 2020 2064 6566 205f 5f74 7275  )..    def __tru
+00020c60: 6564 6976 5f5f 2871 7561 7420 612c 2062  ediv__(quat a, b
+00020c70: 293a 0a20 2020 2020 2020 2022 2222 4469  ):.        """Di
+00020c80: 7669 7369 6f6e 2e0a 0a20 2020 2020 2020  vision...       
+00020c90: 203e 3e3e 2071 3d71 7561 7428 302e 3936   >>> q=quat(0.96
+00020ca0: 3839 2c20 302e 3231 3630 2c20 302e 3130  89, 0.2160, 0.10
+00020cb0: 3830 2c20 302e 3035 3430 290a 2020 2020  80, 0.0540).    
+00020cc0: 2020 2020 3e3e 3e20 7072 696e 7428 712f      >>> print(q/
+00020cd0: 322e 3029 0a20 2020 2020 2020 2028 302e  2.0).        (0.
+00020ce0: 3438 3434 2c20 302e 3130 3830 2c20 302e  4844, 0.1080, 0.
+00020cf0: 3035 3430 2c20 302e 3032 3730 290a 2020  0540, 0.0270).  
+00020d00: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00020d10: 2020 6364 6566 2071 7561 7420 7265 730a    cdef quat res.
+00020d20: 2020 2020 2020 2020 6364 6566 2064 6f75          cdef dou
+00020d30: 626c 6520 720a 0a20 2020 2020 2020 2074  ble r..        t
+00020d40: 6220 3d20 7479 7065 2862 290a 0a20 2020  b = type(b)..   
+00020d50: 2020 2020 2069 6620 7462 2069 7320 666c       if tb is fl
+00020d60: 6f61 7420 6f72 2074 6220 6973 2069 6e74  oat or tb is int
+00020d70: 206f 7220 7462 2069 7320 6c6f 6e67 3a0a   or tb is long:.
+00020d80: 2020 2020 2020 2020 2020 2020 2320 7175              # qu
+00020d90: 6174 2f73 6361 6c61 720a 2020 2020 2020  at/scalar.      
+00020da0: 2020 2020 2020 7265 7320 3d20 7175 6174        res = quat
+00020db0: 2829 0a20 2020 2020 2020 2020 2020 2072  ().            r
+00020dc0: 203d 2062 0a20 2020 2020 2020 2020 2020   = b.           
+00020dd0: 2069 6620 6661 6273 2872 293c 3d65 7073   if fabs(r)<=eps
+00020de0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00020df0: 2020 7261 6973 6520 5a65 726f 4469 7669    raise ZeroDivi
+00020e00: 7369 6f6e 4572 726f 722c 2271 7561 7420  sionError,"quat 
+00020e10: 6469 7669 7369 6f6e 220a 2020 2020 2020  division".      
+00020e20: 2020 2020 2020 7265 732e 7720 3d20 612e        res.w = a.
+00020e30: 772f 720a 2020 2020 2020 2020 2020 2020  w/r.            
+00020e40: 7265 732e 7820 3d20 612e 782f 720a 2020  res.x = a.x/r.  
+00020e50: 2020 2020 2020 2020 2020 7265 732e 7920            res.y 
+00020e60: 3d20 612e 792f 720a 2020 2020 2020 2020  = a.y/r.        
+00020e70: 2020 2020 7265 732e 7a20 3d20 612e 7a2f      res.z = a.z/
+00020e80: 720a 2020 2020 2020 2020 2020 2020 7265  r.            re
+00020e90: 7475 726e 2072 6573 0a20 2020 2020 2020  turn res.       
+00020ea0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00020eb0: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
+00020ec0: 6f72 2c20 2275 6e73 7570 706f 7274 6564  or, "unsupported
+00020ed0: 206f 7065 7261 6e64 2074 7970 6520 666f   operand type fo
+00020ee0: 7220 2f22 0a0a 2020 2020 6465 6620 5f5f  r /"..    def __
+00020ef0: 706f 775f 5f28 7175 6174 2073 656c 662c  pow__(quat self,
+00020f00: 206f 7468 6572 2c20 6d6f 6475 6c6f 293a   other, modulo):
+00020f10: 0a20 2020 2020 2020 2022 2222 5265 7475  .        """Retu
+00020f20: 726e 2073 656c 662a 2a71 2e22 2222 0a20  rn self**q.""". 
+00020f30: 2020 2020 2020 2063 6465 6620 7175 6174         cdef quat
+00020f40: 2071 0a20 2020 2020 2020 2069 6620 6d6f   q.        if mo
+00020f50: 6475 6c6f 213d 4e6f 6e65 3a0a 2020 2020  dulo!=None:.    
+00020f60: 2020 2020 2020 2020 7261 6973 6520 5479          raise Ty
+00020f70: 7065 4572 726f 722c 2022 756e 7375 7070  peError, "unsupp
+00020f80: 6f72 7465 6420 6f70 6572 6174 696f 6e22  orted operation"
+00020f90: 0a20 2020 2020 2020 2071 203d 2071 7561  .        q = qua
+00020fa0: 7428 6f74 6865 7229 0a20 2020 2020 2020  t(other).       
+00020fb0: 2072 6574 7572 6e20 2871 2a73 656c 662e   return (q*self.
+00020fc0: 6c6f 6728 2929 2e65 7870 2829 0a0a 2020  log()).exp()..  
+00020fd0: 2020 6465 6620 5f5f 6e65 675f 5f28 7365    def __neg__(se
+00020fe0: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
+00020ff0: 4e65 6761 7469 6f6e 2e0a 0a20 2020 2020  Negation...     
+00021000: 2020 203e 3e3e 2071 3d71 7561 7428 302e     >>> q=quat(0.
+00021010: 3936 3839 2c20 302e 3231 3630 2c20 302e  9689, 0.2160, 0.
+00021020: 3130 3830 2c20 302e 3035 3430 290a 2020  1080, 0.0540).  
+00021030: 2020 2020 2020 3e3e 3e20 7072 696e 7428        >>> print(
+00021040: 2d71 290a 2020 2020 2020 2020 282d 302e  -q).        (-0.
+00021050: 3936 3839 2c20 2d30 2e32 3136 302c 202d  9689, -0.2160, -
+00021060: 302e 3130 3830 2c20 2d30 2e30 3534 3029  0.1080, -0.0540)
+00021070: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00021080: 2020 2020 2063 6465 6620 7175 6174 2072       cdef quat r
+00021090: 6573 0a20 2020 2020 2020 2072 6573 203d  es.        res =
+000210a0: 2071 7561 7428 290a 2020 2020 2020 2020   quat().        
+000210b0: 7265 732e 7720 3d20 2d73 656c 662e 770a  res.w = -self.w.
+000210c0: 2020 2020 2020 2020 7265 732e 7820 3d20          res.x = 
+000210d0: 2d73 656c 662e 780a 2020 2020 2020 2020  -self.x.        
+000210e0: 7265 732e 7920 3d20 2d73 656c 662e 790a  res.y = -self.y.
+000210f0: 2020 2020 2020 2020 7265 732e 7a20 3d20          res.z = 
+00021100: 2d73 656c 662e 7a0a 2020 2020 2020 2020  -self.z.        
+00021110: 7265 7475 726e 2072 6573 0a0a 2020 2020  return res..    
+00021120: 6465 6620 5f5f 706f 735f 5f28 7365 6c66  def __pos__(self
+00021130: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
+00021140: 2020 2020 2020 203e 3e3e 2071 3d71 7561         >>> q=qua
+00021150: 7428 302e 3936 3839 2c20 302e 3231 3630  t(0.9689, 0.2160
+00021160: 2c20 302e 3130 3830 2c20 302e 3035 3430  , 0.1080, 0.0540
+00021170: 290a 2020 2020 2020 2020 3e3e 3e20 7072  ).        >>> pr
+00021180: 696e 7428 2b71 290a 2020 2020 2020 2020  int(+q).        
+00021190: 2830 2e39 3638 392c 2030 2e32 3136 302c  (0.9689, 0.2160,
+000211a0: 2030 2e31 3038 302c 2030 2e30 3534 3029   0.1080, 0.0540)
+000211b0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+000211c0: 2020 2020 2063 6465 6620 7175 6174 2072       cdef quat r
+000211d0: 6573 0a20 2020 2020 2020 2072 6573 203d  es.        res =
+000211e0: 2071 7561 7428 290a 2020 2020 2020 2020   quat().        
+000211f0: 7265 732e 7720 3d20 7365 6c66 2e77 0a20  res.w = self.w. 
+00021200: 2020 2020 2020 2072 6573 2e78 203d 2073         res.x = s
+00021210: 656c 662e 780a 2020 2020 2020 2020 7265  elf.x.        re
+00021220: 732e 7920 3d20 7365 6c66 2e79 0a20 2020  s.y = self.y.   
+00021230: 2020 2020 2072 6573 2e7a 203d 2073 656c       res.z = sel
+00021240: 662e 7a0a 2020 2020 2020 2020 7265 7475  f.z.        retu
+00021250: 726e 2072 6573 0a0a 2020 2020 6465 6620  rn res..    def 
+00021260: 5f5f 6961 6464 5f5f 2873 656c 662c 2071  __iadd__(self, q
+00021270: 7561 7420 6f74 6865 7229 3a0a 2020 2020  uat other):.    
+00021280: 2020 2020 2222 2249 6e6c 696e 6520 7175      """Inline qu
+00021290: 6174 6572 6e69 6f6e 2061 6464 6974 696f  aternion additio
+000212a0: 6e2e 0a20 2020 2020 2020 2022 2222 0a20  n..        """. 
+000212b0: 2020 2020 2020 2073 656c 662e 773d 7365         self.w=se
+000212c0: 6c66 2e77 2b6f 7468 6572 2e77 0a20 2020  lf.w+other.w.   
+000212d0: 2020 2020 2073 656c 662e 783d 7365 6c66       self.x=self
+000212e0: 2e78 2b6f 7468 6572 2e78 0a20 2020 2020  .x+other.x.     
+000212f0: 2020 2073 656c 662e 793d 7365 6c66 2e79     self.y=self.y
+00021300: 2b6f 7468 6572 2e79 0a20 2020 2020 2020  +other.y.       
+00021310: 2073 656c 662e 7a3d 7365 6c66 2e7a 2b6f   self.z=self.z+o
+00021320: 7468 6572 2e7a 0a20 2020 2020 2020 2072  ther.z.        r
+00021330: 6574 7572 6e20 7365 6c66 0a0a 2020 2020  eturn self..    
+00021340: 6465 6620 5f5f 6973 7562 5f5f 2873 656c  def __isub__(sel
+00021350: 662c 2071 7561 7420 6f74 6865 7229 3a0a  f, quat other):.
+00021360: 2020 2020 2020 2020 2222 2249 6e6c 696e          """Inlin
+00021370: 6520 7175 6174 6572 6e69 6f6e 2073 7562  e quaternion sub
+00021380: 7472 6163 7469 6f6e 2e0a 2020 2020 2020  traction..      
+00021390: 2020 2222 220a 2020 2020 2020 2020 7365    """.        se
+000213a0: 6c66 2e77 3d73 656c 662e 772d 6f74 6865  lf.w=self.w-othe
+000213b0: 722e 770a 2020 2020 2020 2020 7365 6c66  r.w.        self
+000213c0: 2e78 3d73 656c 662e 782d 6f74 6865 722e  .x=self.x-other.
+000213d0: 780a 2020 2020 2020 2020 7365 6c66 2e79  x.        self.y
+000213e0: 3d73 656c 662e 792d 6f74 6865 722e 790a  =self.y-other.y.
+000213f0: 2020 2020 2020 2020 7365 6c66 2e7a 3d73          self.z=s
+00021400: 656c 662e 7a2d 6f74 6865 722e 7a0a 2020  elf.z-other.z.  
+00021410: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00021420: 660a 0a20 2020 2064 6566 205f 5f69 6d75  f..    def __imu
+00021430: 6c5f 5f28 7365 6c66 2c20 6f74 6865 7229  l__(self, other)
+00021440: 3a0a 2020 2020 2020 2020 2222 2249 6e6c  :.        """Inl
+00021450: 696e 6520 6d75 6c74 6970 6c69 6361 7469  ine multiplicati
+00021460: 6f6e 2e0a 2020 2020 2020 2020 2222 220a  on..        """.
+00021470: 2020 2020 2020 2020 6364 6566 2071 7561          cdef qua
+00021480: 7420 7662 0a20 2020 2020 2020 2063 6465  t vb.        cde
+00021490: 6620 646f 7562 6c65 2072 0a20 2020 2020  f double r.     
+000214a0: 2020 2063 6465 6620 646f 7562 6c65 2077     cdef double w
+000214b0: 2c78 2c79 2c7a 0a0a 2020 2020 2020 2020  ,x,y,z..        
+000214c0: 5420 3d20 7479 7065 286f 7468 6572 290a  T = type(other).
+000214d0: 0a20 2020 2020 2020 2069 6620 5420 6973  .        if T is
+000214e0: 2071 7561 743a 0a20 2020 2020 2020 2020   quat:.         
+000214f0: 2020 2023 2071 7561 742a 3d71 7561 740a     # quat*=quat.
+00021500: 2020 2020 2020 2020 2020 2020 7662 203d              vb =
+00021510: 206f 7468 6572 0a20 2020 2020 2020 2020   other.         
+00021520: 2020 2077 203d 2073 656c 662e 772a 7662     w = self.w*vb
+00021530: 2e77 202d 2073 656c 662e 782a 7662 2e78  .w - self.x*vb.x
+00021540: 202d 2073 656c 662e 792a 7662 2e79 202d   - self.y*vb.y -
+00021550: 2073 656c 662e 7a2a 7662 2e7a 0a20 2020   self.z*vb.z.   
+00021560: 2020 2020 2020 2020 2078 203d 2073 656c           x = sel
+00021570: 662e 772a 7662 2e78 202b 2073 656c 662e  f.w*vb.x + self.
+00021580: 782a 7662 2e77 202b 2073 656c 662e 792a  x*vb.w + self.y*
+00021590: 7662 2e7a 202d 2073 656c 662e 7a2a 7662  vb.z - self.z*vb
+000215a0: 2e79 0a20 2020 2020 2020 2020 2020 2079  .y.            y
+000215b0: 203d 2073 656c 662e 772a 7662 2e79 202b   = self.w*vb.y +
+000215c0: 2073 656c 662e 792a 7662 2e77 202d 2073   self.y*vb.w - s
+000215d0: 656c 662e 782a 7662 2e7a 202b 2073 656c  elf.x*vb.z + sel
+000215e0: 662e 7a2a 7662 2e78 0a20 2020 2020 2020  f.z*vb.x.       
+000215f0: 2020 2020 207a 203d 2073 656c 662e 772a       z = self.w*
+00021600: 7662 2e7a 202b 2073 656c 662e 7a2a 7662  vb.z + self.z*vb
+00021610: 2e77 202b 2073 656c 662e 782a 7662 2e79  .w + self.x*vb.y
+00021620: 202d 2073 656c 662e 792a 7662 2e78 0a20   - self.y*vb.x. 
+00021630: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00021640: 7720 3d20 770a 2020 2020 2020 2020 2020  w = w.          
+00021650: 2020 7365 6c66 2e78 203d 2078 0a20 2020    self.x = x.   
+00021660: 2020 2020 2020 2020 2073 656c 662e 7920           self.y 
+00021670: 3d20 790a 2020 2020 2020 2020 2020 2020  = y.            
+00021680: 7365 6c66 2e7a 203d 207a 0a20 2020 2020  self.z = z.     
+00021690: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+000216a0: 6c66 0a0a 2020 2020 2020 2020 656c 6966  lf..        elif
+000216b0: 2054 2069 7320 666c 6f61 7420 6f72 2054   T is float or T
+000216c0: 2069 7320 696e 7420 6f72 2054 2069 7320   is int or T is 
+000216d0: 6c6f 6e67 3a0a 2020 2020 2020 2020 2020  long:.          
+000216e0: 2020 2320 7175 6174 2a3d 7363 616c 6172    # quat*=scalar
+000216f0: 0a20 2020 2020 2020 2020 2020 2072 2020  .            r  
+00021700: 203d 206f 7468 6572 0a20 2020 2020 2020   = other.       
+00021710: 2020 2020 2073 656c 662e 7720 3d20 7365       self.w = se
+00021720: 6c66 2e77 2a72 0a20 2020 2020 2020 2020  lf.w*r.         
+00021730: 2020 2073 656c 662e 7820 3d20 7365 6c66     self.x = self
+00021740: 2e78 2a72 0a20 2020 2020 2020 2020 2020  .x*r.           
+00021750: 2073 656c 662e 7920 3d20 7365 6c66 2e79   self.y = self.y
+00021760: 2a72 0a20 2020 2020 2020 2020 2020 2073  *r.            s
+00021770: 656c 662e 7a20 3d20 7365 6c66 2e7a 2a72  elf.z = self.z*r
+00021780: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00021790: 7572 6e20 7365 6c66 0a0a 2020 2020 2020  urn self..      
+000217a0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+000217b0: 2020 2020 7261 6973 6520 5479 7065 4572      raise TypeEr
+000217c0: 726f 722c 2022 756e 7375 7070 6f72 7465  ror, "unsupporte
+000217d0: 6420 6f70 6572 616e 6420 7479 7065 2066  d operand type f
+000217e0: 6f72 202a 3d22 0a0a 2020 2020 6465 6620  or *="..    def 
+000217f0: 5f5f 6964 6976 5f5f 2873 656c 662c 206f  __idiv__(self, o
+00021800: 7468 6572 293a 0a20 2020 2020 2020 2022  ther):.        "
+00021810: 2222 496e 6c69 6e65 2064 6976 6973 696f  ""Inline divisio
+00021820: 6e20 7769 7468 2073 6361 6c61 722e 0a20  n with scalar.. 
+00021830: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00021840: 2020 2063 6465 6620 646f 7562 6c65 2072     cdef double r
+00021850: 0a20 2020 2020 2020 2074 6220 3d20 7479  .        tb = ty
+00021860: 7065 286f 7468 6572 290a 2020 2020 2020  pe(other).      
+00021870: 2020 6966 2074 6220 6973 2066 6c6f 6174    if tb is float
+00021880: 206f 7220 7462 2069 7320 696e 7420 6f72   or tb is int or
+00021890: 2074 6220 6973 206c 6f6e 673a 0a20 2020   tb is long:.   
+000218a0: 2020 2020 2020 2020 2072 3d6f 7468 6572           r=other
+000218b0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+000218c0: 6661 6273 2872 293c 3d65 7073 3a0a 2020  fabs(r)<=eps:.  
+000218d0: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+000218e0: 6973 6520 5a65 726f 4469 7669 7369 6f6e  ise ZeroDivision
+000218f0: 4572 726f 722c 2271 7561 7420 6469 7669  Error,"quat divi
+00021900: 7369 6f6e 220a 2020 2020 2020 2020 2020  sion".          
+00021910: 2020 7365 6c66 2e77 3d73 656c 662e 772f    self.w=self.w/
+00021920: 720a 2020 2020 2020 2020 2020 2020 7365  r.            se
+00021930: 6c66 2e78 3d73 656c 662e 782f 720a 2020  lf.x=self.x/r.  
+00021940: 2020 2020 2020 2020 2020 7365 6c66 2e79            self.y
+00021950: 3d73 656c 662e 792f 720a 2020 2020 2020  =self.y/r.      
+00021960: 2020 2020 2020 7365 6c66 2e7a 3d73 656c        self.z=sel
+00021970: 662e 7a2f 720a 2020 2020 2020 2020 2020  f.z/r.          
+00021980: 2020 7265 7475 726e 2073 656c 660a 2020    return self.  
+00021990: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+000219a0: 2020 2020 2020 2020 7261 6973 6520 5479          raise Ty
+000219b0: 7065 4572 726f 722c 2022 756e 7375 7070  peError, "unsupp
+000219c0: 6f72 7465 6420 6f70 6572 616e 6420 7479  orted operand ty
+000219d0: 7065 2066 6f72 202f 3d22 0a0a 2020 2020  pe for /="..    
+000219e0: 6465 6620 5f5f 6765 7461 7474 725f 5f28  def __getattr__(
+000219f0: 7365 6c66 2c20 6e61 6d65 293a 0a20 2020  self, name):.   
+00021a00: 2020 2020 2069 6620 6e61 6d65 3d3d 2277       if name=="w
+00021a10: 223a 0a20 2020 2020 2020 2020 2020 2072  ":.            r
+00021a20: 6574 7572 6e20 7365 6c66 2e77 0a20 2020  eturn self.w.   
+00021a30: 2020 2020 2065 6c69 6620 6e61 6d65 3d3d       elif name==
+00021a40: 2278 223a 0a20 2020 2020 2020 2020 2020  "x":.           
+00021a50: 2072 6574 7572 6e20 7365 6c66 2e78 0a20   return self.x. 
+00021a60: 2020 2020 2020 2065 6c69 6620 6e61 6d65         elif name
+00021a70: 3d3d 2279 223a 0a20 2020 2020 2020 2020  =="y":.         
+00021a80: 2020 2072 6574 7572 6e20 7365 6c66 2e79     return self.y
+00021a90: 0a20 2020 2020 2020 2065 6c69 6620 6e61  .        elif na
+00021aa0: 6d65 3d3d 227a 223a 0a20 2020 2020 2020  me=="z":.       
+00021ab0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00021ac0: 2e7a 0a20 2020 2020 2020 2065 6c73 653a  .z.        else:
+00021ad0: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+00021ae0: 7365 2041 7474 7269 6275 7465 4572 726f  se AttributeErro
+00021af0: 722c 2271 7561 7420 6861 7320 6e6f 2061  r,"quat has no a
+00021b00: 7474 7269 6275 7465 2027 222b 6e61 6d65  ttribute '"+name
+00021b10: 2b22 2722 0a0a 2020 2020 6465 6620 5f5f  +"'"..    def __
+00021b20: 7365 7461 7474 725f 5f28 7365 6c66 2c20  setattr__(self, 
+00021b30: 6e61 6d65 2c20 7661 6c29 3a0a 2020 2020  name, val):.    
+00021b40: 2020 2020 6966 206e 616d 653d 3d22 7722      if name=="w"
+00021b50: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
+00021b60: 6c66 2e77 203d 2076 616c 0a20 2020 2020  lf.w = val.     
+00021b70: 2020 2065 6c69 6620 6e61 6d65 3d3d 2278     elif name=="x
+00021b80: 223a 0a20 2020 2020 2020 2020 2020 2073  ":.            s
+00021b90: 656c 662e 7820 3d20 7661 6c0a 2020 2020  elf.x = val.    
+00021ba0: 2020 2020 656c 6966 206e 616d 653d 3d22      elif name=="
+00021bb0: 7922 3a0a 2020 2020 2020 2020 2020 2020  y":.            
+00021bc0: 7365 6c66 2e79 203d 2076 616c 0a20 2020  self.y = val.   
+00021bd0: 2020 2020 2065 6c69 6620 6e61 6d65 3d3d       elif name==
+00021be0: 227a 223a 0a20 2020 2020 2020 2020 2020  "z":.           
+00021bf0: 2073 656c 662e 7a20 3d20 7661 6c0a 2020   self.z = val.  
+00021c00: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00021c10: 2020 2020 2020 2020 7261 6973 6520 4174          raise At
+00021c20: 7472 6962 7574 6545 7272 6f72 2c22 7175  tributeError,"qu
+00021c30: 6174 2068 6173 206e 6f20 7772 6974 6162  at has no writab
+00021c40: 6c65 2061 7474 7269 6275 7465 2027 222b  le attribute '"+
+00021c50: 6e61 6d65 2b22 2722 0a0a 0a20 2020 2064  name+"'"...    d
+00021c60: 6566 205f 5f61 6273 5f5f 2873 656c 6629  ef __abs__(self)
+00021c70: 3a0a 2020 2020 2020 2020 2222 2252 6574  :.        """Ret
+00021c80: 7572 6e20 6d61 676e 6974 7564 652e 0a0a  urn magnitude...
+00021c90: 2020 2020 2020 2020 3e3e 3e20 713d 7175          >>> q=qu
+00021ca0: 6174 2830 2e39 3638 392c 2030 2e32 3136  at(0.9689, 0.216
+00021cb0: 302c 2030 2e31 3038 302c 2030 2e30 3534  0, 0.1080, 0.054
+00021cc0: 3029 0a20 2020 2020 2020 203e 3e3e 2070  0).        >>> p
+00021cd0: 7269 6e74 2872 6f75 6e64 2861 6273 2871  rint(round(abs(q
+00021ce0: 292c 3529 290a 2020 2020 2020 2020 312e  ),5)).        1.
+00021cf0: 300a 2020 2020 2020 2020 2222 220a 2020  0.        """.  
+00021d00: 2020 2020 2020 6364 6566 2064 6f75 626c        cdef doubl
+00021d10: 6520 610a 2020 2020 2020 2020 6120 3d20  e a.        a = 
+00021d20: 7365 6c66 2e77 2a73 656c 662e 7720 2b20  self.w*self.w + 
+00021d30: 7365 6c66 2e78 2a73 656c 662e 7820 2b20  self.x*self.x + 
+00021d40: 7365 6c66 2e79 2a73 656c 662e 7920 2b20  self.y*self.y + 
+00021d50: 7365 6c66 2e7a 2a73 656c 662e 7a0a 2020  self.z*self.z.  
+00021d60: 2020 2020 2020 7265 7475 726e 2073 7172        return sqr
+00021d70: 7428 6129 0a0a 2020 2020 6465 6620 636f  t(a)..    def co
+00021d80: 6e6a 7567 6174 6528 7365 6c66 293a 0a20  njugate(self):. 
+00021d90: 2020 2020 2020 2022 2222 5265 7475 726e         """Return
+00021da0: 2063 6f6e 6a75 6761 7465 2e0a 0a20 2020   conjugate...   
+00021db0: 2020 2020 203e 3e3e 2071 3d71 7561 7428       >>> q=quat(
+00021dc0: 302e 3936 3839 2c20 302e 3231 3630 2c20  0.9689, 0.2160, 
+00021dd0: 302e 3130 3830 2c20 302e 3035 3430 290a  0.1080, 0.0540).
+00021de0: 2020 2020 2020 2020 3e3e 3e20 7072 696e          >>> prin
+00021df0: 7428 712e 636f 6e6a 7567 6174 6528 2929  t(q.conjugate())
+00021e00: 0a20 2020 2020 2020 2028 302e 3936 3839  .        (0.9689
+00021e10: 2c20 2d30 2e32 3136 302c 202d 302e 3130  , -0.2160, -0.10
+00021e20: 3830 2c20 2d30 2e30 3534 3029 0a20 2020  80, -0.0540).   
+00021e30: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00021e40: 2063 6465 6620 7175 6174 2072 6573 0a20   cdef quat res. 
+00021e50: 2020 2020 2020 2072 6573 3d71 7561 7428         res=quat(
+00021e60: 290a 2020 2020 2020 2020 7265 732e 7720  ).        res.w 
+00021e70: 3d20 7365 6c66 2e77 0a20 2020 2020 2020  = self.w.       
+00021e80: 2072 6573 2e78 203d 202d 7365 6c66 2e78   res.x = -self.x
+00021e90: 0a20 2020 2020 2020 2072 6573 2e79 203d  .        res.y =
+00021ea0: 202d 7365 6c66 2e79 0a20 2020 2020 2020   -self.y.       
+00021eb0: 2072 6573 2e7a 203d 202d 7365 6c66 2e7a   res.z = -self.z
+00021ec0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00021ed0: 7265 730a 0a20 2020 2064 6566 206e 6f72  res..    def nor
+00021ee0: 6d61 6c69 7a65 2873 656c 6629 3a0a 2020  malize(self):.  
+00021ef0: 2020 2020 2020 2222 2252 6574 7572 6e20        """Return 
+00021f00: 6e6f 726d 616c 697a 6564 2071 7561 7465  normalized quate
+00021f10: 726e 696f 6e2e 0a0a 2020 2020 2020 2020  rnion...        
+00021f20: 3e3e 3e20 713d 7175 6174 2830 2e39 2c20  >>> q=quat(0.9, 
+00021f30: 302e 352c 2030 2e32 2c20 302e 3329 0a20  0.5, 0.2, 0.3). 
+00021f40: 2020 2020 2020 203e 3e3e 2071 3d71 2e6e         >>> q=q.n
+00021f50: 6f72 6d61 6c69 7a65 2829 0a20 2020 2020  ormalize().     
+00021f60: 2020 203e 3e3e 2070 7269 6e74 2871 290a     >>> print(q).
+00021f70: 2020 2020 2020 2020 2830 2e38 3235 302c          (0.8250,
+00021f80: 2030 2e34 3538 332c 2030 2e31 3833 332c   0.4583, 0.1833,
+00021f90: 2030 2e32 3735 3029 0a20 2020 2020 2020   0.2750).       
+00021fa0: 203e 3e3e 2070 7269 6e74 2861 6273 2871   >>> print(abs(q
+00021fb0: 2929 0a20 2020 2020 2020 2031 2e30 0a20  )).        1.0. 
+00021fc0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00021fd0: 2020 2063 6465 6620 7175 6174 2072 6573     cdef quat res
+00021fe0: 0a20 2020 2020 2020 2063 6465 6620 646f  .        cdef do
+00021ff0: 7562 6c65 206e 6c65 6e0a 0a20 2020 2020  uble nlen..     
+00022000: 2020 206e 6c65 6e20 3d20 7371 7274 2873     nlen = sqrt(s
+00022010: 656c 662e 772a 7365 6c66 2e77 2b73 656c  elf.w*self.w+sel
+00022020: 662e 782a 7365 6c66 2e78 2b73 656c 662e  f.x*self.x+self.
+00022030: 792a 7365 6c66 2e79 2b73 656c 662e 7a2a  y*self.y+self.z*
+00022040: 7365 6c66 2e7a 290a 2020 2020 2020 2020  self.z).        
+00022050: 6966 206e 6c65 6e3c 3d65 7073 3a0a 2020  if nlen<=eps:.  
+00022060: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00022070: 5a65 726f 4469 7669 7369 6f6e 4572 726f  ZeroDivisionErro
+00022080: 722c 2271 7561 7420 6469 7669 7369 6f6e  r,"quat division
+00022090: 220a 0a20 2020 2020 2020 206e 6c65 6e20  "..        nlen 
+000220a0: 3d20 312e 302f 6e6c 656e 0a20 2020 2020  = 1.0/nlen.     
+000220b0: 2020 2072 6573 203d 2071 7561 7428 290a     res = quat().
+000220c0: 2020 2020 2020 2020 7265 732e 7720 3d20          res.w = 
+000220d0: 7365 6c66 2e77 2a6e 6c65 6e0a 2020 2020  self.w*nlen.    
+000220e0: 2020 2020 7265 732e 7820 3d20 7365 6c66      res.x = self
+000220f0: 2e78 2a6e 6c65 6e0a 2020 2020 2020 2020  .x*nlen.        
+00022100: 7265 732e 7920 3d20 7365 6c66 2e79 2a6e  res.y = self.y*n
+00022110: 6c65 6e0a 2020 2020 2020 2020 7265 732e  len.        res.
+00022120: 7a20 3d20 7365 6c66 2e7a 2a6e 6c65 6e0a  z = self.z*nlen.
+00022130: 2020 2020 2020 2020 7265 7475 726e 2072          return r
+00022140: 6573 0a0a 2020 2020 6465 6620 696e 7665  es..    def inve
+00022150: 7273 6528 7365 6c66 293a 0a20 2020 2020  rse(self):.     
+00022160: 2020 2022 2222 5265 7475 726e 2069 6e76     """Return inv
+00022170: 6572 7365 2e0a 0a20 2020 2020 2020 203e  erse...        >
+00022180: 3e3e 2071 3d71 7561 7428 302e 392c 2030  >> q=quat(0.9, 0
+00022190: 2e35 2c20 302e 322c 2030 2e33 290a 2020  .5, 0.2, 0.3).  
+000221a0: 2020 2020 2020 3e3e 3e20 7072 696e 7428        >>> print(
+000221b0: 712e 696e 7665 7273 6528 2929 0a20 2020  q.inverse()).   
+000221c0: 2020 2020 2028 302e 3735 3633 2c20 2d30       (0.7563, -0
+000221d0: 2e34 3230 322c 202d 302e 3136 3831 2c20  .4202, -0.1681, 
+000221e0: 2d30 2e32 3532 3129 0a20 2020 2020 2020  -0.2521).       
+000221f0: 2022 2222 0a20 2020 2020 2020 2063 6465   """.        cde
+00022200: 6620 7175 6174 2072 6573 0a0a 2020 2020  f quat res..    
+00022210: 2020 2020 6c65 6e5f 3220 3d20 7365 6c66      len_2 = self
+00022220: 2e77 2a73 656c 662e 772b 7365 6c66 2e78  .w*self.w+self.x
+00022230: 2a73 656c 662e 782b 7365 6c66 2e79 2a73  *self.x+self.y*s
+00022240: 656c 662e 792b 7365 6c66 2e7a 2a73 656c  elf.y+self.z*sel
+00022250: 662e 7a0a 2020 2020 2020 2020 6966 2066  f.z.        if f
+00022260: 6162 7328 6c65 6e5f 3229 3c3d 6570 733a  abs(len_2)<=eps:
+00022270: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+00022280: 7365 205a 6572 6f44 6976 6973 696f 6e45  se ZeroDivisionE
+00022290: 7272 6f72 2c22 7175 6174 2069 7320 6e6f  rror,"quat is no
+000222a0: 7420 696e 7665 7274 6962 6c65 220a 0a20  t invertible".. 
+000222b0: 2020 2020 2020 206c 656e 5f32 203d 2031         len_2 = 1
+000222c0: 2e30 2f6c 656e 5f32 0a20 2020 2020 2020  .0/len_2.       
+000222d0: 2072 6573 203d 2071 7561 7428 290a 2020   res = quat().  
+000222e0: 2020 2020 2020 7265 732e 7720 3d20 2073        res.w =  s
+000222f0: 656c 662e 772a 6c65 6e5f 320a 2020 2020  elf.w*len_2.    
+00022300: 2020 2020 7265 732e 7820 3d20 2d73 656c      res.x = -sel
+00022310: 662e 782a 6c65 6e5f 320a 2020 2020 2020  f.x*len_2.      
+00022320: 2020 7265 732e 7920 3d20 2d73 656c 662e    res.y = -self.
+00022330: 792a 6c65 6e5f 320a 2020 2020 2020 2020  y*len_2.        
+00022340: 7265 732e 7a20 3d20 2d73 656c 662e 7a2a  res.z = -self.z*
+00022350: 6c65 6e5f 320a 2020 2020 2020 2020 7265  len_2.        re
+00022360: 7475 726e 2072 6573 0a0a 2020 2020 6465  turn res..    de
+00022370: 6620 746f 416e 676c 6541 7869 7328 7365  f toAngleAxis(se
+00022380: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
+00022390: 5265 7475 726e 2061 6e67 6c65 2028 696e  Return angle (in
+000223a0: 2072 6164 6961 6e73 2920 616e 6420 726f   radians) and ro
+000223b0: 7461 7469 6f6e 2061 7869 732e 0a0a 2020  tation axis...  
+000223c0: 2020 2020 2020 3e3e 3e20 713d 7175 6174        >>> q=quat
+000223d0: 2830 2e39 2c20 302e 352c 2030 2e32 2c20  (0.9, 0.5, 0.2, 
+000223e0: 302e 3329 0a20 2020 2020 2020 203e 3e3e  0.3).        >>>
+000223f0: 2061 6e67 6c65 2c20 6178 6973 203d 2071   angle, axis = q
+00022400: 2e74 6f41 6e67 6c65 4178 6973 2829 0a20  .toAngleAxis(). 
+00022410: 2020 2020 2020 203e 3e3e 2070 7269 6e74         >>> print
+00022420: 2872 6f75 6e64 2861 6e67 6c65 2c34 2929  (round(angle,4))
+00022430: 0a20 2020 2020 2020 2031 2e32 3031 310a  .        1.2011.
+00022440: 2020 2020 2020 2020 3e3e 3e20 7072 696e          >>> prin
+00022450: 7428 6178 6973 290a 2020 2020 2020 2020  t(axis).        
+00022460: 2830 2e38 3131 312c 2030 2e33 3234 342c  (0.8111, 0.3244,
+00022470: 2030 2e34 3836 3729 0a20 2020 2020 2020   0.4867).       
+00022480: 2022 2222 0a20 2020 2020 2020 2063 6465   """.        cde
+00022490: 6620 7175 6174 2071 0a20 2020 2020 2020  f quat q.       
+000224a0: 2063 6465 6620 646f 7562 6c65 2073 2c77   cdef double s,w
+000224b0: 0a0a 2020 2020 2020 2020 7120 3d20 7365  ..        q = se
+000224c0: 6c66 2e6e 6f72 6d61 6c69 7a65 2829 0a0a  lf.normalize()..
+000224d0: 2020 2020 2020 2020 2320 436c 616d 7020          # Clamp 
+000224e0: 6e73 656c 662e 7720 2873 696e 6365 2074  nself.w (since t
+000224f0: 6865 2071 7561 7420 6861 7320 746f 2062  he quat has to b
+00022500: 6520 6e6f 726d 616c 697a 6564 2069 7420  e normalized it 
+00022510: 7368 6f75 6c64 0a20 2020 2020 2020 2023  should.        #
+00022520: 2062 6520 6265 7477 6565 6e20 2d31 2061   be between -1 a
+00022530: 6e64 2031 2061 6e79 7761 792c 2062 7574  nd 1 anyway, but
+00022540: 2069 7420 6d69 6768 7420 6265 2073 6c69   it might be sli
+00022550: 6768 746c 7920 6f66 6620 6475 650a 2020  ghtly off due.  
+00022560: 2020 2020 2020 2320 746f 206e 756d 6572        # to numer
+00022570: 6963 616c 2069 6e61 6363 7572 6163 6965  ical inaccuracie
+00022580: 7329 0a20 2020 2020 2020 2069 6620 712e  s).        if q.
+00022590: 773c 2d31 2e30 3a0a 2020 2020 2020 2020  w<-1.0:.        
+000225a0: 2020 2020 7720 3d20 2d31 2e30 0a20 2020      w = -1.0.   
+000225b0: 2020 2020 2065 6c69 6620 712e 773e 312e       elif q.w>1.
+000225c0: 303a 0a20 2020 2020 2020 2020 2020 2077  0:.            w
+000225d0: 203d 2031 2e30 0a20 2020 2020 2020 2065   = 1.0.        e
+000225e0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+000225f0: 2077 203d 2071 2e77 0a0a 2020 2020 2020   w = q.w..      
+00022600: 2020 7720 3d20 6163 6f73 2877 290a 2020    w = acos(w).  
+00022610: 2020 2020 2020 7320 3d20 7369 6e28 7729        s = sin(w)
+00022620: 0a20 2020 2020 2020 2069 6620 733c 3d65  .        if s<=e
+00022630: 7073 3a0a 2020 2020 2020 2020 2020 2020  ps:.            
+00022640: 7265 7475 726e 2028 302e 302c 2076 6563  return (0.0, vec
+00022650: 3328 302e 302c 302e 302c 302e 3029 290a  3(0.0,0.0,0.0)).
+00022660: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00022670: 2832 2e30 2a77 2c20 7665 6333 2871 2e78  (2.0*w, vec3(q.x
+00022680: 2f73 2c20 712e 792f 732c 2071 2e7a 2f73  /s, q.y/s, q.z/s
+00022690: 2929 0a0a 2020 2020 6465 6620 6672 6f6d  ))..    def from
+000226a0: 416e 676c 6541 7869 7328 7365 6c66 2c20  AngleAxis(self, 
+000226b0: 616e 676c 652c 2061 7869 7329 3a0a 2020  angle, axis):.  
+000226c0: 2020 2020 2020 2222 2249 6e69 7469 616c        """Initial
+000226d0: 697a 6520 7365 6c66 2066 726f 6d20 616e  ize self from an
+000226e0: 2061 6e67 6c65 2028 696e 2072 6164 6961   angle (in radia
+000226f0: 6e73 2920 616e 6420 616e 2061 7869 7320  ns) and an axis 
+00022700: 616e 6420 7265 7475 726e 7320 7365 6c66  and returns self
+00022710: 2e22 2222 0a20 2020 2020 2020 2063 6465  .""".        cde
+00022720: 6620 646f 7562 6c65 2061 2c6e 2c20 782c  f double a,n, x,
+00022730: 792c 7a0a 2020 2020 2020 2020 6364 6566  y,z.        cdef
+00022740: 2071 7561 7420 710a 0a20 2020 2020 2020   quat q..       
+00022750: 2061 203d 2061 6e67 6c65 2f32 2e30 0a20   a = angle/2.0. 
+00022760: 2020 2020 2020 2073 656c 662e 7720 3d20         self.w = 
+00022770: 636f 7328 6129 0a0a 2020 2020 2020 2020  cos(a)..        
+00022780: 7820 3d20 6178 6973 5b30 5d0a 2020 2020  x = axis[0].    
+00022790: 2020 2020 7920 3d20 6178 6973 5b31 5d0a      y = axis[1].
+000227a0: 2020 2020 2020 2020 7a20 3d20 6178 6973          z = axis
+000227b0: 5b32 5d0a 2020 2020 2020 2020 6e20 3d20  [2].        n = 
+000227c0: 782a 782b 792a 792b 7a2a 7a0a 2020 2020  x*x+y*y+z*z.    
+000227d0: 2020 2020 6966 206e 3c3d 6570 733a 0a20      if n<=eps:. 
+000227e0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+000227f0: 2056 616c 7565 4572 726f 722c 2261 7869   ValueError,"axi
+00022800: 7320 6d75 7374 6e27 7420 6265 2074 6865  s mustn't be the
+00022810: 206e 756c 6c20 7665 6374 6f72 220a 0a20   null vector".. 
+00022820: 2020 2020 2020 2073 203d 2073 696e 2861         s = sin(a
+00022830: 292f 6e0a 2020 2020 2020 2020 7365 6c66  )/n.        self
+00022840: 2e78 203d 2078 2a73 0a20 2020 2020 2020  .x = x*s.       
+00022850: 2073 656c 662e 7920 3d20 792a 730a 2020   self.y = y*s.  
+00022860: 2020 2020 2020 7365 6c66 2e7a 203d 207a        self.z = z
+00022870: 2a73 0a0a 2020 2020 2020 2020 2320 4e6f  *s..        # No
+00022880: 726d 616c 697a 6520 7468 6520 7175 6174  rmalize the quat
+00022890: 0a20 2020 2020 2020 2071 203d 2073 656c  .        q = sel
+000228a0: 662e 6e6f 726d 616c 697a 6528 290a 2020  f.normalize().  
+000228b0: 2020 2020 2020 7365 6c66 2e77 203d 2071        self.w = q
+000228c0: 2e77 0a20 2020 2020 2020 2073 656c 662e  .w.        self.
+000228d0: 7820 3d20 712e 780a 2020 2020 2020 2020  x = q.x.        
+000228e0: 7365 6c66 2e79 203d 2071 2e79 0a20 2020  self.y = q.y.   
+000228f0: 2020 2020 2073 656c 662e 7a20 3d20 712e       self.z = q.
+00022900: 7a0a 2020 2020 2020 2020 7265 7475 726e  z.        return
+00022910: 2073 656c 660a 0a20 2020 2064 6566 2074   self..    def t
+00022920: 6f4d 6174 3328 7365 6c66 293a 0a20 2020  oMat3(self):.   
+00022930: 2020 2020 2022 2222 5265 7475 726e 2072       """Return r
+00022940: 6f74 6174 696f 6e20 6d61 7472 6978 2061  otation matrix a
+00022950: 7320 6d61 7433 2e22 2222 0a20 2020 2020  s mat3.""".     
+00022960: 2020 2063 6465 6620 6d61 7433 2072 6573     cdef mat3 res
+00022970: 0a20 2020 2020 2020 2063 6465 6620 7878  .        cdef xx
+00022980: 2c79 792c 7a7a 2c78 792c 7a77 2c78 7a2c  ,yy,zz,xy,zw,xz,
+00022990: 7977 2c79 7a2c 7877 0a0a 2020 2020 2020  yw,yz,xw..      
+000229a0: 2020 7878 203d 2032 2e30 2a73 656c 662e    xx = 2.0*self.
+000229b0: 782a 7365 6c66 2e78 0a20 2020 2020 2020  x*self.x.       
+000229c0: 2079 7920 3d20 322e 302a 7365 6c66 2e79   yy = 2.0*self.y
+000229d0: 2a73 656c 662e 790a 2020 2020 2020 2020  *self.y.        
+000229e0: 7a7a 203d 2032 2e30 2a73 656c 662e 7a2a  zz = 2.0*self.z*
+000229f0: 7365 6c66 2e7a 0a20 2020 2020 2020 2078  self.z.        x
+00022a00: 7920 3d20 322e 302a 7365 6c66 2e78 2a73  y = 2.0*self.x*s
+00022a10: 656c 662e 790a 2020 2020 2020 2020 7a77  elf.y.        zw
+00022a20: 203d 2032 2e30 2a73 656c 662e 7a2a 7365   = 2.0*self.z*se
+00022a30: 6c66 2e77 0a20 2020 2020 2020 2078 7a20  lf.w.        xz 
+00022a40: 3d20 322e 302a 7365 6c66 2e78 2a73 656c  = 2.0*self.x*sel
+00022a50: 662e 7a0a 2020 2020 2020 2020 7977 203d  f.z.        yw =
+00022a60: 2032 2e30 2a73 656c 662e 792a 7365 6c66   2.0*self.y*self
+00022a70: 2e77 0a20 2020 2020 2020 2079 7a20 3d20  .w.        yz = 
+00022a80: 322e 302a 7365 6c66 2e79 2a73 656c 662e  2.0*self.y*self.
+00022a90: 7a0a 2020 2020 2020 2020 7877 203d 2032  z.        xw = 2
+00022aa0: 2e30 2a73 656c 662e 782a 7365 6c66 2e77  .0*self.x*self.w
+00022ab0: 0a0a 2020 2020 2020 2020 7265 7320 3d20  ..        res = 
+00022ac0: 6d61 7433 2829 0a20 2020 2020 2020 2072  mat3().        r
+00022ad0: 6573 2e6d 3131 203d 2031 2e30 2d79 792d  es.m11 = 1.0-yy-
+00022ae0: 7a7a 0a20 2020 2020 2020 2072 6573 2e6d  zz.        res.m
+00022af0: 3132 203d 2078 792d 7a77 0a20 2020 2020  12 = xy-zw.     
+00022b00: 2020 2072 6573 2e6d 3133 203d 2078 7a2b     res.m13 = xz+
+00022b10: 7977 0a20 2020 2020 2020 2072 6573 2e6d  yw.        res.m
+00022b20: 3231 203d 2078 792b 7a77 0a20 2020 2020  21 = xy+zw.     
+00022b30: 2020 2072 6573 2e6d 3232 203d 2031 2e30     res.m22 = 1.0
+00022b40: 2d78 782d 7a7a 0a20 2020 2020 2020 2072  -xx-zz.        r
+00022b50: 6573 2e6d 3233 203d 2079 7a2d 7877 0a20  es.m23 = yz-xw. 
+00022b60: 2020 2020 2020 2072 6573 2e6d 3331 203d         res.m31 =
+00022b70: 2078 7a2d 7977 0a20 2020 2020 2020 2072   xz-yw.        r
+00022b80: 6573 2e6d 3332 203d 2079 7a2b 7877 0a20  es.m32 = yz+xw. 
+00022b90: 2020 2020 2020 2072 6573 2e6d 3333 203d         res.m33 =
+00022ba0: 2031 2e30 2d78 782d 7979 0a20 2020 2020   1.0-xx-yy.     
+00022bb0: 2020 2072 6574 7572 6e20 7265 730a 0a20     return res.. 
+00022bc0: 2020 2064 6566 2074 6f4d 6174 3428 7365     def toMat4(se
+00022bd0: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
+00022be0: 5265 7475 726e 2072 6f74 6174 696f 6e20  Return rotation 
+00022bf0: 6d61 7472 6978 2061 7320 6d61 7434 2e22  matrix as mat4."
+00022c00: 2222 0a20 2020 2020 2020 2063 6465 6620  "".        cdef 
+00022c10: 6d61 7434 2072 6573 0a20 2020 2020 2020  mat4 res.       
+00022c20: 2063 6465 6620 7878 2c79 792c 7a7a 2c78   cdef xx,yy,zz,x
+00022c30: 792c 7a77 2c78 7a2c 7977 2c79 7a2c 7877  y,zw,xz,yw,yz,xw
+00022c40: 0a0a 2020 2020 2020 2020 7878 203d 2032  ..        xx = 2
+00022c50: 2e30 2a73 656c 662e 782a 7365 6c66 2e78  .0*self.x*self.x
+00022c60: 0a20 2020 2020 2020 2079 7920 3d20 322e  .        yy = 2.
+00022c70: 302a 7365 6c66 2e79 2a73 656c 662e 790a  0*self.y*self.y.
+00022c80: 2020 2020 2020 2020 7a7a 203d 2032 2e30          zz = 2.0
+00022c90: 2a73 656c 662e 7a2a 7365 6c66 2e7a 0a20  *self.z*self.z. 
+00022ca0: 2020 2020 2020 2078 7920 3d20 322e 302a         xy = 2.0*
+00022cb0: 7365 6c66 2e78 2a73 656c 662e 790a 2020  self.x*self.y.  
+00022cc0: 2020 2020 2020 7a77 203d 2032 2e30 2a73        zw = 2.0*s
+00022cd0: 656c 662e 7a2a 7365 6c66 2e77 0a20 2020  elf.z*self.w.   
+00022ce0: 2020 2020 2078 7a20 3d20 322e 302a 7365       xz = 2.0*se
+00022cf0: 6c66 2e78 2a73 656c 662e 7a0a 2020 2020  lf.x*self.z.    
+00022d00: 2020 2020 7977 203d 2032 2e30 2a73 656c      yw = 2.0*sel
+00022d10: 662e 792a 7365 6c66 2e77 0a20 2020 2020  f.y*self.w.     
+00022d20: 2020 2079 7a20 3d20 322e 302a 7365 6c66     yz = 2.0*self
+00022d30: 2e79 2a73 656c 662e 7a0a 2020 2020 2020  .y*self.z.      
+00022d40: 2020 7877 203d 2032 2e30 2a73 656c 662e    xw = 2.0*self.
+00022d50: 782a 7365 6c66 2e77 0a0a 2020 2020 2020  x*self.w..      
+00022d60: 2020 7265 7320 3d20 6d61 7434 2829 0a0a    res = mat4()..
+00022d70: 2020 2020 2020 2020 7265 732e 6d31 3120          res.m11 
+00022d80: 3d20 312e 302d 7979 2d7a 7a0a 2020 2020  = 1.0-yy-zz.    
+00022d90: 2020 2020 7265 732e 6d31 3220 3d20 7879      res.m12 = xy
+00022da0: 2d7a 770a 2020 2020 2020 2020 7265 732e  -zw.        res.
+00022db0: 6d31 3320 3d20 787a 2b79 770a 2020 2020  m13 = xz+yw.    
+00022dc0: 2020 2020 7265 732e 6d31 3420 3d20 302e      res.m14 = 0.
+00022dd0: 300a 2020 2020 2020 2020 7265 732e 6d32  0.        res.m2
+00022de0: 3120 3d20 7879 2b7a 770a 2020 2020 2020  1 = xy+zw.      
+00022df0: 2020 7265 732e 6d32 3220 3d20 312e 302d    res.m22 = 1.0-
+00022e00: 7878 2d7a 7a0a 2020 2020 2020 2020 7265  xx-zz.        re
+00022e10: 732e 6d32 3320 3d20 797a 2d78 770a 2020  s.m23 = yz-xw.  
+00022e20: 2020 2020 2020 7265 732e 6d32 3420 3d20        res.m24 = 
+00022e30: 302e 300a 2020 2020 2020 2020 7265 732e  0.0.        res.
+00022e40: 6d33 3120 3d20 787a 2d79 770a 2020 2020  m31 = xz-yw.    
+00022e50: 2020 2020 7265 732e 6d33 3220 3d20 797a      res.m32 = yz
+00022e60: 2b78 770a 2020 2020 2020 2020 7265 732e  +xw.        res.
+00022e70: 6d33 3320 3d20 312e 302d 7878 2d79 790a  m33 = 1.0-xx-yy.
+00022e80: 2020 2020 2020 2020 7265 732e 6d33 3420          res.m34 
+00022e90: 3d20 302e 300a 2020 2020 2020 2020 7265  = 0.0.        re
+00022ea0: 732e 6d34 3120 3d20 302e 300a 2020 2020  s.m41 = 0.0.    
+00022eb0: 2020 2020 7265 732e 6d34 3220 3d20 302e      res.m42 = 0.
+00022ec0: 300a 2020 2020 2020 2020 7265 732e 6d34  0.        res.m4
+00022ed0: 3320 3d20 302e 300a 2020 2020 2020 2020  3 = 0.0.        
+00022ee0: 7265 732e 6d34 3420 3d20 312e 300a 2020  res.m44 = 1.0.  
+00022ef0: 2020 2020 2020 7265 7475 726e 2072 6573        return res
+00022f00: 0a0a 2020 2020 6465 6620 6672 6f6d 4d61  ..    def fromMa
+00022f10: 7428 7365 6c66 2c20 6d29 3a0a 2020 2020  t(self, m):.    
+00022f20: 2020 2020 2222 2249 6e69 7469 616c 697a      """Initializ
+00022f30: 6520 7365 6c66 2066 726f 6d20 6569 7468  e self from eith
+00022f40: 6572 2061 206d 6174 3320 6f72 206d 6174  er a mat3 or mat
+00022f50: 3420 616e 6420 7265 7475 726e 7320 7365  4 and returns se
+00022f60: 6c66 2e22 2222 0a20 2020 2020 2020 2063  lf.""".        c
+00022f70: 6465 6620 646f 7562 6c65 2064 312c 6432  def double d1,d2
+00022f80: 2c64 332c 6164 312c 6164 322c 6164 332c  ,d3,ad1,ad2,ad3,
+00022f90: 742c 730a 0a20 2020 2020 2020 2064 3120  t,s..        d1 
+00022fa0: 3d20 6d5b 302c 305d 0a20 2020 2020 2020  = m[0,0].       
+00022fb0: 2064 3220 3d20 6d5b 312c 315d 0a20 2020   d2 = m[1,1].   
+00022fc0: 2020 2020 2064 3320 3d20 6d5b 322c 325d       d3 = m[2,2]
+00022fd0: 0a20 2020 2020 2020 2074 203d 2064 312b  .        t = d1+
+00022fe0: 6432 2b64 332b 312e 300a 2020 2020 2020  d2+d3+1.0.      
+00022ff0: 2020 6966 2074 3e30 2e30 3a0a 2020 2020    if t>0.0:.    
+00023000: 2020 2020 2020 2020 7320 3d20 302e 352f          s = 0.5/
+00023010: 7371 7274 2874 290a 2020 2020 2020 2020  sqrt(t).        
+00023020: 2020 2020 7365 6c66 2e77 203d 2030 2e32      self.w = 0.2
+00023030: 352f 730a 2020 2020 2020 2020 2020 2020  5/s.            
+00023040: 7365 6c66 2e78 203d 2028 6d5b 322c 315d  self.x = (m[2,1]
+00023050: 2d6d 5b31 2c32 5d29 2a73 0a20 2020 2020  -m[1,2])*s.     
+00023060: 2020 2020 2020 2073 656c 662e 7920 3d20         self.y = 
+00023070: 286d 5b30 2c32 5d2d 6d5b 322c 305d 292a  (m[0,2]-m[2,0])*
+00023080: 730a 2020 2020 2020 2020 2020 2020 7365  s.            se
+00023090: 6c66 2e7a 203d 2028 6d5b 312c 305d 2d6d  lf.z = (m[1,0]-m
+000230a0: 5b30 2c31 5d29 2a73 0a20 2020 2020 2020  [0,1])*s.       
+000230b0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+000230c0: 2020 2061 6431 203d 2066 6162 7328 6431     ad1 = fabs(d1
+000230d0: 290a 2020 2020 2020 2020 2020 2020 6164  ).            ad
+000230e0: 3220 3d20 6661 6273 2864 3229 0a20 2020  2 = fabs(d2).   
+000230f0: 2020 2020 2020 2020 2061 6433 203d 2066           ad3 = f
+00023100: 6162 7328 6433 290a 2020 2020 2020 2020  abs(d3).        
+00023110: 2020 2020 6966 2061 6431 3e3d 6164 3220      if ad1>=ad2 
+00023120: 616e 6420 6164 313e 3d61 6433 3a0a 2020  and ad1>=ad3:.  
+00023130: 2020 2020 2020 2020 2020 2020 2020 7320                s 
+00023140: 3d20 7371 7274 2831 2e30 2b64 312d 6432  = sqrt(1.0+d1-d2
+00023150: 2d64 3329 2a32 2e30 0a20 2020 2020 2020  -d3)*2.0.       
+00023160: 2020 2020 2020 2020 2073 656c 662e 7820           self.x 
+00023170: 3d20 302e 352f 730a 2020 2020 2020 2020  = 0.5/s.        
+00023180: 2020 2020 2020 2020 7365 6c66 2e79 203d          self.y =
+00023190: 2028 6d5b 302c 315d 2b6d 5b31 2c30 5d29   (m[0,1]+m[1,0])
+000231a0: 2f73 0a20 2020 2020 2020 2020 2020 2020  /s.             
+000231b0: 2020 2073 656c 662e 7a20 3d20 286d 5b30     self.z = (m[0
+000231c0: 2c32 5d2b 6d5b 322c 305d 292f 730a 2020  ,2]+m[2,0])/s.  
+000231d0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+000231e0: 6c66 2e77 203d 2028 6d5b 312c 325d 2b6d  lf.w = (m[1,2]+m
+000231f0: 5b32 2c31 5d29 2f73 0a20 2020 2020 2020  [2,1])/s.       
+00023200: 2020 2020 2065 6c69 6620 6164 323e 3d61       elif ad2>=a
+00023210: 6431 2061 6e64 2061 6432 3e3d 6164 333a  d1 and ad2>=ad3:
+00023220: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00023230: 2073 203d 2073 7172 7428 312e 302b 6432   s = sqrt(1.0+d2
+00023240: 2d64 312d 6433 292a 322e 300a 2020 2020  -d1-d3)*2.0.    
+00023250: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00023260: 2e78 203d 2028 6d5b 302c 315d 2b6d 5b31  .x = (m[0,1]+m[1
+00023270: 2c30 5d29 2f73 0a20 2020 2020 2020 2020  ,0])/s.         
+00023280: 2020 2020 2020 2073 656c 662e 7920 3d20         self.y = 
+00023290: 302e 352f 730a 2020 2020 2020 2020 2020  0.5/s.          
+000232a0: 2020 2020 2020 7365 6c66 2e7a 203d 2028        self.z = (
+000232b0: 6d5b 312c 325d 2b6d 5b32 2c31 5d29 2f73  m[1,2]+m[2,1])/s
+000232c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000232d0: 2073 656c 662e 7720 3d20 286d 5b30 2c32   self.w = (m[0,2
+000232e0: 5d2b 6d5b 322c 305d 292f 730a 2020 2020  ]+m[2,0])/s.    
+000232f0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00023300: 2020 2020 2020 2020 2020 2020 2020 7320                s 
+00023310: 3d20 7371 7274 2831 2e30 2b64 332d 6431  = sqrt(1.0+d3-d1
+00023320: 2d64 3229 2a32 2e30 0a20 2020 2020 2020  -d2)*2.0.       
+00023330: 2020 2020 2020 2020 2073 656c 662e 7820           self.x 
+00023340: 3d20 286d 5b30 2c32 5d2b 6d5b 322c 305d  = (m[0,2]+m[2,0]
+00023350: 292f 730a 2020 2020 2020 2020 2020 2020  )/s.            
+00023360: 2020 2020 7365 6c66 2e79 203d 2028 6d5b      self.y = (m[
+00023370: 312c 325d 2b6d 5b32 2c31 5d29 2f73 0a20  1,2]+m[2,1])/s. 
+00023380: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00023390: 656c 662e 7a20 3d20 302e 352f 730a 2020  elf.z = 0.5/s.  
+000233a0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+000233b0: 6c66 2e77 203d 2028 6d5b 302c 315d 2b6d  lf.w = (m[0,1]+m
+000233c0: 5b31 2c30 5d29 2f73 0a0a 2020 2020 2020  [1,0])/s..      
+000233d0: 2020 7265 7475 726e 2073 656c 660a 0a20    return self.. 
+000233e0: 2020 2064 6566 2064 6f74 2873 656c 662c     def dot(self,
+000233f0: 2071 7561 7420 6229 3a0a 2020 2020 2020   quat b):.      
+00023400: 2020 2222 2252 6574 7572 6e20 7468 6520    """Return the 
+00023410: 646f 7420 7072 6f64 7563 7420 6f66 2073  dot product of s
+00023420: 656c 6620 616e 6420 622e 2222 220a 2020  elf and b.""".  
+00023430: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00023440: 662e 772a 622e 7720 2b20 7365 6c66 2e78  f.w*b.w + self.x
+00023450: 2a62 2e78 202b 2073 656c 662e 792a 622e  *b.x + self.y*b.
+00023460: 7920 2b20 7365 6c66 2e7a 2a62 2e7a 0a0a  y + self.z*b.z..
+00023470: 2020 2020 6465 6620 6c6f 6728 7365 6c66      def log(self
+00023480: 293a 0a20 2020 2020 2020 2022 2222 5265  ):.        """Re
+00023490: 7475 726e 2074 6865 206e 6174 7572 616c  turn the natural
+000234a0: 206c 6f67 6172 6974 686d 206f 6620 7365   logarithm of se
+000234b0: 6c66 2e22 2222 0a0a 2020 2020 2020 2020  lf."""..        
+000234c0: 6364 6566 2064 6f75 626c 6520 622c 2074  cdef double b, t
+000234d0: 2c20 662c 2063 742c 2072 0a20 2020 2020  , f, ct, r.     
+000234e0: 2020 2063 6465 6620 7175 6174 2072 6573     cdef quat res
+000234f0: 0a0a 2020 2020 2020 2020 6220 3d20 7371  ..        b = sq
+00023500: 7274 2873 656c 662e 782a 7365 6c66 2e78  rt(self.x*self.x
+00023510: 202b 2073 656c 662e 792a 7365 6c66 2e79   + self.y*self.y
+00023520: 202b 2073 656c 662e 7a2a 7365 6c66 2e7a   + self.z*self.z
+00023530: 290a 2020 2020 2020 2020 7265 7320 3d20  ).        res = 
+00023540: 7175 6174 2829 0a20 2020 2020 2020 2069  quat().        i
+00023550: 6620 6661 6273 2862 293c 3d65 7073 3a0a  f fabs(b)<=eps:.
+00023560: 2020 2020 2020 2020 2020 2020 7265 732e              res.
+00023570: 7820 3d20 302e 300a 2020 2020 2020 2020  x = 0.0.        
+00023580: 2020 2020 7265 732e 7920 3d20 302e 300a      res.y = 0.0.
+00023590: 2020 2020 2020 2020 2020 2020 7265 732e              res.
+000235a0: 7a20 3d20 302e 300a 2020 2020 2020 2020  z = 0.0.        
+000235b0: 2020 2020 6966 2073 656c 662e 773c 3d65      if self.w<=e
+000235c0: 7073 3a0a 2020 2020 2020 2020 2020 2020  ps:.            
+000235d0: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+000235e0: 7272 6f72 2c20 226d 6174 6820 646f 6d61  rror, "math doma
+000235f0: 696e 2065 7272 6f72 220a 2020 2020 2020  in error".      
+00023600: 2020 2020 2020 7265 732e 7720 3d20 6c6f        res.w = lo
+00023610: 6728 7365 6c66 2e77 290a 2020 2020 2020  g(self.w).      
+00023620: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00023630: 2020 2020 7420 3d20 6174 616e 3228 622c      t = atan2(b,
+00023640: 2073 656c 662e 7729 0a20 2020 2020 2020   self.w).       
+00023650: 2020 2020 2066 203d 2074 2f62 0a20 2020       f = t/b.   
+00023660: 2020 2020 2020 2020 2072 6573 2e78 203d           res.x =
+00023670: 2066 2a73 656c 662e 780a 2020 2020 2020   f*self.x.      
+00023680: 2020 2020 2020 7265 732e 7920 3d20 662a        res.y = f*
+00023690: 7365 6c66 2e79 0a20 2020 2020 2020 2020  self.y.         
+000236a0: 2020 2072 6573 2e7a 203d 2066 2a73 656c     res.z = f*sel
+000236b0: 662e 7a0a 2020 2020 2020 2020 2020 2020  f.z.            
+000236c0: 6374 203d 2063 6f73 2874 290a 2020 2020  ct = cos(t).    
+000236d0: 2020 2020 2020 2020 6966 2066 6162 7328          if fabs(
+000236e0: 6374 293c 3d65 7073 3a0a 2020 2020 2020  ct)<=eps:.      
+000236f0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00023700: 5661 6c75 6545 7272 6f72 2c20 226d 6174  ValueError, "mat
+00023710: 6820 646f 6d61 696e 2065 7272 6f72 220a  h domain error".
+00023720: 2020 2020 2020 2020 2020 2020 7220 3d20              r = 
+00023730: 7365 6c66 2e77 2f63 740a 2020 2020 2020  self.w/ct.      
+00023740: 2020 2020 2020 6966 2072 3c3d 6570 733a        if r<=eps:
+00023750: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00023760: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+00023770: 722c 2022 6d61 7468 2064 6f6d 6169 6e20  r, "math domain 
+00023780: 6572 726f 7222 0a20 2020 2020 2020 2020  error".         
+00023790: 2020 2072 6573 2e77 203d 206c 6f67 2872     res.w = log(r
+000237a0: 290a 0a20 2020 2020 2020 2072 6574 7572  )..        retur
+000237b0: 6e20 7265 730a 0a20 2020 2064 6566 2065  n res..    def e
+000237c0: 7870 2873 656c 6629 3a0a 2020 2020 2020  xp(self):.      
+000237d0: 2020 2222 2252 6574 7572 6e20 7468 6520    """Return the 
+000237e0: 6578 706f 6e65 6e74 6961 6c20 6f66 2073  exponential of s
+000237f0: 656c 662e 2222 220a 0a20 2020 2020 2020  elf."""..       
+00023800: 2063 6465 6620 646f 7562 6c65 2062 2c20   cdef double b, 
+00023810: 660a 2020 2020 2020 2020 6364 6566 2071  f.        cdef q
+00023820: 7561 7420 7265 730a 0a20 2020 2020 2020  uat res..       
+00023830: 2062 203d 2073 7172 7428 7365 6c66 2e78   b = sqrt(self.x
+00023840: 2a73 656c 662e 7820 2b20 7365 6c66 2e79  *self.x + self.y
+00023850: 2a73 656c 662e 7920 2b20 7365 6c66 2e7a  *self.y + self.z
+00023860: 2a73 656c 662e 7a29 0a20 2020 2020 2020  *self.z).       
+00023870: 2072 6573 203d 2071 7561 7428 290a 2020   res = quat().  
+00023880: 2020 2020 2020 6966 2066 6162 7328 6229        if fabs(b)
+00023890: 3c3d 6570 733a 0a20 2020 2020 2020 2020  <=eps:.         
+000238a0: 2020 2072 6573 2e78 203d 2030 2e30 0a20     res.x = 0.0. 
+000238b0: 2020 2020 2020 2020 2020 2072 6573 2e79             res.y
+000238c0: 203d 2030 2e30 0a20 2020 2020 2020 2020   = 0.0.         
+000238d0: 2020 2072 6573 2e7a 203d 2030 2e30 0a20     res.z = 0.0. 
+000238e0: 2020 2020 2020 2020 2020 2072 6573 2e77             res.w
+000238f0: 203d 2065 7870 2873 656c 662e 7729 0a20   = exp(self.w). 
+00023900: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00023910: 2020 2020 2020 2020 2066 203d 2073 696e           f = sin
+00023920: 2862 292f 620a 2020 2020 2020 2020 2020  (b)/b.          
+00023930: 2020 7265 732e 7820 3d20 662a 7365 6c66    res.x = f*self
+00023940: 2e78 0a20 2020 2020 2020 2020 2020 2072  .x.            r
+00023950: 6573 2e79 203d 2066 2a73 656c 662e 790a  es.y = f*self.y.
+00023960: 2020 2020 2020 2020 2020 2020 7265 732e              res.
+00023970: 7a20 3d20 662a 7365 6c66 2e7a 0a20 2020  z = f*self.z.   
+00023980: 2020 2020 2020 2020 2072 6573 2e77 203d           res.w =
+00023990: 2065 7870 2873 656c 662e 7729 2a63 6f73   exp(self.w)*cos
+000239a0: 2862 290a 0a20 2020 2020 2020 2072 6574  (b)..        ret
+000239b0: 7572 6e20 7265 730a 0a0a 6465 6620 736c  urn res...def sl
+000239c0: 6572 7028 646f 7562 6c65 2074 2c20 7175  erp(double t, qu
+000239d0: 6174 2071 302c 2071 7561 7420 7131 293a  at q0, quat q1):
+000239e0: 0a20 2020 2022 2222 5370 6865 7269 6361  .    """Spherica
+000239f0: 6c20 6c69 6e65 6172 2069 6e74 6572 706f  l linear interpo
+00023a00: 6c61 7469 6f6e 2062 6574 7765 656e 2074  lation between t
+00023a10: 776f 2071 7561 7465 726e 696f 6e73 2e0a  wo quaternions..
+00023a20: 0a20 2020 2054 6865 2072 6574 7572 6e20  .    The return 
+00023a30: 7661 6c75 6520 6973 2061 6e20 696e 7465  value is an inte
+00023a40: 7270 6f6c 6174 696f 6e20 6265 7477 6565  rpolation betwee
+00023a50: 6e20 7130 2061 6e64 2071 312e 2046 6f72  n q0 and q1. For
+00023a60: 2074 3d30 2e30 0a20 2020 2074 6865 2072   t=0.0.    the r
+00023a70: 6574 7572 6e20 7661 6c75 6520 6571 7561  eturn value equa
+00023a80: 6c73 2071 302c 2066 6f72 2074 3d31 2e30  ls q0, for t=1.0
+00023a90: 2069 7420 6571 7561 6c73 2071 312e 0a20   it equals q1.. 
+00023aa0: 2020 2071 3020 616e 6420 7131 206d 7573     q0 and q1 mus
+00023ab0: 7420 6265 2075 6e69 7420 7175 6174 6572  t be unit quater
+00023ac0: 6e69 6f6e 732e 0a20 2020 2022 2222 0a20  nions..    """. 
+00023ad0: 2020 2063 6465 6620 646f 7562 6c65 206f     cdef double o
+00023ae0: 2c73 6f2c 612c 620a 0a20 2020 206f 203d  ,so,a,b..    o =
+00023af0: 2061 636f 7328 7130 2e64 6f74 2871 3129   acos(q0.dot(q1)
+00023b00: 290a 2020 2020 736f 203d 2073 696e 286f  ).    so = sin(o
+00023b10: 290a 0a20 2020 2069 6620 2866 6162 7328  )..    if (fabs(
+00023b20: 736f 293c 6570 7329 3a0a 2020 2020 2020  so)<eps):.      
+00023b30: 2020 7265 7475 726e 2071 7561 7428 7130    return quat(q0
+00023b40: 290a 0a20 2020 2061 203d 2073 696e 286f  )..    a = sin(o
+00023b50: 2a28 312e 302d 7429 2920 2f20 736f 0a20  *(1.0-t)) / so. 
+00023b60: 2020 2062 203d 2073 696e 286f 2a74 2920     b = sin(o*t) 
+00023b70: 2f20 736f 0a20 2020 2072 6574 7572 6e20  / so.    return 
+00023b80: 7130 2a61 202b 2071 312a 620a 0a64 6566  q0*a + q1*b..def
+00023b90: 2073 7175 6164 2864 6f75 626c 6520 742c   squad(double t,
+00023ba0: 2071 7561 7420 612c 2071 7561 7420 622c   quat a, quat b,
+00023bb0: 2071 7561 7420 632c 2071 7561 7420 6429   quat c, quat d)
+00023bc0: 3a0a 2020 2020 2222 2253 7068 6572 6963  :.    """Spheric
+00023bd0: 616c 2063 7562 6963 2069 6e74 6572 706f  al cubic interpo
+00023be0: 6c61 7469 6f6e 2e22 2222 0a20 2020 2072  lation.""".    r
+00023bf0: 6574 7572 6e20 736c 6572 7028 322a 742a  eturn slerp(2*t*
+00023c00: 2831 2e30 2d74 292c 2073 6c65 7270 2874  (1.0-t), slerp(t
+00023c10: 2c61 2c64 292c 2073 6c65 7270 2874 2c62  ,a,d), slerp(t,b
+00023c20: 2c63 2929 0a0a 2323 2323 2323 2323 2323  ,c))..##########
+00023c30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00023c40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00023c50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00023c60: 2323 2323 2323 2323 2323 2323 0a0a 696d  ############..im
+00023c70: 706f 7274 2073 7973 0a69 6620 7379 732e  port sys.if sys.
+00023c80: 7665 7273 696f 6e5f 696e 666f 5b30 5d20  version_info[0] 
+00023c90: 3e3d 2033 3a0a 2020 2020 696d 706f 7274  >= 3:.    import
+00023ca0: 2063 6f70 7972 6567 2061 7320 636f 7079   copyreg as copy
+00023cb0: 5f72 6567 0a65 6c73 653a 0a20 2020 2069  _reg.else:.    i
+00023cc0: 6d70 6f72 7420 636f 7079 5f72 6567 0a0a  mport copy_reg..
+00023cd0: 6465 6620 5f76 6563 3363 6f6e 7374 7275  def _vec3constru
+00023ce0: 6374 2878 2c79 2c7a 293a 0a20 2020 2072  ct(x,y,z):.    r
+00023cf0: 6574 7572 6e20 7665 6333 2878 2c79 2c7a  eturn vec3(x,y,z
+00023d00: 290a 0a64 6566 205f 7665 6334 636f 6e73  )..def _vec4cons
+00023d10: 7472 7563 7428 782c 792c 7a2c 7729 3a0a  truct(x,y,z,w):.
+00023d20: 2020 2020 7265 7475 726e 2076 6563 3428      return vec4(
+00023d30: 782c 792c 7a2c 7729 0a0a 6465 6620 5f6d  x,y,z,w)..def _m
+00023d40: 6174 3363 6f6e 7374 7275 6374 2862 312c  at3construct(b1,
+00023d50: 6232 2c62 3329 3a0a 2020 2020 7265 7475  b2,b3):.    retu
+00023d60: 726e 206d 6174 3328 6231 2c62 322c 6233  rn mat3(b1,b2,b3
+00023d70: 290a 0a64 6566 205f 6d61 7434 636f 6e73  )..def _mat4cons
+00023d80: 7472 7563 7428 6231 2c62 322c 6233 2c62  truct(b1,b2,b3,b
+00023d90: 3429 3a0a 2020 2020 7265 7475 726e 206d  4):.    return m
+00023da0: 6174 3428 6231 2c62 322c 6233 2c62 3429  at4(b1,b2,b3,b4)
+00023db0: 0a0a 6465 6620 5f71 7561 7463 6f6e 7374  ..def _quatconst
+00023dc0: 7275 6374 2877 2c78 2c79 2c7a 293a 0a20  ruct(w,x,y,z):. 
+00023dd0: 2020 2072 6574 7572 6e20 7175 6174 2877     return quat(w
+00023de0: 2c78 2c79 2c7a 290a 0a63 6f70 795f 7265  ,x,y,z)..copy_re
+00023df0: 672e 636f 6e73 7472 7563 746f 7228 5f76  g.constructor(_v
+00023e00: 6563 3363 6f6e 7374 7275 6374 290a 636f  ec3construct).co
+00023e10: 7079 5f72 6567 2e63 6f6e 7374 7275 6374  py_reg.construct
+00023e20: 6f72 285f 7665 6334 636f 6e73 7472 7563  or(_vec4construc
+00023e30: 7429 0a63 6f70 795f 7265 672e 636f 6e73  t).copy_reg.cons
+00023e40: 7472 7563 746f 7228 5f6d 6174 3363 6f6e  tructor(_mat3con
+00023e50: 7374 7275 6374 290a 636f 7079 5f72 6567  struct).copy_reg
+00023e60: 2e63 6f6e 7374 7275 6374 6f72 285f 6d61  .constructor(_ma
+00023e70: 7434 636f 6e73 7472 7563 7429 0a63 6f70  t4construct).cop
+00023e80: 795f 7265 672e 636f 6e73 7472 7563 746f  y_reg.constructo
+00023e90: 7228 5f71 7561 7463 6f6e 7374 7275 6374  r(_quatconstruct
+00023ea0: 290a 0a                                  )..
```

### Comparing `cgkit1-1.2.8/license.txt` & `cgkit1-1.3.0/license.txt`

 * *Files identical despite different names*

### Comparing `cgkit1-1.2.8/pyproject.toml` & `cgkit1-1.3.0/pyproject.toml`

 * *Files 14% similar despite different names*

```diff
@@ -1,21 +1,19 @@
 [project]
 name = "cgkit1"
-version = "1.2.8"                                                        # also update cgkitinfo.py
+version = "1.3.0"                                                        # also update cgkitinfo.py
 description = "Python Computer Graphics Kit v1"
 readme = "README.md"
 requires-python = ">= 3.7"
 license.file = "license.txt"
 authors = [{ name = "Matthias Bass", email = "baas@ira.uka.de" }]
 maintainers = [{ name = "Andrew Straw", email = "strawman@astraw.com" }]
 
 urls.homepage = "https://github.com/strawlab/cgkit1"
 
 [build-system]
 # following advice in https://stackoverflow.com/a/66479252
 requires = [
     "setuptools>=61",
-    "cython>=0.29,!=0.29.20",
-    "wheel>=0.34.2",
-    "twine>=1.15.0",
+    "cython >= 3.0",
 ]
 build-backend = "setuptools.build_meta"
```

### Comparing `cgkit1-1.2.8/setup.py` & `cgkit1-1.3.0/setup.py`

 * *Files identical despite different names*

