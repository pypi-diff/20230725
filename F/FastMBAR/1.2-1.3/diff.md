# Comparing `tmp/fastmbar-1.2.tar.gz` & `tmp/fastmbar-1.3.tar.gz`

## Comparing `fastmbar-1.2.tar` & `fastmbar-1.3.tar`

### file list

```diff
@@ -1,210 +1,210 @@
--rw-r--r--   0        0        0      580 2020-02-02 00:00:00.000000 fastmbar-1.2/.readthedocs.yaml
--rw-r--r--   0        0        0      171 2020-02-02 00:00:00.000000 fastmbar-1.2/.travis.yml
--rw-r--r--   0        0        0       97 2020-02-02 00:00:00.000000 fastmbar-1.2/build.sh
--rw-r--r--   0        0        0    33346 2020-02-02 00:00:00.000000 fastmbar-1.2/energy_matrix.pdf
--rw-r--r--   0        0        0   459263 2020-02-02 00:00:00.000000 fastmbar-1.2/energy_matrix.png
--rw-r--r--   0        0        0      168 2020-02-02 00:00:00.000000 fastmbar-1.2/.vscode/settings.json
--rw-r--r--   0        0        0      339 2020-02-02 00:00:00.000000 fastmbar-1.2/FastMBAR/__init__.py
--rw-r--r--   0        0        0    29138 2020-02-02 00:00:00.000000 fastmbar-1.2/FastMBAR/fastmbar.py
--rw-r--r--   0        0        0     2465 2020-02-02 00:00:00.000000 fastmbar-1.2/FastMBAR/test_FastMBAR.py
--rw-r--r--   0        0        0     9701 2020-02-02 00:00:00.000000 fastmbar-1.2/FastMBAR/utils/analyzer.py
--rw-r--r--   0        0        0     8086 2020-02-02 00:00:00.000000 fastmbar-1.2/FastMBAR/utils/fastmbartools.py
--rw-r--r--   0        0        0        7 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/.gitignore
--rw-r--r--   0        0        0      585 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/Makefile
--rw-r--r--   0        0        0       91 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/requirements.txt
--rw-r--r--   0        0        0      230 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/.buildinfo
--rw-r--r--   0        0        0    30535 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/API.html
--rw-r--r--   0        0        0    56378 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/butane_PMF.html
--rw-r--r--   0        0        0    67565 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/dialanine_PMF.html
--rw-r--r--   0        0        0    16020 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/examples.html
--rw-r--r--   0        0        0    12093 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/genindex.html
--rw-r--r--   0        0        0    16014 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/index.html
--rw-r--r--   0        0        0    36805 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/installation.html
--rw-r--r--   0        0        0      509 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/objects.inv
--rw-r--r--   0        0        0    12811 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/references.html
--rw-r--r--   0        0        0    10779 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/search.html
--rw-r--r--   0        0        0    15370 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/searchindex.js
--rw-r--r--   0        0        0    26667 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/usage.html
--rw-r--r--   0        0        0    68887 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/.doctrees/API.doctree
--rw-r--r--   0        0        0    41990 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/.doctrees/butane_PMF.doctree
--rw-r--r--   0        0        0    51030 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/.doctrees/dialanine_PMF.doctree
--rw-r--r--   0        0        0    61760 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/.doctrees/environment.pickle
--rw-r--r--   0        0        0    11488 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/.doctrees/examples.doctree
--rw-r--r--   0        0        0     8004 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/.doctrees/index.doctree
--rw-r--r--   0        0        0    33251 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/.doctrees/installation.doctree
--rw-r--r--   0        0        0     8759 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/.doctrees/references.doctree
--rw-r--r--   0        0        0    28287 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/.doctrees/usage.doctree
--rw-r--r--   0        0        0   187708 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_images/Fig_1.png
--rw-r--r--   0        0        0   211402 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_images/Fig_11.png
--rw-r--r--   0        0        0   172324 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_images/Fig_2.png
--rw-r--r--   0        0        0   193626 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_images/Fig_21.png
--rw-r--r--   0        0        0   156671 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_images/PMF.png
--rw-r--r--   0        0        0   116954 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_images/PMF1.png
--rw-r--r--   0        0        0   459263 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_images/energy_matrix.png
--rw-r--r--   0        0        0    10181 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_modules/index.html
--rw-r--r--   0        0        0   125225 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_modules/FastMBAR/fastmbar.html
--rw-r--r--   0        0        0      401 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_sources/API.rst
--rw-r--r--   0        0        0    14932 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_sources/butane_PMF.rst
--rw-r--r--   0        0        0    17540 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_sources/dialanine_PMF.rst
--rw-r--r--   0        0        0     1729 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_sources/examples.rst
--rw-r--r--   0        0        0     2077 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_sources/index.rst
--rw-r--r--   0        0        0     7171 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_sources/installation.rst
--rw-r--r--   0        0        0      943 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_sources/references.rst
--rw-r--r--   0        0        0     6902 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_sources/usage.rst
--rw-r--r--   0        0        0     4418 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/_sphinx_javascript_frameworks_compat.js
--rw-r--r--   0        0        0    15228 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/basic.css
--rw-r--r--   0        0        0      313 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/check-solid.svg
--rw-r--r--   0        0        0     9031 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/clipboard.min.js
--rw-r--r--   0        0        0      411 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/copy-button.svg
--rw-r--r--   0        0        0     2060 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/copybutton.css
--rw-r--r--   0        0        0     8467 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/copybutton.js
--rw-r--r--   0        0        0     2698 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/copybutton_funcs.js
--rw-r--r--   0        0        0     8171 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/doctools.js
--rw-r--r--   0        0        0      417 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/documentation_options.js
--rw-r--r--   0        0        0      286 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/file.png
--rw-r--r--   0        0        0   288580 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/jquery-3.6.0.js
--rw-r--r--   0        0        0    89501 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/jquery.js
--rw-r--r--   0        0        0     4758 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/language_data.js
--rw-r--r--   0        0        0  1201731 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/logo.ai
--rw-r--r--   0        0        0  1249206 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/logo.eps
--rw-r--r--   0        0        0   119173 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/logo.png
--rw-r--r--   0        0        0       90 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/minus.png
--rw-r--r--   0        0        0       90 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/plus.png
--rw-r--r--   0        0        0    12757 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/pygments.css
--rw-r--r--   0        0        0      419 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/sbt-webpack-macros.html
--rw-r--r--   0        0        0    17088 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/searchtools.js
--rw-r--r--   0        0        0    68420 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/underscore-1.13.1.js
--rw-r--r--   0        0        0    19530 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/underscore.js
--rw-r--r--   0        0        0     1863 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/webpack-macros.html
--rw-r--r--   0        0        0     1186 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/images/logo_binder.svg
--rw-r--r--   0        0        0     7601 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/images/logo_colab.png
--rw-r--r--   0        0        0      681 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/images/logo_deepnote.svg
--rw-r--r--   0        0        0     1758 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/images/logo_jupyterhub.svg
--rw-r--r--   0        0        0     1541 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/ar/LC_MESSAGES/booktheme.mo
--rw-r--r--   0        0        0     1459 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/ar/LC_MESSAGES/booktheme.po
--rw-r--r--   0        0        0     1708 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/bg/LC_MESSAGES/booktheme.mo
--rw-r--r--   0        0        0     1626 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/bg/LC_MESSAGES/booktheme.po
--rw-r--r--   0        0        0     1646 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/bn/LC_MESSAGES/booktheme.mo
--rw-r--r--   0        0        0     1564 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/bn/LC_MESSAGES/booktheme.po
--rw-r--r--   0        0        0     1246 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/ca/LC_MESSAGES/booktheme.mo
--rw-r--r--   0        0        0     1166 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/ca/LC_MESSAGES/booktheme.po
--rw-r--r--   0        0        0     1405 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/cs/LC_MESSAGES/booktheme.mo
--rw-r--r--   0        0        0     1323 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/cs/LC_MESSAGES/booktheme.po
--rw-r--r--   0        0        0     1304 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/da/LC_MESSAGES/booktheme.mo
--rw-r--r--   0        0        0     1222 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/da/LC_MESSAGES/booktheme.po
--rw-r--r--   0        0        0     1388 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/de/LC_MESSAGES/booktheme.mo
--rw-r--r--   0        0        0     1306 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/de/LC_MESSAGES/booktheme.po
--rw-r--r--   0        0        0     1722 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/el/LC_MESSAGES/booktheme.mo
--rw-r--r--   0        0        0     1640 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/el/LC_MESSAGES/booktheme.po
--rw-r--r--   0        0        0     1337 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/eo/LC_MESSAGES/booktheme.mo
--rw-r--r--   0        0        0     1255 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/eo/LC_MESSAGES/booktheme.po
--rw-r--r--   0        0        0     1396 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/es/LC_MESSAGES/booktheme.mo
--rw-r--r--   0        0        0     1314 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/es/LC_MESSAGES/booktheme.po
--rw-r--r--   0        0        0     1341 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/et/LC_MESSAGES/booktheme.mo
--rw-r--r--   0        0        0     1259 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/et/LC_MESSAGES/booktheme.po
--rw-r--r--   0        0        0     1368 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/fi/LC_MESSAGES/booktheme.mo
--rw-r--r--   0        0        0     1286 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/fi/LC_MESSAGES/booktheme.po
--rw-r--r--   0        0        0     1412 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/fr/LC_MESSAGES/booktheme.mo
--rw-r--r--   0        0        0     1330 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/fr/LC_MESSAGES/booktheme.po
--rw-r--r--   0        0        0     1402 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/hr/LC_MESSAGES/booktheme.mo
--rw-r--r--   0        0        0     1320 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/hr/LC_MESSAGES/booktheme.po
--rw-r--r--   0        0        0     1323 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/id/LC_MESSAGES/booktheme.mo
--rw-r--r--   0        0        0     1241 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/id/LC_MESSAGES/booktheme.po
--rw-r--r--   0        0        0     1403 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/it/LC_MESSAGES/booktheme.mo
--rw-r--r--   0        0        0     1321 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/it/LC_MESSAGES/booktheme.po
--rw-r--r--   0        0        0     1445 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/iw/LC_MESSAGES/booktheme.mo
--rw-r--r--   0        0        0     1363 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/iw/LC_MESSAGES/booktheme.po
--rw-r--r--   0        0        0     1471 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/ja/LC_MESSAGES/booktheme.mo
--rw-r--r--   0        0        0     1389 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/ja/LC_MESSAGES/booktheme.po
--rw-r--r--   0        0        0     1375 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/ko/LC_MESSAGES/booktheme.mo
--rw-r--r--   0        0        0     1293 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/ko/LC_MESSAGES/booktheme.po
--rw-r--r--   0        0        0     1413 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/lt/LC_MESSAGES/booktheme.mo
--rw-r--r--   0        0        0     1331 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/lt/LC_MESSAGES/booktheme.po
--rw-r--r--   0        0        0     1404 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/lv/LC_MESSAGES/booktheme.mo
--rw-r--r--   0        0        0     1322 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/lv/LC_MESSAGES/booktheme.po
--rw-r--r--   0        0        0     1883 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/ml/LC_MESSAGES/booktheme.mo
--rw-r--r--   0        0        0     1803 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/ml/LC_MESSAGES/booktheme.po
--rw-r--r--   0        0        0     1674 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/mr/LC_MESSAGES/booktheme.mo
--rw-r--r--   0        0        0     1594 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/mr/LC_MESSAGES/booktheme.po
--rw-r--r--   0        0        0     1213 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/ms/LC_MESSAGES/booktheme.mo
--rw-r--r--   0        0        0     1133 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/ms/LC_MESSAGES/booktheme.po
--rw-r--r--   0        0        0     1356 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/nl/LC_MESSAGES/booktheme.mo
--rw-r--r--   0        0        0     1274 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/nl/LC_MESSAGES/booktheme.po
--rw-r--r--   0        0        0     1317 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/no/LC_MESSAGES/booktheme.mo
--rw-r--r--   0        0        0     1235 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/no/LC_MESSAGES/booktheme.po
--rw-r--r--   0        0        0     1371 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/pl/LC_MESSAGES/booktheme.mo
--rw-r--r--   0        0        0     1289 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/pl/LC_MESSAGES/booktheme.po
--rw-r--r--   0        0        0     1364 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/pt/LC_MESSAGES/booktheme.mo
--rw-r--r--   0        0        0     1282 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/pt/LC_MESSAGES/booktheme.po
--rw-r--r--   0        0        0     1390 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/ro/LC_MESSAGES/booktheme.mo
--rw-r--r--   0        0        0     1308 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/ro/LC_MESSAGES/booktheme.po
--rw-r--r--   0        0        0     1722 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/ru/LC_MESSAGES/booktheme.mo
--rw-r--r--   0        0        0     1640 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/ru/LC_MESSAGES/booktheme.po
--rw-r--r--   0        0        0     1393 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/sk/LC_MESSAGES/booktheme.mo
--rw-r--r--   0        0        0     1311 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/sk/LC_MESSAGES/booktheme.po
--rw-r--r--   0        0        0     1374 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/sl/LC_MESSAGES/booktheme.mo
--rw-r--r--   0        0        0     1292 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/sl/LC_MESSAGES/booktheme.po
--rw-r--r--   0        0        0     1679 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/sr/LC_MESSAGES/booktheme.mo
--rw-r--r--   0        0        0     1597 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/sr/LC_MESSAGES/booktheme.po
--rw-r--r--   0        0        0     1349 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/sv/LC_MESSAGES/booktheme.mo
--rw-r--r--   0        0        0     1267 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/sv/LC_MESSAGES/booktheme.po
--rw-r--r--   0        0        0     1928 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/ta/LC_MESSAGES/booktheme.mo
--rw-r--r--   0        0        0     1848 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/ta/LC_MESSAGES/booktheme.po
--rw-r--r--   0        0        0     1806 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/te/LC_MESSAGES/booktheme.mo
--rw-r--r--   0        0        0     1726 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/te/LC_MESSAGES/booktheme.po
--rw-r--r--   0        0        0     1628 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/tg/LC_MESSAGES/booktheme.mo
--rw-r--r--   0        0        0     1546 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/tg/LC_MESSAGES/booktheme.po
--rw-r--r--   0        0        0     1766 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/th/LC_MESSAGES/booktheme.mo
--rw-r--r--   0        0        0     1684 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/th/LC_MESSAGES/booktheme.po
--rw-r--r--   0        0        0     1273 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/tl/LC_MESSAGES/booktheme.mo
--rw-r--r--   0        0        0     1193 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/tl/LC_MESSAGES/booktheme.po
--rw-r--r--   0        0        0     1373 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/tr/LC_MESSAGES/booktheme.mo
--rw-r--r--   0        0        0     1291 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/tr/LC_MESSAGES/booktheme.po
--rw-r--r--   0        0        0     1681 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/uk/LC_MESSAGES/booktheme.mo
--rw-r--r--   0        0        0     1601 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/uk/LC_MESSAGES/booktheme.po
--rw-r--r--   0        0        0     1462 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/ur/LC_MESSAGES/booktheme.mo
--rw-r--r--   0        0        0     1382 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/ur/LC_MESSAGES/booktheme.po
--rw-r--r--   0        0        0     1431 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/vi/LC_MESSAGES/booktheme.mo
--rw-r--r--   0        0        0     1349 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/vi/LC_MESSAGES/booktheme.po
--rw-r--r--   0        0        0     1310 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/zh_CN/LC_MESSAGES/booktheme.mo
--rw-r--r--   0        0        0     1228 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/zh_CN/LC_MESSAGES/booktheme.po
--rw-r--r--   0        0        0     1341 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/zh_TW/LC_MESSAGES/booktheme.mo
--rw-r--r--   0        0        0     1259 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/locales/zh_TW/LC_MESSAGES/booktheme.po
--rw-r--r--   0        0        0    80813 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/scripts/bootstrap.js
--rw-r--r--   0        0        0      237 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/scripts/bootstrap.js.LICENSE.txt
--rw-r--r--   0        0        0   335757 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/scripts/bootstrap.js.map
--rw-r--r--   0        0        0     4456 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/scripts/pydata-sphinx-theme.js
--rw-r--r--   0        0        0    19648 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/scripts/pydata-sphinx-theme.js.map
--rw-r--r--   0        0        0     3075 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/scripts/sphinx-book-theme.js
--rw-r--r--   0        0        0    13066 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/scripts/sphinx-book-theme.js.map
--rw-r--r--   0        0        0   176654 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/styles/bootstrap.css
--rw-r--r--   0        0        0    63341 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/styles/pydata-sphinx-theme.css
--rw-r--r--   0        0        0    13841 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/styles/sphinx-book-theme.css
--rw-r--r--   0        0        0      106 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/styles/theme.css
--rw-r--r--   0        0        0     7427 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/vendor/fontawesome/6.1.2/LICENSE.txt
--rw-r--r--   0        0        0   101691 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/vendor/fontawesome/6.1.2/css/all.min.css
--rw-r--r--   0        0        0   181264 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.ttf
--rw-r--r--   0        0        0   105112 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2
--rw-r--r--   0        0        0    60236 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.ttf
--rw-r--r--   0        0        0    24028 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2
--rw-r--r--   0        0        0   389948 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.ttf
--rw-r--r--   0        0        0   154840 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2
--rw-r--r--   0        0        0    10084 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/vendor/fontawesome/6.1.2/webfonts/fa-v4compatibility.ttf
--rw-r--r--   0        0        0     4776 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/build/_static/vendor/fontawesome/6.1.2/webfonts/fa-v4compatibility.woff2
--rw-r--r--   0        0        0      401 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/source/API.rst
--rw-r--r--   0        0        0    14932 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/source/butane_PMF.rst
--rw-r--r--   0        0        0     5311 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/source/conf.py
--rw-r--r--   0        0        0    17540 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/source/dialanine_PMF.rst
--rw-r--r--   0        0        0     1729 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/source/examples.rst
--rw-r--r--   0        0        0     2077 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/source/index.rst
--rw-r--r--   0        0        0     7171 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/source/installation.rst
--rw-r--r--   0        0        0      943 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/source/references.rst
--rw-r--r--   0        0        0     6902 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/source/usage.rst
--rw-r--r--   0        0        0  1201731 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/source/_static/logo.ai
--rw-r--r--   0        0        0  1249206 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/source/_static/logo.eps
--rw-r--r--   0        0        0   119173 2020-02-02 00:00:00.000000 fastmbar-1.2/docs/source/_static/logo.png
--rw-r--r--   0        0        0       68 2020-02-02 00:00:00.000000 fastmbar-1.2/.gitignore
--rw-r--r--   0        0        0     1092 2020-02-02 00:00:00.000000 fastmbar-1.2/LICENSE
--rw-r--r--   0        0        0      815 2020-02-02 00:00:00.000000 fastmbar-1.2/README.rst
--rw-r--r--   0        0        0      778 2020-02-02 00:00:00.000000 fastmbar-1.2/pyproject.toml
--rw-r--r--   0        0        0     2725 2020-02-02 00:00:00.000000 fastmbar-1.2/PKG-INFO
+-rw-r--r--   0        0        0      580 2020-02-02 00:00:00.000000 fastmbar-1.3/.readthedocs.yaml
+-rw-r--r--   0        0        0      171 2020-02-02 00:00:00.000000 fastmbar-1.3/.travis.yml
+-rw-r--r--   0        0        0       97 2020-02-02 00:00:00.000000 fastmbar-1.3/build.sh
+-rw-r--r--   0        0        0    33346 2020-02-02 00:00:00.000000 fastmbar-1.3/energy_matrix.pdf
+-rw-r--r--   0        0        0   459263 2020-02-02 00:00:00.000000 fastmbar-1.3/energy_matrix.png
+-rw-r--r--   0        0        0      168 2020-02-02 00:00:00.000000 fastmbar-1.3/.vscode/settings.json
+-rw-r--r--   0        0        0      339 2020-02-02 00:00:00.000000 fastmbar-1.3/FastMBAR/__init__.py
+-rw-r--r--   0        0        0    29168 2020-02-02 00:00:00.000000 fastmbar-1.3/FastMBAR/fastmbar.py
+-rw-r--r--   0        0        0     2465 2020-02-02 00:00:00.000000 fastmbar-1.3/FastMBAR/test_FastMBAR.py
+-rw-r--r--   0        0        0     9701 2020-02-02 00:00:00.000000 fastmbar-1.3/FastMBAR/utils/analyzer.py
+-rw-r--r--   0        0        0     8086 2020-02-02 00:00:00.000000 fastmbar-1.3/FastMBAR/utils/fastmbartools.py
+-rw-r--r--   0        0        0        7 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/.gitignore
+-rw-r--r--   0        0        0      585 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/Makefile
+-rw-r--r--   0        0        0       91 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/requirements.txt
+-rw-r--r--   0        0        0      230 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/.buildinfo
+-rw-r--r--   0        0        0    30535 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/API.html
+-rw-r--r--   0        0        0    56378 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/butane_PMF.html
+-rw-r--r--   0        0        0    67565 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/dialanine_PMF.html
+-rw-r--r--   0        0        0    16020 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/examples.html
+-rw-r--r--   0        0        0    12093 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/genindex.html
+-rw-r--r--   0        0        0    16014 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/index.html
+-rw-r--r--   0        0        0    36805 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/installation.html
+-rw-r--r--   0        0        0      509 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/objects.inv
+-rw-r--r--   0        0        0    13009 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/references.html
+-rw-r--r--   0        0        0    10779 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/search.html
+-rw-r--r--   0        0        0    15543 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/searchindex.js
+-rw-r--r--   0        0        0    26667 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/usage.html
+-rw-r--r--   0        0        0    68887 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/.doctrees/API.doctree
+-rw-r--r--   0        0        0    41990 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/.doctrees/butane_PMF.doctree
+-rw-r--r--   0        0        0    51030 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/.doctrees/dialanine_PMF.doctree
+-rw-r--r--   0        0        0    61703 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/.doctrees/environment.pickle
+-rw-r--r--   0        0        0    11488 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/.doctrees/examples.doctree
+-rw-r--r--   0        0        0     8004 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/.doctrees/index.doctree
+-rw-r--r--   0        0        0    33251 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/.doctrees/installation.doctree
+-rw-r--r--   0        0        0     8750 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/.doctrees/references.doctree
+-rw-r--r--   0        0        0    28287 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/.doctrees/usage.doctree
+-rw-r--r--   0        0        0   187708 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_images/Fig_1.png
+-rw-r--r--   0        0        0   211402 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_images/Fig_11.png
+-rw-r--r--   0        0        0   172324 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_images/Fig_2.png
+-rw-r--r--   0        0        0   193626 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_images/Fig_21.png
+-rw-r--r--   0        0        0   156671 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_images/PMF.png
+-rw-r--r--   0        0        0   116954 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_images/PMF1.png
+-rw-r--r--   0        0        0   459263 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_images/energy_matrix.png
+-rw-r--r--   0        0        0    10181 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_modules/index.html
+-rw-r--r--   0        0        0   125331 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_modules/FastMBAR/fastmbar.html
+-rw-r--r--   0        0        0      401 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_sources/API.rst
+-rw-r--r--   0        0        0    14932 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_sources/butane_PMF.rst
+-rw-r--r--   0        0        0    17540 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_sources/dialanine_PMF.rst
+-rw-r--r--   0        0        0     1729 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_sources/examples.rst
+-rw-r--r--   0        0        0     2077 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_sources/index.rst
+-rw-r--r--   0        0        0     7171 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_sources/installation.rst
+-rw-r--r--   0        0        0     1149 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_sources/references.rst
+-rw-r--r--   0        0        0     6902 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_sources/usage.rst
+-rw-r--r--   0        0        0     4418 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/_sphinx_javascript_frameworks_compat.js
+-rw-r--r--   0        0        0    15228 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/basic.css
+-rw-r--r--   0        0        0      313 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/check-solid.svg
+-rw-r--r--   0        0        0     9031 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/clipboard.min.js
+-rw-r--r--   0        0        0      411 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/copy-button.svg
+-rw-r--r--   0        0        0     2060 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/copybutton.css
+-rw-r--r--   0        0        0     8467 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/copybutton.js
+-rw-r--r--   0        0        0     2698 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/copybutton_funcs.js
+-rw-r--r--   0        0        0     8171 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/doctools.js
+-rw-r--r--   0        0        0      417 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/documentation_options.js
+-rw-r--r--   0        0        0      286 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/file.png
+-rw-r--r--   0        0        0   288580 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/jquery-3.6.0.js
+-rw-r--r--   0        0        0    89501 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/jquery.js
+-rw-r--r--   0        0        0     4758 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/language_data.js
+-rw-r--r--   0        0        0  1201731 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/logo.ai
+-rw-r--r--   0        0        0  1249206 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/logo.eps
+-rw-r--r--   0        0        0   119173 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/logo.png
+-rw-r--r--   0        0        0       90 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/minus.png
+-rw-r--r--   0        0        0       90 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/plus.png
+-rw-r--r--   0        0        0    12757 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/pygments.css
+-rw-r--r--   0        0        0      419 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/sbt-webpack-macros.html
+-rw-r--r--   0        0        0    17088 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/searchtools.js
+-rw-r--r--   0        0        0    68420 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/underscore-1.13.1.js
+-rw-r--r--   0        0        0    19530 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/underscore.js
+-rw-r--r--   0        0        0     1863 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/webpack-macros.html
+-rw-r--r--   0        0        0     1186 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/images/logo_binder.svg
+-rw-r--r--   0        0        0     7601 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/images/logo_colab.png
+-rw-r--r--   0        0        0      681 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/images/logo_deepnote.svg
+-rw-r--r--   0        0        0     1758 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/images/logo_jupyterhub.svg
+-rw-r--r--   0        0        0     1541 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/ar/LC_MESSAGES/booktheme.mo
+-rw-r--r--   0        0        0     1459 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/ar/LC_MESSAGES/booktheme.po
+-rw-r--r--   0        0        0     1708 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/bg/LC_MESSAGES/booktheme.mo
+-rw-r--r--   0        0        0     1626 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/bg/LC_MESSAGES/booktheme.po
+-rw-r--r--   0        0        0     1646 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/bn/LC_MESSAGES/booktheme.mo
+-rw-r--r--   0        0        0     1564 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/bn/LC_MESSAGES/booktheme.po
+-rw-r--r--   0        0        0     1246 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/ca/LC_MESSAGES/booktheme.mo
+-rw-r--r--   0        0        0     1166 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/ca/LC_MESSAGES/booktheme.po
+-rw-r--r--   0        0        0     1405 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/cs/LC_MESSAGES/booktheme.mo
+-rw-r--r--   0        0        0     1323 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/cs/LC_MESSAGES/booktheme.po
+-rw-r--r--   0        0        0     1304 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/da/LC_MESSAGES/booktheme.mo
+-rw-r--r--   0        0        0     1222 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/da/LC_MESSAGES/booktheme.po
+-rw-r--r--   0        0        0     1388 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/de/LC_MESSAGES/booktheme.mo
+-rw-r--r--   0        0        0     1306 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/de/LC_MESSAGES/booktheme.po
+-rw-r--r--   0        0        0     1722 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/el/LC_MESSAGES/booktheme.mo
+-rw-r--r--   0        0        0     1640 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/el/LC_MESSAGES/booktheme.po
+-rw-r--r--   0        0        0     1337 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/eo/LC_MESSAGES/booktheme.mo
+-rw-r--r--   0        0        0     1255 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/eo/LC_MESSAGES/booktheme.po
+-rw-r--r--   0        0        0     1396 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/es/LC_MESSAGES/booktheme.mo
+-rw-r--r--   0        0        0     1314 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/es/LC_MESSAGES/booktheme.po
+-rw-r--r--   0        0        0     1341 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/et/LC_MESSAGES/booktheme.mo
+-rw-r--r--   0        0        0     1259 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/et/LC_MESSAGES/booktheme.po
+-rw-r--r--   0        0        0     1368 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/fi/LC_MESSAGES/booktheme.mo
+-rw-r--r--   0        0        0     1286 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/fi/LC_MESSAGES/booktheme.po
+-rw-r--r--   0        0        0     1412 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/fr/LC_MESSAGES/booktheme.mo
+-rw-r--r--   0        0        0     1330 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/fr/LC_MESSAGES/booktheme.po
+-rw-r--r--   0        0        0     1402 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/hr/LC_MESSAGES/booktheme.mo
+-rw-r--r--   0        0        0     1320 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/hr/LC_MESSAGES/booktheme.po
+-rw-r--r--   0        0        0     1323 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/id/LC_MESSAGES/booktheme.mo
+-rw-r--r--   0        0        0     1241 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/id/LC_MESSAGES/booktheme.po
+-rw-r--r--   0        0        0     1403 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/it/LC_MESSAGES/booktheme.mo
+-rw-r--r--   0        0        0     1321 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/it/LC_MESSAGES/booktheme.po
+-rw-r--r--   0        0        0     1445 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/iw/LC_MESSAGES/booktheme.mo
+-rw-r--r--   0        0        0     1363 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/iw/LC_MESSAGES/booktheme.po
+-rw-r--r--   0        0        0     1471 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/ja/LC_MESSAGES/booktheme.mo
+-rw-r--r--   0        0        0     1389 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/ja/LC_MESSAGES/booktheme.po
+-rw-r--r--   0        0        0     1375 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/ko/LC_MESSAGES/booktheme.mo
+-rw-r--r--   0        0        0     1293 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/ko/LC_MESSAGES/booktheme.po
+-rw-r--r--   0        0        0     1413 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/lt/LC_MESSAGES/booktheme.mo
+-rw-r--r--   0        0        0     1331 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/lt/LC_MESSAGES/booktheme.po
+-rw-r--r--   0        0        0     1404 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/lv/LC_MESSAGES/booktheme.mo
+-rw-r--r--   0        0        0     1322 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/lv/LC_MESSAGES/booktheme.po
+-rw-r--r--   0        0        0     1883 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/ml/LC_MESSAGES/booktheme.mo
+-rw-r--r--   0        0        0     1803 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/ml/LC_MESSAGES/booktheme.po
+-rw-r--r--   0        0        0     1674 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/mr/LC_MESSAGES/booktheme.mo
+-rw-r--r--   0        0        0     1594 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/mr/LC_MESSAGES/booktheme.po
+-rw-r--r--   0        0        0     1213 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/ms/LC_MESSAGES/booktheme.mo
+-rw-r--r--   0        0        0     1133 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/ms/LC_MESSAGES/booktheme.po
+-rw-r--r--   0        0        0     1356 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/nl/LC_MESSAGES/booktheme.mo
+-rw-r--r--   0        0        0     1274 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/nl/LC_MESSAGES/booktheme.po
+-rw-r--r--   0        0        0     1317 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/no/LC_MESSAGES/booktheme.mo
+-rw-r--r--   0        0        0     1235 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/no/LC_MESSAGES/booktheme.po
+-rw-r--r--   0        0        0     1371 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/pl/LC_MESSAGES/booktheme.mo
+-rw-r--r--   0        0        0     1289 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/pl/LC_MESSAGES/booktheme.po
+-rw-r--r--   0        0        0     1364 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/pt/LC_MESSAGES/booktheme.mo
+-rw-r--r--   0        0        0     1282 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/pt/LC_MESSAGES/booktheme.po
+-rw-r--r--   0        0        0     1390 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/ro/LC_MESSAGES/booktheme.mo
+-rw-r--r--   0        0        0     1308 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/ro/LC_MESSAGES/booktheme.po
+-rw-r--r--   0        0        0     1722 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/ru/LC_MESSAGES/booktheme.mo
+-rw-r--r--   0        0        0     1640 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/ru/LC_MESSAGES/booktheme.po
+-rw-r--r--   0        0        0     1393 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/sk/LC_MESSAGES/booktheme.mo
+-rw-r--r--   0        0        0     1311 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/sk/LC_MESSAGES/booktheme.po
+-rw-r--r--   0        0        0     1374 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/sl/LC_MESSAGES/booktheme.mo
+-rw-r--r--   0        0        0     1292 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/sl/LC_MESSAGES/booktheme.po
+-rw-r--r--   0        0        0     1679 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/sr/LC_MESSAGES/booktheme.mo
+-rw-r--r--   0        0        0     1597 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/sr/LC_MESSAGES/booktheme.po
+-rw-r--r--   0        0        0     1349 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/sv/LC_MESSAGES/booktheme.mo
+-rw-r--r--   0        0        0     1267 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/sv/LC_MESSAGES/booktheme.po
+-rw-r--r--   0        0        0     1928 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/ta/LC_MESSAGES/booktheme.mo
+-rw-r--r--   0        0        0     1848 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/ta/LC_MESSAGES/booktheme.po
+-rw-r--r--   0        0        0     1806 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/te/LC_MESSAGES/booktheme.mo
+-rw-r--r--   0        0        0     1726 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/te/LC_MESSAGES/booktheme.po
+-rw-r--r--   0        0        0     1628 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/tg/LC_MESSAGES/booktheme.mo
+-rw-r--r--   0        0        0     1546 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/tg/LC_MESSAGES/booktheme.po
+-rw-r--r--   0        0        0     1766 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/th/LC_MESSAGES/booktheme.mo
+-rw-r--r--   0        0        0     1684 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/th/LC_MESSAGES/booktheme.po
+-rw-r--r--   0        0        0     1273 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/tl/LC_MESSAGES/booktheme.mo
+-rw-r--r--   0        0        0     1193 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/tl/LC_MESSAGES/booktheme.po
+-rw-r--r--   0        0        0     1373 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/tr/LC_MESSAGES/booktheme.mo
+-rw-r--r--   0        0        0     1291 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/tr/LC_MESSAGES/booktheme.po
+-rw-r--r--   0        0        0     1681 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/uk/LC_MESSAGES/booktheme.mo
+-rw-r--r--   0        0        0     1601 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/uk/LC_MESSAGES/booktheme.po
+-rw-r--r--   0        0        0     1462 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/ur/LC_MESSAGES/booktheme.mo
+-rw-r--r--   0        0        0     1382 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/ur/LC_MESSAGES/booktheme.po
+-rw-r--r--   0        0        0     1431 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/vi/LC_MESSAGES/booktheme.mo
+-rw-r--r--   0        0        0     1349 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/vi/LC_MESSAGES/booktheme.po
+-rw-r--r--   0        0        0     1310 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/zh_CN/LC_MESSAGES/booktheme.mo
+-rw-r--r--   0        0        0     1228 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/zh_CN/LC_MESSAGES/booktheme.po
+-rw-r--r--   0        0        0     1341 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/zh_TW/LC_MESSAGES/booktheme.mo
+-rw-r--r--   0        0        0     1259 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/locales/zh_TW/LC_MESSAGES/booktheme.po
+-rw-r--r--   0        0        0    80813 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/scripts/bootstrap.js
+-rw-r--r--   0        0        0      237 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/scripts/bootstrap.js.LICENSE.txt
+-rw-r--r--   0        0        0   335757 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/scripts/bootstrap.js.map
+-rw-r--r--   0        0        0     4456 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/scripts/pydata-sphinx-theme.js
+-rw-r--r--   0        0        0    19648 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/scripts/pydata-sphinx-theme.js.map
+-rw-r--r--   0        0        0     3075 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/scripts/sphinx-book-theme.js
+-rw-r--r--   0        0        0    13066 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/scripts/sphinx-book-theme.js.map
+-rw-r--r--   0        0        0   176654 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/styles/bootstrap.css
+-rw-r--r--   0        0        0    63341 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/styles/pydata-sphinx-theme.css
+-rw-r--r--   0        0        0    13841 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/styles/sphinx-book-theme.css
+-rw-r--r--   0        0        0      106 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/styles/theme.css
+-rw-r--r--   0        0        0     7427 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/vendor/fontawesome/6.1.2/LICENSE.txt
+-rw-r--r--   0        0        0   101691 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/vendor/fontawesome/6.1.2/css/all.min.css
+-rw-r--r--   0        0        0   181264 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.ttf
+-rw-r--r--   0        0        0   105112 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2
+-rw-r--r--   0        0        0    60236 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.ttf
+-rw-r--r--   0        0        0    24028 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2
+-rw-r--r--   0        0        0   389948 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.ttf
+-rw-r--r--   0        0        0   154840 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2
+-rw-r--r--   0        0        0    10084 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/vendor/fontawesome/6.1.2/webfonts/fa-v4compatibility.ttf
+-rw-r--r--   0        0        0     4776 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/build/_static/vendor/fontawesome/6.1.2/webfonts/fa-v4compatibility.woff2
+-rw-r--r--   0        0        0      401 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/source/API.rst
+-rw-r--r--   0        0        0    14932 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/source/butane_PMF.rst
+-rw-r--r--   0        0        0     5311 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/source/conf.py
+-rw-r--r--   0        0        0    17540 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/source/dialanine_PMF.rst
+-rw-r--r--   0        0        0     1729 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/source/examples.rst
+-rw-r--r--   0        0        0     2077 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/source/index.rst
+-rw-r--r--   0        0        0     7171 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/source/installation.rst
+-rw-r--r--   0        0        0     1148 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/source/references.rst
+-rw-r--r--   0        0        0     6902 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/source/usage.rst
+-rw-r--r--   0        0        0  1201731 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/source/_static/logo.ai
+-rw-r--r--   0        0        0  1249206 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/source/_static/logo.eps
+-rw-r--r--   0        0        0   119173 2020-02-02 00:00:00.000000 fastmbar-1.3/docs/source/_static/logo.png
+-rw-r--r--   0        0        0       68 2020-02-02 00:00:00.000000 fastmbar-1.3/.gitignore
+-rw-r--r--   0        0        0     1092 2020-02-02 00:00:00.000000 fastmbar-1.3/LICENSE
+-rw-r--r--   0        0        0      815 2020-02-02 00:00:00.000000 fastmbar-1.3/README.rst
+-rw-r--r--   0        0        0      778 2020-02-02 00:00:00.000000 fastmbar-1.3/pyproject.toml
+-rw-r--r--   0        0        0     2725 2020-02-02 00:00:00.000000 fastmbar-1.3/PKG-INFO
```

### Comparing `fastmbar-1.2/.readthedocs.yaml` & `fastmbar-1.3/.readthedocs.yaml`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/energy_matrix.pdf` & `fastmbar-1.3/energy_matrix.pdf`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/energy_matrix.png` & `fastmbar-1.3/energy_matrix.png`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/FastMBAR/fastmbar.py` & `fastmbar-1.3/FastMBAR/fastmbar.py`

 * *Files 1% similar despite different names*

```diff
@@ -289,15 +289,15 @@
             self._F_bootstrap = F - torch.sum(pi[:, None] * F, dim=0)
 
             self._F = torch.mean(self._F_bootstrap, dim=1)
             self._F_std = torch.std(self._F_bootstrap, dim=1)
             self._F_cov = torch.cov(self._F_bootstrap)
 
             self._log_prob_mix = torch.stack(log_prob_mix, dim=0)
-            DeltaF = dF[None, :, :] - dF[:, None, :]
+            DeltaF = self._F_bootstrap[None, :, :] - self._F_bootstrap[:, None, :]
             self._DeltaF = torch.mean(DeltaF, dim=2)
             self._DeltaF_std = torch.std(DeltaF, dim=2)
 
     @property
     def F(self) -> np.ndarray:
         """Free energies of the states under the constraint :math:`\sum_{k=1}^{M} N_k * F_k = 0`,
         where :math:`N_k` is the number of conformations sampled from state k.
```

### Comparing `fastmbar-1.2/FastMBAR/test_FastMBAR.py` & `fastmbar-1.3/FastMBAR/test_FastMBAR.py`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/FastMBAR/utils/analyzer.py` & `fastmbar-1.3/FastMBAR/utils/analyzer.py`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/FastMBAR/utils/fastmbartools.py` & `fastmbar-1.3/FastMBAR/utils/fastmbartools.py`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/Makefile` & `fastmbar-1.3/docs/Makefile`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/API.html` & `fastmbar-1.3/docs/build/API.html`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/butane_PMF.html` & `fastmbar-1.3/docs/build/butane_PMF.html`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/dialanine_PMF.html` & `fastmbar-1.3/docs/build/dialanine_PMF.html`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/examples.html` & `fastmbar-1.3/docs/build/examples.html`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/genindex.html` & `fastmbar-1.3/docs/build/genindex.html`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/index.html` & `fastmbar-1.3/docs/build/index.html`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/installation.html` & `fastmbar-1.3/docs/build/installation.html`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/references.html` & `fastmbar-1.3/docs/build/references.html`

 * *Files 3% similar despite different names*

```diff
@@ -303,20 +303,24 @@
                 
 <div id="searchbox"></div>
                 <article class="bd-article" role="main">
                   
   <section id="references">
 <h1>References<a class="headerlink" href="#references" title="Permalink to this heading">#</a></h1>
 <p>Please consider citing the following references if FastMBAR is used in your projects.</p>
-<ol class="arabic simple">
-<li><p>Xinqiang Ding, Jonah Z. Vilseck, Charles L. Brooks III. (2019). <a class="reference external" href="https://doi.org/10.1021/acs.jctc.8b01010">Fast Solver for Large Scale Multistate Bennett Acceptance Ratio Equations.</a>  <em>J. Chem. Theory Comput.</em></p></li>
-<li><p>Xinqiang Ding, Jonah Z. Vilseck, Ryan L. Hayes, Charles L. Brooks III. (2017). <a class="reference external" href="https://doi.org/10.1021/acs.jctc.7b00204">Gibbs Sampler-based λ-dynamics and Rao–Blackwell Estimator for Alchemical Free Energy Calculation.</a>  <em>J. Chem. Theory Comput.</em></p></li>
-<li><p>Shirts, Michael R., and John D. Chodera. (2008) <a class="reference external" href="https://doi.org/10.1063/1.2978177">Statistically Optimal Analysis of Samples from Multiple Equilibrium States.</a> <em>J. Chem. Phys.</em></p></li>
-<li><p>Bennett, Charles H. (1976) <a class="reference external" href="https://doi.org/10.1016/0021-9991(76)90078-4">Efficient Estimation of Free Energy Differences from Monte Carlo Data.</a> J. Comput. Phys.</p></li>
-</ol>
+<p>1. Xinqiang Ding, Jonah Z. Vilseck, Charles L. Brooks III. (2019).
+<a class="reference external" href="https://doi.org/10.1021/acs.jctc.8b01010">Fast Solver for Large Scale Multistate Bennett Acceptance Ratio Equations.</a>  <em>J. Chem. Theory Comput.</em></p>
+<p>2. Xinqiang Ding, Jonah Z. Vilseck, Ryan L. Hayes, Charles L. Brooks III. (2017).
+<a class="reference external" href="https://doi.org/10.1021/acs.jctc.7b00204">Gibbs Sampler-based λ-dynamics and Rao–Blackwell Estimator for Alchemical Free Energy Calculation.</a>  <em>J. Chem. Theory Comput.</em></p>
+<p>3. Shirts, Michael R., and John D. Chodera. (2008)
+<a class="reference external" href="https://doi.org/10.1063/1.2978177">Statistically Optimal Analysis of Samples from Multiple Equilibrium States.</a> <em>J. Chem. Phys.</em></p>
+<p>4. Kong A, McCullagh P, Meng XL, Nicolae D, Tan Z. (2003)
+<a class="reference external" href="https://doi.org/10.1111/1467-9868.00404">A theory of statistical models for Monte Carlo integration.</a> <em>J. R. Stat. Soc. Ser. B Stat. Methodol.</em></p>
+<p>5. Bennett, Charles H. (1976)
+<a class="reference external" href="https://doi.org/10.1016/0021-9991(76)90078-4">Efficient Estimation of Free Energy Differences from Monte Carlo Data.</a> J. Comput. Phys.</p>
 </section>
 
 
                 </article>
```

#### html2text {}

```diff
@@ -34,24 +34,27 @@
     *     .pdf
 
 ****** References ******
 
 ****** References# ******
 Please consider citing the following references if FastMBAR is used in your
 projects.
-   1. Xinqiang Ding, Jonah Z. Vilseck, Charles L. Brooks III. (2019). Fast
-      Solver_for_Large_Scale_Multistate_Bennett_Acceptance_Ratio_Equations. J.
-      Chem. Theory Comput.
-   2. Xinqiang Ding, Jonah Z. Vilseck, Ryan L. Hayes, Charles L. Brooks III.
-      (2017). Gibbs_Sampler-based_Î»-dynamics_and_RaoâBlackwell_Estimator_for
-      Alchemical_Free_Energy_Calculation. J. Chem. Theory Comput.
-   3. Shirts, Michael R., and John D. Chodera. (2008) Statistically_Optimal
-      Analysis_of_Samples_from_Multiple_Equilibrium_States. J. Chem. Phys.
-   4. Bennett, Charles H. (1976) Efficient_Estimation_of_Free_Energy
-      Differences_from_Monte_Carlo_Data. J. Comput. Phys.
+1. Xinqiang Ding, Jonah Z. Vilseck, Charles L. Brooks III. (2019). Fast_Solver
+for_Large_Scale_Multistate_Bennett_Acceptance_Ratio_Equations. J. Chem. Theory
+Comput.
+2. Xinqiang Ding, Jonah Z. Vilseck, Ryan L. Hayes, Charles L. Brooks III.
+(2017). Gibbs_Sampler-based_Î»-dynamics_and_RaoâBlackwell_Estimator_for
+Alchemical_Free_Energy_Calculation. J. Chem. Theory Comput.
+3. Shirts, Michael R., and John D. Chodera. (2008) Statistically_Optimal
+Analysis_of_Samples_from_Multiple_Equilibrium_States. J. Chem. Phys.
+4. Kong A, McCullagh P, Meng XL, Nicolae D, Tan Z. (2003) A_theory_of
+statistical_models_for_Monte_Carlo_integration. J. R. Stat. Soc. Ser. B Stat.
+Methodol.
+5. Bennett, Charles H. (1976) Efficient_Estimation_of_Free_Energy_Differences
+from_Monte_Carlo_Data. J. Comput. Phys.
 
 previous
 Example_2._Compute_a_2D-PMF_of_dihedrals_for_dialanine.
 By Xinqiang Ding
 Â© Copyright 2019 Xinqiang Ding, Jonah Z. Vilseck, and Charles L. Brooks III..
```

### Comparing `fastmbar-1.2/docs/build/search.html` & `fastmbar-1.3/docs/build/search.html`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/searchindex.js` & `fastmbar-1.3/docs/build/searchindex.js`

 * *Files 1% similar despite different names*

#### js-beautify {}

```diff
@@ -14,15 +14,15 @@
         "fals": [0, 1, 2, 5, 7],
         "cuda_batch_mod": 0,
         "option": 0,
         "none": 0,
         "bootstrap": [0, 7],
         "bootstrap_block_s": 0,
         "int": [0, 7],
-        "3": [0, 4],
+        "3": [0, 4, 6],
         "bootstrap_num_rep": 0,
         "100": [0, 1, 2, 5],
         "verbos": [0, 1, 2, 7],
         "method": [0, 1, 2],
         "str": 0,
         "newton": [0, 5],
         "sourc": [0, 1, 2],
@@ -124,15 +124,15 @@
         "print": [0, 1, 2, 5, 7],
         "s": 0,
         "properti": [0, 1, 2],
         "f": [0, 1, 2, 7],
         "under": 0,
         "constraint": [0, 1, 2],
         "sum_": [0, 7],
-        "1": [0, 3, 4],
+        "1": [0, 3, 4, 6],
         "n_k": [0, 7],
         "f_k": [0, 7],
         "f_std": [0, 1, 7],
         "standard": [0, 7],
         "deviat": [0, 7],
         "f_cov": 0,
         "covari": 0,
@@ -146,15 +146,15 @@
         "log": 0,
         "probabl": [0, 7],
         "densiti": 0,
         "mixtur": 0,
         "distribut": [0, 5, 7],
         "calculate_free_energies_of_perturbed_st": [0, 1, 2, 7],
         "energy_perturb": 0,
-        "2": [0, 3, 4],
+        "2": [0, 3, 4, 6],
         "d": [0, 6],
         "float": 0,
         "each": [0, 1, 2, 7],
         "row": [0, 7],
         "repres": [0, 1, 2, 7],
         "valu": 0,
         "th": [0, 1, 2, 7],
@@ -284,15 +284,15 @@
         "degre": [1, 2],
         "freedom": [1, 2],
         "want": [1, 2, 3, 4, 5, 7],
         "createsystem": [1, 2],
         "nonbondedmethod": [1, 2],
         "nocutoff": [1, 2],
         "bias_tors": 1,
-        "5": [1, 2],
+        "5": [1, 2, 6],
         "dtheta": [1, 2],
         "min": [1, 2],
         "diff": 1,
         "pi": [1, 2],
         "ab": [1, 2],
         "theta": [1, 2],
         "theta0": 1,
@@ -329,15 +329,15 @@
         "parallel": [1, 2],
         "cluster": [1, 2],
         "node": [1, 2],
         "r": [1, 2, 6],
         "deseri": [1, 2],
         "context": [1, 2],
         "consist": [1, 2],
-        "integr": [1, 2],
+        "integr": [1, 2, 6],
         "platform": [1, 2, 5],
         "abov": [1, 2, 5, 7],
         "specifi": [1, 2],
         "kind": [1, 2, 3],
         "langevin": [1, 2],
         "dynam": [1, 2, 3, 6],
         "nvt": [1, 2],
@@ -437,15 +437,15 @@
         "remov": [1, 2],
         "affect": [1, 2],
         "omit": [1, 2],
         "loadtxt": 1,
         "append": [1, 2],
         "len": 1,
         "concaten": 1,
-        "A": [1, 2, 7],
+        "A": [1, 2, 6, 7],
         "zero": [1, 2],
         "kbt": [1, 2],
         "boltzmann_constant_kb": [1, 2],
         "avogadro_constant_na": [1, 2],
         "value_in_unit": [1, 2],
         "kilojoule_per_mol": [1, 2],
         "current_theta0": 1,
@@ -460,15 +460,15 @@
         "theta_": 1,
         "theta_l": 1,
         "constrain": [1, 2],
         "r_l": 1,
         "enforc": [1, 2],
         "infin": [1, 2],
         "otherwis": [1, 2],
-        "b": [1, 2, 5, 7],
+        "b": [1, 2, 5, 6, 7],
         "25": [1, 2, 5],
         "theta_pmf": 1,
         "width": [1, 2],
         "theta_cent": 1,
         "theta_low": 1,
         "theta_high": 1,
         "inf": [1, 2],
@@ -771,15 +771,15 @@
         "f_perturbed_std": 7,
         "_": [],
         "pytest": 5,
         "pyarg": 5,
         "session": 5,
         "linux": 5,
         "11": 5,
-        "4": 5,
+        "4": [5, 6],
         "7": 5,
         "pluggi": 5,
         "home": 5,
         "xqding": 5,
         "miniconda3": 5,
         "env": 5,
         "bin": 5,
@@ -806,15 +806,28 @@
         "91": 5,
         "111": 5,
         "64": 5,
         "01": 5,
         "51": 5,
         "skip": 5,
         "29": 5,
-        "67": 5
+        "67": 5,
+        "kong": 6,
+        "mccullagh": 6,
+        "p": 6,
+        "meng": 6,
+        "xl": 6,
+        "nicola": 6,
+        "tan": 6,
+        "2003": 6,
+        "model": 6,
+        "stat": 6,
+        "soc": 6,
+        "ser": 6,
+        "methodol": 6
     },
     "objects": {
         "FastMBAR": [
             [0, 0, 1, "", "FastMBAR"]
         ],
         "FastMBAR.FastMBAR": [
             [0, 1, 1, "", "DeltaF"],
```

### Comparing `fastmbar-1.2/docs/build/usage.html` & `fastmbar-1.3/docs/build/usage.html`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/.doctrees/API.doctree` & `fastmbar-1.3/docs/build/.doctrees/API.doctree`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/.doctrees/butane_PMF.doctree` & `fastmbar-1.3/docs/build/.doctrees/butane_PMF.doctree`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/.doctrees/dialanine_PMF.doctree` & `fastmbar-1.3/docs/build/.doctrees/dialanine_PMF.doctree`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/.doctrees/environment.pickle` & `fastmbar-1.3/docs/build/.doctrees/environment.pickle`

 * *Files 16% similar despite different names*

```diff
@@ -1,8 +1,8 @@
-00000000: 8005 9535 f100 0000 0000 008c 1273 7068  ...5.........sph
+00000000: 8005 95fc f000 0000 0000 008c 1273 7068  .............sph
 00000010: 696e 782e 656e 7669 726f 6e6d 656e 7494  inx.environment.
 00000020: 8c10 4275 696c 6445 6e76 6972 6f6e 6d65  ..BuildEnvironme
 00000030: 6e74 9493 9429 8194 7d94 288c 0361 7070  nt...)..}.(..app
 00000040: 944e 8c0a 646f 6374 7265 6564 6972 948c  .N..doctreedir..
 00000050: 642f 5573 6572 732f 6469 6e67 7871 2f4c  d/Users/dingxq/L
 00000060: 6962 7261 7279 2f43 6c6f 7564 5374 6f72  ibrary/CloudStor
 00000070: 6167 652f 426f 782d 426f 782f 5265 7365  age/Box-Box/Rese
@@ -777,20 +777,20 @@
 00003080: 7573 944b 018c 1363 6f6e 6669 675f 7374  us.K...config_st
 00003090: 6174 7573 5f65 7874 7261 9468 6c8c 0665  atus_extra.hl..e
 000030a0: 7665 6e74 7394 4e8c 0770 726f 6a65 6374  vents.N..project
 000030b0: 948c 0e73 7068 696e 782e 7072 6f6a 6563  ...sphinx.projec
 000030c0: 7494 8c07 5072 6f6a 6563 7494 9394 2981  t...Project...).
 000030d0: 947d 9428 8c06 7372 6364 6972 9468 0968  .}.(..srcdir.h.h
 000030e0: 5a68 5e8c 0864 6f63 6e61 6d65 7394 8f94  Zh^..docnames...
-000030f0: 288c 0c69 6e73 7461 6c6c 6174 696f 6e94  (..installation.
-00003100: 8c0d 6469 616c 616e 696e 655f 504d 4694  ..dialanine_PMF.
-00003110: 8c05 7573 6167 6594 8c03 4150 4994 8c08  ..usage...API...
-00003120: 6578 616d 706c 6573 948c 0a62 7574 616e  examples...butan
-00003130: 655f 504d 4694 8c0a 7265 6665 7265 6e63  e_PMF...referenc
-00003140: 6573 948c 0569 6e64 6578 9490 7562 8c07  es...index..ub..
+000030f0: 288c 0569 6e64 6578 948c 0a72 6566 6572  (..index...refer
+00003100: 656e 6365 7394 8c0d 6469 616c 616e 696e  ences...dialanin
+00003110: 655f 504d 4694 8c03 4150 4994 8c0a 6275  e_PMF...API...bu
+00003120: 7461 6e65 5f50 4d46 948c 0575 7361 6765  tane_PMF...usage
+00003130: 948c 0865 7861 6d70 6c65 7394 8c0c 696e  ...examples...in
+00003140: 7374 616c 6c61 7469 6f6e 9490 7562 8c07  stallation..ub..
 00003150: 7665 7273 696f 6e94 7d94 288c 1073 7068  version.}.(..sph
 00003160: 696e 782e 646f 6d61 696e 732e 6394 4b02  inx.domains.c.K.
 00003170: 8c18 7370 6869 6e78 2e64 6f6d 6169 6e73  ..sphinx.domains
 00003180: 2e63 6861 6e67 6573 6574 944b 018c 1773  .changeset.K...s
 00003190: 7068 696e 782e 646f 6d61 696e 732e 6369  phinx.domains.ci
 000031a0: 7461 7469 6f6e 944b 018c 1273 7068 696e  tation.K...sphin
 000031b0: 782e 646f 6d61 696e 732e 6370 7094 4b06  x.domains.cpp.K.
@@ -833,3028 +833,3025 @@
 00003400: 6e61 626c 6564 9488 8c13 736d 6172 7471  nabled....smartq
 00003410: 756f 7465 735f 6c6f 6361 6c65 7394 5d94  uotes_locales.].
 00003420: 8c03 656e 7694 6803 8c1d 7472 696d 5f66  ..env.h...trim_f
 00003430: 6f6f 746e 6f74 655f 7265 6665 7265 6e63  ootnote_referenc
 00003440: 655f 7370 6163 6594 898c 0d6c 616e 6775  e_space....langu
 00003450: 6167 655f 636f 6465 9468 1b8c 0c73 6d61  age_code.h...sma
 00003460: 7274 5f71 756f 7465 7394 8875 8c08 616c  rt_quotes..u..al
-00003470: 6c5f 646f 6373 947d 9428 8c03 4150 4994  l_docs.}.(..API.
-00003480: 4741 d92b 09a4 2201 b88c 0a62 7574 616e  GA.+.."....butan
-00003490: 655f 504d 4694 4741 d92b 09a4 23bd 418c  e_PMF.GA.+..#.A.
-000034a0: 0d64 6961 6c61 6e69 6e65 5f50 4d46 9447  .dialanine_PMF.G
-000034b0: 41d9 2b09 a425 9026 8c08 6578 616d 706c  A.+..%.&..exampl
-000034c0: 6573 9447 41d9 2b09 a426 34e7 8c05 696e  es.GA.+..&4...in
-000034d0: 6465 7894 4741 d92b 09a4 2695 9a8c 0a72  dex.GA.+..&....r
-000034e0: 6566 6572 656e 6365 7394 4741 d92b 09a4  eferences.GA.+..
-000034f0: 27d5 678c 0575 7361 6765 9447 41d9 2b09  '.g..usage.GA.+.
-00003500: a429 1bf0 6ae7 0200 0047 41d9 2b11 629c  .)..j....GA.+.b.
-00003510: 0abb 758c 0c64 6570 656e 6465 6e63 6965  ..u..dependencie
-00003520: 7394 685b 8c0b 6465 6661 756c 7464 6963  s.h[..defaultdic
-00003530: 7494 9394 8c08 6275 696c 7469 6e73 948c  t.....builtins..
-00003540: 0373 6574 9493 9485 9452 9428 6a1c 0300  .set.....R.(j...
-00003550: 008f 9428 8c1a 2e2e 2f2e 2e2f 4661 7374  ...(..../../Fast
-00003560: 4d42 4152 2f66 6173 746d 6261 722e 7079  MBAR/fastmbar.py
-00003570: 9490 6a1d 0300 008f 9428 8c24 2e2e 2f2e  ..j......(.$../.
-00003580: 2e2f 6578 616d 706c 6573 2f62 7574 616e  ./examples/butan
-00003590: 652f 6461 7461 2f46 6967 5f31 2e70 6e67  e/data/Fig_1.png
-000035a0: 948c 1a2e 2e2f 2e2e 2f46 6173 744d 4241  ...../../FastMBA
-000035b0: 522f 6661 7374 6d62 6172 2e70 7994 8c22  R/fastmbar.py.."
-000035c0: 2e2e 2f2e 2e2f 6578 616d 706c 6573 2f62  ../../examples/b
-000035d0: 7574 616e 652f 6461 7461 2f50 4d46 2e70  utane/data/PMF.p
-000035e0: 6e67 948c 242e 2e2f 2e2e 2f65 7861 6d70  ng..$../../examp
-000035f0: 6c65 732f 6275 7461 6e65 2f64 6174 612f  les/butane/data/
-00003600: 4669 675f 322e 706e 6794 906a 1e03 0000  Fig_2.png..j....
-00003610: 8f94 288c 1a2e 2e2f 2e2e 2f46 6173 744d  ..(..../../FastM
-00003620: 4241 522f 6661 7374 6d62 6172 2e70 7994  BAR/fastmbar.py.
-00003630: 8c25 2e2e 2f2e 2e2f 6578 616d 706c 6573  .%../../examples
-00003640: 2f64 6961 6c61 6e69 6e65 2f64 6174 612f  /dialanine/data/
-00003650: 504d 462e 706e 6794 8c27 2e2e 2f2e 2e2f  PMF.png..'../../
-00003660: 6578 616d 706c 6573 2f64 6961 6c61 6e69  examples/dialani
-00003670: 6e65 2f64 6174 612f 4669 675f 322e 706e  ne/data/Fig_2.pn
-00003680: 6794 8c27 2e2e 2f2e 2e2f 6578 616d 706c  g..'../../exampl
-00003690: 6573 2f64 6961 6c61 6e69 6e65 2f64 6174  es/dialanine/dat
-000036a0: 612f 4669 675f 312e 706e 6794 906a 1f03  a/Fig_1.png..j..
-000036b0: 0000 8f94 288c 1a2e 2e2f 2e2e 2f46 6173  ....(..../../Fas
-000036c0: 744d 4241 522f 6661 7374 6d62 6172 2e70  tMBAR/fastmbar.p
-000036d0: 7994 906a 2003 0000 8f94 288c 1a2e 2e2f  y..j .....(..../
-000036e0: 2e2e 2f46 6173 744d 4241 522f 6661 7374  ../FastMBAR/fast
-000036f0: 6d62 6172 2e70 7994 906a 2103 0000 8f94  mbar.py..j!.....
-00003700: 288c 1a2e 2e2f 2e2e 2f46 6173 744d 4241  (..../../FastMBA
-00003710: 522f 6661 7374 6d62 6172 2e70 7994 906a  R/fastmbar.py..j
-00003720: 2203 0000 8f94 288c 1a2e 2e2f 2e2e 2f46  ".....(..../../F
-00003730: 6173 744d 4241 522f 6661 7374 6d62 6172  astMBAR/fastmbar
-00003740: 2e70 7994 8c17 2e2e 2f2e 2e2f 656e 6572  .py...../../ener
-00003750: 6779 5f6d 6174 7269 782e 706e 6794 9075  gy_matrix.png..u
-00003760: 8c08 696e 636c 7564 6564 946a 2503 0000  ..included.j%...
-00003770: 6a28 0300 0085 9452 948c 0d72 6572 6561  j(.....R...rerea
-00003780: 645f 616c 7761 7973 948f 948c 086d 6574  d_always.....met
-00003790: 6164 6174 6194 6a25 0300 006a 2603 0000  adata.j%...j&...
-000037a0: 8c04 6469 6374 9493 9485 9452 948c 0674  ..dict.....R...t
-000037b0: 6974 6c65 7394 7d94 286a 1c03 0000 8c0e  itles.}.(j......
-000037c0: 646f 6375 7469 6c73 2e6e 6f64 6573 948c  docutils.nodes..
-000037d0: 0574 6974 6c65 9493 9429 8194 7d94 288c  .title...)..}.(.
-000037e0: 0972 6177 736f 7572 6365 9468 6c8c 0863  .rawsource.hl..c
-000037f0: 6869 6c64 7265 6e94 5d94 6a4c 0300 008c  hildren.].jL....
-00003800: 0454 6578 7494 9394 8c0c 4661 7374 4d42  .Text.....FastMB
-00003810: 4152 2041 5049 9485 9481 947d 948c 0670  AR API.....}...p
-00003820: 6172 656e 7494 6a4f 0300 0073 6261 8c0a  arent.jO...sba..
-00003830: 6174 7472 6962 7574 6573 947d 9428 8c03  attributes.}.(..
-00003840: 6964 7394 5d94 8c07 636c 6173 7365 7394  ids.]...classes.
-00003850: 5d94 8c05 6e61 6d65 7394 5d94 8c08 6475  ]...names.]...du
-00003860: 706e 616d 6573 945d 948c 0862 6163 6b72  pnames.]...backr
-00003870: 6566 7394 5d94 758c 0774 6167 6e61 6d65  efs.].u..tagname
-00003880: 948c 0574 6974 6c65 9475 626a 1d03 0000  ...title.ubj....
-00003890: 6a4e 0300 0029 8194 7d94 286a 5103 0000  jN...)..}.(jQ...
-000038a0: 686c 6a52 0300 005d 946a 5503 0000 8c34  hljR...].jU....4
-000038b0: 4578 616d 706c 6520 312e 2043 6f6d 7075  Example 1. Compu
-000038c0: 7465 2074 6865 2050 4d46 206f 6620 6120  te the PMF of a 
-000038d0: 6469 6865 6472 616c 2066 6f72 2062 7574  dihedral for but
-000038e0: 616e 652e 9485 9481 947d 946a 5a03 0000  ane......}.jZ...
-000038f0: 6a69 0300 0073 6261 6a5b 0300 007d 9428  ji...sbaj[...}.(
-00003900: 6a5d 0300 005d 946a 5f03 0000 5d94 6a61  j]...].j_...].ja
-00003910: 0300 005d 946a 6303 0000 5d94 6a65 0300  ...].jc...].je..
-00003920: 005d 9475 6a67 0300 006a 6803 0000 7562  .].ujg...jh...ub
-00003930: 6a1e 0300 006a 4e03 0000 2981 947d 9428  j....jN...)..}.(
-00003940: 6a51 0300 0068 6c6a 5203 0000 5d94 6a55  jQ...hljR...].jU
-00003950: 0300 008c 3745 7861 6d70 6c65 2032 2e20  ....7Example 2. 
-00003960: 436f 6d70 7574 6520 6120 3244 2d50 4d46  Compute a 2D-PMF
-00003970: 206f 6620 6469 6865 6472 616c 7320 666f   of dihedrals fo
-00003980: 7220 6469 616c 616e 696e 652e 9485 9481  r dialanine.....
-00003990: 947d 946a 5a03 0000 6a76 0300 0073 6261  .}.jZ...jv...sba
-000039a0: 6a5b 0300 007d 9428 6a5d 0300 005d 946a  j[...}.(j]...].j
-000039b0: 5f03 0000 5d94 6a61 0300 005d 946a 6303  _...].ja...].jc.
-000039c0: 0000 5d94 6a65 0300 005d 9475 6a67 0300  ..].je...].ujg..
-000039d0: 006a 6803 0000 7562 6a1f 0300 006a 4e03  .jh...ubj....jN.
-000039e0: 0000 2981 947d 9428 6a51 0300 0068 6c6a  ..)..}.(jQ...hlj
-000039f0: 5203 0000 5d94 6a55 0300 008c 0845 7861  R...].jU.....Exa
-00003a00: 6d70 6c65 7394 8594 8194 7d94 6a5a 0300  mples.....}.jZ..
-00003a10: 006a 8303 0000 7362 616a 5b03 0000 7d94  .j....sbaj[...}.
-00003a20: 286a 5d03 0000 5d94 6a5f 0300 005d 946a  (j]...].j_...].j
-00003a30: 6103 0000 5d94 6a63 0300 005d 946a 6503  a...].jc...].je.
-00003a40: 0000 5d94 756a 6703 0000 6a68 0300 0075  ..].ujg...jh...u
-00003a50: 626a 2003 0000 6a4e 0300 0029 8194 7d94  bj ...jN...)..}.
-00003a60: 286a 5103 0000 686c 6a52 0300 005d 946a  (jQ...hljR...].j
-00003a70: 5503 0000 8c14 5765 6c63 6f6d 6520 746f  U.....Welcome to
-00003a80: 2046 6173 744d 4241 5221 9485 9481 947d   FastMBAR!.....}
-00003a90: 946a 5a03 0000 6a90 0300 0073 6261 6a5b  .jZ...j....sbaj[
-00003aa0: 0300 007d 9428 6a5d 0300 005d 946a 5f03  ...}.(j]...].j_.
-00003ab0: 0000 5d94 6a61 0300 005d 946a 6303 0000  ..].ja...].jc...
-00003ac0: 5d94 6a65 0300 005d 9475 6a67 0300 006a  ].je...].ujg...j
-00003ad0: 6803 0000 7562 6a21 0300 006a 4e03 0000  h...ubj!...jN...
-00003ae0: 2981 947d 9428 6a51 0300 0068 6c6a 5203  )..}.(jQ...hljR.
-00003af0: 0000 5d94 6a55 0300 008c 0a52 6566 6572  ..].jU.....Refer
-00003b00: 656e 6365 7394 8594 8194 7d94 6a5a 0300  ences.....}.jZ..
-00003b10: 006a 9d03 0000 7362 616a 5b03 0000 7d94  .j....sbaj[...}.
-00003b20: 286a 5d03 0000 5d94 6a5f 0300 005d 946a  (j]...].j_...].j
-00003b30: 6103 0000 5d94 6a63 0300 005d 946a 6503  a...].jc...].je.
-00003b40: 0000 5d94 756a 6703 0000 6a68 0300 0075  ..].ujg...jh...u
-00003b50: 626a 2203 0000 6a4e 0300 0029 8194 7d94  bj"...jN...)..}.
-00003b60: 286a 5103 0000 686c 6a52 0300 005d 946a  (jQ...hljR...].j
-00003b70: 5503 0000 8c05 5573 6167 6594 8594 8194  U.....Usage.....
-00003b80: 7d94 6a5a 0300 006a aa03 0000 7362 616a  }.jZ...j....sbaj
-00003b90: 5b03 0000 7d94 286a 5d03 0000 5d94 6a5f  [...}.(j]...].j_
-00003ba0: 0300 005d 946a 6103 0000 5d94 6a63 0300  ...].ja...].jc..
-00003bb0: 005d 946a 6503 0000 5d94 756a 6703 0000  .].je...].ujg...
-00003bc0: 6a68 0300 0075 626a e702 0000 6a4e 0300  jh...ubj....jN..
-00003bd0: 0029 8194 7d94 286a 5103 0000 686c 6a52  .)..}.(jQ...hljR
-00003be0: 0300 005d 946a 5503 0000 8c0c 496e 7374  ...].jU.....Inst
-00003bf0: 616c 6c61 7469 6f6e 9485 9481 947d 946a  allation.....}.j
-00003c00: 5a03 0000 6ab7 0300 0073 6261 6a5b 0300  Z...j....sbaj[..
-00003c10: 007d 9428 8c03 6964 7394 5d94 8c07 636c  .}.(..ids.]...cl
-00003c20: 6173 7365 7394 5d94 8c05 6e61 6d65 7394  asses.]...names.
-00003c30: 5d94 8c08 6475 706e 616d 6573 945d 948c  ]...dupnames.]..
-00003c40: 0862 6163 6b72 6566 7394 5d94 756a 6703  .backrefs.].ujg.
-00003c50: 0000 6a4d 0300 0075 6275 8c0a 6c6f 6e67  ..jM...ubu..long
-00003c60: 7469 746c 6573 947d 9428 6a1c 0300 006a  titles.}.(j....j
-00003c70: 4f03 0000 6a1d 0300 006a 6903 0000 6a1e  O...j....ji...j.
-00003c80: 0300 006a 7603 0000 6a1f 0300 006a 8303  ...jv...j....j..
-00003c90: 0000 6a20 0300 006a 9003 0000 6a21 0300  ..j ...j....j!..
-00003ca0: 006a 9d03 0000 6a22 0300 006a aa03 0000  .j....j"...j....
-00003cb0: 6ae7 0200 006a b703 0000 758c 0474 6f63  j....j....u..toc
-00003cc0: 7394 7d94 286a 1c03 0000 6a4c 0300 008c  s.}.(j....jL....
-00003cd0: 0b62 756c 6c65 745f 6c69 7374 9493 9429  .bullet_list...)
-00003ce0: 8194 7d94 286a 5103 0000 686c 6a52 0300  ..}.(jQ...hljR..
-00003cf0: 005d 946a 4c03 0000 8c09 6c69 7374 5f69  .].jL.....list_i
-00003d00: 7465 6d94 9394 2981 947d 9428 6a51 0300  tem...)..}.(jQ..
-00003d10: 0068 6c6a 5203 0000 5d94 8c0f 7370 6869  .hljR...]...sphi
-00003d20: 6e78 2e61 6464 6e6f 6465 7394 8c11 636f  nx.addnodes...co
-00003d30: 6d70 6163 745f 7061 7261 6772 6170 6894  mpact_paragraph.
-00003d40: 9394 2981 947d 9428 6a51 0300 0068 6c6a  ..)..}.(jQ...hlj
-00003d50: 5203 0000 5d94 6a4c 0300 008c 0972 6566  R...].jL.....ref
-00003d60: 6572 656e 6365 9493 9429 8194 7d94 286a  erence...)..}.(j
-00003d70: 5103 0000 686c 6a52 0300 005d 946a 5503  Q...hljR...].jU.
-00003d80: 0000 8c0c 4661 7374 4d42 4152 2041 5049  ....FastMBAR API
-00003d90: 9485 9481 947d 946a 5a03 0000 6adf 0300  .....}.jZ...j...
-00003da0: 0073 6261 6a5b 0300 007d 9428 6a5d 0300  .sbaj[...}.(j]..
-00003db0: 005d 946a 5f03 0000 5d94 6a61 0300 005d  .].j_...].ja...]
-00003dc0: 946a 6303 0000 5d94 6a65 0300 005d 948c  .jc...].je...]..
-00003dd0: 0869 6e74 6572 6e61 6c94 888c 0672 6566  .internal....ref
-00003de0: 7572 6994 6a1c 0300 008c 0a61 6e63 686f  uri.j......ancho
-00003df0: 726e 616d 6594 686c 756a 6703 0000 8c09  rname.hlujg.....
-00003e00: 7265 6665 7265 6e63 6594 6a5a 0300 006a  reference.jZ...j
-00003e10: da03 0000 7562 616a 5b03 0000 7d94 286a  ....ubaj[...}.(j
-00003e20: 5d03 0000 5d94 6a5f 0300 005d 946a 6103  ]...].j_...].ja.
-00003e30: 0000 5d94 6a63 0300 005d 946a 6503 0000  ..].jc...].je...
-00003e40: 5d94 756a 6703 0000 8c11 636f 6d70 6163  ].ujg.....compac
-00003e50: 745f 7061 7261 6772 6170 6894 6a5a 0300  t_paragraph.jZ..
-00003e60: 006a d403 0000 7562 616a 5b03 0000 7d94  .j....ubaj[...}.
-00003e70: 286a 5d03 0000 5d94 6a5f 0300 005d 946a  (j]...].j_...].j
-00003e80: 6103 0000 5d94 6a63 0300 005d 946a 6503  a...].jc...].je.
-00003e90: 0000 5d94 756a 6703 0000 8c09 6c69 7374  ..].ujg.....list
-00003ea0: 5f69 7465 6d94 6a5a 0300 006a cf03 0000  _item.jZ...j....
-00003eb0: 7562 616a 5b03 0000 7d94 286a 5d03 0000  ubaj[...}.(j]...
-00003ec0: 5d94 6a5f 0300 005d 946a 6103 0000 5d94  ].j_...].ja...].
-00003ed0: 6a63 0300 005d 946a 6503 0000 5d94 756a  jc...].je...].uj
-00003ee0: 6703 0000 8c0b 6275 6c6c 6574 5f6c 6973  g.....bullet_lis
-00003ef0: 7494 7562 6a1d 0300 006a ce03 0000 2981  t.ubj....j....).
-00003f00: 947d 9428 6a51 0300 0068 6c6a 5203 0000  .}.(jQ...hljR...
-00003f10: 5d94 6ad3 0300 0029 8194 7d94 286a 5103  ].j....)..}.(jQ.
-00003f20: 0000 686c 6a52 0300 005d 9428 6ad9 0300  ..hljR...].(j...
-00003f30: 0029 8194 7d94 286a 5103 0000 686c 6a52  .)..}.(jQ...hljR
-00003f40: 0300 005d 946a de03 0000 2981 947d 9428  ...].j....)..}.(
-00003f50: 6a51 0300 0068 6c6a 5203 0000 5d94 6a55  jQ...hljR...].jU
-00003f60: 0300 008c 3445 7861 6d70 6c65 2031 2e20  ....4Example 1. 
-00003f70: 436f 6d70 7574 6520 7468 6520 504d 4620  Compute the PMF 
-00003f80: 6f66 2061 2064 6968 6564 7261 6c20 666f  of a dihedral fo
-00003f90: 7220 6275 7461 6e65 2e94 8594 8194 7d94  r butane......}.
-00003fa0: 6a5a 0300 006a 0e04 0000 7362 616a 5b03  jZ...j....sbaj[.
-00003fb0: 0000 7d94 286a 5d03 0000 5d94 6a5f 0300  ..}.(j]...].j_..
-00003fc0: 005d 946a 6103 0000 5d94 6a63 0300 005d  .].ja...].jc...]
-00003fd0: 946a 6503 0000 5d94 8c08 696e 7465 726e  .je...]...intern
-00003fe0: 616c 9488 8c06 7265 6675 7269 946a 1d03  al....refuri.j..
-00003ff0: 0000 8c0a 616e 6368 6f72 6e61 6d65 9468  ....anchorname.h
-00004000: 6c75 6a67 0300 006a ef03 0000 6a5a 0300  lujg...j....jZ..
-00004010: 006a 0b04 0000 7562 616a 5b03 0000 7d94  .j....ubaj[...}.
-00004020: 286a 5d03 0000 5d94 6a5f 0300 005d 946a  (j]...].j_...].j
-00004030: 6103 0000 5d94 6a63 0300 005d 946a 6503  a...].jc...].je.
-00004040: 0000 5d94 756a 6703 0000 6af6 0300 006a  ..].ujg...j....j
-00004050: 5a03 0000 6a08 0400 0075 626a ce03 0000  Z...j....ubj....
-00004060: 2981 947d 9428 6a51 0300 0068 6c6a 5203  )..}.(jQ...hljR.
-00004070: 0000 5d94 286a d303 0000 2981 947d 9428  ..].(j....)..}.(
-00004080: 6a51 0300 0068 6c6a 5203 0000 5d94 6ad9  jQ...hljR...].j.
-00004090: 0300 0029 8194 7d94 286a 5103 0000 686c  ...)..}.(jQ...hl
-000040a0: 6a52 0300 005d 946a de03 0000 2981 947d  jR...].j....)..}
-000040b0: 9428 6a51 0300 0068 6c6a 5203 0000 5d94  .(jQ...hljR...].
-000040c0: 6a55 0300 008c 2731 2e20 436f 6e73 7472  jU....'1. Constr
-000040d0: 7563 7420 616e 204f 7065 6e4d 4d20 7379  uct an OpenMM sy
-000040e0: 7374 656d 206f 6620 6275 7461 6e65 9485  stem of butane..
-000040f0: 9481 947d 946a 5a03 0000 6a2d 0400 0073  ...}.jZ...j-...s
-00004100: 6261 6a5b 0300 007d 9428 6a5d 0300 005d  baj[...}.(j]...]
-00004110: 946a 5f03 0000 5d94 6a61 0300 005d 946a  .j_...].ja...].j
-00004120: 6303 0000 5d94 6a65 0300 005d 948c 0869  c...].je...]...i
-00004130: 6e74 6572 6e61 6c94 888c 0672 6566 7572  nternal....refur
-00004140: 6994 6a1d 0300 008c 0a61 6e63 686f 726e  i.j......anchorn
-00004150: 616d 6594 8c25 2363 6f6e 7374 7275 6374  ame..%#construct
-00004160: 2d61 6e2d 6f70 656e 6d6d 2d73 7973 7465  -an-openmm-syste
-00004170: 6d2d 6f66 2d62 7574 616e 6594 756a 6703  m-of-butane.ujg.
-00004180: 0000 6aef 0300 006a 5a03 0000 6a2a 0400  ..j....jZ...j*..
-00004190: 0075 6261 6a5b 0300 007d 9428 6a5d 0300  .ubaj[...}.(j]..
-000041a0: 005d 946a 5f03 0000 5d94 6a61 0300 005d  .].j_...].ja...]
-000041b0: 946a 6303 0000 5d94 6a65 0300 005d 9475  .jc...].je...].u
-000041c0: 6a67 0300 006a f603 0000 6a5a 0300 006a  jg...j....jZ...j
-000041d0: 2704 0000 7562 616a 5b03 0000 7d94 286a  '...ubaj[...}.(j
-000041e0: 5d03 0000 5d94 6a5f 0300 005d 946a 6103  ]...].j_...].ja.
-000041f0: 0000 5d94 6a63 0300 005d 946a 6503 0000  ..].jc...].je...
-00004200: 5d94 756a 6703 0000 6afd 0300 006a 5a03  ].ujg...j....jZ.
-00004210: 0000 6a24 0400 0075 626a d303 0000 2981  ..j$...ubj....).
-00004220: 947d 9428 6a51 0300 0068 6c6a 5203 0000  .}.(jQ...hljR...
-00004230: 5d94 6ad9 0300 0029 8194 7d94 286a 5103  ].j....)..}.(jQ.
-00004240: 0000 686c 6a52 0300 005d 946a de03 0000  ..hljR...].j....
-00004250: 2981 947d 9428 6a51 0300 0068 6c6a 5203  )..}.(jQ...hljR.
-00004260: 0000 5d94 6a55 0300 008c 1832 2e20 5275  ..].jU.....2. Ru
-00004270: 6e20 756d 6272 656c 6c61 2073 616d 706c  n umbrella sampl
-00004280: 696e 6794 8594 8194 7d94 6a5a 0300 006a  ing.....}.jZ...j
-00004290: 5004 0000 7362 616a 5b03 0000 7d94 286a  P...sbaj[...}.(j
-000042a0: 5d03 0000 5d94 6a5f 0300 005d 946a 6103  ]...].j_...].ja.
-000042b0: 0000 5d94 6a63 0300 005d 946a 6503 0000  ..].jc...].je...
-000042c0: 5d94 8c08 696e 7465 726e 616c 9488 8c06  ]...internal....
-000042d0: 7265 6675 7269 946a 1d03 0000 8c0a 616e  refuri.j......an
-000042e0: 6368 6f72 6e61 6d65 948c 1623 7275 6e2d  chorname...#run-
-000042f0: 756d 6272 656c 6c61 2d73 616d 706c 696e  umbrella-samplin
-00004300: 6794 756a 6703 0000 6aef 0300 006a 5a03  g.ujg...j....jZ.
-00004310: 0000 6a4d 0400 0075 6261 6a5b 0300 007d  ..jM...ubaj[...}
-00004320: 9428 6a5d 0300 005d 946a 5f03 0000 5d94  .(j]...].j_...].
-00004330: 6a61 0300 005d 946a 6303 0000 5d94 6a65  ja...].jc...].je
-00004340: 0300 005d 9475 6a67 0300 006a f603 0000  ...].ujg...j....
-00004350: 6a5a 0300 006a 4a04 0000 7562 616a 5b03  jZ...jJ...ubaj[.
-00004360: 0000 7d94 286a 5d03 0000 5d94 6a5f 0300  ..}.(j]...].j_..
-00004370: 005d 946a 6103 0000 5d94 6a63 0300 005d  .].ja...].jc...]
-00004380: 946a 6503 0000 5d94 756a 6703 0000 6afd  .je...].ujg...j.
-00004390: 0300 006a 5a03 0000 6a24 0400 0075 626a  ...jZ...j$...ubj
-000043a0: d303 0000 2981 947d 9428 6a51 0300 0068  ....)..}.(jQ...h
-000043b0: 6c6a 5203 0000 5d94 6ad9 0300 0029 8194  ljR...].j....)..
-000043c0: 7d94 286a 5103 0000 686c 6a52 0300 005d  }.(jQ...hljR...]
-000043d0: 946a de03 0000 2981 947d 9428 6a51 0300  .j....)..}.(jQ..
-000043e0: 0068 6c6a 5203 0000 5d94 6a55 0300 008c  .hljR...].jU....
-000043f0: 3133 2e20 436f 6d70 7574 6520 616e 6420  13. Compute and 
-00004400: 636f 6c6c 6563 7420 7468 6520 6275 7461  collect the buta
-00004410: 6e65 2064 6968 6564 7261 6c20 7661 6c75  ne dihedral valu
-00004420: 6573 9485 9481 947d 946a 5a03 0000 6a73  es.....}.jZ...js
-00004430: 0400 0073 6261 6a5b 0300 007d 9428 6a5d  ...sbaj[...}.(j]
-00004440: 0300 005d 946a 5f03 0000 5d94 6a61 0300  ...].j_...].ja..
-00004450: 005d 946a 6303 0000 5d94 6a65 0300 005d  .].jc...].je...]
-00004460: 948c 0869 6e74 6572 6e61 6c94 888c 0672  ...internal....r
-00004470: 6566 7572 6994 6a1d 0300 008c 0a61 6e63  efuri.j......anc
-00004480: 686f 726e 616d 6594 8c2f 2363 6f6d 7075  horname../#compu
-00004490: 7465 2d61 6e64 2d63 6f6c 6c65 6374 2d74  te-and-collect-t
-000044a0: 6865 2d62 7574 616e 652d 6469 6865 6472  he-butane-dihedr
-000044b0: 616c 2d76 616c 7565 7394 756a 6703 0000  al-values.ujg...
-000044c0: 6aef 0300 006a 5a03 0000 6a70 0400 0075  j....jZ...jp...u
-000044d0: 6261 6a5b 0300 007d 9428 6a5d 0300 005d  baj[...}.(j]...]
-000044e0: 946a 5f03 0000 5d94 6a61 0300 005d 946a  .j_...].ja...].j
-000044f0: 6303 0000 5d94 6a65 0300 005d 9475 6a67  c...].je...].ujg
-00004500: 0300 006a f603 0000 6a5a 0300 006a 6d04  ...j....jZ...jm.
-00004510: 0000 7562 616a 5b03 0000 7d94 286a 5d03  ..ubaj[...}.(j].
-00004520: 0000 5d94 6a5f 0300 005d 946a 6103 0000  ..].j_...].ja...
-00004530: 5d94 6a63 0300 005d 946a 6503 0000 5d94  ].jc...].je...].
-00004540: 756a 6703 0000 6afd 0300 006a 5a03 0000  ujg...j....jZ...
-00004550: 6a24 0400 0075 626a d303 0000 2981 947d  j$...ubj....)..}
-00004560: 9428 6a51 0300 0068 6c6a 5203 0000 5d94  .(jQ...hljR...].
-00004570: 6ad9 0300 0029 8194 7d94 286a 5103 0000  j....)..}.(jQ...
-00004580: 686c 6a52 0300 005d 946a de03 0000 2981  hljR...].j....).
-00004590: 947d 9428 6a51 0300 0068 6c6a 5203 0000  .}.(jQ...hljR...
-000045a0: 5d94 6a55 0300 008c 4134 2e20 5573 6520  ].jU....A4. Use 
-000045b0: 4661 7374 4d42 4152 2074 6f20 736f 6c76  FastMBAR to solv
-000045c0: 6520 4d42 4152 2f55 5748 414d 2065 7175  e MBAR/UWHAM equ
-000045d0: 6174 696f 6e73 2061 6e64 2063 6f6d 7075  ations and compu
-000045e0: 7465 2074 6865 2050 4d46 9485 9481 947d  te the PMF.....}
-000045f0: 946a 5a03 0000 6a96 0400 0073 6261 6a5b  .jZ...j....sbaj[
-00004600: 0300 007d 9428 6a5d 0300 005d 946a 5f03  ...}.(j]...].j_.
-00004610: 0000 5d94 6a61 0300 005d 946a 6303 0000  ..].ja...].jc...
-00004620: 5d94 6a65 0300 005d 948c 0869 6e74 6572  ].je...]...inter
-00004630: 6e61 6c94 888c 0672 6566 7572 6994 6a1d  nal....refuri.j.
-00004640: 0300 008c 0a61 6e63 686f 726e 616d 6594  .....anchorname.
-00004650: 8c3f 2375 7365 2d66 6173 746d 6261 722d  .?#use-fastmbar-
-00004660: 746f 2d73 6f6c 7665 2d6d 6261 722d 7577  to-solve-mbar-uw
-00004670: 6861 6d2d 6571 7561 7469 6f6e 732d 616e  ham-equations-an
-00004680: 642d 636f 6d70 7574 652d 7468 652d 706d  d-compute-the-pm
-00004690: 6694 756a 6703 0000 6aef 0300 006a 5a03  f.ujg...j....jZ.
-000046a0: 0000 6a93 0400 0075 6261 6a5b 0300 007d  ..j....ubaj[...}
-000046b0: 9428 6a5d 0300 005d 946a 5f03 0000 5d94  .(j]...].j_...].
-000046c0: 6a61 0300 005d 946a 6303 0000 5d94 6a65  ja...].jc...].je
-000046d0: 0300 005d 9475 6a67 0300 006a f603 0000  ...].ujg...j....
-000046e0: 6a5a 0300 006a 9004 0000 7562 616a 5b03  jZ...j....ubaj[.
-000046f0: 0000 7d94 286a 5d03 0000 5d94 6a5f 0300  ..}.(j]...].j_..
-00004700: 005d 946a 6103 0000 5d94 6a63 0300 005d  .].ja...].jc...]
-00004710: 946a 6503 0000 5d94 756a 6703 0000 6afd  .je...].ujg...j.
-00004720: 0300 006a 5a03 0000 6a24 0400 0075 6265  ...jZ...j$...ube
-00004730: 6a5b 0300 007d 9428 6a5d 0300 005d 946a  j[...}.(j]...].j
-00004740: 5f03 0000 5d94 6a61 0300 005d 946a 6303  _...].ja...].jc.
-00004750: 0000 5d94 6a65 0300 005d 9475 6a67 0300  ..].je...].ujg..
-00004760: 006a 0404 0000 6a5a 0300 006a 0804 0000  .j....jZ...j....
-00004770: 7562 656a 5b03 0000 7d94 286a 5d03 0000  ubej[...}.(j]...
-00004780: 5d94 6a5f 0300 005d 946a 6103 0000 5d94  ].j_...].ja...].
-00004790: 6a63 0300 005d 946a 6503 0000 5d94 756a  jc...].je...].uj
-000047a0: 6703 0000 6afd 0300 006a 5a03 0000 6a05  g...j....jZ...j.
-000047b0: 0400 0075 6261 6a5b 0300 007d 9428 6a5d  ...ubaj[...}.(j]
-000047c0: 0300 005d 946a 5f03 0000 5d94 6a61 0300  ...].j_...].ja..
-000047d0: 005d 946a 6303 0000 5d94 6a65 0300 005d  .].jc...].je...]
-000047e0: 9475 6a67 0300 006a 0404 0000 7562 6a1e  .ujg...j....ubj.
-000047f0: 0300 006a ce03 0000 2981 947d 9428 6a51  ...j....)..}.(jQ
-00004800: 0300 0068 6c6a 5203 0000 5d94 6ad3 0300  ...hljR...].j...
-00004810: 0029 8194 7d94 286a 5103 0000 686c 6a52  .)..}.(jQ...hljR
-00004820: 0300 005d 9428 6ad9 0300 0029 8194 7d94  ...].(j....)..}.
-00004830: 286a 5103 0000 686c 6a52 0300 005d 946a  (jQ...hljR...].j
-00004840: de03 0000 2981 947d 9428 6a51 0300 0068  ....)..}.(jQ...h
-00004850: 6c6a 5203 0000 5d94 6a55 0300 008c 3745  ljR...].jU....7E
-00004860: 7861 6d70 6c65 2032 2e20 436f 6d70 7574  xample 2. Comput
-00004870: 6520 6120 3244 2d50 4d46 206f 6620 6469  e a 2D-PMF of di
-00004880: 6865 6472 616c 7320 666f 7220 6469 616c  hedrals for dial
-00004890: 616e 696e 652e 9485 9481 947d 946a 5a03  anine......}.jZ.
-000048a0: 0000 6ace 0400 0073 6261 6a5b 0300 007d  ..j....sbaj[...}
-000048b0: 9428 6a5d 0300 005d 946a 5f03 0000 5d94  .(j]...].j_...].
-000048c0: 6a61 0300 005d 946a 6303 0000 5d94 6a65  ja...].jc...].je
-000048d0: 0300 005d 948c 0869 6e74 6572 6e61 6c94  ...]...internal.
-000048e0: 888c 0672 6566 7572 6994 6a1e 0300 008c  ...refuri.j.....
-000048f0: 0a61 6e63 686f 726e 616d 6594 686c 756a  .anchorname.hluj
-00004900: 6703 0000 6aef 0300 006a 5a03 0000 6acb  g...j....jZ...j.
-00004910: 0400 0075 6261 6a5b 0300 007d 9428 6a5d  ...ubaj[...}.(j]
-00004920: 0300 005d 946a 5f03 0000 5d94 6a61 0300  ...].j_...].ja..
-00004930: 005d 946a 6303 0000 5d94 6a65 0300 005d  .].jc...].je...]
-00004940: 9475 6a67 0300 006a f603 0000 6a5a 0300  .ujg...j....jZ..
-00004950: 006a c804 0000 7562 6ace 0300 0029 8194  .j....ubj....)..
-00004960: 7d94 286a 5103 0000 686c 6a52 0300 005d  }.(jQ...hljR...]
-00004970: 9428 6ad3 0300 0029 8194 7d94 286a 5103  .(j....)..}.(jQ.
-00004980: 0000 686c 6a52 0300 005d 946a d903 0000  ..hljR...].j....
-00004990: 2981 947d 9428 6a51 0300 0068 6c6a 5203  )..}.(jQ...hljR.
-000049a0: 0000 5d94 6ade 0300 0029 8194 7d94 286a  ..].j....)..}.(j
-000049b0: 5103 0000 686c 6a52 0300 005d 946a 5503  Q...hljR...].jU.
-000049c0: 0000 8c2a 312e 2043 6f6e 7374 7275 6374  ...*1. Construct
-000049d0: 2061 6e20 4f70 656e 4d4d 2073 7973 7465   an OpenMM syste
-000049e0: 6d20 6f66 2064 6961 6c61 6e69 6e65 9485  m of dialanine..
-000049f0: 9481 947d 946a 5a03 0000 6aed 0400 0073  ...}.jZ...j....s
-00004a00: 6261 6a5b 0300 007d 9428 6a5d 0300 005d  baj[...}.(j]...]
-00004a10: 946a 5f03 0000 5d94 6a61 0300 005d 946a  .j_...].ja...].j
-00004a20: 6303 0000 5d94 6a65 0300 005d 948c 0869  c...].je...]...i
-00004a30: 6e74 6572 6e61 6c94 888c 0672 6566 7572  nternal....refur
-00004a40: 6994 6a1e 0300 008c 0a61 6e63 686f 726e  i.j......anchorn
-00004a50: 616d 6594 8c28 2363 6f6e 7374 7275 6374  ame..(#construct
-00004a60: 2d61 6e2d 6f70 656e 6d6d 2d73 7973 7465  -an-openmm-syste
-00004a70: 6d2d 6f66 2d64 6961 6c61 6e69 6e65 9475  m-of-dialanine.u
-00004a80: 6a67 0300 006a ef03 0000 6a5a 0300 006a  jg...j....jZ...j
-00004a90: ea04 0000 7562 616a 5b03 0000 7d94 286a  ....ubaj[...}.(j
-00004aa0: 5d03 0000 5d94 6a5f 0300 005d 946a 6103  ]...].j_...].ja.
-00004ab0: 0000 5d94 6a63 0300 005d 946a 6503 0000  ..].jc...].je...
-00004ac0: 5d94 756a 6703 0000 6af6 0300 006a 5a03  ].ujg...j....jZ.
-00004ad0: 0000 6ae7 0400 0075 6261 6a5b 0300 007d  ..j....ubaj[...}
-00004ae0: 9428 6a5d 0300 005d 946a 5f03 0000 5d94  .(j]...].j_...].
-00004af0: 6a61 0300 005d 946a 6303 0000 5d94 6a65  ja...].jc...].je
-00004b00: 0300 005d 9475 6a67 0300 006a fd03 0000  ...].ujg...j....
-00004b10: 6a5a 0300 006a e404 0000 7562 6ad3 0300  jZ...j....ubj...
-00004b20: 0029 8194 7d94 286a 5103 0000 686c 6a52  .)..}.(jQ...hljR
-00004b30: 0300 005d 946a d903 0000 2981 947d 9428  ...].j....)..}.(
-00004b40: 6a51 0300 0068 6c6a 5203 0000 5d94 6ade  jQ...hljR...].j.
-00004b50: 0300 0029 8194 7d94 286a 5103 0000 686c  ...)..}.(jQ...hl
-00004b60: 6a52 0300 005d 946a 5503 0000 8c18 322e  jR...].jU.....2.
-00004b70: 2052 756e 2075 6d62 7265 6c6c 6120 7361   Run umbrella sa
-00004b80: 6d70 6c69 6e67 9485 9481 947d 946a 5a03  mpling.....}.jZ.
-00004b90: 0000 6a10 0500 0073 6261 6a5b 0300 007d  ..j....sbaj[...}
-00004ba0: 9428 6a5d 0300 005d 946a 5f03 0000 5d94  .(j]...].j_...].
-00004bb0: 6a61 0300 005d 946a 6303 0000 5d94 6a65  ja...].jc...].je
-00004bc0: 0300 005d 948c 0869 6e74 6572 6e61 6c94  ...]...internal.
-00004bd0: 888c 0672 6566 7572 6994 6a1e 0300 008c  ...refuri.j.....
-00004be0: 0a61 6e63 686f 726e 616d 6594 8c16 2372  .anchorname...#r
-00004bf0: 756e 2d75 6d62 7265 6c6c 612d 7361 6d70  un-umbrella-samp
-00004c00: 6c69 6e67 9475 6a67 0300 006a ef03 0000  ling.ujg...j....
-00004c10: 6a5a 0300 006a 0d05 0000 7562 616a 5b03  jZ...j....ubaj[.
-00004c20: 0000 7d94 286a 5d03 0000 5d94 6a5f 0300  ..}.(j]...].j_..
-00004c30: 005d 946a 6103 0000 5d94 6a63 0300 005d  .].ja...].jc...]
-00004c40: 946a 6503 0000 5d94 756a 6703 0000 6af6  .je...].ujg...j.
-00004c50: 0300 006a 5a03 0000 6a0a 0500 0075 6261  ...jZ...j....uba
-00004c60: 6a5b 0300 007d 9428 6a5d 0300 005d 946a  j[...}.(j]...].j
-00004c70: 5f03 0000 5d94 6a61 0300 005d 946a 6303  _...].ja...].jc.
-00004c80: 0000 5d94 6a65 0300 005d 9475 6a67 0300  ..].je...].ujg..
-00004c90: 006a fd03 0000 6a5a 0300 006a e404 0000  .j....jZ...j....
-00004ca0: 7562 6ad3 0300 0029 8194 7d94 286a 5103  ubj....)..}.(jQ.
-00004cb0: 0000 686c 6a52 0300 005d 946a d903 0000  ..hljR...].j....
-00004cc0: 2981 947d 9428 6a51 0300 0068 6c6a 5203  )..}.(jQ...hljR.
-00004cd0: 0000 5d94 6ade 0300 0029 8194 7d94 286a  ..].j....)..}.(j
-00004ce0: 5103 0000 686c 6a52 0300 005d 946a 5503  Q...hljR...].jU.
-00004cf0: 0000 8c38 332e 2043 6f6d 7075 7465 2061  ...83. Compute a
-00004d00: 6e64 2063 6f6c 6c65 6374 2076 616c 7565  nd collect value
-00004d10: 7320 6f66 2062 6f74 6820 6469 616c 616e  s of both dialan
-00004d20: 696e 6520 6469 6865 6472 616c 9485 9481  ine dihedral....
-00004d30: 947d 946a 5a03 0000 6a33 0500 0073 6261  .}.jZ...j3...sba
-00004d40: 6a5b 0300 007d 9428 6a5d 0300 005d 946a  j[...}.(j]...].j
-00004d50: 5f03 0000 5d94 6a61 0300 005d 946a 6303  _...].ja...].jc.
-00004d60: 0000 5d94 6a65 0300 005d 948c 0869 6e74  ..].je...]...int
-00004d70: 6572 6e61 6c94 888c 0672 6566 7572 6994  ernal....refuri.
-00004d80: 6a1e 0300 008c 0a61 6e63 686f 726e 616d  j......anchornam
-00004d90: 6594 8c36 2363 6f6d 7075 7465 2d61 6e64  e..6#compute-and
-00004da0: 2d63 6f6c 6c65 6374 2d76 616c 7565 732d  -collect-values-
-00004db0: 6f66 2d62 6f74 682d 6469 616c 616e 696e  of-both-dialanin
-00004dc0: 652d 6469 6865 6472 616c 9475 6a67 0300  e-dihedral.ujg..
-00004dd0: 006a ef03 0000 6a5a 0300 006a 3005 0000  .j....jZ...j0...
-00004de0: 7562 616a 5b03 0000 7d94 286a 5d03 0000  ubaj[...}.(j]...
-00004df0: 5d94 6a5f 0300 005d 946a 6103 0000 5d94  ].j_...].ja...].
-00004e00: 6a63 0300 005d 946a 6503 0000 5d94 756a  jc...].je...].uj
-00004e10: 6703 0000 6af6 0300 006a 5a03 0000 6a2d  g...j....jZ...j-
-00004e20: 0500 0075 6261 6a5b 0300 007d 9428 6a5d  ...ubaj[...}.(j]
-00004e30: 0300 005d 946a 5f03 0000 5d94 6a61 0300  ...].j_...].ja..
-00004e40: 005d 946a 6303 0000 5d94 6a65 0300 005d  .].jc...].je...]
-00004e50: 9475 6a67 0300 006a fd03 0000 6a5a 0300  .ujg...j....jZ..
-00004e60: 006a e404 0000 7562 6ad3 0300 0029 8194  .j....ubj....)..
-00004e70: 7d94 286a 5103 0000 686c 6a52 0300 005d  }.(jQ...hljR...]
-00004e80: 946a d903 0000 2981 947d 9428 6a51 0300  .j....)..}.(jQ..
-00004e90: 0068 6c6a 5203 0000 5d94 6ade 0300 0029  .hljR...].j....)
-00004ea0: 8194 7d94 286a 5103 0000 686c 6a52 0300  ..}.(jQ...hljR..
-00004eb0: 005d 946a 5503 0000 8c41 342e 2055 7365  .].jU....A4. Use
-00004ec0: 2046 6173 744d 4241 5220 746f 2073 6f6c   FastMBAR to sol
-00004ed0: 7665 204d 4241 522f 5557 4841 4d20 6571  ve MBAR/UWHAM eq
-00004ee0: 7561 7469 6f6e 7320 616e 6420 636f 6d70  uations and comp
-00004ef0: 7574 6520 7468 6520 504d 4694 8594 8194  ute the PMF.....
-00004f00: 7d94 6a5a 0300 006a 5605 0000 7362 616a  }.jZ...jV...sbaj
-00004f10: 5b03 0000 7d94 286a 5d03 0000 5d94 6a5f  [...}.(j]...].j_
-00004f20: 0300 005d 946a 6103 0000 5d94 6a63 0300  ...].ja...].jc..
-00004f30: 005d 946a 6503 0000 5d94 8c08 696e 7465  .].je...]...inte
-00004f40: 726e 616c 9488 8c06 7265 6675 7269 946a  rnal....refuri.j
-00004f50: 1e03 0000 8c0a 616e 6368 6f72 6e61 6d65  ......anchorname
-00004f60: 948c 3f23 7573 652d 6661 7374 6d62 6172  ..?#use-fastmbar
-00004f70: 2d74 6f2d 736f 6c76 652d 6d62 6172 2d75  -to-solve-mbar-u
-00004f80: 7768 616d 2d65 7175 6174 696f 6e73 2d61  wham-equations-a
-00004f90: 6e64 2d63 6f6d 7075 7465 2d74 6865 2d70  nd-compute-the-p
-00004fa0: 6d66 9475 6a67 0300 006a ef03 0000 6a5a  mf.ujg...j....jZ
-00004fb0: 0300 006a 5305 0000 7562 616a 5b03 0000  ...jS...ubaj[...
-00004fc0: 7d94 286a 5d03 0000 5d94 6a5f 0300 005d  }.(j]...].j_...]
-00004fd0: 946a 6103 0000 5d94 6a63 0300 005d 946a  .ja...].jc...].j
-00004fe0: 6503 0000 5d94 756a 6703 0000 6af6 0300  e...].ujg...j...
-00004ff0: 006a 5a03 0000 6a50 0500 0075 6261 6a5b  .jZ...jP...ubaj[
-00005000: 0300 007d 9428 6a5d 0300 005d 946a 5f03  ...}.(j]...].j_.
-00005010: 0000 5d94 6a61 0300 005d 946a 6303 0000  ..].ja...].jc...
-00005020: 5d94 6a65 0300 005d 9475 6a67 0300 006a  ].je...].ujg...j
-00005030: fd03 0000 6a5a 0300 006a e404 0000 7562  ....jZ...j....ub
-00005040: 656a 5b03 0000 7d94 286a 5d03 0000 5d94  ej[...}.(j]...].
-00005050: 6a5f 0300 005d 946a 6103 0000 5d94 6a63  j_...].ja...].jc
-00005060: 0300 005d 946a 6503 0000 5d94 756a 6703  ...].je...].ujg.
-00005070: 0000 6a04 0400 006a 5a03 0000 6ac8 0400  ..j....jZ...j...
-00005080: 0075 6265 6a5b 0300 007d 9428 6a5d 0300  .ubej[...}.(j]..
-00005090: 005d 946a 5f03 0000 5d94 6a61 0300 005d  .].j_...].ja...]
-000050a0: 946a 6303 0000 5d94 6a65 0300 005d 9475  .jc...].je...].u
-000050b0: 6a67 0300 006a fd03 0000 6a5a 0300 006a  jg...j....jZ...j
-000050c0: c504 0000 7562 616a 5b03 0000 7d94 286a  ....ubaj[...}.(j
-000050d0: 5d03 0000 5d94 6a5f 0300 005d 946a 6103  ]...].j_...].ja.
-000050e0: 0000 5d94 6a63 0300 005d 946a 6503 0000  ..].jc...].je...
-000050f0: 5d94 756a 6703 0000 6a04 0400 0075 626a  ].ujg...j....ubj
-00005100: 1f03 0000 6ace 0300 0029 8194 7d94 286a  ....j....)..}.(j
-00005110: 5103 0000 686c 6a52 0300 005d 946a d303  Q...hljR...].j..
-00005120: 0000 2981 947d 9428 6a51 0300 0068 6c6a  ..)..}.(jQ...hlj
-00005130: 5203 0000 5d94 286a d903 0000 2981 947d  R...].(j....)..}
-00005140: 9428 6a51 0300 0068 6c6a 5203 0000 5d94  .(jQ...hljR...].
-00005150: 6ade 0300 0029 8194 7d94 286a 5103 0000  j....)..}.(jQ...
-00005160: 686c 6a52 0300 005d 946a 5503 0000 8c08  hljR...].jU.....
-00005170: 4578 616d 706c 6573 9485 9481 947d 946a  Examples.....}.j
-00005180: 5a03 0000 6a8e 0500 0073 6261 6a5b 0300  Z...j....sbaj[..
-00005190: 007d 9428 6a5d 0300 005d 946a 5f03 0000  .}.(j]...].j_...
-000051a0: 5d94 6a61 0300 005d 946a 6303 0000 5d94  ].ja...].jc...].
-000051b0: 6a65 0300 005d 948c 0869 6e74 6572 6e61  je...]...interna
-000051c0: 6c94 888c 0672 6566 7572 6994 6a1f 0300  l....refuri.j...
-000051d0: 008c 0a61 6e63 686f 726e 616d 6594 686c  ...anchorname.hl
-000051e0: 756a 6703 0000 6aef 0300 006a 5a03 0000  ujg...j....jZ...
-000051f0: 6a8b 0500 0075 6261 6a5b 0300 007d 9428  j....ubaj[...}.(
-00005200: 6a5d 0300 005d 946a 5f03 0000 5d94 6a61  j]...].j_...].ja
-00005210: 0300 005d 946a 6303 0000 5d94 6a65 0300  ...].jc...].je..
-00005220: 005d 9475 6a67 0300 006a f603 0000 6a5a  .].ujg...j....jZ
-00005230: 0300 006a 8805 0000 7562 6ace 0300 0029  ...j....ubj....)
-00005240: 8194 7d94 286a 5103 0000 686c 6a52 0300  ..}.(jQ...hljR..
-00005250: 005d 9428 6ad3 0300 0029 8194 7d94 286a  .].(j....)..}.(j
-00005260: 5103 0000 686c 6a52 0300 005d 946a d903  Q...hljR...].j..
-00005270: 0000 2981 947d 9428 6a51 0300 0068 6c6a  ..)..}.(jQ...hlj
-00005280: 5203 0000 5d94 6ade 0300 0029 8194 7d94  R...].j....)..}.
-00005290: 286a 5103 0000 686c 6a52 0300 005d 946a  (jQ...hljR...].j
-000052a0: 5503 0000 8c25 496e 7374 616c 6c20 4578  U....%Install Ex
-000052b0: 7472 6120 5265 7175 6972 6564 2050 7974  tra Required Pyt
-000052c0: 686f 6e20 5061 636b 6765 7394 8594 8194  hon Packges.....
-000052d0: 7d94 6a5a 0300 006a ad05 0000 7362 616a  }.jZ...j....sbaj
-000052e0: 5b03 0000 7d94 286a 5d03 0000 5d94 6a5f  [...}.(j]...].j_
-000052f0: 0300 005d 946a 6103 0000 5d94 6a63 0300  ...].ja...].jc..
-00005300: 005d 946a 6503 0000 5d94 8c08 696e 7465  .].je...]...inte
-00005310: 726e 616c 9488 8c06 7265 6675 7269 946a  rnal....refuri.j
-00005320: 1f03 0000 8c0a 616e 6368 6f72 6e61 6d65  ......anchorname
-00005330: 948c 2623 696e 7374 616c 6c2d 6578 7472  ..&#install-extr
-00005340: 612d 7265 7175 6972 6564 2d70 7974 686f  a-required-pytho
-00005350: 6e2d 7061 636b 6765 7394 756a 6703 0000  n-packges.ujg...
-00005360: 6aef 0300 006a 5a03 0000 6aaa 0500 0075  j....jZ...j....u
-00005370: 6261 6a5b 0300 007d 9428 6a5d 0300 005d  baj[...}.(j]...]
-00005380: 946a 5f03 0000 5d94 6a61 0300 005d 946a  .j_...].ja...].j
-00005390: 6303 0000 5d94 6a65 0300 005d 9475 6a67  c...].je...].ujg
-000053a0: 0300 006a f603 0000 6a5a 0300 006a a705  ...j....jZ...j..
-000053b0: 0000 7562 616a 5b03 0000 7d94 286a 5d03  ..ubaj[...}.(j].
-000053c0: 0000 5d94 6a5f 0300 005d 946a 6103 0000  ..].j_...].ja...
-000053d0: 5d94 6a63 0300 005d 946a 6503 0000 5d94  ].jc...].je...].
-000053e0: 756a 6703 0000 6afd 0300 006a 5a03 0000  ujg...j....jZ...
-000053f0: 6aa4 0500 0075 626a d303 0000 2981 947d  j....ubj....)..}
-00005400: 9428 6a51 0300 0068 6c6a 5203 0000 5d94  .(jQ...hljR...].
-00005410: 286a d903 0000 2981 947d 9428 6a51 0300  (j....)..}.(jQ..
-00005420: 0068 6c6a 5203 0000 5d94 6ade 0300 0029  .hljR...].j....)
-00005430: 8194 7d94 286a 5103 0000 686c 6a52 0300  ..}.(jQ...hljR..
-00005440: 005d 946a 5503 0000 8c08 4578 616d 706c  .].jU.....Exampl
-00005450: 6573 9485 9481 947d 946a 5a03 0000 6ad0  es.....}.jZ...j.
-00005460: 0500 0073 6261 6a5b 0300 007d 9428 6a5d  ...sbaj[...}.(j]
-00005470: 0300 005d 946a 5f03 0000 5d94 6a61 0300  ...].j_...].ja..
-00005480: 005d 946a 6303 0000 5d94 6a65 0300 005d  .].jc...].je...]
-00005490: 948c 0869 6e74 6572 6e61 6c94 888c 0672  ...internal....r
-000054a0: 6566 7572 6994 6a1f 0300 008c 0a61 6e63  efuri.j......anc
-000054b0: 686f 726e 616d 6594 8c04 2369 6432 9475  horname...#id2.u
-000054c0: 6a67 0300 006a ef03 0000 6a5a 0300 006a  jg...j....jZ...j
-000054d0: cd05 0000 7562 616a 5b03 0000 7d94 286a  ....ubaj[...}.(j
-000054e0: 5d03 0000 5d94 6a5f 0300 005d 946a 6103  ]...].j_...].ja.
-000054f0: 0000 5d94 6a63 0300 005d 946a 6503 0000  ..].jc...].je...
-00005500: 5d94 756a 6703 0000 6af6 0300 006a 5a03  ].ujg...j....jZ.
-00005510: 0000 6aca 0500 0075 626a ce03 0000 2981  ..j....ubj....).
-00005520: 947d 9428 6a51 0300 0068 6c6a 5203 0000  .}.(jQ...hljR...
-00005530: 5d94 6ad7 0300 008c 0774 6f63 7472 6565  ].j......toctree
-00005540: 9493 9429 8194 7d94 286a 5103 0000 686c  ...)..}.(jQ...hl
-00005550: 6a52 0300 005d 946a 5b03 0000 7d94 286a  jR...].j[...}.(j
-00005560: 5d03 0000 5d94 6a5f 0300 005d 946a 6103  ]...].j_...].ja.
-00005570: 0000 5d94 6a63 0300 005d 946a 6503 0000  ..].jc...].je...
-00005580: 5d94 8c06 7061 7265 6e74 946a 1f03 0000  ]...parent.j....
-00005590: 8c07 656e 7472 6965 7394 5d94 284e 8c0a  ..entries.].(N..
-000055a0: 6275 7461 6e65 5f50 4d46 9486 944e 8c0d  butane_PMF...N..
-000055b0: 6469 616c 616e 696e 655f 504d 4694 8694  dialanine_PMF...
-000055c0: 658c 0c69 6e63 6c75 6465 6669 6c65 7394  e..includefiles.
-000055d0: 5d94 286a f805 0000 6afa 0500 0065 8c08  ].(j....j....e..
-000055e0: 6d61 7864 6570 7468 944b 018c 0763 6170  maxdepth.K...cap
-000055f0: 7469 6f6e 944e 8c04 676c 6f62 9489 8c06  tion.N..glob....
-00005600: 6869 6464 656e 9489 8c0d 696e 636c 7564  hidden....includ
-00005610: 6568 6964 6465 6e94 898c 086e 756d 6265  ehidden....numbe
-00005620: 7265 6494 4b00 8c0a 7469 746c 6573 6f6e  red.K...titleson
-00005630: 6c79 9489 8c0a 7261 7765 6e74 7269 6573  ly....rawentries
-00005640: 945d 9475 6a67 0300 008c 0774 6f63 7472  .].ujg.....toctr
-00005650: 6565 948c 0673 6f75 7263 6594 8c68 2f55  ee...source..h/U
-00005660: 7365 7273 2f64 696e 6778 712f 4c69 6272  sers/dingxq/Libr
-00005670: 6172 792f 436c 6f75 6453 746f 7261 6765  ary/CloudStorage
-00005680: 2f42 6f78 2d42 6f78 2f52 6573 6561 7263  /Box-Box/Researc
-00005690: 682f 5072 6f6a 6563 7473 5f6f 6e5f 4769  h/Projects_on_Gi
-000056a0: 7468 7562 2f46 6173 744d 4241 522f 646f  thub/FastMBAR/do
-000056b0: 6373 2f73 6f75 7263 652f 6578 616d 706c  cs/source/exampl
-000056c0: 6573 2e72 7374 948c 046c 696e 6594 4b2e  es.rst...line.K.
-000056d0: 6a5a 0300 006a e705 0000 7562 616a 5b03  jZ...j....ubaj[.
-000056e0: 0000 7d94 286a 5d03 0000 5d94 6a5f 0300  ..}.(j]...].j_..
-000056f0: 005d 946a 6103 0000 5d94 6a63 0300 005d  .].ja...].jc...]
-00005700: 946a 6503 0000 5d94 756a 6703 0000 6a04  .je...].ujg...j.
-00005710: 0400 006a 5a03 0000 6aca 0500 0075 6265  ...jZ...j....ube
-00005720: 6a5b 0300 007d 9428 6a5d 0300 005d 946a  j[...}.(j]...].j
-00005730: 5f03 0000 5d94 6a61 0300 005d 946a 6303  _...].ja...].jc.
-00005740: 0000 5d94 6a65 0300 005d 9475 6a67 0300  ..].je...].ujg..
-00005750: 006a fd03 0000 6a5a 0300 006a a405 0000  .j....jZ...j....
-00005760: 7562 656a 5b03 0000 7d94 286a 5d03 0000  ubej[...}.(j]...
-00005770: 5d94 6a5f 0300 005d 946a 6103 0000 5d94  ].j_...].ja...].
-00005780: 6a63 0300 005d 946a 6503 0000 5d94 756a  jc...].je...].uj
-00005790: 6703 0000 6a04 0400 006a 5a03 0000 6a88  g...j....jZ...j.
-000057a0: 0500 0075 6265 6a5b 0300 007d 9428 6a5d  ...ubej[...}.(j]
-000057b0: 0300 005d 946a 5f03 0000 5d94 6a61 0300  ...].j_...].ja..
-000057c0: 005d 946a 6303 0000 5d94 6a65 0300 005d  .].jc...].je...]
-000057d0: 9475 6a67 0300 006a fd03 0000 6a5a 0300  .ujg...j....jZ..
-000057e0: 006a 8505 0000 7562 616a 5b03 0000 7d94  .j....ubaj[...}.
-000057f0: 286a 5d03 0000 5d94 6a5f 0300 005d 946a  (j]...].j_...].j
-00005800: 6103 0000 5d94 6a63 0300 005d 946a 6503  a...].jc...].je.
-00005810: 0000 5d94 756a 6703 0000 6a04 0400 0075  ..].ujg...j....u
-00005820: 626a 2003 0000 6ace 0300 0029 8194 7d94  bj ...j....)..}.
-00005830: 286a 5103 0000 686c 6a52 0300 005d 946a  (jQ...hljR...].j
-00005840: d303 0000 2981 947d 9428 6a51 0300 0068  ....)..}.(jQ...h
-00005850: 6c6a 5203 0000 5d94 286a d903 0000 2981  ljR...].(j....).
-00005860: 947d 9428 6a51 0300 0068 6c6a 5203 0000  .}.(jQ...hljR...
-00005870: 5d94 6ade 0300 0029 8194 7d94 286a 5103  ].j....)..}.(jQ.
-00005880: 0000 686c 6a52 0300 005d 946a 5503 0000  ..hljR...].jU...
-00005890: 8c14 5765 6c63 6f6d 6520 746f 2046 6173  ..Welcome to Fas
-000058a0: 744d 4241 5221 9485 9481 947d 946a 5a03  tMBAR!.....}.jZ.
-000058b0: 0000 6a32 0600 0073 6261 6a5b 0300 007d  ..j2...sbaj[...}
-000058c0: 9428 6a5d 0300 005d 946a 5f03 0000 5d94  .(j]...].j_...].
-000058d0: 6a61 0300 005d 946a 6303 0000 5d94 6a65  ja...].jc...].je
-000058e0: 0300 005d 948c 0869 6e74 6572 6e61 6c94  ...]...internal.
-000058f0: 888c 0672 6566 7572 6994 6a20 0300 008c  ...refuri.j ....
-00005900: 0a61 6e63 686f 726e 616d 6594 686c 756a  .anchorname.hluj
-00005910: 6703 0000 6aef 0300 006a 5a03 0000 6a2f  g...j....jZ...j/
-00005920: 0600 0075 6261 6a5b 0300 007d 9428 6a5d  ...ubaj[...}.(j]
-00005930: 0300 005d 946a 5f03 0000 5d94 6a61 0300  ...].j_...].ja..
-00005940: 005d 946a 6303 0000 5d94 6a65 0300 005d  .].jc...].je...]
-00005950: 9475 6a67 0300 006a f603 0000 6a5a 0300  .ujg...j....jZ..
-00005960: 006a 2c06 0000 7562 6ace 0300 0029 8194  .j,...ubj....)..
-00005970: 7d94 286a 5103 0000 686c 6a52 0300 005d  }.(jQ...hljR...]
-00005980: 9428 6ad3 0300 0029 8194 7d94 286a 5103  .(j....)..}.(jQ.
-00005990: 0000 686c 6a52 0300 005d 946a d903 0000  ..hljR...].j....
-000059a0: 2981 947d 9428 6a51 0300 0068 6c6a 5203  )..}.(jQ...hljR.
-000059b0: 0000 5d94 6ade 0300 0029 8194 7d94 286a  ..].j....)..}.(j
-000059c0: 5103 0000 686c 6a52 0300 005d 946a 5503  Q...hljR...].jU.
-000059d0: 0000 8c11 5768 6174 2069 7320 4661 7374  ....What is Fast
-000059e0: 4d42 4152 3f94 8594 8194 7d94 6a5a 0300  MBAR?.....}.jZ..
-000059f0: 006a 5106 0000 7362 616a 5b03 0000 7d94  .jQ...sbaj[...}.
-00005a00: 286a 5d03 0000 5d94 6a5f 0300 005d 946a  (j]...].j_...].j
-00005a10: 6103 0000 5d94 6a63 0300 005d 946a 6503  a...].jc...].je.
-00005a20: 0000 5d94 8c08 696e 7465 726e 616c 9488  ..]...internal..
-00005a30: 8c06 7265 6675 7269 946a 2003 0000 8c0a  ..refuri.j .....
-00005a40: 616e 6368 6f72 6e61 6d65 948c 1123 7768  anchorname...#wh
-00005a50: 6174 2d69 732d 6661 7374 6d62 6172 9475  at-is-fastmbar.u
-00005a60: 6a67 0300 006a ef03 0000 6a5a 0300 006a  jg...j....jZ...j
-00005a70: 4e06 0000 7562 616a 5b03 0000 7d94 286a  N...ubaj[...}.(j
-00005a80: 5d03 0000 5d94 6a5f 0300 005d 946a 6103  ]...].j_...].ja.
-00005a90: 0000 5d94 6a63 0300 005d 946a 6503 0000  ..].jc...].je...
-00005aa0: 5d94 756a 6703 0000 6af6 0300 006a 5a03  ].ujg...j....jZ.
-00005ab0: 0000 6a4b 0600 0075 6261 6a5b 0300 007d  ..jK...ubaj[...}
-00005ac0: 9428 6a5d 0300 005d 946a 5f03 0000 5d94  .(j]...].j_...].
-00005ad0: 6a61 0300 005d 946a 6303 0000 5d94 6a65  ja...].jc...].je
-00005ae0: 0300 005d 9475 6a67 0300 006a fd03 0000  ...].ujg...j....
-00005af0: 6a5a 0300 006a 4806 0000 7562 6ad3 0300  jZ...jH...ubj...
-00005b00: 0029 8194 7d94 286a 5103 0000 686c 6a52  .)..}.(jQ...hljR
-00005b10: 0300 005d 946a d903 0000 2981 947d 9428  ...].j....)..}.(
-00005b20: 6a51 0300 0068 6c6a 5203 0000 5d94 6ade  jQ...hljR...].j.
-00005b30: 0300 0029 8194 7d94 286a 5103 0000 686c  ...)..}.(jQ...hl
-00005b40: 6a52 0300 005d 946a 5503 0000 8c0d 5768  jR...].jU.....Wh
-00005b50: 7920 4661 7374 4d42 4152 3f94 8594 8194  y FastMBAR?.....
-00005b60: 7d94 6a5a 0300 006a 7406 0000 7362 616a  }.jZ...jt...sbaj
-00005b70: 5b03 0000 7d94 286a 5d03 0000 5d94 6a5f  [...}.(j]...].j_
-00005b80: 0300 005d 946a 6103 0000 5d94 6a63 0300  ...].ja...].jc..
-00005b90: 005d 946a 6503 0000 5d94 8c08 696e 7465  .].je...]...inte
-00005ba0: 726e 616c 9488 8c06 7265 6675 7269 946a  rnal....refuri.j
-00005bb0: 2003 0000 8c0a 616e 6368 6f72 6e61 6d65   .....anchorname
-00005bc0: 948c 0d23 7768 792d 6661 7374 6d62 6172  ...#why-fastmbar
-00005bd0: 9475 6a67 0300 006a ef03 0000 6a5a 0300  .ujg...j....jZ..
-00005be0: 006a 7106 0000 7562 616a 5b03 0000 7d94  .jq...ubaj[...}.
-00005bf0: 286a 5d03 0000 5d94 6a5f 0300 005d 946a  (j]...].j_...].j
-00005c00: 6103 0000 5d94 6a63 0300 005d 946a 6503  a...].jc...].je.
-00005c10: 0000 5d94 756a 6703 0000 6af6 0300 006a  ..].ujg...j....j
-00005c20: 5a03 0000 6a6e 0600 0075 6261 6a5b 0300  Z...jn...ubaj[..
-00005c30: 007d 9428 6a5d 0300 005d 946a 5f03 0000  .}.(j]...].j_...
-00005c40: 5d94 6a61 0300 005d 946a 6303 0000 5d94  ].ja...].jc...].
-00005c50: 6a65 0300 005d 9475 6a67 0300 006a fd03  je...].ujg...j..
-00005c60: 0000 6a5a 0300 006a 4806 0000 7562 6ad3  ..jZ...jH...ubj.
-00005c70: 0300 0029 8194 7d94 286a 5103 0000 686c  ...)..}.(jQ...hl
-00005c80: 6a52 0300 005d 9428 6ad9 0300 0029 8194  jR...].(j....)..
-00005c90: 7d94 286a 5103 0000 686c 6a52 0300 005d  }.(jQ...hljR...]
-00005ca0: 946a de03 0000 2981 947d 9428 6a51 0300  .j....)..}.(jQ..
-00005cb0: 0068 6c6a 5203 0000 5d94 6a55 0300 008c  .hljR...].jU....
-00005cc0: 1448 6f77 2074 6f20 7573 6520 4661 7374  .How to use Fast
-00005cd0: 4d42 4152 3f94 8594 8194 7d94 6a5a 0300  MBAR?.....}.jZ..
-00005ce0: 006a 9706 0000 7362 616a 5b03 0000 7d94  .j....sbaj[...}.
-00005cf0: 286a 5d03 0000 5d94 6a5f 0300 005d 946a  (j]...].j_...].j
-00005d00: 6103 0000 5d94 6a63 0300 005d 946a 6503  a...].jc...].je.
-00005d10: 0000 5d94 8c08 696e 7465 726e 616c 9488  ..]...internal..
-00005d20: 8c06 7265 6675 7269 946a 2003 0000 8c0a  ..refuri.j .....
-00005d30: 616e 6368 6f72 6e61 6d65 948c 1423 686f  anchorname...#ho
-00005d40: 772d 746f 2d75 7365 2d66 6173 746d 6261  w-to-use-fastmba
-00005d50: 7294 756a 6703 0000 6aef 0300 006a 5a03  r.ujg...j....jZ.
-00005d60: 0000 6a94 0600 0075 6261 6a5b 0300 007d  ..j....ubaj[...}
-00005d70: 9428 6a5d 0300 005d 946a 5f03 0000 5d94  .(j]...].j_...].
-00005d80: 6a61 0300 005d 946a 6303 0000 5d94 6a65  ja...].jc...].je
-00005d90: 0300 005d 9475 6a67 0300 006a f603 0000  ...].ujg...j....
-00005da0: 6a5a 0300 006a 9106 0000 7562 6ace 0300  jZ...j....ubj...
-00005db0: 0029 8194 7d94 286a 5103 0000 686c 6a52  .)..}.(jQ...hljR
-00005dc0: 0300 005d 946a eb05 0000 2981 947d 9428  ...].j....)..}.(
-00005dd0: 6a51 0300 0068 6c6a 5203 0000 5d94 6a5b  jQ...hljR...].j[
-00005de0: 0300 007d 9428 6a5d 0300 005d 946a 5f03  ...}.(j]...].j_.
-00005df0: 0000 5d94 6a61 0300 005d 946a 6303 0000  ..].ja...].jc...
-00005e00: 5d94 6a65 0300 005d 948c 0670 6172 656e  ].je...]...paren
-00005e10: 7494 6a20 0300 008c 0765 6e74 7269 6573  t.j .....entries
-00005e20: 945d 9428 4e8c 0c69 6e73 7461 6c6c 6174  .].(N..installat
-00005e30: 696f 6e94 8694 4e8c 0575 7361 6765 9486  ion...N..usage..
-00005e40: 944e 8c03 4150 4994 8694 4e8c 0865 7861  .N..API...N..exa
-00005e50: 6d70 6c65 7394 8694 4e8c 0a72 6566 6572  mples...N..refer
-00005e60: 656e 6365 7394 8694 658c 0c69 6e63 6c75  ences...e..inclu
-00005e70: 6465 6669 6c65 7394 5d94 286a bd06 0000  defiles.].(j....
-00005e80: 6abf 0600 006a c106 0000 6ac3 0600 006a  j....j....j....j
-00005e90: c506 0000 658c 086d 6178 6465 7074 6894  ....e..maxdepth.
-00005ea0: 4b02 8c07 6361 7074 696f 6e94 4e8c 0467  K...caption.N..g
-00005eb0: 6c6f 6294 898c 0668 6964 6465 6e94 898c  lob....hidden...
-00005ec0: 0d69 6e63 6c75 6465 6869 6464 656e 9489  .includehidden..
-00005ed0: 8c08 6e75 6d62 6572 6564 944b 008c 0a74  ..numbered.K...t
-00005ee0: 6974 6c65 736f 6e6c 7994 898c 0a72 6177  itlesonly....raw
-00005ef0: 656e 7472 6965 7394 5d94 756a 6703 0000  entries.].ujg...
-00005f00: 6a07 0600 006a 0806 0000 8c65 2f55 7365  j....j.....e/Use
-00005f10: 7273 2f64 696e 6778 712f 4c69 6272 6172  rs/dingxq/Librar
-00005f20: 792f 436c 6f75 6453 746f 7261 6765 2f42  y/CloudStorage/B
-00005f30: 6f78 2d42 6f78 2f52 6573 6561 7263 682f  ox-Box/Research/
-00005f40: 5072 6f6a 6563 7473 5f6f 6e5f 4769 7468  Projects_on_Gith
-00005f50: 7562 2f46 6173 744d 4241 522f 646f 6373  ub/FastMBAR/docs
-00005f60: 2f73 6f75 7263 652f 696e 6465 782e 7273  /source/index.rs
-00005f70: 7494 6a0a 0600 004b 206a 5a03 0000 6aae  t.j....K jZ...j.
-00005f80: 0600 0075 6261 6a5b 0300 007d 9428 6a5d  ...ubaj[...}.(j]
-00005f90: 0300 005d 946a 5f03 0000 5d94 6a61 0300  ...].j_...].ja..
-00005fa0: 005d 946a 6303 0000 5d94 6a65 0300 005d  .].jc...].je...]
-00005fb0: 9475 6a67 0300 006a 0404 0000 6a5a 0300  .ujg...j....jZ..
-00005fc0: 006a 9106 0000 7562 656a 5b03 0000 7d94  .j....ubej[...}.
-00005fd0: 286a 5d03 0000 5d94 6a5f 0300 005d 946a  (j]...].j_...].j
-00005fe0: 6103 0000 5d94 6a63 0300 005d 946a 6503  a...].jc...].je.
-00005ff0: 0000 5d94 756a 6703 0000 6afd 0300 006a  ..].ujg...j....j
-00006000: 5a03 0000 6a48 0600 0075 6265 6a5b 0300  Z...jH...ubej[..
-00006010: 007d 9428 6a5d 0300 005d 946a 5f03 0000  .}.(j]...].j_...
-00006020: 5d94 6a61 0300 005d 946a 6303 0000 5d94  ].ja...].jc...].
-00006030: 6a65 0300 005d 9475 6a67 0300 006a 0404  je...].ujg...j..
-00006040: 0000 6a5a 0300 006a 2c06 0000 7562 656a  ..jZ...j,...ubej
-00006050: 5b03 0000 7d94 286a 5d03 0000 5d94 6a5f  [...}.(j]...].j_
-00006060: 0300 005d 946a 6103 0000 5d94 6a63 0300  ...].ja...].jc..
-00006070: 005d 946a 6503 0000 5d94 756a 6703 0000  .].je...].ujg...
-00006080: 6afd 0300 006a 5a03 0000 6a29 0600 0075  j....jZ...j)...u
-00006090: 6261 6a5b 0300 007d 9428 6a5d 0300 005d  baj[...}.(j]...]
-000060a0: 946a 5f03 0000 5d94 6a61 0300 005d 946a  .j_...].ja...].j
-000060b0: 6303 0000 5d94 6a65 0300 005d 9475 6a67  c...].je...].ujg
-000060c0: 0300 006a 0404 0000 7562 6a21 0300 006a  ...j....ubj!...j
-000060d0: ce03 0000 2981 947d 9428 6a51 0300 0068  ....)..}.(jQ...h
-000060e0: 6c6a 5203 0000 5d94 6ad3 0300 0029 8194  ljR...].j....)..
-000060f0: 7d94 286a 5103 0000 686c 6a52 0300 005d  }.(jQ...hljR...]
-00006100: 946a d903 0000 2981 947d 9428 6a51 0300  .j....)..}.(jQ..
-00006110: 0068 6c6a 5203 0000 5d94 6ade 0300 0029  .hljR...].j....)
-00006120: 8194 7d94 286a 5103 0000 686c 6a52 0300  ..}.(jQ...hljR..
-00006130: 005d 946a 5503 0000 8c0a 5265 6665 7265  .].jU.....Refere
-00006140: 6e63 6573 9485 9481 947d 946a 5a03 0000  nces.....}.jZ...
-00006150: 6afa 0600 0073 6261 6a5b 0300 007d 9428  j....sbaj[...}.(
-00006160: 6a5d 0300 005d 946a 5f03 0000 5d94 6a61  j]...].j_...].ja
-00006170: 0300 005d 946a 6303 0000 5d94 6a65 0300  ...].jc...].je..
-00006180: 005d 948c 0869 6e74 6572 6e61 6c94 888c  .]...internal...
-00006190: 0672 6566 7572 6994 6a21 0300 008c 0a61  .refuri.j!.....a
-000061a0: 6e63 686f 726e 616d 6594 686c 756a 6703  nchorname.hlujg.
-000061b0: 0000 6aef 0300 006a 5a03 0000 6af7 0600  ..j....jZ...j...
-000061c0: 0075 6261 6a5b 0300 007d 9428 6a5d 0300  .ubaj[...}.(j]..
-000061d0: 005d 946a 5f03 0000 5d94 6a61 0300 005d  .].j_...].ja...]
-000061e0: 946a 6303 0000 5d94 6a65 0300 005d 9475  .jc...].je...].u
-000061f0: 6a67 0300 006a f603 0000 6a5a 0300 006a  jg...j....jZ...j
-00006200: f406 0000 7562 616a 5b03 0000 7d94 286a  ....ubaj[...}.(j
-00006210: 5d03 0000 5d94 6a5f 0300 005d 946a 6103  ]...].j_...].ja.
-00006220: 0000 5d94 6a63 0300 005d 946a 6503 0000  ..].jc...].je...
-00006230: 5d94 756a 6703 0000 6afd 0300 006a 5a03  ].ujg...j....jZ.
-00006240: 0000 6af1 0600 0075 6261 6a5b 0300 007d  ..j....ubaj[...}
-00006250: 9428 6a5d 0300 005d 946a 5f03 0000 5d94  .(j]...].j_...].
-00006260: 6a61 0300 005d 946a 6303 0000 5d94 6a65  ja...].jc...].je
-00006270: 0300 005d 9475 6a67 0300 006a 0404 0000  ...].ujg...j....
-00006280: 7562 6a22 0300 006a ce03 0000 2981 947d  ubj"...j....)..}
-00006290: 9428 6a51 0300 0068 6c6a 5203 0000 5d94  .(jQ...hljR...].
-000062a0: 6ad3 0300 0029 8194 7d94 286a 5103 0000  j....)..}.(jQ...
-000062b0: 686c 6a52 0300 005d 9428 6ad9 0300 0029  hljR...].(j....)
-000062c0: 8194 7d94 286a 5103 0000 686c 6a52 0300  ..}.(jQ...hljR..
-000062d0: 005d 946a de03 0000 2981 947d 9428 6a51  .].j....)..}.(jQ
-000062e0: 0300 0068 6c6a 5203 0000 5d94 6a55 0300  ...hljR...].jU..
-000062f0: 008c 0555 7361 6765 9485 9481 947d 946a  ...Usage.....}.j
-00006300: 5a03 0000 6a25 0700 0073 6261 6a5b 0300  Z...j%...sbaj[..
-00006310: 007d 9428 6a5d 0300 005d 946a 5f03 0000  .}.(j]...].j_...
-00006320: 5d94 6a61 0300 005d 946a 6303 0000 5d94  ].ja...].jc...].
-00006330: 6a65 0300 005d 948c 0869 6e74 6572 6e61  je...]...interna
-00006340: 6c94 888c 0672 6566 7572 6994 6a22 0300  l....refuri.j"..
-00006350: 008c 0a61 6e63 686f 726e 616d 6594 686c  ...anchorname.hl
-00006360: 756a 6703 0000 6aef 0300 006a 5a03 0000  ujg...j....jZ...
-00006370: 6a22 0700 0075 6261 6a5b 0300 007d 9428  j"...ubaj[...}.(
-00006380: 6a5d 0300 005d 946a 5f03 0000 5d94 6a61  j]...].j_...].ja
-00006390: 0300 005d 946a 6303 0000 5d94 6a65 0300  ...].jc...].je..
-000063a0: 005d 9475 6a67 0300 006a f603 0000 6a5a  .].ujg...j....jZ
-000063b0: 0300 006a 1f07 0000 7562 6ace 0300 0029  ...j....ubj....)
-000063c0: 8194 7d94 286a 5103 0000 686c 6a52 0300  ..}.(jQ...hljR..
-000063d0: 005d 9428 6ad3 0300 0029 8194 7d94 286a  .].(j....)..}.(j
-000063e0: 5103 0000 686c 6a52 0300 005d 946a d903  Q...hljR...].j..
-000063f0: 0000 2981 947d 9428 6a51 0300 0068 6c6a  ..)..}.(jQ...hlj
-00006400: 5203 0000 5d94 6ade 0300 0029 8194 7d94  R...].j....)..}.
-00006410: 286a 5103 0000 686c 6a52 0300 005d 946a  (jQ...hljR...].j
-00006420: 5503 0000 8c1e 312e 2057 6865 6e20 746f  U.....1. When to
-00006430: 2075 7365 204d 4241 5220 6571 7561 7469   use MBAR equati
-00006440: 6f6e 733f 9485 9481 947d 946a 5a03 0000  ons?.....}.jZ...
-00006450: 6a44 0700 0073 6261 6a5b 0300 007d 9428  jD...sbaj[...}.(
-00006460: 6a5d 0300 005d 946a 5f03 0000 5d94 6a61  j]...].j_...].ja
-00006470: 0300 005d 946a 6303 0000 5d94 6a65 0300  ...].jc...].je..
-00006480: 005d 948c 0869 6e74 6572 6e61 6c94 888c  .]...internal...
-00006490: 0672 6566 7572 6994 6a22 0300 008c 0a61  .refuri.j".....a
-000064a0: 6e63 686f 726e 616d 6594 8c1b 2377 6865  nchorname...#whe
-000064b0: 6e2d 746f 2d75 7365 2d6d 6261 722d 6571  n-to-use-mbar-eq
-000064c0: 7561 7469 6f6e 7394 756a 6703 0000 6aef  uations.ujg...j.
-000064d0: 0300 006a 5a03 0000 6a41 0700 0075 6261  ...jZ...jA...uba
-000064e0: 6a5b 0300 007d 9428 6a5d 0300 005d 946a  j[...}.(j]...].j
-000064f0: 5f03 0000 5d94 6a61 0300 005d 946a 6303  _...].ja...].jc.
-00006500: 0000 5d94 6a65 0300 005d 9475 6a67 0300  ..].je...].ujg..
-00006510: 006a f603 0000 6a5a 0300 006a 3e07 0000  .j....jZ...j>...
-00006520: 7562 616a 5b03 0000 7d94 286a 5d03 0000  ubaj[...}.(j]...
-00006530: 5d94 6a5f 0300 005d 946a 6103 0000 5d94  ].j_...].ja...].
-00006540: 6a63 0300 005d 946a 6503 0000 5d94 756a  jc...].je...].uj
-00006550: 6703 0000 6afd 0300 006a 5a03 0000 6a3b  g...j....jZ...j;
-00006560: 0700 0075 626a d303 0000 2981 947d 9428  ...ubj....)..}.(
-00006570: 6a51 0300 0068 6c6a 5203 0000 5d94 6ad9  jQ...hljR...].j.
-00006580: 0300 0029 8194 7d94 286a 5103 0000 686c  ...)..}.(jQ...hl
-00006590: 6a52 0300 005d 946a de03 0000 2981 947d  jR...].j....)..}
-000065a0: 9428 6a51 0300 0068 6c6a 5203 0000 5d94  .(jQ...hljR...].
-000065b0: 6a55 0300 008c 1732 2e20 486f 7720 746f  jU.....2. How to
-000065c0: 2075 7365 2046 6173 744d 4241 523f 9485   use FastMBAR?..
-000065d0: 9481 947d 946a 5a03 0000 6a67 0700 0073  ...}.jZ...jg...s
-000065e0: 6261 6a5b 0300 007d 9428 6a5d 0300 005d  baj[...}.(j]...]
-000065f0: 946a 5f03 0000 5d94 6a61 0300 005d 946a  .j_...].ja...].j
-00006600: 6303 0000 5d94 6a65 0300 005d 948c 0869  c...].je...]...i
-00006610: 6e74 6572 6e61 6c94 888c 0672 6566 7572  nternal....refur
-00006620: 6994 6a22 0300 008c 0a61 6e63 686f 726e  i.j".....anchorn
-00006630: 616d 6594 8c14 2368 6f77 2d74 6f2d 7573  ame...#how-to-us
-00006640: 652d 6661 7374 6d62 6172 9475 6a67 0300  e-fastmbar.ujg..
-00006650: 006a ef03 0000 6a5a 0300 006a 6407 0000  .j....jZ...jd...
-00006660: 7562 616a 5b03 0000 7d94 286a 5d03 0000  ubaj[...}.(j]...
-00006670: 5d94 6a5f 0300 005d 946a 6103 0000 5d94  ].j_...].ja...].
-00006680: 6a63 0300 005d 946a 6503 0000 5d94 756a  jc...].je...].uj
-00006690: 6703 0000 6af6 0300 006a 5a03 0000 6a61  g...j....jZ...ja
-000066a0: 0700 0075 6261 6a5b 0300 007d 9428 6a5d  ...ubaj[...}.(j]
-000066b0: 0300 005d 946a 5f03 0000 5d94 6a61 0300  ...].j_...].ja..
-000066c0: 005d 946a 6303 0000 5d94 6a65 0300 005d  .].jc...].je...]
-000066d0: 9475 6a67 0300 006a fd03 0000 6a5a 0300  .ujg...j....jZ..
-000066e0: 006a 3b07 0000 7562 656a 5b03 0000 7d94  .j;...ubej[...}.
-000066f0: 286a 5d03 0000 5d94 6a5f 0300 005d 946a  (j]...].j_...].j
-00006700: 6103 0000 5d94 6a63 0300 005d 946a 6503  a...].jc...].je.
-00006710: 0000 5d94 756a 6703 0000 6a04 0400 006a  ..].ujg...j....j
-00006720: 5a03 0000 6a1f 0700 0075 6265 6a5b 0300  Z...j....ubej[..
-00006730: 007d 9428 6a5d 0300 005d 946a 5f03 0000  .}.(j]...].j_...
-00006740: 5d94 6a61 0300 005d 946a 6303 0000 5d94  ].ja...].jc...].
-00006750: 6a65 0300 005d 9475 6a67 0300 006a fd03  je...].ujg...j..
-00006760: 0000 6a5a 0300 006a 1c07 0000 7562 616a  ..jZ...j....ubaj
-00006770: 5b03 0000 7d94 286a 5d03 0000 5d94 6a5f  [...}.(j]...].j_
-00006780: 0300 005d 946a 6103 0000 5d94 6a63 0300  ...].ja...].jc..
-00006790: 005d 946a 6503 0000 5d94 756a 6703 0000  .].je...].ujg...
-000067a0: 6a04 0400 0075 626a e702 0000 6ace 0300  j....ubj....j...
-000067b0: 0029 8194 7d94 286a 5103 0000 686c 6a52  .)..}.(jQ...hljR
-000067c0: 0300 005d 946a d303 0000 2981 947d 9428  ...].j....)..}.(
-000067d0: 6a51 0300 0068 6c6a 5203 0000 5d94 286a  jQ...hljR...].(j
-000067e0: d903 0000 2981 947d 9428 6a51 0300 0068  ....)..}.(jQ...h
-000067f0: 6c6a 5203 0000 5d94 6ade 0300 0029 8194  ljR...].j....)..
-00006800: 7d94 286a 5103 0000 686c 6a52 0300 005d  }.(jQ...hljR...]
-00006810: 946a 5503 0000 8c0c 496e 7374 616c 6c61  .jU.....Installa
-00006820: 7469 6f6e 9485 9481 947d 946a 5a03 0000  tion.....}.jZ...
-00006830: 6a9f 0700 0073 6261 6a5b 0300 007d 9428  j....sbaj[...}.(
-00006840: 6abf 0300 005d 946a c103 0000 5d94 6ac3  j....].j....].j.
-00006850: 0300 005d 946a c503 0000 5d94 6ac7 0300  ...].j....].j...
-00006860: 005d 948c 0869 6e74 6572 6e61 6c94 888c  .]...internal...
-00006870: 0672 6566 7572 6994 6ae7 0200 008c 0a61  .refuri.j......a
-00006880: 6e63 686f 726e 616d 6594 686c 756a 6703  nchorname.hlujg.
-00006890: 0000 6add 0300 006a 5a03 0000 6a9c 0700  ..j....jZ...j...
-000068a0: 0075 6261 6a5b 0300 007d 9428 6abf 0300  .ubaj[...}.(j...
-000068b0: 005d 946a c103 0000 5d94 6ac3 0300 005d  .].j....].j....]
-000068c0: 946a c503 0000 5d94 6ac7 0300 005d 9475  .j....].j....].u
-000068d0: 6a67 0300 006a d803 0000 6a5a 0300 006a  jg...j....jZ...j
-000068e0: 9907 0000 7562 6ace 0300 0029 8194 7d94  ....ubj....)..}.
-000068f0: 286a 5103 0000 686c 6a52 0300 005d 9428  (jQ...hljR...].(
-00006900: 6ad3 0300 0029 8194 7d94 286a 5103 0000  j....)..}.(jQ...
-00006910: 686c 6a52 0300 005d 946a d903 0000 2981  hljR...].j....).
-00006920: 947d 9428 6a51 0300 0068 6c6a 5203 0000  .}.(jQ...hljR...
-00006930: 5d94 6ade 0300 0029 8194 7d94 286a 5103  ].j....)..}.(jQ.
-00006940: 0000 686c 6a52 0300 005d 946a 5503 0000  ..hljR...].jU...
-00006950: 8c1d 312e 204e 6577 2074 6f20 5079 7468  ..1. New to Pyth
-00006960: 6f6e 206f 7220 416e 6163 6f6e 6461 3f94  on or Anaconda?.
-00006970: 8594 8194 7d94 6a5a 0300 006a be07 0000  ....}.jZ...j....
-00006980: 7362 616a 5b03 0000 7d94 286a bf03 0000  sbaj[...}.(j....
-00006990: 5d94 6ac1 0300 005d 946a c303 0000 5d94  ].j....].j....].
-000069a0: 6ac5 0300 005d 946a c703 0000 5d94 8c08  j....].j....]...
-000069b0: 696e 7465 726e 616c 9488 8c06 7265 6675  internal....refu
-000069c0: 7269 946a e702 0000 8c0a 616e 6368 6f72  ri.j......anchor
-000069d0: 6e61 6d65 948c 1a23 6e65 772d 746f 2d70  name...#new-to-p
-000069e0: 7974 686f 6e2d 6f72 2d61 6e61 636f 6e64  ython-or-anacond
-000069f0: 6194 756a 6703 0000 6add 0300 006a 5a03  a.ujg...j....jZ.
-00006a00: 0000 6abb 0700 0075 6261 6a5b 0300 007d  ..j....ubaj[...}
-00006a10: 9428 6abf 0300 005d 946a c103 0000 5d94  .(j....].j....].
-00006a20: 6ac3 0300 005d 946a c503 0000 5d94 6ac7  j....].j....].j.
-00006a30: 0300 005d 9475 6a67 0300 006a d803 0000  ...].ujg...j....
-00006a40: 6a5a 0300 006a b807 0000 7562 616a 5b03  jZ...j....ubaj[.
-00006a50: 0000 7d94 286a bf03 0000 5d94 6ac1 0300  ..}.(j....].j...
-00006a60: 005d 946a c303 0000 5d94 6ac5 0300 005d  .].j....].j....]
-00006a70: 946a c703 0000 5d94 756a 6703 0000 6ad2  .j....].ujg...j.
-00006a80: 0300 006a 5a03 0000 6ab5 0700 0075 626a  ...jZ...j....ubj
-00006a90: d303 0000 2981 947d 9428 6a51 0300 0068  ....)..}.(jQ...h
-00006aa0: 6c6a 5203 0000 5d94 6ad9 0300 0029 8194  ljR...].j....)..
-00006ab0: 7d94 286a 5103 0000 686c 6a52 0300 005d  }.(jQ...hljR...]
-00006ac0: 946a de03 0000 2981 947d 9428 6a51 0300  .j....)..}.(jQ..
-00006ad0: 0068 6c6a 5203 0000 5d94 6a55 0300 008c  .hljR...].jU....
-00006ae0: 1c32 2e20 496e 7374 616c 6c20 4661 7374  .2. Install Fast
-00006af0: 4d42 4152 2077 6974 6820 7069 7094 8594  MBAR with pip...
-00006b00: 8194 7d94 6a5a 0300 006a e107 0000 7362  ..}.jZ...j....sb
-00006b10: 616a 5b03 0000 7d94 286a bf03 0000 5d94  aj[...}.(j....].
-00006b20: 6ac1 0300 005d 946a c303 0000 5d94 6ac5  j....].j....].j.
-00006b30: 0300 005d 946a c703 0000 5d94 8c08 696e  ...].j....]...in
-00006b40: 7465 726e 616c 9488 8c06 7265 6675 7269  ternal....refuri
-00006b50: 946a e702 0000 8c0a 616e 6368 6f72 6e61  .j......anchorna
-00006b60: 6d65 948c 1a23 696e 7374 616c 6c2d 6661  me...#install-fa
-00006b70: 7374 6d62 6172 2d77 6974 682d 7069 7094  stmbar-with-pip.
-00006b80: 756a 6703 0000 6add 0300 006a 5a03 0000  ujg...j....jZ...
-00006b90: 6ade 0700 0075 6261 6a5b 0300 007d 9428  j....ubaj[...}.(
-00006ba0: 6abf 0300 005d 946a c103 0000 5d94 6ac3  j....].j....].j.
-00006bb0: 0300 005d 946a c503 0000 5d94 6ac7 0300  ...].j....].j...
-00006bc0: 005d 9475 6a67 0300 006a d803 0000 6a5a  .].ujg...j....jZ
-00006bd0: 0300 006a db07 0000 7562 616a 5b03 0000  ...j....ubaj[...
-00006be0: 7d94 286a bf03 0000 5d94 6ac1 0300 005d  }.(j....].j....]
-00006bf0: 946a c303 0000 5d94 6ac5 0300 005d 946a  .j....].j....].j
-00006c00: c703 0000 5d94 756a 6703 0000 6ad2 0300  ....].ujg...j...
-00006c10: 006a 5a03 0000 6ab5 0700 0075 626a d303  .jZ...j....ubj..
-00006c20: 0000 2981 947d 9428 6a51 0300 0068 6c6a  ..)..}.(jQ...hlj
-00006c30: 5203 0000 5d94 6ad9 0300 0029 8194 7d94  R...].j....)..}.
-00006c40: 286a 5103 0000 686c 6a52 0300 005d 946a  (jQ...hljR...].j
-00006c50: de03 0000 2981 947d 9428 6a51 0300 0068  ....)..}.(jQ...h
-00006c60: 6c6a 5203 0000 5d94 6a55 0300 008c 2433  ljR...].jU....$3
-00006c70: 2e20 5465 7374 2074 6865 2049 6e73 7461  . Test the Insta
-00006c80: 6c6c 6174 696f 6e20 6f66 2046 6173 744d  llation of FastM
-00006c90: 4241 5294 8594 8194 7d94 6a5a 0300 006a  BAR.....}.jZ...j
-00006ca0: 0408 0000 7362 616a 5b03 0000 7d94 286a  ....sbaj[...}.(j
-00006cb0: bf03 0000 5d94 6ac1 0300 005d 946a c303  ....].j....].j..
-00006cc0: 0000 5d94 6ac5 0300 005d 946a c703 0000  ..].j....].j....
-00006cd0: 5d94 8c08 696e 7465 726e 616c 9488 8c06  ]...internal....
-00006ce0: 7265 6675 7269 946a e702 0000 8c0a 616e  refuri.j......an
-00006cf0: 6368 6f72 6e61 6d65 948c 2223 7465 7374  chorname.."#test
-00006d00: 2d74 6865 2d69 6e73 7461 6c6c 6174 696f  -the-installatio
-00006d10: 6e2d 6f66 2d66 6173 746d 6261 7294 756a  n-of-fastmbar.uj
-00006d20: 6703 0000 6add 0300 006a 5a03 0000 6a01  g...j....jZ...j.
-00006d30: 0800 0075 6261 6a5b 0300 007d 9428 6abf  ...ubaj[...}.(j.
-00006d40: 0300 005d 946a c103 0000 5d94 6ac3 0300  ...].j....].j...
-00006d50: 005d 946a c503 0000 5d94 6ac7 0300 005d  .].j....].j....]
-00006d60: 9475 6a67 0300 006a d803 0000 6a5a 0300  .ujg...j....jZ..
-00006d70: 006a fe07 0000 7562 616a 5b03 0000 7d94  .j....ubaj[...}.
-00006d80: 286a bf03 0000 5d94 6ac1 0300 005d 946a  (j....].j....].j
-00006d90: c303 0000 5d94 6ac5 0300 005d 946a c703  ....].j....].j..
-00006da0: 0000 5d94 756a 6703 0000 6ad2 0300 006a  ..].ujg...j....j
-00006db0: 5a03 0000 6ab5 0700 0075 6265 6a5b 0300  Z...j....ubej[..
-00006dc0: 007d 9428 6abf 0300 005d 946a c103 0000  .}.(j....].j....
-00006dd0: 5d94 6ac3 0300 005d 946a c503 0000 5d94  ].j....].j....].
-00006de0: 6ac7 0300 005d 9475 6a67 0300 006a cd03  j....].ujg...j..
-00006df0: 0000 6a5a 0300 006a 9907 0000 7562 656a  ..jZ...j....ubej
-00006e00: 5b03 0000 7d94 286a bf03 0000 5d94 6ac1  [...}.(j....].j.
-00006e10: 0300 005d 946a c303 0000 5d94 6ac5 0300  ...].j....].j...
-00006e20: 005d 946a c703 0000 5d94 756a 6703 0000  .].j....].ujg...
-00006e30: 6ad2 0300 006a 5a03 0000 6a96 0700 0075  j....jZ...j....u
-00006e40: 6261 6a5b 0300 007d 9428 6abf 0300 005d  baj[...}.(j....]
-00006e50: 946a c103 0000 5d94 6ac3 0300 005d 946a  .j....].j....].j
-00006e60: c503 0000 5d94 6ac7 0300 005d 9475 6a67  ....].j....].ujg
-00006e70: 0300 006a cd03 0000 7562 758c 0f74 6f63  ...j....ubu..toc
-00006e80: 5f6e 756d 5f65 6e74 7269 6573 947d 9428  _num_entries.}.(
-00006e90: 6a1c 0300 004b 016a 1d03 0000 4b05 6a1e  j....K.j....K.j.
-00006ea0: 0300 004b 056a 1f03 0000 4b03 6a20 0300  ...K.j....K.j ..
-00006eb0: 004b 046a 2103 0000 4b01 6a22 0300 004b  .K.j!...K.j"...K
-00006ec0: 036a e702 0000 4b04 758c 0e74 6f63 5f73  .j....K.u..toc_s
-00006ed0: 6563 6e75 6d62 6572 7394 7d94 8c0e 746f  ecnumbers.}...to
-00006ee0: 635f 6669 676e 756d 6265 7273 947d 948c  c_fignumbers.}..
-00006ef0: 1074 6f63 7472 6565 5f69 6e63 6c75 6465  .toctree_include
-00006f00: 7394 7d94 286a 1f03 0000 5d94 286a f805  s.}.(j....].(j..
-00006f10: 0000 6afa 0500 0065 6a20 0300 005d 9428  ..j....ej ...].(
-00006f20: 6abd 0600 006a bf06 0000 6ac1 0600 006a  j....j....j....j
-00006f30: c306 0000 6ac5 0600 0065 758c 1066 696c  ....j....eu..fil
-00006f40: 6573 5f74 6f5f 7265 6275 696c 6494 7d94  es_to_rebuild.}.
-00006f50: 286a f805 0000 8f94 286a 1f03 0000 906a  (j......(j.....j
-00006f60: fa05 0000 8f94 286a 1f03 0000 906a bd06  ......(j.....j..
-00006f70: 0000 8f94 286a 2003 0000 906a bf06 0000  ....(j ....j....
-00006f80: 8f94 286a 2003 0000 906a c106 0000 8f94  ..(j ....j......
-00006f90: 286a 2003 0000 906a c306 0000 8f94 286a  (j ....j......(j
-00006fa0: 2003 0000 906a c506 0000 8f94 286a 2003   ....j......(j .
-00006fb0: 0000 9075 8c0d 676c 6f62 5f74 6f63 7472  ...u..glob_toctr
-00006fc0: 6565 7394 8f94 8c11 6e75 6d62 6572 6564  ees.....numbered
-00006fd0: 5f74 6f63 7472 6565 7394 8f94 8c0a 646f  _toctrees.....do
-00006fe0: 6d61 696e 6461 7461 947d 9428 8c01 6394  maindata.}.(..c.
-00006ff0: 7d94 288c 0b72 6f6f 745f 7379 6d62 6f6c  }.(..root_symbol
-00007000: 946a f102 0000 8c06 5379 6d62 6f6c 9493  .j......Symbol..
-00007010: 9429 8194 7d94 286a 5a03 0000 4e8c 0c73  .)..}.(jZ...N..s
-00007020: 6962 6c69 6e67 4162 6f76 6594 4e8c 0c73  iblingAbove.N..s
-00007030: 6962 6c69 6e67 4265 6c6f 7794 4e8c 0569  iblingBelow.N..i
-00007040: 6465 6e74 944e 8c0b 6465 636c 6172 6174  dent.N..declarat
-00007050: 696f 6e94 4e8c 0764 6f63 6e61 6d65 944e  ion.N..docname.N
-00007060: 6a0a 0600 004e 8c0f 6973 5265 6465 636c  j....N..isRedecl
-00007070: 6172 6174 696f 6e94 898c 095f 6368 696c  aration...._chil
-00007080: 6472 656e 945d 948c 0d5f 616e 6f6e 4368  dren.]..._anonCh
-00007090: 696c 6472 656e 945d 9475 628c 076f 626a  ildren.].ub..obj
-000070a0: 6563 7473 947d 946a ef02 0000 4b00 758c  ects.}.j....K.u.
-000070b0: 0963 6861 6e67 6573 6574 947d 9428 8c07  .changeset.}.(..
-000070c0: 6368 616e 6765 7394 7d94 6aef 0200 004b  changes.}.j....K
-000070d0: 0075 8c08 6369 7461 7469 6f6e 947d 9428  .u..citation.}.(
-000070e0: 6aef 0200 004b 008c 0963 6974 6174 696f  j....K...citatio
-000070f0: 6e73 947d 948c 0d63 6974 6174 696f 6e5f  ns.}...citation_
-00007100: 7265 6673 947d 9475 8c03 6370 7094 7d94  refs.}.u..cpp.}.
-00007110: 286a 4e08 0000 6af4 0200 006a 4f08 0000  (jN...j....jO...
-00007120: 9394 2981 947d 9428 6a5a 0300 004e 6a53  ..)..}.(jZ...NjS
-00007130: 0800 004e 6a54 0800 004e 8c09 6964 656e  ...NjT...N..iden
-00007140: 744f 724f 7094 4e8c 0e74 656d 706c 6174  tOrOp.N..templat
-00007150: 6550 6172 616d 7394 4e8c 0c74 656d 706c  eParams.N..templ
-00007160: 6174 6541 7267 7394 4e6a 5608 0000 4e6a  ateArgs.NjV...Nj
-00007170: 5708 0000 4e6a 0a06 0000 4e6a 5808 0000  W...Nj....NjX...
-00007180: 896a 5908 0000 5d94 6a5b 0800 005d 9475  .jY...].j[...].u
-00007190: 626a 6103 0000 7d94 6aef 0200 004b 0075  bja...}.j....K.u
-000071a0: 8c05 696e 6465 7894 7d94 286a ef02 0000  ..index.}.(j....
-000071b0: 4b00 8c07 656e 7472 6965 7394 7d94 286a  K...entries.}.(j
-000071c0: 1c03 0000 5d94 2828 8c06 7369 6e67 6c65  ....].((..single
-000071d0: 948c 1c46 6173 744d 4241 5220 2863 6c61  ...FastMBAR (cla
-000071e0: 7373 2069 6e20 4661 7374 4d42 4152 2994  ss in FastMBAR).
-000071f0: 8c11 4661 7374 4d42 4152 2e46 6173 744d  ..FastMBAR.FastM
-00007200: 4241 5294 686c 4e74 9428 6a79 0800 008c  BAR.hlNt.(jy....
-00007210: 255f 5f69 6e69 745f 5f28 2920 2846 6173  %__init__() (Fas
-00007220: 744d 4241 522e 4661 7374 4d42 4152 206d  tMBAR.FastMBAR m
-00007230: 6574 686f 6429 948c 1a46 6173 744d 4241  ethod)...FastMBA
-00007240: 522e 4661 7374 4d42 4152 2e5f 5f69 6e69  R.FastMBAR.__ini
-00007250: 745f 5f94 686c 4e74 9428 6a79 0800 008c  t__.hlNt.(jy....
-00007260: 1e46 2028 4661 7374 4d42 4152 2e46 6173  .F (FastMBAR.Fas
-00007270: 744d 4241 5220 7072 6f70 6572 7479 2994  tMBAR property).
-00007280: 8c13 4661 7374 4d42 4152 2e46 6173 744d  ..FastMBAR.FastM
-00007290: 4241 522e 4694 686c 4e74 9428 6a79 0800  BAR.F.hlNt.(jy..
-000072a0: 008c 2246 5f73 7464 2028 4661 7374 4d42  .."F_std (FastMB
-000072b0: 4152 2e46 6173 744d 4241 5220 7072 6f70  AR.FastMBAR prop
-000072c0: 6572 7479 2994 8c17 4661 7374 4d42 4152  erty)...FastMBAR
-000072d0: 2e46 6173 744d 4241 522e 465f 7374 6494  .FastMBAR.F_std.
-000072e0: 686c 4e74 9428 6a79 0800 008c 2246 5f63  hlNt.(jy...."F_c
-000072f0: 6f76 2028 4661 7374 4d42 4152 2e46 6173  ov (FastMBAR.Fas
-00007300: 744d 4241 5220 7072 6f70 6572 7479 2994  tMBAR property).
-00007310: 8c17 4661 7374 4d42 4152 2e46 6173 744d  ..FastMBAR.FastM
-00007320: 4241 522e 465f 636f 7694 686c 4e74 9428  BAR.F_cov.hlNt.(
-00007330: 6a79 0800 008c 2344 656c 7461 4620 2846  jy....#DeltaF (F
-00007340: 6173 744d 4241 522e 4661 7374 4d42 4152  astMBAR.FastMBAR
-00007350: 2070 726f 7065 7274 7929 948c 1846 6173   property)...Fas
-00007360: 744d 4241 522e 4661 7374 4d42 4152 2e44  tMBAR.FastMBAR.D
-00007370: 656c 7461 4694 686c 4e74 9428 6a79 0800  eltaF.hlNt.(jy..
-00007380: 008c 2744 656c 7461 465f 7374 6420 2846  ..'DeltaF_std (F
-00007390: 6173 744d 4241 522e 4661 7374 4d42 4152  astMBAR.FastMBAR
-000073a0: 2070 726f 7065 7274 7929 948c 1c46 6173   property)...Fas
-000073b0: 744d 4241 522e 4661 7374 4d42 4152 2e44  tMBAR.FastMBAR.D
-000073c0: 656c 7461 465f 7374 6494 686c 4e74 9428  eltaF_std.hlNt.(
-000073d0: 6a79 0800 008c 296c 6f67 5f70 726f 625f  jy....)log_prob_
-000073e0: 6d69 7820 2846 6173 744d 4241 522e 4661  mix (FastMBAR.Fa
-000073f0: 7374 4d42 4152 2070 726f 7065 7274 7929  stMBAR property)
-00007400: 948c 1e46 6173 744d 4241 522e 4661 7374  ...FastMBAR.Fast
-00007410: 4d42 4152 2e6c 6f67 5f70 726f 625f 6d69  MBAR.log_prob_mi
-00007420: 7894 686c 4e74 9428 6a79 0800 008c 4863  x.hlNt.(jy....Hc
-00007430: 616c 6375 6c61 7465 5f66 7265 655f 656e  alculate_free_en
-00007440: 6572 6769 6573 5f6f 665f 7065 7274 7572  ergies_of_pertur
-00007450: 6265 645f 7374 6174 6573 2829 2028 4661  bed_states() (Fa
-00007460: 7374 4d42 4152 2e46 6173 744d 4241 5220  stMBAR.FastMBAR 
-00007470: 6d65 7468 6f64 2994 8c3d 4661 7374 4d42  method)..=FastMB
-00007480: 4152 2e46 6173 744d 4241 522e 6361 6c63  AR.FastMBAR.calc
-00007490: 756c 6174 655f 6672 6565 5f65 6e65 7267  ulate_free_energ
-000074a0: 6965 735f 6f66 5f70 6572 7475 7262 6564  ies_of_perturbed
-000074b0: 5f73 7461 7465 7394 686c 4e74 9465 6a1d  _states.hlNt.ej.
-000074c0: 0300 005d 946a 1e03 0000 5d94 6a1f 0300  ...].j....].j...
-000074d0: 005d 946a 2003 0000 5d94 6a21 0300 005d  .].j ...].j!...]
-000074e0: 946a 2203 0000 5d94 6ae7 0200 005d 9475  .j"...].j....].u
-000074f0: 758c 026a 7394 7d94 286a 5d08 0000 7d94  u..js.}.(j]...}.
-00007500: 8c07 6d6f 6475 6c65 7394 7d94 6aef 0200  ..modules.}.j...
-00007510: 004b 0075 8c04 6d61 7468 947d 9428 6a5d  .K.u..math.}.(j]
-00007520: 0800 007d 948c 0d68 6173 5f65 7175 6174  ...}...has_equat
-00007530: 696f 6e73 947d 9428 6a1c 0300 0088 6a1d  ions.}.(j.....j.
-00007540: 0300 0088 6a1e 0300 0088 6a1f 0300 0089  ....j.....j.....
-00007550: 6a20 0300 0089 6a21 0300 0089 6a22 0300  j ....j!....j"..
-00007560: 0088 6ae7 0200 0089 756a ef02 0000 4b00  ..j.....uj....K.
-00007570: 758c 0270 7994 7d94 286a 5d08 0000 7d94  u..py.}.(j]...}.
-00007580: 288c 1146 6173 744d 4241 522e 4661 7374  (..FastMBAR.Fast
-00007590: 4d42 4152 948c 1573 7068 696e 782e 646f  MBAR...sphinx.do
-000075a0: 6d61 696e 732e 7079 7468 6f6e 948c 0b4f  mains.python...O
-000075b0: 626a 6563 7445 6e74 7279 9493 9428 6a1c  bjectEntry...(j.
-000075c0: 0300 006a 7b08 0000 8c05 636c 6173 7394  ...j{.....class.
-000075d0: 8974 9481 948c 1a46 6173 744d 4241 522e  .t.....FastMBAR.
-000075e0: 6661 7374 6d62 6172 2e46 6173 744d 4241  fastmbar.FastMBA
-000075f0: 5294 6aac 0800 0028 6a1c 0300 006a 7b08  R.j....(j....j{.
-00007600: 0000 6aad 0800 0088 7494 8194 8c1a 4661  ..j.....t.....Fa
-00007610: 7374 4d42 4152 2e46 6173 744d 4241 522e  stMBAR.FastMBAR.
-00007620: 5f5f 696e 6974 5f5f 946a ac08 0000 286a  __init__.j....(j
-00007630: 1c03 0000 6a7e 0800 008c 066d 6574 686f  ....j~.....metho
-00007640: 6494 8974 9481 948c 1346 6173 744d 4241  d..t.....FastMBA
-00007650: 522e 4661 7374 4d42 4152 2e46 946a ac08  R.FastMBAR.F.j..
-00007660: 0000 286a 1c03 0000 6a81 0800 008c 0870  ..(j....j......p
-00007670: 726f 7065 7274 7994 8974 9481 948c 1746  roperty..t.....F
-00007680: 6173 744d 4241 522e 4661 7374 4d42 4152  astMBAR.FastMBAR
-00007690: 2e46 5f73 7464 946a ac08 0000 286a 1c03  .F_std.j....(j..
-000076a0: 0000 6a84 0800 008c 0870 726f 7065 7274  ..j......propert
-000076b0: 7994 8974 9481 948c 1746 6173 744d 4241  y..t.....FastMBA
-000076c0: 522e 4661 7374 4d42 4152 2e46 5f63 6f76  R.FastMBAR.F_cov
-000076d0: 946a ac08 0000 286a 1c03 0000 6a87 0800  .j....(j....j...
-000076e0: 008c 0870 726f 7065 7274 7994 8974 9481  ...property..t..
-000076f0: 948c 1846 6173 744d 4241 522e 4661 7374  ...FastMBAR.Fast
-00007700: 4d42 4152 2e44 656c 7461 4694 6aac 0800  MBAR.DeltaF.j...
-00007710: 0028 6a1c 0300 006a 8a08 0000 8c08 7072  .(j....j......pr
-00007720: 6f70 6572 7479 9489 7494 8194 8c1c 4661  operty..t.....Fa
-00007730: 7374 4d42 4152 2e46 6173 744d 4241 522e  stMBAR.FastMBAR.
-00007740: 4465 6c74 6146 5f73 7464 946a ac08 0000  DeltaF_std.j....
-00007750: 286a 1c03 0000 6a8d 0800 008c 0870 726f  (j....j......pro
-00007760: 7065 7274 7994 8974 9481 948c 1e46 6173  perty..t.....Fas
-00007770: 744d 4241 522e 4661 7374 4d42 4152 2e6c  tMBAR.FastMBAR.l
-00007780: 6f67 5f70 726f 625f 6d69 7894 6aac 0800  og_prob_mix.j...
-00007790: 0028 6a1c 0300 006a 9008 0000 8c08 7072  .(j....j......pr
-000077a0: 6f70 6572 7479 9489 7494 8194 8c3d 4661  operty..t....=Fa
-000077b0: 7374 4d42 4152 2e46 6173 744d 4241 522e  stMBAR.FastMBAR.
-000077c0: 6361 6c63 756c 6174 655f 6672 6565 5f65  calculate_free_e
-000077d0: 6e65 7267 6965 735f 6f66 5f70 6572 7475  nergies_of_pertu
-000077e0: 7262 6564 5f73 7461 7465 7394 6aac 0800  rbed_states.j...
-000077f0: 0028 6a1c 0300 006a 9308 0000 8c06 6d65  .(j....j......me
-00007800: 7468 6f64 9489 7494 8194 756a 9f08 0000  thod..t...uj....
-00007810: 7d94 6aef 0200 004b 0075 8c03 7273 7494  }.j....K.u..rst.
-00007820: 7d94 286a 5d08 0000 7d94 6aef 0200 004b  }.(j]...}.j....K
-00007830: 0075 8c03 7374 6494 7d94 288c 0b70 726f  .u..std.}.(..pro
-00007840: 676f 7074 696f 6e73 947d 946a 5d08 0000  goptions.}.j]...
-00007850: 7d94 8c06 6c61 6265 6c73 947d 9428 8c08  }...labels.}.(..
-00007860: 6765 6e69 6e64 6578 946a de08 0000 686c  genindex.j....hl
-00007870: 8c0d 7370 6869 6e78 2e6c 6f63 616c 6594  ..sphinx.locale.
-00007880: 8c11 5f54 7261 6e73 6c61 7469 6f6e 5072  .._TranslationPr
-00007890: 6f78 7994 9394 286a df08 0000 8c0f 5f6c  oxy...(j......_l
-000078a0: 617a 795f 7472 616e 736c 6174 6594 9394  azy_translate...
-000078b0: 8c06 7370 6869 6e78 948c 0767 656e 6572  ..sphinx...gener
-000078c0: 616c 948c 0549 6e64 6578 9474 9481 946a  al...Index.t...j
-000078d0: e308 0000 6ae4 0800 006a e508 0000 6ae6  ....j....j....j.
-000078e0: 0800 0087 9486 9462 8794 8c08 6d6f 6469  .......b....modi
-000078f0: 6e64 6578 948c 0b70 792d 6d6f 6469 6e64  ndex...py-modind
-00007900: 6578 9468 6c6a e108 0000 286a e308 0000  ex.hlj....(j....
-00007910: 6ae4 0800 006a e508 0000 8c0c 4d6f 6475  j....j......Modu
-00007920: 6c65 2049 6e64 6578 9474 9481 946a e308  le Index.t...j..
-00007930: 0000 6ae4 0800 006a e508 0000 6aee 0800  ..j....j....j...
-00007940: 0087 9486 9462 8794 8c06 7365 6172 6368  .....b....search
-00007950: 946a f408 0000 686c 6ae1 0800 0028 6ae3  .j....hlj....(j.
-00007960: 0800 006a e408 0000 6ae5 0800 008c 0b53  ...j....j......S
-00007970: 6561 7263 6820 5061 6765 9474 9481 946a  earch Page.t...j
-00007980: e308 0000 6ae4 0800 006a e508 0000 6af5  ....j....j....j.
-00007990: 0800 0087 9486 9462 8794 8c0b 7079 2d6d  .......b....py-m
-000079a0: 6f64 696e 6465 7894 8c0b 7079 2d6d 6f64  odindex...py-mod
-000079b0: 696e 6465 7894 686c 8c13 5079 7468 6f6e  index.hl..Python
-000079c0: 204d 6f64 756c 6520 496e 6465 7894 8794   Module Index...
-000079d0: 8c08 6578 616d 706c 6573 946a 1f03 0000  ..examples.j....
-000079e0: 8c08 6578 616d 706c 6573 948c 0845 7861  ..examples...Exa
-000079f0: 6d70 6c65 7394 8794 758c 0a61 6e6f 6e6c  mples...u..anonl
-00007a00: 6162 656c 7394 7d94 286a de08 0000 6ade  abels.}.(j....j.
-00007a10: 0800 0068 6c86 946a ec08 0000 6aed 0800  ...hl..j....j...
-00007a20: 0068 6c86 946a f408 0000 6af4 0800 0068  .hl..j....j....h
-00007a30: 6c86 946a fb08 0000 6afc 0800 0068 6c86  l..j....j....hl.
-00007a40: 946a ff08 0000 6a1f 0300 006a 0009 0000  .j....j....j....
-00007a50: 8694 756a ef02 0000 4b00 8c05 7465 726d  ..uj....K...term
-00007a60: 7394 7d94 7575 8c06 696d 6167 6573 948c  s.}.uu..images..
-00007a70: 0b73 7068 696e 782e 7574 696c 948c 1046  .sphinx.util...F
-00007a80: 696c 656e 616d 6555 6e69 7144 6963 7494  ilenameUniqDict.
-00007a90: 9394 2981 9428 6a2e 0300 008f 9428 6a1d  ..)..(j......(j.
-00007aa0: 0300 0090 8c09 4669 675f 312e 706e 6794  ......Fig_1.png.
-00007ab0: 8694 6a31 0300 008f 9428 6a1d 0300 0090  ..j1.....(j.....
-00007ac0: 8c09 4669 675f 322e 706e 6794 8694 6a30  ..Fig_2.png...j0
-00007ad0: 0300 008f 9428 6a1d 0300 0090 8c07 504d  .....(j.......PM
-00007ae0: 462e 706e 6794 8694 6a36 0300 008f 9428  F.png...j6.....(
-00007af0: 6a1e 0300 0090 8c0a 4669 675f 3131 2e70  j.......Fig_11.p
-00007b00: 6e67 9486 946a 3503 0000 8f94 286a 1e03  ng...j5.....(j..
-00007b10: 0000 908c 0a46 6967 5f32 312e 706e 6794  .....Fig_21.png.
-00007b20: 8694 6a34 0300 008f 9428 6a1e 0300 0090  ..j4.....(j.....
-00007b30: 8c08 504d 4631 2e70 6e67 9486 946a 3f03  ..PMF1.png...j?.
-00007b40: 0000 8f94 286a 2203 0000 908c 1165 6e65  ....(j"......ene
-00007b50: 7267 795f 6d61 7472 6978 2e70 6e67 9486  rgy_matrix.png..
-00007b60: 9475 8f94 286a 1509 0000 6a21 0900 006a  .u..(j....j!...j
-00007b70: 1809 0000 6a24 0900 006a 1209 0000 6a1b  ....j$...j....j.
-00007b80: 0900 006a 1e09 0000 9062 8c07 646c 6669  ...j.....b..dlfi
-00007b90: 6c65 7394 6a0d 0900 008c 0d44 6f77 6e6c  les.j......Downl
-00007ba0: 6f61 6446 696c 6573 9493 9429 8194 8c12  oadFiles...)....
-00007bb0: 6f72 6967 696e 616c 5f69 6d61 6765 5f75  original_image_u
-00007bc0: 7269 947d 948c 0974 656d 705f 6461 7461  ri.}...temp_data
-00007bd0: 947d 948c 0b72 6566 5f63 6f6e 7465 7874  .}...ref_context
-00007be0: 947d 948c 115f 7669 6577 636f 6465 5f6d  .}..._viewcode_m
-00007bf0: 6f64 756c 6573 947d 948c 1146 6173 744d  odules.}...FastM
-00007c00: 4241 522e 6661 7374 6d62 6172 9428 58c6  BAR.fastmbar.(X.
-00007c10: 7100 0066 726f 6d20 7479 7069 6e67 2069  q..from typing i
-00007c20: 6d70 6f72 7420 556e 696f 6e0a 696d 706f  mport Union.impo
-00007c30: 7274 2074 6f72 6368 0a69 6d70 6f72 7420  rt torch.import 
-00007c40: 6e75 6d70 7920 6173 206e 700a 696d 706f  numpy as np.impo
-00007c50: 7274 2073 6369 7079 2e6f 7074 696d 697a  rt scipy.optimiz
-00007c60: 6520 6173 206f 7074 696d 697a 650a 696d  e as optimize.im
-00007c70: 706f 7274 206d 6174 680a 0a0a 636c 6173  port math...clas
-00007c80: 7320 4661 7374 4d42 4152 3a0a 2020 2020  s FastMBAR:.    
-00007c90: 2222 220a 2020 2020 5468 6520 4661 7374  """.    The Fast
-00007ca0: 4d42 4152 2063 6c61 7373 2069 7320 696e  MBAR class is in
-00007cb0: 6974 6961 6c69 7a65 6420 7769 7468 2061  itialized with a
-00007cc0: 6e20 656e 6572 6779 206d 6174 7269 7820  n energy matrix 
-00007cd0: 616e 6420 616e 2061 7272 6179 0a20 2020  and an array.   
-00007ce0: 206f 6620 6e75 6d20 6f66 2063 6f6e 666f   of num of confo
-00007cf0: 726d 6174 696f 6e73 2e20 5468 6520 636f  rmations. The co
-00007d00: 7272 6573 706f 6e64 696e 6720 4d42 4152  rresponding MBAR
-00007d10: 2065 7175 6174 696f 6e20 6973 2073 6f6c   equation is sol
-00007d20: 7665 640a 2020 2020 696e 2074 6865 2063  ved.    in the c
-00007d30: 6f6e 7374 7275 6374 6f72 2e20 5468 6572  onstructor. Ther
-00007d40: 6566 6f72 652c 2074 6865 2072 656c 6174  efore, the relat
-00007d50: 6976 6520 6672 6565 2065 6e65 7267 6965  ive free energie
-00007d60: 7320 6f66 2073 7461 7465 730a 2020 2020  s of states.    
-00007d70: 7573 6564 2069 6e20 7468 6520 656e 6572  used in the ener
-00007d80: 6779 206d 6174 7269 7820 6973 2063 616c  gy matrix is cal
-00007d90: 6375 6c61 7465 6420 696e 2074 6865 2063  culated in the c
-00007da0: 6f6e 7374 7275 6374 6f72 2e20 5468 650a  onstructor. The.
-00007db0: 2020 2020 6d65 7468 6f64 202a 2a63 616c      method **cal
-00007dc0: 6375 6c61 7465 5f66 7265 655f 656e 6572  culate_free_ener
-00007dd0: 6769 6573 5f66 6f72 5f70 6572 7475 7262  gies_for_perturb
-00007de0: 6564 5f73 7461 7465 732a 2a0a 2020 2020  ed_states**.    
-00007df0: 6361 6e20 6265 2075 7365 6420 746f 2063  can be used to c
-00007e00: 616c 6375 6c61 7465 6420 7468 6520 7265  alculated the re
-00007e10: 6c61 7469 7665 2066 7265 6520 656e 6572  lative free ener
-00007e20: 6769 6573 206f 6620 7065 7274 7572 6265  gies of perturbe
-00007e30: 6420 7374 6174 6573 2e0a 2020 2020 2222  d states..    ""
-00007e40: 220a 0a20 2020 2064 6566 205f 5f69 6e69  "..    def __ini
-00007e50: 745f 5f28 0a20 2020 2020 2020 2073 656c  t__(.        sel
-00007e60: 662c 0a20 2020 2020 2020 2065 6e65 7267  f,.        energ
-00007e70: 793a 2055 6e69 6f6e 5b6e 702e 6e64 6172  y: Union[np.ndar
-00007e80: 7261 792c 2074 6f72 6368 2e54 656e 736f  ray, torch.Tenso
-00007e90: 725d 2c0a 2020 2020 2020 2020 6e75 6d5f  r],.        num_
-00007ea0: 636f 6e66 3a20 556e 696f 6e5b 6e70 2e6e  conf: Union[np.n
-00007eb0: 6461 7272 6179 2c20 746f 7263 682e 5465  darray, torch.Te
-00007ec0: 6e73 6f72 5d2c 0a20 2020 2020 2020 2063  nsor],.        c
-00007ed0: 7564 613a 2062 6f6f 6c20 3d20 4661 6c73  uda: bool = Fals
-00007ee0: 652c 0a20 2020 2020 2020 2063 7564 615f  e,.        cuda_
-00007ef0: 6261 7463 685f 6d6f 6465 3a20 556e 696f  batch_mode: Unio
-00007f00: 6e5b 626f 6f6c 2c20 4e6f 6e65 5d20 3d20  n[bool, None] = 
-00007f10: 4e6f 6e65 2c0a 2020 2020 2020 2020 626f  None,.        bo
-00007f20: 6f74 7374 7261 703a 2062 6f6f 6c20 3d20  otstrap: bool = 
-00007f30: 4661 6c73 652c 0a20 2020 2020 2020 2062  False,.        b
-00007f40: 6f6f 7473 7472 6170 5f62 6c6f 636b 5f73  ootstrap_block_s
-00007f50: 697a 653a 2069 6e74 203d 2033 2c0a 2020  ize: int = 3,.  
-00007f60: 2020 2020 2020 626f 6f74 7374 7261 705f        bootstrap_
-00007f70: 6e75 6d5f 7265 703a 2069 6e74 203d 2031  num_rep: int = 1
-00007f80: 3030 2c0a 2020 2020 2020 2020 7665 7262  00,.        verb
-00007f90: 6f73 653a 2062 6f6f 6c20 3d20 4661 6c73  ose: bool = Fals
-00007fa0: 652c 0a20 2020 2020 2020 206d 6574 686f  e,.        metho
-00007fb0: 643a 2073 7472 203d 2022 4e65 7774 6f6e  d: str = "Newton
-00007fc0: 222c 0a20 2020 2029 202d 3e20 4e6f 6e65  ",.    ) -> None
-00007fd0: 3a0a 2020 2020 2020 2020 2222 2249 6e69  :.        """Ini
-00007fe0: 7469 616c 697a 6572 2066 6f72 2074 6865  tializer for the
-00007ff0: 2063 6c61 7373 2046 6173 744d 4241 520a   class FastMBAR.
-00008000: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
-00008010: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
-00008020: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2065  ------.        e
-00008030: 6e65 7267 7920 3a20 3244 206e 6461 7272  nergy : 2D ndarr
-00008040: 6179 206f 7220 3244 2074 656e 736f 720a  ay or 2D tensor.
-00008050: 2020 2020 2020 2020 2020 2020 4974 2068              It h
-00008060: 6173 2061 2073 697a 6520 6f66 2028 4d20  as a size of (M 
-00008070: 7820 4e29 2c20 7768 6572 6520 4d20 6973  x N), where M is
-00008080: 2074 6865 206e 756d 6265 7220 6f66 2073   the number of s
-00008090: 7461 7465 730a 2020 2020 2020 2020 2020  tates.          
-000080a0: 2020 616e 6420 4e20 6973 2074 6865 2074    and N is the t
-000080b0: 6f74 616c 206e 756d 6265 7220 6f66 2063  otal number of c
-000080c0: 6f6e 666f 726d 6174 696f 6e73 2e20 5468  onformations. Th
-000080d0: 6520 656e 7472 7920 656e 6572 6779 5b69  e entry energy[i
-000080e0: 2c6a 5d0a 2020 2020 2020 2020 2020 2020  ,j].            
-000080f0: 6973 2074 6865 2072 6564 7563 6564 2028  is the reduced (
-00008100: 756e 6974 6c65 7373 2920 656e 6572 6779  unitless) energy
-00008110: 206f 6620 636f 6e66 6f72 6d61 7469 6f6e   of conformation
-00008120: 206a 2069 6e20 7374 6174 6520 692e 0a20   j in state i.. 
-00008130: 2020 2020 2020 2020 2020 2049 6620 626f             If bo
-00008140: 6f74 7374 7261 7070 696e 6720 6973 2075  otstrapping is u
-00008150: 7365 6420 746f 2063 616c 6375 6c61 7465  sed to calculate
-00008160: 2074 6865 2075 6e63 6572 7461 696e 7479   the uncertainty
-00008170: 2c20 7468 6520 6f72 6465 720a 2020 2020  , the order.    
-00008180: 2020 2020 2020 2020 6f66 2063 6f6e 666f          of confo
-00008190: 726d 6174 696f 6e73 206d 6174 7465 7273  rmations matters
-000081a0: 2e20 436f 6e66 6f72 6d61 7469 6f6e 7320  . Conformations 
-000081b0: 7361 6d70 6c65 6420 6672 6f6d 206f 6e65  sampled from one
-000081c0: 2073 7461 7465 0a20 2020 2020 2020 2020   state.         
-000081d0: 2020 206e 6565 6420 746f 206f 6363 7079     need to occpy
-000081e0: 2061 2063 6f6e 7469 6e75 6f75 7320 6368   a continuous ch
-000081f0: 756e 6b20 6f66 2063 6f6c 6c75 6d6e 732e  unk of collumns.
-00008200: 2043 6f6e 666f 726d 6174 696f 6e73 2073   Conformations s
-00008210: 616d 706c 6564 0a20 2020 2020 2020 2020  ampled.         
-00008220: 2020 2066 726f 6d20 7374 6174 6520 6b20     from state k 
-00008230: 6e65 6564 2074 6f20 6f63 6375 7079 2063  need to occupy c
-00008240: 6f6c 6c75 6d6e 7320 746f 2074 6865 206c  ollumns to the l
-00008250: 6566 7420 6f66 2063 6f6e 666f 726d 6174  eft of conformat
-00008260: 696f 6e73 0a20 2020 2020 2020 2020 2020  ions.           
-00008270: 2073 616d 706c 6564 2066 726f 6d20 7374   sampled from st
-00008280: 6174 6520 6c20 6966 206b 203c 206c 2e20  ate l if k < l. 
-00008290: 4966 2062 6f6f 7473 7472 6170 7069 6e67  If bootstrapping
-000082a0: 2069 7320 6e6f 7420 7573 6564 2c20 7468   is not used, th
-000082b0: 656e 0a20 2020 2020 2020 2020 2020 2074  en.            t
-000082c0: 6865 206f 7264 6572 206f 6620 636f 6e66  he order of conf
-000082d0: 6f72 6d61 7469 6f6e 2064 6f65 7320 6e6f  ormation does no
-000082e0: 7420 6d61 7474 6572 2e0a 2020 2020 2020  t matter..      
-000082f0: 2020 6e75 6d5f 636f 6e66 3a20 3144 2069    num_conf: 1D i
-00008300: 6e74 206e 6461 7272 6179 206f 7220 3144  nt ndarray or 1D
-00008310: 2074 656e 736f 720a 2020 2020 2020 2020   tensor.        
-00008320: 2020 2020 4974 2073 686f 756c 6420 6861      It should ha
-00008330: 7665 2061 2073 697a 6520 6f66 204d 2c20  ve a size of M, 
-00008340: 7768 6572 6520 6e75 6d5f 636f 6e66 5b69  where num_conf[i
-00008350: 5d20 6973 2074 6865 206e 756d 206f 660a  ] is the num of.
-00008360: 2020 2020 2020 2020 2020 2020 636f 6e66              conf
-00008370: 6f72 6d61 7469 6f6e 7320 7361 6d70 6c65  ormations sample
-00008380: 6420 6672 6f6d 2073 7461 7465 2069 2e20  d from state i. 
-00008390: 5468 6572 6566 6f72 652c 206e 702e 7375  Therefore, np.su
-000083a0: 6d28 6e75 6d5f 636f 6e66 290a 2020 2020  m(num_conf).    
-000083b0: 2020 2020 2020 2020 6861 7320 746f 2062          has to b
-000083c0: 6520 6571 7561 6c20 746f 204e 2e20 416c  e equal to N. Al
-000083d0: 6c20 656e 7472 6965 7320 696e 206e 756d  l entries in num
-000083e0: 5f63 6f6e 6620 6861 7665 2074 6f20 6265  _conf have to be
-000083f0: 2073 7472 6963 746c 790a 2020 2020 2020   strictly.      
-00008400: 2020 2020 2020 6772 6561 7465 7220 7468        greater th
-00008410: 616e 2030 2e0a 2020 2020 2020 2020 6375  an 0..        cu
-00008420: 6461 3a20 626f 6f6c 2c20 6f70 7469 6f6e  da: bool, option
-00008430: 616c 2028 6465 6661 756c 743d 4661 6c73  al (default=Fals
-00008440: 6529 0a20 2020 2020 2020 2020 2020 2049  e).            I
-00008450: 6620 6974 2069 7320 7365 7420 746f 2062  f it is set to b
-00008460: 6520 5472 7565 2c20 7468 656e 2074 6865  e True, then the
-00008470: 2063 616c 6375 6c61 7469 6f6e 2077 696c   calculation wil
-00008480: 6c20 6265 2072 756e 206f 6e0a 2020 2020  l be run on.    
-00008490: 2020 2020 2020 2020 6120 6772 6170 6869          a graphi
-000084a0: 6361 6c20 7072 6f63 6573 7369 6e67 2075  cal processing u
-000084b0: 6e69 7420 2847 5055 2920 7573 696e 6720  nit (GPU) using 
-000084c0: 4355 4441 2e0a 2020 2020 2020 2020 6375  CUDA..        cu
-000084d0: 6461 5f62 6174 6368 5f6d 6f64 653a 2062  da_batch_mode: b
-000084e0: 6f6f 6c2c 206f 7074 696f 6e61 6c20 2864  ool, optional (d
-000084f0: 6566 6175 6c74 3d4e 6f6e 6529 0a20 2020  efault=None).   
-00008500: 2020 2020 2020 2020 2054 6865 2062 6174           The bat
-00008510: 6368 206d 6f64 6520 6973 2074 7572 6e65  ch mode is turne
-00008520: 6420 6f6e 2077 6865 6e20 7468 6520 7369  d on when the si
-00008530: 7a65 206f 6620 7468 6520 656e 6572 6779  ze of the energy
-00008540: 206d 6174 7269 7820 6973 0a20 2020 2020   matrix is.     
-00008550: 2020 2020 2020 2074 6f6f 206c 6172 6765         too large
-00008560: 2066 6f72 2074 6865 206d 656d 6f72 7920   for the memory 
-00008570: 6f66 2061 2047 5055 2e20 5768 656e 2063  of a GPU. When c
-00008580: 7564 615f 6261 7463 685f 6d6f 6465 2069  uda_batch_mode i
-00008590: 7320 5472 7565 2c0a 2020 2020 2020 2020  s True,.        
-000085a0: 2020 2020 7468 6520 656e 6572 6779 206d      the energy m
-000085b0: 6174 7269 7820 7769 6c6c 2062 6520 7370  atrix will be sp
-000085c0: 6c69 7420 696e 746f 206d 756c 7469 706c  lit into multipl
-000085d0: 6520 6261 7463 6865 7320 7768 6963 6820  e batches which 
-000085e0: 6172 6520 7573 6564 0a20 2020 2020 2020  are used.       
-000085f0: 2020 2020 2073 6571 7565 6e74 6961 6c6c       sequentiall
-00008600: 792e 2049 6620 6375 6461 5f62 6174 6368  y. If cuda_batch
-00008610: 5f6d 6f64 6520 3d20 4e6f 6e65 2c20 6974  _mode = None, it
-00008620: 2077 696c 6c20 6265 2073 6574 2061 7574   will be set aut
-00008630: 6f6d 6174 6963 616c 6c79 0a20 2020 2020  omatically.     
-00008640: 2020 2020 2020 2062 6173 6564 206f 6e20         based on 
-00008650: 7468 6520 7369 7a65 206f 6620 656e 6572  the size of ener
-00008660: 6779 2061 6e64 2074 6865 206d 656d 6f72  gy and the memor
-00008670: 7920 6f66 2074 6865 2061 7661 6962 6c65  y of the avaible
-00008680: 2047 5055 2064 6576 6963 652e 0a20 2020   GPU device..   
-00008690: 2020 2020 2062 6f6f 7473 7472 6170 3a20       bootstrap: 
-000086a0: 626f 6f6c 2c20 6f70 7469 6f6e 616c 2028  bool, optional (
-000086b0: 6465 6661 756c 743d 4661 6c73 6529 0a20  default=False). 
-000086c0: 2020 2020 2020 2020 2020 2049 6620 626f             If bo
-000086d0: 6f74 7374 7261 7020 6973 2054 7275 652c  otstrap is True,
-000086e0: 2074 6865 2075 6e63 6572 7461 696e 7479   the uncertainty
-000086f0: 206f 6620 7468 6520 6361 6c63 756c 6174   of the calculat
-00008700: 6564 2066 7265 6520 656e 6572 6769 6573  ed free energies
-00008710: 0a20 2020 2020 2020 2020 2020 2077 696c  .            wil
-00008720: 6c20 6265 2065 7374 696d 6174 6520 7573  l be estimate us
-00008730: 696e 6720 626c 6f63 6b20 626f 6f74 7374  ing block bootst
-00008740: 7261 7069 6e67 2e0a 2020 2020 2020 2020  raping..        
-00008750: 626f 6f74 7374 7261 705f 626c 6f63 6b5f  bootstrap_block_
-00008760: 7369 7a65 3a20 696e 742c 206f 7074 696f  size: int, optio
-00008770: 6e61 6c20 2864 6566 6175 6c74 3d33 290a  nal (default=3).
-00008780: 2020 2020 2020 2020 2020 2020 626c 6f63              bloc
-00008790: 6b20 7369 7a65 2075 7365 6420 696e 2062  k size used in b
-000087a0: 6c6f 636b 2062 6f6f 7473 7472 6170 7069  lock bootstrappi
-000087b0: 6e67 0a20 2020 2020 2020 2062 6f6f 7473  ng.        boots
-000087c0: 7472 6170 5f6e 756d 5f72 6570 3a20 696e  trap_num_rep: in
-000087d0: 742c 206f 7074 696f 6e61 6c20 2864 6566  t, optional (def
-000087e0: 6175 6c74 3d31 3030 290a 2020 2020 2020  ault=100).      
-000087f0: 2020 2020 2020 6e75 6d62 6572 206f 6620        number of 
-00008800: 7265 7072 6561 7473 2069 6e20 626c 6f63  repreats in bloc
-00008810: 6b20 626f 6f74 7374 7261 7070 696e 670a  k bootstrapping.
-00008820: 2020 2020 2020 2020 7665 7262 6f73 653a          verbose:
-00008830: 2062 6f6f 6c2c 206f 7074 696f 6e61 6c20   bool, optional 
-00008840: 2864 6566 6175 6c74 3d46 616c 7365 290a  (default=False).
-00008850: 2020 2020 2020 2020 2020 2020 6966 2076              if v
-00008860: 6572 626f 7365 2069 7320 7472 7565 2c20  erbose is true, 
-00008870: 7468 6520 6465 7461 696c 6564 2069 6e66  the detailed inf
-00008880: 6f72 6d61 7469 6f6e 206f 6620 736f 6c76  ormation of solv
-00008890: 696e 6720 4d42 4152 2065 7175 6174 696f  ing MBAR equatio
-000088a0: 6e73 0a20 2020 2020 2020 2020 2020 2069  ns.            i
-000088b0: 7320 7072 696e 7465 642e 0a20 2020 2020  s printed..     
-000088c0: 2020 206d 6574 686f 643a 2073 7472 2c20     method: str, 
-000088d0: 6f70 7469 6f6e 616c 2028 6465 6661 756c  optional (defaul
-000088e0: 743d 224e 6577 746f 6e22 290a 2020 2020  t="Newton").    
-000088f0: 2020 2020 2020 2020 7468 6520 6d65 7468          the meth
-00008900: 6f64 2075 7365 6420 746f 2073 6f6c 7665  od used to solve
-00008910: 2074 6865 204d 4241 5220 6571 7561 7469   the MBAR equati
-00008920: 6f6e 2e20 5468 6520 6465 6661 756c 7420  on. The default 
-00008930: 6973 204e 6577 746f 6e27 7320 6d65 7468  is Newton's meth
-00008940: 6f64 2e0a 2020 2020 2020 2020 2222 220a  od..        """.
-00008950: 0a20 2020 2020 2020 2023 2323 2320 6368  .        #### ch
-00008960: 6563 6b20 7468 6520 7061 7261 6d65 7465  eck the paramete
-00008970: 7273 3a20 656e 6572 6779 2061 6e64 206e  rs: energy and n
-00008980: 756d 5f63 6f6e 660a 2020 2020 2020 2020  um_conf.        
-00008990: 2323 204e 6f74 6520 7468 6174 2062 6f74  ## Note that bot
-000089a0: 6820 7365 6c66 2e65 6e65 7267 7920 616e  h self.energy an
-000089b0: 6420 7365 6c66 2e63 6f6e 6620 7769 6c6c  d self.conf will
-000089c0: 2062 6520 6f6e 2043 5055 7320 6e6f 206d   be on CPUs no m
-000089d0: 6174 7465 720a 2020 2020 2020 2020 2323  atter.        ##
-000089e0: 2069 6620 6375 6461 2069 7320 5472 7565   if cuda is True
-000089f0: 206f 7220 4661 6c73 652e 0a0a 2020 2020   or False...    
-00008a00: 2020 2020 2323 2065 6e65 7267 7920 6e65      ## energy ne
-00008a10: 6564 7320 746f 2062 6520 6120 322d 4420  eds to be a 2-D 
-00008a20: 6e64 6172 7261 7920 6f72 2061 2032 2d44  ndarray or a 2-D
-00008a30: 2074 656e 736f 722e 0a20 2020 2020 2020   tensor..       
-00008a40: 2023 2320 636f 6e76 6572 7420 6974 2069   ## convert it i
-00008a50: 6e74 6f20 646f 7562 6c65 2070 7265 6369  nto double preci
-00008a60: 7369 6f6e 2069 6620 6e6f 740a 2020 2020  sion if not.    
-00008a70: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-00008a80: 6528 656e 6572 6779 2c20 6e70 2e6e 6461  e(energy, np.nda
-00008a90: 7272 6179 293a 0a20 2020 2020 2020 2020  rray):.         
-00008aa0: 2020 2065 6e65 7267 7920 3d20 656e 6572     energy = ener
-00008ab0: 6779 2e61 7374 7970 6528 6e70 2e66 6c6f  gy.astype(np.flo
-00008ac0: 6174 3634 290a 2020 2020 2020 2020 2020  at64).          
-00008ad0: 2020 7365 6c66 2e65 6e65 7267 7920 3d20    self.energy = 
-00008ae0: 746f 7263 682e 6672 6f6d 5f6e 756d 7079  torch.from_numpy
-00008af0: 2865 6e65 7267 7929 0a20 2020 2020 2020  (energy).       
-00008b00: 2065 6c69 6620 6973 696e 7374 616e 6365   elif isinstance
-00008b10: 2865 6e65 7267 792c 2074 6f72 6368 2e54  (energy, torch.T
-00008b20: 656e 736f 7229 3a0a 2020 2020 2020 2020  ensor):.        
-00008b30: 2020 2020 7365 6c66 2e65 6e65 7267 7920      self.energy 
-00008b40: 3d20 656e 6572 6779 2e64 6f75 626c 6528  = energy.double(
-00008b50: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
-00008b60: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00008b70: 6520 5479 7065 4572 726f 7228 2265 6e65  e TypeError("ene
-00008b80: 7267 7920 6861 7320 746f 2062 6520 6120  rgy has to be a 
-00008b90: 322d 4420 6e64 6172 7261 7920 6f72 2061  2-D ndarray or a
-00008ba0: 2032 2d44 2074 656e 736f 722e 2229 0a0a   2-D tensor.")..
-00008bb0: 2020 2020 2020 2020 2323 206e 756d 5f63          ## num_c
-00008bc0: 6f6e 6620 6e65 6564 7320 746f 2062 6520  onf needs to be 
-00008bd0: 6120 312d 4420 6e64 6172 7261 7920 6f72  a 1-D ndarray or
-00008be0: 2061 2031 2d44 2074 656e 736f 722e 0a20   a 1-D tensor.. 
-00008bf0: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-00008c00: 616e 6365 286e 756d 5f63 6f6e 662c 206e  ance(num_conf, n
-00008c10: 702e 6e64 6172 7261 7929 3a0a 2020 2020  p.ndarray):.    
-00008c20: 2020 2020 2020 2020 6e75 6d5f 636f 6e66          num_conf
-00008c30: 203d 206e 756d 5f63 6f6e 662e 6173 7479   = num_conf.asty
-00008c40: 7065 286e 702e 666c 6f61 7436 3429 0a20  pe(np.float64). 
-00008c50: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00008c60: 6e75 6d5f 636f 6e66 203d 2074 6f72 6368  num_conf = torch
-00008c70: 2e66 726f 6d5f 6e75 6d70 7928 6e75 6d5f  .from_numpy(num_
-00008c80: 636f 6e66 290a 2020 2020 2020 2020 656c  conf).        el
-00008c90: 6966 2069 7369 6e73 7461 6e63 6528 6e75  if isinstance(nu
-00008ca0: 6d5f 636f 6e66 2c20 746f 7263 682e 5465  m_conf, torch.Te
-00008cb0: 6e73 6f72 293a 0a20 2020 2020 2020 2020  nsor):.         
-00008cc0: 2020 2073 656c 662e 6e75 6d5f 636f 6e66     self.num_conf
-00008cd0: 203d 206e 756d 5f63 6f6e 662e 646f 7562   = num_conf.doub
-00008ce0: 6c65 2829 0a20 2020 2020 2020 2065 6c73  le().        els
-00008cf0: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
-00008d00: 6169 7365 2054 7970 6545 7272 6f72 2822  aise TypeError("
-00008d10: 6e75 6d5f 636f 6e66 2068 6173 2074 6f20  num_conf has to 
-00008d20: 6265 2061 2031 2d44 206e 6461 7272 6179  be a 1-D ndarray
-00008d30: 206f 7220 6120 312d 4420 7465 6e73 6f72   or a 1-D tensor
-00008d40: 2e22 290a 0a20 2020 2020 2020 2023 2320  .")..        ## 
-00008d50: 6368 6563 6b20 7468 6520 7368 6170 6520  check the shape 
-00008d60: 6f66 2065 6e65 7267 7920 616e 6420 6e75  of energy and nu
-00008d70: 6d5f 636f 6e66 0a20 2020 2020 2020 2069  m_conf.        i
-00008d80: 6620 656e 6572 6779 2e6e 6469 6d20 213d  f energy.ndim !=
-00008d90: 2032 3a0a 2020 2020 2020 2020 2020 2020   2:.            
-00008da0: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
-00008db0: 2822 656e 6572 6779 2068 6173 2074 6f20  ("energy has to 
-00008dc0: 6265 2061 2032 2d44 206e 6461 7272 6179  be a 2-D ndarray
-00008dd0: 206f 7220 6120 322d 4420 7465 6e73 6f72   or a 2-D tensor
-00008de0: 2e22 290a 2020 2020 2020 2020 6966 206e  .").        if n
-00008df0: 756d 5f63 6f6e 662e 6e64 696d 2021 3d20  um_conf.ndim != 
-00008e00: 313a 0a20 2020 2020 2020 2020 2020 2072  1:.            r
-00008e10: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-00008e20: 226e 756d 5f63 6f6e 6620 6861 7320 746f  "num_conf has to
-00008e30: 2062 6520 6120 312d 4420 6e64 6172 7261   be a 1-D ndarra
-00008e40: 7920 6f72 2061 2031 2d44 2074 656e 736f  y or a 1-D tenso
-00008e50: 722e 2229 0a20 2020 2020 2020 2069 6620  r.").        if 
-00008e60: 656e 6572 6779 2e73 6861 7065 5b30 5d20  energy.shape[0] 
-00008e70: 213d 206e 756d 5f63 6f6e 662e 7368 6170  != num_conf.shap
-00008e80: 655b 305d 3a0a 2020 2020 2020 2020 2020  e[0]:.          
-00008e90: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-00008ea0: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
-00008eb0: 2020 2020 2274 6865 206e 756d 6265 7220      "the number 
-00008ec0: 6f66 2072 6f77 7320 696e 2065 6e65 7267  of rows in energ
-00008ed0: 7920 6861 7320 746f 2062 6520 6571 7561  y has to be equa
-00008ee0: 6c20 746f 2074 6865 206c 656e 6774 6820  l to the length 
-00008ef0: 6f66 206e 756d 5f63 6f6e 662e 220a 2020  of num_conf.".  
-00008f00: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
-00008f10: 2020 2020 2023 2320 6368 6563 6b20 6966       ## check if
-00008f20: 2074 6865 206e 756d 6265 7220 6f66 2063   the number of c
-00008f30: 6f6e 666f 726d 6174 696f 6e73 2073 616d  onformations sam
-00008f40: 706c 6564 2066 726f 6d20 6561 6368 2073  pled from each s
-00008f50: 7461 7465 2069 7320 6772 6561 7465 7220  tate is greater 
-00008f60: 7468 616e 2030 0a20 2020 2020 2020 2069  than 0.        i
-00008f70: 6620 746f 7263 682e 7375 6d28 7365 6c66  f torch.sum(self
-00008f80: 2e6e 756d 5f63 6f6e 6620 3c3d 2030 2920  .num_conf <= 0) 
-00008f90: 3e20 303a 0a20 2020 2020 2020 2020 2020  > 0:.           
-00008fa0: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-00008fb0: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
-00008fc0: 2020 2022 616c 6c20 656e 7472 6965 7320     "all entries 
-00008fd0: 696e 206e 756d 5f63 6f6e 6620 6861 7665  in num_conf have
-00008fe0: 2074 6f20 6265 2073 7472 6963 746c 7920   to be strictly 
-00008ff0: 6772 6561 7465 7220 7468 616e 2030 2e22  greater than 0."
-00009000: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
-00009010: 2020 2020 2020 2020 2323 2063 6865 636b          ## check
-00009020: 2069 6620 7468 6520 746f 7461 6c20 6e75   if the total nu
-00009030: 6d62 6572 206f 6620 636f 6e66 6f72 6d61  mber of conforma
-00009040: 7469 6f6e 7320 6973 2065 7175 616c 2074  tions is equal t
-00009050: 6f20 7468 6520 6e75 6d62 6572 206f 6620  o the number of 
-00009060: 636f 6c75 6d6e 7320 696e 2065 6e65 7267  columns in energ
-00009070: 790a 2020 2020 2020 2020 6966 2074 6f72  y.        if tor
-00009080: 6368 2e73 756d 2873 656c 662e 6e75 6d5f  ch.sum(self.num_
-00009090: 636f 6e66 2920 213d 2073 656c 662e 656e  conf) != self.en
-000090a0: 6572 6779 2e73 6861 7065 5b31 5d3a 0a20  ergy.shape[1]:. 
-000090b0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-000090c0: 2056 616c 7565 4572 726f 7228 0a20 2020   ValueError(.   
-000090d0: 2020 2020 2020 2020 2020 2020 2022 7468               "th
-000090e0: 6520 7375 6d20 6f66 206e 756d 5f63 6f6e  e sum of num_con
-000090f0: 6620 6861 7320 746f 2062 6520 6571 7561  f has to be equa
-00009100: 6c20 746f 2074 6865 206e 756d 6265 7220  l to the number 
-00009110: 6f66 2063 6f6c 756d 6e73 2069 6e20 656e  of columns in en
-00009120: 6572 6779 2e22 0a20 2020 2020 2020 2020  ergy.".         
-00009130: 2020 2029 0a0a 2020 2020 2020 2020 7365     )..        se
-00009140: 6c66 2e4d 203d 2073 656c 662e 656e 6572  lf.M = self.ener
-00009150: 6779 2e73 6861 7065 5b30 5d0a 2020 2020  gy.shape[0].    
-00009160: 2020 2020 7365 6c66 2e4e 203d 2073 656c      self.N = sel
-00009170: 662e 656e 6572 6779 2e73 6861 7065 5b31  f.energy.shape[1
-00009180: 5d0a 0a20 2020 2020 2020 2073 656c 662e  ]..        self.
-00009190: 6375 6461 203d 2063 7564 610a 2020 2020  cuda = cuda.    
-000091a0: 2020 2020 6966 2073 656c 662e 6375 6461      if self.cuda
-000091b0: 2069 7320 5472 7565 3a0a 2020 2020 2020   is True:.      
-000091c0: 2020 2020 2020 7365 6c66 2e64 6576 6963        self.devic
-000091d0: 6520 3d20 746f 7263 682e 6465 7669 6365  e = torch.device
-000091e0: 2822 6375 6461 2229 0a20 2020 2020 2020  ("cuda").       
-000091f0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00009200: 2020 2073 656c 662e 6465 7669 6365 203d     self.device =
-00009210: 2074 6f72 6368 2e64 6576 6963 6528 2263   torch.device("c
-00009220: 7075 2229 0a0a 2020 2020 2020 2020 6966  pu")..        if
-00009230: 2073 656c 662e 6375 6461 3a0a 2020 2020   self.cuda:.    
-00009240: 2020 2020 2020 2020 2323 2063 6865 636b          ## check
-00009250: 2069 6620 7468 6520 4750 5520 6465 7669   if the GPU devi
-00009260: 6365 2068 6173 2065 6e6f 7567 6820 6d65  ce has enough me
-00009270: 6d6f 7279 2e20 4966 206e 6f74 2c20 6375  mory. If not, cu
-00009280: 6461 5f62 6174 6368 5f6d 6f64 6520 6973  da_batch_mode is
-00009290: 2074 7572 6e65 6420 6f6e 0a0a 2020 2020   turned on..    
-000092a0: 2020 2020 2020 2020 2323 2061 7574 6f6d          ## autom
-000092b0: 6174 6963 616c 6c79 2064 6574 6572 6d69  atically determi
-000092c0: 6e65 2069 6620 6375 6461 5f62 6174 6368  ne if cuda_batch
-000092d0: 5f6d 6f64 6520 6973 206f 6e20 6f72 206f  _mode is on or o
-000092e0: 6666 0a20 2020 2020 2020 2020 2020 2073  ff.            s
-000092f0: 656c 662e 5f74 6f74 616c 5f47 5055 5f6d  elf._total_GPU_m
-00009300: 656d 6f72 7920 3d20 746f 7263 682e 6375  emory = torch.cu
-00009310: 6461 2e67 6574 5f64 6576 6963 655f 7072  da.get_device_pr
-00009320: 6f70 6572 7469 6573 2830 292e 746f 7461  operties(0).tota
-00009330: 6c5f 6d65 6d6f 7279 0a20 2020 2020 2020  l_memory.       
-00009340: 2020 2020 2069 6620 280a 2020 2020 2020       if (.      
-00009350: 2020 2020 2020 2020 2020 7365 6c66 2e65            self.e
-00009360: 6e65 7267 792e 6e75 6d65 6c28 2920 2a20  nergy.numel() * 
-00009370: 7365 6c66 2e65 6e65 7267 792e 656c 656d  self.energy.elem
-00009380: 656e 745f 7369 7a65 2829 0a20 2020 2020  ent_size().     
-00009390: 2020 2020 2020 2020 2020 203c 2073 656c             < sel
-000093a0: 662e 5f74 6f74 616c 5f47 5055 5f6d 656d  f._total_GPU_mem
-000093b0: 6f72 7920 2f20 3130 0a20 2020 2020 2020  ory / 10.       
-000093c0: 2020 2020 2029 3a0a 2020 2020 2020 2020       ):.        
-000093d0: 2020 2020 2020 2020 7365 6c66 2e63 7564          self.cud
-000093e0: 615f 6261 7463 685f 6d6f 6465 203d 2046  a_batch_mode = F
-000093f0: 616c 7365 0a20 2020 2020 2020 2020 2020  alse.           
-00009400: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00009410: 2020 2020 2020 2073 656c 662e 6375 6461         self.cuda
-00009420: 5f62 6174 6368 5f6d 6f64 6520 3d20 5472  _batch_mode = Tr
-00009430: 7565 0a0a 2020 2020 2020 2020 2020 2020  ue..            
-00009440: 2323 2063 7564 615f 6261 7463 685f 6d6f  ## cuda_batch_mo
-00009450: 6465 2063 616e 2062 6520 656e 666f 7263  de can be enforc
-00009460: 6564 2062 7920 7061 7373 696e 6720 7468  ed by passing th
-00009470: 6520 6172 6775 6d65 6e74 2063 7564 615f  e argument cuda_
-00009480: 6261 7463 685f 6d6f 6465 0a20 2020 2020  batch_mode.     
-00009490: 2020 2020 2020 2069 6620 6375 6461 5f62         if cuda_b
-000094a0: 6174 6368 5f6d 6f64 6520 6973 206e 6f74  atch_mode is not
-000094b0: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-000094c0: 2020 2020 2020 2073 656c 662e 6375 6461         self.cuda
-000094d0: 5f62 6174 6368 5f6d 6f64 6520 3d20 6375  _batch_mode = cu
-000094e0: 6461 5f62 6174 6368 5f6d 6f64 650a 0a20  da_batch_mode.. 
-000094f0: 2020 2020 2020 2023 2320 7768 656e 2063         ## when c
-00009500: 7564 615f 6261 7463 685f 6d6f 6465 2069  uda_batch_mode i
-00009510: 7320 7573 6564 2c20 7765 206e 6565 6420  s used, we need 
-00009520: 746f 2064 6563 6964 6520 6f6e 2074 6865  to decide on the
-00009530: 2062 6174 6368 5f73 697a 6520 6261 7365   batch_size base
-00009540: 6420 6f6e 0a20 2020 2020 2020 2023 2320  d on.        ## 
-00009550: 626f 7468 2074 6865 206d 656d 6f72 7920  both the memory 
-00009560: 6f66 2074 6865 2047 5055 2064 6576 6963  of the GPU devic
-00009570: 6520 616e 6420 7468 6520 7369 7a65 206f  e and the size o
-00009580: 6620 656e 6572 6779 206d 6174 7269 780a  f energy matrix.
-00009590: 2020 2020 2020 2020 7365 6c66 2e5f 6261          self._ba
-000095a0: 7463 685f 7369 7a65 203d 204e 6f6e 650a  tch_size = None.
-000095b0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-000095c0: 6375 6461 2061 6e64 2073 656c 662e 6375  cuda and self.cu
-000095d0: 6461 5f62 6174 6368 5f6d 6f64 653a 0a20  da_batch_mode:. 
-000095e0: 2020 2020 2020 2020 2020 2023 2320 6261             ## ba
-000095f0: 7463 6820 7369 7a65 2066 6f72 2073 6570  tch size for sep
-00009600: 6572 6174 696e 6720 636f 6e66 6f72 6d61  erating conforma
-00009610: 7469 6f6e 730a 2020 2020 2020 2020 2020  tions.          
-00009620: 2020 7365 6c66 2e5f 6261 7463 685f 7369    self._batch_si
-00009630: 7a65 203d 2069 6e74 280a 2020 2020 2020  ze = int(.      
-00009640: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-00009650: 746f 7461 6c5f 4750 555f 6d65 6d6f 7279  total_GPU_memory
-00009660: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00009670: 202f 2032 300a 2020 2020 2020 2020 2020   / 20.          
-00009680: 2020 2020 2020 2f20 7365 6c66 2e65 6e65        / self.ene
-00009690: 7267 792e 7368 6170 655b 305d 0a20 2020  rgy.shape[0].   
-000096a0: 2020 2020 2020 2020 2020 2020 202f 2073               / s
-000096b0: 656c 662e 656e 6572 6779 2e65 6c65 6d65  elf.energy.eleme
-000096c0: 6e74 5f73 697a 6528 290a 2020 2020 2020  nt_size().      
-000096d0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-000096e0: 2020 2020 7365 6c66 2e5f 6261 7463 685f      self._batch_
-000096f0: 7369 7a65 203d 206d 696e 2831 3032 342c  size = min(1024,
-00009700: 2073 656c 662e 5f62 6174 6368 5f73 697a   self._batch_siz
-00009710: 6529 0a0a 2020 2020 2020 2020 2323 2077  e)..        ## w
-00009720: 6865 7468 6572 2074 6f20 7573 6520 626f  hether to use bo
-00009730: 6f74 7374 7261 7020 746f 2065 7374 696d  otstrap to estim
-00009740: 6174 6520 7468 6520 756e 6365 7274 6169  ate the uncertai
-00009750: 6e74 7920 6f66 2074 6865 2063 616c 6375  nty of the calcu
-00009760: 6c61 7465 6420 6672 6565 2065 6e65 7267  lated free energ
-00009770: 6965 730a 2020 2020 2020 2020 2323 2062  ies.        ## b
-00009780: 6f6f 7473 7472 6170 206e 6565 6473 2074  ootstrap needs t
-00009790: 6f20 6265 2061 2062 6f6f 6c65 616e 0a20  o be a boolean. 
-000097a0: 2020 2020 2020 2069 6620 6e6f 7420 6973         if not is
-000097b0: 696e 7374 616e 6365 2862 6f6f 7473 7472  instance(bootstr
-000097c0: 6170 2c20 626f 6f6c 293a 0a20 2020 2020  ap, bool):.     
-000097d0: 2020 2020 2020 2072 6169 7365 2054 7970         raise Typ
-000097e0: 6545 7272 6f72 2822 626f 6f74 7374 7261  eError("bootstra
-000097f0: 7020 6861 7320 746f 2062 6520 6120 626f  p has to be a bo
-00009800: 6f6c 6561 6e2e 2229 0a20 2020 2020 2020  olean.").       
-00009810: 2073 656c 662e 626f 6f74 7374 7261 7020   self.bootstrap 
-00009820: 3d20 626f 6f74 7374 7261 700a 0a20 2020  = bootstrap..   
-00009830: 2020 2020 2023 2320 626c 6f63 6b20 7369       ## block si
-00009840: 7a65 2075 7365 6420 696e 2062 6c6f 636b  ze used in block
-00009850: 2062 6f6f 7473 7472 6170 7069 6e67 0a20   bootstrapping. 
-00009860: 2020 2020 2020 2069 6620 6e6f 7420 6973         if not is
-00009870: 696e 7374 616e 6365 2862 6f6f 7473 7472  instance(bootstr
-00009880: 6170 5f62 6c6f 636b 5f73 697a 652c 2069  ap_block_size, i
-00009890: 6e74 293a 0a20 2020 2020 2020 2020 2020  nt):.           
-000098a0: 2072 6169 7365 2054 7970 6545 7272 6f72   raise TypeError
-000098b0: 2822 626f 6f74 7374 7261 705f 626c 6f63  ("bootstrap_bloc
-000098c0: 6b5f 7369 7a65 2068 6173 2074 6f20 6265  k_size has to be
-000098d0: 2061 6e20 696e 7465 6765 722e 2229 0a20   an integer."). 
-000098e0: 2020 2020 2020 2073 656c 662e 626f 6f74         self.boot
-000098f0: 7374 7261 705f 626c 6f63 6b5f 7369 7a65  strap_block_size
-00009900: 203d 2062 6f6f 7473 7472 6170 5f62 6c6f   = bootstrap_blo
-00009910: 636b 5f73 697a 650a 0a20 2020 2020 2020  ck_size..       
-00009920: 2023 2320 6e75 6d62 6572 206f 6620 7265   ## number of re
-00009930: 7065 6174 7320 696e 2062 6c6f 636b 2062  peats in block b
-00009940: 6f6f 7473 7472 6170 7069 6e67 0a20 2020  ootstrapping.   
-00009950: 2020 2020 2069 6620 6e6f 7420 6973 696e       if not isin
-00009960: 7374 616e 6365 2862 6f6f 7473 7472 6170  stance(bootstrap
-00009970: 5f6e 756d 5f72 6570 2c20 696e 7429 3a0a  _num_rep, int):.
-00009980: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00009990: 6520 5479 7065 4572 726f 7228 2262 6f6f  e TypeError("boo
-000099a0: 7473 7472 6170 5f6e 756d 5f72 6570 2068  tstrap_num_rep h
-000099b0: 6173 2074 6f20 6265 2061 6e20 696e 7465  as to be an inte
-000099c0: 6765 722e 2229 0a20 2020 2020 2020 2073  ger.").        s
-000099d0: 656c 662e 626f 6f74 7374 7261 705f 6e75  elf.bootstrap_nu
-000099e0: 6d5f 7265 7020 3d20 626f 6f74 7374 7261  m_rep = bootstra
-000099f0: 705f 6e75 6d5f 7265 700a 0a20 2020 2020  p_num_rep..     
-00009a00: 2020 2023 2320 7768 6574 6865 7220 746f     ## whether to
-00009a10: 2070 7269 6e74 2074 6865 2064 6574 6169   print the detai
-00009a20: 6c65 6420 696e 666f 726d 6174 696f 6e20  led information 
-00009a30: 6f66 2073 6f6c 7669 6e67 204d 4241 5220  of solving MBAR 
-00009a40: 6571 7561 7469 6f6e 730a 2020 2020 2020  equations.      
-00009a50: 2020 2323 2076 6572 626f 7365 206e 6565    ## verbose nee
-00009a60: 6473 2074 6f20 6265 2061 2062 6f6f 6c65  ds to be a boole
-00009a70: 616e 0a20 2020 2020 2020 2069 6620 6e6f  an.        if no
-00009a80: 7420 6973 696e 7374 616e 6365 2876 6572  t isinstance(ver
-00009a90: 626f 7365 2c20 626f 6f6c 293a 0a20 2020  bose, bool):.   
-00009aa0: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
-00009ab0: 7970 6545 7272 6f72 2822 7665 7262 6f73  ypeError("verbos
-00009ac0: 6520 6861 7320 746f 2062 6520 6120 626f  e has to be a bo
-00009ad0: 6f6c 6561 6e2e 2229 0a20 2020 2020 2020  olean.").       
-00009ae0: 2073 656c 662e 7665 7262 6f73 6520 3d20   self.verbose = 
-00009af0: 7665 7262 6f73 650a 0a20 2020 2020 2020  verbose..       
-00009b00: 2023 2320 6d65 7468 6f64 2075 7365 6420   ## method used 
-00009b10: 746f 2073 6f6c 7665 2074 6865 204d 4241  to solve the MBA
-00009b20: 5220 6571 7561 7469 6f6e 0a20 2020 2020  R equation.     
-00009b30: 2020 2069 6620 6e6f 7420 6973 696e 7374     if not isinst
-00009b40: 616e 6365 286d 6574 686f 642c 2073 7472  ance(method, str
-00009b50: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
-00009b60: 6169 7365 2054 7970 6545 7272 6f72 2822  aise TypeError("
-00009b70: 6d65 7468 6f64 2068 6173 2074 6f20 6265  method has to be
-00009b80: 2061 2073 7472 696e 672e 2229 0a20 2020   a string.").   
-00009b90: 2020 2020 2069 6620 6d65 7468 6f64 206e       if method n
-00009ba0: 6f74 2069 6e20 5b22 4e65 7774 6f6e 222c  ot in ["Newton",
-00009bb0: 2022 4c2d 4246 4753 2d42 225d 3a0a 2020   "L-BFGS-B"]:.  
-00009bc0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00009bd0: 5661 6c75 6545 7272 6f72 2822 6d65 7468  ValueError("meth
-00009be0: 6f64 2068 6173 2074 6f20 6265 204e 6577  od has to be New
-00009bf0: 746f 6e20 6f72 204c 2d42 4647 532d 422e  ton or L-BFGS-B.
-00009c00: 2229 0a20 2020 2020 2020 2073 656c 662e  ").        self.
-00009c10: 6d65 7468 6f64 203d 206d 6574 686f 640a  method = method.
-00009c20: 0a20 2020 2020 2020 2023 2320 736f 6c76  .        ## solv
-00009c30: 6520 7468 6520 4d42 4152 2065 7175 6174  e the MBAR equat
-00009c40: 696f 6e0a 2020 2020 2020 2020 6966 2073  ion.        if s
-00009c50: 656c 662e 626f 6f74 7374 7261 7020 6973  elf.bootstrap is
-00009c60: 2046 616c 7365 3a0a 2020 2020 2020 2020   False:.        
-00009c70: 2020 2020 6446 5f69 6e69 7420 3d20 7365      dF_init = se
-00009c80: 6c66 2e65 6e65 7267 792e 6e65 775f 7a65  lf.energy.new_ze
-00009c90: 726f 7328 7365 6c66 2e4d 202d 2031 290a  ros(self.M - 1).
-00009ca0: 2020 2020 2020 2020 2020 2020 6446 203d              dF =
-00009cb0: 205f 736f 6c76 655f 6d62 6172 280a 2020   _solve_mbar(.  
-00009cc0: 2020 2020 2020 2020 2020 2020 2020 6446                dF
-00009cd0: 5f69 6e69 742e 746f 2873 656c 662e 6465  _init.to(self.de
-00009ce0: 7669 6365 292c 0a20 2020 2020 2020 2020  vice),.         
-00009cf0: 2020 2020 2020 2073 656c 662e 656e 6572         self.ener
-00009d00: 6779 2e74 6f28 7365 6c66 2e64 6576 6963  gy.to(self.devic
-00009d10: 6529 2c0a 2020 2020 2020 2020 2020 2020  e),.            
-00009d20: 2020 2020 7365 6c66 2e6e 756d 5f63 6f6e      self.num_con
-00009d30: 662e 746f 2873 656c 662e 6465 7669 6365  f.to(self.device
-00009d40: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-00009d50: 2020 2073 656c 662e 6d65 7468 6f64 2c0a     self.method,.
-00009d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009d70: 7365 6c66 2e5f 6261 7463 685f 7369 7a65  self._batch_size
-00009d80: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00009d90: 2020 7665 7262 6f73 653d 7365 6c66 2e76    verbose=self.v
-00009da0: 6572 626f 7365 2c0a 2020 2020 2020 2020  erbose,.        
-00009db0: 2020 2020 292e 6370 7528 290a 0a20 2020      ).cpu()..   
-00009dc0: 2020 2020 2020 2020 2023 2320 7368 6966           ## shif
-00009dd0: 7420 7365 6c66 2e5f 4620 7375 6368 2074  t self._F such t
-00009de0: 6861 7420 5c73 756d 5f69 2046 5b69 5d2a  hat \sum_i F[i]*
-00009df0: 6e75 6d5f 636f 6e66 5b69 5d20 3d20 300a  num_conf[i] = 0.
-00009e00: 2020 2020 2020 2020 2020 2020 4620 3d20              F = 
-00009e10: 746f 7263 682e 6361 7428 5b64 462e 6e65  torch.cat([dF.ne
-00009e20: 775f 7a65 726f 7328 3129 2c20 6446 5d29  w_zeros(1), dF])
-00009e30: 0a20 2020 2020 2020 2020 2020 2070 6920  .            pi 
-00009e40: 3d20 7365 6c66 2e6e 756d 5f63 6f6e 6620  = self.num_conf 
-00009e50: 2f20 7365 6c66 2e4e 0a20 2020 2020 2020  / self.N.       
-00009e60: 2020 2020 2073 656c 662e 5f46 203d 2046       self._F = F
-00009e70: 202d 2074 6f72 6368 2e73 756d 2870 6920   - torch.sum(pi 
-00009e80: 2a20 4629 0a0a 2020 2020 2020 2020 2020  * F)..          
-00009e90: 2020 6220 3d20 2d73 656c 662e 5f46 202d    b = -self._F -
-00009ea0: 2074 6f72 6368 2e6c 6f67 2873 656c 662e   torch.log(self.
-00009eb0: 6e75 6d5f 636f 6e66 290a 2020 2020 2020  num_conf).      
-00009ec0: 2020 2020 2020 7365 6c66 2e5f 6c6f 675f        self._log_
-00009ed0: 7072 6f62 5f6d 6978 203d 2074 6f72 6368  prob_mix = torch
-00009ee0: 2e6c 6f67 7375 6d65 7870 282d 2873 656c  .logsumexp(-(sel
-00009ef0: 662e 656e 6572 6779 202b 2062 5b3a 2c20  f.energy + b[:, 
-00009f00: 4e6f 6e65 5d29 2c20 6469 6d3d 3029 0a20  None]), dim=0). 
-00009f10: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00009f20: 5f6c 6f67 5f6d 7520 3d20 2d73 656c 662e  _log_mu = -self.
-00009f30: 6c6f 675f 7072 6f62 5f6d 6978 0a0a 2020  log_prob_mix..  
-00009f40: 2020 2020 2020 2020 2020 2323 2043 6f6d            ## Com
-00009f50: 7075 7465 2073 656c 662e 5f46 5f63 6f76  pute self._F_cov
-00009f60: 2075 6e64 6572 2074 6865 2063 6f6e 7374   under the const
-00009f70: 7261 696e 7420 7468 6174 205c 7375 6d5f  raint that \sum_
-00009f80: 6920 465b 695d 2a6e 756d 5f63 6f6e 665b  i F[i]*num_conf[
-00009f90: 695d 203d 2030 0a0a 2020 2020 2020 2020  i] = 0..        
-00009fa0: 2020 2020 2323 2054 6865 7265 2061 7265      ## There are
-00009fb0: 2074 776f 2077 6179 7320 746f 2063 6f6d   two ways to com
-00009fc0: 7075 7465 2074 6865 2063 6f76 6172 6961  pute the covaria
-00009fd0: 6e63 6520 6d61 7472 6978 206f 6620 7365  nce matrix of se
-00009fe0: 6c66 2e5f 460a 2020 2020 2020 2020 2020  lf._F.          
-00009ff0: 2020 2323 2053 6565 2065 7175 6174 696f    ## See equatio
-0000a000: 6e20 342e 3220 616e 6420 362e 3420 696e  n 4.2 and 6.4 in
-0000a010: 2074 6865 2066 6f6c 6c6f 7769 6e67 2070   the following p
-0000a020: 6170 6572 2066 6f72 2064 6574 6169 6c73  aper for details
-0000a030: 0a20 2020 2020 2020 2020 2020 2023 2320  .            ## 
-0000a040: 224b 6f6e 672c 2041 2e2c 2065 7420 616c  "Kong, A., et al
-0000a050: 2e20 2241 2074 6865 6f72 7920 6f66 2073  . "A theory of s
-0000a060: 7461 7469 7374 6963 616c 206d 6f64 656c  tatistical model
-0000a070: 7320 666f 7220 4d6f 6e74 6520 4361 726c  s for Monte Carl
-0000a080: 6f20 696e 7465 6772 6174 696f 6e2e 220a  o integration.".
-0000a090: 2020 2020 2020 2020 2020 2020 2323 204a              ## J
-0000a0a0: 6f75 726e 616c 206f 6620 7468 6520 526f  ournal of the Ro
-0000a0b0: 7961 6c20 5374 6174 6973 7469 6361 6c20  yal Statistical 
-0000a0c0: 536f 6369 6574 7920 5365 7269 6573 2042  Society Series B
-0000a0d0: 3a20 5374 6174 6973 7469 6361 6c20 4d65  : Statistical Me
-0000a0e0: 7468 6f64 6f6c 6f67 7920 3635 2e33 0a20  thodology 65.3. 
-0000a0f0: 2020 2020 2020 2020 2020 2023 2320 2832             ## (2
-0000a100: 3030 3329 3a20 3538 352d 3630 342e 2220  003): 585-604." 
-0000a110: 6874 7470 733a 2f2f 646f 692e 6f72 672f  https://doi.org/
-0000a120: 3130 2e31 3131 312f 3134 3637 2d39 3836  10.1111/1467-986
-0000a130: 382e 3030 3430 340a 0a20 2020 2020 2020  8.00404..       
-0000a140: 2020 2020 2023 2320 5468 6520 6669 7273       ## The firs
-0000a150: 7420 7761 7920 6173 2073 686f 776e 2069  t way as shown i
-0000a160: 6e20 7468 6520 666f 6c6c 6f77 696e 6720  n the following 
-0000a170: 7573 6573 2065 7175 6174 696f 6e20 342e  uses equation 4.
-0000a180: 320a 2020 2020 2020 2020 2020 2020 2323  2.            ##
-0000a190: 2074 6869 7320 6d65 7468 6f64 2069 7320   this method is 
-0000a1a0: 6d6f 7265 2067 656e 6572 616c 2074 6861  more general tha
-0000a1b0: 6e20 7468 6520 666f 6c6c 6f77 696e 6720  n the following 
-0000a1c0: 6d65 7468 6f64 2c20 6d65 616e 696e 6720  method, meaning 
-0000a1d0: 7468 6174 0a20 2020 2020 2020 2020 2020  that.           
-0000a1e0: 2023 2320 6974 2063 616e 2061 6c73 6f20   ## it can also 
-0000a1f0: 6265 2075 7365 6420 746f 2063 6f6d 7075  be used to compu
-0000a200: 7465 2063 6f76 6172 6961 6e63 6520 6d61  te covariance ma
-0000a210: 7472 6978 2066 6f72 2070 6572 7475 7262  trix for perturb
-0000a220: 6564 2073 7461 7465 732e 0a20 2020 2020  ed states..     
-0000a230: 2020 2020 2020 2023 2320 5468 6572 6566         ## Theref
-0000a240: 6f72 6520 6974 2069 7320 7573 6564 2068  ore it is used h
-0000a250: 6572 652e 0a20 2020 2020 2020 2020 2020  ere..           
-0000a260: 2073 656c 662e 5020 3d20 746f 7263 682e   self.P = torch.
-0000a270: 6578 7028 0a20 2020 2020 2020 2020 2020  exp(.           
-0000a280: 2020 2020 202d 2873 656c 662e 656e 6572       -(self.ener
-0000a290: 6779 202d 2073 656c 662e 5f46 5b3a 2c20  gy - self._F[:, 
-0000a2a0: 4e6f 6e65 5d20 2b20 7365 6c66 2e5f 6c6f  None] + self._lo
-0000a2b0: 675f 7072 6f62 5f6d 6978 290a 2020 2020  g_prob_mix).    
-0000a2c0: 2020 2020 2020 2020 292e 7428 290a 2020          ).t().  
-0000a2d0: 2020 2020 2020 2020 2020 5720 3d20 746f            W = to
-0000a2e0: 7263 682e 6469 6167 2873 656c 662e 6e75  rch.diag(self.nu
-0000a2f0: 6d5f 636f 6e66 290a 2020 2020 2020 2020  m_conf).        
-0000a300: 2020 2020 512c 2052 203d 2074 6f72 6368      Q, R = torch
-0000a310: 2e6c 696e 616c 672e 7172 2873 656c 662e  .linalg.qr(self.
-0000a320: 5029 0a20 2020 2020 2020 2020 2020 2041  P).            A
-0000a330: 203d 2074 6f72 6368 2e65 7965 2873 656c   = torch.eye(sel
-0000a340: 662e 4d2c 2064 6576 6963 653d 572e 6465  f.M, device=W.de
-0000a350: 7669 6365 2920 2d20 5220 4020 5720 4020  vice) - R @ W @ 
-0000a360: 522e 540a 2020 2020 2020 2020 2020 2020  R.T.            
-0000a370: 7365 6c66 2e5f 465f 636f 7620 3d20 522e  self._F_cov = R.
-0000a380: 5420 4020 746f 7263 682e 6c69 6e61 6c67  T @ torch.linalg
-0000a390: 2e70 696e 7628 412c 2068 6572 6d69 7469  .pinv(A, hermiti
-0000a3a0: 616e 3d54 7275 652c 2072 746f 6c3d 3165  an=True, rtol=1e
-0000a3b0: 2d38 2920 4020 520a 0a20 2020 2020 2020  -8) @ R..       
-0000a3c0: 2020 2020 2023 2023 2054 6865 2073 6563       # # The sec
-0000a3d0: 6f6e 6420 7761 7920 7573 6573 2065 7175  ond way uses equ
-0000a3e0: 6174 696f 6e20 362e 340a 2020 2020 2020  ation 6.4.      
-0000a3f0: 2020 2020 2020 2320 6966 2073 656c 662e        # if self.
-0000a400: 5f62 6174 6368 5f73 697a 6520 6973 204e  _batch_size is N
-0000a410: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-0000a420: 2023 2020 2020 2048 203d 205f 636f 6d70   #     H = _comp
-0000a430: 7574 655f 6865 7373 6961 6e5f 6c6f 675f  ute_hessian_log_
-0000a440: 6c69 6b65 6c69 686f 6f64 5f6f 665f 4628  likelihood_of_F(
-0000a450: 0a20 2020 2020 2020 2020 2020 2023 2020  .            #  
-0000a460: 2020 2020 2020 2073 656c 662e 5f46 2c20         self._F, 
-0000a470: 7365 6c66 2e65 6e65 7267 792c 2073 656c  self.energy, sel
-0000a480: 662e 6e75 6d5f 636f 6e66 0a20 2020 2020  f.num_conf.     
-0000a490: 2020 2020 2020 2023 2020 2020 2029 0a20         #     ). 
-0000a4a0: 2020 2020 2020 2020 2020 2023 2065 6c73             # els
-0000a4b0: 653a 0a20 2020 2020 2020 2020 2020 2023  e:.            #
-0000a4c0: 2020 2020 2048 203d 205f 636f 6d70 7574       H = _comput
-0000a4d0: 655f 6865 7373 6961 6e5f 6c6f 675f 6c69  e_hessian_log_li
-0000a4e0: 6b65 6c69 686f 6f64 5f6f 665f 465f 696e  kelihood_of_F_in
-0000a4f0: 5f62 6174 6368 280a 2020 2020 2020 2020  _batch(.        
-0000a500: 2020 2020 2320 2020 2020 2020 2020 7365      #         se
-0000a510: 6c66 2e5f 462c 2073 656c 662e 656e 6572  lf._F, self.ener
-0000a520: 6779 2c20 7365 6c66 2e6e 756d 5f63 6f6e  gy, self.num_con
-0000a530: 662c 2073 656c 662e 5f62 6174 6368 5f73  f, self._batch_s
-0000a540: 697a 650a 2020 2020 2020 2020 2020 2020  ize.            
-0000a550: 2320 2020 2020 290a 2020 2020 2020 2020  #     ).        
-0000a560: 2020 2020 2320 4870 203d 2048 2e6e 6577      # Hp = H.new
-0000a570: 5f7a 6572 6f73 2828 7365 6c66 2e4d 202b  _zeros((self.M +
-0000a580: 2031 2c20 7365 6c66 2e4d 202b 2031 2929   1, self.M + 1))
-0000a590: 2e63 7075 2829 0a20 2020 2020 2020 2020  .cpu().         
-0000a5a0: 2020 2023 2048 705b 3020 3a20 7365 6c66     # Hp[0 : self
-0000a5b0: 2e4d 2c20 3020 3a20 7365 6c66 2e4d 5d20  .M, 0 : self.M] 
-0000a5c0: 3d20 480a 2020 2020 2020 2020 2020 2020  = H.            
-0000a5d0: 2320 4870 5b73 656c 662e 4d2c 2030 203a  # Hp[self.M, 0 :
-0000a5e0: 2073 656c 662e 4d5d 203d 202d 7365 6c66   self.M] = -self
-0000a5f0: 2e6e 756d 5f63 6f6e 660a 2020 2020 2020  .num_conf.      
-0000a600: 2020 2020 2020 2320 4870 5b30 203a 2073        # Hp[0 : s
-0000a610: 656c 662e 4d2c 2073 656c 662e 4d5d 203d  elf.M, self.M] =
-0000a620: 202d 7365 6c66 2e6e 756d 5f63 6f6e 660a   -self.num_conf.
-0000a630: 2020 2020 2020 2020 2020 2020 2320 4870              # Hp
-0000a640: 5b73 656c 662e 4d2c 2073 656c 662e 4d5d  [self.M, self.M]
-0000a650: 203d 2030 0a20 2020 2020 2020 2020 2020   = 0.           
-0000a660: 2023 2073 656c 662e 5f46 5f63 6f76 203d   # self._F_cov =
-0000a670: 2074 6f72 6368 2e6c 696e 616c 672e 696e   torch.linalg.in
-0000a680: 7628 2d48 7029 5b30 203a 2073 656c 662e  v(-Hp)[0 : self.
-0000a690: 4d2c 2030 203a 2073 656c 662e 4d5d 0a20  M, 0 : self.M]. 
-0000a6a0: 2020 2020 2020 2020 2020 2023 2073 656c             # sel
-0000a6b0: 662e 5f46 5f63 6f76 203d 2073 656c 662e  f._F_cov = self.
-0000a6c0: 5f46 5f63 6f76 202d 2074 6f72 6368 2e64  _F_cov - torch.d
-0000a6d0: 6961 6728 3120 2f20 7365 6c66 2e6e 756d  iag(1 / self.num
-0000a6e0: 5f63 6f6e 6629 202b 2031 202f 2073 656c  _conf) + 1 / sel
-0000a6f0: 662e 4e0a 0a20 2020 2020 2020 2020 2020  f.N..           
-0000a700: 2073 656c 662e 5f46 5f73 7464 203d 2073   self._F_std = s
-0000a710: 656c 662e 5f46 5f63 6f76 2e64 6961 676f  elf._F_cov.diago
-0000a720: 6e61 6c28 292e 7371 7274 2829 0a0a 2020  nal().sqrt()..  
-0000a730: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-0000a740: 4465 6c74 6146 203d 2073 656c 662e 5f46  DeltaF = self._F
-0000a750: 5b4e 6f6e 652c 203a 5d20 2d20 7365 6c66  [None, :] - self
-0000a760: 2e5f 465b 3a2c 204e 6f6e 655d 0a20 2020  ._F[:, None].   
-0000a770: 2020 2020 2020 2020 2073 656c 662e 5f44           self._D
-0000a780: 656c 7461 465f 636f 7620 3d20 280a 2020  eltaF_cov = (.  
-0000a790: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0000a7a0: 6c66 2e5f 465f 636f 762e 6469 6167 2829  lf._F_cov.diag()
-0000a7b0: 5b3a 2c20 4e6f 6e65 5d0a 2020 2020 2020  [:, None].      
-0000a7c0: 2020 2020 2020 2020 2020 2b20 7365 6c66            + self
-0000a7d0: 2e5f 465f 636f 762e 6469 6167 2829 5b4e  ._F_cov.diag()[N
-0000a7e0: 6f6e 652c 203a 5d0a 2020 2020 2020 2020  one, :].        
-0000a7f0: 2020 2020 2020 2020 2d20 3220 2a20 7365          - 2 * se
-0000a800: 6c66 2e5f 465f 636f 760a 2020 2020 2020  lf._F_cov.      
-0000a810: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-0000a820: 2020 2020 7365 6c66 2e5f 4465 6c74 6146      self._DeltaF
-0000a830: 5f73 7464 203d 2073 656c 662e 5f44 656c  _std = self._Del
-0000a840: 7461 465f 636f 762e 7371 7274 2829 0a0a  taF_cov.sqrt()..
-0000a850: 2020 2020 2020 2020 656c 6966 2073 656c          elif sel
-0000a860: 662e 626f 6f74 7374 7261 7020 6973 2054  f.bootstrap is T
-0000a870: 7275 653a 0a20 2020 2020 2020 2020 2020  rue:.           
-0000a880: 2064 4673 203d 205b 5d0a 2020 2020 2020   dFs = [].      
-0000a890: 2020 2020 2020 6c6f 675f 7072 6f62 5f6d        log_prob_m
-0000a8a0: 6978 203d 205b 5d0a 2020 2020 2020 2020  ix = [].        
-0000a8b0: 2020 2020 6446 5f69 6e69 7420 3d20 7365      dF_init = se
-0000a8c0: 6c66 2e65 6e65 7267 792e 6e65 775f 7a65  lf.energy.new_ze
-0000a8d0: 726f 7328 7365 6c66 2e4d 202d 2031 290a  ros(self.M - 1).
-0000a8e0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0000a8f0: 2e5f 636f 6e66 5f69 6478 203d 205b 5d0a  ._conf_idx = [].
-0000a900: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-0000a910: 5f20 696e 2072 616e 6765 2873 656c 662e  _ in range(self.
-0000a920: 626f 6f74 7374 7261 705f 6e75 6d5f 7265  bootstrap_num_re
-0000a930: 7029 3a0a 2020 2020 2020 2020 2020 2020  p):.            
-0000a940: 2020 2020 636f 6e66 5f69 6478 203d 205f      conf_idx = _
-0000a950: 626f 6f74 7374 7261 705f 636f 6e66 5f69  bootstrap_conf_i
-0000a960: 6478 280a 2020 2020 2020 2020 2020 2020  dx(.            
-0000a970: 2020 2020 2020 2020 7365 6c66 2e6e 756d          self.num
-0000a980: 5f63 6f6e 662e 746f 2874 6f72 6368 2e69  _conf.to(torch.i
-0000a990: 6e74 3634 292c 2073 656c 662e 626f 6f74  nt64), self.boot
-0000a9a0: 7374 7261 705f 626c 6f63 6b5f 7369 7a65  strap_block_size
-0000a9b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000a9c0: 2029 0a20 2020 2020 2020 2020 2020 2020   ).             
-0000a9d0: 2020 2064 4620 3d20 5f73 6f6c 7665 5f6d     dF = _solve_m
-0000a9e0: 6261 7228 0a20 2020 2020 2020 2020 2020  bar(.           
-0000a9f0: 2020 2020 2020 2020 2064 465f 696e 6974           dF_init
-0000aa00: 2e74 6f28 7365 6c66 2e64 6576 6963 6529  .to(self.device)
-0000aa10: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000aa20: 2020 2020 2020 7365 6c66 2e65 6e65 7267        self.energ
-0000aa30: 795b 3a2c 2063 6f6e 665f 6964 785d 2e74  y[:, conf_idx].t
-0000aa40: 6f28 7365 6c66 2e64 6576 6963 6529 2c0a  o(self.device),.
-0000aa50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000aa60: 2020 2020 7365 6c66 2e6e 756d 5f63 6f6e      self.num_con
-0000aa70: 662e 746f 2873 656c 662e 6465 7669 6365  f.to(self.device
-0000aa80: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-0000aa90: 2020 2020 2020 2073 656c 662e 6d65 7468         self.meth
-0000aaa0: 6f64 2c0a 2020 2020 2020 2020 2020 2020  od,.            
-0000aab0: 2020 2020 2020 2020 7365 6c66 2e5f 6261          self._ba
-0000aac0: 7463 685f 7369 7a65 2c0a 2020 2020 2020  tch_size,.      
-0000aad0: 2020 2020 2020 2020 2020 2020 2020 7665                ve
-0000aae0: 7262 6f73 653d 7365 6c66 2e76 6572 626f  rbose=self.verbo
-0000aaf0: 7365 2c0a 2020 2020 2020 2020 2020 2020  se,.            
-0000ab00: 2020 2020 292e 6370 7528 290a 2020 2020      ).cpu().    
-0000ab10: 2020 2020 2020 2020 2020 2020 6446 5f69              dF_i
-0000ab20: 6e69 7420 3d20 6446 0a20 2020 2020 2020  nit = dF.       
-0000ab30: 2020 2020 2020 2020 2064 4673 2e61 7070           dFs.app
-0000ab40: 656e 6428 6446 2e63 6c6f 6e65 2829 290a  end(dF.clone()).
-0000ab50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000ab60: 2046 203d 2074 6f72 6368 2e63 6174 285b   F = torch.cat([
-0000ab70: 6446 2e6e 6577 5f7a 6572 6f73 2831 292c  dF.new_zeros(1),
-0000ab80: 2064 465d 290a 2020 2020 2020 2020 2020   dF]).          
-0000ab90: 2020 2020 2020 2323 2073 6869 6674 2046        ## shift F
-0000aba0: 2073 7563 6820 7468 6174 205c 7375 6d5f   such that \sum_
-0000abb0: 6920 465b 695d 2a6e 756d 5f63 6f6e 665b  i F[i]*num_conf[
-0000abc0: 695d 203d 2030 0a20 2020 2020 2020 2020  i] = 0.         
-0000abd0: 2020 2020 2020 2070 6920 3d20 7365 6c66         pi = self
-0000abe0: 2e6e 756d 5f63 6f6e 6620 2f20 7365 6c66  .num_conf / self
-0000abf0: 2e4e 0a20 2020 2020 2020 2020 2020 2020  .N.             
-0000ac00: 2020 2046 203d 2046 202d 2074 6f72 6368     F = F - torch
-0000ac10: 2e73 756d 2870 6920 2a20 4629 0a0a 2020  .sum(pi * F)..  
-0000ac20: 2020 2020 2020 2020 2020 2020 2020 6220                b 
-0000ac30: 3d20 2d46 202d 2074 6f72 6368 2e6c 6f67  = -F - torch.log
-0000ac40: 2873 656c 662e 6e75 6d5f 636f 6e66 202f  (self.num_conf /
-0000ac50: 2073 656c 662e 4e29 0a20 2020 2020 2020   self.N).       
-0000ac60: 2020 2020 2020 2020 206c 6f67 5f70 726f           log_pro
-0000ac70: 625f 6d69 782e 6170 7065 6e64 280a 2020  b_mix.append(.  
-0000ac80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ac90: 2020 746f 7263 682e 6c6f 6773 756d 6578    torch.logsumex
-0000aca0: 7028 2d28 7365 6c66 2e65 6e65 7267 795b  p(-(self.energy[
-0000acb0: 3a2c 2063 6f6e 665f 6964 785d 202b 2062  :, conf_idx] + b
-0000acc0: 5b3a 2c20 4e6f 6e65 5d29 2c20 6469 6d3d  [:, None]), dim=
-0000acd0: 3029 0a20 2020 2020 2020 2020 2020 2020  0).             
-0000ace0: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-0000acf0: 2020 2020 2073 656c 662e 5f63 6f6e 665f       self._conf_
-0000ad00: 6964 782e 6170 7065 6e64 2863 6f6e 665f  idx.append(conf_
-0000ad10: 6964 7829 0a0a 2020 2020 2020 2020 2020  idx)..          
-0000ad20: 2020 6446 203d 2074 6f72 6368 2e73 7461    dF = torch.sta
-0000ad30: 636b 2864 4673 2c20 6469 6d3d 3129 0a20  ck(dFs, dim=1). 
-0000ad40: 2020 2020 2020 2020 2020 2046 203d 2074             F = t
-0000ad50: 6f72 6368 2e63 6174 285b 6446 2e6e 6577  orch.cat([dF.new
-0000ad60: 5f7a 6572 6f73 2831 2c20 6446 2e73 6861  _zeros(1, dF.sha
-0000ad70: 7065 5b31 5d29 2c20 6446 5d2c 2064 696d  pe[1]), dF], dim
-0000ad80: 3d30 290a 0a20 2020 2020 2020 2020 2020  =0)..           
-0000ad90: 2023 2320 7368 6966 7420 4620 7375 6368   ## shift F such
-0000ada0: 2074 6861 7420 5c73 756d 5f69 2046 5b69   that \sum_i F[i
-0000adb0: 5d2a 6e75 6d5f 636f 6e66 5b69 5d20 3d20  ]*num_conf[i] = 
-0000adc0: 300a 2020 2020 2020 2020 2020 2020 7069  0.            pi
-0000add0: 203d 2073 656c 662e 6e75 6d5f 636f 6e66   = self.num_conf
-0000ade0: 202f 2073 656c 662e 4e0a 2020 2020 2020   / self.N.      
-0000adf0: 2020 2020 2020 7365 6c66 2e5f 465f 626f        self._F_bo
-0000ae00: 6f74 7374 7261 7020 3d20 4620 2d20 746f  otstrap = F - to
-0000ae10: 7263 682e 7375 6d28 7069 5b3a 2c20 4e6f  rch.sum(pi[:, No
-0000ae20: 6e65 5d20 2a20 462c 2064 696d 3d30 290a  ne] * F, dim=0).
-0000ae30: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0000ae40: 662e 5f46 203d 2074 6f72 6368 2e6d 6561  f._F = torch.mea
-0000ae50: 6e28 7365 6c66 2e5f 465f 626f 6f74 7374  n(self._F_bootst
-0000ae60: 7261 702c 2064 696d 3d31 290a 2020 2020  rap, dim=1).    
-0000ae70: 2020 2020 2020 2020 7365 6c66 2e5f 465f          self._F_
-0000ae80: 7374 6420 3d20 746f 7263 682e 7374 6428  std = torch.std(
-0000ae90: 7365 6c66 2e5f 465f 626f 6f74 7374 7261  self._F_bootstra
-0000aea0: 702c 2064 696d 3d31 290a 2020 2020 2020  p, dim=1).      
-0000aeb0: 2020 2020 2020 7365 6c66 2e5f 465f 636f        self._F_co
-0000aec0: 7620 3d20 746f 7263 682e 636f 7628 7365  v = torch.cov(se
-0000aed0: 6c66 2e5f 465f 626f 6f74 7374 7261 7029  lf._F_bootstrap)
-0000aee0: 0a0a 2020 2020 2020 2020 2020 2020 7365  ..            se
-0000aef0: 6c66 2e5f 6c6f 675f 7072 6f62 5f6d 6978  lf._log_prob_mix
-0000af00: 203d 2074 6f72 6368 2e73 7461 636b 286c   = torch.stack(l
-0000af10: 6f67 5f70 726f 625f 6d69 782c 2064 696d  og_prob_mix, dim
-0000af20: 3d30 290a 2020 2020 2020 2020 2020 2020  =0).            
-0000af30: 4465 6c74 6146 203d 2064 465b 4e6f 6e65  DeltaF = dF[None
-0000af40: 2c20 3a2c 203a 5d20 2d20 6446 5b3a 2c20  , :, :] - dF[:, 
-0000af50: 4e6f 6e65 2c20 3a5d 0a20 2020 2020 2020  None, :].       
-0000af60: 2020 2020 2073 656c 662e 5f44 656c 7461       self._Delta
-0000af70: 4620 3d20 746f 7263 682e 6d65 616e 2844  F = torch.mean(D
-0000af80: 656c 7461 462c 2064 696d 3d32 290a 2020  eltaF, dim=2).  
-0000af90: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-0000afa0: 4465 6c74 6146 5f73 7464 203d 2074 6f72  DeltaF_std = tor
-0000afb0: 6368 2e73 7464 2844 656c 7461 462c 2064  ch.std(DeltaF, d
-0000afc0: 696d 3d32 290a 0a20 2020 2040 7072 6f70  im=2)..    @prop
-0000afd0: 6572 7479 0a20 2020 2064 6566 2046 2873  erty.    def F(s
-0000afe0: 656c 6629 202d 3e20 6e70 2e6e 6461 7272  elf) -> np.ndarr
-0000aff0: 6179 3a0a 2020 2020 2020 2020 2222 2246  ay:.        """F
-0000b000: 7265 6520 656e 6572 6769 6573 206f 6620  ree energies of 
-0000b010: 7468 6520 7374 6174 6573 2075 6e64 6572  the states under
-0000b020: 2074 6865 2063 6f6e 7374 7261 696e 7420   the constraint 
-0000b030: 3a6d 6174 683a 605c 7375 6d5f 7b6b 3d31  :math:`\sum_{k=1
-0000b040: 7d5e 7b4d 7d20 4e5f 6b20 2a20 465f 6b20  }^{M} N_k * F_k 
-0000b050: 3d20 3060 2c0a 2020 2020 2020 2020 7768  = 0`,.        wh
-0000b060: 6572 6520 3a6d 6174 683a 604e 5f6b 6020  ere :math:`N_k` 
-0000b070: 6973 2074 6865 206e 756d 6265 7220 6f66  is the number of
-0000b080: 2063 6f6e 666f 726d 6174 696f 6e73 2073   conformations s
-0000b090: 616d 706c 6564 2066 726f 6d20 7374 6174  ampled from stat
-0000b0a0: 6520 6b2e 0a20 2020 2020 2020 2022 2222  e k..        """
-0000b0b0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0000b0c0: 7365 6c66 2e5f 462e 6370 7528 292e 6e75  self._F.cpu().nu
-0000b0d0: 6d70 7928 290a 0a20 2020 2040 7072 6f70  mpy()..    @prop
-0000b0e0: 6572 7479 0a20 2020 2064 6566 2046 5f73  erty.    def F_s
-0000b0f0: 7464 2873 656c 6629 202d 3e20 6e70 2e6e  td(self) -> np.n
-0000b100: 6461 7272 6179 3a0a 2020 2020 2020 2020  darray:.        
-0000b110: 2222 2253 7461 6e64 6172 6420 6465 7669  """Standard devi
-0000b120: 6174 696f 6e20 6f66 2074 6865 2066 7265  ation of the fre
-0000b130: 6520 656e 6572 6769 6573 206f 6620 7468  e energies of th
-0000b140: 6520 7374 6174 6573 2075 6e64 6572 2074  e states under t
-0000b150: 6865 2063 6f6e 7374 7261 696e 740a 2020  he constraint.  
-0000b160: 2020 2020 2020 3a6d 6174 683a 605c 7375        :math:`\su
-0000b170: 6d5f 7b6b 3d31 7d5e 7b4d 7d20 4e5f 6b20  m_{k=1}^{M} N_k 
-0000b180: 2a20 465f 6b20 3d20 3060 2c0a 2020 2020  * F_k = 0`,.    
-0000b190: 2020 2020 7768 6572 6520 3a6d 6174 683a      where :math:
-0000b1a0: 604e 5f6b 6020 6973 2074 6865 206e 756d  `N_k` is the num
-0000b1b0: 6265 7220 6f66 2063 6f6e 666f 726d 6174  ber of conformat
-0000b1c0: 696f 6e73 2073 616d 706c 6564 2066 726f  ions sampled fro
-0000b1d0: 6d20 7374 6174 6520 6b2e 0a20 2020 2020  m state k..     
-0000b1e0: 2020 2022 2222 0a20 2020 2020 2020 2072     """.        r
-0000b1f0: 6574 7572 6e20 7365 6c66 2e5f 465f 7374  eturn self._F_st
-0000b200: 642e 6370 7528 292e 6e75 6d70 7928 290a  d.cpu().numpy().
-0000b210: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
-0000b220: 2020 2064 6566 2046 5f63 6f76 2873 656c     def F_cov(sel
-0000b230: 6629 202d 3e20 6e70 2e6e 6461 7272 6179  f) -> np.ndarray
-0000b240: 3a0a 2020 2020 2020 2020 2222 2243 6f76  :.        """Cov
-0000b250: 6172 6961 6e63 6520 6d61 7472 6978 206f  ariance matrix o
-0000b260: 6620 7468 6520 6672 6565 2065 6e65 7267  f the free energ
-0000b270: 6965 7320 6f66 2074 6865 2073 7461 7465  ies of the state
-0000b280: 7320 756e 6465 7220 7468 6520 636f 6e73  s under the cons
-0000b290: 7472 6169 6e74 0a20 2020 2020 2020 203a  traint.        :
-0000b2a0: 6d61 7468 3a60 5c73 756d 5f7b 6b3d 317d  math:`\sum_{k=1}
-0000b2b0: 5e7b 4d7d 204e 5f6b 202a 2046 5f6b 203d  ^{M} N_k * F_k =
-0000b2c0: 2030 602c 0a20 2020 2020 2020 2077 6865   0`,.        whe
-0000b2d0: 7265 203a 6d61 7468 3a60 4e5f 6b60 2069  re :math:`N_k` i
-0000b2e0: 7320 7468 6520 6e75 6d62 6572 206f 6620  s the number of 
-0000b2f0: 636f 6e66 6f72 6d61 7469 6f6e 7320 7361  conformations sa
-0000b300: 6d70 6c65 6420 6672 6f6d 2073 7461 7465  mpled from state
-0000b310: 206b 2e0a 2020 2020 2020 2020 2222 220a   k..        """.
-0000b320: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0000b330: 656c 662e 5f46 5f63 6f76 2e63 7075 2829  elf._F_cov.cpu()
-0000b340: 2e6e 756d 7079 2829 0a0a 2020 2020 4070  .numpy()..    @p
-0000b350: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-0000b360: 4465 6c74 6146 2873 656c 6629 202d 3e20  DeltaF(self) -> 
-0000b370: 6e70 2e6e 6461 7272 6179 3a0a 2020 2020  np.ndarray:.    
-0000b380: 2020 2020 2222 2246 7265 6520 656e 6572      """Free ener
-0000b390: 6779 2064 6966 6665 7265 6e63 6520 6265  gy difference be
-0000b3a0: 7477 6565 6e20 7374 6174 6573 2e0a 2020  tween states..  
-0000b3b0: 2020 2020 2020 3a6d 6174 683a 605c 6d61        :math:`\ma
-0000b3c0: 7468 726d 7b44 656c 7461 467d 5b69 2c6a  thrm{DeltaF}[i,j
-0000b3d0: 5d60 2069 7320 7468 6520 6672 6565 2065  ]` is the free e
-0000b3e0: 6e65 7267 7920 6469 6666 6572 656e 6365  nergy difference
-0000b3f0: 2062 6574 7765 656e 2073 7461 7465 206a   between state j
-0000b400: 2061 6e64 2073 7461 7465 2069 2c0a 2020   and state i,.  
-0000b410: 2020 2020 2020 692e 652e 2c20 3a6d 6174        i.e., :mat
-0000b420: 683a 605c 6d61 7468 726d 7b44 656c 7461  h:`\mathrm{Delta
-0000b430: 467d 5b69 2c6a 5d20 3d20 465b 6a5d 202d  F}[i,j] = F[j] -
-0000b440: 2046 5b69 5d60 202e 0a20 2020 2020 2020   F[i]` ..       
-0000b450: 2022 2222 0a20 2020 2020 2020 2072 6574   """.        ret
-0000b460: 7572 6e20 7365 6c66 2e5f 4465 6c74 6146  urn self._DeltaF
-0000b470: 2e63 7075 2829 2e6e 756d 7079 2829 0a0a  .cpu().numpy()..
-0000b480: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
-0000b490: 2020 6465 6620 4465 6c74 6146 5f73 7464    def DeltaF_std
-0000b4a0: 2873 656c 6629 202d 3e20 6e70 2e6e 6461  (self) -> np.nda
-0000b4b0: 7272 6179 3a0a 2020 2020 2020 2020 2222  rray:.        ""
-0000b4c0: 2253 7461 6e64 6172 6420 6465 7669 6174  "Standard deviat
-0000b4d0: 696f 6e20 6f66 2074 6865 2066 7265 6520  ion of the free 
-0000b4e0: 656e 6572 6779 2064 6966 6665 7265 6e63  energy differenc
-0000b4f0: 6520 6265 7477 6565 6e20 7374 6174 6573  e between states
-0000b500: 2e0a 2020 2020 2020 2020 3a6d 6174 683a  ..        :math:
-0000b510: 605c 6d61 7468 726d 7b44 656c 7461 465f  `\mathrm{DeltaF_
-0000b520: 7374 647d 5b69 2c6a 5d60 2069 7320 7468  std}[i,j]` is th
-0000b530: 6520 7374 616e 6461 7264 2064 6576 6961  e standard devia
-0000b540: 7469 6f6e 206f 6620 7468 6520 6672 6565  tion of the free
-0000b550: 2065 6e65 7267 790a 2020 2020 2020 2020   energy.        
-0000b560: 6469 6666 6572 656e 6365 203a 6d61 7468  difference :math
-0000b570: 3a60 5c6d 6174 6872 6d7b 4465 6c74 6146  :`\mathrm{DeltaF
-0000b580: 7d5b 692c 6a5d 602e 0a20 2020 2020 2020  }[i,j]`..       
-0000b590: 2022 2222 0a20 2020 2020 2020 2072 6574   """.        ret
-0000b5a0: 7572 6e20 7365 6c66 2e5f 4465 6c74 6146  urn self._DeltaF
-0000b5b0: 5f73 7464 2e63 7075 2829 2e6e 756d 7079  _std.cpu().numpy
-0000b5c0: 2829 0a0a 2020 2020 4070 726f 7065 7274  ()..    @propert
-0000b5d0: 790a 2020 2020 6465 6620 6c6f 675f 7072  y.    def log_pr
-0000b5e0: 6f62 5f6d 6978 2873 656c 6629 202d 3e20  ob_mix(self) -> 
-0000b5f0: 6e70 2e6e 6461 7272 6179 3a0a 2020 2020  np.ndarray:.    
-0000b600: 2020 2020 2222 2274 6865 206c 6f67 2070      """the log p
-0000b610: 726f 6261 6269 6c69 7479 2064 656e 7369  robability densi
-0000b620: 7479 206f 6620 636f 6e66 6f72 6d61 7469  ty of conformati
-0000b630: 6f6e 7320 696e 2074 6865 206d 6978 7475  ons in the mixtu
-0000b640: 7265 2064 6973 7472 6962 7574 696f 6e2e  re distribution.
-0000b650: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
-0000b660: 726e 2073 656c 662e 5f6c 6f67 5f70 726f  rn self._log_pro
-0000b670: 625f 6d69 782e 6370 7528 292e 6e75 6d70  b_mix.cpu().nump
-0000b680: 7928 290a 0a20 2020 2064 6566 2063 616c  y()..    def cal
-0000b690: 6375 6c61 7465 5f66 7265 655f 656e 6572  culate_free_ener
-0000b6a0: 6769 6573 5f6f 665f 7065 7274 7572 6265  gies_of_perturbe
-0000b6b0: 645f 7374 6174 6573 2873 656c 662c 2065  d_states(self, e
-0000b6c0: 6e65 7267 795f 7065 7274 7572 6265 6429  nergy_perturbed)
-0000b6d0: 3a0a 2020 2020 2020 2020 2222 2263 616c  :.        """cal
-0000b6e0: 6375 6c61 7465 2066 7265 6520 656e 6572  culate free ener
-0000b6f0: 6769 6573 2066 6f72 2070 6572 7475 7262  gies for perturb
-0000b700: 6564 2073 7461 7465 732e 0a0a 2020 2020  ed states...    
-0000b710: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
-0000b720: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-0000b730: 2d2d 0a20 2020 2020 2020 2065 6e65 7267  --.        energ
-0000b740: 795f 7065 7274 7572 6265 643a 2032 2d44  y_perturbed: 2-D
-0000b750: 2066 6c6f 6174 206e 6461 7272 6179 2077   float ndarray w
-0000b760: 6974 6820 7369 7a65 206f 6620 284c 2c4e  ith size of (L,N
-0000b770: 290a 2020 2020 2020 2020 2020 2020 6561  ).            ea
-0000b780: 6368 2072 6f77 206f 6620 7468 6520 656e  ch row of the en
-0000b790: 6572 6779 5f70 6572 7475 7262 6564 206d  ergy_perturbed m
-0000b7a0: 6174 7269 7820 7265 7072 6573 656e 7473  atrix represents
-0000b7b0: 2061 2073 7461 7465 2061 6e64 0a20 2020   a state and.   
-0000b7c0: 2020 2020 2020 2020 2074 6865 2076 616c           the val
-0000b7d0: 7565 2065 6e65 7267 795f 7065 7274 7572  ue energy_pertur
-0000b7e0: 6265 645b 6c2c 6e5d 2072 6570 7265 7365  bed[l,n] represe
-0000b7f0: 6e74 7320 7468 6520 7265 6475 6365 6420  nts the reduced 
-0000b800: 656e 6572 6779 0a20 2020 2020 2020 2020  energy.         
-0000b810: 2020 206f 6620 7468 6520 6e27 7468 2063     of the n'th c
-0000b820: 6f6e 666f 726d 6174 696f 6e20 696e 2074  onformation in t
-0000b830: 6865 206c 2774 6820 7065 7274 7572 6265  he l'th perturbe
-0000b840: 6420 7374 6174 652e 0a0a 2020 2020 2020  d state...      
-0000b850: 2020 5265 7475 726e 730a 2020 2020 2020    Returns.      
-0000b860: 2020 2d2d 2d2d 2d2d 2d0a 2020 2020 2020    -------.      
-0000b870: 2020 7265 7375 6c74 733a 2064 6963 740a    results: dict.
-0000b880: 2020 2020 2020 2020 2020 2020 6120 6469              a di
-0000b890: 6374 696f 6e61 7279 2063 6f6e 7461 696e  ctionary contain
-0000b8a0: 696e 6720 7468 6520 666f 6c6c 6f77 696e  ing the followin
-0000b8b0: 6720 6b65 7973 3a0a 0a20 2020 2020 2020  g keys:..       
-0000b8c0: 2020 2020 202a 2a46 2a2a 202d 2074 6865       **F** - the
-0000b8d0: 2066 7265 6520 656e 6572 6779 206f 6620   free energy of 
-0000b8e0: 7468 6520 7065 7274 7572 6265 6420 7374  the perturbed st
-0000b8f0: 6174 6573 2e0a 0a20 2020 2020 2020 2020  ates...         
-0000b900: 2020 202a 2a46 5f73 7464 2a2a 202d 2074     **F_std** - t
-0000b910: 6865 2073 7461 6e64 6172 6420 6465 7669  he standard devi
-0000b920: 6174 696f 6e20 6f66 2074 6865 2066 7265  ation of the fre
-0000b930: 6520 656e 6572 6779 206f 6620 7468 6520  e energy of the 
-0000b940: 7065 7274 7572 6265 6420 7374 6174 6573  perturbed states
-0000b950: 2e20 0a0a 2020 2020 2020 2020 2020 2020  . ..            
-0000b960: 2a2a 465f 636f 762a 2a20 2d20 7468 6520  **F_cov** - the 
-0000b970: 636f 7661 7269 616e 6365 2062 6574 7765  covariance betwe
-0000b980: 656e 2074 6865 2066 7265 6520 656e 6572  en the free ener
-0000b990: 6769 6573 206f 6620 7468 6520 7065 7274  gies of the pert
-0000b9a0: 7572 6265 6420 7374 6174 6573 2e0a 0a20  urbed states... 
-0000b9b0: 2020 2020 2020 2020 2020 202a 2a44 656c             **Del
-0000b9c0: 7461 462a 2a20 2d20 3a6d 6174 683a 605c  taF** - :math:`\
-0000b9d0: 6d61 7468 726d 7b44 656c 7461 467d 5b6b  mathrm{DeltaF}[k
-0000b9e0: 2c6c 5d60 2069 7320 7468 6520 6672 6565  ,l]` is the free
-0000b9f0: 2065 6e65 7267 7920 6469 6666 6572 656e   energy differen
-0000ba00: 6365 2062 6574 7765 656e 2073 7461 7465  ce between state
-0000ba10: 2020 2020 2020 2020 2020 2020 0a20 2020              .   
-0000ba20: 2020 2020 2020 2020 203a 6d61 7468 3a60           :math:`
-0000ba30: 6b60 2061 6e64 2073 7461 7465 203a 6d61  k` and state :ma
-0000ba40: 7468 3a60 6c60 2c20 692e 652e 2c20 3a6d  th:`l`, i.e., :m
-0000ba50: 6174 683a 605c 6d61 7468 726d 7b44 656c  ath:`\mathrm{Del
-0000ba60: 7461 467d 5b6b 2c6c 5d20 3d20 465b 6c5d  taF}[k,l] = F[l]
-0000ba70: 202d 2046 5b6b 5d60 202e 0a0a 2020 2020   - F[k]` ...    
-0000ba80: 2020 2020 2020 2020 2a2a 4465 6c74 6146          **DeltaF
-0000ba90: 5f73 7464 2a2a 202d 2074 6865 2073 7461  _std** - the sta
-0000baa0: 6e64 6172 6420 6465 7669 6174 696f 6e20  ndard deviation 
-0000bab0: 6f66 2074 6865 2066 7265 6520 656e 6572  of the free ener
-0000bac0: 6779 2064 6966 6665 7265 6e63 652e 0a20  gy difference.. 
-0000bad0: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
-0000bae0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-0000baf0: 6528 656e 6572 6779 5f70 6572 7475 7262  e(energy_perturb
-0000bb00: 6564 2c20 6e70 2e6e 6461 7272 6179 293a  ed, np.ndarray):
-0000bb10: 0a20 2020 2020 2020 2020 2020 2065 6e65  .            ene
-0000bb20: 7267 795f 7065 7274 7572 6265 6420 3d20  rgy_perturbed = 
-0000bb30: 656e 6572 6779 5f70 6572 7475 7262 6564  energy_perturbed
-0000bb40: 2e61 7374 7970 6528 6e70 2e66 6c6f 6174  .astype(np.float
-0000bb50: 3634 290a 2020 2020 2020 2020 2020 2020  64).            
-0000bb60: 656e 6572 6779 5f70 6572 7475 7262 6564  energy_perturbed
-0000bb70: 203d 2074 6f72 6368 2e66 726f 6d5f 6e75   = torch.from_nu
-0000bb80: 6d70 7928 656e 6572 6779 5f70 6572 7475  mpy(energy_pertu
-0000bb90: 7262 6564 290a 2020 2020 2020 2020 656c  rbed).        el
-0000bba0: 6966 2069 7369 6e73 7461 6e63 6528 656e  if isinstance(en
-0000bbb0: 6572 6779 5f70 6572 7475 7262 6564 2c20  ergy_perturbed, 
-0000bbc0: 746f 7263 682e 5465 6e73 6f72 293a 0a20  torch.Tensor):. 
-0000bbd0: 2020 2020 2020 2020 2020 2065 6e65 7267             energ
-0000bbe0: 795f 7065 7274 7572 6265 6420 3d20 656e  y_perturbed = en
-0000bbf0: 6572 6779 5f70 6572 7475 7262 6564 2e64  ergy_perturbed.d
-0000bc00: 6f75 626c 6528 290a 2020 2020 2020 2020  ouble().        
-0000bc10: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-0000bc20: 2020 7261 6973 6520 5479 7065 4572 726f    raise TypeErro
-0000bc30: 7228 2265 6e65 7267 795f 7065 7274 7572  r("energy_pertur
-0000bc40: 6265 6420 6861 7320 746f 2062 6520 6120  bed has to be a 
-0000bc50: 322d 4420 6e64 6172 7261 7920 6f72 2061  2-D ndarray or a
-0000bc60: 2032 2d44 2074 656e 736f 722e 2229 0a0a   2-D tensor.")..
-0000bc70: 2020 2020 2020 2020 6966 2065 6e65 7267          if energ
-0000bc80: 795f 7065 7274 7572 6265 642e 6e64 696d  y_perturbed.ndim
-0000bc90: 2021 3d20 323a 0a20 2020 2020 2020 2020   != 2:.         
-0000bca0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-0000bcb0: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
-0000bcc0: 2020 2020 2022 656e 6572 6779 5f70 6572       "energy_per
-0000bcd0: 7475 7262 6564 2068 6173 2074 6f20 6265  turbed has to be
-0000bce0: 2061 2032 2d44 206e 6461 7272 6179 206f   a 2-D ndarray o
-0000bcf0: 7220 6120 322d 4420 7465 6e73 6f72 2e22  r a 2-D tensor."
-0000bd00: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-0000bd10: 2020 2020 2020 2069 6620 656e 6572 6779         if energy
-0000bd20: 5f70 6572 7475 7262 6564 2e73 6861 7065  _perturbed.shape
-0000bd30: 5b31 5d20 213d 2073 656c 662e 656e 6572  [1] != self.ener
-0000bd40: 6779 2e73 6861 7065 5b31 5d3a 0a20 2020  gy.shape[1]:.   
-0000bd50: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-0000bd60: 616c 7565 4572 726f 7228 0a20 2020 2020  alueError(.     
-0000bd70: 2020 2020 2020 2020 2020 2022 7468 6520             "the 
-0000bd80: 6e75 6d62 6572 206f 6620 636f 6c75 6d6e  number of column
-0000bd90: 7320 696e 2065 6e65 7267 795f 7065 7274  s in energy_pert
-0000bda0: 7572 6265 6420 6861 7320 746f 2062 6520  urbed has to be 
-0000bdb0: 6571 7561 6c20 746f 2074 6865 206e 756d  equal to the num
-0000bdc0: 6265 7220 6f66 2063 6f6c 756d 6e73 2069  ber of columns i
-0000bdd0: 6e20 656e 6572 6779 2e22 0a20 2020 2020  n energy.".     
-0000bde0: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-0000bdf0: 2020 4c20 3d20 656e 6572 6779 5f70 6572    L = energy_per
-0000be00: 7475 7262 6564 2e73 6861 7065 5b30 5d0a  turbed.shape[0].
-0000be10: 0a20 2020 2020 2020 2046 203d 204e 6f6e  .        F = Non
-0000be20: 650a 2020 2020 2020 2020 465f 636f 7620  e.        F_cov 
-0000be30: 3d20 4e6f 6e65 0a20 2020 2020 2020 2046  = None.        F
-0000be40: 5f73 7464 203d 204e 6f6e 650a 0a20 2020  _std = None..   
-0000be50: 2020 2020 2069 6620 6e6f 7420 7365 6c66       if not self
-0000be60: 2e62 6f6f 7473 7472 6170 3a0a 2020 2020  .bootstrap:.    
-0000be70: 2020 2020 2020 2020 6475 203d 2065 6e65          du = ene
-0000be80: 7267 795f 7065 7274 7572 6265 6420 2b20  rgy_perturbed + 
-0000be90: 7365 6c66 2e5f 6c6f 675f 7072 6f62 5f6d  self._log_prob_m
-0000bea0: 6978 0a20 2020 2020 2020 2020 2020 2046  ix.            F
-0000beb0: 203d 202d 746f 7263 682e 6c6f 6773 756d   = -torch.logsum
-0000bec0: 6578 7028 2d64 752c 2064 696d 3d31 290a  exp(-du, dim=1).
-0000bed0: 0a20 2020 2020 2020 2020 2020 2046 5f65  .            F_e
-0000bee0: 7874 203d 2074 6f72 6368 2e63 6174 285b  xt = torch.cat([
-0000bef0: 7365 6c66 2e5f 462c 2046 5d29 0a20 2020  self._F, F]).   
-0000bf00: 2020 2020 2020 2020 2055 203d 2074 6f72           U = tor
-0000bf10: 6368 2e63 6174 285b 7365 6c66 2e65 6e65  ch.cat([self.ene
-0000bf20: 7267 792c 2065 6e65 7267 795f 7065 7274  rgy, energy_pert
-0000bf30: 7572 6265 645d 2c20 6469 6d3d 3029 2e74  urbed], dim=0).t
-0000bf40: 2829 0a20 2020 2020 2020 2020 2020 2050  ().            P
-0000bf50: 203d 2074 6f72 6368 2e65 7870 282d 2855   = torch.exp(-(U
-0000bf60: 202d 2046 5f65 7874 202b 2073 656c 662e   - F_ext + self.
-0000bf70: 5f6c 6f67 5f70 726f 625f 6d69 785b 3a2c  _log_prob_mix[:,
-0000bf80: 204e 6f6e 655d 2929 0a0a 2020 2020 2020   None]))..      
-0000bf90: 2020 2020 2020 5720 3d20 746f 7263 682e        W = torch.
-0000bfa0: 6469 6167 2874 6f72 6368 2e63 6174 285b  diag(torch.cat([
-0000bfb0: 7365 6c66 2e6e 756d 5f63 6f6e 662c 2073  self.num_conf, s
-0000bfc0: 656c 662e 6e75 6d5f 636f 6e66 2e6e 6577  elf.num_conf.new
-0000bfd0: 5f7a 6572 6f73 284c 295d 2929 0a20 2020  _zeros(L)])).   
-0000bfe0: 2020 2020 2020 2020 2051 2c20 5220 3d20           Q, R = 
-0000bff0: 746f 7263 682e 6c69 6e61 6c67 2e71 7228  torch.linalg.qr(
-0000c000: 5029 0a20 2020 2020 2020 2020 2020 2041  P).            A
-0000c010: 203d 2074 6f72 6368 2e65 7965 2873 656c   = torch.eye(sel
-0000c020: 662e 4d20 2b20 4c2c 2064 6576 6963 653d  f.M + L, device=
-0000c030: 572e 6465 7669 6365 2920 2d20 5220 4020  W.device) - R @ 
-0000c040: 5720 4020 522e 540a 2020 2020 2020 2020  W @ R.T.        
-0000c050: 2020 2020 465f 636f 7620 3d20 522e 5420      F_cov = R.T 
-0000c060: 4020 746f 7263 682e 6c69 6e61 6c67 2e70  @ torch.linalg.p
-0000c070: 696e 7628 412c 2068 6572 6d69 7469 616e  inv(A, hermitian
-0000c080: 3d54 7275 652c 2072 746f 6c3d 3165 2d38  =True, rtol=1e-8
-0000c090: 2920 4020 520a 0a20 2020 2020 2020 2020  ) @ R..         
-0000c0a0: 2020 2046 5f63 6f76 203d 2046 5f63 6f76     F_cov = F_cov
-0000c0b0: 5b73 656c 662e 4d20 3a2c 2073 656c 662e  [self.M :, self.
-0000c0c0: 4d20 3a5d 0a20 2020 2020 2020 2020 2020  M :].           
-0000c0d0: 2046 5f73 7464 203d 2046 5f63 6f76 2e64   F_std = F_cov.d
-0000c0e0: 6961 676f 6e61 6c28 292e 7371 7274 2829  iagonal().sqrt()
-0000c0f0: 0a0a 2020 2020 2020 2020 2020 2020 4465  ..            De
-0000c100: 6c74 6146 203d 2046 5b4e 6f6e 652c 203a  ltaF = F[None, :
-0000c110: 5d20 2d20 465b 3a2c 204e 6f6e 655d 0a20  ] - F[:, None]. 
-0000c120: 2020 2020 2020 2020 2020 2044 656c 7461             Delta
-0000c130: 465f 636f 7620 3d20 465f 636f 762e 6469  F_cov = F_cov.di
-0000c140: 6167 2829 5b3a 2c20 4e6f 6e65 5d20 2b20  ag()[:, None] + 
-0000c150: 465f 636f 762e 6469 6167 2829 5b4e 6f6e  F_cov.diag()[Non
-0000c160: 652c 203a 5d20 2d20 3220 2a20 465f 636f  e, :] - 2 * F_co
-0000c170: 760a 2020 2020 2020 2020 2020 2020 4465  v.            De
-0000c180: 6c74 6146 5f73 7464 203d 2044 656c 7461  ltaF_std = Delta
-0000c190: 465f 636f 762e 7371 7274 2829 0a20 2020  F_cov.sqrt().   
-0000c1a0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-0000c1b0: 2020 2020 2020 2046 5f6c 6973 7420 3d20         F_list = 
-0000c1c0: 5b5d 0a20 2020 2020 2020 2020 2020 2066  [].            f
-0000c1d0: 6f72 206b 2069 6e20 7261 6e67 6528 7365  or k in range(se
-0000c1e0: 6c66 2e62 6f6f 7473 7472 6170 5f6e 756d  lf.bootstrap_num
-0000c1f0: 5f72 6570 293a 0a20 2020 2020 2020 2020  _rep):.         
-0000c200: 2020 2020 2020 2064 7520 3d20 656e 6572         du = ener
-0000c210: 6779 5f70 6572 7475 7262 6564 5b3a 2c20  gy_perturbed[:, 
-0000c220: 7365 6c66 2e5f 636f 6e66 5f69 6478 5b6b  self._conf_idx[k
-0000c230: 5d5d 202b 2073 656c 662e 5f6c 6f67 5f70  ]] + self._log_p
-0000c240: 726f 625f 6d69 785b 6b5d 0a20 2020 2020  rob_mix[k].     
-0000c250: 2020 2020 2020 2020 2020 2046 203d 202d             F = -
-0000c260: 746f 7263 682e 6c6f 6773 756d 6578 7028  torch.logsumexp(
-0000c270: 2d64 752c 2064 696d 3d31 290a 2020 2020  -du, dim=1).    
-0000c280: 2020 2020 2020 2020 2020 2020 465f 6c69              F_li
-0000c290: 7374 2e61 7070 656e 6428 4629 0a20 2020  st.append(F).   
-0000c2a0: 2020 2020 2020 2020 2046 5f6c 6973 7420           F_list 
-0000c2b0: 3d20 746f 7263 682e 7374 6163 6b28 465f  = torch.stack(F_
-0000c2c0: 6c69 7374 2c20 6469 6d3d 3129 0a20 2020  list, dim=1).   
-0000c2d0: 2020 2020 2020 2020 2046 203d 2074 6f72           F = tor
-0000c2e0: 6368 2e6d 6561 6e28 465f 6c69 7374 2c20  ch.mean(F_list, 
-0000c2f0: 6469 6d3d 3129 0a20 2020 2020 2020 2020  dim=1).         
-0000c300: 2020 2046 5f73 7464 203d 2074 6f72 6368     F_std = torch
-0000c310: 2e73 7464 2846 5f6c 6973 742c 2064 696d  .std(F_list, dim
-0000c320: 3d31 290a 2020 2020 2020 2020 2020 2020  =1).            
-0000c330: 465f 636f 7620 3d20 746f 7263 682e 636f  F_cov = torch.co
-0000c340: 7628 465f 6c69 7374 290a 0a20 2020 2020  v(F_list)..     
-0000c350: 2020 2020 2020 2044 656c 7461 4620 3d20         DeltaF = 
-0000c360: 465b 4e6f 6e65 2c20 3a5d 202d 2046 5b3a  F[None, :] - F[:
-0000c370: 2c20 4e6f 6e65 5d0a 2020 2020 2020 2020  , None].        
-0000c380: 2020 2020 4465 6c74 6146 5f73 7464 203d      DeltaF_std =
-0000c390: 2074 6f72 6368 2e73 7464 2846 5f6c 6973   torch.std(F_lis
-0000c3a0: 745b 3a2c 203a 2c20 4e6f 6e65 5d20 2d20  t[:, :, None] - 
-0000c3b0: 465f 6c69 7374 5b3a 2c20 4e6f 6e65 2c20  F_list[:, None, 
-0000c3c0: 3a5d 2c20 6469 6d3d 3129 0a0a 2020 2020  :], dim=1)..    
-0000c3d0: 2020 2020 7265 7375 6c74 7320 3d20 7b0a      results = {.
-0000c3e0: 2020 2020 2020 2020 2020 2020 2246 223a              "F":
-0000c3f0: 2046 2e6e 756d 7079 2829 2c0a 2020 2020   F.numpy(),.    
-0000c400: 2020 2020 2020 2020 2246 5f73 7464 223a          "F_std":
-0000c410: 2046 5f73 7464 2e6e 756d 7079 2829 2c0a   F_std.numpy(),.
-0000c420: 2020 2020 2020 2020 2020 2020 2246 5f63              "F_c
-0000c430: 6f76 223a 2046 5f63 6f76 2e6e 756d 7079  ov": F_cov.numpy
-0000c440: 2829 2c0a 2020 2020 2020 2020 2020 2020  (),.            
-0000c450: 2244 656c 7461 4622 3a20 4465 6c74 6146  "DeltaF": DeltaF
-0000c460: 2e6e 756d 7079 2829 2c0a 2020 2020 2020  .numpy(),.      
-0000c470: 2020 2020 2020 2244 656c 7461 465f 7374        "DeltaF_st
-0000c480: 6422 3a20 4465 6c74 6146 5f73 7464 2e6e  d": DeltaF_std.n
-0000c490: 756d 7079 2829 2c0a 2020 2020 2020 2020  umpy(),.        
-0000c4a0: 7d0a 0a20 2020 2020 2020 2072 6574 7572  }..        retur
-0000c4b0: 6e20 7265 7375 6c74 730a 0a64 6566 205f  n results..def _
-0000c4c0: 636f 6d70 7574 655f 6c6f 6770 5f6f 665f  compute_logp_of_
-0000c4d0: 4628 462c 2065 6e65 7267 792c 206e 756d  F(F, energy, num
-0000c4e0: 5f63 6f6e 6629 3a0a 2020 2020 6c6f 6770  _conf):.    logp
-0000c4f0: 203d 2028 0a20 2020 2020 2020 2074 6f72   = (.        tor
-0000c500: 6368 2e73 756d 286e 756d 5f63 6f6e 6620  ch.sum(num_conf 
-0000c510: 2a20 4629 0a20 2020 2020 2020 202d 2074  * F).        - t
-0000c520: 6f72 6368 2e6c 6f67 7375 6d65 7870 282d  orch.logsumexp(-
-0000c530: 2865 6e65 7267 792e 5420 2d20 746f 7263  (energy.T - torc
-0000c540: 682e 6c6f 6728 6e75 6d5f 636f 6e66 2920  h.log(num_conf) 
-0000c550: 2d20 4629 2c20 6469 6d3d 3129 2e73 756d  - F), dim=1).sum
-0000c560: 2829 0a20 2020 2029 0a20 2020 2072 6574  ().    ).    ret
-0000c570: 7572 6e20 6c6f 6770 0a0a 0a64 6566 205f  urn logp...def _
-0000c580: 636f 6d70 7574 655f 6c6f 7373 5f61 6e64  compute_loss_and
-0000c590: 5f67 7261 645f 6f66 5f64 4628 6446 2c20  _grad_of_dF(dF, 
-0000c5a0: 656e 6572 6779 2c20 6e75 6d5f 636f 6e66  energy, num_conf
-0000c5b0: 293a 0a20 2020 2022 2222 436f 6d70 7574  ):.    """Comput
-0000c5c0: 6520 7468 6520 6c6f 7373 2066 756e 6374  e the loss funct
-0000c5d0: 696f 6e20 616e 6420 7468 6520 6772 6164  ion and the grad
-0000c5e0: 6965 6e74 206f 6620 6446 2067 6976 656e  ient of dF given
-0000c5f0: 2065 6e65 7267 7920 616e 6420 6e75 6d5f   energy and num_
-0000c600: 636f 6e66 2e0a 2020 2020 5061 7261 6d65  conf..    Parame
-0000c610: 7465 7273 0a20 2020 202d 2d2d 2d2d 2d2d  ters.    -------
-0000c620: 2d2d 2d0a 2020 2020 6446 3a20 312d 4420  ---.    dF: 1-D 
-0000c630: 666c 6f61 7420 7465 6e73 6f72 2077 6974  float tensor wit
-0000c640: 6820 7369 7a65 2028 4d2d 3129 0a20 2020  h size (M-1).   
-0000c650: 2020 2020 2054 6865 2066 7265 6520 656e       The free en
-0000c660: 6572 6779 2064 6966 6665 7265 6e63 6520  ergy difference 
-0000c670: 6265 7477 6565 6e20 7374 6174 6520 3020  between state 0 
-0000c680: 616e 6420 6f74 6865 7220 7374 6174 6573  and other states
-0000c690: 2e20 5468 6520 656e 7472 790a 2020 2020  . The entry.    
-0000c6a0: 2020 2020 6446 5b69 5d20 6973 2074 6865      dF[i] is the
-0000c6b0: 2066 7265 6520 656e 6572 6779 2064 6966   free energy dif
-0000c6c0: 6665 7265 6e63 6520 6265 7477 6565 6e20  ference between 
-0000c6d0: 7374 6174 6520 3020 616e 6420 7374 6174  state 0 and stat
-0000c6e0: 6520 692b 312e 0a20 2020 2065 6e65 7267  e i+1..    energ
-0000c6f0: 793a 2032 2d44 2066 6c6f 6174 2074 656e  y: 2-D float ten
-0000c700: 736f 7220 7769 7468 2073 697a 6520 284d  sor with size (M
-0000c710: 2078 204e 290a 2020 2020 2020 2020 4120   x N).        A 
-0000c720: 322d 4420 7465 6e73 6f72 2077 6974 6820  2-D tensor with 
-0000c730: 7369 7a65 206f 6620 4d20 7820 4e2c 2077  size of M x N, w
-0000c740: 6865 7265 204d 2069 7320 7468 6520 6e75  here M is the nu
-0000c750: 6d62 6572 206f 6620 7374 6174 730a 2020  mber of stats.  
-0000c760: 2020 2020 2020 616e 6420 4e20 6973 2074        and N is t
-0000c770: 6865 2074 6f74 616c 206e 756d 6265 7220  he total number 
-0000c780: 6f66 2063 6f6e 666f 726d 6174 696f 6e73  of conformations
-0000c790: 2e20 5468 6520 656e 7472 7920 656e 6572  . The entry ener
-0000c7a0: 6779 5b69 2c6a 5d0a 2020 2020 6e75 6d5f  gy[i,j].    num_
-0000c7b0: 636f 6e66 3a20 312d 4420 696e 7420 7465  conf: 1-D int te
-0000c7c0: 6e73 6f72 2077 6974 6820 7369 7a65 2028  nsor with size (
-0000c7d0: 4d29 0a20 2020 2020 2020 2041 2031 2d44  M).        A 1-D
-0000c7e0: 2074 656e 736f 7220 7769 7468 2073 697a   tensor with siz
-0000c7f0: 6520 6f66 204d 2c20 7768 6572 6520 6e75  e of M, where nu
-0000c800: 6d5f 636f 6e66 5b69 5d20 6973 2074 6865  m_conf[i] is the
-0000c810: 206e 756d 206f 660a 2020 2020 2020 2020   num of.        
-0000c820: 636f 6e66 6f72 6d61 7469 6f6e 7320 7361  conformations sa
-0000c830: 6d70 6c65 6420 6672 6f6d 2073 7461 7465  mpled from state
-0000c840: 2069 2e20 5468 6572 6566 6f72 652c 2074   i. Therefore, t
-0000c850: 6f72 6368 2e73 756d 286e 756d 5f63 6f6e  orch.sum(num_con
-0000c860: 6629 0a20 2020 2020 2020 2068 6173 2074  f).        has t
-0000c870: 6f20 6265 2065 7175 616c 2074 6f20 4e2e  o be equal to N.
-0000c880: 2041 6c6c 2065 6e74 7269 6573 2069 6e20   All entries in 
-0000c890: 6e75 6d5f 636f 6e66 2068 6176 6520 746f  num_conf have to
-0000c8a0: 2062 6520 7374 7269 6374 6c79 0a20 2020   be strictly.   
-0000c8b0: 2020 2020 2067 7265 6174 6572 2074 6861       greater tha
-0000c8c0: 6e20 302e 0a20 2020 2022 2222 0a0a 2020  n 0..    """..  
-0000c8d0: 2020 2320 636f 6d70 7574 6520 7468 6520    # compute the 
-0000c8e0: 6c6f 7373 2066 756e 6374 696f 6e0a 2020  loss function.  
-0000c8f0: 2020 4620 3d20 746f 7263 682e 6361 7428    F = torch.cat(
-0000c900: 5b64 462e 6e65 775f 7a65 726f 7328 3129  [dF.new_zeros(1)
-0000c910: 2c20 6446 5d29 0a20 2020 206c 6f67 7020  , dF]).    logp 
-0000c920: 3d20 5f63 6f6d 7075 7465 5f6c 6f67 705f  = _compute_logp_
-0000c930: 6f66 5f46 2846 2c20 656e 6572 6779 2c20  of_F(F, energy, 
-0000c940: 6e75 6d5f 636f 6e66 290a 2020 2020 6c6f  num_conf).    lo
-0000c950: 7373 203d 202d 6c6f 6770 202f 206e 756d  ss = -logp / num
-0000c960: 5f63 6f6e 662e 7375 6d28 290a 2020 2020  _conf.sum().    
-0000c970: 7520 3d20 656e 6572 6779 202d 2046 5b3a  u = energy - F[:
-0000c980: 2c20 4e6f 6e65 5d20 2d20 746f 7263 682e  , None] - torch.
-0000c990: 6c6f 6728 6e75 6d5f 636f 6e66 295b 3a2c  log(num_conf)[:,
-0000c9a0: 204e 6f6e 655d 0a0a 2020 2020 2320 636f   None]..    # co
-0000c9b0: 6d70 7574 6520 7468 6520 6772 6164 6965  mpute the gradie
-0000c9c0: 6e74 206f 6620 7468 6520 6c6f 7373 2066  nt of the loss f
-0000c9d0: 756e 6374 696f 6e0a 2020 2020 7020 3d20  unction.    p = 
-0000c9e0: 746f 7263 682e 736f 6674 6d61 7828 2d75  torch.softmax(-u
-0000c9f0: 2c20 6469 6d3d 3029 0a20 2020 2067 7261  , dim=0).    gra
-0000ca00: 6420 3d20 746f 7263 682e 6d65 616e 2870  d = torch.mean(p
-0000ca10: 2c20 6469 6d3d 3129 202d 206e 756d 5f63  , dim=1) - num_c
-0000ca20: 6f6e 6620 2f20 6e75 6d5f 636f 6e66 2e73  onf / num_conf.s
-0000ca30: 756d 2829 0a20 2020 2067 7261 6420 3d20  um().    grad = 
-0000ca40: 6772 6164 5b31 3a5d 0a0a 2020 2020 7265  grad[1:]..    re
-0000ca50: 7475 726e 206c 6f73 732c 2067 7261 640a  turn loss, grad.
-0000ca60: 0a0a 6465 6620 5f63 6f6d 7075 7465 5f6c  ..def _compute_l
-0000ca70: 6f73 735f 616e 645f 6772 6164 5f6f 665f  oss_and_grad_of_
-0000ca80: 6446 5f69 6e5f 6261 7463 6828 6446 2c20  dF_in_batch(dF, 
-0000ca90: 656e 6572 6779 2c20 6e75 6d5f 636f 6e66  energy, num_conf
-0000caa0: 2c20 6261 7463 685f 7369 7a65 3a20 696e  , batch_size: in
-0000cab0: 7429 3a0a 2020 2020 2222 2254 6869 7320  t):.    """This 
-0000cac0: 6973 2074 6865 2062 6174 6368 2076 6572  is the batch ver
-0000cad0: 7369 6f6e 206f 6620 5f63 6f6d 7075 7465  sion of _compute
-0000cae0: 5f6c 6f73 735f 616e 645f 6772 6164 5f6f  _loss_and_grad_o
-0000caf0: 665f 6446 2e0a 2020 2020 5468 6520 6261  f_dF..    The ba
-0000cb00: 7463 6820 7665 7273 696f 6e20 6973 2075  tch version is u
-0000cb10: 7365 6420 7768 656e 2074 6865 2073 697a  sed when the siz
-0000cb20: 6520 6f66 2065 6e65 7267 7920 6973 2074  e of energy is t
-0000cb30: 6f6f 206c 6172 6765 2074 6f20 6669 7420  oo large to fit 
-0000cb40: 696e 746f 2074 6865 0a20 2020 206d 656d  into the.    mem
-0000cb50: 6f72 7920 6f66 2061 2047 5055 2e20 5468  ory of a GPU. Th
-0000cb60: 6520 656e 6572 6779 206d 6174 7269 7820  e energy matrix 
-0000cb70: 6973 2073 706c 6974 2069 6e74 6f20 6d75  is split into mu
-0000cb80: 6c74 6970 6c65 2062 6174 6368 6573 2061  ltiple batches a
-0000cb90: 6e64 2074 6865 0a20 2020 2063 616c 6375  nd the.    calcu
-0000cba0: 6c61 7469 6f6e 2069 7320 646f 6e65 2073  lation is done s
-0000cbb0: 6571 7565 6e74 6961 6c6c 792e 0a0a 2020  equentially...  
-0000cbc0: 2020 5468 6520 7061 7261 6d65 7465 7273    The parameters
-0000cbd0: 2061 7265 2074 6865 2073 616d 6520 6173   are the same as
-0000cbe0: 205f 636f 6d70 7574 655f 6c6f 7373 5f61   _compute_loss_a
-0000cbf0: 6e64 5f67 7261 645f 6f66 5f64 462e 0a20  nd_grad_of_dF.. 
-0000cc00: 2020 2022 2222 0a0a 2020 2020 6e20 3d20     """..    n = 
-0000cc10: 6e75 6d5f 636f 6e66 0a20 2020 204e 203d  num_conf.    N =
-0000cc20: 2074 6f72 6368 2e73 756d 286e 290a 2020   torch.sum(n).  
-0000cc30: 2020 6e5f 6f76 6572 5f4e 203d 206e 202f    n_over_N = n /
-0000cc40: 204e 0a0a 2020 2020 6966 2065 6e65 7267   N..    if energ
-0000cc50: 792e 7368 6170 655b 315d 2025 2062 6174  y.shape[1] % bat
-0000cc60: 6368 5f73 697a 6520 3d3d 2030 3a0a 2020  ch_size == 0:.  
-0000cc70: 2020 2020 2020 6e75 6d5f 6261 7463 6820        num_batch 
-0000cc80: 3d20 656e 6572 6779 2e73 6861 7065 5b31  = energy.shape[1
-0000cc90: 5d20 2f2f 2062 6174 6368 5f73 697a 650a  ] // batch_size.
-0000cca0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-0000ccb0: 2020 6e75 6d5f 6261 7463 6820 3d20 656e    num_batch = en
-0000ccc0: 6572 6779 2e73 6861 7065 5b31 5d20 2f2f  ergy.shape[1] //
-0000ccd0: 2062 6174 6368 5f73 697a 6520 2b20 310a   batch_size + 1.
-0000cce0: 0a20 2020 2046 203d 2074 6f72 6368 2e63  .    F = torch.c
-0000ccf0: 6174 285b 6446 2e6e 6577 5f7a 6572 6f73  at([dF.new_zeros
-0000cd00: 2831 292c 2064 465d 290a 2020 2020 6c6f  (1), dF]).    lo
-0000cd10: 7373 203d 202d 746f 7263 682e 7375 6d28  ss = -torch.sum(
-0000cd20: 6e75 6d5f 636f 6e66 202a 2046 290a 2020  num_conf * F).  
-0000cd30: 2020 6772 6164 203d 202d 6e75 6d5f 636f    grad = -num_co
-0000cd40: 6e66 0a0a 2020 2020 666f 7220 6920 696e  nf..    for i in
-0000cd50: 2072 616e 6765 286e 756d 5f62 6174 6368   range(num_batch
-0000cd60: 293a 0a20 2020 2020 2020 2065 6e65 7267  ):.        energ
-0000cd70: 795f 6261 7463 6820 3d20 656e 6572 6779  y_batch = energy
-0000cd80: 5b3a 2c20 6920 2a20 6261 7463 685f 7369  [:, i * batch_si
-0000cd90: 7a65 203a 2028 6920 2b20 3129 202a 2062  ze : (i + 1) * b
-0000cda0: 6174 6368 5f73 697a 655d 0a20 2020 2020  atch_size].     
-0000cdb0: 2020 2075 203d 2065 6e65 7267 795f 6261     u = energy_ba
-0000cdc0: 7463 682e 6375 6461 2829 202d 2074 6f72  tch.cuda() - tor
-0000cdd0: 6368 2e6c 6f67 286e 756d 5f63 6f6e 6629  ch.log(num_conf)
-0000cde0: 5b3a 2c20 4e6f 6e65 5d20 2d20 465b 3a2c  [:, None] - F[:,
-0000cdf0: 204e 6f6e 655d 0a20 2020 2020 2020 206c   None].        l
-0000ce00: 6f73 7320 2b3d 2074 6f72 6368 2e6c 6f67  oss += torch.log
-0000ce10: 7375 6d65 7870 282d 752c 2064 696d 3d30  sumexp(-u, dim=0
-0000ce20: 292e 7375 6d28 290a 0a20 2020 2020 2020  ).sum()..       
-0000ce30: 2070 203d 2074 6f72 6368 2e73 6f66 746d   p = torch.softm
-0000ce40: 6178 282d 752c 2064 696d 3d30 290a 2020  ax(-u, dim=0).  
-0000ce50: 2020 2020 2020 6772 6164 202b 3d20 746f        grad += to
-0000ce60: 7263 682e 7375 6d28 702c 2064 696d 3d31  rch.sum(p, dim=1
-0000ce70: 290a 0a20 2020 206c 6f73 7320 3d20 6c6f  )..    loss = lo
-0000ce80: 7373 202f 204e 0a20 2020 2067 7261 6420  ss / N.    grad 
-0000ce90: 3d20 6772 6164 202f 204e 0a20 2020 2067  = grad / N.    g
-0000cea0: 7261 6420 3d20 6772 6164 5b31 3a5d 0a20  rad = grad[1:]. 
-0000ceb0: 2020 2072 6574 7572 6e20 6c6f 7373 2c20     return loss, 
-0000cec0: 6772 6164 0a0a 0a64 6566 205f 636f 6d70  grad...def _comp
-0000ced0: 7574 655f 6865 7373 6961 6e5f 6c6f 675f  ute_hessian_log_
-0000cee0: 6c69 6b65 6c69 686f 6f64 5f6f 665f 4628  likelihood_of_F(
-0000cef0: 462c 2065 6e65 7267 792c 206e 756d 5f63  F, energy, num_c
-0000cf00: 6f6e 6629 3a0a 2020 2020 7520 3d20 656e  onf):.    u = en
-0000cf10: 6572 6779 202d 2046 5b3a 2c20 4e6f 6e65  ergy - F[:, None
-0000cf20: 5d20 2d20 746f 7263 682e 6c6f 6728 6e75  ] - torch.log(nu
-0000cf30: 6d5f 636f 6e66 295b 3a2c 204e 6f6e 655d  m_conf)[:, None]
-0000cf40: 0a20 2020 2070 203d 2074 6f72 6368 2e73  .    p = torch.s
-0000cf50: 6f66 746d 6178 282d 752c 2064 696d 3d30  oftmax(-u, dim=0
-0000cf60: 290a 2020 2020 7070 203d 2074 6f72 6368  ).    pp = torch
-0000cf70: 2e6d 6174 6d75 6c28 702c 2070 2e54 290a  .matmul(p, p.T).
-0000cf80: 2020 2020 4820 3d20 7070 202d 2074 6f72      H = pp - tor
-0000cf90: 6368 2e64 6961 6728 746f 7263 682e 7375  ch.diag(torch.su
-0000cfa0: 6d28 702c 2031 2929 0a20 2020 2072 6574  m(p, 1)).    ret
-0000cfb0: 7572 6e20 480a 0a0a 6465 6620 5f63 6f6d  urn H...def _com
-0000cfc0: 7075 7465 5f68 6573 7369 616e 5f6c 6f67  pute_hessian_log
-0000cfd0: 5f6c 696b 656c 6968 6f6f 645f 6f66 5f46  _likelihood_of_F
-0000cfe0: 5f69 6e5f 6261 7463 6828 462c 2065 6e65  _in_batch(F, ene
-0000cff0: 7267 792c 206e 756d 5f63 6f6e 662c 2062  rgy, num_conf, b
-0000d000: 6174 6368 5f73 697a 653a 2069 6e74 293a  atch_size: int):
-0000d010: 0a20 2020 2069 6620 656e 6572 6779 2e73  .    if energy.s
-0000d020: 6861 7065 5b31 5d20 2520 6261 7463 685f  hape[1] % batch_
-0000d030: 7369 7a65 203d 3d20 303a 0a20 2020 2020  size == 0:.     
-0000d040: 2020 206e 756d 5f62 6174 6368 203d 2065     num_batch = e
-0000d050: 6e65 7267 792e 7368 6170 655b 315d 202f  nergy.shape[1] /
-0000d060: 2f20 6261 7463 685f 7369 7a65 0a20 2020  / batch_size.   
-0000d070: 2065 6c73 653a 0a20 2020 2020 2020 206e   else:.        n
-0000d080: 756d 5f62 6174 6368 203d 2065 6e65 7267  um_batch = energ
-0000d090: 792e 7368 6170 655b 315d 202f 2f20 6261  y.shape[1] // ba
-0000d0a0: 7463 685f 7369 7a65 202b 2031 0a0a 2020  tch_size + 1..  
-0000d0b0: 2020 4820 3d20 462e 6e65 775f 7a65 726f    H = F.new_zero
-0000d0c0: 7328 2846 2e73 6861 7065 5b30 5d2c 2046  s((F.shape[0], F
-0000d0d0: 2e73 6861 7065 5b30 5d29 292e 6375 6461  .shape[0])).cuda
-0000d0e0: 2829 0a20 2020 2066 6f72 2069 2069 6e20  ().    for i in 
-0000d0f0: 7261 6e67 6528 6e75 6d5f 6261 7463 6829  range(num_batch)
-0000d100: 3a0a 2020 2020 2020 2020 656e 6572 6779  :.        energy
-0000d110: 5f62 6174 6368 203d 2065 6e65 7267 795b  _batch = energy[
-0000d120: 3a2c 2069 202a 2062 6174 6368 5f73 697a  :, i * batch_siz
-0000d130: 6520 3a20 2869 202b 2031 2920 2a20 6261  e : (i + 1) * ba
-0000d140: 7463 685f 7369 7a65 5d0a 2020 2020 2020  tch_size].      
-0000d150: 2020 7520 3d20 656e 6572 6779 5f62 6174    u = energy_bat
-0000d160: 6368 2e63 7564 6128 2920 2d20 465b 3a2c  ch.cuda() - F[:,
-0000d170: 204e 6f6e 655d 202d 2074 6f72 6368 2e6c   None] - torch.l
-0000d180: 6f67 286e 756d 5f63 6f6e 6629 5b3a 2c20  og(num_conf)[:, 
-0000d190: 4e6f 6e65 5d0a 0a20 2020 2020 2020 2070  None]..        p
-0000d1a0: 203d 2074 6f72 6368 2e73 6f66 746d 6178   = torch.softmax
-0000d1b0: 282d 752c 2064 696d 3d30 290a 2020 2020  (-u, dim=0).    
-0000d1c0: 2020 2020 7070 203d 2074 6f72 6368 2e6d      pp = torch.m
-0000d1d0: 6174 6d75 6c28 702c 2070 2e54 290a 2020  atmul(p, p.T).  
-0000d1e0: 2020 2020 2020 4820 2b3d 2070 7020 2d20        H += pp - 
-0000d1f0: 746f 7263 682e 6469 6167 2874 6f72 6368  torch.diag(torch
-0000d200: 2e73 756d 2870 2c20 3129 290a 0a20 2020  .sum(p, 1))..   
-0000d210: 2072 6574 7572 6e20 480a 0a0a 6465 6620   return H...def 
-0000d220: 5f63 6f6d 7075 7465 5f68 6573 7369 616e  _compute_hessian
-0000d230: 5f6c 6f73 735f 6f66 5f64 4628 6446 2c20  _loss_of_dF(dF, 
-0000d240: 656e 6572 6779 2c20 6e75 6d5f 636f 6e66  energy, num_conf
-0000d250: 293a 0a20 2020 204e 203d 2074 6f72 6368  ):.    N = torch
-0000d260: 2e73 756d 286e 756d 5f63 6f6e 6629 0a20  .sum(num_conf). 
-0000d270: 2020 2046 203d 2074 6f72 6368 2e63 6174     F = torch.cat
-0000d280: 285b 6446 2e6e 6577 5f7a 6572 6f73 2831  ([dF.new_zeros(1
-0000d290: 292c 2064 465d 290a 2020 2020 4820 3d20  ), dF]).    H = 
-0000d2a0: 5f63 6f6d 7075 7465 5f68 6573 7369 616e  _compute_hessian
-0000d2b0: 5f6c 6f67 5f6c 696b 656c 6968 6f6f 645f  _log_likelihood_
-0000d2c0: 6f66 5f46 2846 2c20 656e 6572 6779 2c20  of_F(F, energy, 
-0000d2d0: 6e75 6d5f 636f 6e66 290a 2020 2020 4820  num_conf).    H 
-0000d2e0: 3d20 2d48 5b31 3a2c 2031 3a5d 202f 204e  = -H[1:, 1:] / N
-0000d2f0: 0a20 2020 2072 6574 7572 6e20 480a 0a0a  .    return H...
-0000d300: 6465 6620 5f63 6f6d 7075 7465 5f68 6573  def _compute_hes
-0000d310: 7369 616e 5f6c 6f73 735f 6f66 5f64 465f  sian_loss_of_dF_
-0000d320: 696e 5f62 6174 6368 2864 462c 2065 6e65  in_batch(dF, ene
-0000d330: 7267 792c 206e 756d 5f63 6f6e 662c 2062  rgy, num_conf, b
-0000d340: 6174 6368 5f73 697a 653a 2069 6e74 293a  atch_size: int):
-0000d350: 0a20 2020 204e 203d 2074 6f72 6368 2e73  .    N = torch.s
-0000d360: 756d 286e 756d 5f63 6f6e 6629 0a20 2020  um(num_conf).   
-0000d370: 2046 203d 2074 6f72 6368 2e63 6174 285b   F = torch.cat([
-0000d380: 6446 2e6e 6577 5f7a 6572 6f73 2831 292c  dF.new_zeros(1),
-0000d390: 2064 465d 290a 2020 2020 4820 3d20 5f63   dF]).    H = _c
-0000d3a0: 6f6d 7075 7465 5f68 6573 7369 616e 5f6c  ompute_hessian_l
-0000d3b0: 6f67 5f6c 696b 656c 6968 6f6f 645f 6f66  og_likelihood_of
-0000d3c0: 5f46 5f69 6e5f 6261 7463 6828 462c 2065  _F_in_batch(F, e
-0000d3d0: 6e65 7267 792c 206e 756d 5f63 6f6e 662c  nergy, num_conf,
-0000d3e0: 2062 6174 6368 5f73 697a 6529 0a20 2020   batch_size).   
-0000d3f0: 2048 203d 202d 485b 313a 2c20 313a 5d20   H = -H[1:, 1:] 
-0000d400: 2f20 4e0a 2020 2020 7265 7475 726e 2048  / N.    return H
-0000d410: 0a0a 0a64 6566 205f 736f 6c76 655f 6d62  ...def _solve_mb
-0000d420: 6172 2864 465f 696e 6974 2c20 656e 6572  ar(dF_init, ener
-0000d430: 6779 2c20 6e75 6d5f 636f 6e66 2c20 6d65  gy, num_conf, me
-0000d440: 7468 6f64 2c20 6261 7463 685f 7369 7a65  thod, batch_size
-0000d450: 3d4e 6f6e 652c 2076 6572 626f 7365 3d46  =None, verbose=F
-0000d460: 616c 7365 293a 0a20 2020 2069 6620 6261  alse):.    if ba
-0000d470: 7463 685f 7369 7a65 2069 7320 6e6f 7420  tch_size is not 
-0000d480: 4e6f 6e65 3a0a 2020 2020 2020 2020 6966  None:.        if
-0000d490: 206d 6574 686f 6420 3d3d 2022 4e65 7774   method == "Newt
-0000d4a0: 6f6e 223a 0a20 2020 2020 2020 2020 2020  on":.           
-0000d4b0: 2072 6573 756c 7473 203d 2066 6d69 6e5f   results = fmin_
-0000d4c0: 6e65 7774 6f6e 280a 2020 2020 2020 2020  newton(.        
-0000d4d0: 2020 2020 2020 2020 663d 5f63 6f6d 7075          f=_compu
-0000d4e0: 7465 5f6c 6f73 735f 616e 645f 6772 6164  te_loss_and_grad
-0000d4f0: 5f6f 665f 6446 5f69 6e5f 6261 7463 682c  _of_dF_in_batch,
-0000d500: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000d510: 2068 6573 733d 5f63 6f6d 7075 7465 5f68   hess=_compute_h
-0000d520: 6573 7369 616e 5f6c 6f73 735f 6f66 5f64  essian_loss_of_d
-0000d530: 465f 696e 5f62 6174 6368 2c0a 2020 2020  F_in_batch,.    
-0000d540: 2020 2020 2020 2020 2020 2020 785f 696e              x_in
-0000d550: 6974 3d64 465f 696e 6974 2c0a 2020 2020  it=dF_init,.    
-0000d560: 2020 2020 2020 2020 2020 2020 6172 6773              args
-0000d570: 3d28 656e 6572 6779 2c20 6e75 6d5f 636f  =(energy, num_co
-0000d580: 6e66 2c20 6261 7463 685f 7369 7a65 292c  nf, batch_size),
-0000d590: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000d5a0: 2076 6572 626f 7365 3d76 6572 626f 7365   verbose=verbose
-0000d5b0: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
-0000d5c0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0000d5d0: 726e 2072 6573 756c 7473 5b22 7822 5d0a  rn results["x"].
-0000d5e0: 0a20 2020 2020 2020 2065 6c69 6620 6d65  .        elif me
-0000d5f0: 7468 6f64 203d 3d20 224c 2d42 4647 532d  thod == "L-BFGS-
-0000d600: 4222 3a0a 2020 2020 2020 2020 2020 2020  B":.            
-0000d610: 6f70 7469 6f6e 7320 3d20 7b22 6469 7370  options = {"disp
-0000d620: 223a 2076 6572 626f 7365 2c20 2267 746f  ": verbose, "gto
-0000d630: 6c22 3a20 3165 2d38 7d0a 2020 2020 2020  l": 1e-8}.      
-0000d640: 2020 2020 2020 7265 7375 6c74 7320 3d20        results = 
-0000d650: 6f70 7469 6d69 7a65 2e6d 696e 696d 697a  optimize.minimiz
-0000d660: 6528 0a20 2020 2020 2020 2020 2020 2020  e(.             
-0000d670: 2020 206c 616d 6264 6120 783a 205b 0a20     lambda x: [. 
-0000d680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d690: 2020 2072 2e63 7075 2829 2e6e 756d 7079     r.cpu().numpy
-0000d6a0: 2829 0a20 2020 2020 2020 2020 2020 2020  ().             
-0000d6b0: 2020 2020 2020 2066 6f72 2072 2069 6e20         for r in 
-0000d6c0: 5f63 6f6d 7075 7465 5f6c 6f73 735f 616e  _compute_loss_an
-0000d6d0: 645f 6772 6164 5f6f 665f 6446 5f69 6e5f  d_grad_of_dF_in_
-0000d6e0: 6261 7463 6828 0a20 2020 2020 2020 2020  batch(.         
-0000d6f0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0000d700: 6e65 7267 792e 6e65 775f 7465 6e73 6f72  nergy.new_tensor
-0000d710: 2878 292c 2065 6e65 7267 792c 206e 756d  (x), energy, num
-0000d720: 5f63 6f6e 662c 2062 6174 6368 5f73 697a  _conf, batch_siz
-0000d730: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
-0000d740: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-0000d750: 2020 2020 2020 2020 5d2c 0a20 2020 2020          ],.     
-0000d760: 2020 2020 2020 2020 2020 2064 465f 696e             dF_in
-0000d770: 6974 2e63 7075 2829 2e6e 756d 7079 2829  it.cpu().numpy()
-0000d780: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000d790: 2020 6a61 633d 5472 7565 2c0a 2020 2020    jac=True,.    
-0000d7a0: 2020 2020 2020 2020 2020 2020 6d65 7468              meth
-0000d7b0: 6f64 3d22 4c2d 4246 4753 2d42 222c 0a20  od="L-BFGS-B",. 
-0000d7c0: 2020 2020 2020 2020 2020 2020 2020 2074                 t
-0000d7d0: 6f6c 3d31 652d 3132 2c0a 2020 2020 2020  ol=1e-12,.      
-0000d7e0: 2020 2020 2020 2020 2020 6f70 7469 6f6e            option
-0000d7f0: 733d 6f70 7469 6f6e 732c 0a20 2020 2020  s=options,.     
-0000d800: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0000d810: 2020 2020 2072 6574 7572 6e20 746f 7263       return torc
-0000d820: 682e 6672 6f6d 5f6e 756d 7079 2872 6573  h.from_numpy(res
-0000d830: 756c 7473 5b22 7822 5d29 0a20 2020 2065  ults["x"]).    e
-0000d840: 6c73 653a 0a20 2020 2020 2020 2069 6620  lse:.        if 
-0000d850: 6d65 7468 6f64 203d 3d20 224e 6577 746f  method == "Newto
-0000d860: 6e22 3a0a 2020 2020 2020 2020 2020 2020  n":.            
-0000d870: 7265 7375 6c74 7320 3d20 666d 696e 5f6e  results = fmin_n
-0000d880: 6577 746f 6e28 0a20 2020 2020 2020 2020  ewton(.         
-0000d890: 2020 2020 2020 2066 3d5f 636f 6d70 7574         f=_comput
-0000d8a0: 655f 6c6f 7373 5f61 6e64 5f67 7261 645f  e_loss_and_grad_
-0000d8b0: 6f66 5f64 462c 0a20 2020 2020 2020 2020  of_dF,.         
-0000d8c0: 2020 2020 2020 2068 6573 733d 5f63 6f6d         hess=_com
-0000d8d0: 7075 7465 5f68 6573 7369 616e 5f6c 6f73  pute_hessian_los
-0000d8e0: 735f 6f66 5f64 462c 0a20 2020 2020 2020  s_of_dF,.       
-0000d8f0: 2020 2020 2020 2020 2078 5f69 6e69 743d           x_init=
-0000d900: 6446 5f69 6e69 742c 0a20 2020 2020 2020  dF_init,.       
-0000d910: 2020 2020 2020 2020 2061 7267 733d 2865           args=(e
-0000d920: 6e65 7267 792c 206e 756d 5f63 6f6e 6629  nergy, num_conf)
-0000d930: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000d940: 2020 7665 7262 6f73 653d 7665 7262 6f73    verbose=verbos
-0000d950: 652c 0a20 2020 2020 2020 2020 2020 2029  e,.            )
-0000d960: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-0000d970: 7572 6e20 7265 7375 6c74 735b 2278 225d  urn results["x"]
-0000d980: 0a20 2020 2020 2020 2065 6c69 6620 6d65  .        elif me
-0000d990: 7468 6f64 203d 3d20 224c 2d42 4647 532d  thod == "L-BFGS-
-0000d9a0: 4222 3a0a 2020 2020 2020 2020 2020 2020  B":.            
-0000d9b0: 6f70 7469 6f6e 7320 3d20 7b22 6469 7370  options = {"disp
-0000d9c0: 223a 2076 6572 626f 7365 2c20 2267 746f  ": verbose, "gto
-0000d9d0: 6c22 3a20 3165 2d38 7d0a 2020 2020 2020  l": 1e-8}.      
-0000d9e0: 2020 2020 2020 7265 7375 6c74 7320 3d20        results = 
-0000d9f0: 6f70 7469 6d69 7a65 2e6d 696e 696d 697a  optimize.minimiz
-0000da00: 6528 0a20 2020 2020 2020 2020 2020 2020  e(.             
-0000da10: 2020 206c 616d 6264 6120 783a 205b 0a20     lambda x: [. 
-0000da20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000da30: 2020 2072 2e63 7075 2829 2e6e 756d 7079     r.cpu().numpy
-0000da40: 2829 0a20 2020 2020 2020 2020 2020 2020  ().             
-0000da50: 2020 2020 2020 2066 6f72 2072 2069 6e20         for r in 
-0000da60: 5f63 6f6d 7075 7465 5f6c 6f73 735f 616e  _compute_loss_an
-0000da70: 645f 6772 6164 5f6f 665f 6446 280a 2020  d_grad_of_dF(.  
-0000da80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000da90: 2020 2020 2020 656e 6572 6779 2e6e 6577        energy.new
-0000daa0: 5f74 656e 736f 7228 7829 2c20 656e 6572  _tensor(x), ener
-0000dab0: 6779 2c20 6e75 6d5f 636f 6e66 0a20 2020  gy, num_conf.   
-0000dac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000dad0: 2029 0a20 2020 2020 2020 2020 2020 2020   ).             
-0000dae0: 2020 205d 2c0a 2020 2020 2020 2020 2020     ],.          
-0000daf0: 2020 2020 2020 6446 5f69 6e69 742e 6370        dF_init.cp
-0000db00: 7528 292e 6e75 6d70 7928 292c 0a20 2020  u().numpy(),.   
-0000db10: 2020 2020 2020 2020 2020 2020 206a 6163               jac
-0000db20: 3d54 7275 652c 0a20 2020 2020 2020 2020  =True,.         
-0000db30: 2020 2020 2020 206d 6574 686f 643d 224c         method="L
-0000db40: 2d42 4647 532d 4222 2c0a 2020 2020 2020  -BFGS-B",.      
-0000db50: 2020 2020 2020 2020 2020 746f 6c3d 3165            tol=1e
-0000db60: 2d31 322c 0a20 2020 2020 2020 2020 2020  -12,.           
-0000db70: 2020 2020 206f 7074 696f 6e73 3d6f 7074       options=opt
-0000db80: 696f 6e73 2c0a 2020 2020 2020 2020 2020  ions,.          
-0000db90: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-0000dba0: 7265 7475 726e 2074 6f72 6368 2e66 726f  return torch.fro
-0000dbb0: 6d5f 6e75 6d70 7928 7265 7375 6c74 735b  m_numpy(results[
-0000dbc0: 2278 225d 290a 0a0a 6465 6620 5f62 6f6f  "x"])...def _boo
-0000dbd0: 7473 7472 6170 5f63 6f6e 665f 6964 7828  tstrap_conf_idx(
-0000dbe0: 6e75 6d5f 636f 6e66 2c20 626f 6f74 7374  num_conf, bootst
-0000dbf0: 7261 705f 626c 6f63 6b5f 7369 7a65 293a  rap_block_size):
-0000dc00: 0a20 2020 206e 756d 5f63 6f6e 665f 6375  .    num_conf_cu
-0000dc10: 6d73 756d 203d 2074 6f72 6368 2e63 756d  msum = torch.cum
-0000dc20: 7375 6d28 6e75 6d5f 636f 6e66 2c20 6469  sum(num_conf, di
-0000dc30: 6d3d 3029 2e74 6f6c 6973 7428 290a 2020  m=0).tolist().  
-0000dc40: 2020 6e75 6d5f 636f 6e66 5f63 756d 7375    num_conf_cumsu
-0000dc50: 6d2e 706f 7028 2d31 290a 2020 2020 6e75  m.pop(-1).    nu
-0000dc60: 6d5f 636f 6e66 5f63 756d 7375 6d20 3d20  m_conf_cumsum = 
-0000dc70: 5b30 5d20 2b20 6e75 6d5f 636f 6e66 5f63  [0] + num_conf_c
-0000dc80: 756d 7375 6d0a 2020 2020 636f 6e66 5f69  umsum.    conf_i
-0000dc90: 6478 203d 205b 5d0a 2020 2020 666f 7220  dx = [].    for 
-0000dca0: 6920 696e 2072 616e 6765 286c 656e 286e  i in range(len(n
-0000dcb0: 756d 5f63 6f6e 6629 293a 0a20 2020 2020  um_conf)):.     
-0000dcc0: 2020 206c 656e 5f73 6571 203d 2069 6e74     len_seq = int
-0000dcd0: 286e 756d 5f63 6f6e 665b 695d 2920 2023  (num_conf[i])  #
-0000dce0: 2320 7573 696e 6720 6369 7263 756c 6172  # using circular
-0000dcf0: 2062 6c6f 636b 2062 6f6f 7473 7472 6170   block bootstrap
-0000dd00: 0a20 2020 2020 2020 206e 756d 5f73 616d  .        num_sam
-0000dd10: 706c 655f 626c 6f63 6b20 3d20 696e 7428  ple_block = int(
-0000dd20: 6e70 2e63 6569 6c28 6c65 6e5f 7365 7120  np.ceil(len_seq 
-0000dd30: 2f20 626f 6f74 7374 7261 705f 626c 6f63  / bootstrap_bloc
-0000dd40: 6b5f 7369 7a65 2929 0a20 2020 2020 2020  k_size)).       
-0000dd50: 2069 6478 7320 3d20 746f 7263 682e 7261   idxs = torch.ra
-0000dd60: 6e64 696e 7428 302c 206c 656e 5f73 6571  ndint(0, len_seq
-0000dd70: 2c20 286e 756d 5f73 616d 706c 655f 626c  , (num_sample_bl
-0000dd80: 6f63 6b2c 2929 0a20 2020 2020 2020 2073  ock,)).        s
-0000dd90: 616d 706c 655f 6964 7820 3d20 746f 7263  ample_idx = torc
-0000dda0: 682e 6361 7428 0a20 2020 2020 2020 2020  h.cat(.         
-0000ddb0: 2020 205b 746f 7263 682e 6172 616e 6765     [torch.arange
-0000ddc0: 2869 6478 2c20 6964 7820 2b20 626f 6f74  (idx, idx + boot
-0000ddd0: 7374 7261 705f 626c 6f63 6b5f 7369 7a65  strap_block_size
-0000dde0: 2920 666f 7220 6964 7820 696e 2069 6478  ) for idx in idx
-0000ddf0: 735d 0a20 2020 2020 2020 2029 0a20 2020  s].        ).   
-0000de00: 2020 2020 2073 616d 706c 655f 6964 7820       sample_idx 
-0000de10: 3d20 746f 7263 682e 7265 6d61 696e 6465  = torch.remainde
-0000de20: 7228 7361 6d70 6c65 5f69 6478 2c20 6c65  r(sample_idx, le
-0000de30: 6e5f 7365 7129 0a20 2020 2020 2020 2073  n_seq).        s
-0000de40: 616d 706c 655f 6964 7820 3d20 7361 6d70  ample_idx = samp
-0000de50: 6c65 5f69 6478 5b30 3a6c 656e 5f73 6571  le_idx[0:len_seq
-0000de60: 5d0a 2020 2020 2020 2020 7361 6d70 6c65  ].        sample
-0000de70: 5f69 6478 203d 2073 616d 706c 655f 6964  _idx = sample_id
-0000de80: 7820 2b20 6e75 6d5f 636f 6e66 5f63 756d  x + num_conf_cum
-0000de90: 7375 6d5b 695d 0a20 2020 2020 2020 2063  sum[i].        c
-0000dea0: 6f6e 665f 6964 782e 6170 7065 6e64 2873  onf_idx.append(s
-0000deb0: 616d 706c 655f 6964 7829 0a20 2020 2063  ample_idx).    c
-0000dec0: 6f6e 665f 6964 7820 3d20 746f 7263 682e  onf_idx = torch.
-0000ded0: 6361 7428 636f 6e66 5f69 6478 290a 2020  cat(conf_idx).  
-0000dee0: 2020 7265 7475 726e 2063 6f6e 665f 6964    return conf_id
-0000def0: 780a 0a0a 6465 6620 666d 696e 5f6e 6577  x...def fmin_new
-0000df00: 746f 6e28 662c 2068 6573 732c 2078 5f69  ton(f, hess, x_i
-0000df10: 6e69 742c 2061 7267 733d 2829 2c20 7665  nit, args=(), ve
-0000df20: 7262 6f73 653d 5472 7565 2c20 6570 733d  rbose=True, eps=
-0000df30: 3165 2d31 322c 206d 6178 5f69 7465 723d  1e-12, max_iter=
-0000df40: 3330 3029 3a0a 2020 2020 2222 224d 696e  300):.    """Min
-0000df50: 696d 697a 6520 6120 6675 6e63 7469 6f6e  imize a function
-0000df60: 2077 6974 6820 7468 6520 4e65 7774 6f6e   with the Newton
-0000df70: 2773 206d 6574 686f 642e 0a0a 2020 2020  's method...    
-0000df80: 466f 7220 6465 7461 696c 7320 6f66 2074  For details of t
-0000df90: 6865 204e 6577 746f 6e27 7320 6d65 7468  he Newton's meth
-0000dfa0: 6f64 2c20 7365 6520 4368 6170 7465 7220  od, see Chapter 
-0000dfb0: 392e 3520 6f66 2050 726f 662e 2042 6f79  9.5 of Prof. Boy
-0000dfc0: 6427 7320 626f 6f6b 0a20 2020 2060 436f  d's book.    `Co
-0000dfd0: 6e76 6578 204f 7074 696d 697a 6174 696f  nvex Optimizatio
-0000dfe0: 6e20 3c68 7474 7073 3a2f 2f77 6562 2e73  n <https://web.s
-0000dff0: 7461 6e66 6f72 642e 6564 752f 7e62 6f79  tanford.edu/~boy
-0000e000: 642f 6376 7862 6f6f 6b2f 3e60 5f2e 0a0a  d/cvxbook/>`_...
-0000e010: 2020 2020 4172 6773 3a0a 2020 2020 2020      Args:.      
-0000e020: 2020 6620 2863 616c 6c61 626c 6529 3a20    f (callable): 
-0000e030: 7468 6520 6f62 6a65 6374 6976 6520 6675  the objective fu
-0000e040: 6e63 7469 6f6e 2074 6f20 6265 206d 696e  nction to be min
-0000e050: 696d 697a 6564 2e0a 2020 2020 2020 2020  imized..        
-0000e060: 2020 2020 6628 783a 5465 6e73 6f72 2c20      f(x:Tensor, 
-0000e070: 2a61 7267 7329 202d 3e20 2028 793a 5465  *args) ->  (y:Te
-0000e080: 6e73 6f72 2c20 6772 6164 3a54 656e 736f  nsor, grad:Tenso
-0000e090: 7229 2c20 7768 6572 650a 2020 2020 2020  r), where.      
-0000e0a0: 2020 2020 2020 7920 6973 2074 6865 2066        y is the f
-0000e0b0: 756e 6374 696f 6e20 7661 6c75 6520 616e  unction value an
-0000e0c0: 6420 6772 6164 2069 7320 7468 6520 6772  d grad is the gr
-0000e0d0: 6164 6965 6e74 2e0a 2020 2020 2020 2020  adient..        
-0000e0e0: 6865 7373 2028 6361 6c6c 6162 6c65 293a  hess (callable):
-0000e0f0: 2074 6865 2066 756e 6374 696f 6e20 746f   the function to
-0000e100: 2063 6f6d 7075 7465 2074 6865 2048 6573   compute the Hes
-0000e110: 7369 616e 206d 6174 7269 782e 0a20 2020  sian matrix..   
-0000e120: 2020 2020 2020 2020 2068 6573 7328 783a           hess(x:
-0000e130: 5465 6e73 6f72 2c20 2a61 7267 7329 202d  Tensor, *args) -
-0000e140: 3e20 6120 7477 6f20 6469 6d65 6e73 696f  > a two dimensio
-0000e150: 6e61 6c20 7465 6e73 6f72 2e0a 2020 2020  nal tensor..    
-0000e160: 2020 2020 785f 696e 6974 2028 5465 6e73      x_init (Tens
-0000e170: 6f72 293a 2074 6865 2069 6e69 7469 616c  or): the initial
-0000e180: 2076 616c 7565 2e0a 2020 2020 2020 2020   value..        
-0000e190: 6172 6773 2028 7475 706c 6529 3a20 6578  args (tuple): ex
-0000e1a0: 7472 6120 7061 7261 6d65 7465 7273 2066  tra parameters f
-0000e1b0: 6f72 2066 2061 6e64 2068 6573 732e 0a20  or f and hess.. 
-0000e1c0: 2020 2020 2020 2076 6572 626f 7365 2028         verbose (
-0000e1d0: 626f 6f6c 293a 2077 6865 7468 6572 2074  bool): whether t
-0000e1e0: 6f20 7072 696e 7420 6d69 6e69 6d69 7a69  o print minimizi
-0000e1f0: 6e67 206c 6f67 2069 6e66 6f72 6d61 7469  ng log informati
-0000e200: 6f6e 2e0a 2020 2020 2020 2020 6570 7320  on..        eps 
-0000e210: 2866 6c6f 6174 293a 2074 6f6c 6572 616e  (float): toleran
-0000e220: 6365 2066 6f72 2073 746f 7070 696e 670a  ce for stopping.
-0000e230: 2020 2020 2020 2020 6d61 785f 6974 6572          max_iter
-0000e240: 2028 696e 7429 3a20 6d61 7869 6d75 6d20   (int): maximum 
-0000e250: 6e75 6d62 6572 206f 6620 6974 6572 6174  number of iterat
-0000e260: 696f 6e73 2e0a 2020 2020 2222 220a 0a20  ions..    """.. 
-0000e270: 2020 2023 2320 636f 6e73 7461 6e74 7320     ## constants 
-0000e280: 7573 6564 2069 6e20 6261 636b 7472 6163  used in backtrac
-0000e290: 6b69 6e67 206c 696e 6520 7365 6172 6368  king line search
-0000e2a0: 0a20 2020 2061 6c70 6861 2c20 6265 7461  .    alpha, beta
-0000e2b0: 203d 2030 2e30 312c 2030 2e32 0a0a 2020   = 0.01, 0.2..  
-0000e2c0: 2020 2323 204e 6577 746f 6e27 7320 6d65    ## Newton's me
-0000e2d0: 7468 6f64 2066 6f72 206d 696e 696d 697a  thod for minimiz
-0000e2e0: 696e 6720 7468 6520 6675 6e63 7469 6f6e  ing the function
-0000e2f0: 0a20 2020 2069 6e64 785f 6974 6572 203d  .    indx_iter =
-0000e300: 2030 0a0a 2020 2020 4e5f 6675 6e63 203d   0..    N_func =
-0000e310: 2030 0a0a 2020 2020 6966 2076 6572 626f   0..    if verbo
-0000e320: 7365 3a0a 2020 2020 2020 2020 7072 696e  se:.        prin
-0000e330: 7428 223d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  t("=============
-0000e340: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0000e350: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0000e360: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0000e370: 3d3d 3d3d 3d22 290a 0a20 2020 2020 2020  =====")..       
-0000e380: 2070 7269 6e74 2822 2020 2020 2020 2020   print("        
-0000e390: 2020 2020 2020 2020 5255 4e4e 494e 4720          RUNNING 
-0000e3a0: 5448 4520 4e45 5754 4f4e 2753 204d 4554  THE NEWTON'S MET
-0000e3b0: 484f 4420 2020 2020 2020 2020 2020 2020  HOD             
-0000e3c0: 2020 2020 2020 2020 5c6e 2229 0a20 2020          \n").   
-0000e3d0: 2020 2020 2070 7269 6e74 2822 2020 2020       print("    
-0000e3e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e3f0: 2020 2020 2020 202a 202a 202a 2020 2020         * * *    
-0000e400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e410: 2020 2020 2020 2020 2020 2020 5c6e 2229              \n")
-0000e420: 0a20 2020 2020 2020 2070 7269 6e74 2866  .        print(f
-0000e430: 2220 2020 2020 2020 2020 2020 2020 2020  "               
-0000e440: 2020 2020 2054 6f6c 6572 616e 6365 2045       Tolerance E
-0000e450: 5053 203d 207b 6570 733a 2e35 457d 2020  PS = {eps:.5E}  
-0000e460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e470: 5c6e 2229 0a0a 2020 2020 2323 2063 6865  \n")..    ## che
-0000e480: 636b 2069 6620 785f 696e 6974 2069 7320  ck if x_init is 
-0000e490: 6120 7079 746f 7263 6820 7465 6e73 6f72  a pytorch tensor
-0000e4a0: 0a20 2020 2069 6620 6973 696e 7374 616e  .    if isinstan
-0000e4b0: 6365 2878 5f69 6e69 742c 2074 6f72 6368  ce(x_init, torch
-0000e4c0: 2e54 656e 736f 7229 3a0a 2020 2020 2020  .Tensor):.      
-0000e4d0: 2020 7820 3d20 785f 696e 6974 2e63 6c6f    x = x_init.clo
-0000e4e0: 6e65 2829 2e64 6574 6163 6828 292e 7265  ne().detach().re
-0000e4f0: 7175 6972 6573 5f67 7261 645f 2846 616c  quires_grad_(Fal
-0000e500: 7365 290a 2020 2020 656c 7365 3a0a 2020  se).    else:.  
-0000e510: 2020 2020 2020 7820 3d20 785f 696e 6974        x = x_init
-0000e520: 0a0a 2020 2020 7768 696c 6520 696e 6478  ..    while indx
-0000e530: 5f69 7465 7220 3c20 6d61 785f 6974 6572  _iter < max_iter
-0000e540: 3a0a 2020 2020 2020 2020 6c6f 7373 2c20  :.        loss, 
-0000e550: 6772 6164 203d 2066 2878 2c20 2a61 7267  grad = f(x, *arg
-0000e560: 7329 0a20 2020 2020 2020 204e 5f66 756e  s).        N_fun
-0000e570: 6320 2b3d 2031 0a0a 2020 2020 2020 2020  c += 1..        
-0000e580: 6966 2069 7369 6e73 7461 6e63 6528 785f  if isinstance(x_
-0000e590: 696e 6974 2c20 746f 7263 682e 5465 6e73  init, torch.Tens
-0000e5a0: 6f72 293a 0a20 2020 2020 2020 2020 2020  or):.           
-0000e5b0: 2077 6974 6820 746f 7263 682e 6e6f 5f67   with torch.no_g
-0000e5c0: 7261 6428 293a 0a20 2020 2020 2020 2020  rad():.         
-0000e5d0: 2020 2020 2020 2048 203d 2068 6573 7328         H = hess(
-0000e5e0: 782c 202a 6172 6773 290a 2020 2020 2020  x, *args).      
-0000e5f0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-0000e600: 2020 2020 4820 3d20 6865 7373 2878 2c20      H = hess(x, 
-0000e610: 2a61 7267 7329 0a0a 2020 2020 2020 2020  *args)..        
-0000e620: 6966 2069 7369 6e73 7461 6e63 6528 6772  if isinstance(gr
-0000e630: 6164 2c20 746f 7263 682e 5465 6e73 6f72  ad, torch.Tensor
-0000e640: 293a 0a20 2020 2020 2020 2020 2020 206e  ):.            n
-0000e650: 6577 746f 6e5f 6469 7265 6374 696f 6e20  ewton_direction 
-0000e660: 3d20 746f 7263 682e 6c69 6e61 6c67 2e73  = torch.linalg.s
-0000e670: 6f6c 7665 2848 2c20 2d67 7261 6429 0a20  olve(H, -grad). 
-0000e680: 2020 2020 2020 2020 2020 206e 6577 746f             newto
-0000e690: 6e5f 6465 6372 656d 656e 745f 7371 7561  n_decrement_squa
-0000e6a0: 7265 203d 2074 6f72 6368 2e73 756d 282d  re = torch.sum(-
-0000e6b0: 6772 6164 202a 206e 6577 746f 6e5f 6469  grad * newton_di
-0000e6c0: 7265 6374 696f 6e29 0a20 2020 2020 2020  rection).       
-0000e6d0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-0000e6e0: 2020 206e 6577 746f 6e5f 6469 7265 6374     newton_direct
-0000e6f0: 696f 6e20 3d20 6e70 2e6c 696e 616c 672e  ion = np.linalg.
-0000e700: 736f 6c76 6528 482c 202d 6772 6164 290a  solve(H, -grad).
-0000e710: 2020 2020 2020 2020 2020 2020 6e65 7774              newt
-0000e720: 6f6e 5f64 6563 7265 6d65 6e74 5f73 7175  on_decrement_squ
-0000e730: 6172 6520 3d20 6e70 2e73 756d 282d 6772  are = np.sum(-gr
-0000e740: 6164 202a 206e 6577 746f 6e5f 6469 7265  ad * newton_dire
-0000e750: 6374 696f 6e29 0a0a 2020 2020 2020 2020  ction)..        
-0000e760: 6966 2076 6572 626f 7365 3a0a 2020 2020  if verbose:.    
-0000e770: 2020 2020 2020 2020 7072 696e 7428 0a20          print(. 
-0000e780: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0000e790: 2241 7420 6974 6572 6174 6520 7b69 6e64  "At iterate {ind
-0000e7a0: 785f 6974 6572 3a34 647d 3b20 663d 207b  x_iter:4d}; f= {
-0000e7b0: 6c6f 7373 2e69 7465 6d28 293a 2e35 457d  loss.item():.5E}
-0000e7c0: 3b22 2c0a 2020 2020 2020 2020 2020 2020  ;",.            
-0000e7d0: 2020 2020 6622 7c31 2f32 2a4e 6577 746f      f"|1/2*Newto
-0000e7e0: 6e5f 6465 6372 656d 656e 745e 327c 3a20  n_decrement^2|: 
-0000e7f0: 7b6e 6577 746f 6e5f 6465 6372 656d 656e  {newton_decremen
-0000e800: 745f 7371 7561 7265 2e69 7465 6d28 292f  t_square.item()/
-0000e810: 323a 2e35 457d 5c6e 222c 0a20 2020 2020  2:.5E}\n",.     
-0000e820: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-0000e830: 2020 6966 206e 6577 746f 6e5f 6465 6372    if newton_decr
-0000e840: 656d 656e 745f 7371 7561 7265 202f 2032  ement_square / 2
-0000e850: 2e30 203c 3d20 6570 733a 0a20 2020 2020  .0 <= eps:.     
-0000e860: 2020 2020 2020 2062 7265 616b 0a0a 2020         break..  
-0000e870: 2020 2020 2020 2323 2062 6163 6b74 7261        ## backtra
-0000e880: 636b 696e 6720 6c69 6e65 2073 6561 7263  cking line searc
-0000e890: 680a 2020 2020 2020 2020 6d61 785f 6c73  h.        max_ls
-0000e8a0: 5f69 7465 7220 3d20 3130 300a 2020 2020  _iter = 100.    
-0000e8b0: 2020 2020 7374 6570 5f73 697a 6520 3d20      step_size = 
-0000e8c0: 312e 300a 0a20 2020 2020 2020 2069 6e64  1.0..        ind
-0000e8d0: 785f 6c73 5f69 7465 7220 3d20 300a 2020  x_ls_iter = 0.  
-0000e8e0: 2020 2020 2020 7768 696c 6520 696e 6478        while indx
-0000e8f0: 5f6c 735f 6974 6572 203c 206d 6178 5f6c  _ls_iter < max_l
-0000e900: 735f 6974 6572 3a0a 2020 2020 2020 2020  s_iter:.        
-0000e910: 2020 2020 7461 7267 6574 5f6c 6f73 732c      target_loss,
-0000e920: 205f 203d 2066 2878 202b 2073 7465 705f   _ = f(x + step_
-0000e930: 7369 7a65 202a 206e 6577 746f 6e5f 6469  size * newton_di
-0000e940: 7265 6374 696f 6e2c 202a 6172 6773 290a  rection, *args).
-0000e950: 0a20 2020 2020 2020 2020 2020 204e 5f66  .            N_f
-0000e960: 756e 6320 2b3d 2031 0a20 2020 2020 2020  unc += 1.       
-0000e970: 2020 2020 2061 7070 726f 7869 6d61 7465       approximate
-0000e980: 5f6c 6f73 7320 3d20 6c6f 7373 202b 2073  _loss = loss + s
-0000e990: 7465 705f 7369 7a65 202a 2061 6c70 6861  tep_size * alpha
-0000e9a0: 202a 2028 2d6e 6577 746f 6e5f 6465 6372   * (-newton_decr
-0000e9b0: 656d 656e 745f 7371 7561 7265 290a 2020  ement_square).  
-0000e9c0: 2020 2020 2020 2020 2020 6966 2074 6172            if tar
-0000e9d0: 6765 745f 6c6f 7373 203c 2061 7070 726f  get_loss < appro
-0000e9e0: 7869 6d61 7465 5f6c 6f73 733a 0a20 2020  ximate_loss:.   
-0000e9f0: 2020 2020 2020 2020 2020 2020 2062 7265               bre
-0000ea00: 616b 0a20 2020 2020 2020 2020 2020 2065  ak.            e
-0000ea10: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0000ea20: 2020 2020 2073 7465 705f 7369 7a65 203d       step_size =
-0000ea30: 2073 7465 705f 7369 7a65 202a 2062 6574   step_size * bet
-0000ea40: 610a 2020 2020 2020 2020 2020 2020 696e  a.            in
-0000ea50: 6478 5f6c 735f 6974 6572 202b 3d20 310a  dx_ls_iter += 1.
-0000ea60: 0a20 2020 2020 2020 2078 203d 2078 202b  .        x = x +
-0000ea70: 2073 7465 705f 7369 7a65 202a 206e 6577   step_size * new
-0000ea80: 746f 6e5f 6469 7265 6374 696f 6e0a 2020  ton_direction.  
-0000ea90: 2020 2020 2020 696e 6478 5f69 7465 7220        indx_iter 
-0000eaa0: 2b3d 2031 0a0a 2020 2020 6966 2076 6572  += 1..    if ver
-0000eab0: 626f 7365 3a0a 2020 2020 2020 2020 7072  bose:.        pr
-0000eac0: 696e 7428 224e 5f69 7465 7220 2020 3d20  int("N_iter   = 
-0000ead0: 746f 7461 6c20 6e75 6d62 6572 206f 6620  total number of 
-0000eae0: 6974 6572 6174 696f 6e73 2229 0a20 2020  iterations").   
-0000eaf0: 2020 2020 2070 7269 6e74 2822 4e5f 6675       print("N_fu
-0000eb00: 6e63 2020 203d 2074 6f74 616c 206e 756d  nc   = total num
-0000eb10: 6265 7220 6f66 2066 756e 6374 696f 6e20  ber of function 
-0000eb20: 616e 6420 6772 6164 6965 6e74 2065 7661  and gradient eva
-0000eb30: 6c75 6174 696f 6e73 2229 0a20 2020 2020  luations").     
-0000eb40: 2020 2070 7269 6e74 2822 4620 2020 2020     print("F     
-0000eb50: 2020 203d 2066 696e 616c 2066 756e 6374     = final funct
-0000eb60: 696f 6e20 7661 6c75 6520 5c6e 2229 0a20  ion value \n"). 
-0000eb70: 2020 2020 2020 2070 7269 6e74 2822 2020         print("  
-0000eb80: 2020 2020 2020 2020 2020 202a 202a 202a             * * *
-0000eb90: 2020 2020 205c 6e22 290a 2020 2020 2020       \n").      
-0000eba0: 2020 7072 696e 7428 224e 5f69 7465 7220    print("N_iter 
-0000ebb0: 2020 204e 5f66 756e 6320 2020 2020 2020     N_func       
-0000ebc0: 2046 2229 0a20 2020 2020 2020 2070 7269   F").        pri
-0000ebd0: 6e74 2866 227b 696e 6478 5f69 7465 722b  nt(f"{indx_iter+
-0000ebe0: 313a 3664 7d20 2020 207b 4e5f 6675 6e63  1:6d}    {N_func
-0000ebf0: 3a36 647d 2020 2020 7b6c 6f73 732e 6974  :6d}    {loss.it
-0000ec00: 656d 2829 3a2e 3645 7d22 290a 2020 2020  em():.6E}").    
-0000ec10: 2020 2020 7072 696e 7428 6622 2020 4620      print(f"  F 
-0000ec20: 3d20 7b6c 6f73 732e 6974 656d 2829 3a2e  = {loss.item():.
-0000ec30: 3132 667d 205c 6e22 290a 0a20 2020 2020  12f} \n")..     
-0000ec40: 2020 2069 6620 6e65 7774 6f6e 5f64 6563     if newton_dec
-0000ec50: 7265 6d65 6e74 5f73 7175 6172 6520 2f20  rement_square / 
-0000ec60: 322e 3020 3c3d 2065 7073 2061 6e64 2069  2.0 <= eps and i
-0000ec70: 6e64 785f 6974 6572 203c 206d 6178 5f69  ndx_iter < max_i
-0000ec80: 7465 723a 0a20 2020 2020 2020 2020 2020  ter:.           
-0000ec90: 2070 7269 6e74 2822 434f 4e56 4552 4745   print("CONVERGE
-0000eca0: 4e43 453a 2031 2f32 2a4e 6577 746f 6e5f  NCE: 1/2*Newton_
-0000ecb0: 6465 6372 656d 656e 745e 3220 3c20 4550  decrement^2 < EP
-0000ecc0: 5322 290a 2020 2020 2020 2020 656c 7365  S").        else
-0000ecd0: 3a0a 2020 2020 2020 2020 2020 2020 7072  :.            pr
-0000ece0: 696e 7428 2243 4f4e 5645 5247 454e 4345  int("CONVERGENCE
-0000ecf0: 3a20 4e55 4d5f 4f46 5f49 5445 5241 5449  : NUM_OF_ITERATI
-0000ed00: 4f4e 2052 4541 4348 204d 4158 5f49 5445  ON REACH MAX_ITE
-0000ed10: 5241 5449 4f4e 2229 0a0a 2020 2020 7265  RATION")..    re
-0000ed20: 7475 726e 207b 0a20 2020 2020 2020 2022  turn {.        "
-0000ed30: 7822 3a20 782c 0a20 2020 2020 2020 2022  x": x,.        "
-0000ed40: 4e5f 6974 6572 223a 2069 6e64 785f 6974  N_iter": indx_it
-0000ed50: 6572 202b 2031 2c0a 2020 2020 2020 2020  er + 1,.        
-0000ed60: 224e 5f66 756e 6322 3a20 4e5f 6675 6e63  "N_func": N_func
-0000ed70: 2c0a 2020 2020 2020 2020 2246 223a 206c  ,.        "F": l
-0000ed80: 6f73 732e 6974 656d 2829 2c0a 2020 2020  oss.item(),.    
-0000ed90: 2020 2020 2268 616c 665f 6e65 7774 6f6e      "half_newton
-0000eda0: 5f64 6563 7265 6d65 6e74 5f73 7175 6172  _decrement_squar
-0000edb0: 6522 3a20 6e65 7774 6f6e 5f64 6563 7265  e": newton_decre
-0000edc0: 6d65 6e74 5f73 7175 6172 6520 2f20 322e  ment_square / 2.
-0000edd0: 302c 0a20 2020 207d 0a94 7d94 288c 1146  0,.    }..}.(..F
-0000ede0: 6173 744d 4241 522e 5f5f 696e 6974 5f5f  astMBAR.__init__
-0000edf0: 948c 0364 6566 944b 124d 2a01 8794 8c0a  ...def.K.M*.....
-0000ee00: 4661 7374 4d42 4152 2e46 946a 3709 0000  FastMBAR.F.j7...
-0000ee10: 4d2c 014d 3101 8794 8c0e 4661 7374 4d42  M,.M1.....FastMB
-0000ee20: 4152 2e46 5f73 7464 946a 3709 0000 4d33  AR.F_std.j7...M3
-0000ee30: 014d 3901 8794 8c0e 4661 7374 4d42 4152  .M9.....FastMBAR
-0000ee40: 2e46 5f63 6f76 946a 3709 0000 4d3b 014d  .F_cov.j7...M;.M
-0000ee50: 4101 8794 8c0f 4661 7374 4d42 4152 2e44  A.....FastMBAR.D
-0000ee60: 656c 7461 4694 6a37 0900 004d 4301 4d49  eltaF.j7...MC.MI
-0000ee70: 0187 948c 1346 6173 744d 4241 522e 4465  .....FastMBAR.De
-0000ee80: 6c74 6146 5f73 7464 946a 3709 0000 4d4b  ltaF_std.j7...MK
-0000ee90: 014d 5101 8794 8c15 4661 7374 4d42 4152  .MQ.....FastMBAR
-0000eea0: 2e6c 6f67 5f70 726f 625f 6d69 7894 6a37  .log_prob_mix.j7
-0000eeb0: 0900 004d 5301 4d56 0187 948c 3446 6173  ...MS.MV....4Fas
-0000eec0: 744d 4241 522e 6361 6c63 756c 6174 655f  tMBAR.calculate_
-0000eed0: 6672 6565 5f65 6e65 7267 6965 735f 6f66  free_energies_of
-0000eee0: 5f70 6572 7475 7262 6564 5f73 7461 7465  _perturbed_state
-0000eef0: 7394 6a37 0900 004d 5801 4db3 0187 948c  s.j7...MX.M.....
-0000ef00: 0846 6173 744d 4241 5294 8c05 636c 6173  .FastMBAR...clas
-0000ef10: 7394 4b08 4db3 0187 948c 125f 636f 6d70  s.K.M......_comp
-0000ef20: 7574 655f 6c6f 6770 5f6f 665f 4694 6a37  ute_logp_of_F.j7
-0000ef30: 0900 004d b501 4dba 0187 948c 1c5f 636f  ...M..M......_co
-0000ef40: 6d70 7574 655f 6c6f 7373 5f61 6e64 5f67  mpute_loss_and_g
-0000ef50: 7261 645f 6f66 5f64 4694 6a37 0900 004d  rad_of_dF.j7...M
-0000ef60: bd01 4dd9 0187 948c 255f 636f 6d70 7574  ..M.....%_comput
-0000ef70: 655f 6c6f 7373 5f61 6e64 5f67 7261 645f  e_loss_and_grad_
-0000ef80: 6f66 5f64 465f 696e 5f62 6174 6368 946a  of_dF_in_batch.j
-0000ef90: 3709 0000 4ddc 014d fd01 8794 8c24 5f63  7...M..M.....$_c
-0000efa0: 6f6d 7075 7465 5f68 6573 7369 616e 5f6c  ompute_hessian_l
-0000efb0: 6f67 5f6c 696b 656c 6968 6f6f 645f 6f66  og_likelihood_of
-0000efc0: 5f46 946a 3709 0000 4d00 024d 0502 8794  _F.j7...M..M....
-0000efd0: 8c2d 5f63 6f6d 7075 7465 5f68 6573 7369  .-_compute_hessi
-0000efe0: 616e 5f6c 6f67 5f6c 696b 656c 6968 6f6f  an_log_likelihoo
-0000eff0: 645f 6f66 5f46 5f69 6e5f 6261 7463 6894  d_of_F_in_batch.
-0000f000: 6a37 0900 004d 0802 4d17 0287 948c 1b5f  j7...M..M......_
-0000f010: 636f 6d70 7574 655f 6865 7373 6961 6e5f  compute_hessian_
-0000f020: 6c6f 7373 5f6f 665f 6446 946a 3709 0000  loss_of_dF.j7...
-0000f030: 4d1a 024d 1f02 8794 8c24 5f63 6f6d 7075  M..M.....$_compu
-0000f040: 7465 5f68 6573 7369 616e 5f6c 6f73 735f  te_hessian_loss_
-0000f050: 6f66 5f64 465f 696e 5f62 6174 6368 946a  of_dF_in_batch.j
-0000f060: 3709 0000 4d22 024d 2702 8794 8c0b 5f73  7...M".M'....._s
-0000f070: 6f6c 7665 5f6d 6261 7294 6a37 0900 004d  olve_mbar.j7...M
-0000f080: 2a02 4d5f 0287 948c 135f 626f 6f74 7374  *.M_....._bootst
-0000f090: 7261 705f 636f 6e66 5f69 6478 946a 3709  rap_conf_idx.j7.
-0000f0a0: 0000 4d62 024d 7302 8794 8c0b 666d 696e  ..Mb.Ms.....fmin
-0000f0b0: 5f6e 6577 746f 6e94 6a37 0900 004d 7602  _newton.j7...Mv.
-0000f0c0: 4ddf 0287 9475 7d94 288c 0846 6173 744d  M....u}.(..FastM
-0000f0d0: 4241 5294 6a1c 0300 008c 1146 6173 744d  BAR.j......FastM
-0000f0e0: 4241 522e 5f5f 696e 6974 5f5f 946a 1c03  BAR.__init__.j..
-0000f0f0: 0000 8c34 4661 7374 4d42 4152 2e63 616c  ...4FastMBAR.cal
-0000f100: 6375 6c61 7465 5f66 7265 655f 656e 6572  culate_free_ener
-0000f110: 6769 6573 5f6f 665f 7065 7274 7572 6265  gies_of_perturbe
-0000f120: 645f 7374 6174 6573 946a 1c03 0000 758c  d_states.j....u.
-0000f130: 0846 6173 744d 4241 5294 7494 7375 622e  .FastMBAR.t.sub.
+00003470: 6c5f 646f 6373 947d 9428 6aea 0200 0047  l_docs.}.(j....G
+00003480: 41d9 2b1c 315a 0a5f 6aeb 0200 0047 41d9  A.+.1Z._j....GA.
+00003490: 2b1c 315b ecfe 6ae9 0200 0047 41d9 2b1c  +.1[..j....GA.+.
+000034a0: 315d cf9f 6aed 0200 0047 41d9 2b1c 315e  1]..j....GA.+.1^
+000034b0: 7e5f 6ae7 0200 0047 41d9 2b1c 315e e989  ~_j....GA.+.1^..
+000034c0: 6aee 0200 0047 41d9 2b1c 315f cec9 6ae8  j....GA.+.1_..j.
+000034d0: 0200 0047 41d9 2b1c 3160 50a8 6aec 0200  ...GA.+.1`P.j...
+000034e0: 0047 41d9 2b1c 3161 9d17 758c 0c64 6570  .GA.+.1a..u..dep
+000034f0: 656e 6465 6e63 6965 7394 685b 8c0b 6465  endencies.h[..de
+00003500: 6661 756c 7464 6963 7494 9394 8c08 6275  faultdict.....bu
+00003510: 696c 7469 6e73 948c 0373 6574 9493 9485  iltins...set....
+00003520: 9452 9428 6aea 0200 008f 9428 8c1a 2e2e  .R.(j......(....
+00003530: 2f2e 2e2f 4661 7374 4d42 4152 2f66 6173  /../FastMBAR/fas
+00003540: 746d 6261 722e 7079 9490 6aeb 0200 008f  tmbar.py..j.....
+00003550: 9428 8c24 2e2e 2f2e 2e2f 6578 616d 706c  .(.$../../exampl
+00003560: 6573 2f62 7574 616e 652f 6461 7461 2f46  es/butane/data/F
+00003570: 6967 5f31 2e70 6e67 948c 222e 2e2f 2e2e  ig_1.png.."../..
+00003580: 2f65 7861 6d70 6c65 732f 6275 7461 6e65  /examples/butane
+00003590: 2f64 6174 612f 504d 462e 706e 6794 8c1a  /data/PMF.png...
+000035a0: 2e2e 2f2e 2e2f 4661 7374 4d42 4152 2f66  ../../FastMBAR/f
+000035b0: 6173 746d 6261 722e 7079 948c 242e 2e2f  astmbar.py..$../
+000035c0: 2e2e 2f65 7861 6d70 6c65 732f 6275 7461  ../examples/buta
+000035d0: 6e65 2f64 6174 612f 4669 675f 322e 706e  ne/data/Fig_2.pn
+000035e0: 6794 906a e902 0000 8f94 288c 272e 2e2f  g..j......(.'../
+000035f0: 2e2e 2f65 7861 6d70 6c65 732f 6469 616c  ../examples/dial
+00003600: 616e 696e 652f 6461 7461 2f46 6967 5f32  anine/data/Fig_2
+00003610: 2e70 6e67 948c 272e 2e2f 2e2e 2f65 7861  .png..'../../exa
+00003620: 6d70 6c65 732f 6469 616c 616e 696e 652f  mples/dialanine/
+00003630: 6461 7461 2f46 6967 5f31 2e70 6e67 948c  data/Fig_1.png..
+00003640: 1a2e 2e2f 2e2e 2f46 6173 744d 4241 522f  .../../FastMBAR/
+00003650: 6661 7374 6d62 6172 2e70 7994 8c25 2e2e  fastmbar.py..%..
+00003660: 2f2e 2e2f 6578 616d 706c 6573 2f64 6961  /../examples/dia
+00003670: 6c61 6e69 6e65 2f64 6174 612f 504d 462e  lanine/data/PMF.
+00003680: 706e 6794 906a ed02 0000 8f94 288c 1a2e  png..j......(...
+00003690: 2e2f 2e2e 2f46 6173 744d 4241 522f 6661  ./../FastMBAR/fa
+000036a0: 7374 6d62 6172 2e70 7994 906a e702 0000  stmbar.py..j....
+000036b0: 8f94 288c 1a2e 2e2f 2e2e 2f46 6173 744d  ..(..../../FastM
+000036c0: 4241 522f 6661 7374 6d62 6172 2e70 7994  BAR/fastmbar.py.
+000036d0: 906a ee02 0000 8f94 288c 1a2e 2e2f 2e2e  .j......(..../..
+000036e0: 2f46 6173 744d 4241 522f 6661 7374 6d62  /FastMBAR/fastmb
+000036f0: 6172 2e70 7994 906a e802 0000 8f94 288c  ar.py..j......(.
+00003700: 1a2e 2e2f 2e2e 2f46 6173 744d 4241 522f  .../../FastMBAR/
+00003710: 6661 7374 6d62 6172 2e70 7994 906a ec02  fastmbar.py..j..
+00003720: 0000 8f94 288c 172e 2e2f 2e2e 2f65 6e65  ....(..../../ene
+00003730: 7267 795f 6d61 7472 6978 2e70 6e67 948c  rgy_matrix.png..
+00003740: 1a2e 2e2f 2e2e 2f46 6173 744d 4241 522f  .../../FastMBAR/
+00003750: 6661 7374 6d62 6172 2e70 7994 9075 8c08  fastmbar.py..u..
+00003760: 696e 636c 7564 6564 946a 1e03 0000 6a21  included.j....j!
+00003770: 0300 0085 9452 948c 0d72 6572 6561 645f  .....R...reread_
+00003780: 616c 7761 7973 948f 948c 086d 6574 6164  always.....metad
+00003790: 6174 6194 6a1e 0300 006a 1f03 0000 8c04  ata.j....j......
+000037a0: 6469 6374 9493 9485 9452 948c 0674 6974  dict.....R...tit
+000037b0: 6c65 7394 7d94 286a ea02 0000 8c0e 646f  les.}.(j......do
+000037c0: 6375 7469 6c73 2e6e 6f64 6573 948c 0574  cutils.nodes...t
+000037d0: 6974 6c65 9493 9429 8194 7d94 288c 0972  itle...)..}.(..r
+000037e0: 6177 736f 7572 6365 9468 6c8c 0863 6869  awsource.hl..chi
+000037f0: 6c64 7265 6e94 5d94 6a47 0300 008c 0454  ldren.].jG.....T
+00003800: 6578 7494 9394 8c0c 4661 7374 4d42 4152  ext.....FastMBAR
+00003810: 2041 5049 9485 9481 947d 948c 0670 6172   API.....}...par
+00003820: 656e 7494 6a4a 0300 0073 6261 8c0a 6174  ent.jJ...sba..at
+00003830: 7472 6962 7574 6573 947d 9428 8c03 6964  tributes.}.(..id
+00003840: 7394 5d94 8c07 636c 6173 7365 7394 5d94  s.]...classes.].
+00003850: 8c05 6e61 6d65 7394 5d94 8c08 6475 706e  ..names.]...dupn
+00003860: 616d 6573 945d 948c 0862 6163 6b72 6566  ames.]...backref
+00003870: 7394 5d94 758c 0774 6167 6e61 6d65 946a  s.].u..tagname.j
+00003880: 4803 0000 7562 6aeb 0200 006a 4903 0000  H...ubj....jI...
+00003890: 2981 947d 9428 6a4c 0300 0068 6c6a 4d03  )..}.(jL...hljM.
+000038a0: 0000 5d94 6a50 0300 008c 3445 7861 6d70  ..].jP....4Examp
+000038b0: 6c65 2031 2e20 436f 6d70 7574 6520 7468  le 1. Compute th
+000038c0: 6520 504d 4620 6f66 2061 2064 6968 6564  e PMF of a dihed
+000038d0: 7261 6c20 666f 7220 6275 7461 6e65 2e94  ral for butane..
+000038e0: 8594 8194 7d94 6a55 0300 006a 6303 0000  ....}.jU...jc...
+000038f0: 7362 616a 5603 0000 7d94 286a 5803 0000  sbajV...}.(jX...
+00003900: 5d94 6a5a 0300 005d 946a 5c03 0000 5d94  ].jZ...].j\...].
+00003910: 6a5e 0300 005d 946a 6003 0000 5d94 756a  j^...].j`...].uj
+00003920: 6203 0000 6a48 0300 0075 626a e902 0000  b...jH...ubj....
+00003930: 6a49 0300 0029 8194 7d94 286a 4c03 0000  jI...)..}.(jL...
+00003940: 686c 6a4d 0300 005d 946a 5003 0000 8c37  hljM...].jP....7
+00003950: 4578 616d 706c 6520 322e 2043 6f6d 7075  Example 2. Compu
+00003960: 7465 2061 2032 442d 504d 4620 6f66 2064  te a 2D-PMF of d
+00003970: 6968 6564 7261 6c73 2066 6f72 2064 6961  ihedrals for dia
+00003980: 6c61 6e69 6e65 2e94 8594 8194 7d94 6a55  lanine......}.jU
+00003990: 0300 006a 7003 0000 7362 616a 5603 0000  ...jp...sbajV...
+000039a0: 7d94 286a 5803 0000 5d94 6a5a 0300 005d  }.(jX...].jZ...]
+000039b0: 946a 5c03 0000 5d94 6a5e 0300 005d 946a  .j\...].j^...].j
+000039c0: 6003 0000 5d94 756a 6203 0000 6a48 0300  `...].ujb...jH..
+000039d0: 0075 626a ed02 0000 6a49 0300 0029 8194  .ubj....jI...)..
+000039e0: 7d94 286a 4c03 0000 686c 6a4d 0300 005d  }.(jL...hljM...]
+000039f0: 946a 5003 0000 8c08 4578 616d 706c 6573  .jP.....Examples
+00003a00: 9485 9481 947d 946a 5503 0000 6a7d 0300  .....}.jU...j}..
+00003a10: 0073 6261 6a56 0300 007d 9428 6a58 0300  .sbajV...}.(jX..
+00003a20: 005d 946a 5a03 0000 5d94 6a5c 0300 005d  .].jZ...].j\...]
+00003a30: 946a 5e03 0000 5d94 6a60 0300 005d 9475  .j^...].j`...].u
+00003a40: 6a62 0300 006a 4803 0000 7562 6ae7 0200  jb...jH...ubj...
+00003a50: 006a 4903 0000 2981 947d 9428 6a4c 0300  .jI...)..}.(jL..
+00003a60: 0068 6c6a 4d03 0000 5d94 6a50 0300 008c  .hljM...].jP....
+00003a70: 1457 656c 636f 6d65 2074 6f20 4661 7374  .Welcome to Fast
+00003a80: 4d42 4152 2194 8594 8194 7d94 6a55 0300  MBAR!.....}.jU..
+00003a90: 006a 8a03 0000 7362 616a 5603 0000 7d94  .j....sbajV...}.
+00003aa0: 286a 5803 0000 5d94 6a5a 0300 005d 946a  (jX...].jZ...].j
+00003ab0: 5c03 0000 5d94 6a5e 0300 005d 946a 6003  \...].j^...].j`.
+00003ac0: 0000 5d94 756a 6203 0000 6a48 0300 0075  ..].ujb...jH...u
+00003ad0: 626a ee02 0000 6a49 0300 0029 8194 7d94  bj....jI...)..}.
+00003ae0: 286a 4c03 0000 686c 6a4d 0300 005d 946a  (jL...hljM...].j
+00003af0: 5003 0000 8c0c 496e 7374 616c 6c61 7469  P.....Installati
+00003b00: 6f6e 9485 9481 947d 946a 5503 0000 6a97  on.....}.jU...j.
+00003b10: 0300 0073 6261 6a56 0300 007d 9428 6a58  ...sbajV...}.(jX
+00003b20: 0300 005d 946a 5a03 0000 5d94 6a5c 0300  ...].jZ...].j\..
+00003b30: 005d 946a 5e03 0000 5d94 6a60 0300 005d  .].j^...].j`...]
+00003b40: 9475 6a62 0300 006a 4803 0000 7562 6ae8  .ujb...jH...ubj.
+00003b50: 0200 006a 4903 0000 2981 947d 9428 6a4c  ...jI...)..}.(jL
+00003b60: 0300 0068 6c6a 4d03 0000 5d94 6a50 0300  ...hljM...].jP..
+00003b70: 008c 0a52 6566 6572 656e 6365 7394 8594  ...References...
+00003b80: 8194 7d94 6a55 0300 006a a403 0000 7362  ..}.jU...j....sb
+00003b90: 616a 5603 0000 7d94 286a 5803 0000 5d94  ajV...}.(jX...].
+00003ba0: 6a5a 0300 005d 946a 5c03 0000 5d94 6a5e  jZ...].j\...].j^
+00003bb0: 0300 005d 946a 6003 0000 5d94 756a 6203  ...].j`...].ujb.
+00003bc0: 0000 6a48 0300 0075 626a ec02 0000 6a49  ..jH...ubj....jI
+00003bd0: 0300 0029 8194 7d94 286a 4c03 0000 686c  ...)..}.(jL...hl
+00003be0: 6a4d 0300 005d 946a 5003 0000 8c05 5573  jM...].jP.....Us
+00003bf0: 6167 6594 8594 8194 7d94 6a55 0300 006a  age.....}.jU...j
+00003c00: b103 0000 7362 616a 5603 0000 7d94 286a  ....sbajV...}.(j
+00003c10: 5803 0000 5d94 6a5a 0300 005d 946a 5c03  X...].jZ...].j\.
+00003c20: 0000 5d94 6a5e 0300 005d 946a 6003 0000  ..].j^...].j`...
+00003c30: 5d94 756a 6203 0000 6a48 0300 0075 6275  ].ujb...jH...ubu
+00003c40: 8c0a 6c6f 6e67 7469 746c 6573 947d 9428  ..longtitles.}.(
+00003c50: 6aea 0200 006a 4a03 0000 6aeb 0200 006a  j....jJ...j....j
+00003c60: 6303 0000 6ae9 0200 006a 7003 0000 6aed  c...j....jp...j.
+00003c70: 0200 006a 7d03 0000 6ae7 0200 006a 8a03  ...j}...j....j..
+00003c80: 0000 6aee 0200 006a 9703 0000 6ae8 0200  ..j....j....j...
+00003c90: 006a a403 0000 6aec 0200 006a b103 0000  .j....j....j....
+00003ca0: 758c 0474 6f63 7394 7d94 286a ea02 0000  u..tocs.}.(j....
+00003cb0: 6a47 0300 008c 0b62 756c 6c65 745f 6c69  jG.....bullet_li
+00003cc0: 7374 9493 9429 8194 7d94 286a 4c03 0000  st...)..}.(jL...
+00003cd0: 686c 6a4d 0300 005d 946a 4703 0000 8c09  hljM...].jG.....
+00003ce0: 6c69 7374 5f69 7465 6d94 9394 2981 947d  list_item...)..}
+00003cf0: 9428 6a4c 0300 0068 6c6a 4d03 0000 5d94  .(jL...hljM...].
+00003d00: 8c0f 7370 6869 6e78 2e61 6464 6e6f 6465  ..sphinx.addnode
+00003d10: 7394 8c11 636f 6d70 6163 745f 7061 7261  s...compact_para
+00003d20: 6772 6170 6894 9394 2981 947d 9428 6a4c  graph...)..}.(jL
+00003d30: 0300 0068 6c6a 4d03 0000 5d94 6a47 0300  ...hljM...].jG..
+00003d40: 008c 0972 6566 6572 656e 6365 9493 9429  ...reference...)
+00003d50: 8194 7d94 286a 4c03 0000 686c 6a4d 0300  ..}.(jL...hljM..
+00003d60: 005d 946a 5003 0000 8c0c 4661 7374 4d42  .].jP.....FastMB
+00003d70: 4152 2041 5049 9485 9481 947d 946a 5503  AR API.....}.jU.
+00003d80: 0000 6ad4 0300 0073 6261 6a56 0300 007d  ..j....sbajV...}
+00003d90: 9428 6a58 0300 005d 946a 5a03 0000 5d94  .(jX...].jZ...].
+00003da0: 6a5c 0300 005d 946a 5e03 0000 5d94 6a60  j\...].j^...].j`
+00003db0: 0300 005d 948c 0869 6e74 6572 6e61 6c94  ...]...internal.
+00003dc0: 888c 0672 6566 7572 6994 6aea 0200 008c  ...refuri.j.....
+00003dd0: 0a61 6e63 686f 726e 616d 6594 686c 756a  .anchorname.hluj
+00003de0: 6203 0000 6ad2 0300 006a 5503 0000 6acf  b...j....jU...j.
+00003df0: 0300 0075 6261 6a56 0300 007d 9428 6a58  ...ubajV...}.(jX
+00003e00: 0300 005d 946a 5a03 0000 5d94 6a5c 0300  ...].jZ...].j\..
+00003e10: 005d 946a 5e03 0000 5d94 6a60 0300 005d  .].j^...].j`...]
+00003e20: 9475 6a62 0300 006a cd03 0000 6a55 0300  .ujb...j....jU..
+00003e30: 006a c903 0000 7562 616a 5603 0000 7d94  .j....ubajV...}.
+00003e40: 286a 5803 0000 5d94 6a5a 0300 005d 946a  (jX...].jZ...].j
+00003e50: 5c03 0000 5d94 6a5e 0300 005d 946a 6003  \...].j^...].j`.
+00003e60: 0000 5d94 756a 6203 0000 6ac7 0300 006a  ..].ujb...j....j
+00003e70: 5503 0000 6ac4 0300 0075 6261 6a56 0300  U...j....ubajV..
+00003e80: 007d 9428 6a58 0300 005d 946a 5a03 0000  .}.(jX...].jZ...
+00003e90: 5d94 6a5c 0300 005d 946a 5e03 0000 5d94  ].j\...].j^...].
+00003ea0: 6a60 0300 005d 9475 6a62 0300 006a c203  j`...].ujb...j..
+00003eb0: 0000 7562 6aeb 0200 006a c303 0000 2981  ..ubj....j....).
+00003ec0: 947d 9428 6a4c 0300 0068 6c6a 4d03 0000  .}.(jL...hljM...
+00003ed0: 5d94 6ac8 0300 0029 8194 7d94 286a 4c03  ].j....)..}.(jL.
+00003ee0: 0000 686c 6a4d 0300 005d 9428 6ace 0300  ..hljM...].(j...
+00003ef0: 0029 8194 7d94 286a 4c03 0000 686c 6a4d  .)..}.(jL...hljM
+00003f00: 0300 005d 946a d303 0000 2981 947d 9428  ...].j....)..}.(
+00003f10: 6a4c 0300 0068 6c6a 4d03 0000 5d94 6a50  jL...hljM...].jP
+00003f20: 0300 008c 3445 7861 6d70 6c65 2031 2e20  ....4Example 1. 
+00003f30: 436f 6d70 7574 6520 7468 6520 504d 4620  Compute the PMF 
+00003f40: 6f66 2061 2064 6968 6564 7261 6c20 666f  of a dihedral fo
+00003f50: 7220 6275 7461 6e65 2e94 8594 8194 7d94  r butane......}.
+00003f60: 6a55 0300 006a ff03 0000 7362 616a 5603  jU...j....sbajV.
+00003f70: 0000 7d94 286a 5803 0000 5d94 6a5a 0300  ..}.(jX...].jZ..
+00003f80: 005d 946a 5c03 0000 5d94 6a5e 0300 005d  .].j\...].j^...]
+00003f90: 946a 6003 0000 5d94 8c08 696e 7465 726e  .j`...]...intern
+00003fa0: 616c 9488 8c06 7265 6675 7269 946a eb02  al....refuri.j..
+00003fb0: 0000 8c0a 616e 6368 6f72 6e61 6d65 9468  ....anchorname.h
+00003fc0: 6c75 6a62 0300 006a d203 0000 6a55 0300  lujb...j....jU..
+00003fd0: 006a fc03 0000 7562 616a 5603 0000 7d94  .j....ubajV...}.
+00003fe0: 286a 5803 0000 5d94 6a5a 0300 005d 946a  (jX...].jZ...].j
+00003ff0: 5c03 0000 5d94 6a5e 0300 005d 946a 6003  \...].j^...].j`.
+00004000: 0000 5d94 756a 6203 0000 6acd 0300 006a  ..].ujb...j....j
+00004010: 5503 0000 6af9 0300 0075 626a c303 0000  U...j....ubj....
+00004020: 2981 947d 9428 6a4c 0300 0068 6c6a 4d03  )..}.(jL...hljM.
+00004030: 0000 5d94 286a c803 0000 2981 947d 9428  ..].(j....)..}.(
+00004040: 6a4c 0300 0068 6c6a 4d03 0000 5d94 6ace  jL...hljM...].j.
+00004050: 0300 0029 8194 7d94 286a 4c03 0000 686c  ...)..}.(jL...hl
+00004060: 6a4d 0300 005d 946a d303 0000 2981 947d  jM...].j....)..}
+00004070: 9428 6a4c 0300 0068 6c6a 4d03 0000 5d94  .(jL...hljM...].
+00004080: 6a50 0300 008c 2731 2e20 436f 6e73 7472  jP....'1. Constr
+00004090: 7563 7420 616e 204f 7065 6e4d 4d20 7379  uct an OpenMM sy
+000040a0: 7374 656d 206f 6620 6275 7461 6e65 9485  stem of butane..
+000040b0: 9481 947d 946a 5503 0000 6a1e 0400 0073  ...}.jU...j....s
+000040c0: 6261 6a56 0300 007d 9428 6a58 0300 005d  bajV...}.(jX...]
+000040d0: 946a 5a03 0000 5d94 6a5c 0300 005d 946a  .jZ...].j\...].j
+000040e0: 5e03 0000 5d94 6a60 0300 005d 948c 0869  ^...].j`...]...i
+000040f0: 6e74 6572 6e61 6c94 888c 0672 6566 7572  nternal....refur
+00004100: 6994 6aeb 0200 008c 0a61 6e63 686f 726e  i.j......anchorn
+00004110: 616d 6594 8c25 2363 6f6e 7374 7275 6374  ame..%#construct
+00004120: 2d61 6e2d 6f70 656e 6d6d 2d73 7973 7465  -an-openmm-syste
+00004130: 6d2d 6f66 2d62 7574 616e 6594 756a 6203  m-of-butane.ujb.
+00004140: 0000 6ad2 0300 006a 5503 0000 6a1b 0400  ..j....jU...j...
+00004150: 0075 6261 6a56 0300 007d 9428 6a58 0300  .ubajV...}.(jX..
+00004160: 005d 946a 5a03 0000 5d94 6a5c 0300 005d  .].jZ...].j\...]
+00004170: 946a 5e03 0000 5d94 6a60 0300 005d 9475  .j^...].j`...].u
+00004180: 6a62 0300 006a cd03 0000 6a55 0300 006a  jb...j....jU...j
+00004190: 1804 0000 7562 616a 5603 0000 7d94 286a  ....ubajV...}.(j
+000041a0: 5803 0000 5d94 6a5a 0300 005d 946a 5c03  X...].jZ...].j\.
+000041b0: 0000 5d94 6a5e 0300 005d 946a 6003 0000  ..].j^...].j`...
+000041c0: 5d94 756a 6203 0000 6ac7 0300 006a 5503  ].ujb...j....jU.
+000041d0: 0000 6a15 0400 0075 626a c803 0000 2981  ..j....ubj....).
+000041e0: 947d 9428 6a4c 0300 0068 6c6a 4d03 0000  .}.(jL...hljM...
+000041f0: 5d94 6ace 0300 0029 8194 7d94 286a 4c03  ].j....)..}.(jL.
+00004200: 0000 686c 6a4d 0300 005d 946a d303 0000  ..hljM...].j....
+00004210: 2981 947d 9428 6a4c 0300 0068 6c6a 4d03  )..}.(jL...hljM.
+00004220: 0000 5d94 6a50 0300 008c 1832 2e20 5275  ..].jP.....2. Ru
+00004230: 6e20 756d 6272 656c 6c61 2073 616d 706c  n umbrella sampl
+00004240: 696e 6794 8594 8194 7d94 6a55 0300 006a  ing.....}.jU...j
+00004250: 4104 0000 7362 616a 5603 0000 7d94 286a  A...sbajV...}.(j
+00004260: 5803 0000 5d94 6a5a 0300 005d 946a 5c03  X...].jZ...].j\.
+00004270: 0000 5d94 6a5e 0300 005d 946a 6003 0000  ..].j^...].j`...
+00004280: 5d94 8c08 696e 7465 726e 616c 9488 8c06  ]...internal....
+00004290: 7265 6675 7269 946a eb02 0000 8c0a 616e  refuri.j......an
+000042a0: 6368 6f72 6e61 6d65 948c 1623 7275 6e2d  chorname...#run-
+000042b0: 756d 6272 656c 6c61 2d73 616d 706c 696e  umbrella-samplin
+000042c0: 6794 756a 6203 0000 6ad2 0300 006a 5503  g.ujb...j....jU.
+000042d0: 0000 6a3e 0400 0075 6261 6a56 0300 007d  ..j>...ubajV...}
+000042e0: 9428 6a58 0300 005d 946a 5a03 0000 5d94  .(jX...].jZ...].
+000042f0: 6a5c 0300 005d 946a 5e03 0000 5d94 6a60  j\...].j^...].j`
+00004300: 0300 005d 9475 6a62 0300 006a cd03 0000  ...].ujb...j....
+00004310: 6a55 0300 006a 3b04 0000 7562 616a 5603  jU...j;...ubajV.
+00004320: 0000 7d94 286a 5803 0000 5d94 6a5a 0300  ..}.(jX...].jZ..
+00004330: 005d 946a 5c03 0000 5d94 6a5e 0300 005d  .].j\...].j^...]
+00004340: 946a 6003 0000 5d94 756a 6203 0000 6ac7  .j`...].ujb...j.
+00004350: 0300 006a 5503 0000 6a15 0400 0075 626a  ...jU...j....ubj
+00004360: c803 0000 2981 947d 9428 6a4c 0300 0068  ....)..}.(jL...h
+00004370: 6c6a 4d03 0000 5d94 6ace 0300 0029 8194  ljM...].j....)..
+00004380: 7d94 286a 4c03 0000 686c 6a4d 0300 005d  }.(jL...hljM...]
+00004390: 946a d303 0000 2981 947d 9428 6a4c 0300  .j....)..}.(jL..
+000043a0: 0068 6c6a 4d03 0000 5d94 6a50 0300 008c  .hljM...].jP....
+000043b0: 3133 2e20 436f 6d70 7574 6520 616e 6420  13. Compute and 
+000043c0: 636f 6c6c 6563 7420 7468 6520 6275 7461  collect the buta
+000043d0: 6e65 2064 6968 6564 7261 6c20 7661 6c75  ne dihedral valu
+000043e0: 6573 9485 9481 947d 946a 5503 0000 6a64  es.....}.jU...jd
+000043f0: 0400 0073 6261 6a56 0300 007d 9428 6a58  ...sbajV...}.(jX
+00004400: 0300 005d 946a 5a03 0000 5d94 6a5c 0300  ...].jZ...].j\..
+00004410: 005d 946a 5e03 0000 5d94 6a60 0300 005d  .].j^...].j`...]
+00004420: 948c 0869 6e74 6572 6e61 6c94 888c 0672  ...internal....r
+00004430: 6566 7572 6994 6aeb 0200 008c 0a61 6e63  efuri.j......anc
+00004440: 686f 726e 616d 6594 8c2f 2363 6f6d 7075  horname../#compu
+00004450: 7465 2d61 6e64 2d63 6f6c 6c65 6374 2d74  te-and-collect-t
+00004460: 6865 2d62 7574 616e 652d 6469 6865 6472  he-butane-dihedr
+00004470: 616c 2d76 616c 7565 7394 756a 6203 0000  al-values.ujb...
+00004480: 6ad2 0300 006a 5503 0000 6a61 0400 0075  j....jU...ja...u
+00004490: 6261 6a56 0300 007d 9428 6a58 0300 005d  bajV...}.(jX...]
+000044a0: 946a 5a03 0000 5d94 6a5c 0300 005d 946a  .jZ...].j\...].j
+000044b0: 5e03 0000 5d94 6a60 0300 005d 9475 6a62  ^...].j`...].ujb
+000044c0: 0300 006a cd03 0000 6a55 0300 006a 5e04  ...j....jU...j^.
+000044d0: 0000 7562 616a 5603 0000 7d94 286a 5803  ..ubajV...}.(jX.
+000044e0: 0000 5d94 6a5a 0300 005d 946a 5c03 0000  ..].jZ...].j\...
+000044f0: 5d94 6a5e 0300 005d 946a 6003 0000 5d94  ].j^...].j`...].
+00004500: 756a 6203 0000 6ac7 0300 006a 5503 0000  ujb...j....jU...
+00004510: 6a15 0400 0075 626a c803 0000 2981 947d  j....ubj....)..}
+00004520: 9428 6a4c 0300 0068 6c6a 4d03 0000 5d94  .(jL...hljM...].
+00004530: 6ace 0300 0029 8194 7d94 286a 4c03 0000  j....)..}.(jL...
+00004540: 686c 6a4d 0300 005d 946a d303 0000 2981  hljM...].j....).
+00004550: 947d 9428 6a4c 0300 0068 6c6a 4d03 0000  .}.(jL...hljM...
+00004560: 5d94 6a50 0300 008c 4134 2e20 5573 6520  ].jP....A4. Use 
+00004570: 4661 7374 4d42 4152 2074 6f20 736f 6c76  FastMBAR to solv
+00004580: 6520 4d42 4152 2f55 5748 414d 2065 7175  e MBAR/UWHAM equ
+00004590: 6174 696f 6e73 2061 6e64 2063 6f6d 7075  ations and compu
+000045a0: 7465 2074 6865 2050 4d46 9485 9481 947d  te the PMF.....}
+000045b0: 946a 5503 0000 6a87 0400 0073 6261 6a56  .jU...j....sbajV
+000045c0: 0300 007d 9428 6a58 0300 005d 946a 5a03  ...}.(jX...].jZ.
+000045d0: 0000 5d94 6a5c 0300 005d 946a 5e03 0000  ..].j\...].j^...
+000045e0: 5d94 6a60 0300 005d 948c 0869 6e74 6572  ].j`...]...inter
+000045f0: 6e61 6c94 888c 0672 6566 7572 6994 6aeb  nal....refuri.j.
+00004600: 0200 008c 0a61 6e63 686f 726e 616d 6594  .....anchorname.
+00004610: 8c3f 2375 7365 2d66 6173 746d 6261 722d  .?#use-fastmbar-
+00004620: 746f 2d73 6f6c 7665 2d6d 6261 722d 7577  to-solve-mbar-uw
+00004630: 6861 6d2d 6571 7561 7469 6f6e 732d 616e  ham-equations-an
+00004640: 642d 636f 6d70 7574 652d 7468 652d 706d  d-compute-the-pm
+00004650: 6694 756a 6203 0000 6ad2 0300 006a 5503  f.ujb...j....jU.
+00004660: 0000 6a84 0400 0075 6261 6a56 0300 007d  ..j....ubajV...}
+00004670: 9428 6a58 0300 005d 946a 5a03 0000 5d94  .(jX...].jZ...].
+00004680: 6a5c 0300 005d 946a 5e03 0000 5d94 6a60  j\...].j^...].j`
+00004690: 0300 005d 9475 6a62 0300 006a cd03 0000  ...].ujb...j....
+000046a0: 6a55 0300 006a 8104 0000 7562 616a 5603  jU...j....ubajV.
+000046b0: 0000 7d94 286a 5803 0000 5d94 6a5a 0300  ..}.(jX...].jZ..
+000046c0: 005d 946a 5c03 0000 5d94 6a5e 0300 005d  .].j\...].j^...]
+000046d0: 946a 6003 0000 5d94 756a 6203 0000 6ac7  .j`...].ujb...j.
+000046e0: 0300 006a 5503 0000 6a15 0400 0075 6265  ...jU...j....ube
+000046f0: 6a56 0300 007d 9428 6a58 0300 005d 946a  jV...}.(jX...].j
+00004700: 5a03 0000 5d94 6a5c 0300 005d 946a 5e03  Z...].j\...].j^.
+00004710: 0000 5d94 6a60 0300 005d 9475 6a62 0300  ..].j`...].ujb..
+00004720: 006a c203 0000 6a55 0300 006a f903 0000  .j....jU...j....
+00004730: 7562 656a 5603 0000 7d94 286a 5803 0000  ubejV...}.(jX...
+00004740: 5d94 6a5a 0300 005d 946a 5c03 0000 5d94  ].jZ...].j\...].
+00004750: 6a5e 0300 005d 946a 6003 0000 5d94 756a  j^...].j`...].uj
+00004760: 6203 0000 6ac7 0300 006a 5503 0000 6af6  b...j....jU...j.
+00004770: 0300 0075 6261 6a56 0300 007d 9428 6a58  ...ubajV...}.(jX
+00004780: 0300 005d 946a 5a03 0000 5d94 6a5c 0300  ...].jZ...].j\..
+00004790: 005d 946a 5e03 0000 5d94 6a60 0300 005d  .].j^...].j`...]
+000047a0: 9475 6a62 0300 006a c203 0000 7562 6ae9  .ujb...j....ubj.
+000047b0: 0200 006a c303 0000 2981 947d 9428 6a4c  ...j....)..}.(jL
+000047c0: 0300 0068 6c6a 4d03 0000 5d94 6ac8 0300  ...hljM...].j...
+000047d0: 0029 8194 7d94 286a 4c03 0000 686c 6a4d  .)..}.(jL...hljM
+000047e0: 0300 005d 9428 6ace 0300 0029 8194 7d94  ...].(j....)..}.
+000047f0: 286a 4c03 0000 686c 6a4d 0300 005d 946a  (jL...hljM...].j
+00004800: d303 0000 2981 947d 9428 6a4c 0300 0068  ....)..}.(jL...h
+00004810: 6c6a 4d03 0000 5d94 6a50 0300 008c 3745  ljM...].jP....7E
+00004820: 7861 6d70 6c65 2032 2e20 436f 6d70 7574  xample 2. Comput
+00004830: 6520 6120 3244 2d50 4d46 206f 6620 6469  e a 2D-PMF of di
+00004840: 6865 6472 616c 7320 666f 7220 6469 616c  hedrals for dial
+00004850: 616e 696e 652e 9485 9481 947d 946a 5503  anine......}.jU.
+00004860: 0000 6abf 0400 0073 6261 6a56 0300 007d  ..j....sbajV...}
+00004870: 9428 6a58 0300 005d 946a 5a03 0000 5d94  .(jX...].jZ...].
+00004880: 6a5c 0300 005d 946a 5e03 0000 5d94 6a60  j\...].j^...].j`
+00004890: 0300 005d 948c 0869 6e74 6572 6e61 6c94  ...]...internal.
+000048a0: 888c 0672 6566 7572 6994 6ae9 0200 008c  ...refuri.j.....
+000048b0: 0a61 6e63 686f 726e 616d 6594 686c 756a  .anchorname.hluj
+000048c0: 6203 0000 6ad2 0300 006a 5503 0000 6abc  b...j....jU...j.
+000048d0: 0400 0075 6261 6a56 0300 007d 9428 6a58  ...ubajV...}.(jX
+000048e0: 0300 005d 946a 5a03 0000 5d94 6a5c 0300  ...].jZ...].j\..
+000048f0: 005d 946a 5e03 0000 5d94 6a60 0300 005d  .].j^...].j`...]
+00004900: 9475 6a62 0300 006a cd03 0000 6a55 0300  .ujb...j....jU..
+00004910: 006a b904 0000 7562 6ac3 0300 0029 8194  .j....ubj....)..
+00004920: 7d94 286a 4c03 0000 686c 6a4d 0300 005d  }.(jL...hljM...]
+00004930: 9428 6ac8 0300 0029 8194 7d94 286a 4c03  .(j....)..}.(jL.
+00004940: 0000 686c 6a4d 0300 005d 946a ce03 0000  ..hljM...].j....
+00004950: 2981 947d 9428 6a4c 0300 0068 6c6a 4d03  )..}.(jL...hljM.
+00004960: 0000 5d94 6ad3 0300 0029 8194 7d94 286a  ..].j....)..}.(j
+00004970: 4c03 0000 686c 6a4d 0300 005d 946a 5003  L...hljM...].jP.
+00004980: 0000 8c2a 312e 2043 6f6e 7374 7275 6374  ...*1. Construct
+00004990: 2061 6e20 4f70 656e 4d4d 2073 7973 7465   an OpenMM syste
+000049a0: 6d20 6f66 2064 6961 6c61 6e69 6e65 9485  m of dialanine..
+000049b0: 9481 947d 946a 5503 0000 6ade 0400 0073  ...}.jU...j....s
+000049c0: 6261 6a56 0300 007d 9428 6a58 0300 005d  bajV...}.(jX...]
+000049d0: 946a 5a03 0000 5d94 6a5c 0300 005d 946a  .jZ...].j\...].j
+000049e0: 5e03 0000 5d94 6a60 0300 005d 948c 0869  ^...].j`...]...i
+000049f0: 6e74 6572 6e61 6c94 888c 0672 6566 7572  nternal....refur
+00004a00: 6994 6ae9 0200 008c 0a61 6e63 686f 726e  i.j......anchorn
+00004a10: 616d 6594 8c28 2363 6f6e 7374 7275 6374  ame..(#construct
+00004a20: 2d61 6e2d 6f70 656e 6d6d 2d73 7973 7465  -an-openmm-syste
+00004a30: 6d2d 6f66 2d64 6961 6c61 6e69 6e65 9475  m-of-dialanine.u
+00004a40: 6a62 0300 006a d203 0000 6a55 0300 006a  jb...j....jU...j
+00004a50: db04 0000 7562 616a 5603 0000 7d94 286a  ....ubajV...}.(j
+00004a60: 5803 0000 5d94 6a5a 0300 005d 946a 5c03  X...].jZ...].j\.
+00004a70: 0000 5d94 6a5e 0300 005d 946a 6003 0000  ..].j^...].j`...
+00004a80: 5d94 756a 6203 0000 6acd 0300 006a 5503  ].ujb...j....jU.
+00004a90: 0000 6ad8 0400 0075 6261 6a56 0300 007d  ..j....ubajV...}
+00004aa0: 9428 6a58 0300 005d 946a 5a03 0000 5d94  .(jX...].jZ...].
+00004ab0: 6a5c 0300 005d 946a 5e03 0000 5d94 6a60  j\...].j^...].j`
+00004ac0: 0300 005d 9475 6a62 0300 006a c703 0000  ...].ujb...j....
+00004ad0: 6a55 0300 006a d504 0000 7562 6ac8 0300  jU...j....ubj...
+00004ae0: 0029 8194 7d94 286a 4c03 0000 686c 6a4d  .)..}.(jL...hljM
+00004af0: 0300 005d 946a ce03 0000 2981 947d 9428  ...].j....)..}.(
+00004b00: 6a4c 0300 0068 6c6a 4d03 0000 5d94 6ad3  jL...hljM...].j.
+00004b10: 0300 0029 8194 7d94 286a 4c03 0000 686c  ...)..}.(jL...hl
+00004b20: 6a4d 0300 005d 946a 5003 0000 8c18 322e  jM...].jP.....2.
+00004b30: 2052 756e 2075 6d62 7265 6c6c 6120 7361   Run umbrella sa
+00004b40: 6d70 6c69 6e67 9485 9481 947d 946a 5503  mpling.....}.jU.
+00004b50: 0000 6a01 0500 0073 6261 6a56 0300 007d  ..j....sbajV...}
+00004b60: 9428 6a58 0300 005d 946a 5a03 0000 5d94  .(jX...].jZ...].
+00004b70: 6a5c 0300 005d 946a 5e03 0000 5d94 6a60  j\...].j^...].j`
+00004b80: 0300 005d 948c 0869 6e74 6572 6e61 6c94  ...]...internal.
+00004b90: 888c 0672 6566 7572 6994 6ae9 0200 008c  ...refuri.j.....
+00004ba0: 0a61 6e63 686f 726e 616d 6594 8c16 2372  .anchorname...#r
+00004bb0: 756e 2d75 6d62 7265 6c6c 612d 7361 6d70  un-umbrella-samp
+00004bc0: 6c69 6e67 9475 6a62 0300 006a d203 0000  ling.ujb...j....
+00004bd0: 6a55 0300 006a fe04 0000 7562 616a 5603  jU...j....ubajV.
+00004be0: 0000 7d94 286a 5803 0000 5d94 6a5a 0300  ..}.(jX...].jZ..
+00004bf0: 005d 946a 5c03 0000 5d94 6a5e 0300 005d  .].j\...].j^...]
+00004c00: 946a 6003 0000 5d94 756a 6203 0000 6acd  .j`...].ujb...j.
+00004c10: 0300 006a 5503 0000 6afb 0400 0075 6261  ...jU...j....uba
+00004c20: 6a56 0300 007d 9428 6a58 0300 005d 946a  jV...}.(jX...].j
+00004c30: 5a03 0000 5d94 6a5c 0300 005d 946a 5e03  Z...].j\...].j^.
+00004c40: 0000 5d94 6a60 0300 005d 9475 6a62 0300  ..].j`...].ujb..
+00004c50: 006a c703 0000 6a55 0300 006a d504 0000  .j....jU...j....
+00004c60: 7562 6ac8 0300 0029 8194 7d94 286a 4c03  ubj....)..}.(jL.
+00004c70: 0000 686c 6a4d 0300 005d 946a ce03 0000  ..hljM...].j....
+00004c80: 2981 947d 9428 6a4c 0300 0068 6c6a 4d03  )..}.(jL...hljM.
+00004c90: 0000 5d94 6ad3 0300 0029 8194 7d94 286a  ..].j....)..}.(j
+00004ca0: 4c03 0000 686c 6a4d 0300 005d 946a 5003  L...hljM...].jP.
+00004cb0: 0000 8c38 332e 2043 6f6d 7075 7465 2061  ...83. Compute a
+00004cc0: 6e64 2063 6f6c 6c65 6374 2076 616c 7565  nd collect value
+00004cd0: 7320 6f66 2062 6f74 6820 6469 616c 616e  s of both dialan
+00004ce0: 696e 6520 6469 6865 6472 616c 9485 9481  ine dihedral....
+00004cf0: 947d 946a 5503 0000 6a24 0500 0073 6261  .}.jU...j$...sba
+00004d00: 6a56 0300 007d 9428 6a58 0300 005d 946a  jV...}.(jX...].j
+00004d10: 5a03 0000 5d94 6a5c 0300 005d 946a 5e03  Z...].j\...].j^.
+00004d20: 0000 5d94 6a60 0300 005d 948c 0869 6e74  ..].j`...]...int
+00004d30: 6572 6e61 6c94 888c 0672 6566 7572 6994  ernal....refuri.
+00004d40: 6ae9 0200 008c 0a61 6e63 686f 726e 616d  j......anchornam
+00004d50: 6594 8c36 2363 6f6d 7075 7465 2d61 6e64  e..6#compute-and
+00004d60: 2d63 6f6c 6c65 6374 2d76 616c 7565 732d  -collect-values-
+00004d70: 6f66 2d62 6f74 682d 6469 616c 616e 696e  of-both-dialanin
+00004d80: 652d 6469 6865 6472 616c 9475 6a62 0300  e-dihedral.ujb..
+00004d90: 006a d203 0000 6a55 0300 006a 2105 0000  .j....jU...j!...
+00004da0: 7562 616a 5603 0000 7d94 286a 5803 0000  ubajV...}.(jX...
+00004db0: 5d94 6a5a 0300 005d 946a 5c03 0000 5d94  ].jZ...].j\...].
+00004dc0: 6a5e 0300 005d 946a 6003 0000 5d94 756a  j^...].j`...].uj
+00004dd0: 6203 0000 6acd 0300 006a 5503 0000 6a1e  b...j....jU...j.
+00004de0: 0500 0075 6261 6a56 0300 007d 9428 6a58  ...ubajV...}.(jX
+00004df0: 0300 005d 946a 5a03 0000 5d94 6a5c 0300  ...].jZ...].j\..
+00004e00: 005d 946a 5e03 0000 5d94 6a60 0300 005d  .].j^...].j`...]
+00004e10: 9475 6a62 0300 006a c703 0000 6a55 0300  .ujb...j....jU..
+00004e20: 006a d504 0000 7562 6ac8 0300 0029 8194  .j....ubj....)..
+00004e30: 7d94 286a 4c03 0000 686c 6a4d 0300 005d  }.(jL...hljM...]
+00004e40: 946a ce03 0000 2981 947d 9428 6a4c 0300  .j....)..}.(jL..
+00004e50: 0068 6c6a 4d03 0000 5d94 6ad3 0300 0029  .hljM...].j....)
+00004e60: 8194 7d94 286a 4c03 0000 686c 6a4d 0300  ..}.(jL...hljM..
+00004e70: 005d 946a 5003 0000 8c41 342e 2055 7365  .].jP....A4. Use
+00004e80: 2046 6173 744d 4241 5220 746f 2073 6f6c   FastMBAR to sol
+00004e90: 7665 204d 4241 522f 5557 4841 4d20 6571  ve MBAR/UWHAM eq
+00004ea0: 7561 7469 6f6e 7320 616e 6420 636f 6d70  uations and comp
+00004eb0: 7574 6520 7468 6520 504d 4694 8594 8194  ute the PMF.....
+00004ec0: 7d94 6a55 0300 006a 4705 0000 7362 616a  }.jU...jG...sbaj
+00004ed0: 5603 0000 7d94 286a 5803 0000 5d94 6a5a  V...}.(jX...].jZ
+00004ee0: 0300 005d 946a 5c03 0000 5d94 6a5e 0300  ...].j\...].j^..
+00004ef0: 005d 946a 6003 0000 5d94 8c08 696e 7465  .].j`...]...inte
+00004f00: 726e 616c 9488 8c06 7265 6675 7269 946a  rnal....refuri.j
+00004f10: e902 0000 8c0a 616e 6368 6f72 6e61 6d65  ......anchorname
+00004f20: 948c 3f23 7573 652d 6661 7374 6d62 6172  ..?#use-fastmbar
+00004f30: 2d74 6f2d 736f 6c76 652d 6d62 6172 2d75  -to-solve-mbar-u
+00004f40: 7768 616d 2d65 7175 6174 696f 6e73 2d61  wham-equations-a
+00004f50: 6e64 2d63 6f6d 7075 7465 2d74 6865 2d70  nd-compute-the-p
+00004f60: 6d66 9475 6a62 0300 006a d203 0000 6a55  mf.ujb...j....jU
+00004f70: 0300 006a 4405 0000 7562 616a 5603 0000  ...jD...ubajV...
+00004f80: 7d94 286a 5803 0000 5d94 6a5a 0300 005d  }.(jX...].jZ...]
+00004f90: 946a 5c03 0000 5d94 6a5e 0300 005d 946a  .j\...].j^...].j
+00004fa0: 6003 0000 5d94 756a 6203 0000 6acd 0300  `...].ujb...j...
+00004fb0: 006a 5503 0000 6a41 0500 0075 6261 6a56  .jU...jA...ubajV
+00004fc0: 0300 007d 9428 6a58 0300 005d 946a 5a03  ...}.(jX...].jZ.
+00004fd0: 0000 5d94 6a5c 0300 005d 946a 5e03 0000  ..].j\...].j^...
+00004fe0: 5d94 6a60 0300 005d 9475 6a62 0300 006a  ].j`...].ujb...j
+00004ff0: c703 0000 6a55 0300 006a d504 0000 7562  ....jU...j....ub
+00005000: 656a 5603 0000 7d94 286a 5803 0000 5d94  ejV...}.(jX...].
+00005010: 6a5a 0300 005d 946a 5c03 0000 5d94 6a5e  jZ...].j\...].j^
+00005020: 0300 005d 946a 6003 0000 5d94 756a 6203  ...].j`...].ujb.
+00005030: 0000 6ac2 0300 006a 5503 0000 6ab9 0400  ..j....jU...j...
+00005040: 0075 6265 6a56 0300 007d 9428 6a58 0300  .ubejV...}.(jX..
+00005050: 005d 946a 5a03 0000 5d94 6a5c 0300 005d  .].jZ...].j\...]
+00005060: 946a 5e03 0000 5d94 6a60 0300 005d 9475  .j^...].j`...].u
+00005070: 6a62 0300 006a c703 0000 6a55 0300 006a  jb...j....jU...j
+00005080: b604 0000 7562 616a 5603 0000 7d94 286a  ....ubajV...}.(j
+00005090: 5803 0000 5d94 6a5a 0300 005d 946a 5c03  X...].jZ...].j\.
+000050a0: 0000 5d94 6a5e 0300 005d 946a 6003 0000  ..].j^...].j`...
+000050b0: 5d94 756a 6203 0000 6ac2 0300 0075 626a  ].ujb...j....ubj
+000050c0: ed02 0000 6ac3 0300 0029 8194 7d94 286a  ....j....)..}.(j
+000050d0: 4c03 0000 686c 6a4d 0300 005d 946a c803  L...hljM...].j..
+000050e0: 0000 2981 947d 9428 6a4c 0300 0068 6c6a  ..)..}.(jL...hlj
+000050f0: 4d03 0000 5d94 286a ce03 0000 2981 947d  M...].(j....)..}
+00005100: 9428 6a4c 0300 0068 6c6a 4d03 0000 5d94  .(jL...hljM...].
+00005110: 6ad3 0300 0029 8194 7d94 286a 4c03 0000  j....)..}.(jL...
+00005120: 686c 6a4d 0300 005d 946a 5003 0000 8c08  hljM...].jP.....
+00005130: 4578 616d 706c 6573 9485 9481 947d 946a  Examples.....}.j
+00005140: 5503 0000 6a7f 0500 0073 6261 6a56 0300  U...j....sbajV..
+00005150: 007d 9428 6a58 0300 005d 946a 5a03 0000  .}.(jX...].jZ...
+00005160: 5d94 6a5c 0300 005d 946a 5e03 0000 5d94  ].j\...].j^...].
+00005170: 6a60 0300 005d 948c 0869 6e74 6572 6e61  j`...]...interna
+00005180: 6c94 888c 0672 6566 7572 6994 6aed 0200  l....refuri.j...
+00005190: 008c 0a61 6e63 686f 726e 616d 6594 686c  ...anchorname.hl
+000051a0: 756a 6203 0000 6ad2 0300 006a 5503 0000  ujb...j....jU...
+000051b0: 6a7c 0500 0075 6261 6a56 0300 007d 9428  j|...ubajV...}.(
+000051c0: 6a58 0300 005d 946a 5a03 0000 5d94 6a5c  jX...].jZ...].j\
+000051d0: 0300 005d 946a 5e03 0000 5d94 6a60 0300  ...].j^...].j`..
+000051e0: 005d 9475 6a62 0300 006a cd03 0000 6a55  .].ujb...j....jU
+000051f0: 0300 006a 7905 0000 7562 6ac3 0300 0029  ...jy...ubj....)
+00005200: 8194 7d94 286a 4c03 0000 686c 6a4d 0300  ..}.(jL...hljM..
+00005210: 005d 9428 6ac8 0300 0029 8194 7d94 286a  .].(j....)..}.(j
+00005220: 4c03 0000 686c 6a4d 0300 005d 946a ce03  L...hljM...].j..
+00005230: 0000 2981 947d 9428 6a4c 0300 0068 6c6a  ..)..}.(jL...hlj
+00005240: 4d03 0000 5d94 6ad3 0300 0029 8194 7d94  M...].j....)..}.
+00005250: 286a 4c03 0000 686c 6a4d 0300 005d 946a  (jL...hljM...].j
+00005260: 5003 0000 8c25 496e 7374 616c 6c20 4578  P....%Install Ex
+00005270: 7472 6120 5265 7175 6972 6564 2050 7974  tra Required Pyt
+00005280: 686f 6e20 5061 636b 6765 7394 8594 8194  hon Packges.....
+00005290: 7d94 6a55 0300 006a 9e05 0000 7362 616a  }.jU...j....sbaj
+000052a0: 5603 0000 7d94 286a 5803 0000 5d94 6a5a  V...}.(jX...].jZ
+000052b0: 0300 005d 946a 5c03 0000 5d94 6a5e 0300  ...].j\...].j^..
+000052c0: 005d 946a 6003 0000 5d94 8c08 696e 7465  .].j`...]...inte
+000052d0: 726e 616c 9488 8c06 7265 6675 7269 946a  rnal....refuri.j
+000052e0: ed02 0000 8c0a 616e 6368 6f72 6e61 6d65  ......anchorname
+000052f0: 948c 2623 696e 7374 616c 6c2d 6578 7472  ..&#install-extr
+00005300: 612d 7265 7175 6972 6564 2d70 7974 686f  a-required-pytho
+00005310: 6e2d 7061 636b 6765 7394 756a 6203 0000  n-packges.ujb...
+00005320: 6ad2 0300 006a 5503 0000 6a9b 0500 0075  j....jU...j....u
+00005330: 6261 6a56 0300 007d 9428 6a58 0300 005d  bajV...}.(jX...]
+00005340: 946a 5a03 0000 5d94 6a5c 0300 005d 946a  .jZ...].j\...].j
+00005350: 5e03 0000 5d94 6a60 0300 005d 9475 6a62  ^...].j`...].ujb
+00005360: 0300 006a cd03 0000 6a55 0300 006a 9805  ...j....jU...j..
+00005370: 0000 7562 616a 5603 0000 7d94 286a 5803  ..ubajV...}.(jX.
+00005380: 0000 5d94 6a5a 0300 005d 946a 5c03 0000  ..].jZ...].j\...
+00005390: 5d94 6a5e 0300 005d 946a 6003 0000 5d94  ].j^...].j`...].
+000053a0: 756a 6203 0000 6ac7 0300 006a 5503 0000  ujb...j....jU...
+000053b0: 6a95 0500 0075 626a c803 0000 2981 947d  j....ubj....)..}
+000053c0: 9428 6a4c 0300 0068 6c6a 4d03 0000 5d94  .(jL...hljM...].
+000053d0: 286a ce03 0000 2981 947d 9428 6a4c 0300  (j....)..}.(jL..
+000053e0: 0068 6c6a 4d03 0000 5d94 6ad3 0300 0029  .hljM...].j....)
+000053f0: 8194 7d94 286a 4c03 0000 686c 6a4d 0300  ..}.(jL...hljM..
+00005400: 005d 946a 5003 0000 8c08 4578 616d 706c  .].jP.....Exampl
+00005410: 6573 9485 9481 947d 946a 5503 0000 6ac1  es.....}.jU...j.
+00005420: 0500 0073 6261 6a56 0300 007d 9428 6a58  ...sbajV...}.(jX
+00005430: 0300 005d 946a 5a03 0000 5d94 6a5c 0300  ...].jZ...].j\..
+00005440: 005d 946a 5e03 0000 5d94 6a60 0300 005d  .].j^...].j`...]
+00005450: 948c 0869 6e74 6572 6e61 6c94 888c 0672  ...internal....r
+00005460: 6566 7572 6994 6aed 0200 008c 0a61 6e63  efuri.j......anc
+00005470: 686f 726e 616d 6594 8c04 2369 6432 9475  horname...#id2.u
+00005480: 6a62 0300 006a d203 0000 6a55 0300 006a  jb...j....jU...j
+00005490: be05 0000 7562 616a 5603 0000 7d94 286a  ....ubajV...}.(j
+000054a0: 5803 0000 5d94 6a5a 0300 005d 946a 5c03  X...].jZ...].j\.
+000054b0: 0000 5d94 6a5e 0300 005d 946a 6003 0000  ..].j^...].j`...
+000054c0: 5d94 756a 6203 0000 6acd 0300 006a 5503  ].ujb...j....jU.
+000054d0: 0000 6abb 0500 0075 626a c303 0000 2981  ..j....ubj....).
+000054e0: 947d 9428 6a4c 0300 0068 6c6a 4d03 0000  .}.(jL...hljM...
+000054f0: 5d94 6acc 0300 008c 0774 6f63 7472 6565  ].j......toctree
+00005500: 9493 9429 8194 7d94 286a 4c03 0000 686c  ...)..}.(jL...hl
+00005510: 6a4d 0300 005d 946a 5603 0000 7d94 286a  jM...].jV...}.(j
+00005520: 5803 0000 5d94 6a5a 0300 005d 946a 5c03  X...].jZ...].j\.
+00005530: 0000 5d94 6a5e 0300 005d 946a 6003 0000  ..].j^...].j`...
+00005540: 5d94 8c06 7061 7265 6e74 946a ed02 0000  ]...parent.j....
+00005550: 8c07 656e 7472 6965 7394 5d94 284e 8c0a  ..entries.].(N..
+00005560: 6275 7461 6e65 5f50 4d46 9486 944e 8c0d  butane_PMF...N..
+00005570: 6469 616c 616e 696e 655f 504d 4694 8694  dialanine_PMF...
+00005580: 658c 0c69 6e63 6c75 6465 6669 6c65 7394  e..includefiles.
+00005590: 5d94 286a e905 0000 6aeb 0500 0065 8c08  ].(j....j....e..
+000055a0: 6d61 7864 6570 7468 944b 018c 0763 6170  maxdepth.K...cap
+000055b0: 7469 6f6e 944e 8c04 676c 6f62 9489 8c06  tion.N..glob....
+000055c0: 6869 6464 656e 9489 8c0d 696e 636c 7564  hidden....includ
+000055d0: 6568 6964 6465 6e94 898c 086e 756d 6265  ehidden....numbe
+000055e0: 7265 6494 4b00 8c0a 7469 746c 6573 6f6e  red.K...titleson
+000055f0: 6c79 9489 8c0a 7261 7765 6e74 7269 6573  ly....rawentries
+00005600: 945d 9475 6a62 0300 006a db05 0000 8c06  .].ujb...j......
+00005610: 736f 7572 6365 948c 682f 5573 6572 732f  source..h/Users/
+00005620: 6469 6e67 7871 2f4c 6962 7261 7279 2f43  dingxq/Library/C
+00005630: 6c6f 7564 5374 6f72 6167 652f 426f 782d  loudStorage/Box-
+00005640: 426f 782f 5265 7365 6172 6368 2f50 726f  Box/Research/Pro
+00005650: 6a65 6374 735f 6f6e 5f47 6974 6875 622f  jects_on_Github/
+00005660: 4661 7374 4d42 4152 2f64 6f63 732f 736f  FastMBAR/docs/so
+00005670: 7572 6365 2f65 7861 6d70 6c65 732e 7273  urce/examples.rs
+00005680: 7494 8c04 6c69 6e65 944b 2e6a 5503 0000  t...line.K.jU...
+00005690: 6ad8 0500 0075 6261 6a56 0300 007d 9428  j....ubajV...}.(
+000056a0: 6a58 0300 005d 946a 5a03 0000 5d94 6a5c  jX...].jZ...].j\
+000056b0: 0300 005d 946a 5e03 0000 5d94 6a60 0300  ...].j^...].j`..
+000056c0: 005d 9475 6a62 0300 006a c203 0000 6a55  .].ujb...j....jU
+000056d0: 0300 006a bb05 0000 7562 656a 5603 0000  ...j....ubejV...
+000056e0: 7d94 286a 5803 0000 5d94 6a5a 0300 005d  }.(jX...].jZ...]
+000056f0: 946a 5c03 0000 5d94 6a5e 0300 005d 946a  .j\...].j^...].j
+00005700: 6003 0000 5d94 756a 6203 0000 6ac7 0300  `...].ujb...j...
+00005710: 006a 5503 0000 6a95 0500 0075 6265 6a56  .jU...j....ubejV
+00005720: 0300 007d 9428 6a58 0300 005d 946a 5a03  ...}.(jX...].jZ.
+00005730: 0000 5d94 6a5c 0300 005d 946a 5e03 0000  ..].j\...].j^...
+00005740: 5d94 6a60 0300 005d 9475 6a62 0300 006a  ].j`...].ujb...j
+00005750: c203 0000 6a55 0300 006a 7905 0000 7562  ....jU...jy...ub
+00005760: 656a 5603 0000 7d94 286a 5803 0000 5d94  ejV...}.(jX...].
+00005770: 6a5a 0300 005d 946a 5c03 0000 5d94 6a5e  jZ...].j\...].j^
+00005780: 0300 005d 946a 6003 0000 5d94 756a 6203  ...].j`...].ujb.
+00005790: 0000 6ac7 0300 006a 5503 0000 6a76 0500  ..j....jU...jv..
+000057a0: 0075 6261 6a56 0300 007d 9428 6a58 0300  .ubajV...}.(jX..
+000057b0: 005d 946a 5a03 0000 5d94 6a5c 0300 005d  .].jZ...].j\...]
+000057c0: 946a 5e03 0000 5d94 6a60 0300 005d 9475  .j^...].j`...].u
+000057d0: 6a62 0300 006a c203 0000 7562 6ae7 0200  jb...j....ubj...
+000057e0: 006a c303 0000 2981 947d 9428 6a4c 0300  .j....)..}.(jL..
+000057f0: 0068 6c6a 4d03 0000 5d94 6ac8 0300 0029  .hljM...].j....)
+00005800: 8194 7d94 286a 4c03 0000 686c 6a4d 0300  ..}.(jL...hljM..
+00005810: 005d 9428 6ace 0300 0029 8194 7d94 286a  .].(j....)..}.(j
+00005820: 4c03 0000 686c 6a4d 0300 005d 946a d303  L...hljM...].j..
+00005830: 0000 2981 947d 9428 6a4c 0300 0068 6c6a  ..)..}.(jL...hlj
+00005840: 4d03 0000 5d94 6a50 0300 008c 1457 656c  M...].jP.....Wel
+00005850: 636f 6d65 2074 6f20 4661 7374 4d42 4152  come to FastMBAR
+00005860: 2194 8594 8194 7d94 6a55 0300 006a 2206  !.....}.jU...j".
+00005870: 0000 7362 616a 5603 0000 7d94 286a 5803  ..sbajV...}.(jX.
+00005880: 0000 5d94 6a5a 0300 005d 946a 5c03 0000  ..].jZ...].j\...
+00005890: 5d94 6a5e 0300 005d 946a 6003 0000 5d94  ].j^...].j`...].
+000058a0: 8c08 696e 7465 726e 616c 9488 8c06 7265  ..internal....re
+000058b0: 6675 7269 946a e702 0000 8c0a 616e 6368  furi.j......anch
+000058c0: 6f72 6e61 6d65 9468 6c75 6a62 0300 006a  orname.hlujb...j
+000058d0: d203 0000 6a55 0300 006a 1f06 0000 7562  ....jU...j....ub
+000058e0: 616a 5603 0000 7d94 286a 5803 0000 5d94  ajV...}.(jX...].
+000058f0: 6a5a 0300 005d 946a 5c03 0000 5d94 6a5e  jZ...].j\...].j^
+00005900: 0300 005d 946a 6003 0000 5d94 756a 6203  ...].j`...].ujb.
+00005910: 0000 6acd 0300 006a 5503 0000 6a1c 0600  ..j....jU...j...
+00005920: 0075 626a c303 0000 2981 947d 9428 6a4c  .ubj....)..}.(jL
+00005930: 0300 0068 6c6a 4d03 0000 5d94 286a c803  ...hljM...].(j..
+00005940: 0000 2981 947d 9428 6a4c 0300 0068 6c6a  ..)..}.(jL...hlj
+00005950: 4d03 0000 5d94 6ace 0300 0029 8194 7d94  M...].j....)..}.
+00005960: 286a 4c03 0000 686c 6a4d 0300 005d 946a  (jL...hljM...].j
+00005970: d303 0000 2981 947d 9428 6a4c 0300 0068  ....)..}.(jL...h
+00005980: 6c6a 4d03 0000 5d94 6a50 0300 008c 1157  ljM...].jP.....W
+00005990: 6861 7420 6973 2046 6173 744d 4241 523f  hat is FastMBAR?
+000059a0: 9485 9481 947d 946a 5503 0000 6a41 0600  .....}.jU...jA..
+000059b0: 0073 6261 6a56 0300 007d 9428 6a58 0300  .sbajV...}.(jX..
+000059c0: 005d 946a 5a03 0000 5d94 6a5c 0300 005d  .].jZ...].j\...]
+000059d0: 946a 5e03 0000 5d94 6a60 0300 005d 948c  .j^...].j`...]..
+000059e0: 0869 6e74 6572 6e61 6c94 888c 0672 6566  .internal....ref
+000059f0: 7572 6994 6ae7 0200 008c 0a61 6e63 686f  uri.j......ancho
+00005a00: 726e 616d 6594 8c11 2377 6861 742d 6973  rname...#what-is
+00005a10: 2d66 6173 746d 6261 7294 756a 6203 0000  -fastmbar.ujb...
+00005a20: 6ad2 0300 006a 5503 0000 6a3e 0600 0075  j....jU...j>...u
+00005a30: 6261 6a56 0300 007d 9428 6a58 0300 005d  bajV...}.(jX...]
+00005a40: 946a 5a03 0000 5d94 6a5c 0300 005d 946a  .jZ...].j\...].j
+00005a50: 5e03 0000 5d94 6a60 0300 005d 9475 6a62  ^...].j`...].ujb
+00005a60: 0300 006a cd03 0000 6a55 0300 006a 3b06  ...j....jU...j;.
+00005a70: 0000 7562 616a 5603 0000 7d94 286a 5803  ..ubajV...}.(jX.
+00005a80: 0000 5d94 6a5a 0300 005d 946a 5c03 0000  ..].jZ...].j\...
+00005a90: 5d94 6a5e 0300 005d 946a 6003 0000 5d94  ].j^...].j`...].
+00005aa0: 756a 6203 0000 6ac7 0300 006a 5503 0000  ujb...j....jU...
+00005ab0: 6a38 0600 0075 626a c803 0000 2981 947d  j8...ubj....)..}
+00005ac0: 9428 6a4c 0300 0068 6c6a 4d03 0000 5d94  .(jL...hljM...].
+00005ad0: 6ace 0300 0029 8194 7d94 286a 4c03 0000  j....)..}.(jL...
+00005ae0: 686c 6a4d 0300 005d 946a d303 0000 2981  hljM...].j....).
+00005af0: 947d 9428 6a4c 0300 0068 6c6a 4d03 0000  .}.(jL...hljM...
+00005b00: 5d94 6a50 0300 008c 0d57 6879 2046 6173  ].jP.....Why Fas
+00005b10: 744d 4241 523f 9485 9481 947d 946a 5503  tMBAR?.....}.jU.
+00005b20: 0000 6a64 0600 0073 6261 6a56 0300 007d  ..jd...sbajV...}
+00005b30: 9428 6a58 0300 005d 946a 5a03 0000 5d94  .(jX...].jZ...].
+00005b40: 6a5c 0300 005d 946a 5e03 0000 5d94 6a60  j\...].j^...].j`
+00005b50: 0300 005d 948c 0869 6e74 6572 6e61 6c94  ...]...internal.
+00005b60: 888c 0672 6566 7572 6994 6ae7 0200 008c  ...refuri.j.....
+00005b70: 0a61 6e63 686f 726e 616d 6594 8c0d 2377  .anchorname...#w
+00005b80: 6879 2d66 6173 746d 6261 7294 756a 6203  hy-fastmbar.ujb.
+00005b90: 0000 6ad2 0300 006a 5503 0000 6a61 0600  ..j....jU...ja..
+00005ba0: 0075 6261 6a56 0300 007d 9428 6a58 0300  .ubajV...}.(jX..
+00005bb0: 005d 946a 5a03 0000 5d94 6a5c 0300 005d  .].jZ...].j\...]
+00005bc0: 946a 5e03 0000 5d94 6a60 0300 005d 9475  .j^...].j`...].u
+00005bd0: 6a62 0300 006a cd03 0000 6a55 0300 006a  jb...j....jU...j
+00005be0: 5e06 0000 7562 616a 5603 0000 7d94 286a  ^...ubajV...}.(j
+00005bf0: 5803 0000 5d94 6a5a 0300 005d 946a 5c03  X...].jZ...].j\.
+00005c00: 0000 5d94 6a5e 0300 005d 946a 6003 0000  ..].j^...].j`...
+00005c10: 5d94 756a 6203 0000 6ac7 0300 006a 5503  ].ujb...j....jU.
+00005c20: 0000 6a38 0600 0075 626a c803 0000 2981  ..j8...ubj....).
+00005c30: 947d 9428 6a4c 0300 0068 6c6a 4d03 0000  .}.(jL...hljM...
+00005c40: 5d94 286a ce03 0000 2981 947d 9428 6a4c  ].(j....)..}.(jL
+00005c50: 0300 0068 6c6a 4d03 0000 5d94 6ad3 0300  ...hljM...].j...
+00005c60: 0029 8194 7d94 286a 4c03 0000 686c 6a4d  .)..}.(jL...hljM
+00005c70: 0300 005d 946a 5003 0000 8c14 486f 7720  ...].jP.....How 
+00005c80: 746f 2075 7365 2046 6173 744d 4241 523f  to use FastMBAR?
+00005c90: 9485 9481 947d 946a 5503 0000 6a87 0600  .....}.jU...j...
+00005ca0: 0073 6261 6a56 0300 007d 9428 6a58 0300  .sbajV...}.(jX..
+00005cb0: 005d 946a 5a03 0000 5d94 6a5c 0300 005d  .].jZ...].j\...]
+00005cc0: 946a 5e03 0000 5d94 6a60 0300 005d 948c  .j^...].j`...]..
+00005cd0: 0869 6e74 6572 6e61 6c94 888c 0672 6566  .internal....ref
+00005ce0: 7572 6994 6ae7 0200 008c 0a61 6e63 686f  uri.j......ancho
+00005cf0: 726e 616d 6594 8c14 2368 6f77 2d74 6f2d  rname...#how-to-
+00005d00: 7573 652d 6661 7374 6d62 6172 9475 6a62  use-fastmbar.ujb
+00005d10: 0300 006a d203 0000 6a55 0300 006a 8406  ...j....jU...j..
+00005d20: 0000 7562 616a 5603 0000 7d94 286a 5803  ..ubajV...}.(jX.
+00005d30: 0000 5d94 6a5a 0300 005d 946a 5c03 0000  ..].jZ...].j\...
+00005d40: 5d94 6a5e 0300 005d 946a 6003 0000 5d94  ].j^...].j`...].
+00005d50: 756a 6203 0000 6acd 0300 006a 5503 0000  ujb...j....jU...
+00005d60: 6a81 0600 0075 626a c303 0000 2981 947d  j....ubj....)..}
+00005d70: 9428 6a4c 0300 0068 6c6a 4d03 0000 5d94  .(jL...hljM...].
+00005d80: 6adc 0500 0029 8194 7d94 286a 4c03 0000  j....)..}.(jL...
+00005d90: 686c 6a4d 0300 005d 946a 5603 0000 7d94  hljM...].jV...}.
+00005da0: 286a 5803 0000 5d94 6a5a 0300 005d 946a  (jX...].jZ...].j
+00005db0: 5c03 0000 5d94 6a5e 0300 005d 946a 6003  \...].j^...].j`.
+00005dc0: 0000 5d94 8c06 7061 7265 6e74 946a e702  ..]...parent.j..
+00005dd0: 0000 8c07 656e 7472 6965 7394 5d94 284e  ....entries.].(N
+00005de0: 8c0c 696e 7374 616c 6c61 7469 6f6e 9486  ..installation..
+00005df0: 944e 8c05 7573 6167 6594 8694 4e8c 0341  .N..usage...N..A
+00005e00: 5049 9486 944e 8c08 6578 616d 706c 6573  PI...N..examples
+00005e10: 9486 944e 8c0a 7265 6665 7265 6e63 6573  ...N..references
+00005e20: 9486 9465 8c0c 696e 636c 7564 6566 696c  ...e..includefil
+00005e30: 6573 945d 9428 6aad 0600 006a af06 0000  es.].(j....j....
+00005e40: 6ab1 0600 006a b306 0000 6ab5 0600 0065  j....j....j....e
+00005e50: 8c08 6d61 7864 6570 7468 944b 028c 0763  ..maxdepth.K...c
+00005e60: 6170 7469 6f6e 944e 8c04 676c 6f62 9489  aption.N..glob..
+00005e70: 8c06 6869 6464 656e 9489 8c0d 696e 636c  ..hidden....incl
+00005e80: 7564 6568 6964 6465 6e94 898c 086e 756d  udehidden....num
+00005e90: 6265 7265 6494 4b00 8c0a 7469 746c 6573  bered.K...titles
+00005ea0: 6f6e 6c79 9489 8c0a 7261 7765 6e74 7269  only....rawentri
+00005eb0: 6573 945d 9475 6a62 0300 006a db05 0000  es.].ujb...j....
+00005ec0: 6af8 0500 008c 652f 5573 6572 732f 6469  j.....e/Users/di
+00005ed0: 6e67 7871 2f4c 6962 7261 7279 2f43 6c6f  ngxq/Library/Clo
+00005ee0: 7564 5374 6f72 6167 652f 426f 782d 426f  udStorage/Box-Bo
+00005ef0: 782f 5265 7365 6172 6368 2f50 726f 6a65  x/Research/Proje
+00005f00: 6374 735f 6f6e 5f47 6974 6875 622f 4661  cts_on_Github/Fa
+00005f10: 7374 4d42 4152 2f64 6f63 732f 736f 7572  stMBAR/docs/sour
+00005f20: 6365 2f69 6e64 6578 2e72 7374 946a fa05  ce/index.rst.j..
+00005f30: 0000 4b20 6a55 0300 006a 9e06 0000 7562  ..K jU...j....ub
+00005f40: 616a 5603 0000 7d94 286a 5803 0000 5d94  ajV...}.(jX...].
+00005f50: 6a5a 0300 005d 946a 5c03 0000 5d94 6a5e  jZ...].j\...].j^
+00005f60: 0300 005d 946a 6003 0000 5d94 756a 6203  ...].j`...].ujb.
+00005f70: 0000 6ac2 0300 006a 5503 0000 6a81 0600  ..j....jU...j...
+00005f80: 0075 6265 6a56 0300 007d 9428 6a58 0300  .ubejV...}.(jX..
+00005f90: 005d 946a 5a03 0000 5d94 6a5c 0300 005d  .].jZ...].j\...]
+00005fa0: 946a 5e03 0000 5d94 6a60 0300 005d 9475  .j^...].j`...].u
+00005fb0: 6a62 0300 006a c703 0000 6a55 0300 006a  jb...j....jU...j
+00005fc0: 3806 0000 7562 656a 5603 0000 7d94 286a  8...ubejV...}.(j
+00005fd0: 5803 0000 5d94 6a5a 0300 005d 946a 5c03  X...].jZ...].j\.
+00005fe0: 0000 5d94 6a5e 0300 005d 946a 6003 0000  ..].j^...].j`...
+00005ff0: 5d94 756a 6203 0000 6ac2 0300 006a 5503  ].ujb...j....jU.
+00006000: 0000 6a1c 0600 0075 6265 6a56 0300 007d  ..j....ubejV...}
+00006010: 9428 6a58 0300 005d 946a 5a03 0000 5d94  .(jX...].jZ...].
+00006020: 6a5c 0300 005d 946a 5e03 0000 5d94 6a60  j\...].j^...].j`
+00006030: 0300 005d 9475 6a62 0300 006a c703 0000  ...].ujb...j....
+00006040: 6a55 0300 006a 1906 0000 7562 616a 5603  jU...j....ubajV.
+00006050: 0000 7d94 286a 5803 0000 5d94 6a5a 0300  ..}.(jX...].jZ..
+00006060: 005d 946a 5c03 0000 5d94 6a5e 0300 005d  .].j\...].j^...]
+00006070: 946a 6003 0000 5d94 756a 6203 0000 6ac2  .j`...].ujb...j.
+00006080: 0300 0075 626a ee02 0000 6ac3 0300 0029  ...ubj....j....)
+00006090: 8194 7d94 286a 4c03 0000 686c 6a4d 0300  ..}.(jL...hljM..
+000060a0: 005d 946a c803 0000 2981 947d 9428 6a4c  .].j....)..}.(jL
+000060b0: 0300 0068 6c6a 4d03 0000 5d94 286a ce03  ...hljM...].(j..
+000060c0: 0000 2981 947d 9428 6a4c 0300 0068 6c6a  ..)..}.(jL...hlj
+000060d0: 4d03 0000 5d94 6ad3 0300 0029 8194 7d94  M...].j....)..}.
+000060e0: 286a 4c03 0000 686c 6a4d 0300 005d 946a  (jL...hljM...].j
+000060f0: 5003 0000 8c0c 496e 7374 616c 6c61 7469  P.....Installati
+00006100: 6f6e 9485 9481 947d 946a 5503 0000 6aea  on.....}.jU...j.
+00006110: 0600 0073 6261 6a56 0300 007d 9428 6a58  ...sbajV...}.(jX
+00006120: 0300 005d 946a 5a03 0000 5d94 6a5c 0300  ...].jZ...].j\..
+00006130: 005d 946a 5e03 0000 5d94 6a60 0300 005d  .].j^...].j`...]
+00006140: 948c 0869 6e74 6572 6e61 6c94 888c 0672  ...internal....r
+00006150: 6566 7572 6994 6aee 0200 008c 0a61 6e63  efuri.j......anc
+00006160: 686f 726e 616d 6594 686c 756a 6203 0000  horname.hlujb...
+00006170: 6ad2 0300 006a 5503 0000 6ae7 0600 0075  j....jU...j....u
+00006180: 6261 6a56 0300 007d 9428 6a58 0300 005d  bajV...}.(jX...]
+00006190: 946a 5a03 0000 5d94 6a5c 0300 005d 946a  .jZ...].j\...].j
+000061a0: 5e03 0000 5d94 6a60 0300 005d 9475 6a62  ^...].j`...].ujb
+000061b0: 0300 006a cd03 0000 6a55 0300 006a e406  ...j....jU...j..
+000061c0: 0000 7562 6ac3 0300 0029 8194 7d94 286a  ..ubj....)..}.(j
+000061d0: 4c03 0000 686c 6a4d 0300 005d 9428 6ac8  L...hljM...].(j.
+000061e0: 0300 0029 8194 7d94 286a 4c03 0000 686c  ...)..}.(jL...hl
+000061f0: 6a4d 0300 005d 946a ce03 0000 2981 947d  jM...].j....)..}
+00006200: 9428 6a4c 0300 0068 6c6a 4d03 0000 5d94  .(jL...hljM...].
+00006210: 6ad3 0300 0029 8194 7d94 286a 4c03 0000  j....)..}.(jL...
+00006220: 686c 6a4d 0300 005d 946a 5003 0000 8c1d  hljM...].jP.....
+00006230: 312e 204e 6577 2074 6f20 5079 7468 6f6e  1. New to Python
+00006240: 206f 7220 416e 6163 6f6e 6461 3f94 8594   or Anaconda?...
+00006250: 8194 7d94 6a55 0300 006a 0907 0000 7362  ..}.jU...j....sb
+00006260: 616a 5603 0000 7d94 286a 5803 0000 5d94  ajV...}.(jX...].
+00006270: 6a5a 0300 005d 946a 5c03 0000 5d94 6a5e  jZ...].j\...].j^
+00006280: 0300 005d 946a 6003 0000 5d94 8c08 696e  ...].j`...]...in
+00006290: 7465 726e 616c 9488 8c06 7265 6675 7269  ternal....refuri
+000062a0: 946a ee02 0000 8c0a 616e 6368 6f72 6e61  .j......anchorna
+000062b0: 6d65 948c 1a23 6e65 772d 746f 2d70 7974  me...#new-to-pyt
+000062c0: 686f 6e2d 6f72 2d61 6e61 636f 6e64 6194  hon-or-anaconda.
+000062d0: 756a 6203 0000 6ad2 0300 006a 5503 0000  ujb...j....jU...
+000062e0: 6a06 0700 0075 6261 6a56 0300 007d 9428  j....ubajV...}.(
+000062f0: 6a58 0300 005d 946a 5a03 0000 5d94 6a5c  jX...].jZ...].j\
+00006300: 0300 005d 946a 5e03 0000 5d94 6a60 0300  ...].j^...].j`..
+00006310: 005d 9475 6a62 0300 006a cd03 0000 6a55  .].ujb...j....jU
+00006320: 0300 006a 0307 0000 7562 616a 5603 0000  ...j....ubajV...
+00006330: 7d94 286a 5803 0000 5d94 6a5a 0300 005d  }.(jX...].jZ...]
+00006340: 946a 5c03 0000 5d94 6a5e 0300 005d 946a  .j\...].j^...].j
+00006350: 6003 0000 5d94 756a 6203 0000 6ac7 0300  `...].ujb...j...
+00006360: 006a 5503 0000 6a00 0700 0075 626a c803  .jU...j....ubj..
+00006370: 0000 2981 947d 9428 6a4c 0300 0068 6c6a  ..)..}.(jL...hlj
+00006380: 4d03 0000 5d94 6ace 0300 0029 8194 7d94  M...].j....)..}.
+00006390: 286a 4c03 0000 686c 6a4d 0300 005d 946a  (jL...hljM...].j
+000063a0: d303 0000 2981 947d 9428 6a4c 0300 0068  ....)..}.(jL...h
+000063b0: 6c6a 4d03 0000 5d94 6a50 0300 008c 1c32  ljM...].jP.....2
+000063c0: 2e20 496e 7374 616c 6c20 4661 7374 4d42  . Install FastMB
+000063d0: 4152 2077 6974 6820 7069 7094 8594 8194  AR with pip.....
+000063e0: 7d94 6a55 0300 006a 2c07 0000 7362 616a  }.jU...j,...sbaj
+000063f0: 5603 0000 7d94 286a 5803 0000 5d94 6a5a  V...}.(jX...].jZ
+00006400: 0300 005d 946a 5c03 0000 5d94 6a5e 0300  ...].j\...].j^..
+00006410: 005d 946a 6003 0000 5d94 8c08 696e 7465  .].j`...]...inte
+00006420: 726e 616c 9488 8c06 7265 6675 7269 946a  rnal....refuri.j
+00006430: ee02 0000 8c0a 616e 6368 6f72 6e61 6d65  ......anchorname
+00006440: 948c 1a23 696e 7374 616c 6c2d 6661 7374  ...#install-fast
+00006450: 6d62 6172 2d77 6974 682d 7069 7094 756a  mbar-with-pip.uj
+00006460: 6203 0000 6ad2 0300 006a 5503 0000 6a29  b...j....jU...j)
+00006470: 0700 0075 6261 6a56 0300 007d 9428 6a58  ...ubajV...}.(jX
+00006480: 0300 005d 946a 5a03 0000 5d94 6a5c 0300  ...].jZ...].j\..
+00006490: 005d 946a 5e03 0000 5d94 6a60 0300 005d  .].j^...].j`...]
+000064a0: 9475 6a62 0300 006a cd03 0000 6a55 0300  .ujb...j....jU..
+000064b0: 006a 2607 0000 7562 616a 5603 0000 7d94  .j&...ubajV...}.
+000064c0: 286a 5803 0000 5d94 6a5a 0300 005d 946a  (jX...].jZ...].j
+000064d0: 5c03 0000 5d94 6a5e 0300 005d 946a 6003  \...].j^...].j`.
+000064e0: 0000 5d94 756a 6203 0000 6ac7 0300 006a  ..].ujb...j....j
+000064f0: 5503 0000 6a00 0700 0075 626a c803 0000  U...j....ubj....
+00006500: 2981 947d 9428 6a4c 0300 0068 6c6a 4d03  )..}.(jL...hljM.
+00006510: 0000 5d94 6ace 0300 0029 8194 7d94 286a  ..].j....)..}.(j
+00006520: 4c03 0000 686c 6a4d 0300 005d 946a d303  L...hljM...].j..
+00006530: 0000 2981 947d 9428 6a4c 0300 0068 6c6a  ..)..}.(jL...hlj
+00006540: 4d03 0000 5d94 6a50 0300 008c 2433 2e20  M...].jP....$3. 
+00006550: 5465 7374 2074 6865 2049 6e73 7461 6c6c  Test the Install
+00006560: 6174 696f 6e20 6f66 2046 6173 744d 4241  ation of FastMBA
+00006570: 5294 8594 8194 7d94 6a55 0300 006a 4f07  R.....}.jU...jO.
+00006580: 0000 7362 616a 5603 0000 7d94 286a 5803  ..sbajV...}.(jX.
+00006590: 0000 5d94 6a5a 0300 005d 946a 5c03 0000  ..].jZ...].j\...
+000065a0: 5d94 6a5e 0300 005d 946a 6003 0000 5d94  ].j^...].j`...].
+000065b0: 8c08 696e 7465 726e 616c 9488 8c06 7265  ..internal....re
+000065c0: 6675 7269 946a ee02 0000 8c0a 616e 6368  furi.j......anch
+000065d0: 6f72 6e61 6d65 948c 2223 7465 7374 2d74  orname.."#test-t
+000065e0: 6865 2d69 6e73 7461 6c6c 6174 696f 6e2d  he-installation-
+000065f0: 6f66 2d66 6173 746d 6261 7294 756a 6203  of-fastmbar.ujb.
+00006600: 0000 6ad2 0300 006a 5503 0000 6a4c 0700  ..j....jU...jL..
+00006610: 0075 6261 6a56 0300 007d 9428 6a58 0300  .ubajV...}.(jX..
+00006620: 005d 946a 5a03 0000 5d94 6a5c 0300 005d  .].jZ...].j\...]
+00006630: 946a 5e03 0000 5d94 6a60 0300 005d 9475  .j^...].j`...].u
+00006640: 6a62 0300 006a cd03 0000 6a55 0300 006a  jb...j....jU...j
+00006650: 4907 0000 7562 616a 5603 0000 7d94 286a  I...ubajV...}.(j
+00006660: 5803 0000 5d94 6a5a 0300 005d 946a 5c03  X...].jZ...].j\.
+00006670: 0000 5d94 6a5e 0300 005d 946a 6003 0000  ..].j^...].j`...
+00006680: 5d94 756a 6203 0000 6ac7 0300 006a 5503  ].ujb...j....jU.
+00006690: 0000 6a00 0700 0075 6265 6a56 0300 007d  ..j....ubejV...}
+000066a0: 9428 6a58 0300 005d 946a 5a03 0000 5d94  .(jX...].jZ...].
+000066b0: 6a5c 0300 005d 946a 5e03 0000 5d94 6a60  j\...].j^...].j`
+000066c0: 0300 005d 9475 6a62 0300 006a c203 0000  ...].ujb...j....
+000066d0: 6a55 0300 006a e406 0000 7562 656a 5603  jU...j....ubejV.
+000066e0: 0000 7d94 286a 5803 0000 5d94 6a5a 0300  ..}.(jX...].jZ..
+000066f0: 005d 946a 5c03 0000 5d94 6a5e 0300 005d  .].j\...].j^...]
+00006700: 946a 6003 0000 5d94 756a 6203 0000 6ac7  .j`...].ujb...j.
+00006710: 0300 006a 5503 0000 6ae1 0600 0075 6261  ...jU...j....uba
+00006720: 6a56 0300 007d 9428 6a58 0300 005d 946a  jV...}.(jX...].j
+00006730: 5a03 0000 5d94 6a5c 0300 005d 946a 5e03  Z...].j\...].j^.
+00006740: 0000 5d94 6a60 0300 005d 9475 6a62 0300  ..].j`...].ujb..
+00006750: 006a c203 0000 7562 6ae8 0200 006a c303  .j....ubj....j..
+00006760: 0000 2981 947d 9428 6a4c 0300 0068 6c6a  ..)..}.(jL...hlj
+00006770: 4d03 0000 5d94 6ac8 0300 0029 8194 7d94  M...].j....)..}.
+00006780: 286a 4c03 0000 686c 6a4d 0300 005d 946a  (jL...hljM...].j
+00006790: ce03 0000 2981 947d 9428 6a4c 0300 0068  ....)..}.(jL...h
+000067a0: 6c6a 4d03 0000 5d94 6ad3 0300 0029 8194  ljM...].j....)..
+000067b0: 7d94 286a 4c03 0000 686c 6a4d 0300 005d  }.(jL...hljM...]
+000067c0: 946a 5003 0000 8c0a 5265 6665 7265 6e63  .jP.....Referenc
+000067d0: 6573 9485 9481 947d 946a 5503 0000 6a87  es.....}.jU...j.
+000067e0: 0700 0073 6261 6a56 0300 007d 9428 6a58  ...sbajV...}.(jX
+000067f0: 0300 005d 946a 5a03 0000 5d94 6a5c 0300  ...].jZ...].j\..
+00006800: 005d 946a 5e03 0000 5d94 6a60 0300 005d  .].j^...].j`...]
+00006810: 948c 0869 6e74 6572 6e61 6c94 888c 0672  ...internal....r
+00006820: 6566 7572 6994 6ae8 0200 008c 0a61 6e63  efuri.j......anc
+00006830: 686f 726e 616d 6594 686c 756a 6203 0000  horname.hlujb...
+00006840: 6ad2 0300 006a 5503 0000 6a84 0700 0075  j....jU...j....u
+00006850: 6261 6a56 0300 007d 9428 6a58 0300 005d  bajV...}.(jX...]
+00006860: 946a 5a03 0000 5d94 6a5c 0300 005d 946a  .jZ...].j\...].j
+00006870: 5e03 0000 5d94 6a60 0300 005d 9475 6a62  ^...].j`...].ujb
+00006880: 0300 006a cd03 0000 6a55 0300 006a 8107  ...j....jU...j..
+00006890: 0000 7562 616a 5603 0000 7d94 286a 5803  ..ubajV...}.(jX.
+000068a0: 0000 5d94 6a5a 0300 005d 946a 5c03 0000  ..].jZ...].j\...
+000068b0: 5d94 6a5e 0300 005d 946a 6003 0000 5d94  ].j^...].j`...].
+000068c0: 756a 6203 0000 6ac7 0300 006a 5503 0000  ujb...j....jU...
+000068d0: 6a7e 0700 0075 6261 6a56 0300 007d 9428  j~...ubajV...}.(
+000068e0: 6a58 0300 005d 946a 5a03 0000 5d94 6a5c  jX...].jZ...].j\
+000068f0: 0300 005d 946a 5e03 0000 5d94 6a60 0300  ...].j^...].j`..
+00006900: 005d 9475 6a62 0300 006a c203 0000 7562  .].ujb...j....ub
+00006910: 6aec 0200 006a c303 0000 2981 947d 9428  j....j....)..}.(
+00006920: 6a4c 0300 0068 6c6a 4d03 0000 5d94 6ac8  jL...hljM...].j.
+00006930: 0300 0029 8194 7d94 286a 4c03 0000 686c  ...)..}.(jL...hl
+00006940: 6a4d 0300 005d 9428 6ace 0300 0029 8194  jM...].(j....)..
+00006950: 7d94 286a 4c03 0000 686c 6a4d 0300 005d  }.(jL...hljM...]
+00006960: 946a d303 0000 2981 947d 9428 6a4c 0300  .j....)..}.(jL..
+00006970: 0068 6c6a 4d03 0000 5d94 6a50 0300 008c  .hljM...].jP....
+00006980: 0555 7361 6765 9485 9481 947d 946a 5503  .Usage.....}.jU.
+00006990: 0000 6ab2 0700 0073 6261 6a56 0300 007d  ..j....sbajV...}
+000069a0: 9428 6a58 0300 005d 946a 5a03 0000 5d94  .(jX...].jZ...].
+000069b0: 6a5c 0300 005d 946a 5e03 0000 5d94 6a60  j\...].j^...].j`
+000069c0: 0300 005d 948c 0869 6e74 6572 6e61 6c94  ...]...internal.
+000069d0: 888c 0672 6566 7572 6994 6aec 0200 008c  ...refuri.j.....
+000069e0: 0a61 6e63 686f 726e 616d 6594 686c 756a  .anchorname.hluj
+000069f0: 6203 0000 6ad2 0300 006a 5503 0000 6aaf  b...j....jU...j.
+00006a00: 0700 0075 6261 6a56 0300 007d 9428 6a58  ...ubajV...}.(jX
+00006a10: 0300 005d 946a 5a03 0000 5d94 6a5c 0300  ...].jZ...].j\..
+00006a20: 005d 946a 5e03 0000 5d94 6a60 0300 005d  .].j^...].j`...]
+00006a30: 9475 6a62 0300 006a cd03 0000 6a55 0300  .ujb...j....jU..
+00006a40: 006a ac07 0000 7562 6ac3 0300 0029 8194  .j....ubj....)..
+00006a50: 7d94 286a 4c03 0000 686c 6a4d 0300 005d  }.(jL...hljM...]
+00006a60: 9428 6ac8 0300 0029 8194 7d94 286a 4c03  .(j....)..}.(jL.
+00006a70: 0000 686c 6a4d 0300 005d 946a ce03 0000  ..hljM...].j....
+00006a80: 2981 947d 9428 6a4c 0300 0068 6c6a 4d03  )..}.(jL...hljM.
+00006a90: 0000 5d94 6ad3 0300 0029 8194 7d94 286a  ..].j....)..}.(j
+00006aa0: 4c03 0000 686c 6a4d 0300 005d 946a 5003  L...hljM...].jP.
+00006ab0: 0000 8c1e 312e 2057 6865 6e20 746f 2075  ....1. When to u
+00006ac0: 7365 204d 4241 5220 6571 7561 7469 6f6e  se MBAR equation
+00006ad0: 733f 9485 9481 947d 946a 5503 0000 6ad1  s?.....}.jU...j.
+00006ae0: 0700 0073 6261 6a56 0300 007d 9428 6a58  ...sbajV...}.(jX
+00006af0: 0300 005d 946a 5a03 0000 5d94 6a5c 0300  ...].jZ...].j\..
+00006b00: 005d 946a 5e03 0000 5d94 6a60 0300 005d  .].j^...].j`...]
+00006b10: 948c 0869 6e74 6572 6e61 6c94 888c 0672  ...internal....r
+00006b20: 6566 7572 6994 6aec 0200 008c 0a61 6e63  efuri.j......anc
+00006b30: 686f 726e 616d 6594 8c1b 2377 6865 6e2d  horname...#when-
+00006b40: 746f 2d75 7365 2d6d 6261 722d 6571 7561  to-use-mbar-equa
+00006b50: 7469 6f6e 7394 756a 6203 0000 6ad2 0300  tions.ujb...j...
+00006b60: 006a 5503 0000 6ace 0700 0075 6261 6a56  .jU...j....ubajV
+00006b70: 0300 007d 9428 6a58 0300 005d 946a 5a03  ...}.(jX...].jZ.
+00006b80: 0000 5d94 6a5c 0300 005d 946a 5e03 0000  ..].j\...].j^...
+00006b90: 5d94 6a60 0300 005d 9475 6a62 0300 006a  ].j`...].ujb...j
+00006ba0: cd03 0000 6a55 0300 006a cb07 0000 7562  ....jU...j....ub
+00006bb0: 616a 5603 0000 7d94 286a 5803 0000 5d94  ajV...}.(jX...].
+00006bc0: 6a5a 0300 005d 946a 5c03 0000 5d94 6a5e  jZ...].j\...].j^
+00006bd0: 0300 005d 946a 6003 0000 5d94 756a 6203  ...].j`...].ujb.
+00006be0: 0000 6ac7 0300 006a 5503 0000 6ac8 0700  ..j....jU...j...
+00006bf0: 0075 626a c803 0000 2981 947d 9428 6a4c  .ubj....)..}.(jL
+00006c00: 0300 0068 6c6a 4d03 0000 5d94 6ace 0300  ...hljM...].j...
+00006c10: 0029 8194 7d94 286a 4c03 0000 686c 6a4d  .)..}.(jL...hljM
+00006c20: 0300 005d 946a d303 0000 2981 947d 9428  ...].j....)..}.(
+00006c30: 6a4c 0300 0068 6c6a 4d03 0000 5d94 6a50  jL...hljM...].jP
+00006c40: 0300 008c 1732 2e20 486f 7720 746f 2075  .....2. How to u
+00006c50: 7365 2046 6173 744d 4241 523f 9485 9481  se FastMBAR?....
+00006c60: 947d 946a 5503 0000 6af4 0700 0073 6261  .}.jU...j....sba
+00006c70: 6a56 0300 007d 9428 6a58 0300 005d 946a  jV...}.(jX...].j
+00006c80: 5a03 0000 5d94 6a5c 0300 005d 946a 5e03  Z...].j\...].j^.
+00006c90: 0000 5d94 6a60 0300 005d 948c 0869 6e74  ..].j`...]...int
+00006ca0: 6572 6e61 6c94 888c 0672 6566 7572 6994  ernal....refuri.
+00006cb0: 6aec 0200 008c 0a61 6e63 686f 726e 616d  j......anchornam
+00006cc0: 6594 8c14 2368 6f77 2d74 6f2d 7573 652d  e...#how-to-use-
+00006cd0: 6661 7374 6d62 6172 9475 6a62 0300 006a  fastmbar.ujb...j
+00006ce0: d203 0000 6a55 0300 006a f107 0000 7562  ....jU...j....ub
+00006cf0: 616a 5603 0000 7d94 286a 5803 0000 5d94  ajV...}.(jX...].
+00006d00: 6a5a 0300 005d 946a 5c03 0000 5d94 6a5e  jZ...].j\...].j^
+00006d10: 0300 005d 946a 6003 0000 5d94 756a 6203  ...].j`...].ujb.
+00006d20: 0000 6acd 0300 006a 5503 0000 6aee 0700  ..j....jU...j...
+00006d30: 0075 6261 6a56 0300 007d 9428 6a58 0300  .ubajV...}.(jX..
+00006d40: 005d 946a 5a03 0000 5d94 6a5c 0300 005d  .].jZ...].j\...]
+00006d50: 946a 5e03 0000 5d94 6a60 0300 005d 9475  .j^...].j`...].u
+00006d60: 6a62 0300 006a c703 0000 6a55 0300 006a  jb...j....jU...j
+00006d70: c807 0000 7562 656a 5603 0000 7d94 286a  ....ubejV...}.(j
+00006d80: 5803 0000 5d94 6a5a 0300 005d 946a 5c03  X...].jZ...].j\.
+00006d90: 0000 5d94 6a5e 0300 005d 946a 6003 0000  ..].j^...].j`...
+00006da0: 5d94 756a 6203 0000 6ac2 0300 006a 5503  ].ujb...j....jU.
+00006db0: 0000 6aac 0700 0075 6265 6a56 0300 007d  ..j....ubejV...}
+00006dc0: 9428 6a58 0300 005d 946a 5a03 0000 5d94  .(jX...].jZ...].
+00006dd0: 6a5c 0300 005d 946a 5e03 0000 5d94 6a60  j\...].j^...].j`
+00006de0: 0300 005d 9475 6a62 0300 006a c703 0000  ...].ujb...j....
+00006df0: 6a55 0300 006a a907 0000 7562 616a 5603  jU...j....ubajV.
+00006e00: 0000 7d94 286a 5803 0000 5d94 6a5a 0300  ..}.(jX...].jZ..
+00006e10: 005d 946a 5c03 0000 5d94 6a5e 0300 005d  .].j\...].j^...]
+00006e20: 946a 6003 0000 5d94 756a 6203 0000 6ac2  .j`...].ujb...j.
+00006e30: 0300 0075 6275 8c0f 746f 635f 6e75 6d5f  ...ubu..toc_num_
+00006e40: 656e 7472 6965 7394 7d94 286a ea02 0000  entries.}.(j....
+00006e50: 4b01 6aeb 0200 004b 056a e902 0000 4b05  K.j....K.j....K.
+00006e60: 6aed 0200 004b 036a e702 0000 4b04 6aee  j....K.j....K.j.
+00006e70: 0200 004b 046a e802 0000 4b01 6aec 0200  ...K.j....K.j...
+00006e80: 004b 0375 8c0e 746f 635f 7365 636e 756d  .K.u..toc_secnum
+00006e90: 6265 7273 947d 948c 0e74 6f63 5f66 6967  bers.}...toc_fig
+00006ea0: 6e75 6d62 6572 7394 7d94 8c10 746f 6374  numbers.}...toct
+00006eb0: 7265 655f 696e 636c 7564 6573 947d 9428  ree_includes.}.(
+00006ec0: 6aed 0200 005d 9428 6ae9 0500 006a eb05  j....].(j....j..
+00006ed0: 0000 656a e702 0000 5d94 286a ad06 0000  ..ej....].(j....
+00006ee0: 6aaf 0600 006a b106 0000 6ab3 0600 006a  j....j....j....j
+00006ef0: b506 0000 6575 8c10 6669 6c65 735f 746f  ....eu..files_to
+00006f00: 5f72 6562 7569 6c64 947d 9428 6ae9 0500  _rebuild.}.(j...
+00006f10: 008f 9428 6aed 0200 0090 6aeb 0500 008f  ...(j.....j.....
+00006f20: 9428 6aed 0200 0090 6aad 0600 008f 9428  .(j.....j......(
+00006f30: 6ae7 0200 0090 6aaf 0600 008f 9428 6ae7  j.....j......(j.
+00006f40: 0200 0090 6ab1 0600 008f 9428 6ae7 0200  ....j......(j...
+00006f50: 0090 6ab3 0600 008f 9428 6ae7 0200 0090  ..j......(j.....
+00006f60: 6ab5 0600 008f 9428 6ae7 0200 0090 758c  j......(j.....u.
+00006f70: 0d67 6c6f 625f 746f 6374 7265 6573 948f  .glob_toctrees..
+00006f80: 948c 116e 756d 6265 7265 645f 746f 6374  ...numbered_toct
+00006f90: 7265 6573 948f 948c 0a64 6f6d 6169 6e64  rees.....domaind
+00006fa0: 6174 6194 7d94 288c 0163 947d 9428 8c0b  ata.}.(..c.}.(..
+00006fb0: 726f 6f74 5f73 796d 626f 6c94 6af1 0200  root_symbol.j...
+00006fc0: 008c 0653 796d 626f 6c94 9394 2981 947d  ...Symbol...)..}
+00006fd0: 9428 6a55 0300 004e 8c0c 7369 626c 696e  .(jU...N..siblin
+00006fe0: 6741 626f 7665 944e 8c0c 7369 626c 696e  gAbove.N..siblin
+00006ff0: 6742 656c 6f77 944e 8c05 6964 656e 7494  gBelow.N..ident.
+00007000: 4e8c 0b64 6563 6c61 7261 7469 6f6e 944e  N..declaration.N
+00007010: 8c07 646f 636e 616d 6594 4e6a fa05 0000  ..docname.Nj....
+00007020: 4e8c 0f69 7352 6564 6563 6c61 7261 7469  N..isRedeclarati
+00007030: 6f6e 9489 8c09 5f63 6869 6c64 7265 6e94  on...._children.
+00007040: 5d94 8c0d 5f61 6e6f 6e43 6869 6c64 7265  ]..._anonChildre
+00007050: 6e94 5d94 7562 8c07 6f62 6a65 6374 7394  n.].ub..objects.
+00007060: 7d94 6aef 0200 004b 0075 8c09 6368 616e  }.j....K.u..chan
+00007070: 6765 7365 7494 7d94 288c 0763 6861 6e67  geset.}.(..chang
+00007080: 6573 947d 946a ef02 0000 4b00 758c 0863  es.}.j....K.u..c
+00007090: 6974 6174 696f 6e94 7d94 286a ef02 0000  itation.}.(j....
+000070a0: 4b00 8c09 6369 7461 7469 6f6e 7394 7d94  K...citations.}.
+000070b0: 8c0d 6369 7461 7469 6f6e 5f72 6566 7394  ..citation_refs.
+000070c0: 7d94 758c 0363 7070 947d 9428 6a3e 0800  }.u..cpp.}.(j>..
+000070d0: 006a f402 0000 6a3f 0800 0093 9429 8194  .j....j?.....)..
+000070e0: 7d94 286a 5503 0000 4e6a 4308 0000 4e6a  }.(jU...NjC...Nj
+000070f0: 4408 0000 4e8c 0969 6465 6e74 4f72 4f70  D...N..identOrOp
+00007100: 944e 8c0e 7465 6d70 6c61 7465 5061 7261  .N..templatePara
+00007110: 6d73 944e 8c0c 7465 6d70 6c61 7465 4172  ms.N..templateAr
+00007120: 6773 944e 6a46 0800 004e 6a47 0800 004e  gs.NjF...NjG...N
+00007130: 6afa 0500 004e 6a48 0800 0089 6a49 0800  j....NjH....jI..
+00007140: 005d 946a 4b08 0000 5d94 7562 8c05 6e61  .].jK...].ub..na
+00007150: 6d65 7394 7d94 6aef 0200 004b 0075 8c05  mes.}.j....K.u..
+00007160: 696e 6465 7894 7d94 286a ef02 0000 4b00  index.}.(j....K.
+00007170: 8c07 656e 7472 6965 7394 7d94 286a ea02  ..entries.}.(j..
+00007180: 0000 5d94 2828 8c06 7369 6e67 6c65 948c  ..].((..single..
+00007190: 1c46 6173 744d 4241 5220 2863 6c61 7373  .FastMBAR (class
+000071a0: 2069 6e20 4661 7374 4d42 4152 2994 8c11   in FastMBAR)...
+000071b0: 4661 7374 4d42 4152 2e46 6173 744d 4241  FastMBAR.FastMBA
+000071c0: 5294 686c 4e74 9428 6a6a 0800 008c 255f  R.hlNt.(jj....%_
+000071d0: 5f69 6e69 745f 5f28 2920 2846 6173 744d  _init__() (FastM
+000071e0: 4241 522e 4661 7374 4d42 4152 206d 6574  BAR.FastMBAR met
+000071f0: 686f 6429 948c 1a46 6173 744d 4241 522e  hod)...FastMBAR.
+00007200: 4661 7374 4d42 4152 2e5f 5f69 6e69 745f  FastMBAR.__init_
+00007210: 5f94 686c 4e74 9428 6a6a 0800 008c 1e46  _.hlNt.(jj.....F
+00007220: 2028 4661 7374 4d42 4152 2e46 6173 744d   (FastMBAR.FastM
+00007230: 4241 5220 7072 6f70 6572 7479 2994 8c13  BAR property)...
+00007240: 4661 7374 4d42 4152 2e46 6173 744d 4241  FastMBAR.FastMBA
+00007250: 522e 4694 686c 4e74 9428 6a6a 0800 008c  R.F.hlNt.(jj....
+00007260: 2246 5f73 7464 2028 4661 7374 4d42 4152  "F_std (FastMBAR
+00007270: 2e46 6173 744d 4241 5220 7072 6f70 6572  .FastMBAR proper
+00007280: 7479 2994 8c17 4661 7374 4d42 4152 2e46  ty)...FastMBAR.F
+00007290: 6173 744d 4241 522e 465f 7374 6494 686c  astMBAR.F_std.hl
+000072a0: 4e74 9428 6a6a 0800 008c 2246 5f63 6f76  Nt.(jj...."F_cov
+000072b0: 2028 4661 7374 4d42 4152 2e46 6173 744d   (FastMBAR.FastM
+000072c0: 4241 5220 7072 6f70 6572 7479 2994 8c17  BAR property)...
+000072d0: 4661 7374 4d42 4152 2e46 6173 744d 4241  FastMBAR.FastMBA
+000072e0: 522e 465f 636f 7694 686c 4e74 9428 6a6a  R.F_cov.hlNt.(jj
+000072f0: 0800 008c 2344 656c 7461 4620 2846 6173  ....#DeltaF (Fas
+00007300: 744d 4241 522e 4661 7374 4d42 4152 2070  tMBAR.FastMBAR p
+00007310: 726f 7065 7274 7929 948c 1846 6173 744d  roperty)...FastM
+00007320: 4241 522e 4661 7374 4d42 4152 2e44 656c  BAR.FastMBAR.Del
+00007330: 7461 4694 686c 4e74 9428 6a6a 0800 008c  taF.hlNt.(jj....
+00007340: 2744 656c 7461 465f 7374 6420 2846 6173  'DeltaF_std (Fas
+00007350: 744d 4241 522e 4661 7374 4d42 4152 2070  tMBAR.FastMBAR p
+00007360: 726f 7065 7274 7929 948c 1c46 6173 744d  roperty)...FastM
+00007370: 4241 522e 4661 7374 4d42 4152 2e44 656c  BAR.FastMBAR.Del
+00007380: 7461 465f 7374 6494 686c 4e74 9428 6a6a  taF_std.hlNt.(jj
+00007390: 0800 008c 296c 6f67 5f70 726f 625f 6d69  ....)log_prob_mi
+000073a0: 7820 2846 6173 744d 4241 522e 4661 7374  x (FastMBAR.Fast
+000073b0: 4d42 4152 2070 726f 7065 7274 7929 948c  MBAR property)..
+000073c0: 1e46 6173 744d 4241 522e 4661 7374 4d42  .FastMBAR.FastMB
+000073d0: 4152 2e6c 6f67 5f70 726f 625f 6d69 7894  AR.log_prob_mix.
+000073e0: 686c 4e74 9428 6a6a 0800 008c 4863 616c  hlNt.(jj....Hcal
+000073f0: 6375 6c61 7465 5f66 7265 655f 656e 6572  culate_free_ener
+00007400: 6769 6573 5f6f 665f 7065 7274 7572 6265  gies_of_perturbe
+00007410: 645f 7374 6174 6573 2829 2028 4661 7374  d_states() (Fast
+00007420: 4d42 4152 2e46 6173 744d 4241 5220 6d65  MBAR.FastMBAR me
+00007430: 7468 6f64 2994 8c3d 4661 7374 4d42 4152  thod)..=FastMBAR
+00007440: 2e46 6173 744d 4241 522e 6361 6c63 756c  .FastMBAR.calcul
+00007450: 6174 655f 6672 6565 5f65 6e65 7267 6965  ate_free_energie
+00007460: 735f 6f66 5f70 6572 7475 7262 6564 5f73  s_of_perturbed_s
+00007470: 7461 7465 7394 686c 4e74 9465 6aeb 0200  tates.hlNt.ej...
+00007480: 005d 946a e902 0000 5d94 6aed 0200 005d  .].j....].j....]
+00007490: 946a e702 0000 5d94 6aee 0200 005d 946a  .j....].j....].j
+000074a0: e802 0000 5d94 6aec 0200 005d 9475 758c  ....].j....].uu.
+000074b0: 026a 7394 7d94 286a 4d08 0000 7d94 8c07  .js.}.(jM...}...
+000074c0: 6d6f 6475 6c65 7394 7d94 6aef 0200 004b  modules.}.j....K
+000074d0: 0075 8c04 6d61 7468 947d 9428 6a4d 0800  .u..math.}.(jM..
+000074e0: 007d 948c 0d68 6173 5f65 7175 6174 696f  .}...has_equatio
+000074f0: 6e73 947d 9428 6aea 0200 0088 6aeb 0200  ns.}.(j.....j...
+00007500: 0088 6ae9 0200 0088 6aed 0200 0089 6ae7  ..j.....j.....j.
+00007510: 0200 0089 6aee 0200 0089 6ae8 0200 0089  ....j.....j.....
+00007520: 6aec 0200 0088 756a ef02 0000 4b00 758c  j.....uj....K.u.
+00007530: 0270 7994 7d94 286a 4d08 0000 7d94 288c  .py.}.(jM...}.(.
+00007540: 1146 6173 744d 4241 522e 4661 7374 4d42  .FastMBAR.FastMB
+00007550: 4152 948c 1573 7068 696e 782e 646f 6d61  AR...sphinx.doma
+00007560: 696e 732e 7079 7468 6f6e 948c 0b4f 626a  ins.python...Obj
+00007570: 6563 7445 6e74 7279 9493 9428 6aea 0200  ectEntry...(j...
+00007580: 006a 6c08 0000 8c05 636c 6173 7394 8974  .jl.....class..t
+00007590: 9481 948c 1a46 6173 744d 4241 522e 6661  .....FastMBAR.fa
+000075a0: 7374 6d62 6172 2e46 6173 744d 4241 5294  stmbar.FastMBAR.
+000075b0: 6a9d 0800 0028 6aea 0200 006a 6c08 0000  j....(j....jl...
+000075c0: 6a9e 0800 0088 7494 8194 8c1a 4661 7374  j.....t.....Fast
+000075d0: 4d42 4152 2e46 6173 744d 4241 522e 5f5f  MBAR.FastMBAR.__
+000075e0: 696e 6974 5f5f 946a 9d08 0000 286a ea02  init__.j....(j..
+000075f0: 0000 6a6f 0800 008c 066d 6574 686f 6494  ..jo.....method.
+00007600: 8974 9481 948c 1346 6173 744d 4241 522e  .t.....FastMBAR.
+00007610: 4661 7374 4d42 4152 2e46 946a 9d08 0000  FastMBAR.F.j....
+00007620: 286a ea02 0000 6a72 0800 008c 0870 726f  (j....jr.....pro
+00007630: 7065 7274 7994 8974 9481 948c 1746 6173  perty..t.....Fas
+00007640: 744d 4241 522e 4661 7374 4d42 4152 2e46  tMBAR.FastMBAR.F
+00007650: 5f73 7464 946a 9d08 0000 286a ea02 0000  _std.j....(j....
+00007660: 6a75 0800 008c 0870 726f 7065 7274 7994  ju.....property.
+00007670: 8974 9481 948c 1746 6173 744d 4241 522e  .t.....FastMBAR.
+00007680: 4661 7374 4d42 4152 2e46 5f63 6f76 946a  FastMBAR.F_cov.j
+00007690: 9d08 0000 286a ea02 0000 6a78 0800 008c  ....(j....jx....
+000076a0: 0870 726f 7065 7274 7994 8974 9481 948c  .property..t....
+000076b0: 1846 6173 744d 4241 522e 4661 7374 4d42  .FastMBAR.FastMB
+000076c0: 4152 2e44 656c 7461 4694 6a9d 0800 0028  AR.DeltaF.j....(
+000076d0: 6aea 0200 006a 7b08 0000 8c08 7072 6f70  j....j{.....prop
+000076e0: 6572 7479 9489 7494 8194 8c1c 4661 7374  erty..t.....Fast
+000076f0: 4d42 4152 2e46 6173 744d 4241 522e 4465  MBAR.FastMBAR.De
+00007700: 6c74 6146 5f73 7464 946a 9d08 0000 286a  ltaF_std.j....(j
+00007710: ea02 0000 6a7e 0800 008c 0870 726f 7065  ....j~.....prope
+00007720: 7274 7994 8974 9481 948c 1e46 6173 744d  rty..t.....FastM
+00007730: 4241 522e 4661 7374 4d42 4152 2e6c 6f67  BAR.FastMBAR.log
+00007740: 5f70 726f 625f 6d69 7894 6a9d 0800 0028  _prob_mix.j....(
+00007750: 6aea 0200 006a 8108 0000 8c08 7072 6f70  j....j......prop
+00007760: 6572 7479 9489 7494 8194 8c3d 4661 7374  erty..t....=Fast
+00007770: 4d42 4152 2e46 6173 744d 4241 522e 6361  MBAR.FastMBAR.ca
+00007780: 6c63 756c 6174 655f 6672 6565 5f65 6e65  lculate_free_ene
+00007790: 7267 6965 735f 6f66 5f70 6572 7475 7262  rgies_of_perturb
+000077a0: 6564 5f73 7461 7465 7394 6a9d 0800 0028  ed_states.j....(
+000077b0: 6aea 0200 006a 8408 0000 8c06 6d65 7468  j....j......meth
+000077c0: 6f64 9489 7494 8194 756a 9008 0000 7d94  od..t...uj....}.
+000077d0: 6aef 0200 004b 0075 8c03 7273 7494 7d94  j....K.u..rst.}.
+000077e0: 286a 4d08 0000 7d94 6aef 0200 004b 0075  (jM...}.j....K.u
+000077f0: 8c03 7374 6494 7d94 288c 0b70 726f 676f  ..std.}.(..progo
+00007800: 7074 696f 6e73 947d 946a 4d08 0000 7d94  ptions.}.jM...}.
+00007810: 8c06 6c61 6265 6c73 947d 9428 8c08 6765  ..labels.}.(..ge
+00007820: 6e69 6e64 6578 946a cf08 0000 686c 8c0d  nindex.j....hl..
+00007830: 7370 6869 6e78 2e6c 6f63 616c 6594 8c11  sphinx.locale...
+00007840: 5f54 7261 6e73 6c61 7469 6f6e 5072 6f78  _TranslationProx
+00007850: 7994 9394 286a d008 0000 8c0f 5f6c 617a  y...(j......_laz
+00007860: 795f 7472 616e 736c 6174 6594 9394 8c06  y_translate.....
+00007870: 7370 6869 6e78 948c 0767 656e 6572 616c  sphinx...general
+00007880: 948c 0549 6e64 6578 9474 9481 946a d408  ...Index.t...j..
+00007890: 0000 6ad5 0800 006a d608 0000 6ad7 0800  ..j....j....j...
+000078a0: 0087 9486 9462 8794 8c08 6d6f 6469 6e64  .....b....modind
+000078b0: 6578 948c 0b70 792d 6d6f 6469 6e64 6578  ex...py-modindex
+000078c0: 9468 6c6a d208 0000 286a d408 0000 6ad5  .hlj....(j....j.
+000078d0: 0800 006a d608 0000 8c0c 4d6f 6475 6c65  ...j......Module
+000078e0: 2049 6e64 6578 9474 9481 946a d408 0000   Index.t...j....
+000078f0: 6ad5 0800 006a d608 0000 6adf 0800 0087  j....j....j.....
+00007900: 9486 9462 8794 8c06 7365 6172 6368 946a  ...b....search.j
+00007910: e508 0000 686c 6ad2 0800 0028 6ad4 0800  ....hlj....(j...
+00007920: 006a d508 0000 6ad6 0800 008c 0b53 6561  .j....j......Sea
+00007930: 7263 6820 5061 6765 9474 9481 946a d408  rch Page.t...j..
+00007940: 0000 6ad5 0800 006a d608 0000 6ae6 0800  ..j....j....j...
+00007950: 0087 9486 9462 8794 8c0b 7079 2d6d 6f64  .....b....py-mod
+00007960: 696e 6465 7894 8c0b 7079 2d6d 6f64 696e  index...py-modin
+00007970: 6465 7894 686c 8c13 5079 7468 6f6e 204d  dex.hl..Python M
+00007980: 6f64 756c 6520 496e 6465 7894 8794 8c08  odule Index.....
+00007990: 6578 616d 706c 6573 946a ed02 0000 8c08  examples.j......
+000079a0: 6578 616d 706c 6573 948c 0845 7861 6d70  examples...Examp
+000079b0: 6c65 7394 8794 758c 0a61 6e6f 6e6c 6162  les...u..anonlab
+000079c0: 656c 7394 7d94 286a cf08 0000 6acf 0800  els.}.(j....j...
+000079d0: 0068 6c86 946a dd08 0000 6ade 0800 0068  .hl..j....j....h
+000079e0: 6c86 946a e508 0000 6ae5 0800 0068 6c86  l..j....j....hl.
+000079f0: 946a ec08 0000 6aed 0800 0068 6c86 946a  .j....j....hl..j
+00007a00: f008 0000 6aed 0200 006a f108 0000 8694  ....j....j......
+00007a10: 756a ef02 0000 4b00 8c05 7465 726d 7394  uj....K...terms.
+00007a20: 7d94 7575 8c06 696d 6167 6573 948c 0b73  }.uu..images...s
+00007a30: 7068 696e 782e 7574 696c 948c 1046 696c  phinx.util...Fil
+00007a40: 656e 616d 6555 6e69 7144 6963 7494 9394  enameUniqDict...
+00007a50: 2981 9428 6a27 0300 008f 9428 6aeb 0200  )..(j'.....(j...
+00007a60: 0090 8c09 4669 675f 312e 706e 6794 8694  ....Fig_1.png...
+00007a70: 6a2a 0300 008f 9428 6aeb 0200 0090 8c09  j*.....(j.......
+00007a80: 4669 675f 322e 706e 6794 8694 6a28 0300  Fig_2.png...j(..
+00007a90: 008f 9428 6aeb 0200 0090 8c07 504d 462e  ...(j.......PMF.
+00007aa0: 706e 6794 8694 6a2d 0300 008f 9428 6ae9  png...j-.....(j.
+00007ab0: 0200 0090 8c0a 4669 675f 3131 2e70 6e67  ......Fig_11.png
+00007ac0: 9486 946a 2c03 0000 8f94 286a e902 0000  ...j,.....(j....
+00007ad0: 908c 0a46 6967 5f32 312e 706e 6794 8694  ...Fig_21.png...
+00007ae0: 6a2f 0300 008f 9428 6ae9 0200 0090 8c08  j/.....(j.......
+00007af0: 504d 4631 2e70 6e67 9486 946a 3903 0000  PMF1.png...j9...
+00007b00: 8f94 286a ec02 0000 908c 1165 6e65 7267  ..(j.......energ
+00007b10: 795f 6d61 7472 6978 2e70 6e67 9486 9475  y_matrix.png...u
+00007b20: 8f94 286a 1509 0000 6a03 0900 006a 0c09  ..(j....j....j..
+00007b30: 0000 6a12 0900 006a 0909 0000 6a06 0900  ..j....j....j...
+00007b40: 006a 0f09 0000 9062 8c07 646c 6669 6c65  .j.....b..dlfile
+00007b50: 7394 6afe 0800 008c 0d44 6f77 6e6c 6f61  s.j......Downloa
+00007b60: 6446 696c 6573 9493 9429 8194 8c12 6f72  dFiles...)....or
+00007b70: 6967 696e 616c 5f69 6d61 6765 5f75 7269  iginal_image_uri
+00007b80: 947d 948c 0974 656d 705f 6461 7461 947d  .}...temp_data.}
+00007b90: 948c 0b72 6566 5f63 6f6e 7465 7874 947d  ...ref_context.}
+00007ba0: 948c 115f 7669 6577 636f 6465 5f6d 6f64  ..._viewcode_mod
+00007bb0: 756c 6573 947d 948c 1146 6173 744d 4241  ules.}...FastMBA
+00007bc0: 522e 6661 7374 6d62 6172 9428 58d2 7100  R.fastmbar.(X.q.
+00007bd0: 0066 726f 6d20 7479 7069 6e67 2069 6d70  .from typing imp
+00007be0: 6f72 7420 556e 696f 6e0a 696d 706f 7274  ort Union.import
+00007bf0: 2074 6f72 6368 0a69 6d70 6f72 7420 6e75   torch.import nu
+00007c00: 6d70 7920 6173 206e 700a 696d 706f 7274  mpy as np.import
+00007c10: 2073 6369 7079 2e6f 7074 696d 697a 6520   scipy.optimize 
+00007c20: 6173 206f 7074 696d 697a 650a 696d 706f  as optimize.impo
+00007c30: 7274 206d 6174 680a 0a0a 636c 6173 7320  rt math...class 
+00007c40: 4661 7374 4d42 4152 3a0a 2020 2020 2222  FastMBAR:.    ""
+00007c50: 220a 2020 2020 5468 6520 4661 7374 4d42  ".    The FastMB
+00007c60: 4152 2063 6c61 7373 2069 7320 696e 6974  AR class is init
+00007c70: 6961 6c69 7a65 6420 7769 7468 2061 6e20  ialized with an 
+00007c80: 656e 6572 6779 206d 6174 7269 7820 616e  energy matrix an
+00007c90: 6420 616e 2061 7272 6179 0a20 2020 206f  d an array.    o
+00007ca0: 6620 6e75 6d20 6f66 2063 6f6e 666f 726d  f num of conform
+00007cb0: 6174 696f 6e73 2e20 5468 6520 636f 7272  ations. The corr
+00007cc0: 6573 706f 6e64 696e 6720 4d42 4152 2065  esponding MBAR e
+00007cd0: 7175 6174 696f 6e20 6973 2073 6f6c 7665  quation is solve
+00007ce0: 640a 2020 2020 696e 2074 6865 2063 6f6e  d.    in the con
+00007cf0: 7374 7275 6374 6f72 2e20 5468 6572 6566  structor. Theref
+00007d00: 6f72 652c 2074 6865 2072 656c 6174 6976  ore, the relativ
+00007d10: 6520 6672 6565 2065 6e65 7267 6965 7320  e free energies 
+00007d20: 6f66 2073 7461 7465 730a 2020 2020 7573  of states.    us
+00007d30: 6564 2069 6e20 7468 6520 656e 6572 6779  ed in the energy
+00007d40: 206d 6174 7269 7820 6973 2063 616c 6375   matrix is calcu
+00007d50: 6c61 7465 6420 696e 2074 6865 2063 6f6e  lated in the con
+00007d60: 7374 7275 6374 6f72 2e20 5468 650a 2020  structor. The.  
+00007d70: 2020 6d65 7468 6f64 202a 2a63 616c 6375    method **calcu
+00007d80: 6c61 7465 5f66 7265 655f 656e 6572 6769  late_free_energi
+00007d90: 6573 5f66 6f72 5f70 6572 7475 7262 6564  es_for_perturbed
+00007da0: 5f73 7461 7465 732a 2a0a 2020 2020 6361  _states**.    ca
+00007db0: 6e20 6265 2075 7365 6420 746f 2063 616c  n be used to cal
+00007dc0: 6375 6c61 7465 6420 7468 6520 7265 6c61  culated the rela
+00007dd0: 7469 7665 2066 7265 6520 656e 6572 6769  tive free energi
+00007de0: 6573 206f 6620 7065 7274 7572 6265 6420  es of perturbed 
+00007df0: 7374 6174 6573 2e0a 2020 2020 2222 220a  states..    """.
+00007e00: 0a20 2020 2064 6566 205f 5f69 6e69 745f  .    def __init_
+00007e10: 5f28 0a20 2020 2020 2020 2073 656c 662c  _(.        self,
+00007e20: 0a20 2020 2020 2020 2065 6e65 7267 793a  .        energy:
+00007e30: 2055 6e69 6f6e 5b6e 702e 6e64 6172 7261   Union[np.ndarra
+00007e40: 792c 2074 6f72 6368 2e54 656e 736f 725d  y, torch.Tensor]
+00007e50: 2c0a 2020 2020 2020 2020 6e75 6d5f 636f  ,.        num_co
+00007e60: 6e66 3a20 556e 696f 6e5b 6e70 2e6e 6461  nf: Union[np.nda
+00007e70: 7272 6179 2c20 746f 7263 682e 5465 6e73  rray, torch.Tens
+00007e80: 6f72 5d2c 0a20 2020 2020 2020 2063 7564  or],.        cud
+00007e90: 613a 2062 6f6f 6c20 3d20 4661 6c73 652c  a: bool = False,
+00007ea0: 0a20 2020 2020 2020 2063 7564 615f 6261  .        cuda_ba
+00007eb0: 7463 685f 6d6f 6465 3a20 556e 696f 6e5b  tch_mode: Union[
+00007ec0: 626f 6f6c 2c20 4e6f 6e65 5d20 3d20 4e6f  bool, None] = No
+00007ed0: 6e65 2c0a 2020 2020 2020 2020 626f 6f74  ne,.        boot
+00007ee0: 7374 7261 703a 2062 6f6f 6c20 3d20 4661  strap: bool = Fa
+00007ef0: 6c73 652c 0a20 2020 2020 2020 2062 6f6f  lse,.        boo
+00007f00: 7473 7472 6170 5f62 6c6f 636b 5f73 697a  tstrap_block_siz
+00007f10: 653a 2069 6e74 203d 2033 2c0a 2020 2020  e: int = 3,.    
+00007f20: 2020 2020 626f 6f74 7374 7261 705f 6e75      bootstrap_nu
+00007f30: 6d5f 7265 703a 2069 6e74 203d 2031 3030  m_rep: int = 100
+00007f40: 2c0a 2020 2020 2020 2020 7665 7262 6f73  ,.        verbos
+00007f50: 653a 2062 6f6f 6c20 3d20 4661 6c73 652c  e: bool = False,
+00007f60: 0a20 2020 2020 2020 206d 6574 686f 643a  .        method:
+00007f70: 2073 7472 203d 2022 4e65 7774 6f6e 222c   str = "Newton",
+00007f80: 0a20 2020 2029 202d 3e20 4e6f 6e65 3a0a  .    ) -> None:.
+00007f90: 2020 2020 2020 2020 2222 2249 6e69 7469          """Initi
+00007fa0: 616c 697a 6572 2066 6f72 2074 6865 2063  alizer for the c
+00007fb0: 6c61 7373 2046 6173 744d 4241 520a 0a20  lass FastMBAR.. 
+00007fc0: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
+00007fd0: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
+00007fe0: 2d2d 2d2d 0a20 2020 2020 2020 2065 6e65  ----.        ene
+00007ff0: 7267 7920 3a20 3244 206e 6461 7272 6179  rgy : 2D ndarray
+00008000: 206f 7220 3244 2074 656e 736f 720a 2020   or 2D tensor.  
+00008010: 2020 2020 2020 2020 2020 4974 2068 6173            It has
+00008020: 2061 2073 697a 6520 6f66 2028 4d20 7820   a size of (M x 
+00008030: 4e29 2c20 7768 6572 6520 4d20 6973 2074  N), where M is t
+00008040: 6865 206e 756d 6265 7220 6f66 2073 7461  he number of sta
+00008050: 7465 730a 2020 2020 2020 2020 2020 2020  tes.            
+00008060: 616e 6420 4e20 6973 2074 6865 2074 6f74  and N is the tot
+00008070: 616c 206e 756d 6265 7220 6f66 2063 6f6e  al number of con
+00008080: 666f 726d 6174 696f 6e73 2e20 5468 6520  formations. The 
+00008090: 656e 7472 7920 656e 6572 6779 5b69 2c6a  entry energy[i,j
+000080a0: 5d0a 2020 2020 2020 2020 2020 2020 6973  ].            is
+000080b0: 2074 6865 2072 6564 7563 6564 2028 756e   the reduced (un
+000080c0: 6974 6c65 7373 2920 656e 6572 6779 206f  itless) energy o
+000080d0: 6620 636f 6e66 6f72 6d61 7469 6f6e 206a  f conformation j
+000080e0: 2069 6e20 7374 6174 6520 692e 0a20 2020   in state i..   
+000080f0: 2020 2020 2020 2020 2049 6620 626f 6f74           If boot
+00008100: 7374 7261 7070 696e 6720 6973 2075 7365  strapping is use
+00008110: 6420 746f 2063 616c 6375 6c61 7465 2074  d to calculate t
+00008120: 6865 2075 6e63 6572 7461 696e 7479 2c20  he uncertainty, 
+00008130: 7468 6520 6f72 6465 720a 2020 2020 2020  the order.      
+00008140: 2020 2020 2020 6f66 2063 6f6e 666f 726d        of conform
+00008150: 6174 696f 6e73 206d 6174 7465 7273 2e20  ations matters. 
+00008160: 436f 6e66 6f72 6d61 7469 6f6e 7320 7361  Conformations sa
+00008170: 6d70 6c65 6420 6672 6f6d 206f 6e65 2073  mpled from one s
+00008180: 7461 7465 0a20 2020 2020 2020 2020 2020  tate.           
+00008190: 206e 6565 6420 746f 206f 6363 7079 2061   need to occpy a
+000081a0: 2063 6f6e 7469 6e75 6f75 7320 6368 756e   continuous chun
+000081b0: 6b20 6f66 2063 6f6c 6c75 6d6e 732e 2043  k of collumns. C
+000081c0: 6f6e 666f 726d 6174 696f 6e73 2073 616d  onformations sam
+000081d0: 706c 6564 0a20 2020 2020 2020 2020 2020  pled.           
+000081e0: 2066 726f 6d20 7374 6174 6520 6b20 6e65   from state k ne
+000081f0: 6564 2074 6f20 6f63 6375 7079 2063 6f6c  ed to occupy col
+00008200: 6c75 6d6e 7320 746f 2074 6865 206c 6566  lumns to the lef
+00008210: 7420 6f66 2063 6f6e 666f 726d 6174 696f  t of conformatio
+00008220: 6e73 0a20 2020 2020 2020 2020 2020 2073  ns.            s
+00008230: 616d 706c 6564 2066 726f 6d20 7374 6174  ampled from stat
+00008240: 6520 6c20 6966 206b 203c 206c 2e20 4966  e l if k < l. If
+00008250: 2062 6f6f 7473 7472 6170 7069 6e67 2069   bootstrapping i
+00008260: 7320 6e6f 7420 7573 6564 2c20 7468 656e  s not used, then
+00008270: 0a20 2020 2020 2020 2020 2020 2074 6865  .            the
+00008280: 206f 7264 6572 206f 6620 636f 6e66 6f72   order of confor
+00008290: 6d61 7469 6f6e 2064 6f65 7320 6e6f 7420  mation does not 
+000082a0: 6d61 7474 6572 2e0a 2020 2020 2020 2020  matter..        
+000082b0: 6e75 6d5f 636f 6e66 3a20 3144 2069 6e74  num_conf: 1D int
+000082c0: 206e 6461 7272 6179 206f 7220 3144 2074   ndarray or 1D t
+000082d0: 656e 736f 720a 2020 2020 2020 2020 2020  ensor.          
+000082e0: 2020 4974 2073 686f 756c 6420 6861 7665    It should have
+000082f0: 2061 2073 697a 6520 6f66 204d 2c20 7768   a size of M, wh
+00008300: 6572 6520 6e75 6d5f 636f 6e66 5b69 5d20  ere num_conf[i] 
+00008310: 6973 2074 6865 206e 756d 206f 660a 2020  is the num of.  
+00008320: 2020 2020 2020 2020 2020 636f 6e66 6f72            confor
+00008330: 6d61 7469 6f6e 7320 7361 6d70 6c65 6420  mations sampled 
+00008340: 6672 6f6d 2073 7461 7465 2069 2e20 5468  from state i. Th
+00008350: 6572 6566 6f72 652c 206e 702e 7375 6d28  erefore, np.sum(
+00008360: 6e75 6d5f 636f 6e66 290a 2020 2020 2020  num_conf).      
+00008370: 2020 2020 2020 6861 7320 746f 2062 6520        has to be 
+00008380: 6571 7561 6c20 746f 204e 2e20 416c 6c20  equal to N. All 
+00008390: 656e 7472 6965 7320 696e 206e 756d 5f63  entries in num_c
+000083a0: 6f6e 6620 6861 7665 2074 6f20 6265 2073  onf have to be s
+000083b0: 7472 6963 746c 790a 2020 2020 2020 2020  trictly.        
+000083c0: 2020 2020 6772 6561 7465 7220 7468 616e      greater than
+000083d0: 2030 2e0a 2020 2020 2020 2020 6375 6461   0..        cuda
+000083e0: 3a20 626f 6f6c 2c20 6f70 7469 6f6e 616c  : bool, optional
+000083f0: 2028 6465 6661 756c 743d 4661 6c73 6529   (default=False)
+00008400: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
+00008410: 6974 2069 7320 7365 7420 746f 2062 6520  it is set to be 
+00008420: 5472 7565 2c20 7468 656e 2074 6865 2063  True, then the c
+00008430: 616c 6375 6c61 7469 6f6e 2077 696c 6c20  alculation will 
+00008440: 6265 2072 756e 206f 6e0a 2020 2020 2020  be run on.      
+00008450: 2020 2020 2020 6120 6772 6170 6869 6361        a graphica
+00008460: 6c20 7072 6f63 6573 7369 6e67 2075 6e69  l processing uni
+00008470: 7420 2847 5055 2920 7573 696e 6720 4355  t (GPU) using CU
+00008480: 4441 2e0a 2020 2020 2020 2020 6375 6461  DA..        cuda
+00008490: 5f62 6174 6368 5f6d 6f64 653a 2062 6f6f  _batch_mode: boo
+000084a0: 6c2c 206f 7074 696f 6e61 6c20 2864 6566  l, optional (def
+000084b0: 6175 6c74 3d4e 6f6e 6529 0a20 2020 2020  ault=None).     
+000084c0: 2020 2020 2020 2054 6865 2062 6174 6368         The batch
+000084d0: 206d 6f64 6520 6973 2074 7572 6e65 6420   mode is turned 
+000084e0: 6f6e 2077 6865 6e20 7468 6520 7369 7a65  on when the size
+000084f0: 206f 6620 7468 6520 656e 6572 6779 206d   of the energy m
+00008500: 6174 7269 7820 6973 0a20 2020 2020 2020  atrix is.       
+00008510: 2020 2020 2074 6f6f 206c 6172 6765 2066       too large f
+00008520: 6f72 2074 6865 206d 656d 6f72 7920 6f66  or the memory of
+00008530: 2061 2047 5055 2e20 5768 656e 2063 7564   a GPU. When cud
+00008540: 615f 6261 7463 685f 6d6f 6465 2069 7320  a_batch_mode is 
+00008550: 5472 7565 2c0a 2020 2020 2020 2020 2020  True,.          
+00008560: 2020 7468 6520 656e 6572 6779 206d 6174    the energy mat
+00008570: 7269 7820 7769 6c6c 2062 6520 7370 6c69  rix will be spli
+00008580: 7420 696e 746f 206d 756c 7469 706c 6520  t into multiple 
+00008590: 6261 7463 6865 7320 7768 6963 6820 6172  batches which ar
+000085a0: 6520 7573 6564 0a20 2020 2020 2020 2020  e used.         
+000085b0: 2020 2073 6571 7565 6e74 6961 6c6c 792e     sequentially.
+000085c0: 2049 6620 6375 6461 5f62 6174 6368 5f6d   If cuda_batch_m
+000085d0: 6f64 6520 3d20 4e6f 6e65 2c20 6974 2077  ode = None, it w
+000085e0: 696c 6c20 6265 2073 6574 2061 7574 6f6d  ill be set autom
+000085f0: 6174 6963 616c 6c79 0a20 2020 2020 2020  atically.       
+00008600: 2020 2020 2062 6173 6564 206f 6e20 7468       based on th
+00008610: 6520 7369 7a65 206f 6620 656e 6572 6779  e size of energy
+00008620: 2061 6e64 2074 6865 206d 656d 6f72 7920   and the memory 
+00008630: 6f66 2074 6865 2061 7661 6962 6c65 2047  of the avaible G
+00008640: 5055 2064 6576 6963 652e 0a20 2020 2020  PU device..     
+00008650: 2020 2062 6f6f 7473 7472 6170 3a20 626f     bootstrap: bo
+00008660: 6f6c 2c20 6f70 7469 6f6e 616c 2028 6465  ol, optional (de
+00008670: 6661 756c 743d 4661 6c73 6529 0a20 2020  fault=False).   
+00008680: 2020 2020 2020 2020 2049 6620 626f 6f74           If boot
+00008690: 7374 7261 7020 6973 2054 7275 652c 2074  strap is True, t
+000086a0: 6865 2075 6e63 6572 7461 696e 7479 206f  he uncertainty o
+000086b0: 6620 7468 6520 6361 6c63 756c 6174 6564  f the calculated
+000086c0: 2066 7265 6520 656e 6572 6769 6573 0a20   free energies. 
+000086d0: 2020 2020 2020 2020 2020 2077 696c 6c20             will 
+000086e0: 6265 2065 7374 696d 6174 6520 7573 696e  be estimate usin
+000086f0: 6720 626c 6f63 6b20 626f 6f74 7374 7261  g block bootstra
+00008700: 7069 6e67 2e0a 2020 2020 2020 2020 626f  ping..        bo
+00008710: 6f74 7374 7261 705f 626c 6f63 6b5f 7369  otstrap_block_si
+00008720: 7a65 3a20 696e 742c 206f 7074 696f 6e61  ze: int, optiona
+00008730: 6c20 2864 6566 6175 6c74 3d33 290a 2020  l (default=3).  
+00008740: 2020 2020 2020 2020 2020 626c 6f63 6b20            block 
+00008750: 7369 7a65 2075 7365 6420 696e 2062 6c6f  size used in blo
+00008760: 636b 2062 6f6f 7473 7472 6170 7069 6e67  ck bootstrapping
+00008770: 0a20 2020 2020 2020 2062 6f6f 7473 7472  .        bootstr
+00008780: 6170 5f6e 756d 5f72 6570 3a20 696e 742c  ap_num_rep: int,
+00008790: 206f 7074 696f 6e61 6c20 2864 6566 6175   optional (defau
+000087a0: 6c74 3d31 3030 290a 2020 2020 2020 2020  lt=100).        
+000087b0: 2020 2020 6e75 6d62 6572 206f 6620 7265      number of re
+000087c0: 7072 6561 7473 2069 6e20 626c 6f63 6b20  preats in block 
+000087d0: 626f 6f74 7374 7261 7070 696e 670a 2020  bootstrapping.  
+000087e0: 2020 2020 2020 7665 7262 6f73 653a 2062        verbose: b
+000087f0: 6f6f 6c2c 206f 7074 696f 6e61 6c20 2864  ool, optional (d
+00008800: 6566 6175 6c74 3d46 616c 7365 290a 2020  efault=False).  
+00008810: 2020 2020 2020 2020 2020 6966 2076 6572            if ver
+00008820: 626f 7365 2069 7320 7472 7565 2c20 7468  bose is true, th
+00008830: 6520 6465 7461 696c 6564 2069 6e66 6f72  e detailed infor
+00008840: 6d61 7469 6f6e 206f 6620 736f 6c76 696e  mation of solvin
+00008850: 6720 4d42 4152 2065 7175 6174 696f 6e73  g MBAR equations
+00008860: 0a20 2020 2020 2020 2020 2020 2069 7320  .            is 
+00008870: 7072 696e 7465 642e 0a20 2020 2020 2020  printed..       
+00008880: 206d 6574 686f 643a 2073 7472 2c20 6f70   method: str, op
+00008890: 7469 6f6e 616c 2028 6465 6661 756c 743d  tional (default=
+000088a0: 224e 6577 746f 6e22 290a 2020 2020 2020  "Newton").      
+000088b0: 2020 2020 2020 7468 6520 6d65 7468 6f64        the method
+000088c0: 2075 7365 6420 746f 2073 6f6c 7665 2074   used to solve t
+000088d0: 6865 204d 4241 5220 6571 7561 7469 6f6e  he MBAR equation
+000088e0: 2e20 5468 6520 6465 6661 756c 7420 6973  . The default is
+000088f0: 204e 6577 746f 6e27 7320 6d65 7468 6f64   Newton's method
+00008900: 2e0a 2020 2020 2020 2020 2222 220a 0a20  ..        """.. 
+00008910: 2020 2020 2020 2023 2323 2320 6368 6563         #### chec
+00008920: 6b20 7468 6520 7061 7261 6d65 7465 7273  k the parameters
+00008930: 3a20 656e 6572 6779 2061 6e64 206e 756d  : energy and num
+00008940: 5f63 6f6e 660a 2020 2020 2020 2020 2323  _conf.        ##
+00008950: 204e 6f74 6520 7468 6174 2062 6f74 6820   Note that both 
+00008960: 7365 6c66 2e65 6e65 7267 7920 616e 6420  self.energy and 
+00008970: 7365 6c66 2e63 6f6e 6620 7769 6c6c 2062  self.conf will b
+00008980: 6520 6f6e 2043 5055 7320 6e6f 206d 6174  e on CPUs no mat
+00008990: 7465 720a 2020 2020 2020 2020 2323 2069  ter.        ## i
+000089a0: 6620 6375 6461 2069 7320 5472 7565 206f  f cuda is True o
+000089b0: 7220 4661 6c73 652e 0a0a 2020 2020 2020  r False...      
+000089c0: 2020 2323 2065 6e65 7267 7920 6e65 6564    ## energy need
+000089d0: 7320 746f 2062 6520 6120 322d 4420 6e64  s to be a 2-D nd
+000089e0: 6172 7261 7920 6f72 2061 2032 2d44 2074  array or a 2-D t
+000089f0: 656e 736f 722e 0a20 2020 2020 2020 2023  ensor..        #
+00008a00: 2320 636f 6e76 6572 7420 6974 2069 6e74  # convert it int
+00008a10: 6f20 646f 7562 6c65 2070 7265 6369 7369  o double precisi
+00008a20: 6f6e 2069 6620 6e6f 740a 2020 2020 2020  on if not.      
+00008a30: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+00008a40: 656e 6572 6779 2c20 6e70 2e6e 6461 7272  energy, np.ndarr
+00008a50: 6179 293a 0a20 2020 2020 2020 2020 2020  ay):.           
+00008a60: 2065 6e65 7267 7920 3d20 656e 6572 6779   energy = energy
+00008a70: 2e61 7374 7970 6528 6e70 2e66 6c6f 6174  .astype(np.float
+00008a80: 3634 290a 2020 2020 2020 2020 2020 2020  64).            
+00008a90: 7365 6c66 2e65 6e65 7267 7920 3d20 746f  self.energy = to
+00008aa0: 7263 682e 6672 6f6d 5f6e 756d 7079 2865  rch.from_numpy(e
+00008ab0: 6e65 7267 7929 0a20 2020 2020 2020 2065  nergy).        e
+00008ac0: 6c69 6620 6973 696e 7374 616e 6365 2865  lif isinstance(e
+00008ad0: 6e65 7267 792c 2074 6f72 6368 2e54 656e  nergy, torch.Ten
+00008ae0: 736f 7229 3a0a 2020 2020 2020 2020 2020  sor):.          
+00008af0: 2020 7365 6c66 2e65 6e65 7267 7920 3d20    self.energy = 
+00008b00: 656e 6572 6779 2e64 6f75 626c 6528 290a  energy.double().
+00008b10: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00008b20: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00008b30: 5479 7065 4572 726f 7228 2265 6e65 7267  TypeError("energ
+00008b40: 7920 6861 7320 746f 2062 6520 6120 322d  y has to be a 2-
+00008b50: 4420 6e64 6172 7261 7920 6f72 2061 2032  D ndarray or a 2
+00008b60: 2d44 2074 656e 736f 722e 2229 0a0a 2020  -D tensor.")..  
+00008b70: 2020 2020 2020 2323 206e 756d 5f63 6f6e        ## num_con
+00008b80: 6620 6e65 6564 7320 746f 2062 6520 6120  f needs to be a 
+00008b90: 312d 4420 6e64 6172 7261 7920 6f72 2061  1-D ndarray or a
+00008ba0: 2031 2d44 2074 656e 736f 722e 0a20 2020   1-D tensor..   
+00008bb0: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
+00008bc0: 6365 286e 756d 5f63 6f6e 662c 206e 702e  ce(num_conf, np.
+00008bd0: 6e64 6172 7261 7929 3a0a 2020 2020 2020  ndarray):.      
+00008be0: 2020 2020 2020 6e75 6d5f 636f 6e66 203d        num_conf =
+00008bf0: 206e 756d 5f63 6f6e 662e 6173 7479 7065   num_conf.astype
+00008c00: 286e 702e 666c 6f61 7436 3429 0a20 2020  (np.float64).   
+00008c10: 2020 2020 2020 2020 2073 656c 662e 6e75           self.nu
+00008c20: 6d5f 636f 6e66 203d 2074 6f72 6368 2e66  m_conf = torch.f
+00008c30: 726f 6d5f 6e75 6d70 7928 6e75 6d5f 636f  rom_numpy(num_co
+00008c40: 6e66 290a 2020 2020 2020 2020 656c 6966  nf).        elif
+00008c50: 2069 7369 6e73 7461 6e63 6528 6e75 6d5f   isinstance(num_
+00008c60: 636f 6e66 2c20 746f 7263 682e 5465 6e73  conf, torch.Tens
+00008c70: 6f72 293a 0a20 2020 2020 2020 2020 2020  or):.           
+00008c80: 2073 656c 662e 6e75 6d5f 636f 6e66 203d   self.num_conf =
+00008c90: 206e 756d 5f63 6f6e 662e 646f 7562 6c65   num_conf.double
+00008ca0: 2829 0a20 2020 2020 2020 2065 6c73 653a  ().        else:
+00008cb0: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+00008cc0: 7365 2054 7970 6545 7272 6f72 2822 6e75  se TypeError("nu
+00008cd0: 6d5f 636f 6e66 2068 6173 2074 6f20 6265  m_conf has to be
+00008ce0: 2061 2031 2d44 206e 6461 7272 6179 206f   a 1-D ndarray o
+00008cf0: 7220 6120 312d 4420 7465 6e73 6f72 2e22  r a 1-D tensor."
+00008d00: 290a 0a20 2020 2020 2020 2023 2320 6368  )..        ## ch
+00008d10: 6563 6b20 7468 6520 7368 6170 6520 6f66  eck the shape of
+00008d20: 2065 6e65 7267 7920 616e 6420 6e75 6d5f   energy and num_
+00008d30: 636f 6e66 0a20 2020 2020 2020 2069 6620  conf.        if 
+00008d40: 656e 6572 6779 2e6e 6469 6d20 213d 2032  energy.ndim != 2
+00008d50: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+00008d60: 6973 6520 5661 6c75 6545 7272 6f72 2822  ise ValueError("
+00008d70: 656e 6572 6779 2068 6173 2074 6f20 6265  energy has to be
+00008d80: 2061 2032 2d44 206e 6461 7272 6179 206f   a 2-D ndarray o
+00008d90: 7220 6120 322d 4420 7465 6e73 6f72 2e22  r a 2-D tensor."
+00008da0: 290a 2020 2020 2020 2020 6966 206e 756d  ).        if num
+00008db0: 5f63 6f6e 662e 6e64 696d 2021 3d20 313a  _conf.ndim != 1:
+00008dc0: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+00008dd0: 7365 2056 616c 7565 4572 726f 7228 226e  se ValueError("n
+00008de0: 756d 5f63 6f6e 6620 6861 7320 746f 2062  um_conf has to b
+00008df0: 6520 6120 312d 4420 6e64 6172 7261 7920  e a 1-D ndarray 
+00008e00: 6f72 2061 2031 2d44 2074 656e 736f 722e  or a 1-D tensor.
+00008e10: 2229 0a20 2020 2020 2020 2069 6620 656e  ").        if en
+00008e20: 6572 6779 2e73 6861 7065 5b30 5d20 213d  ergy.shape[0] !=
+00008e30: 206e 756d 5f63 6f6e 662e 7368 6170 655b   num_conf.shape[
+00008e40: 305d 3a0a 2020 2020 2020 2020 2020 2020  0]:.            
+00008e50: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+00008e60: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00008e70: 2020 2274 6865 206e 756d 6265 7220 6f66    "the number of
+00008e80: 2072 6f77 7320 696e 2065 6e65 7267 7920   rows in energy 
+00008e90: 6861 7320 746f 2062 6520 6571 7561 6c20  has to be equal 
+00008ea0: 746f 2074 6865 206c 656e 6774 6820 6f66  to the length of
+00008eb0: 206e 756d 5f63 6f6e 662e 220a 2020 2020   num_conf.".    
+00008ec0: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+00008ed0: 2020 2023 2320 6368 6563 6b20 6966 2074     ## check if t
+00008ee0: 6865 206e 756d 6265 7220 6f66 2063 6f6e  he number of con
+00008ef0: 666f 726d 6174 696f 6e73 2073 616d 706c  formations sampl
+00008f00: 6564 2066 726f 6d20 6561 6368 2073 7461  ed from each sta
+00008f10: 7465 2069 7320 6772 6561 7465 7220 7468  te is greater th
+00008f20: 616e 2030 0a20 2020 2020 2020 2069 6620  an 0.        if 
+00008f30: 746f 7263 682e 7375 6d28 7365 6c66 2e6e  torch.sum(self.n
+00008f40: 756d 5f63 6f6e 6620 3c3d 2030 2920 3e20  um_conf <= 0) > 
+00008f50: 303a 0a20 2020 2020 2020 2020 2020 2072  0:.            r
+00008f60: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+00008f70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00008f80: 2022 616c 6c20 656e 7472 6965 7320 696e   "all entries in
+00008f90: 206e 756d 5f63 6f6e 6620 6861 7665 2074   num_conf have t
+00008fa0: 6f20 6265 2073 7472 6963 746c 7920 6772  o be strictly gr
+00008fb0: 6561 7465 7220 7468 616e 2030 2e22 0a20  eater than 0.". 
+00008fc0: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
+00008fd0: 2020 2020 2020 2323 2063 6865 636b 2069        ## check i
+00008fe0: 6620 7468 6520 746f 7461 6c20 6e75 6d62  f the total numb
+00008ff0: 6572 206f 6620 636f 6e66 6f72 6d61 7469  er of conformati
+00009000: 6f6e 7320 6973 2065 7175 616c 2074 6f20  ons is equal to 
+00009010: 7468 6520 6e75 6d62 6572 206f 6620 636f  the number of co
+00009020: 6c75 6d6e 7320 696e 2065 6e65 7267 790a  lumns in energy.
+00009030: 2020 2020 2020 2020 6966 2074 6f72 6368          if torch
+00009040: 2e73 756d 2873 656c 662e 6e75 6d5f 636f  .sum(self.num_co
+00009050: 6e66 2920 213d 2073 656c 662e 656e 6572  nf) != self.ener
+00009060: 6779 2e73 6861 7065 5b31 5d3a 0a20 2020  gy.shape[1]:.   
+00009070: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+00009080: 616c 7565 4572 726f 7228 0a20 2020 2020  alueError(.     
+00009090: 2020 2020 2020 2020 2020 2022 7468 6520             "the 
+000090a0: 7375 6d20 6f66 206e 756d 5f63 6f6e 6620  sum of num_conf 
+000090b0: 6861 7320 746f 2062 6520 6571 7561 6c20  has to be equal 
+000090c0: 746f 2074 6865 206e 756d 6265 7220 6f66  to the number of
+000090d0: 2063 6f6c 756d 6e73 2069 6e20 656e 6572   columns in ener
+000090e0: 6779 2e22 0a20 2020 2020 2020 2020 2020  gy.".           
+000090f0: 2029 0a0a 2020 2020 2020 2020 7365 6c66   )..        self
+00009100: 2e4d 203d 2073 656c 662e 656e 6572 6779  .M = self.energy
+00009110: 2e73 6861 7065 5b30 5d0a 2020 2020 2020  .shape[0].      
+00009120: 2020 7365 6c66 2e4e 203d 2073 656c 662e    self.N = self.
+00009130: 656e 6572 6779 2e73 6861 7065 5b31 5d0a  energy.shape[1].
+00009140: 0a20 2020 2020 2020 2073 656c 662e 6375  .        self.cu
+00009150: 6461 203d 2063 7564 610a 2020 2020 2020  da = cuda.      
+00009160: 2020 6966 2073 656c 662e 6375 6461 2069    if self.cuda i
+00009170: 7320 5472 7565 3a0a 2020 2020 2020 2020  s True:.        
+00009180: 2020 2020 7365 6c66 2e64 6576 6963 6520      self.device 
+00009190: 3d20 746f 7263 682e 6465 7669 6365 2822  = torch.device("
+000091a0: 6375 6461 2229 0a20 2020 2020 2020 2065  cuda").        e
+000091b0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+000091c0: 2073 656c 662e 6465 7669 6365 203d 2074   self.device = t
+000091d0: 6f72 6368 2e64 6576 6963 6528 2263 7075  orch.device("cpu
+000091e0: 2229 0a0a 2020 2020 2020 2020 6966 2073  ")..        if s
+000091f0: 656c 662e 6375 6461 3a0a 2020 2020 2020  elf.cuda:.      
+00009200: 2020 2020 2020 2323 2063 6865 636b 2069        ## check i
+00009210: 6620 7468 6520 4750 5520 6465 7669 6365  f the GPU device
+00009220: 2068 6173 2065 6e6f 7567 6820 6d65 6d6f   has enough memo
+00009230: 7279 2e20 4966 206e 6f74 2c20 6375 6461  ry. If not, cuda
+00009240: 5f62 6174 6368 5f6d 6f64 6520 6973 2074  _batch_mode is t
+00009250: 7572 6e65 6420 6f6e 0a0a 2020 2020 2020  urned on..      
+00009260: 2020 2020 2020 2323 2061 7574 6f6d 6174        ## automat
+00009270: 6963 616c 6c79 2064 6574 6572 6d69 6e65  ically determine
+00009280: 2069 6620 6375 6461 5f62 6174 6368 5f6d   if cuda_batch_m
+00009290: 6f64 6520 6973 206f 6e20 6f72 206f 6666  ode is on or off
+000092a0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+000092b0: 662e 5f74 6f74 616c 5f47 5055 5f6d 656d  f._total_GPU_mem
+000092c0: 6f72 7920 3d20 746f 7263 682e 6375 6461  ory = torch.cuda
+000092d0: 2e67 6574 5f64 6576 6963 655f 7072 6f70  .get_device_prop
+000092e0: 6572 7469 6573 2830 292e 746f 7461 6c5f  erties(0).total_
+000092f0: 6d65 6d6f 7279 0a20 2020 2020 2020 2020  memory.         
+00009300: 2020 2069 6620 280a 2020 2020 2020 2020     if (.        
+00009310: 2020 2020 2020 2020 7365 6c66 2e65 6e65          self.ene
+00009320: 7267 792e 6e75 6d65 6c28 2920 2a20 7365  rgy.numel() * se
+00009330: 6c66 2e65 6e65 7267 792e 656c 656d 656e  lf.energy.elemen
+00009340: 745f 7369 7a65 2829 0a20 2020 2020 2020  t_size().       
+00009350: 2020 2020 2020 2020 203c 2073 656c 662e           < self.
+00009360: 5f74 6f74 616c 5f47 5055 5f6d 656d 6f72  _total_GPU_memor
+00009370: 7920 2f20 3130 0a20 2020 2020 2020 2020  y / 10.         
+00009380: 2020 2029 3a0a 2020 2020 2020 2020 2020     ):.          
+00009390: 2020 2020 2020 7365 6c66 2e63 7564 615f        self.cuda_
+000093a0: 6261 7463 685f 6d6f 6465 203d 2046 616c  batch_mode = Fal
+000093b0: 7365 0a20 2020 2020 2020 2020 2020 2065  se.            e
+000093c0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+000093d0: 2020 2020 2073 656c 662e 6375 6461 5f62       self.cuda_b
+000093e0: 6174 6368 5f6d 6f64 6520 3d20 5472 7565  atch_mode = True
+000093f0: 0a0a 2020 2020 2020 2020 2020 2020 2323  ..            ##
+00009400: 2063 7564 615f 6261 7463 685f 6d6f 6465   cuda_batch_mode
+00009410: 2063 616e 2062 6520 656e 666f 7263 6564   can be enforced
+00009420: 2062 7920 7061 7373 696e 6720 7468 6520   by passing the 
+00009430: 6172 6775 6d65 6e74 2063 7564 615f 6261  argument cuda_ba
+00009440: 7463 685f 6d6f 6465 0a20 2020 2020 2020  tch_mode.       
+00009450: 2020 2020 2069 6620 6375 6461 5f62 6174       if cuda_bat
+00009460: 6368 5f6d 6f64 6520 6973 206e 6f74 204e  ch_mode is not N
+00009470: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+00009480: 2020 2020 2073 656c 662e 6375 6461 5f62       self.cuda_b
+00009490: 6174 6368 5f6d 6f64 6520 3d20 6375 6461  atch_mode = cuda
+000094a0: 5f62 6174 6368 5f6d 6f64 650a 0a20 2020  _batch_mode..   
+000094b0: 2020 2020 2023 2320 7768 656e 2063 7564       ## when cud
+000094c0: 615f 6261 7463 685f 6d6f 6465 2069 7320  a_batch_mode is 
+000094d0: 7573 6564 2c20 7765 206e 6565 6420 746f  used, we need to
+000094e0: 2064 6563 6964 6520 6f6e 2074 6865 2062   decide on the b
+000094f0: 6174 6368 5f73 697a 6520 6261 7365 6420  atch_size based 
+00009500: 6f6e 0a20 2020 2020 2020 2023 2320 626f  on.        ## bo
+00009510: 7468 2074 6865 206d 656d 6f72 7920 6f66  th the memory of
+00009520: 2074 6865 2047 5055 2064 6576 6963 6520   the GPU device 
+00009530: 616e 6420 7468 6520 7369 7a65 206f 6620  and the size of 
+00009540: 656e 6572 6779 206d 6174 7269 780a 2020  energy matrix.  
+00009550: 2020 2020 2020 7365 6c66 2e5f 6261 7463        self._batc
+00009560: 685f 7369 7a65 203d 204e 6f6e 650a 2020  h_size = None.  
+00009570: 2020 2020 2020 6966 2073 656c 662e 6375        if self.cu
+00009580: 6461 2061 6e64 2073 656c 662e 6375 6461  da and self.cuda
+00009590: 5f62 6174 6368 5f6d 6f64 653a 0a20 2020  _batch_mode:.   
+000095a0: 2020 2020 2020 2020 2023 2320 6261 7463           ## batc
+000095b0: 6820 7369 7a65 2066 6f72 2073 6570 6572  h size for seper
+000095c0: 6174 696e 6720 636f 6e66 6f72 6d61 7469  ating conformati
+000095d0: 6f6e 730a 2020 2020 2020 2020 2020 2020  ons.            
+000095e0: 7365 6c66 2e5f 6261 7463 685f 7369 7a65  self._batch_size
+000095f0: 203d 2069 6e74 280a 2020 2020 2020 2020   = int(.        
+00009600: 2020 2020 2020 2020 7365 6c66 2e5f 746f          self._to
+00009610: 7461 6c5f 4750 555f 6d65 6d6f 7279 0a20  tal_GPU_memory. 
+00009620: 2020 2020 2020 2020 2020 2020 2020 202f                 /
+00009630: 2032 300a 2020 2020 2020 2020 2020 2020   20.            
+00009640: 2020 2020 2f20 7365 6c66 2e65 6e65 7267      / self.energ
+00009650: 792e 7368 6170 655b 305d 0a20 2020 2020  y.shape[0].     
+00009660: 2020 2020 2020 2020 2020 202f 2073 656c             / sel
+00009670: 662e 656e 6572 6779 2e65 6c65 6d65 6e74  f.energy.element
+00009680: 5f73 697a 6528 290a 2020 2020 2020 2020  _size().        
+00009690: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+000096a0: 2020 7365 6c66 2e5f 6261 7463 685f 7369    self._batch_si
+000096b0: 7a65 203d 206d 696e 2831 3032 342c 2073  ze = min(1024, s
+000096c0: 656c 662e 5f62 6174 6368 5f73 697a 6529  elf._batch_size)
+000096d0: 0a0a 2020 2020 2020 2020 2323 2077 6865  ..        ## whe
+000096e0: 7468 6572 2074 6f20 7573 6520 626f 6f74  ther to use boot
+000096f0: 7374 7261 7020 746f 2065 7374 696d 6174  strap to estimat
+00009700: 6520 7468 6520 756e 6365 7274 6169 6e74  e the uncertaint
+00009710: 7920 6f66 2074 6865 2063 616c 6375 6c61  y of the calcula
+00009720: 7465 6420 6672 6565 2065 6e65 7267 6965  ted free energie
+00009730: 730a 2020 2020 2020 2020 2323 2062 6f6f  s.        ## boo
+00009740: 7473 7472 6170 206e 6565 6473 2074 6f20  tstrap needs to 
+00009750: 6265 2061 2062 6f6f 6c65 616e 0a20 2020  be a boolean.   
+00009760: 2020 2020 2069 6620 6e6f 7420 6973 696e       if not isin
+00009770: 7374 616e 6365 2862 6f6f 7473 7472 6170  stance(bootstrap
+00009780: 2c20 626f 6f6c 293a 0a20 2020 2020 2020  , bool):.       
+00009790: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
+000097a0: 7272 6f72 2822 626f 6f74 7374 7261 7020  rror("bootstrap 
+000097b0: 6861 7320 746f 2062 6520 6120 626f 6f6c  has to be a bool
+000097c0: 6561 6e2e 2229 0a20 2020 2020 2020 2073  ean.").        s
+000097d0: 656c 662e 626f 6f74 7374 7261 7020 3d20  elf.bootstrap = 
+000097e0: 626f 6f74 7374 7261 700a 0a20 2020 2020  bootstrap..     
+000097f0: 2020 2023 2320 626c 6f63 6b20 7369 7a65     ## block size
+00009800: 2075 7365 6420 696e 2062 6c6f 636b 2062   used in block b
+00009810: 6f6f 7473 7472 6170 7069 6e67 0a20 2020  ootstrapping.   
+00009820: 2020 2020 2069 6620 6e6f 7420 6973 696e       if not isin
+00009830: 7374 616e 6365 2862 6f6f 7473 7472 6170  stance(bootstrap
+00009840: 5f62 6c6f 636b 5f73 697a 652c 2069 6e74  _block_size, int
+00009850: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
+00009860: 6169 7365 2054 7970 6545 7272 6f72 2822  aise TypeError("
+00009870: 626f 6f74 7374 7261 705f 626c 6f63 6b5f  bootstrap_block_
+00009880: 7369 7a65 2068 6173 2074 6f20 6265 2061  size has to be a
+00009890: 6e20 696e 7465 6765 722e 2229 0a20 2020  n integer.").   
+000098a0: 2020 2020 2073 656c 662e 626f 6f74 7374       self.bootst
+000098b0: 7261 705f 626c 6f63 6b5f 7369 7a65 203d  rap_block_size =
+000098c0: 2062 6f6f 7473 7472 6170 5f62 6c6f 636b   bootstrap_block
+000098d0: 5f73 697a 650a 0a20 2020 2020 2020 2023  _size..        #
+000098e0: 2320 6e75 6d62 6572 206f 6620 7265 7065  # number of repe
+000098f0: 6174 7320 696e 2062 6c6f 636b 2062 6f6f  ats in block boo
+00009900: 7473 7472 6170 7069 6e67 0a20 2020 2020  tstrapping.     
+00009910: 2020 2069 6620 6e6f 7420 6973 696e 7374     if not isinst
+00009920: 616e 6365 2862 6f6f 7473 7472 6170 5f6e  ance(bootstrap_n
+00009930: 756d 5f72 6570 2c20 696e 7429 3a0a 2020  um_rep, int):.  
+00009940: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00009950: 5479 7065 4572 726f 7228 2262 6f6f 7473  TypeError("boots
+00009960: 7472 6170 5f6e 756d 5f72 6570 2068 6173  trap_num_rep has
+00009970: 2074 6f20 6265 2061 6e20 696e 7465 6765   to be an intege
+00009980: 722e 2229 0a20 2020 2020 2020 2073 656c  r.").        sel
+00009990: 662e 626f 6f74 7374 7261 705f 6e75 6d5f  f.bootstrap_num_
+000099a0: 7265 7020 3d20 626f 6f74 7374 7261 705f  rep = bootstrap_
+000099b0: 6e75 6d5f 7265 700a 0a20 2020 2020 2020  num_rep..       
+000099c0: 2023 2320 7768 6574 6865 7220 746f 2070   ## whether to p
+000099d0: 7269 6e74 2074 6865 2064 6574 6169 6c65  rint the detaile
+000099e0: 6420 696e 666f 726d 6174 696f 6e20 6f66  d information of
+000099f0: 2073 6f6c 7669 6e67 204d 4241 5220 6571   solving MBAR eq
+00009a00: 7561 7469 6f6e 730a 2020 2020 2020 2020  uations.        
+00009a10: 2323 2076 6572 626f 7365 206e 6565 6473  ## verbose needs
+00009a20: 2074 6f20 6265 2061 2062 6f6f 6c65 616e   to be a boolean
+00009a30: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
+00009a40: 6973 696e 7374 616e 6365 2876 6572 626f  isinstance(verbo
+00009a50: 7365 2c20 626f 6f6c 293a 0a20 2020 2020  se, bool):.     
+00009a60: 2020 2020 2020 2072 6169 7365 2054 7970         raise Typ
+00009a70: 6545 7272 6f72 2822 7665 7262 6f73 6520  eError("verbose 
+00009a80: 6861 7320 746f 2062 6520 6120 626f 6f6c  has to be a bool
+00009a90: 6561 6e2e 2229 0a20 2020 2020 2020 2073  ean.").        s
+00009aa0: 656c 662e 7665 7262 6f73 6520 3d20 7665  elf.verbose = ve
+00009ab0: 7262 6f73 650a 0a20 2020 2020 2020 2023  rbose..        #
+00009ac0: 2320 6d65 7468 6f64 2075 7365 6420 746f  # method used to
+00009ad0: 2073 6f6c 7665 2074 6865 204d 4241 5220   solve the MBAR 
+00009ae0: 6571 7561 7469 6f6e 0a20 2020 2020 2020  equation.       
+00009af0: 2069 6620 6e6f 7420 6973 696e 7374 616e   if not isinstan
+00009b00: 6365 286d 6574 686f 642c 2073 7472 293a  ce(method, str):
+00009b10: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+00009b20: 7365 2054 7970 6545 7272 6f72 2822 6d65  se TypeError("me
+00009b30: 7468 6f64 2068 6173 2074 6f20 6265 2061  thod has to be a
+00009b40: 2073 7472 696e 672e 2229 0a20 2020 2020   string.").     
+00009b50: 2020 2069 6620 6d65 7468 6f64 206e 6f74     if method not
+00009b60: 2069 6e20 5b22 4e65 7774 6f6e 222c 2022   in ["Newton", "
+00009b70: 4c2d 4246 4753 2d42 225d 3a0a 2020 2020  L-BFGS-B"]:.    
+00009b80: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+00009b90: 6c75 6545 7272 6f72 2822 6d65 7468 6f64  lueError("method
+00009ba0: 2068 6173 2074 6f20 6265 204e 6577 746f   has to be Newto
+00009bb0: 6e20 6f72 204c 2d42 4647 532d 422e 2229  n or L-BFGS-B.")
+00009bc0: 0a20 2020 2020 2020 2073 656c 662e 6d65  .        self.me
+00009bd0: 7468 6f64 203d 206d 6574 686f 640a 0a20  thod = method.. 
+00009be0: 2020 2020 2020 2023 2320 736f 6c76 6520         ## solve 
+00009bf0: 7468 6520 4d42 4152 2065 7175 6174 696f  the MBAR equatio
+00009c00: 6e0a 2020 2020 2020 2020 6966 2073 656c  n.        if sel
+00009c10: 662e 626f 6f74 7374 7261 7020 6973 2046  f.bootstrap is F
+00009c20: 616c 7365 3a0a 2020 2020 2020 2020 2020  alse:.          
+00009c30: 2020 6446 5f69 6e69 7420 3d20 7365 6c66    dF_init = self
+00009c40: 2e65 6e65 7267 792e 6e65 775f 7a65 726f  .energy.new_zero
+00009c50: 7328 7365 6c66 2e4d 202d 2031 290a 2020  s(self.M - 1).  
+00009c60: 2020 2020 2020 2020 2020 6446 203d 205f            dF = _
+00009c70: 736f 6c76 655f 6d62 6172 280a 2020 2020  solve_mbar(.    
+00009c80: 2020 2020 2020 2020 2020 2020 6446 5f69              dF_i
+00009c90: 6e69 742e 746f 2873 656c 662e 6465 7669  nit.to(self.devi
+00009ca0: 6365 292c 0a20 2020 2020 2020 2020 2020  ce),.           
+00009cb0: 2020 2020 2073 656c 662e 656e 6572 6779       self.energy
+00009cc0: 2e74 6f28 7365 6c66 2e64 6576 6963 6529  .to(self.device)
+00009cd0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00009ce0: 2020 7365 6c66 2e6e 756d 5f63 6f6e 662e    self.num_conf.
+00009cf0: 746f 2873 656c 662e 6465 7669 6365 292c  to(self.device),
+00009d00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00009d10: 2073 656c 662e 6d65 7468 6f64 2c0a 2020   self.method,.  
+00009d20: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00009d30: 6c66 2e5f 6261 7463 685f 7369 7a65 2c0a  lf._batch_size,.
+00009d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009d50: 7665 7262 6f73 653d 7365 6c66 2e76 6572  verbose=self.ver
+00009d60: 626f 7365 2c0a 2020 2020 2020 2020 2020  bose,.          
+00009d70: 2020 292e 6370 7528 290a 0a20 2020 2020    ).cpu()..     
+00009d80: 2020 2020 2020 2023 2320 7368 6966 7420         ## shift 
+00009d90: 7365 6c66 2e5f 4620 7375 6368 2074 6861  self._F such tha
+00009da0: 7420 5c73 756d 5f69 2046 5b69 5d2a 6e75  t \sum_i F[i]*nu
+00009db0: 6d5f 636f 6e66 5b69 5d20 3d20 300a 2020  m_conf[i] = 0.  
+00009dc0: 2020 2020 2020 2020 2020 4620 3d20 746f            F = to
+00009dd0: 7263 682e 6361 7428 5b64 462e 6e65 775f  rch.cat([dF.new_
+00009de0: 7a65 726f 7328 3129 2c20 6446 5d29 0a20  zeros(1), dF]). 
+00009df0: 2020 2020 2020 2020 2020 2070 6920 3d20             pi = 
+00009e00: 7365 6c66 2e6e 756d 5f63 6f6e 6620 2f20  self.num_conf / 
+00009e10: 7365 6c66 2e4e 0a20 2020 2020 2020 2020  self.N.         
+00009e20: 2020 2073 656c 662e 5f46 203d 2046 202d     self._F = F -
+00009e30: 2074 6f72 6368 2e73 756d 2870 6920 2a20   torch.sum(pi * 
+00009e40: 4629 0a0a 2020 2020 2020 2020 2020 2020  F)..            
+00009e50: 6220 3d20 2d73 656c 662e 5f46 202d 2074  b = -self._F - t
+00009e60: 6f72 6368 2e6c 6f67 2873 656c 662e 6e75  orch.log(self.nu
+00009e70: 6d5f 636f 6e66 290a 2020 2020 2020 2020  m_conf).        
+00009e80: 2020 2020 7365 6c66 2e5f 6c6f 675f 7072      self._log_pr
+00009e90: 6f62 5f6d 6978 203d 2074 6f72 6368 2e6c  ob_mix = torch.l
+00009ea0: 6f67 7375 6d65 7870 282d 2873 656c 662e  ogsumexp(-(self.
+00009eb0: 656e 6572 6779 202b 2062 5b3a 2c20 4e6f  energy + b[:, No
+00009ec0: 6e65 5d29 2c20 6469 6d3d 3029 0a20 2020  ne]), dim=0).   
+00009ed0: 2020 2020 2020 2020 2073 656c 662e 5f6c           self._l
+00009ee0: 6f67 5f6d 7520 3d20 2d73 656c 662e 6c6f  og_mu = -self.lo
+00009ef0: 675f 7072 6f62 5f6d 6978 0a0a 2020 2020  g_prob_mix..    
+00009f00: 2020 2020 2020 2020 2323 2043 6f6d 7075          ## Compu
+00009f10: 7465 2073 656c 662e 5f46 5f63 6f76 2075  te self._F_cov u
+00009f20: 6e64 6572 2074 6865 2063 6f6e 7374 7261  nder the constra
+00009f30: 696e 7420 7468 6174 205c 7375 6d5f 6920  int that \sum_i 
+00009f40: 465b 695d 2a6e 756d 5f63 6f6e 665b 695d  F[i]*num_conf[i]
+00009f50: 203d 2030 0a0a 2020 2020 2020 2020 2020   = 0..          
+00009f60: 2020 2323 2054 6865 7265 2061 7265 2074    ## There are t
+00009f70: 776f 2077 6179 7320 746f 2063 6f6d 7075  wo ways to compu
+00009f80: 7465 2074 6865 2063 6f76 6172 6961 6e63  te the covarianc
+00009f90: 6520 6d61 7472 6978 206f 6620 7365 6c66  e matrix of self
+00009fa0: 2e5f 460a 2020 2020 2020 2020 2020 2020  ._F.            
+00009fb0: 2323 2053 6565 2065 7175 6174 696f 6e20  ## See equation 
+00009fc0: 342e 3220 616e 6420 362e 3420 696e 2074  4.2 and 6.4 in t
+00009fd0: 6865 2066 6f6c 6c6f 7769 6e67 2070 6170  he following pap
+00009fe0: 6572 2066 6f72 2064 6574 6169 6c73 0a20  er for details. 
+00009ff0: 2020 2020 2020 2020 2020 2023 2320 224b             ## "K
+0000a000: 6f6e 672c 2041 2e2c 2065 7420 616c 2e20  ong, A., et al. 
+0000a010: 2241 2074 6865 6f72 7920 6f66 2073 7461  "A theory of sta
+0000a020: 7469 7374 6963 616c 206d 6f64 656c 7320  tistical models 
+0000a030: 666f 7220 4d6f 6e74 6520 4361 726c 6f20  for Monte Carlo 
+0000a040: 696e 7465 6772 6174 696f 6e2e 220a 2020  integration.".  
+0000a050: 2020 2020 2020 2020 2020 2323 204a 6f75            ## Jou
+0000a060: 726e 616c 206f 6620 7468 6520 526f 7961  rnal of the Roya
+0000a070: 6c20 5374 6174 6973 7469 6361 6c20 536f  l Statistical So
+0000a080: 6369 6574 7920 5365 7269 6573 2042 3a20  ciety Series B: 
+0000a090: 5374 6174 6973 7469 6361 6c20 4d65 7468  Statistical Meth
+0000a0a0: 6f64 6f6c 6f67 7920 3635 2e33 0a20 2020  odology 65.3.   
+0000a0b0: 2020 2020 2020 2020 2023 2320 2832 3030           ## (200
+0000a0c0: 3329 3a20 3538 352d 3630 342e 2220 6874  3): 585-604." ht
+0000a0d0: 7470 733a 2f2f 646f 692e 6f72 672f 3130  tps://doi.org/10
+0000a0e0: 2e31 3131 312f 3134 3637 2d39 3836 382e  .1111/1467-9868.
+0000a0f0: 3030 3430 340a 0a20 2020 2020 2020 2020  00404..         
+0000a100: 2020 2023 2320 5468 6520 6669 7273 7420     ## The first 
+0000a110: 7761 7920 6173 2073 686f 776e 2069 6e20  way as shown in 
+0000a120: 7468 6520 666f 6c6c 6f77 696e 6720 7573  the following us
+0000a130: 6573 2065 7175 6174 696f 6e20 342e 320a  es equation 4.2.
+0000a140: 2020 2020 2020 2020 2020 2020 2323 2074              ## t
+0000a150: 6869 7320 6d65 7468 6f64 2069 7320 6d6f  his method is mo
+0000a160: 7265 2067 656e 6572 616c 2074 6861 6e20  re general than 
+0000a170: 7468 6520 666f 6c6c 6f77 696e 6720 6d65  the following me
+0000a180: 7468 6f64 2c20 6d65 616e 696e 6720 7468  thod, meaning th
+0000a190: 6174 0a20 2020 2020 2020 2020 2020 2023  at.            #
+0000a1a0: 2320 6974 2063 616e 2061 6c73 6f20 6265  # it can also be
+0000a1b0: 2075 7365 6420 746f 2063 6f6d 7075 7465   used to compute
+0000a1c0: 2063 6f76 6172 6961 6e63 6520 6d61 7472   covariance matr
+0000a1d0: 6978 2066 6f72 2070 6572 7475 7262 6564  ix for perturbed
+0000a1e0: 2073 7461 7465 732e 0a20 2020 2020 2020   states..       
+0000a1f0: 2020 2020 2023 2320 5468 6572 6566 6f72       ## Therefor
+0000a200: 6520 6974 2069 7320 7573 6564 2068 6572  e it is used her
+0000a210: 652e 0a20 2020 2020 2020 2020 2020 2073  e..            s
+0000a220: 656c 662e 5020 3d20 746f 7263 682e 6578  elf.P = torch.ex
+0000a230: 7028 0a20 2020 2020 2020 2020 2020 2020  p(.             
+0000a240: 2020 202d 2873 656c 662e 656e 6572 6779     -(self.energy
+0000a250: 202d 2073 656c 662e 5f46 5b3a 2c20 4e6f   - self._F[:, No
+0000a260: 6e65 5d20 2b20 7365 6c66 2e5f 6c6f 675f  ne] + self._log_
+0000a270: 7072 6f62 5f6d 6978 290a 2020 2020 2020  prob_mix).      
+0000a280: 2020 2020 2020 292e 7428 290a 2020 2020        ).t().    
+0000a290: 2020 2020 2020 2020 5720 3d20 746f 7263          W = torc
+0000a2a0: 682e 6469 6167 2873 656c 662e 6e75 6d5f  h.diag(self.num_
+0000a2b0: 636f 6e66 290a 2020 2020 2020 2020 2020  conf).          
+0000a2c0: 2020 512c 2052 203d 2074 6f72 6368 2e6c    Q, R = torch.l
+0000a2d0: 696e 616c 672e 7172 2873 656c 662e 5029  inalg.qr(self.P)
+0000a2e0: 0a20 2020 2020 2020 2020 2020 2041 203d  .            A =
+0000a2f0: 2074 6f72 6368 2e65 7965 2873 656c 662e   torch.eye(self.
+0000a300: 4d2c 2064 6576 6963 653d 572e 6465 7669  M, device=W.devi
+0000a310: 6365 2920 2d20 5220 4020 5720 4020 522e  ce) - R @ W @ R.
+0000a320: 540a 2020 2020 2020 2020 2020 2020 7365  T.            se
+0000a330: 6c66 2e5f 465f 636f 7620 3d20 522e 5420  lf._F_cov = R.T 
+0000a340: 4020 746f 7263 682e 6c69 6e61 6c67 2e70  @ torch.linalg.p
+0000a350: 696e 7628 412c 2068 6572 6d69 7469 616e  inv(A, hermitian
+0000a360: 3d54 7275 652c 2072 746f 6c3d 3165 2d38  =True, rtol=1e-8
+0000a370: 2920 4020 520a 0a20 2020 2020 2020 2020  ) @ R..         
+0000a380: 2020 2023 2023 2054 6865 2073 6563 6f6e     # # The secon
+0000a390: 6420 7761 7920 7573 6573 2065 7175 6174  d way uses equat
+0000a3a0: 696f 6e20 362e 340a 2020 2020 2020 2020  ion 6.4.        
+0000a3b0: 2020 2020 2320 6966 2073 656c 662e 5f62      # if self._b
+0000a3c0: 6174 6368 5f73 697a 6520 6973 204e 6f6e  atch_size is Non
+0000a3d0: 653a 0a20 2020 2020 2020 2020 2020 2023  e:.            #
+0000a3e0: 2020 2020 2048 203d 205f 636f 6d70 7574       H = _comput
+0000a3f0: 655f 6865 7373 6961 6e5f 6c6f 675f 6c69  e_hessian_log_li
+0000a400: 6b65 6c69 686f 6f64 5f6f 665f 4628 0a20  kelihood_of_F(. 
+0000a410: 2020 2020 2020 2020 2020 2023 2020 2020             #    
+0000a420: 2020 2020 2073 656c 662e 5f46 2c20 7365       self._F, se
+0000a430: 6c66 2e65 6e65 7267 792c 2073 656c 662e  lf.energy, self.
+0000a440: 6e75 6d5f 636f 6e66 0a20 2020 2020 2020  num_conf.       
+0000a450: 2020 2020 2023 2020 2020 2029 0a20 2020       #     ).   
+0000a460: 2020 2020 2020 2020 2023 2065 6c73 653a           # else:
+0000a470: 0a20 2020 2020 2020 2020 2020 2023 2020  .            #  
+0000a480: 2020 2048 203d 205f 636f 6d70 7574 655f     H = _compute_
+0000a490: 6865 7373 6961 6e5f 6c6f 675f 6c69 6b65  hessian_log_like
+0000a4a0: 6c69 686f 6f64 5f6f 665f 465f 696e 5f62  lihood_of_F_in_b
+0000a4b0: 6174 6368 280a 2020 2020 2020 2020 2020  atch(.          
+0000a4c0: 2020 2320 2020 2020 2020 2020 7365 6c66    #         self
+0000a4d0: 2e5f 462c 2073 656c 662e 656e 6572 6779  ._F, self.energy
+0000a4e0: 2c20 7365 6c66 2e6e 756d 5f63 6f6e 662c  , self.num_conf,
+0000a4f0: 2073 656c 662e 5f62 6174 6368 5f73 697a   self._batch_siz
+0000a500: 650a 2020 2020 2020 2020 2020 2020 2320  e.            # 
+0000a510: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+0000a520: 2020 2320 4870 203d 2048 2e6e 6577 5f7a    # Hp = H.new_z
+0000a530: 6572 6f73 2828 7365 6c66 2e4d 202b 2031  eros((self.M + 1
+0000a540: 2c20 7365 6c66 2e4d 202b 2031 2929 2e63  , self.M + 1)).c
+0000a550: 7075 2829 0a20 2020 2020 2020 2020 2020  pu().           
+0000a560: 2023 2048 705b 3020 3a20 7365 6c66 2e4d   # Hp[0 : self.M
+0000a570: 2c20 3020 3a20 7365 6c66 2e4d 5d20 3d20  , 0 : self.M] = 
+0000a580: 480a 2020 2020 2020 2020 2020 2020 2320  H.            # 
+0000a590: 4870 5b73 656c 662e 4d2c 2030 203a 2073  Hp[self.M, 0 : s
+0000a5a0: 656c 662e 4d5d 203d 202d 7365 6c66 2e6e  elf.M] = -self.n
+0000a5b0: 756d 5f63 6f6e 660a 2020 2020 2020 2020  um_conf.        
+0000a5c0: 2020 2020 2320 4870 5b30 203a 2073 656c      # Hp[0 : sel
+0000a5d0: 662e 4d2c 2073 656c 662e 4d5d 203d 202d  f.M, self.M] = -
+0000a5e0: 7365 6c66 2e6e 756d 5f63 6f6e 660a 2020  self.num_conf.  
+0000a5f0: 2020 2020 2020 2020 2020 2320 4870 5b73            # Hp[s
+0000a600: 656c 662e 4d2c 2073 656c 662e 4d5d 203d  elf.M, self.M] =
+0000a610: 2030 0a20 2020 2020 2020 2020 2020 2023   0.            #
+0000a620: 2073 656c 662e 5f46 5f63 6f76 203d 2074   self._F_cov = t
+0000a630: 6f72 6368 2e6c 696e 616c 672e 696e 7628  orch.linalg.inv(
+0000a640: 2d48 7029 5b30 203a 2073 656c 662e 4d2c  -Hp)[0 : self.M,
+0000a650: 2030 203a 2073 656c 662e 4d5d 0a20 2020   0 : self.M].   
+0000a660: 2020 2020 2020 2020 2023 2073 656c 662e           # self.
+0000a670: 5f46 5f63 6f76 203d 2073 656c 662e 5f46  _F_cov = self._F
+0000a680: 5f63 6f76 202d 2074 6f72 6368 2e64 6961  _cov - torch.dia
+0000a690: 6728 3120 2f20 7365 6c66 2e6e 756d 5f63  g(1 / self.num_c
+0000a6a0: 6f6e 6629 202b 2031 202f 2073 656c 662e  onf) + 1 / self.
+0000a6b0: 4e0a 0a20 2020 2020 2020 2020 2020 2073  N..            s
+0000a6c0: 656c 662e 5f46 5f73 7464 203d 2073 656c  elf._F_std = sel
+0000a6d0: 662e 5f46 5f63 6f76 2e64 6961 676f 6e61  f._F_cov.diagona
+0000a6e0: 6c28 292e 7371 7274 2829 0a0a 2020 2020  l().sqrt()..    
+0000a6f0: 2020 2020 2020 2020 7365 6c66 2e5f 4465          self._De
+0000a700: 6c74 6146 203d 2073 656c 662e 5f46 5b4e  ltaF = self._F[N
+0000a710: 6f6e 652c 203a 5d20 2d20 7365 6c66 2e5f  one, :] - self._
+0000a720: 465b 3a2c 204e 6f6e 655d 0a20 2020 2020  F[:, None].     
+0000a730: 2020 2020 2020 2073 656c 662e 5f44 656c         self._Del
+0000a740: 7461 465f 636f 7620 3d20 280a 2020 2020  taF_cov = (.    
+0000a750: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0000a760: 2e5f 465f 636f 762e 6469 6167 2829 5b3a  ._F_cov.diag()[:
+0000a770: 2c20 4e6f 6e65 5d0a 2020 2020 2020 2020  , None].        
+0000a780: 2020 2020 2020 2020 2b20 7365 6c66 2e5f          + self._
+0000a790: 465f 636f 762e 6469 6167 2829 5b4e 6f6e  F_cov.diag()[Non
+0000a7a0: 652c 203a 5d0a 2020 2020 2020 2020 2020  e, :].          
+0000a7b0: 2020 2020 2020 2d20 3220 2a20 7365 6c66        - 2 * self
+0000a7c0: 2e5f 465f 636f 760a 2020 2020 2020 2020  ._F_cov.        
+0000a7d0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+0000a7e0: 2020 7365 6c66 2e5f 4465 6c74 6146 5f73    self._DeltaF_s
+0000a7f0: 7464 203d 2073 656c 662e 5f44 656c 7461  td = self._Delta
+0000a800: 465f 636f 762e 7371 7274 2829 0a0a 2020  F_cov.sqrt()..  
+0000a810: 2020 2020 2020 656c 6966 2073 656c 662e        elif self.
+0000a820: 626f 6f74 7374 7261 7020 6973 2054 7275  bootstrap is Tru
+0000a830: 653a 0a20 2020 2020 2020 2020 2020 2064  e:.            d
+0000a840: 4673 203d 205b 5d0a 2020 2020 2020 2020  Fs = [].        
+0000a850: 2020 2020 6c6f 675f 7072 6f62 5f6d 6978      log_prob_mix
+0000a860: 203d 205b 5d0a 2020 2020 2020 2020 2020   = [].          
+0000a870: 2020 6446 5f69 6e69 7420 3d20 7365 6c66    dF_init = self
+0000a880: 2e65 6e65 7267 792e 6e65 775f 7a65 726f  .energy.new_zero
+0000a890: 7328 7365 6c66 2e4d 202d 2031 290a 2020  s(self.M - 1).  
+0000a8a0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+0000a8b0: 636f 6e66 5f69 6478 203d 205b 5d0a 2020  conf_idx = [].  
+0000a8c0: 2020 2020 2020 2020 2020 666f 7220 5f20            for _ 
+0000a8d0: 696e 2072 616e 6765 2873 656c 662e 626f  in range(self.bo
+0000a8e0: 6f74 7374 7261 705f 6e75 6d5f 7265 7029  otstrap_num_rep)
+0000a8f0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0000a900: 2020 636f 6e66 5f69 6478 203d 205f 626f    conf_idx = _bo
+0000a910: 6f74 7374 7261 705f 636f 6e66 5f69 6478  otstrap_conf_idx
+0000a920: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0000a930: 2020 2020 2020 7365 6c66 2e6e 756d 5f63        self.num_c
+0000a940: 6f6e 662e 746f 2874 6f72 6368 2e69 6e74  onf.to(torch.int
+0000a950: 3634 292c 2073 656c 662e 626f 6f74 7374  64), self.bootst
+0000a960: 7261 705f 626c 6f63 6b5f 7369 7a65 0a20  rap_block_size. 
+0000a970: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+0000a980: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000a990: 2064 4620 3d20 5f73 6f6c 7665 5f6d 6261   dF = _solve_mba
+0000a9a0: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
+0000a9b0: 2020 2020 2020 2064 465f 696e 6974 2e74         dF_init.t
+0000a9c0: 6f28 7365 6c66 2e64 6576 6963 6529 2c0a  o(self.device),.
+0000a9d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a9e0: 2020 2020 7365 6c66 2e65 6e65 7267 795b      self.energy[
+0000a9f0: 3a2c 2063 6f6e 665f 6964 785d 2e74 6f28  :, conf_idx].to(
+0000aa00: 7365 6c66 2e64 6576 6963 6529 2c0a 2020  self.device),.  
+0000aa10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000aa20: 2020 7365 6c66 2e6e 756d 5f63 6f6e 662e    self.num_conf.
+0000aa30: 746f 2873 656c 662e 6465 7669 6365 292c  to(self.device),
+0000aa40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000aa50: 2020 2020 2073 656c 662e 6d65 7468 6f64       self.method
+0000aa60: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0000aa70: 2020 2020 2020 7365 6c66 2e5f 6261 7463        self._batc
+0000aa80: 685f 7369 7a65 2c0a 2020 2020 2020 2020  h_size,.        
+0000aa90: 2020 2020 2020 2020 2020 2020 7665 7262              verb
+0000aaa0: 6f73 653d 7365 6c66 2e76 6572 626f 7365  ose=self.verbose
+0000aab0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0000aac0: 2020 292e 6370 7528 290a 2020 2020 2020    ).cpu().      
+0000aad0: 2020 2020 2020 2020 2020 6446 5f69 6e69            dF_ini
+0000aae0: 7420 3d20 6446 0a20 2020 2020 2020 2020  t = dF.         
+0000aaf0: 2020 2020 2020 2064 4673 2e61 7070 656e         dFs.appen
+0000ab00: 6428 6446 2e63 6c6f 6e65 2829 290a 0a20  d(dF.clone()).. 
+0000ab10: 2020 2020 2020 2020 2020 2020 2020 2046                 F
+0000ab20: 203d 2074 6f72 6368 2e63 6174 285b 6446   = torch.cat([dF
+0000ab30: 2e6e 6577 5f7a 6572 6f73 2831 292c 2064  .new_zeros(1), d
+0000ab40: 465d 290a 2020 2020 2020 2020 2020 2020  F]).            
+0000ab50: 2020 2020 2323 2073 6869 6674 2046 2073      ## shift F s
+0000ab60: 7563 6820 7468 6174 205c 7375 6d5f 6920  uch that \sum_i 
+0000ab70: 465b 695d 2a6e 756d 5f63 6f6e 665b 695d  F[i]*num_conf[i]
+0000ab80: 203d 2030 0a20 2020 2020 2020 2020 2020   = 0.           
+0000ab90: 2020 2020 2070 6920 3d20 7365 6c66 2e6e       pi = self.n
+0000aba0: 756d 5f63 6f6e 6620 2f20 7365 6c66 2e4e  um_conf / self.N
+0000abb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000abc0: 2046 203d 2046 202d 2074 6f72 6368 2e73   F = F - torch.s
+0000abd0: 756d 2870 6920 2a20 4629 0a0a 2020 2020  um(pi * F)..    
+0000abe0: 2020 2020 2020 2020 2020 2020 6220 3d20              b = 
+0000abf0: 2d46 202d 2074 6f72 6368 2e6c 6f67 2873  -F - torch.log(s
+0000ac00: 656c 662e 6e75 6d5f 636f 6e66 202f 2073  elf.num_conf / s
+0000ac10: 656c 662e 4e29 0a20 2020 2020 2020 2020  elf.N).         
+0000ac20: 2020 2020 2020 206c 6f67 5f70 726f 625f         log_prob_
+0000ac30: 6d69 782e 6170 7065 6e64 280a 2020 2020  mix.append(.    
+0000ac40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ac50: 746f 7263 682e 6c6f 6773 756d 6578 7028  torch.logsumexp(
+0000ac60: 2d28 7365 6c66 2e65 6e65 7267 795b 3a2c  -(self.energy[:,
+0000ac70: 2063 6f6e 665f 6964 785d 202b 2062 5b3a   conf_idx] + b[:
+0000ac80: 2c20 4e6f 6e65 5d29 2c20 6469 6d3d 3029  , None]), dim=0)
+0000ac90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000aca0: 2029 0a20 2020 2020 2020 2020 2020 2020   ).             
+0000acb0: 2020 2073 656c 662e 5f63 6f6e 665f 6964     self._conf_id
+0000acc0: 782e 6170 7065 6e64 2863 6f6e 665f 6964  x.append(conf_id
+0000acd0: 7829 0a0a 2020 2020 2020 2020 2020 2020  x)..            
+0000ace0: 6446 203d 2074 6f72 6368 2e73 7461 636b  dF = torch.stack
+0000acf0: 2864 4673 2c20 6469 6d3d 3129 0a20 2020  (dFs, dim=1).   
+0000ad00: 2020 2020 2020 2020 2046 203d 2074 6f72           F = tor
+0000ad10: 6368 2e63 6174 285b 6446 2e6e 6577 5f7a  ch.cat([dF.new_z
+0000ad20: 6572 6f73 2831 2c20 6446 2e73 6861 7065  eros(1, dF.shape
+0000ad30: 5b31 5d29 2c20 6446 5d2c 2064 696d 3d30  [1]), dF], dim=0
+0000ad40: 290a 0a20 2020 2020 2020 2020 2020 2023  )..            #
+0000ad50: 2320 7368 6966 7420 4620 7375 6368 2074  # shift F such t
+0000ad60: 6861 7420 5c73 756d 5f69 2046 5b69 5d2a  hat \sum_i F[i]*
+0000ad70: 6e75 6d5f 636f 6e66 5b69 5d20 3d20 300a  num_conf[i] = 0.
+0000ad80: 2020 2020 2020 2020 2020 2020 7069 203d              pi =
+0000ad90: 2073 656c 662e 6e75 6d5f 636f 6e66 202f   self.num_conf /
+0000ada0: 2073 656c 662e 4e0a 2020 2020 2020 2020   self.N.        
+0000adb0: 2020 2020 7365 6c66 2e5f 465f 626f 6f74      self._F_boot
+0000adc0: 7374 7261 7020 3d20 4620 2d20 746f 7263  strap = F - torc
+0000add0: 682e 7375 6d28 7069 5b3a 2c20 4e6f 6e65  h.sum(pi[:, None
+0000ade0: 5d20 2a20 462c 2064 696d 3d30 290a 0a20  ] * F, dim=0).. 
+0000adf0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0000ae00: 5f46 203d 2074 6f72 6368 2e6d 6561 6e28  _F = torch.mean(
+0000ae10: 7365 6c66 2e5f 465f 626f 6f74 7374 7261  self._F_bootstra
+0000ae20: 702c 2064 696d 3d31 290a 2020 2020 2020  p, dim=1).      
+0000ae30: 2020 2020 2020 7365 6c66 2e5f 465f 7374        self._F_st
+0000ae40: 6420 3d20 746f 7263 682e 7374 6428 7365  d = torch.std(se
+0000ae50: 6c66 2e5f 465f 626f 6f74 7374 7261 702c  lf._F_bootstrap,
+0000ae60: 2064 696d 3d31 290a 2020 2020 2020 2020   dim=1).        
+0000ae70: 2020 2020 7365 6c66 2e5f 465f 636f 7620      self._F_cov 
+0000ae80: 3d20 746f 7263 682e 636f 7628 7365 6c66  = torch.cov(self
+0000ae90: 2e5f 465f 626f 6f74 7374 7261 7029 0a0a  ._F_bootstrap)..
+0000aea0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0000aeb0: 2e5f 6c6f 675f 7072 6f62 5f6d 6978 203d  ._log_prob_mix =
+0000aec0: 2074 6f72 6368 2e73 7461 636b 286c 6f67   torch.stack(log
+0000aed0: 5f70 726f 625f 6d69 782c 2064 696d 3d30  _prob_mix, dim=0
+0000aee0: 290a 2020 2020 2020 2020 2020 2020 4465  ).            De
+0000aef0: 6c74 6146 203d 2064 465b 4e6f 6e65 2c20  ltaF = dF[None, 
+0000af00: 3a2c 203a 5d20 2d20 6446 5b3a 2c20 4e6f  :, :] - dF[:, No
+0000af10: 6e65 2c20 3a5d 0a20 2020 2020 2020 2020  ne, :].         
+0000af20: 2020 2073 656c 662e 5f44 656c 7461 4620     self._DeltaF 
+0000af30: 3d20 746f 7263 682e 6d65 616e 2844 656c  = torch.mean(Del
+0000af40: 7461 462c 2064 696d 3d32 290a 2020 2020  taF, dim=2).    
+0000af50: 2020 2020 2020 2020 7365 6c66 2e5f 4465          self._De
+0000af60: 6c74 6146 5f73 7464 203d 2074 6f72 6368  ltaF_std = torch
+0000af70: 2e73 7464 2844 656c 7461 462c 2064 696d  .std(DeltaF, dim
+0000af80: 3d32 290a 0a20 2020 2040 7072 6f70 6572  =2)..    @proper
+0000af90: 7479 0a20 2020 2064 6566 2046 2873 656c  ty.    def F(sel
+0000afa0: 6629 202d 3e20 6e70 2e6e 6461 7272 6179  f) -> np.ndarray
+0000afb0: 3a0a 2020 2020 2020 2020 2222 2246 7265  :.        """Fre
+0000afc0: 6520 656e 6572 6769 6573 206f 6620 7468  e energies of th
+0000afd0: 6520 7374 6174 6573 2075 6e64 6572 2074  e states under t
+0000afe0: 6865 2063 6f6e 7374 7261 696e 7420 3a6d  he constraint :m
+0000aff0: 6174 683a 605c 7375 6d5f 7b6b 3d31 7d5e  ath:`\sum_{k=1}^
+0000b000: 7b4d 7d20 4e5f 6b20 2a20 465f 6b20 3d20  {M} N_k * F_k = 
+0000b010: 3060 2c0a 2020 2020 2020 2020 7768 6572  0`,.        wher
+0000b020: 6520 3a6d 6174 683a 604e 5f6b 6020 6973  e :math:`N_k` is
+0000b030: 2074 6865 206e 756d 6265 7220 6f66 2063   the number of c
+0000b040: 6f6e 666f 726d 6174 696f 6e73 2073 616d  onformations sam
+0000b050: 706c 6564 2066 726f 6d20 7374 6174 6520  pled from state 
+0000b060: 6b2e 0a20 2020 2020 2020 2022 2222 0a20  k..        """. 
+0000b070: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+0000b080: 6c66 2e5f 462e 6370 7528 292e 6e75 6d70  lf._F.cpu().nump
+0000b090: 7928 290a 0a20 2020 2040 7072 6f70 6572  y()..    @proper
+0000b0a0: 7479 0a20 2020 2064 6566 2046 5f73 7464  ty.    def F_std
+0000b0b0: 2873 656c 6629 202d 3e20 6e70 2e6e 6461  (self) -> np.nda
+0000b0c0: 7272 6179 3a0a 2020 2020 2020 2020 2222  rray:.        ""
+0000b0d0: 2253 7461 6e64 6172 6420 6465 7669 6174  "Standard deviat
+0000b0e0: 696f 6e20 6f66 2074 6865 2066 7265 6520  ion of the free 
+0000b0f0: 656e 6572 6769 6573 206f 6620 7468 6520  energies of the 
+0000b100: 7374 6174 6573 2075 6e64 6572 2074 6865  states under the
+0000b110: 2063 6f6e 7374 7261 696e 740a 2020 2020   constraint.    
+0000b120: 2020 2020 3a6d 6174 683a 605c 7375 6d5f      :math:`\sum_
+0000b130: 7b6b 3d31 7d5e 7b4d 7d20 4e5f 6b20 2a20  {k=1}^{M} N_k * 
+0000b140: 465f 6b20 3d20 3060 2c0a 2020 2020 2020  F_k = 0`,.      
+0000b150: 2020 7768 6572 6520 3a6d 6174 683a 604e    where :math:`N
+0000b160: 5f6b 6020 6973 2074 6865 206e 756d 6265  _k` is the numbe
+0000b170: 7220 6f66 2063 6f6e 666f 726d 6174 696f  r of conformatio
+0000b180: 6e73 2073 616d 706c 6564 2066 726f 6d20  ns sampled from 
+0000b190: 7374 6174 6520 6b2e 0a20 2020 2020 2020  state k..       
+0000b1a0: 2022 2222 0a20 2020 2020 2020 2072 6574   """.        ret
+0000b1b0: 7572 6e20 7365 6c66 2e5f 465f 7374 642e  urn self._F_std.
+0000b1c0: 6370 7528 292e 6e75 6d70 7928 290a 0a20  cpu().numpy().. 
+0000b1d0: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
+0000b1e0: 2064 6566 2046 5f63 6f76 2873 656c 6629   def F_cov(self)
+0000b1f0: 202d 3e20 6e70 2e6e 6461 7272 6179 3a0a   -> np.ndarray:.
+0000b200: 2020 2020 2020 2020 2222 2243 6f76 6172          """Covar
+0000b210: 6961 6e63 6520 6d61 7472 6978 206f 6620  iance matrix of 
+0000b220: 7468 6520 6672 6565 2065 6e65 7267 6965  the free energie
+0000b230: 7320 6f66 2074 6865 2073 7461 7465 7320  s of the states 
+0000b240: 756e 6465 7220 7468 6520 636f 6e73 7472  under the constr
+0000b250: 6169 6e74 0a20 2020 2020 2020 203a 6d61  aint.        :ma
+0000b260: 7468 3a60 5c73 756d 5f7b 6b3d 317d 5e7b  th:`\sum_{k=1}^{
+0000b270: 4d7d 204e 5f6b 202a 2046 5f6b 203d 2030  M} N_k * F_k = 0
+0000b280: 602c 0a20 2020 2020 2020 2077 6865 7265  `,.        where
+0000b290: 203a 6d61 7468 3a60 4e5f 6b60 2069 7320   :math:`N_k` is 
+0000b2a0: 7468 6520 6e75 6d62 6572 206f 6620 636f  the number of co
+0000b2b0: 6e66 6f72 6d61 7469 6f6e 7320 7361 6d70  nformations samp
+0000b2c0: 6c65 6420 6672 6f6d 2073 7461 7465 206b  led from state k
+0000b2d0: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+0000b2e0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+0000b2f0: 662e 5f46 5f63 6f76 2e63 7075 2829 2e6e  f._F_cov.cpu().n
+0000b300: 756d 7079 2829 0a0a 2020 2020 4070 726f  umpy()..    @pro
+0000b310: 7065 7274 790a 2020 2020 6465 6620 4465  perty.    def De
+0000b320: 6c74 6146 2873 656c 6629 202d 3e20 6e70  ltaF(self) -> np
+0000b330: 2e6e 6461 7272 6179 3a0a 2020 2020 2020  .ndarray:.      
+0000b340: 2020 2222 2246 7265 6520 656e 6572 6779    """Free energy
+0000b350: 2064 6966 6665 7265 6e63 6520 6265 7477   difference betw
+0000b360: 6565 6e20 7374 6174 6573 2e0a 2020 2020  een states..    
+0000b370: 2020 2020 3a6d 6174 683a 605c 6d61 7468      :math:`\math
+0000b380: 726d 7b44 656c 7461 467d 5b69 2c6a 5d60  rm{DeltaF}[i,j]`
+0000b390: 2069 7320 7468 6520 6672 6565 2065 6e65   is the free ene
+0000b3a0: 7267 7920 6469 6666 6572 656e 6365 2062  rgy difference b
+0000b3b0: 6574 7765 656e 2073 7461 7465 206a 2061  etween state j a
+0000b3c0: 6e64 2073 7461 7465 2069 2c0a 2020 2020  nd state i,.    
+0000b3d0: 2020 2020 692e 652e 2c20 3a6d 6174 683a      i.e., :math:
+0000b3e0: 605c 6d61 7468 726d 7b44 656c 7461 467d  `\mathrm{DeltaF}
+0000b3f0: 5b69 2c6a 5d20 3d20 465b 6a5d 202d 2046  [i,j] = F[j] - F
+0000b400: 5b69 5d60 202e 0a20 2020 2020 2020 2022  [i]` ..        "
+0000b410: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
+0000b420: 6e20 7365 6c66 2e5f 4465 6c74 6146 2e63  n self._DeltaF.c
+0000b430: 7075 2829 2e6e 756d 7079 2829 0a0a 2020  pu().numpy()..  
+0000b440: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
+0000b450: 6465 6620 4465 6c74 6146 5f73 7464 2873  def DeltaF_std(s
+0000b460: 656c 6629 202d 3e20 6e70 2e6e 6461 7272  elf) -> np.ndarr
+0000b470: 6179 3a0a 2020 2020 2020 2020 2222 2253  ay:.        """S
+0000b480: 7461 6e64 6172 6420 6465 7669 6174 696f  tandard deviatio
+0000b490: 6e20 6f66 2074 6865 2066 7265 6520 656e  n of the free en
+0000b4a0: 6572 6779 2064 6966 6665 7265 6e63 6520  ergy difference 
+0000b4b0: 6265 7477 6565 6e20 7374 6174 6573 2e0a  between states..
+0000b4c0: 2020 2020 2020 2020 3a6d 6174 683a 605c          :math:`\
+0000b4d0: 6d61 7468 726d 7b44 656c 7461 465f 7374  mathrm{DeltaF_st
+0000b4e0: 647d 5b69 2c6a 5d60 2069 7320 7468 6520  d}[i,j]` is the 
+0000b4f0: 7374 616e 6461 7264 2064 6576 6961 7469  standard deviati
+0000b500: 6f6e 206f 6620 7468 6520 6672 6565 2065  on of the free e
+0000b510: 6e65 7267 790a 2020 2020 2020 2020 6469  nergy.        di
+0000b520: 6666 6572 656e 6365 203a 6d61 7468 3a60  fference :math:`
+0000b530: 5c6d 6174 6872 6d7b 4465 6c74 6146 7d5b  \mathrm{DeltaF}[
+0000b540: 692c 6a5d 602e 0a20 2020 2020 2020 2022  i,j]`..        "
+0000b550: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
+0000b560: 6e20 7365 6c66 2e5f 4465 6c74 6146 5f73  n self._DeltaF_s
+0000b570: 7464 2e63 7075 2829 2e6e 756d 7079 2829  td.cpu().numpy()
+0000b580: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
+0000b590: 2020 2020 6465 6620 6c6f 675f 7072 6f62      def log_prob
+0000b5a0: 5f6d 6978 2873 656c 6629 202d 3e20 6e70  _mix(self) -> np
+0000b5b0: 2e6e 6461 7272 6179 3a0a 2020 2020 2020  .ndarray:.      
+0000b5c0: 2020 2222 2274 6865 206c 6f67 2070 726f    """the log pro
+0000b5d0: 6261 6269 6c69 7479 2064 656e 7369 7479  bability density
+0000b5e0: 206f 6620 636f 6e66 6f72 6d61 7469 6f6e   of conformation
+0000b5f0: 7320 696e 2074 6865 206d 6978 7475 7265  s in the mixture
+0000b600: 2064 6973 7472 6962 7574 696f 6e2e 2222   distribution.""
+0000b610: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
+0000b620: 2073 656c 662e 5f6c 6f67 5f70 726f 625f   self._log_prob_
+0000b630: 6d69 782e 6370 7528 292e 6e75 6d70 7928  mix.cpu().numpy(
+0000b640: 290a 0a20 2020 2064 6566 2063 616c 6375  )..    def calcu
+0000b650: 6c61 7465 5f66 7265 655f 656e 6572 6769  late_free_energi
+0000b660: 6573 5f6f 665f 7065 7274 7572 6265 645f  es_of_perturbed_
+0000b670: 7374 6174 6573 2873 656c 662c 2065 6e65  states(self, ene
+0000b680: 7267 795f 7065 7274 7572 6265 6429 3a0a  rgy_perturbed):.
+0000b690: 2020 2020 2020 2020 2222 2263 616c 6375          """calcu
+0000b6a0: 6c61 7465 2066 7265 6520 656e 6572 6769  late free energi
+0000b6b0: 6573 2066 6f72 2070 6572 7475 7262 6564  es for perturbed
+0000b6c0: 2073 7461 7465 732e 0a0a 2020 2020 2020   states...      
+0000b6d0: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
+0000b6e0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d2d       -----------
+0000b6f0: 0a20 2020 2020 2020 2065 6e65 7267 795f  .        energy_
+0000b700: 7065 7274 7572 6265 643a 2032 2d44 2066  perturbed: 2-D f
+0000b710: 6c6f 6174 206e 6461 7272 6179 2077 6974  loat ndarray wit
+0000b720: 6820 7369 7a65 206f 6620 284c 2c4e 290a  h size of (L,N).
+0000b730: 2020 2020 2020 2020 2020 2020 6561 6368              each
+0000b740: 2072 6f77 206f 6620 7468 6520 656e 6572   row of the ener
+0000b750: 6779 5f70 6572 7475 7262 6564 206d 6174  gy_perturbed mat
+0000b760: 7269 7820 7265 7072 6573 656e 7473 2061  rix represents a
+0000b770: 2073 7461 7465 2061 6e64 0a20 2020 2020   state and.     
+0000b780: 2020 2020 2020 2074 6865 2076 616c 7565         the value
+0000b790: 2065 6e65 7267 795f 7065 7274 7572 6265   energy_perturbe
+0000b7a0: 645b 6c2c 6e5d 2072 6570 7265 7365 6e74  d[l,n] represent
+0000b7b0: 7320 7468 6520 7265 6475 6365 6420 656e  s the reduced en
+0000b7c0: 6572 6779 0a20 2020 2020 2020 2020 2020  ergy.           
+0000b7d0: 206f 6620 7468 6520 6e27 7468 2063 6f6e   of the n'th con
+0000b7e0: 666f 726d 6174 696f 6e20 696e 2074 6865  formation in the
+0000b7f0: 206c 2774 6820 7065 7274 7572 6265 6420   l'th perturbed 
+0000b800: 7374 6174 652e 0a0a 2020 2020 2020 2020  state...        
+0000b810: 5265 7475 726e 730a 2020 2020 2020 2020  Returns.        
+0000b820: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+0000b830: 7265 7375 6c74 733a 2064 6963 740a 2020  results: dict.  
+0000b840: 2020 2020 2020 2020 2020 6120 6469 6374            a dict
+0000b850: 696f 6e61 7279 2063 6f6e 7461 696e 696e  ionary containin
+0000b860: 6720 7468 6520 666f 6c6c 6f77 696e 6720  g the following 
+0000b870: 6b65 7973 3a0a 0a20 2020 2020 2020 2020  keys:..         
+0000b880: 2020 202a 2a46 2a2a 202d 2074 6865 2066     **F** - the f
+0000b890: 7265 6520 656e 6572 6779 206f 6620 7468  ree energy of th
+0000b8a0: 6520 7065 7274 7572 6265 6420 7374 6174  e perturbed stat
+0000b8b0: 6573 2e0a 0a20 2020 2020 2020 2020 2020  es...           
+0000b8c0: 202a 2a46 5f73 7464 2a2a 202d 2074 6865   **F_std** - the
+0000b8d0: 2073 7461 6e64 6172 6420 6465 7669 6174   standard deviat
+0000b8e0: 696f 6e20 6f66 2074 6865 2066 7265 6520  ion of the free 
+0000b8f0: 656e 6572 6779 206f 6620 7468 6520 7065  energy of the pe
+0000b900: 7274 7572 6265 6420 7374 6174 6573 2e20  rturbed states. 
+0000b910: 0a0a 2020 2020 2020 2020 2020 2020 2a2a  ..            **
+0000b920: 465f 636f 762a 2a20 2d20 7468 6520 636f  F_cov** - the co
+0000b930: 7661 7269 616e 6365 2062 6574 7765 656e  variance between
+0000b940: 2074 6865 2066 7265 6520 656e 6572 6769   the free energi
+0000b950: 6573 206f 6620 7468 6520 7065 7274 7572  es of the pertur
+0000b960: 6265 6420 7374 6174 6573 2e0a 0a20 2020  bed states...   
+0000b970: 2020 2020 2020 2020 202a 2a44 656c 7461           **Delta
+0000b980: 462a 2a20 2d20 3a6d 6174 683a 605c 6d61  F** - :math:`\ma
+0000b990: 7468 726d 7b44 656c 7461 467d 5b6b 2c6c  thrm{DeltaF}[k,l
+0000b9a0: 5d60 2069 7320 7468 6520 6672 6565 2065  ]` is the free e
+0000b9b0: 6e65 7267 7920 6469 6666 6572 656e 6365  nergy difference
+0000b9c0: 2062 6574 7765 656e 2073 7461 7465 2020   between state  
+0000b9d0: 2020 2020 2020 2020 2020 0a20 2020 2020            .     
+0000b9e0: 2020 2020 2020 203a 6d61 7468 3a60 6b60         :math:`k`
+0000b9f0: 2061 6e64 2073 7461 7465 203a 6d61 7468   and state :math
+0000ba00: 3a60 6c60 2c20 692e 652e 2c20 3a6d 6174  :`l`, i.e., :mat
+0000ba10: 683a 605c 6d61 7468 726d 7b44 656c 7461  h:`\mathrm{Delta
+0000ba20: 467d 5b6b 2c6c 5d20 3d20 465b 6c5d 202d  F}[k,l] = F[l] -
+0000ba30: 2046 5b6b 5d60 202e 0a0a 2020 2020 2020   F[k]` ...      
+0000ba40: 2020 2020 2020 2a2a 4465 6c74 6146 5f73        **DeltaF_s
+0000ba50: 7464 2a2a 202d 2074 6865 2073 7461 6e64  td** - the stand
+0000ba60: 6172 6420 6465 7669 6174 696f 6e20 6f66  ard deviation of
+0000ba70: 2074 6865 2066 7265 6520 656e 6572 6779   the free energy
+0000ba80: 2064 6966 6665 7265 6e63 652e 0a20 2020   difference..   
+0000ba90: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
+0000baa0: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+0000bab0: 656e 6572 6779 5f70 6572 7475 7262 6564  energy_perturbed
+0000bac0: 2c20 6e70 2e6e 6461 7272 6179 293a 0a20  , np.ndarray):. 
+0000bad0: 2020 2020 2020 2020 2020 2065 6e65 7267             energ
+0000bae0: 795f 7065 7274 7572 6265 6420 3d20 656e  y_perturbed = en
+0000baf0: 6572 6779 5f70 6572 7475 7262 6564 2e61  ergy_perturbed.a
+0000bb00: 7374 7970 6528 6e70 2e66 6c6f 6174 3634  stype(np.float64
+0000bb10: 290a 2020 2020 2020 2020 2020 2020 656e  ).            en
+0000bb20: 6572 6779 5f70 6572 7475 7262 6564 203d  ergy_perturbed =
+0000bb30: 2074 6f72 6368 2e66 726f 6d5f 6e75 6d70   torch.from_nump
+0000bb40: 7928 656e 6572 6779 5f70 6572 7475 7262  y(energy_perturb
+0000bb50: 6564 290a 2020 2020 2020 2020 656c 6966  ed).        elif
+0000bb60: 2069 7369 6e73 7461 6e63 6528 656e 6572   isinstance(ener
+0000bb70: 6779 5f70 6572 7475 7262 6564 2c20 746f  gy_perturbed, to
+0000bb80: 7263 682e 5465 6e73 6f72 293a 0a20 2020  rch.Tensor):.   
+0000bb90: 2020 2020 2020 2020 2065 6e65 7267 795f           energy_
+0000bba0: 7065 7274 7572 6265 6420 3d20 656e 6572  perturbed = ener
+0000bbb0: 6779 5f70 6572 7475 7262 6564 2e64 6f75  gy_perturbed.dou
+0000bbc0: 626c 6528 290a 2020 2020 2020 2020 656c  ble().        el
+0000bbd0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+0000bbe0: 7261 6973 6520 5479 7065 4572 726f 7228  raise TypeError(
+0000bbf0: 2265 6e65 7267 795f 7065 7274 7572 6265  "energy_perturbe
+0000bc00: 6420 6861 7320 746f 2062 6520 6120 322d  d has to be a 2-
+0000bc10: 4420 6e64 6172 7261 7920 6f72 2061 2032  D ndarray or a 2
+0000bc20: 2d44 2074 656e 736f 722e 2229 0a0a 2020  -D tensor.")..  
+0000bc30: 2020 2020 2020 6966 2065 6e65 7267 795f        if energy_
+0000bc40: 7065 7274 7572 6265 642e 6e64 696d 2021  perturbed.ndim !
+0000bc50: 3d20 323a 0a20 2020 2020 2020 2020 2020  = 2:.           
+0000bc60: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+0000bc70: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
+0000bc80: 2020 2022 656e 6572 6779 5f70 6572 7475     "energy_pertu
+0000bc90: 7262 6564 2068 6173 2074 6f20 6265 2061  rbed has to be a
+0000bca0: 2032 2d44 206e 6461 7272 6179 206f 7220   2-D ndarray or 
+0000bcb0: 6120 322d 4420 7465 6e73 6f72 2e22 0a20  a 2-D tensor.". 
+0000bcc0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+0000bcd0: 2020 2020 2069 6620 656e 6572 6779 5f70       if energy_p
+0000bce0: 6572 7475 7262 6564 2e73 6861 7065 5b31  erturbed.shape[1
+0000bcf0: 5d20 213d 2073 656c 662e 656e 6572 6779  ] != self.energy
+0000bd00: 2e73 6861 7065 5b31 5d3a 0a20 2020 2020  .shape[1]:.     
+0000bd10: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+0000bd20: 7565 4572 726f 7228 0a20 2020 2020 2020  ueError(.       
+0000bd30: 2020 2020 2020 2020 2022 7468 6520 6e75           "the nu
+0000bd40: 6d62 6572 206f 6620 636f 6c75 6d6e 7320  mber of columns 
+0000bd50: 696e 2065 6e65 7267 795f 7065 7274 7572  in energy_pertur
+0000bd60: 6265 6420 6861 7320 746f 2062 6520 6571  bed has to be eq
+0000bd70: 7561 6c20 746f 2074 6865 206e 756d 6265  ual to the numbe
+0000bd80: 7220 6f66 2063 6f6c 756d 6e73 2069 6e20  r of columns in 
+0000bd90: 656e 6572 6779 2e22 0a20 2020 2020 2020  energy.".       
+0000bda0: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+0000bdb0: 4c20 3d20 656e 6572 6779 5f70 6572 7475  L = energy_pertu
+0000bdc0: 7262 6564 2e73 6861 7065 5b30 5d0a 0a20  rbed.shape[0].. 
+0000bdd0: 2020 2020 2020 2046 203d 204e 6f6e 650a         F = None.
+0000bde0: 2020 2020 2020 2020 465f 636f 7620 3d20          F_cov = 
+0000bdf0: 4e6f 6e65 0a20 2020 2020 2020 2046 5f73  None.        F_s
+0000be00: 7464 203d 204e 6f6e 650a 0a20 2020 2020  td = None..     
+0000be10: 2020 2069 6620 6e6f 7420 7365 6c66 2e62     if not self.b
+0000be20: 6f6f 7473 7472 6170 3a0a 2020 2020 2020  ootstrap:.      
+0000be30: 2020 2020 2020 6475 203d 2065 6e65 7267        du = energ
+0000be40: 795f 7065 7274 7572 6265 6420 2b20 7365  y_perturbed + se
+0000be50: 6c66 2e5f 6c6f 675f 7072 6f62 5f6d 6978  lf._log_prob_mix
+0000be60: 0a20 2020 2020 2020 2020 2020 2046 203d  .            F =
+0000be70: 202d 746f 7263 682e 6c6f 6773 756d 6578   -torch.logsumex
+0000be80: 7028 2d64 752c 2064 696d 3d31 290a 0a20  p(-du, dim=1).. 
+0000be90: 2020 2020 2020 2020 2020 2046 5f65 7874             F_ext
+0000bea0: 203d 2074 6f72 6368 2e63 6174 285b 7365   = torch.cat([se
+0000beb0: 6c66 2e5f 462c 2046 5d29 0a20 2020 2020  lf._F, F]).     
+0000bec0: 2020 2020 2020 2055 203d 2074 6f72 6368         U = torch
+0000bed0: 2e63 6174 285b 7365 6c66 2e65 6e65 7267  .cat([self.energ
+0000bee0: 792c 2065 6e65 7267 795f 7065 7274 7572  y, energy_pertur
+0000bef0: 6265 645d 2c20 6469 6d3d 3029 2e74 2829  bed], dim=0).t()
+0000bf00: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0000bf10: 662e 5f50 203d 2074 6f72 6368 2e65 7870  f._P = torch.exp
+0000bf20: 282d 2855 202d 2046 5f65 7874 202b 2073  (-(U - F_ext + s
+0000bf30: 656c 662e 5f6c 6f67 5f70 726f 625f 6d69  elf._log_prob_mi
+0000bf40: 785b 3a2c 204e 6f6e 655d 2929 0a0a 2020  x[:, None]))..  
+0000bf50: 2020 2020 2020 2020 2020 5720 3d20 746f            W = to
+0000bf60: 7263 682e 6469 6167 2874 6f72 6368 2e63  rch.diag(torch.c
+0000bf70: 6174 285b 7365 6c66 2e6e 756d 5f63 6f6e  at([self.num_con
+0000bf80: 662c 2073 656c 662e 6e75 6d5f 636f 6e66  f, self.num_conf
+0000bf90: 2e6e 6577 5f7a 6572 6f73 284c 295d 2929  .new_zeros(L)]))
+0000bfa0: 0a20 2020 2020 2020 2020 2020 2051 2c20  .            Q, 
+0000bfb0: 5220 3d20 746f 7263 682e 6c69 6e61 6c67  R = torch.linalg
+0000bfc0: 2e71 7228 7365 6c66 2e5f 5029 0a20 2020  .qr(self._P).   
+0000bfd0: 2020 2020 2020 2020 2041 203d 2074 6f72           A = tor
+0000bfe0: 6368 2e65 7965 2873 656c 662e 4d20 2b20  ch.eye(self.M + 
+0000bff0: 4c2c 2064 6576 6963 653d 572e 6465 7669  L, device=W.devi
+0000c000: 6365 2920 2d20 5220 4020 5720 4020 522e  ce) - R @ W @ R.
+0000c010: 540a 2020 2020 2020 2020 2020 2020 465f  T.            F_
+0000c020: 636f 7620 3d20 522e 5420 4020 746f 7263  cov = R.T @ torc
+0000c030: 682e 6c69 6e61 6c67 2e70 696e 7628 412c  h.linalg.pinv(A,
+0000c040: 2068 6572 6d69 7469 616e 3d54 7275 652c   hermitian=True,
+0000c050: 2072 746f 6c3d 3165 2d38 2920 4020 520a   rtol=1e-8) @ R.
+0000c060: 0a20 2020 2020 2020 2020 2020 2046 5f63  .            F_c
+0000c070: 6f76 203d 2046 5f63 6f76 5b73 656c 662e  ov = F_cov[self.
+0000c080: 4d20 3a2c 2073 656c 662e 4d20 3a5d 0a20  M :, self.M :]. 
+0000c090: 2020 2020 2020 2020 2020 2046 5f73 7464             F_std
+0000c0a0: 203d 2046 5f63 6f76 2e64 6961 676f 6e61   = F_cov.diagona
+0000c0b0: 6c28 292e 7371 7274 2829 0a0a 2020 2020  l().sqrt()..    
+0000c0c0: 2020 2020 2020 2020 4465 6c74 6146 203d          DeltaF =
+0000c0d0: 2046 5b4e 6f6e 652c 203a 5d20 2d20 465b   F[None, :] - F[
+0000c0e0: 3a2c 204e 6f6e 655d 0a20 2020 2020 2020  :, None].       
+0000c0f0: 2020 2020 2044 656c 7461 465f 636f 7620       DeltaF_cov 
+0000c100: 3d20 465f 636f 762e 6469 6167 2829 5b3a  = F_cov.diag()[:
+0000c110: 2c20 4e6f 6e65 5d20 2b20 465f 636f 762e  , None] + F_cov.
+0000c120: 6469 6167 2829 5b4e 6f6e 652c 203a 5d20  diag()[None, :] 
+0000c130: 2d20 3220 2a20 465f 636f 760a 2020 2020  - 2 * F_cov.    
+0000c140: 2020 2020 2020 2020 4465 6c74 6146 5f73          DeltaF_s
+0000c150: 7464 203d 2044 656c 7461 465f 636f 762e  td = DeltaF_cov.
+0000c160: 7371 7274 2829 0a20 2020 2020 2020 2065  sqrt().        e
+0000c170: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+0000c180: 2046 5f6c 6973 7420 3d20 5b5d 0a20 2020   F_list = [].   
+0000c190: 2020 2020 2020 2020 2066 6f72 206b 2069           for k i
+0000c1a0: 6e20 7261 6e67 6528 7365 6c66 2e62 6f6f  n range(self.boo
+0000c1b0: 7473 7472 6170 5f6e 756d 5f72 6570 293a  tstrap_num_rep):
+0000c1c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000c1d0: 2064 7520 3d20 656e 6572 6779 5f70 6572   du = energy_per
+0000c1e0: 7475 7262 6564 5b3a 2c20 7365 6c66 2e5f  turbed[:, self._
+0000c1f0: 636f 6e66 5f69 6478 5b6b 5d5d 202b 2073  conf_idx[k]] + s
+0000c200: 656c 662e 5f6c 6f67 5f70 726f 625f 6d69  elf._log_prob_mi
+0000c210: 785b 6b5d 0a20 2020 2020 2020 2020 2020  x[k].           
+0000c220: 2020 2020 2046 203d 202d 746f 7263 682e       F = -torch.
+0000c230: 6c6f 6773 756d 6578 7028 2d64 752c 2064  logsumexp(-du, d
+0000c240: 696d 3d31 290a 2020 2020 2020 2020 2020  im=1).          
+0000c250: 2020 2020 2020 465f 6c69 7374 2e61 7070        F_list.app
+0000c260: 656e 6428 4629 0a20 2020 2020 2020 2020  end(F).         
+0000c270: 2020 2046 5f6c 6973 7420 3d20 746f 7263     F_list = torc
+0000c280: 682e 7374 6163 6b28 465f 6c69 7374 2c20  h.stack(F_list, 
+0000c290: 6469 6d3d 3129 0a20 2020 2020 2020 2020  dim=1).         
+0000c2a0: 2020 2046 203d 2074 6f72 6368 2e6d 6561     F = torch.mea
+0000c2b0: 6e28 465f 6c69 7374 2c20 6469 6d3d 3129  n(F_list, dim=1)
+0000c2c0: 0a20 2020 2020 2020 2020 2020 2046 5f73  .            F_s
+0000c2d0: 7464 203d 2074 6f72 6368 2e73 7464 2846  td = torch.std(F
+0000c2e0: 5f6c 6973 742c 2064 696d 3d31 290a 2020  _list, dim=1).  
+0000c2f0: 2020 2020 2020 2020 2020 465f 636f 7620            F_cov 
+0000c300: 3d20 746f 7263 682e 636f 7628 465f 6c69  = torch.cov(F_li
+0000c310: 7374 290a 0a20 2020 2020 2020 2020 2020  st)..           
+0000c320: 2044 656c 7461 4620 3d20 465b 4e6f 6e65   DeltaF = F[None
+0000c330: 2c20 3a5d 202d 2046 5b3a 2c20 4e6f 6e65  , :] - F[:, None
+0000c340: 5d0a 2020 2020 2020 2020 2020 2020 4465  ].            De
+0000c350: 6c74 6146 5f73 7464 203d 2074 6f72 6368  ltaF_std = torch
+0000c360: 2e73 7464 2846 5f6c 6973 745b 3a2c 203a  .std(F_list[:, :
+0000c370: 2c20 4e6f 6e65 5d20 2d20 465f 6c69 7374  , None] - F_list
+0000c380: 5b3a 2c20 4e6f 6e65 2c20 3a5d 2c20 6469  [:, None, :], di
+0000c390: 6d3d 3129 0a0a 2020 2020 2020 2020 7265  m=1)..        re
+0000c3a0: 7375 6c74 7320 3d20 7b0a 2020 2020 2020  sults = {.      
+0000c3b0: 2020 2020 2020 2246 223a 2046 2e6e 756d        "F": F.num
+0000c3c0: 7079 2829 2c0a 2020 2020 2020 2020 2020  py(),.          
+0000c3d0: 2020 2246 5f73 7464 223a 2046 5f73 7464    "F_std": F_std
+0000c3e0: 2e6e 756d 7079 2829 2c0a 2020 2020 2020  .numpy(),.      
+0000c3f0: 2020 2020 2020 2246 5f63 6f76 223a 2046        "F_cov": F
+0000c400: 5f63 6f76 2e6e 756d 7079 2829 2c0a 2020  _cov.numpy(),.  
+0000c410: 2020 2020 2020 2020 2020 2244 656c 7461            "Delta
+0000c420: 4622 3a20 4465 6c74 6146 2e6e 756d 7079  F": DeltaF.numpy
+0000c430: 2829 2c0a 2020 2020 2020 2020 2020 2020  (),.            
+0000c440: 2244 656c 7461 465f 7374 6422 3a20 4465  "DeltaF_std": De
+0000c450: 6c74 6146 5f73 7464 2e6e 756d 7079 2829  ltaF_std.numpy()
+0000c460: 2c0a 2020 2020 2020 2020 7d0a 0a20 2020  ,.        }..   
+0000c470: 2020 2020 2072 6574 7572 6e20 7265 7375       return resu
+0000c480: 6c74 730a 0a64 6566 205f 636f 6d70 7574  lts..def _comput
+0000c490: 655f 6c6f 6770 5f6f 665f 4628 462c 2065  e_logp_of_F(F, e
+0000c4a0: 6e65 7267 792c 206e 756d 5f63 6f6e 6629  nergy, num_conf)
+0000c4b0: 3a0a 2020 2020 6c6f 6770 203d 2028 0a20  :.    logp = (. 
+0000c4c0: 2020 2020 2020 2074 6f72 6368 2e73 756d         torch.sum
+0000c4d0: 286e 756d 5f63 6f6e 6620 2a20 4629 0a20  (num_conf * F). 
+0000c4e0: 2020 2020 2020 202d 2074 6f72 6368 2e6c         - torch.l
+0000c4f0: 6f67 7375 6d65 7870 282d 2865 6e65 7267  ogsumexp(-(energ
+0000c500: 792e 5420 2d20 746f 7263 682e 6c6f 6728  y.T - torch.log(
+0000c510: 6e75 6d5f 636f 6e66 2920 2d20 4629 2c20  num_conf) - F), 
+0000c520: 6469 6d3d 3129 2e73 756d 2829 0a20 2020  dim=1).sum().   
+0000c530: 2029 0a20 2020 2072 6574 7572 6e20 6c6f   ).    return lo
+0000c540: 6770 0a0a 0a64 6566 205f 636f 6d70 7574  gp...def _comput
+0000c550: 655f 6c6f 7373 5f61 6e64 5f67 7261 645f  e_loss_and_grad_
+0000c560: 6f66 5f64 4628 6446 2c20 656e 6572 6779  of_dF(dF, energy
+0000c570: 2c20 6e75 6d5f 636f 6e66 293a 0a20 2020  , num_conf):.   
+0000c580: 2022 2222 436f 6d70 7574 6520 7468 6520   """Compute the 
+0000c590: 6c6f 7373 2066 756e 6374 696f 6e20 616e  loss function an
+0000c5a0: 6420 7468 6520 6772 6164 6965 6e74 206f  d the gradient o
+0000c5b0: 6620 6446 2067 6976 656e 2065 6e65 7267  f dF given energ
+0000c5c0: 7920 616e 6420 6e75 6d5f 636f 6e66 2e0a  y and num_conf..
+0000c5d0: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
+0000c5e0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
+0000c5f0: 2020 6446 3a20 312d 4420 666c 6f61 7420    dF: 1-D float 
+0000c600: 7465 6e73 6f72 2077 6974 6820 7369 7a65  tensor with size
+0000c610: 2028 4d2d 3129 0a20 2020 2020 2020 2054   (M-1).        T
+0000c620: 6865 2066 7265 6520 656e 6572 6779 2064  he free energy d
+0000c630: 6966 6665 7265 6e63 6520 6265 7477 6565  ifference betwee
+0000c640: 6e20 7374 6174 6520 3020 616e 6420 6f74  n state 0 and ot
+0000c650: 6865 7220 7374 6174 6573 2e20 5468 6520  her states. The 
+0000c660: 656e 7472 790a 2020 2020 2020 2020 6446  entry.        dF
+0000c670: 5b69 5d20 6973 2074 6865 2066 7265 6520  [i] is the free 
+0000c680: 656e 6572 6779 2064 6966 6665 7265 6e63  energy differenc
+0000c690: 6520 6265 7477 6565 6e20 7374 6174 6520  e between state 
+0000c6a0: 3020 616e 6420 7374 6174 6520 692b 312e  0 and state i+1.
+0000c6b0: 0a20 2020 2065 6e65 7267 793a 2032 2d44  .    energy: 2-D
+0000c6c0: 2066 6c6f 6174 2074 656e 736f 7220 7769   float tensor wi
+0000c6d0: 7468 2073 697a 6520 284d 2078 204e 290a  th size (M x N).
+0000c6e0: 2020 2020 2020 2020 4120 322d 4420 7465          A 2-D te
+0000c6f0: 6e73 6f72 2077 6974 6820 7369 7a65 206f  nsor with size o
+0000c700: 6620 4d20 7820 4e2c 2077 6865 7265 204d  f M x N, where M
+0000c710: 2069 7320 7468 6520 6e75 6d62 6572 206f   is the number o
+0000c720: 6620 7374 6174 730a 2020 2020 2020 2020  f stats.        
+0000c730: 616e 6420 4e20 6973 2074 6865 2074 6f74  and N is the tot
+0000c740: 616c 206e 756d 6265 7220 6f66 2063 6f6e  al number of con
+0000c750: 666f 726d 6174 696f 6e73 2e20 5468 6520  formations. The 
+0000c760: 656e 7472 7920 656e 6572 6779 5b69 2c6a  entry energy[i,j
+0000c770: 5d0a 2020 2020 6e75 6d5f 636f 6e66 3a20  ].    num_conf: 
+0000c780: 312d 4420 696e 7420 7465 6e73 6f72 2077  1-D int tensor w
+0000c790: 6974 6820 7369 7a65 2028 4d29 0a20 2020  ith size (M).   
+0000c7a0: 2020 2020 2041 2031 2d44 2074 656e 736f       A 1-D tenso
+0000c7b0: 7220 7769 7468 2073 697a 6520 6f66 204d  r with size of M
+0000c7c0: 2c20 7768 6572 6520 6e75 6d5f 636f 6e66  , where num_conf
+0000c7d0: 5b69 5d20 6973 2074 6865 206e 756d 206f  [i] is the num o
+0000c7e0: 660a 2020 2020 2020 2020 636f 6e66 6f72  f.        confor
+0000c7f0: 6d61 7469 6f6e 7320 7361 6d70 6c65 6420  mations sampled 
+0000c800: 6672 6f6d 2073 7461 7465 2069 2e20 5468  from state i. Th
+0000c810: 6572 6566 6f72 652c 2074 6f72 6368 2e73  erefore, torch.s
+0000c820: 756d 286e 756d 5f63 6f6e 6629 0a20 2020  um(num_conf).   
+0000c830: 2020 2020 2068 6173 2074 6f20 6265 2065       has to be e
+0000c840: 7175 616c 2074 6f20 4e2e 2041 6c6c 2065  qual to N. All e
+0000c850: 6e74 7269 6573 2069 6e20 6e75 6d5f 636f  ntries in num_co
+0000c860: 6e66 2068 6176 6520 746f 2062 6520 7374  nf have to be st
+0000c870: 7269 6374 6c79 0a20 2020 2020 2020 2067  rictly.        g
+0000c880: 7265 6174 6572 2074 6861 6e20 302e 0a20  reater than 0.. 
+0000c890: 2020 2022 2222 0a0a 2020 2020 2320 636f     """..    # co
+0000c8a0: 6d70 7574 6520 7468 6520 6c6f 7373 2066  mpute the loss f
+0000c8b0: 756e 6374 696f 6e0a 2020 2020 4620 3d20  unction.    F = 
+0000c8c0: 746f 7263 682e 6361 7428 5b64 462e 6e65  torch.cat([dF.ne
+0000c8d0: 775f 7a65 726f 7328 3129 2c20 6446 5d29  w_zeros(1), dF])
+0000c8e0: 0a20 2020 206c 6f67 7020 3d20 5f63 6f6d  .    logp = _com
+0000c8f0: 7075 7465 5f6c 6f67 705f 6f66 5f46 2846  pute_logp_of_F(F
+0000c900: 2c20 656e 6572 6779 2c20 6e75 6d5f 636f  , energy, num_co
+0000c910: 6e66 290a 2020 2020 6c6f 7373 203d 202d  nf).    loss = -
+0000c920: 6c6f 6770 202f 206e 756d 5f63 6f6e 662e  logp / num_conf.
+0000c930: 7375 6d28 290a 2020 2020 7520 3d20 656e  sum().    u = en
+0000c940: 6572 6779 202d 2046 5b3a 2c20 4e6f 6e65  ergy - F[:, None
+0000c950: 5d20 2d20 746f 7263 682e 6c6f 6728 6e75  ] - torch.log(nu
+0000c960: 6d5f 636f 6e66 295b 3a2c 204e 6f6e 655d  m_conf)[:, None]
+0000c970: 0a0a 2020 2020 2320 636f 6d70 7574 6520  ..    # compute 
+0000c980: 7468 6520 6772 6164 6965 6e74 206f 6620  the gradient of 
+0000c990: 7468 6520 6c6f 7373 2066 756e 6374 696f  the loss functio
+0000c9a0: 6e0a 2020 2020 7020 3d20 746f 7263 682e  n.    p = torch.
+0000c9b0: 736f 6674 6d61 7828 2d75 2c20 6469 6d3d  softmax(-u, dim=
+0000c9c0: 3029 0a20 2020 2067 7261 6420 3d20 746f  0).    grad = to
+0000c9d0: 7263 682e 6d65 616e 2870 2c20 6469 6d3d  rch.mean(p, dim=
+0000c9e0: 3129 202d 206e 756d 5f63 6f6e 6620 2f20  1) - num_conf / 
+0000c9f0: 6e75 6d5f 636f 6e66 2e73 756d 2829 0a20  num_conf.sum(). 
+0000ca00: 2020 2067 7261 6420 3d20 6772 6164 5b31     grad = grad[1
+0000ca10: 3a5d 0a0a 2020 2020 7265 7475 726e 206c  :]..    return l
+0000ca20: 6f73 732c 2067 7261 640a 0a0a 6465 6620  oss, grad...def 
+0000ca30: 5f63 6f6d 7075 7465 5f6c 6f73 735f 616e  _compute_loss_an
+0000ca40: 645f 6772 6164 5f6f 665f 6446 5f69 6e5f  d_grad_of_dF_in_
+0000ca50: 6261 7463 6828 6446 2c20 656e 6572 6779  batch(dF, energy
+0000ca60: 2c20 6e75 6d5f 636f 6e66 2c20 6261 7463  , num_conf, batc
+0000ca70: 685f 7369 7a65 3a20 696e 7429 3a0a 2020  h_size: int):.  
+0000ca80: 2020 2222 2254 6869 7320 6973 2074 6865    """This is the
+0000ca90: 2062 6174 6368 2076 6572 7369 6f6e 206f   batch version o
+0000caa0: 6620 5f63 6f6d 7075 7465 5f6c 6f73 735f  f _compute_loss_
+0000cab0: 616e 645f 6772 6164 5f6f 665f 6446 2e0a  and_grad_of_dF..
+0000cac0: 2020 2020 5468 6520 6261 7463 6820 7665      The batch ve
+0000cad0: 7273 696f 6e20 6973 2075 7365 6420 7768  rsion is used wh
+0000cae0: 656e 2074 6865 2073 697a 6520 6f66 2065  en the size of e
+0000caf0: 6e65 7267 7920 6973 2074 6f6f 206c 6172  nergy is too lar
+0000cb00: 6765 2074 6f20 6669 7420 696e 746f 2074  ge to fit into t
+0000cb10: 6865 0a20 2020 206d 656d 6f72 7920 6f66  he.    memory of
+0000cb20: 2061 2047 5055 2e20 5468 6520 656e 6572   a GPU. The ener
+0000cb30: 6779 206d 6174 7269 7820 6973 2073 706c  gy matrix is spl
+0000cb40: 6974 2069 6e74 6f20 6d75 6c74 6970 6c65  it into multiple
+0000cb50: 2062 6174 6368 6573 2061 6e64 2074 6865   batches and the
+0000cb60: 0a20 2020 2063 616c 6375 6c61 7469 6f6e  .    calculation
+0000cb70: 2069 7320 646f 6e65 2073 6571 7565 6e74   is done sequent
+0000cb80: 6961 6c6c 792e 0a0a 2020 2020 5468 6520  ially...    The 
+0000cb90: 7061 7261 6d65 7465 7273 2061 7265 2074  parameters are t
+0000cba0: 6865 2073 616d 6520 6173 205f 636f 6d70  he same as _comp
+0000cbb0: 7574 655f 6c6f 7373 5f61 6e64 5f67 7261  ute_loss_and_gra
+0000cbc0: 645f 6f66 5f64 462e 0a20 2020 2022 2222  d_of_dF..    """
+0000cbd0: 0a0a 2020 2020 6e20 3d20 6e75 6d5f 636f  ..    n = num_co
+0000cbe0: 6e66 0a20 2020 204e 203d 2074 6f72 6368  nf.    N = torch
+0000cbf0: 2e73 756d 286e 290a 2020 2020 6e5f 6f76  .sum(n).    n_ov
+0000cc00: 6572 5f4e 203d 206e 202f 204e 0a0a 2020  er_N = n / N..  
+0000cc10: 2020 6966 2065 6e65 7267 792e 7368 6170    if energy.shap
+0000cc20: 655b 315d 2025 2062 6174 6368 5f73 697a  e[1] % batch_siz
+0000cc30: 6520 3d3d 2030 3a0a 2020 2020 2020 2020  e == 0:.        
+0000cc40: 6e75 6d5f 6261 7463 6820 3d20 656e 6572  num_batch = ener
+0000cc50: 6779 2e73 6861 7065 5b31 5d20 2f2f 2062  gy.shape[1] // b
+0000cc60: 6174 6368 5f73 697a 650a 2020 2020 656c  atch_size.    el
+0000cc70: 7365 3a0a 2020 2020 2020 2020 6e75 6d5f  se:.        num_
+0000cc80: 6261 7463 6820 3d20 656e 6572 6779 2e73  batch = energy.s
+0000cc90: 6861 7065 5b31 5d20 2f2f 2062 6174 6368  hape[1] // batch
+0000cca0: 5f73 697a 6520 2b20 310a 0a20 2020 2046  _size + 1..    F
+0000ccb0: 203d 2074 6f72 6368 2e63 6174 285b 6446   = torch.cat([dF
+0000ccc0: 2e6e 6577 5f7a 6572 6f73 2831 292c 2064  .new_zeros(1), d
+0000ccd0: 465d 290a 2020 2020 6c6f 7373 203d 202d  F]).    loss = -
+0000cce0: 746f 7263 682e 7375 6d28 6e75 6d5f 636f  torch.sum(num_co
+0000ccf0: 6e66 202a 2046 290a 2020 2020 6772 6164  nf * F).    grad
+0000cd00: 203d 202d 6e75 6d5f 636f 6e66 0a0a 2020   = -num_conf..  
+0000cd10: 2020 666f 7220 6920 696e 2072 616e 6765    for i in range
+0000cd20: 286e 756d 5f62 6174 6368 293a 0a20 2020  (num_batch):.   
+0000cd30: 2020 2020 2065 6e65 7267 795f 6261 7463       energy_batc
+0000cd40: 6820 3d20 656e 6572 6779 5b3a 2c20 6920  h = energy[:, i 
+0000cd50: 2a20 6261 7463 685f 7369 7a65 203a 2028  * batch_size : (
+0000cd60: 6920 2b20 3129 202a 2062 6174 6368 5f73  i + 1) * batch_s
+0000cd70: 697a 655d 0a20 2020 2020 2020 2075 203d  ize].        u =
+0000cd80: 2065 6e65 7267 795f 6261 7463 682e 6375   energy_batch.cu
+0000cd90: 6461 2829 202d 2074 6f72 6368 2e6c 6f67  da() - torch.log
+0000cda0: 286e 756d 5f63 6f6e 6629 5b3a 2c20 4e6f  (num_conf)[:, No
+0000cdb0: 6e65 5d20 2d20 465b 3a2c 204e 6f6e 655d  ne] - F[:, None]
+0000cdc0: 0a20 2020 2020 2020 206c 6f73 7320 2b3d  .        loss +=
+0000cdd0: 2074 6f72 6368 2e6c 6f67 7375 6d65 7870   torch.logsumexp
+0000cde0: 282d 752c 2064 696d 3d30 292e 7375 6d28  (-u, dim=0).sum(
+0000cdf0: 290a 0a20 2020 2020 2020 2070 203d 2074  )..        p = t
+0000ce00: 6f72 6368 2e73 6f66 746d 6178 282d 752c  orch.softmax(-u,
+0000ce10: 2064 696d 3d30 290a 2020 2020 2020 2020   dim=0).        
+0000ce20: 6772 6164 202b 3d20 746f 7263 682e 7375  grad += torch.su
+0000ce30: 6d28 702c 2064 696d 3d31 290a 0a20 2020  m(p, dim=1)..   
+0000ce40: 206c 6f73 7320 3d20 6c6f 7373 202f 204e   loss = loss / N
+0000ce50: 0a20 2020 2067 7261 6420 3d20 6772 6164  .    grad = grad
+0000ce60: 202f 204e 0a20 2020 2067 7261 6420 3d20   / N.    grad = 
+0000ce70: 6772 6164 5b31 3a5d 0a20 2020 2072 6574  grad[1:].    ret
+0000ce80: 7572 6e20 6c6f 7373 2c20 6772 6164 0a0a  urn loss, grad..
+0000ce90: 0a64 6566 205f 636f 6d70 7574 655f 6865  .def _compute_he
+0000cea0: 7373 6961 6e5f 6c6f 675f 6c69 6b65 6c69  ssian_log_likeli
+0000ceb0: 686f 6f64 5f6f 665f 4628 462c 2065 6e65  hood_of_F(F, ene
+0000cec0: 7267 792c 206e 756d 5f63 6f6e 6629 3a0a  rgy, num_conf):.
+0000ced0: 2020 2020 7520 3d20 656e 6572 6779 202d      u = energy -
+0000cee0: 2046 5b3a 2c20 4e6f 6e65 5d20 2d20 746f   F[:, None] - to
+0000cef0: 7263 682e 6c6f 6728 6e75 6d5f 636f 6e66  rch.log(num_conf
+0000cf00: 295b 3a2c 204e 6f6e 655d 0a20 2020 2070  )[:, None].    p
+0000cf10: 203d 2074 6f72 6368 2e73 6f66 746d 6178   = torch.softmax
+0000cf20: 282d 752c 2064 696d 3d30 290a 2020 2020  (-u, dim=0).    
+0000cf30: 7070 203d 2074 6f72 6368 2e6d 6174 6d75  pp = torch.matmu
+0000cf40: 6c28 702c 2070 2e54 290a 2020 2020 4820  l(p, p.T).    H 
+0000cf50: 3d20 7070 202d 2074 6f72 6368 2e64 6961  = pp - torch.dia
+0000cf60: 6728 746f 7263 682e 7375 6d28 702c 2031  g(torch.sum(p, 1
+0000cf70: 2929 0a20 2020 2072 6574 7572 6e20 480a  )).    return H.
+0000cf80: 0a0a 6465 6620 5f63 6f6d 7075 7465 5f68  ..def _compute_h
+0000cf90: 6573 7369 616e 5f6c 6f67 5f6c 696b 656c  essian_log_likel
+0000cfa0: 6968 6f6f 645f 6f66 5f46 5f69 6e5f 6261  ihood_of_F_in_ba
+0000cfb0: 7463 6828 462c 2065 6e65 7267 792c 206e  tch(F, energy, n
+0000cfc0: 756d 5f63 6f6e 662c 2062 6174 6368 5f73  um_conf, batch_s
+0000cfd0: 697a 653a 2069 6e74 293a 0a20 2020 2069  ize: int):.    i
+0000cfe0: 6620 656e 6572 6779 2e73 6861 7065 5b31  f energy.shape[1
+0000cff0: 5d20 2520 6261 7463 685f 7369 7a65 203d  ] % batch_size =
+0000d000: 3d20 303a 0a20 2020 2020 2020 206e 756d  = 0:.        num
+0000d010: 5f62 6174 6368 203d 2065 6e65 7267 792e  _batch = energy.
+0000d020: 7368 6170 655b 315d 202f 2f20 6261 7463  shape[1] // batc
+0000d030: 685f 7369 7a65 0a20 2020 2065 6c73 653a  h_size.    else:
+0000d040: 0a20 2020 2020 2020 206e 756d 5f62 6174  .        num_bat
+0000d050: 6368 203d 2065 6e65 7267 792e 7368 6170  ch = energy.shap
+0000d060: 655b 315d 202f 2f20 6261 7463 685f 7369  e[1] // batch_si
+0000d070: 7a65 202b 2031 0a0a 2020 2020 4820 3d20  ze + 1..    H = 
+0000d080: 462e 6e65 775f 7a65 726f 7328 2846 2e73  F.new_zeros((F.s
+0000d090: 6861 7065 5b30 5d2c 2046 2e73 6861 7065  hape[0], F.shape
+0000d0a0: 5b30 5d29 292e 6375 6461 2829 0a20 2020  [0])).cuda().   
+0000d0b0: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
+0000d0c0: 6e75 6d5f 6261 7463 6829 3a0a 2020 2020  num_batch):.    
+0000d0d0: 2020 2020 656e 6572 6779 5f62 6174 6368      energy_batch
+0000d0e0: 203d 2065 6e65 7267 795b 3a2c 2069 202a   = energy[:, i *
+0000d0f0: 2062 6174 6368 5f73 697a 6520 3a20 2869   batch_size : (i
+0000d100: 202b 2031 2920 2a20 6261 7463 685f 7369   + 1) * batch_si
+0000d110: 7a65 5d0a 2020 2020 2020 2020 7520 3d20  ze].        u = 
+0000d120: 656e 6572 6779 5f62 6174 6368 2e63 7564  energy_batch.cud
+0000d130: 6128 2920 2d20 465b 3a2c 204e 6f6e 655d  a() - F[:, None]
+0000d140: 202d 2074 6f72 6368 2e6c 6f67 286e 756d   - torch.log(num
+0000d150: 5f63 6f6e 6629 5b3a 2c20 4e6f 6e65 5d0a  _conf)[:, None].
+0000d160: 0a20 2020 2020 2020 2070 203d 2074 6f72  .        p = tor
+0000d170: 6368 2e73 6f66 746d 6178 282d 752c 2064  ch.softmax(-u, d
+0000d180: 696d 3d30 290a 2020 2020 2020 2020 7070  im=0).        pp
+0000d190: 203d 2074 6f72 6368 2e6d 6174 6d75 6c28   = torch.matmul(
+0000d1a0: 702c 2070 2e54 290a 2020 2020 2020 2020  p, p.T).        
+0000d1b0: 4820 2b3d 2070 7020 2d20 746f 7263 682e  H += pp - torch.
+0000d1c0: 6469 6167 2874 6f72 6368 2e73 756d 2870  diag(torch.sum(p
+0000d1d0: 2c20 3129 290a 0a20 2020 2072 6574 7572  , 1))..    retur
+0000d1e0: 6e20 480a 0a0a 6465 6620 5f63 6f6d 7075  n H...def _compu
+0000d1f0: 7465 5f68 6573 7369 616e 5f6c 6f73 735f  te_hessian_loss_
+0000d200: 6f66 5f64 4628 6446 2c20 656e 6572 6779  of_dF(dF, energy
+0000d210: 2c20 6e75 6d5f 636f 6e66 293a 0a20 2020  , num_conf):.   
+0000d220: 204e 203d 2074 6f72 6368 2e73 756d 286e   N = torch.sum(n
+0000d230: 756d 5f63 6f6e 6629 0a20 2020 2046 203d  um_conf).    F =
+0000d240: 2074 6f72 6368 2e63 6174 285b 6446 2e6e   torch.cat([dF.n
+0000d250: 6577 5f7a 6572 6f73 2831 292c 2064 465d  ew_zeros(1), dF]
+0000d260: 290a 2020 2020 4820 3d20 5f63 6f6d 7075  ).    H = _compu
+0000d270: 7465 5f68 6573 7369 616e 5f6c 6f67 5f6c  te_hessian_log_l
+0000d280: 696b 656c 6968 6f6f 645f 6f66 5f46 2846  ikelihood_of_F(F
+0000d290: 2c20 656e 6572 6779 2c20 6e75 6d5f 636f  , energy, num_co
+0000d2a0: 6e66 290a 2020 2020 4820 3d20 2d48 5b31  nf).    H = -H[1
+0000d2b0: 3a2c 2031 3a5d 202f 204e 0a20 2020 2072  :, 1:] / N.    r
+0000d2c0: 6574 7572 6e20 480a 0a0a 6465 6620 5f63  eturn H...def _c
+0000d2d0: 6f6d 7075 7465 5f68 6573 7369 616e 5f6c  ompute_hessian_l
+0000d2e0: 6f73 735f 6f66 5f64 465f 696e 5f62 6174  oss_of_dF_in_bat
+0000d2f0: 6368 2864 462c 2065 6e65 7267 792c 206e  ch(dF, energy, n
+0000d300: 756d 5f63 6f6e 662c 2062 6174 6368 5f73  um_conf, batch_s
+0000d310: 697a 653a 2069 6e74 293a 0a20 2020 204e  ize: int):.    N
+0000d320: 203d 2074 6f72 6368 2e73 756d 286e 756d   = torch.sum(num
+0000d330: 5f63 6f6e 6629 0a20 2020 2046 203d 2074  _conf).    F = t
+0000d340: 6f72 6368 2e63 6174 285b 6446 2e6e 6577  orch.cat([dF.new
+0000d350: 5f7a 6572 6f73 2831 292c 2064 465d 290a  _zeros(1), dF]).
+0000d360: 2020 2020 4820 3d20 5f63 6f6d 7075 7465      H = _compute
+0000d370: 5f68 6573 7369 616e 5f6c 6f67 5f6c 696b  _hessian_log_lik
+0000d380: 656c 6968 6f6f 645f 6f66 5f46 5f69 6e5f  elihood_of_F_in_
+0000d390: 6261 7463 6828 462c 2065 6e65 7267 792c  batch(F, energy,
+0000d3a0: 206e 756d 5f63 6f6e 662c 2062 6174 6368   num_conf, batch
+0000d3b0: 5f73 697a 6529 0a20 2020 2048 203d 202d  _size).    H = -
+0000d3c0: 485b 313a 2c20 313a 5d20 2f20 4e0a 2020  H[1:, 1:] / N.  
+0000d3d0: 2020 7265 7475 726e 2048 0a0a 0a64 6566    return H...def
+0000d3e0: 205f 736f 6c76 655f 6d62 6172 2864 465f   _solve_mbar(dF_
+0000d3f0: 696e 6974 2c20 656e 6572 6779 2c20 6e75  init, energy, nu
+0000d400: 6d5f 636f 6e66 2c20 6d65 7468 6f64 2c20  m_conf, method, 
+0000d410: 6261 7463 685f 7369 7a65 3d4e 6f6e 652c  batch_size=None,
+0000d420: 2076 6572 626f 7365 3d46 616c 7365 293a   verbose=False):
+0000d430: 0a20 2020 2069 6620 6261 7463 685f 7369  .    if batch_si
+0000d440: 7a65 2069 7320 6e6f 7420 4e6f 6e65 3a0a  ze is not None:.
+0000d450: 2020 2020 2020 2020 6966 206d 6574 686f          if metho
+0000d460: 6420 3d3d 2022 4e65 7774 6f6e 223a 0a20  d == "Newton":. 
+0000d470: 2020 2020 2020 2020 2020 2072 6573 756c             resul
+0000d480: 7473 203d 2066 6d69 6e5f 6e65 7774 6f6e  ts = fmin_newton
+0000d490: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0000d4a0: 2020 663d 5f63 6f6d 7075 7465 5f6c 6f73    f=_compute_los
+0000d4b0: 735f 616e 645f 6772 6164 5f6f 665f 6446  s_and_grad_of_dF
+0000d4c0: 5f69 6e5f 6261 7463 682c 0a20 2020 2020  _in_batch,.     
+0000d4d0: 2020 2020 2020 2020 2020 2068 6573 733d             hess=
+0000d4e0: 5f63 6f6d 7075 7465 5f68 6573 7369 616e  _compute_hessian
+0000d4f0: 5f6c 6f73 735f 6f66 5f64 465f 696e 5f62  _loss_of_dF_in_b
+0000d500: 6174 6368 2c0a 2020 2020 2020 2020 2020  atch,.          
+0000d510: 2020 2020 2020 785f 696e 6974 3d64 465f        x_init=dF_
+0000d520: 696e 6974 2c0a 2020 2020 2020 2020 2020  init,.          
+0000d530: 2020 2020 2020 6172 6773 3d28 656e 6572        args=(ener
+0000d540: 6779 2c20 6e75 6d5f 636f 6e66 2c20 6261  gy, num_conf, ba
+0000d550: 7463 685f 7369 7a65 292c 0a20 2020 2020  tch_size),.     
+0000d560: 2020 2020 2020 2020 2020 2076 6572 626f             verbo
+0000d570: 7365 3d76 6572 626f 7365 2c0a 2020 2020  se=verbose,.    
+0000d580: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0000d590: 2020 2020 2020 7265 7475 726e 2072 6573        return res
+0000d5a0: 756c 7473 5b22 7822 5d0a 0a20 2020 2020  ults["x"]..     
+0000d5b0: 2020 2065 6c69 6620 6d65 7468 6f64 203d     elif method =
+0000d5c0: 3d20 224c 2d42 4647 532d 4222 3a0a 2020  = "L-BFGS-B":.  
+0000d5d0: 2020 2020 2020 2020 2020 6f70 7469 6f6e            option
+0000d5e0: 7320 3d20 7b22 6469 7370 223a 2076 6572  s = {"disp": ver
+0000d5f0: 626f 7365 2c20 2267 746f 6c22 3a20 3165  bose, "gtol": 1e
+0000d600: 2d38 7d0a 2020 2020 2020 2020 2020 2020  -8}.            
+0000d610: 7265 7375 6c74 7320 3d20 6f70 7469 6d69  results = optimi
+0000d620: 7a65 2e6d 696e 696d 697a 6528 0a20 2020  ze.minimize(.   
+0000d630: 2020 2020 2020 2020 2020 2020 206c 616d               lam
+0000d640: 6264 6120 783a 205b 0a20 2020 2020 2020  bda x: [.       
+0000d650: 2020 2020 2020 2020 2020 2020 2072 2e63               r.c
+0000d660: 7075 2829 2e6e 756d 7079 2829 0a20 2020  pu().numpy().   
+0000d670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d680: 2066 6f72 2072 2069 6e20 5f63 6f6d 7075   for r in _compu
+0000d690: 7465 5f6c 6f73 735f 616e 645f 6772 6164  te_loss_and_grad
+0000d6a0: 5f6f 665f 6446 5f69 6e5f 6261 7463 6828  _of_dF_in_batch(
+0000d6b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000d6c0: 2020 2020 2020 2020 2065 6e65 7267 792e           energy.
+0000d6d0: 6e65 775f 7465 6e73 6f72 2878 292c 2065  new_tensor(x), e
+0000d6e0: 6e65 7267 792c 206e 756d 5f63 6f6e 662c  nergy, num_conf,
+0000d6f0: 2062 6174 6368 5f73 697a 650a 2020 2020   batch_size.    
+0000d700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d710: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0000d720: 2020 5d2c 0a20 2020 2020 2020 2020 2020    ],.           
+0000d730: 2020 2020 2064 465f 696e 6974 2e63 7075       dF_init.cpu
+0000d740: 2829 2e6e 756d 7079 2829 2c0a 2020 2020  ().numpy(),.    
+0000d750: 2020 2020 2020 2020 2020 2020 6a61 633d              jac=
+0000d760: 5472 7565 2c0a 2020 2020 2020 2020 2020  True,.          
+0000d770: 2020 2020 2020 6d65 7468 6f64 3d22 4c2d        method="L-
+0000d780: 4246 4753 2d42 222c 0a20 2020 2020 2020  BFGS-B",.       
+0000d790: 2020 2020 2020 2020 2074 6f6c 3d31 652d           tol=1e-
+0000d7a0: 3132 2c0a 2020 2020 2020 2020 2020 2020  12,.            
+0000d7b0: 2020 2020 6f70 7469 6f6e 733d 6f70 7469      options=opti
+0000d7c0: 6f6e 732c 0a20 2020 2020 2020 2020 2020  ons,.           
+0000d7d0: 2029 0a20 2020 2020 2020 2020 2020 2072   ).            r
+0000d7e0: 6574 7572 6e20 746f 7263 682e 6672 6f6d  eturn torch.from
+0000d7f0: 5f6e 756d 7079 2872 6573 756c 7473 5b22  _numpy(results["
+0000d800: 7822 5d29 0a20 2020 2065 6c73 653a 0a20  x"]).    else:. 
+0000d810: 2020 2020 2020 2069 6620 6d65 7468 6f64         if method
+0000d820: 203d 3d20 224e 6577 746f 6e22 3a0a 2020   == "Newton":.  
+0000d830: 2020 2020 2020 2020 2020 7265 7375 6c74            result
+0000d840: 7320 3d20 666d 696e 5f6e 6577 746f 6e28  s = fmin_newton(
+0000d850: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000d860: 2066 3d5f 636f 6d70 7574 655f 6c6f 7373   f=_compute_loss
+0000d870: 5f61 6e64 5f67 7261 645f 6f66 5f64 462c  _and_grad_of_dF,
+0000d880: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000d890: 2068 6573 733d 5f63 6f6d 7075 7465 5f68   hess=_compute_h
+0000d8a0: 6573 7369 616e 5f6c 6f73 735f 6f66 5f64  essian_loss_of_d
+0000d8b0: 462c 0a20 2020 2020 2020 2020 2020 2020  F,.             
+0000d8c0: 2020 2078 5f69 6e69 743d 6446 5f69 6e69     x_init=dF_ini
+0000d8d0: 742c 0a20 2020 2020 2020 2020 2020 2020  t,.             
+0000d8e0: 2020 2061 7267 733d 2865 6e65 7267 792c     args=(energy,
+0000d8f0: 206e 756d 5f63 6f6e 6629 2c0a 2020 2020   num_conf),.    
+0000d900: 2020 2020 2020 2020 2020 2020 7665 7262              verb
+0000d910: 6f73 653d 7665 7262 6f73 652c 0a20 2020  ose=verbose,.   
+0000d920: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+0000d930: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
+0000d940: 7375 6c74 735b 2278 225d 0a20 2020 2020  sults["x"].     
+0000d950: 2020 2065 6c69 6620 6d65 7468 6f64 203d     elif method =
+0000d960: 3d20 224c 2d42 4647 532d 4222 3a0a 2020  = "L-BFGS-B":.  
+0000d970: 2020 2020 2020 2020 2020 6f70 7469 6f6e            option
+0000d980: 7320 3d20 7b22 6469 7370 223a 2076 6572  s = {"disp": ver
+0000d990: 626f 7365 2c20 2267 746f 6c22 3a20 3165  bose, "gtol": 1e
+0000d9a0: 2d38 7d0a 2020 2020 2020 2020 2020 2020  -8}.            
+0000d9b0: 7265 7375 6c74 7320 3d20 6f70 7469 6d69  results = optimi
+0000d9c0: 7a65 2e6d 696e 696d 697a 6528 0a20 2020  ze.minimize(.   
+0000d9d0: 2020 2020 2020 2020 2020 2020 206c 616d               lam
+0000d9e0: 6264 6120 783a 205b 0a20 2020 2020 2020  bda x: [.       
+0000d9f0: 2020 2020 2020 2020 2020 2020 2072 2e63               r.c
+0000da00: 7075 2829 2e6e 756d 7079 2829 0a20 2020  pu().numpy().   
+0000da10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000da20: 2066 6f72 2072 2069 6e20 5f63 6f6d 7075   for r in _compu
+0000da30: 7465 5f6c 6f73 735f 616e 645f 6772 6164  te_loss_and_grad
+0000da40: 5f6f 665f 6446 280a 2020 2020 2020 2020  _of_dF(.        
+0000da50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000da60: 656e 6572 6779 2e6e 6577 5f74 656e 736f  energy.new_tenso
+0000da70: 7228 7829 2c20 656e 6572 6779 2c20 6e75  r(x), energy, nu
+0000da80: 6d5f 636f 6e66 0a20 2020 2020 2020 2020  m_conf.         
+0000da90: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+0000daa0: 2020 2020 2020 2020 2020 2020 205d 2c0a               ],.
+0000dab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000dac0: 6446 5f69 6e69 742e 6370 7528 292e 6e75  dF_init.cpu().nu
+0000dad0: 6d70 7928 292c 0a20 2020 2020 2020 2020  mpy(),.         
+0000dae0: 2020 2020 2020 206a 6163 3d54 7275 652c         jac=True,
+0000daf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000db00: 206d 6574 686f 643d 224c 2d42 4647 532d   method="L-BFGS-
+0000db10: 4222 2c0a 2020 2020 2020 2020 2020 2020  B",.            
+0000db20: 2020 2020 746f 6c3d 3165 2d31 322c 0a20      tol=1e-12,. 
+0000db30: 2020 2020 2020 2020 2020 2020 2020 206f                 o
+0000db40: 7074 696f 6e73 3d6f 7074 696f 6e73 2c0a  ptions=options,.
+0000db50: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+0000db60: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0000db70: 2074 6f72 6368 2e66 726f 6d5f 6e75 6d70   torch.from_nump
+0000db80: 7928 7265 7375 6c74 735b 2278 225d 290a  y(results["x"]).
+0000db90: 0a0a 6465 6620 5f62 6f6f 7473 7472 6170  ..def _bootstrap
+0000dba0: 5f63 6f6e 665f 6964 7828 6e75 6d5f 636f  _conf_idx(num_co
+0000dbb0: 6e66 2c20 626f 6f74 7374 7261 705f 626c  nf, bootstrap_bl
+0000dbc0: 6f63 6b5f 7369 7a65 293a 0a20 2020 206e  ock_size):.    n
+0000dbd0: 756d 5f63 6f6e 665f 6375 6d73 756d 203d  um_conf_cumsum =
+0000dbe0: 2074 6f72 6368 2e63 756d 7375 6d28 6e75   torch.cumsum(nu
+0000dbf0: 6d5f 636f 6e66 2c20 6469 6d3d 3029 2e74  m_conf, dim=0).t
+0000dc00: 6f6c 6973 7428 290a 2020 2020 6e75 6d5f  olist().    num_
+0000dc10: 636f 6e66 5f63 756d 7375 6d2e 706f 7028  conf_cumsum.pop(
+0000dc20: 2d31 290a 2020 2020 6e75 6d5f 636f 6e66  -1).    num_conf
+0000dc30: 5f63 756d 7375 6d20 3d20 5b30 5d20 2b20  _cumsum = [0] + 
+0000dc40: 6e75 6d5f 636f 6e66 5f63 756d 7375 6d0a  num_conf_cumsum.
+0000dc50: 2020 2020 636f 6e66 5f69 6478 203d 205b      conf_idx = [
+0000dc60: 5d0a 2020 2020 666f 7220 6920 696e 2072  ].    for i in r
+0000dc70: 616e 6765 286c 656e 286e 756d 5f63 6f6e  ange(len(num_con
+0000dc80: 6629 293a 0a20 2020 2020 2020 206c 656e  f)):.        len
+0000dc90: 5f73 6571 203d 2069 6e74 286e 756d 5f63  _seq = int(num_c
+0000dca0: 6f6e 665b 695d 2920 2023 2320 7573 696e  onf[i])  ## usin
+0000dcb0: 6720 6369 7263 756c 6172 2062 6c6f 636b  g circular block
+0000dcc0: 2062 6f6f 7473 7472 6170 0a20 2020 2020   bootstrap.     
+0000dcd0: 2020 206e 756d 5f73 616d 706c 655f 626c     num_sample_bl
+0000dce0: 6f63 6b20 3d20 696e 7428 6e70 2e63 6569  ock = int(np.cei
+0000dcf0: 6c28 6c65 6e5f 7365 7120 2f20 626f 6f74  l(len_seq / boot
+0000dd00: 7374 7261 705f 626c 6f63 6b5f 7369 7a65  strap_block_size
+0000dd10: 2929 0a20 2020 2020 2020 2069 6478 7320  )).        idxs 
+0000dd20: 3d20 746f 7263 682e 7261 6e64 696e 7428  = torch.randint(
+0000dd30: 302c 206c 656e 5f73 6571 2c20 286e 756d  0, len_seq, (num
+0000dd40: 5f73 616d 706c 655f 626c 6f63 6b2c 2929  _sample_block,))
+0000dd50: 0a20 2020 2020 2020 2073 616d 706c 655f  .        sample_
+0000dd60: 6964 7820 3d20 746f 7263 682e 6361 7428  idx = torch.cat(
+0000dd70: 0a20 2020 2020 2020 2020 2020 205b 746f  .            [to
+0000dd80: 7263 682e 6172 616e 6765 2869 6478 2c20  rch.arange(idx, 
+0000dd90: 6964 7820 2b20 626f 6f74 7374 7261 705f  idx + bootstrap_
+0000dda0: 626c 6f63 6b5f 7369 7a65 2920 666f 7220  block_size) for 
+0000ddb0: 6964 7820 696e 2069 6478 735d 0a20 2020  idx in idxs].   
+0000ddc0: 2020 2020 2029 0a20 2020 2020 2020 2073       ).        s
+0000ddd0: 616d 706c 655f 6964 7820 3d20 746f 7263  ample_idx = torc
+0000dde0: 682e 7265 6d61 696e 6465 7228 7361 6d70  h.remainder(samp
+0000ddf0: 6c65 5f69 6478 2c20 6c65 6e5f 7365 7129  le_idx, len_seq)
+0000de00: 0a20 2020 2020 2020 2073 616d 706c 655f  .        sample_
+0000de10: 6964 7820 3d20 7361 6d70 6c65 5f69 6478  idx = sample_idx
+0000de20: 5b30 3a6c 656e 5f73 6571 5d0a 2020 2020  [0:len_seq].    
+0000de30: 2020 2020 7361 6d70 6c65 5f69 6478 203d      sample_idx =
+0000de40: 2073 616d 706c 655f 6964 7820 2b20 6e75   sample_idx + nu
+0000de50: 6d5f 636f 6e66 5f63 756d 7375 6d5b 695d  m_conf_cumsum[i]
+0000de60: 0a20 2020 2020 2020 2063 6f6e 665f 6964  .        conf_id
+0000de70: 782e 6170 7065 6e64 2873 616d 706c 655f  x.append(sample_
+0000de80: 6964 7829 0a20 2020 2063 6f6e 665f 6964  idx).    conf_id
+0000de90: 7820 3d20 746f 7263 682e 6361 7428 636f  x = torch.cat(co
+0000dea0: 6e66 5f69 6478 290a 2020 2020 7265 7475  nf_idx).    retu
+0000deb0: 726e 2063 6f6e 665f 6964 780a 0a0a 6465  rn conf_idx...de
+0000dec0: 6620 666d 696e 5f6e 6577 746f 6e28 662c  f fmin_newton(f,
+0000ded0: 2068 6573 732c 2078 5f69 6e69 742c 2061   hess, x_init, a
+0000dee0: 7267 733d 2829 2c20 7665 7262 6f73 653d  rgs=(), verbose=
+0000def0: 5472 7565 2c20 6570 733d 3165 2d31 322c  True, eps=1e-12,
+0000df00: 206d 6178 5f69 7465 723d 3330 3029 3a0a   max_iter=300):.
+0000df10: 2020 2020 2222 224d 696e 696d 697a 6520      """Minimize 
+0000df20: 6120 6675 6e63 7469 6f6e 2077 6974 6820  a function with 
+0000df30: 7468 6520 4e65 7774 6f6e 2773 206d 6574  the Newton's met
+0000df40: 686f 642e 0a0a 2020 2020 466f 7220 6465  hod...    For de
+0000df50: 7461 696c 7320 6f66 2074 6865 204e 6577  tails of the New
+0000df60: 746f 6e27 7320 6d65 7468 6f64 2c20 7365  ton's method, se
+0000df70: 6520 4368 6170 7465 7220 392e 3520 6f66  e Chapter 9.5 of
+0000df80: 2050 726f 662e 2042 6f79 6427 7320 626f   Prof. Boyd's bo
+0000df90: 6f6b 0a20 2020 2060 436f 6e76 6578 204f  ok.    `Convex O
+0000dfa0: 7074 696d 697a 6174 696f 6e20 3c68 7474  ptimization <htt
+0000dfb0: 7073 3a2f 2f77 6562 2e73 7461 6e66 6f72  ps://web.stanfor
+0000dfc0: 642e 6564 752f 7e62 6f79 642f 6376 7862  d.edu/~boyd/cvxb
+0000dfd0: 6f6f 6b2f 3e60 5f2e 0a0a 2020 2020 4172  ook/>`_...    Ar
+0000dfe0: 6773 3a0a 2020 2020 2020 2020 6620 2863  gs:.        f (c
+0000dff0: 616c 6c61 626c 6529 3a20 7468 6520 6f62  allable): the ob
+0000e000: 6a65 6374 6976 6520 6675 6e63 7469 6f6e  jective function
+0000e010: 2074 6f20 6265 206d 696e 696d 697a 6564   to be minimized
+0000e020: 2e0a 2020 2020 2020 2020 2020 2020 6628  ..            f(
+0000e030: 783a 5465 6e73 6f72 2c20 2a61 7267 7329  x:Tensor, *args)
+0000e040: 202d 3e20 2028 793a 5465 6e73 6f72 2c20   ->  (y:Tensor, 
+0000e050: 6772 6164 3a54 656e 736f 7229 2c20 7768  grad:Tensor), wh
+0000e060: 6572 650a 2020 2020 2020 2020 2020 2020  ere.            
+0000e070: 7920 6973 2074 6865 2066 756e 6374 696f  y is the functio
+0000e080: 6e20 7661 6c75 6520 616e 6420 6772 6164  n value and grad
+0000e090: 2069 7320 7468 6520 6772 6164 6965 6e74   is the gradient
+0000e0a0: 2e0a 2020 2020 2020 2020 6865 7373 2028  ..        hess (
+0000e0b0: 6361 6c6c 6162 6c65 293a 2074 6865 2066  callable): the f
+0000e0c0: 756e 6374 696f 6e20 746f 2063 6f6d 7075  unction to compu
+0000e0d0: 7465 2074 6865 2048 6573 7369 616e 206d  te the Hessian m
+0000e0e0: 6174 7269 782e 0a20 2020 2020 2020 2020  atrix..         
+0000e0f0: 2020 2068 6573 7328 783a 5465 6e73 6f72     hess(x:Tensor
+0000e100: 2c20 2a61 7267 7329 202d 3e20 6120 7477  , *args) -> a tw
+0000e110: 6f20 6469 6d65 6e73 696f 6e61 6c20 7465  o dimensional te
+0000e120: 6e73 6f72 2e0a 2020 2020 2020 2020 785f  nsor..        x_
+0000e130: 696e 6974 2028 5465 6e73 6f72 293a 2074  init (Tensor): t
+0000e140: 6865 2069 6e69 7469 616c 2076 616c 7565  he initial value
+0000e150: 2e0a 2020 2020 2020 2020 6172 6773 2028  ..        args (
+0000e160: 7475 706c 6529 3a20 6578 7472 6120 7061  tuple): extra pa
+0000e170: 7261 6d65 7465 7273 2066 6f72 2066 2061  rameters for f a
+0000e180: 6e64 2068 6573 732e 0a20 2020 2020 2020  nd hess..       
+0000e190: 2076 6572 626f 7365 2028 626f 6f6c 293a   verbose (bool):
+0000e1a0: 2077 6865 7468 6572 2074 6f20 7072 696e   whether to prin
+0000e1b0: 7420 6d69 6e69 6d69 7a69 6e67 206c 6f67  t minimizing log
+0000e1c0: 2069 6e66 6f72 6d61 7469 6f6e 2e0a 2020   information..  
+0000e1d0: 2020 2020 2020 6570 7320 2866 6c6f 6174        eps (float
+0000e1e0: 293a 2074 6f6c 6572 616e 6365 2066 6f72  ): tolerance for
+0000e1f0: 2073 746f 7070 696e 670a 2020 2020 2020   stopping.      
+0000e200: 2020 6d61 785f 6974 6572 2028 696e 7429    max_iter (int)
+0000e210: 3a20 6d61 7869 6d75 6d20 6e75 6d62 6572  : maximum number
+0000e220: 206f 6620 6974 6572 6174 696f 6e73 2e0a   of iterations..
+0000e230: 2020 2020 2222 220a 0a20 2020 2023 2320      """..    ## 
+0000e240: 636f 6e73 7461 6e74 7320 7573 6564 2069  constants used i
+0000e250: 6e20 6261 636b 7472 6163 6b69 6e67 206c  n backtracking l
+0000e260: 696e 6520 7365 6172 6368 0a20 2020 2061  ine search.    a
+0000e270: 6c70 6861 2c20 6265 7461 203d 2030 2e30  lpha, beta = 0.0
+0000e280: 312c 2030 2e32 0a0a 2020 2020 2323 204e  1, 0.2..    ## N
+0000e290: 6577 746f 6e27 7320 6d65 7468 6f64 2066  ewton's method f
+0000e2a0: 6f72 206d 696e 696d 697a 696e 6720 7468  or minimizing th
+0000e2b0: 6520 6675 6e63 7469 6f6e 0a20 2020 2069  e function.    i
+0000e2c0: 6e64 785f 6974 6572 203d 2030 0a0a 2020  ndx_iter = 0..  
+0000e2d0: 2020 4e5f 6675 6e63 203d 2030 0a0a 2020    N_func = 0..  
+0000e2e0: 2020 6966 2076 6572 626f 7365 3a0a 2020    if verbose:.  
+0000e2f0: 2020 2020 2020 7072 696e 7428 223d 3d3d        print("===
+0000e300: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0000e310: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0000e320: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0000e330: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d22  ==============="
+0000e340: 290a 0a20 2020 2020 2020 2070 7269 6e74  )..        print
+0000e350: 2822 2020 2020 2020 2020 2020 2020 2020  ("              
+0000e360: 2020 5255 4e4e 494e 4720 5448 4520 4e45    RUNNING THE NE
+0000e370: 5754 4f4e 2753 204d 4554 484f 4420 2020  WTON'S METHOD   
+0000e380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e390: 2020 5c6e 2229 0a20 2020 2020 2020 2070    \n").        p
+0000e3a0: 7269 6e74 2822 2020 2020 2020 2020 2020  rint("          
+0000e3b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e3c0: 202a 202a 202a 2020 2020 2020 2020 2020   * * *          
+0000e3d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e3e0: 2020 2020 2020 5c6e 2229 0a20 2020 2020        \n").     
+0000e3f0: 2020 2070 7269 6e74 2866 2220 2020 2020     print(f"     
+0000e400: 2020 2020 2020 2020 2020 2020 2020 2054                 T
+0000e410: 6f6c 6572 616e 6365 2045 5053 203d 207b  olerance EPS = {
+0000e420: 6570 733a 2e35 457d 2020 2020 2020 2020  eps:.5E}        
+0000e430: 2020 2020 2020 2020 2020 5c6e 2229 0a0a            \n")..
+0000e440: 2020 2020 2323 2063 6865 636b 2069 6620      ## check if 
+0000e450: 785f 696e 6974 2069 7320 6120 7079 746f  x_init is a pyto
+0000e460: 7263 6820 7465 6e73 6f72 0a20 2020 2069  rch tensor.    i
+0000e470: 6620 6973 696e 7374 616e 6365 2878 5f69  f isinstance(x_i
+0000e480: 6e69 742c 2074 6f72 6368 2e54 656e 736f  nit, torch.Tenso
+0000e490: 7229 3a0a 2020 2020 2020 2020 7820 3d20  r):.        x = 
+0000e4a0: 785f 696e 6974 2e63 6c6f 6e65 2829 2e64  x_init.clone().d
+0000e4b0: 6574 6163 6828 292e 7265 7175 6972 6573  etach().requires
+0000e4c0: 5f67 7261 645f 2846 616c 7365 290a 2020  _grad_(False).  
+0000e4d0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+0000e4e0: 7820 3d20 785f 696e 6974 0a0a 2020 2020  x = x_init..    
+0000e4f0: 7768 696c 6520 696e 6478 5f69 7465 7220  while indx_iter 
+0000e500: 3c20 6d61 785f 6974 6572 3a0a 2020 2020  < max_iter:.    
+0000e510: 2020 2020 6c6f 7373 2c20 6772 6164 203d      loss, grad =
+0000e520: 2066 2878 2c20 2a61 7267 7329 0a20 2020   f(x, *args).   
+0000e530: 2020 2020 204e 5f66 756e 6320 2b3d 2031       N_func += 1
+0000e540: 0a0a 2020 2020 2020 2020 6966 2069 7369  ..        if isi
+0000e550: 6e73 7461 6e63 6528 785f 696e 6974 2c20  nstance(x_init, 
+0000e560: 746f 7263 682e 5465 6e73 6f72 293a 0a20  torch.Tensor):. 
+0000e570: 2020 2020 2020 2020 2020 2077 6974 6820             with 
+0000e580: 746f 7263 682e 6e6f 5f67 7261 6428 293a  torch.no_grad():
+0000e590: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000e5a0: 2048 203d 2068 6573 7328 782c 202a 6172   H = hess(x, *ar
+0000e5b0: 6773 290a 2020 2020 2020 2020 656c 7365  gs).        else
+0000e5c0: 3a0a 2020 2020 2020 2020 2020 2020 4820  :.            H 
+0000e5d0: 3d20 6865 7373 2878 2c20 2a61 7267 7329  = hess(x, *args)
+0000e5e0: 0a0a 2020 2020 2020 2020 6966 2069 7369  ..        if isi
+0000e5f0: 6e73 7461 6e63 6528 6772 6164 2c20 746f  nstance(grad, to
+0000e600: 7263 682e 5465 6e73 6f72 293a 0a20 2020  rch.Tensor):.   
+0000e610: 2020 2020 2020 2020 206e 6577 746f 6e5f           newton_
+0000e620: 6469 7265 6374 696f 6e20 3d20 746f 7263  direction = torc
+0000e630: 682e 6c69 6e61 6c67 2e73 6f6c 7665 2848  h.linalg.solve(H
+0000e640: 2c20 2d67 7261 6429 0a20 2020 2020 2020  , -grad).       
+0000e650: 2020 2020 206e 6577 746f 6e5f 6465 6372       newton_decr
+0000e660: 656d 656e 745f 7371 7561 7265 203d 2074  ement_square = t
+0000e670: 6f72 6368 2e73 756d 282d 6772 6164 202a  orch.sum(-grad *
+0000e680: 206e 6577 746f 6e5f 6469 7265 6374 696f   newton_directio
+0000e690: 6e29 0a20 2020 2020 2020 2065 6c73 653a  n).        else:
+0000e6a0: 0a20 2020 2020 2020 2020 2020 206e 6577  .            new
+0000e6b0: 746f 6e5f 6469 7265 6374 696f 6e20 3d20  ton_direction = 
+0000e6c0: 6e70 2e6c 696e 616c 672e 736f 6c76 6528  np.linalg.solve(
+0000e6d0: 482c 202d 6772 6164 290a 2020 2020 2020  H, -grad).      
+0000e6e0: 2020 2020 2020 6e65 7774 6f6e 5f64 6563        newton_dec
+0000e6f0: 7265 6d65 6e74 5f73 7175 6172 6520 3d20  rement_square = 
+0000e700: 6e70 2e73 756d 282d 6772 6164 202a 206e  np.sum(-grad * n
+0000e710: 6577 746f 6e5f 6469 7265 6374 696f 6e29  ewton_direction)
+0000e720: 0a0a 2020 2020 2020 2020 6966 2076 6572  ..        if ver
+0000e730: 626f 7365 3a0a 2020 2020 2020 2020 2020  bose:.          
+0000e740: 2020 7072 696e 7428 0a20 2020 2020 2020    print(.       
+0000e750: 2020 2020 2020 2020 2066 2241 7420 6974           f"At it
+0000e760: 6572 6174 6520 7b69 6e64 785f 6974 6572  erate {indx_iter
+0000e770: 3a34 647d 3b20 663d 207b 6c6f 7373 2e69  :4d}; f= {loss.i
+0000e780: 7465 6d28 293a 2e35 457d 3b22 2c0a 2020  tem():.5E};",.  
+0000e790: 2020 2020 2020 2020 2020 2020 2020 6622                f"
+0000e7a0: 7c31 2f32 2a4e 6577 746f 6e5f 6465 6372  |1/2*Newton_decr
+0000e7b0: 656d 656e 745e 327c 3a20 7b6e 6577 746f  ement^2|: {newto
+0000e7c0: 6e5f 6465 6372 656d 656e 745f 7371 7561  n_decrement_squa
+0000e7d0: 7265 2e69 7465 6d28 292f 323a 2e35 457d  re.item()/2:.5E}
+0000e7e0: 5c6e 222c 0a20 2020 2020 2020 2020 2020  \n",.           
+0000e7f0: 2029 0a0a 2020 2020 2020 2020 6966 206e   )..        if n
+0000e800: 6577 746f 6e5f 6465 6372 656d 656e 745f  ewton_decrement_
+0000e810: 7371 7561 7265 202f 2032 2e30 203c 3d20  square / 2.0 <= 
+0000e820: 6570 733a 0a20 2020 2020 2020 2020 2020  eps:.           
+0000e830: 2062 7265 616b 0a0a 2020 2020 2020 2020   break..        
+0000e840: 2323 2062 6163 6b74 7261 636b 696e 6720  ## backtracking 
+0000e850: 6c69 6e65 2073 6561 7263 680a 2020 2020  line search.    
+0000e860: 2020 2020 6d61 785f 6c73 5f69 7465 7220      max_ls_iter 
+0000e870: 3d20 3130 300a 2020 2020 2020 2020 7374  = 100.        st
+0000e880: 6570 5f73 697a 6520 3d20 312e 300a 0a20  ep_size = 1.0.. 
+0000e890: 2020 2020 2020 2069 6e64 785f 6c73 5f69         indx_ls_i
+0000e8a0: 7465 7220 3d20 300a 2020 2020 2020 2020  ter = 0.        
+0000e8b0: 7768 696c 6520 696e 6478 5f6c 735f 6974  while indx_ls_it
+0000e8c0: 6572 203c 206d 6178 5f6c 735f 6974 6572  er < max_ls_iter
+0000e8d0: 3a0a 2020 2020 2020 2020 2020 2020 7461  :.            ta
+0000e8e0: 7267 6574 5f6c 6f73 732c 205f 203d 2066  rget_loss, _ = f
+0000e8f0: 2878 202b 2073 7465 705f 7369 7a65 202a  (x + step_size *
+0000e900: 206e 6577 746f 6e5f 6469 7265 6374 696f   newton_directio
+0000e910: 6e2c 202a 6172 6773 290a 0a20 2020 2020  n, *args)..     
+0000e920: 2020 2020 2020 204e 5f66 756e 6320 2b3d         N_func +=
+0000e930: 2031 0a20 2020 2020 2020 2020 2020 2061   1.            a
+0000e940: 7070 726f 7869 6d61 7465 5f6c 6f73 7320  pproximate_loss 
+0000e950: 3d20 6c6f 7373 202b 2073 7465 705f 7369  = loss + step_si
+0000e960: 7a65 202a 2061 6c70 6861 202a 2028 2d6e  ze * alpha * (-n
+0000e970: 6577 746f 6e5f 6465 6372 656d 656e 745f  ewton_decrement_
+0000e980: 7371 7561 7265 290a 2020 2020 2020 2020  square).        
+0000e990: 2020 2020 6966 2074 6172 6765 745f 6c6f      if target_lo
+0000e9a0: 7373 203c 2061 7070 726f 7869 6d61 7465  ss < approximate
+0000e9b0: 5f6c 6f73 733a 0a20 2020 2020 2020 2020  _loss:.         
+0000e9c0: 2020 2020 2020 2062 7265 616b 0a20 2020         break.   
+0000e9d0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+0000e9e0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0000e9f0: 7465 705f 7369 7a65 203d 2073 7465 705f  tep_size = step_
+0000ea00: 7369 7a65 202a 2062 6574 610a 2020 2020  size * beta.    
+0000ea10: 2020 2020 2020 2020 696e 6478 5f6c 735f          indx_ls_
+0000ea20: 6974 6572 202b 3d20 310a 0a20 2020 2020  iter += 1..     
+0000ea30: 2020 2078 203d 2078 202b 2073 7465 705f     x = x + step_
+0000ea40: 7369 7a65 202a 206e 6577 746f 6e5f 6469  size * newton_di
+0000ea50: 7265 6374 696f 6e0a 2020 2020 2020 2020  rection.        
+0000ea60: 696e 6478 5f69 7465 7220 2b3d 2031 0a0a  indx_iter += 1..
+0000ea70: 2020 2020 6966 2076 6572 626f 7365 3a0a      if verbose:.
+0000ea80: 2020 2020 2020 2020 7072 696e 7428 224e          print("N
+0000ea90: 5f69 7465 7220 2020 3d20 746f 7461 6c20  _iter   = total 
+0000eaa0: 6e75 6d62 6572 206f 6620 6974 6572 6174  number of iterat
+0000eab0: 696f 6e73 2229 0a20 2020 2020 2020 2070  ions").        p
+0000eac0: 7269 6e74 2822 4e5f 6675 6e63 2020 203d  rint("N_func   =
+0000ead0: 2074 6f74 616c 206e 756d 6265 7220 6f66   total number of
+0000eae0: 2066 756e 6374 696f 6e20 616e 6420 6772   function and gr
+0000eaf0: 6164 6965 6e74 2065 7661 6c75 6174 696f  adient evaluatio
+0000eb00: 6e73 2229 0a20 2020 2020 2020 2070 7269  ns").        pri
+0000eb10: 6e74 2822 4620 2020 2020 2020 203d 2066  nt("F        = f
+0000eb20: 696e 616c 2066 756e 6374 696f 6e20 7661  inal function va
+0000eb30: 6c75 6520 5c6e 2229 0a20 2020 2020 2020  lue \n").       
+0000eb40: 2070 7269 6e74 2822 2020 2020 2020 2020   print("        
+0000eb50: 2020 2020 202a 202a 202a 2020 2020 205c       * * *     \
+0000eb60: 6e22 290a 2020 2020 2020 2020 7072 696e  n").        prin
+0000eb70: 7428 224e 5f69 7465 7220 2020 204e 5f66  t("N_iter    N_f
+0000eb80: 756e 6320 2020 2020 2020 2046 2229 0a20  unc        F"). 
+0000eb90: 2020 2020 2020 2070 7269 6e74 2866 227b         print(f"{
+0000eba0: 696e 6478 5f69 7465 722b 313a 3664 7d20  indx_iter+1:6d} 
+0000ebb0: 2020 207b 4e5f 6675 6e63 3a36 647d 2020     {N_func:6d}  
+0000ebc0: 2020 7b6c 6f73 732e 6974 656d 2829 3a2e    {loss.item():.
+0000ebd0: 3645 7d22 290a 2020 2020 2020 2020 7072  6E}").        pr
+0000ebe0: 696e 7428 6622 2020 4620 3d20 7b6c 6f73  int(f"  F = {los
+0000ebf0: 732e 6974 656d 2829 3a2e 3132 667d 205c  s.item():.12f} \
+0000ec00: 6e22 290a 0a20 2020 2020 2020 2069 6620  n")..        if 
+0000ec10: 6e65 7774 6f6e 5f64 6563 7265 6d65 6e74  newton_decrement
+0000ec20: 5f73 7175 6172 6520 2f20 322e 3020 3c3d  _square / 2.0 <=
+0000ec30: 2065 7073 2061 6e64 2069 6e64 785f 6974   eps and indx_it
+0000ec40: 6572 203c 206d 6178 5f69 7465 723a 0a20  er < max_iter:. 
+0000ec50: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+0000ec60: 2822 434f 4e56 4552 4745 4e43 453a 2031  ("CONVERGENCE: 1
+0000ec70: 2f32 2a4e 6577 746f 6e5f 6465 6372 656d  /2*Newton_decrem
+0000ec80: 656e 745e 3220 3c20 4550 5322 290a 2020  ent^2 < EPS").  
+0000ec90: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0000eca0: 2020 2020 2020 2020 7072 696e 7428 2243          print("C
+0000ecb0: 4f4e 5645 5247 454e 4345 3a20 4e55 4d5f  ONVERGENCE: NUM_
+0000ecc0: 4f46 5f49 5445 5241 5449 4f4e 2052 4541  OF_ITERATION REA
+0000ecd0: 4348 204d 4158 5f49 5445 5241 5449 4f4e  CH MAX_ITERATION
+0000ece0: 2229 0a0a 2020 2020 7265 7475 726e 207b  ")..    return {
+0000ecf0: 0a20 2020 2020 2020 2022 7822 3a20 782c  .        "x": x,
+0000ed00: 0a20 2020 2020 2020 2022 4e5f 6974 6572  .        "N_iter
+0000ed10: 223a 2069 6e64 785f 6974 6572 202b 2031  ": indx_iter + 1
+0000ed20: 2c0a 2020 2020 2020 2020 224e 5f66 756e  ,.        "N_fun
+0000ed30: 6322 3a20 4e5f 6675 6e63 2c0a 2020 2020  c": N_func,.    
+0000ed40: 2020 2020 2246 223a 206c 6f73 732e 6974      "F": loss.it
+0000ed50: 656d 2829 2c0a 2020 2020 2020 2020 2268  em(),.        "h
+0000ed60: 616c 665f 6e65 7774 6f6e 5f64 6563 7265  alf_newton_decre
+0000ed70: 6d65 6e74 5f73 7175 6172 6522 3a20 6e65  ment_square": ne
+0000ed80: 7774 6f6e 5f64 6563 7265 6d65 6e74 5f73  wton_decrement_s
+0000ed90: 7175 6172 6520 2f20 322e 302c 0a20 2020  quare / 2.0,.   
+0000eda0: 207d 0a94 7d94 288c 1146 6173 744d 4241   }..}.(..FastMBA
+0000edb0: 522e 5f5f 696e 6974 5f5f 948c 0364 6566  R.__init__...def
+0000edc0: 944b 124d 2a01 8794 8c0a 4661 7374 4d42  .K.M*.....FastMB
+0000edd0: 4152 2e46 946a 2809 0000 4d2c 014d 3101  AR.F.j(...M,.M1.
+0000ede0: 8794 8c0e 4661 7374 4d42 4152 2e46 5f73  ....FastMBAR.F_s
+0000edf0: 7464 946a 2809 0000 4d33 014d 3901 8794  td.j(...M3.M9...
+0000ee00: 8c0e 4661 7374 4d42 4152 2e46 5f63 6f76  ..FastMBAR.F_cov
+0000ee10: 946a 2809 0000 4d3b 014d 4101 8794 8c0f  .j(...M;.MA.....
+0000ee20: 4661 7374 4d42 4152 2e44 656c 7461 4694  FastMBAR.DeltaF.
+0000ee30: 6a28 0900 004d 4301 4d49 0187 948c 1346  j(...MC.MI.....F
+0000ee40: 6173 744d 4241 522e 4465 6c74 6146 5f73  astMBAR.DeltaF_s
+0000ee50: 7464 946a 2809 0000 4d4b 014d 5101 8794  td.j(...MK.MQ...
+0000ee60: 8c15 4661 7374 4d42 4152 2e6c 6f67 5f70  ..FastMBAR.log_p
+0000ee70: 726f 625f 6d69 7894 6a28 0900 004d 5301  rob_mix.j(...MS.
+0000ee80: 4d56 0187 948c 3446 6173 744d 4241 522e  MV....4FastMBAR.
+0000ee90: 6361 6c63 756c 6174 655f 6672 6565 5f65  calculate_free_e
+0000eea0: 6e65 7267 6965 735f 6f66 5f70 6572 7475  nergies_of_pertu
+0000eeb0: 7262 6564 5f73 7461 7465 7394 6a28 0900  rbed_states.j(..
+0000eec0: 004d 5801 4db3 0187 948c 0846 6173 744d  .MX.M......FastM
+0000eed0: 4241 5294 6a8f 0200 004b 084d b301 8794  BAR.j....K.M....
+0000eee0: 8c12 5f63 6f6d 7075 7465 5f6c 6f67 705f  .._compute_logp_
+0000eef0: 6f66 5f46 946a 2809 0000 4db5 014d ba01  of_F.j(...M..M..
+0000ef00: 8794 8c1c 5f63 6f6d 7075 7465 5f6c 6f73  ...._compute_los
+0000ef10: 735f 616e 645f 6772 6164 5f6f 665f 6446  s_and_grad_of_dF
+0000ef20: 946a 2809 0000 4dbd 014d d901 8794 8c25  .j(...M..M.....%
+0000ef30: 5f63 6f6d 7075 7465 5f6c 6f73 735f 616e  _compute_loss_an
+0000ef40: 645f 6772 6164 5f6f 665f 6446 5f69 6e5f  d_grad_of_dF_in_
+0000ef50: 6261 7463 6894 6a28 0900 004d dc01 4dfd  batch.j(...M..M.
+0000ef60: 0187 948c 245f 636f 6d70 7574 655f 6865  ....$_compute_he
+0000ef70: 7373 6961 6e5f 6c6f 675f 6c69 6b65 6c69  ssian_log_likeli
+0000ef80: 686f 6f64 5f6f 665f 4694 6a28 0900 004d  hood_of_F.j(...M
+0000ef90: 0002 4d05 0287 948c 2d5f 636f 6d70 7574  ..M.....-_comput
+0000efa0: 655f 6865 7373 6961 6e5f 6c6f 675f 6c69  e_hessian_log_li
+0000efb0: 6b65 6c69 686f 6f64 5f6f 665f 465f 696e  kelihood_of_F_in
+0000efc0: 5f62 6174 6368 946a 2809 0000 4d08 024d  _batch.j(...M..M
+0000efd0: 1702 8794 8c1b 5f63 6f6d 7075 7465 5f68  ......_compute_h
+0000efe0: 6573 7369 616e 5f6c 6f73 735f 6f66 5f64  essian_loss_of_d
+0000eff0: 4694 6a28 0900 004d 1a02 4d1f 0287 948c  F.j(...M..M.....
+0000f000: 245f 636f 6d70 7574 655f 6865 7373 6961  $_compute_hessia
+0000f010: 6e5f 6c6f 7373 5f6f 665f 6446 5f69 6e5f  n_loss_of_dF_in_
+0000f020: 6261 7463 6894 6a28 0900 004d 2202 4d27  batch.j(...M".M'
+0000f030: 0287 948c 0b5f 736f 6c76 655f 6d62 6172  ....._solve_mbar
+0000f040: 946a 2809 0000 4d2a 024d 5f02 8794 8c13  .j(...M*.M_.....
+0000f050: 5f62 6f6f 7473 7472 6170 5f63 6f6e 665f  _bootstrap_conf_
+0000f060: 6964 7894 6a28 0900 004d 6202 4d73 0287  idx.j(...Mb.Ms..
+0000f070: 948c 0b66 6d69 6e5f 6e65 7774 6f6e 946a  ...fmin_newton.j
+0000f080: 2809 0000 4d76 024d df02 8794 757d 9428  (...Mv.M....u}.(
+0000f090: 8c08 4661 7374 4d42 4152 946a ea02 0000  ..FastMBAR.j....
+0000f0a0: 8c11 4661 7374 4d42 4152 2e5f 5f69 6e69  ..FastMBAR.__ini
+0000f0b0: 745f 5f94 6aea 0200 008c 3446 6173 744d  t__.j.....4FastM
+0000f0c0: 4241 522e 6361 6c63 756c 6174 655f 6672  BAR.calculate_fr
+0000f0d0: 6565 5f65 6e65 7267 6965 735f 6f66 5f70  ee_energies_of_p
+0000f0e0: 6572 7475 7262 6564 5f73 7461 7465 7394  erturbed_states.
+0000f0f0: 6aea 0200 0075 8c08 4661 7374 4d42 4152  j....u..FastMBAR
+0000f100: 9474 9473 7562 2e                        .t.sub.
```

### Comparing `fastmbar-1.2/docs/build/.doctrees/examples.doctree` & `fastmbar-1.3/docs/build/.doctrees/examples.doctree`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/.doctrees/index.doctree` & `fastmbar-1.3/docs/build/.doctrees/index.doctree`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/.doctrees/installation.doctree` & `fastmbar-1.3/docs/build/.doctrees/installation.doctree`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/.doctrees/references.doctree` & `fastmbar-1.3/docs/build/.doctrees/references.doctree`

 * *Files 10% similar despite different names*

```diff
@@ -1,8 +1,8 @@
-00000000: 8005 952c 2200 0000 0000 008c 0f73 7068  ...,"........sph
+00000000: 8005 9523 2200 0000 0000 008c 0f73 7068  ...#"........sph
 00000010: 696e 782e 6164 646e 6f64 6573 948c 0864  inx.addnodes...d
 00000020: 6f63 756d 656e 7494 9394 2981 947d 9428  ocument...)..}.(
 00000030: 8c09 7261 7773 6f75 7263 6594 8c00 948c  ..rawsource.....
 00000040: 0863 6869 6c64 7265 6e94 5d94 8c0e 646f  .children.]...do
 00000050: 6375 7469 6c73 2e6e 6f64 6573 948c 0773  cutils.nodes...s
 00000060: 6563 7469 6f6e 9493 9429 8194 7d94 2868  ection...)..}.(h
 00000070: 0568 0668 075d 9428 6809 8c05 7469 746c  .h.h.].(h...titl
@@ -39,510 +39,509 @@
 00000260: 6365 7320 6966 2046 6173 744d 4241 5220  ces if FastMBAR 
 00000270: 6973 2075 7365 6420 696e 2079 6f75 7220  is used in your 
 00000280: 7072 6f6a 6563 7473 2e94 8594 8194 7d94  projects......}.
 00000290: 2868 1b68 2f68 1c68 0368 1d4e 681e 4e75  (h.h/h.h.h.Nh.Nu
 000002a0: 6261 681f 7d94 2868 215d 9468 235d 9468  bah.}.(h!].h#].h
 000002b0: 255d 9468 275d 9468 295d 9475 682b 682d  %].h'].h)].uh+h-
 000002c0: 681d 682c 681e 4b04 681b 680c 681c 6803  h.h,h.K.h.h.h.h.
-000002d0: 7562 6809 8c0f 656e 756d 6572 6174 6564  ubh...enumerated
-000002e0: 5f6c 6973 7494 9394 2981 947d 9428 6805  _list...)..}.(h.
-000002f0: 6806 6807 5d94 2868 098c 096c 6973 745f  h.h.].(h...list_
-00000300: 6974 656d 9493 9429 8194 7d94 2868 058c  item...)..}.(h..
-00000310: d458 696e 7169 616e 6720 4469 6e67 2c20  .Xinqiang Ding, 
-00000320: 4a6f 6e61 6820 5a2e 2056 696c 7365 636b  Jonah Z. Vilseck
-00000330: 2c20 4368 6172 6c65 7320 4c2e 2042 726f  , Charles L. Bro
-00000340: 6f6b 7320 4949 492e 2028 3230 3139 292e  oks III. (2019).
-00000350: 2060 4661 7374 2053 6f6c 7665 7220 666f   `Fast Solver fo
-00000360: 7220 4c61 7267 6520 5363 616c 6520 4d75  r Large Scale Mu
-00000370: 6c74 6973 7461 7465 2042 656e 6e65 7474  ltistate Bennett
-00000380: 2041 6363 6570 7461 6e63 6520 5261 7469   Acceptance Rati
-00000390: 6f20 4571 7561 7469 6f6e 732e 203c 6874  o Equations. <ht
-000003a0: 7470 733a 2f2f 646f 692e 6f72 672f 3130  tps://doi.org/10
-000003b0: 2e31 3032 312f 6163 732e 6a63 7463 2e38  .1021/acs.jctc.8
-000003c0: 6230 3130 3130 3e60 5f20 202a 4a2e 2043  b01010>`_  *J. C
-000003d0: 6865 6d2e 2054 6865 6f72 7920 436f 6d70  hem. Theory Comp
-000003e0: 7574 2e2a 0a94 6807 5d94 682e 2981 947d  ut.*..h.].h.)..}
-000003f0: 9428 6805 8cd3 5869 6e71 6961 6e67 2044  .(h...Xinqiang D
-00000400: 696e 672c 204a 6f6e 6168 205a 2e20 5669  ing, Jonah Z. Vi
-00000410: 6c73 6563 6b2c 2043 6861 726c 6573 204c  lseck, Charles L
-00000420: 2e20 4272 6f6f 6b73 2049 4949 2e20 2832  . Brooks III. (2
-00000430: 3031 3929 2e20 6046 6173 7420 536f 6c76  019). `Fast Solv
-00000440: 6572 2066 6f72 204c 6172 6765 2053 6361  er for Large Sca
-00000450: 6c65 204d 756c 7469 7374 6174 6520 4265  le Multistate Be
-00000460: 6e6e 6574 7420 4163 6365 7074 616e 6365  nnett Acceptance
-00000470: 2052 6174 696f 2045 7175 6174 696f 6e73   Ratio Equations
-00000480: 2e20 3c68 7474 7073 3a2f 2f64 6f69 2e6f  . <https://doi.o
-00000490: 7267 2f31 302e 3130 3231 2f61 6373 2e6a  rg/10.1021/acs.j
-000004a0: 6374 632e 3862 3031 3031 303e 605f 2020  ctc.8b01010>`_  
-000004b0: 2a4a 2e20 4368 656d 2e20 5468 656f 7279  *J. Chem. Theory
-000004c0: 2043 6f6d 7075 742e 2a94 6807 5d94 2868   Comput.*.h.].(h
-000004d0: 168c 4058 696e 7169 616e 6720 4469 6e67  ..@Xinqiang Ding
-000004e0: 2c20 4a6f 6e61 6820 5a2e 2056 696c 7365  , Jonah Z. Vilse
-000004f0: 636b 2c20 4368 6172 6c65 7320 4c2e 2042  ck, Charles L. B
-00000500: 726f 6f6b 7320 4949 492e 2028 3230 3139  rooks III. (2019
-00000510: 292e 2094 8594 8194 7d94 2868 1b68 4868  ). .....}.(h.hHh
-00000520: 1c68 0368 1d4e 681e 4e75 6268 098c 0972  .h.h.Nh.Nubh...r
-00000530: 6566 6572 656e 6365 9493 9429 8194 7d94  eference...)..}.
-00000540: 2868 058c 7860 4661 7374 2053 6f6c 7665  (h..x`Fast Solve
-00000550: 7220 666f 7220 4c61 7267 6520 5363 616c  r for Large Scal
-00000560: 6520 4d75 6c74 6973 7461 7465 2042 656e  e Multistate Ben
-00000570: 6e65 7474 2041 6363 6570 7461 6e63 6520  nett Acceptance 
-00000580: 5261 7469 6f20 4571 7561 7469 6f6e 732e  Ratio Equations.
-00000590: 203c 6874 7470 733a 2f2f 646f 692e 6f72   <https://doi.or
-000005a0: 672f 3130 2e31 3032 312f 6163 732e 6a63  g/10.1021/acs.jc
-000005b0: 7463 2e38 6230 3130 3130 3e60 5f94 6807  tc.8b01010>`_.h.
-000005c0: 5d94 6816 8c4a 4661 7374 2053 6f6c 7665  ].h..JFast Solve
-000005d0: 7220 666f 7220 4c61 7267 6520 5363 616c  r for Large Scal
-000005e0: 6520 4d75 6c74 6973 7461 7465 2042 656e  e Multistate Ben
-000005f0: 6e65 7474 2041 6363 6570 7461 6e63 6520  nett Acceptance 
-00000600: 5261 7469 6f20 4571 7561 7469 6f6e 732e  Ratio Equations.
-00000610: 9485 9481 947d 9428 681b 6852 681c 6803  .....}.(h.hRh.h.
-00000620: 681d 4e68 1e4e 7562 6168 1f7d 9428 6821  h.Nh.Nubah.}.(h!
-00000630: 5d94 6823 5d94 6825 5d94 6827 5d94 6829  ].h#].h%].h'].h)
-00000640: 5d94 8c04 6e61 6d65 948c 4a46 6173 7420  ]...name..JFast 
-00000650: 536f 6c76 6572 2066 6f72 204c 6172 6765  Solver for Large
-00000660: 2053 6361 6c65 204d 756c 7469 7374 6174   Scale Multistat
-00000670: 6520 4265 6e6e 6574 7420 4163 6365 7074  e Bennett Accept
-00000680: 616e 6365 2052 6174 696f 2045 7175 6174  ance Ratio Equat
-00000690: 696f 6e73 2e94 8c06 7265 6675 7269 948c  ions....refuri..
-000006a0: 2868 7474 7073 3a2f 2f64 6f69 2e6f 7267  (https://doi.org
-000006b0: 2f31 302e 3130 3231 2f61 6373 2e6a 6374  /10.1021/acs.jct
-000006c0: 632e 3862 3031 3031 3094 7568 2b68 5068  c.8b01010.uh+hPh
-000006d0: 1b68 4875 6268 098c 0674 6172 6765 7494  .hHubh...target.
-000006e0: 9394 2981 947d 9428 6805 8c2b 203c 6874  ..)..}.(h..+ <ht
-000006f0: 7470 733a 2f2f 646f 692e 6f72 672f 3130  tps://doi.org/10
-00000700: 2e31 3032 312f 6163 732e 6a63 7463 2e38  .1021/acs.jctc.8
-00000710: 6230 3130 3130 3e94 6807 5d94 681f 7d94  b01010>.h.].h.}.
-00000720: 2868 215d 948c 4966 6173 742d 736f 6c76  (h!]..Ifast-solv
-00000730: 6572 2d66 6f72 2d6c 6172 6765 2d73 6361  er-for-large-sca
-00000740: 6c65 2d6d 756c 7469 7374 6174 652d 6265  le-multistate-be
-00000750: 6e6e 6574 742d 6163 6365 7074 616e 6365  nnett-acceptance
-00000760: 2d72 6174 696f 2d65 7175 6174 696f 6e73  -ratio-equations
-00000770: 9461 6823 5d94 6825 5d94 8c4a 6661 7374  .ah#].h%]..Jfast
-00000780: 2073 6f6c 7665 7220 666f 7220 6c61 7267   solver for larg
-00000790: 6520 7363 616c 6520 6d75 6c74 6973 7461  e scale multista
-000007a0: 7465 2062 656e 6e65 7474 2061 6363 6570  te bennett accep
-000007b0: 7461 6e63 6520 7261 7469 6f20 6571 7561  tance ratio equa
-000007c0: 7469 6f6e 732e 9461 6827 5d94 6829 5d94  tions..ah'].h)].
-000007d0: 8c06 7265 6675 7269 9468 6375 682b 6864  ..refuri.hcuh+hd
-000007e0: 8c0a 7265 6665 7265 6e63 6564 944b 0168  ..referenced.K.h
-000007f0: 1b68 4875 6268 168c 0220 2094 8594 8194  .hHubh...  .....
-00000800: 7d94 2868 1b68 4868 1c68 0368 1d4e 681e  }.(h.hHh.h.h.Nh.
-00000810: 4e75 6268 098c 0865 6d70 6861 7369 7394  Nubh...emphasis.
-00000820: 9394 2981 947d 9428 6805 8c19 2a4a 2e20  ..)..}.(h...*J. 
-00000830: 4368 656d 2e20 5468 656f 7279 2043 6f6d  Chem. Theory Com
-00000840: 7075 742e 2a94 6807 5d94 6816 8c17 4a2e  put.*.h.].h...J.
-00000850: 2043 6865 6d2e 2054 6865 6f72 7920 436f   Chem. Theory Co
-00000860: 6d70 7574 2e94 8594 8194 7d94 2868 1b68  mput......}.(h.h
-00000870: 7a68 1c68 0368 1d4e 681e 4e75 6261 681f  zh.h.h.Nh.Nubah.
-00000880: 7d94 2868 215d 9468 235d 9468 255d 9468  }.(h!].h#].h%].h
-00000890: 275d 9468 295d 9475 682b 6878 681b 6848  '].h)].uh+hxh.hH
-000008a0: 7562 6568 1f7d 9428 6821 5d94 6823 5d94  ubeh.}.(h!].h#].
-000008b0: 6825 5d94 6827 5d94 6829 5d94 7568 2b68  h%].h'].h)].uh+h
-000008c0: 2d68 1d68 2c68 1e4b 0668 1b68 4475 6261  -h.h,h.K.h.hDuba
-000008d0: 681f 7d94 2868 215d 9468 235d 9468 255d  h.}.(h!].h#].h%]
-000008e0: 9468 275d 9468 295d 9475 682b 6842 681b  .h'].h)].uh+hBh.
-000008f0: 683f 681c 6803 681d 682c 681e 4e75 6268  h?h.h.h.h,h.Nubh
-00000900: 4329 8194 7d94 2868 058c fe58 696e 7169  C)..}.(h...Xinqi
-00000910: 616e 6720 4469 6e67 2c20 4a6f 6e61 6820  ang Ding, Jonah 
-00000920: 5a2e 2056 696c 7365 636b 2c20 5279 616e  Z. Vilseck, Ryan
-00000930: 204c 2e20 4861 7965 732c 2043 6861 726c   L. Hayes, Charl
-00000940: 6573 204c 2e20 4272 6f6f 6b73 2049 4949  es L. Brooks III
-00000950: 2e20 2832 3031 3729 2e20 6047 6962 6273  . (2017). `Gibbs
-00000960: 2053 616d 706c 6572 2d62 6173 6564 20ce   Sampler-based .
-00000970: bb2d 6479 6e61 6d69 6373 2061 6e64 2052  .-dynamics and R
-00000980: 616f e280 9342 6c61 636b 7765 6c6c 2045  ao...Blackwell E
-00000990: 7374 696d 6174 6f72 2066 6f72 2041 6c63  stimator for Alc
-000009a0: 6865 6d69 6361 6c20 4672 6565 2045 6e65  hemical Free Ene
-000009b0: 7267 7920 4361 6c63 756c 6174 696f 6e2e  rgy Calculation.
-000009c0: 203c 6874 7470 733a 2f2f 646f 692e 6f72   <https://doi.or
-000009d0: 672f 3130 2e31 3032 312f 6163 732e 6a63  g/10.1021/acs.jc
-000009e0: 7463 2e37 6230 3032 3034 3e60 5f20 202a  tc.7b00204>`_  *
-000009f0: 4a2e 2043 6865 6d2e 2054 6865 6f72 7920  J. Chem. Theory 
-00000a00: 436f 6d70 7574 2e2a 0a94 6807 5d94 682e  Comput.*..h.].h.
-00000a10: 2981 947d 9428 6805 8cfd 5869 6e71 6961  )..}.(h...Xinqia
-00000a20: 6e67 2044 696e 672c 204a 6f6e 6168 205a  ng Ding, Jonah Z
-00000a30: 2e20 5669 6c73 6563 6b2c 2052 7961 6e20  . Vilseck, Ryan 
-00000a40: 4c2e 2048 6179 6573 2c20 4368 6172 6c65  L. Hayes, Charle
-00000a50: 7320 4c2e 2042 726f 6f6b 7320 4949 492e  s L. Brooks III.
-00000a60: 2028 3230 3137 292e 2060 4769 6262 7320   (2017). `Gibbs 
-00000a70: 5361 6d70 6c65 722d 6261 7365 6420 cebb  Sampler-based ..
-00000a80: 2d64 796e 616d 6963 7320 616e 6420 5261  -dynamics and Ra
-00000a90: 6fe2 8093 426c 6163 6b77 656c 6c20 4573  o...Blackwell Es
-00000aa0: 7469 6d61 746f 7220 666f 7220 416c 6368  timator for Alch
-00000ab0: 656d 6963 616c 2046 7265 6520 456e 6572  emical Free Ener
-00000ac0: 6779 2043 616c 6375 6c61 7469 6f6e 2e20  gy Calculation. 
-00000ad0: 3c68 7474 7073 3a2f 2f64 6f69 2e6f 7267  <https://doi.org
-00000ae0: 2f31 302e 3130 3231 2f61 6373 2e6a 6374  /10.1021/acs.jct
-00000af0: 632e 3762 3030 3230 343e 605f 2020 2a4a  c.7b00204>`_  *J
-00000b00: 2e20 4368 656d 2e20 5468 656f 7279 2043  . Chem. Theory C
-00000b10: 6f6d 7075 742e 2a94 6807 5d94 2868 168c  omput.*.h.].(h..
-00000b20: 4f58 696e 7169 616e 6720 4469 6e67 2c20  OXinqiang Ding, 
-00000b30: 4a6f 6e61 6820 5a2e 2056 696c 7365 636b  Jonah Z. Vilseck
-00000b40: 2c20 5279 616e 204c 2e20 4861 7965 732c  , Ryan L. Hayes,
-00000b50: 2043 6861 726c 6573 204c 2e20 4272 6f6f   Charles L. Broo
-00000b60: 6b73 2049 4949 2e20 2832 3031 3729 2e20  ks III. (2017). 
-00000b70: 9485 9481 947d 9428 681b 6898 681c 6803  .....}.(h.h.h.h.
-00000b80: 681d 4e68 1e4e 7562 6851 2981 947d 9428  h.Nh.NubhQ)..}.(
-00000b90: 6805 8c93 6047 6962 6273 2053 616d 706c  h...`Gibbs Sampl
-00000ba0: 6572 2d62 6173 6564 20ce bb2d 6479 6e61  er-based ..-dyna
-00000bb0: 6d69 6373 2061 6e64 2052 616f e280 9342  mics and Rao...B
-00000bc0: 6c61 636b 7765 6c6c 2045 7374 696d 6174  lackwell Estimat
-00000bd0: 6f72 2066 6f72 2041 6c63 6865 6d69 6361  or for Alchemica
-00000be0: 6c20 4672 6565 2045 6e65 7267 7920 4361  l Free Energy Ca
-00000bf0: 6c63 756c 6174 696f 6e2e 203c 6874 7470  lculation. <http
-00000c00: 733a 2f2f 646f 692e 6f72 672f 3130 2e31  s://doi.org/10.1
-00000c10: 3032 312f 6163 732e 6a63 7463 2e37 6230  021/acs.jctc.7b0
-00000c20: 3032 3034 3e60 5f94 6807 5d94 6816 8c65  0204>`_.h.].h..e
-00000c30: 4769 6262 7320 5361 6d70 6c65 722d 6261  Gibbs Sampler-ba
-00000c40: 7365 6420 cebb 2d64 796e 616d 6963 7320  sed ..-dynamics 
-00000c50: 616e 6420 5261 6fe2 8093 426c 6163 6b77  and Rao...Blackw
-00000c60: 656c 6c20 4573 7469 6d61 746f 7220 666f  ell Estimator fo
-00000c70: 7220 416c 6368 656d 6963 616c 2046 7265  r Alchemical Fre
-00000c80: 6520 456e 6572 6779 2043 616c 6375 6c61  e Energy Calcula
-00000c90: 7469 6f6e 2e94 8594 8194 7d94 2868 1b68  tion......}.(h.h
-00000ca0: a068 1c68 0368 1d4e 681e 4e75 6261 681f  .h.h.h.Nh.Nubah.
-00000cb0: 7d94 2868 215d 9468 235d 9468 255d 9468  }.(h!].h#].h%].h
-00000cc0: 275d 9468 295d 948c 046e 616d 6594 8c65  '].h)]...name..e
-00000cd0: 4769 6262 7320 5361 6d70 6c65 722d 6261  Gibbs Sampler-ba
-00000ce0: 7365 6420 cebb 2d64 796e 616d 6963 7320  sed ..-dynamics 
-00000cf0: 616e 6420 5261 6fe2 8093 426c 6163 6b77  and Rao...Blackw
-00000d00: 656c 6c20 4573 7469 6d61 746f 7220 666f  ell Estimator fo
-00000d10: 7220 416c 6368 656d 6963 616c 2046 7265  r Alchemical Fre
-00000d20: 6520 456e 6572 6779 2043 616c 6375 6c61  e Energy Calcula
-00000d30: 7469 6f6e 2e94 6862 8c28 6874 7470 733a  tion..hb.(https:
-00000d40: 2f2f 646f 692e 6f72 672f 3130 2e31 3032  //doi.org/10.102
-00000d50: 312f 6163 732e 6a63 7463 2e37 6230 3032  1/acs.jctc.7b002
-00000d60: 3034 9475 682b 6850 681b 6898 7562 6865  04.uh+hPh.h.ubhe
-00000d70: 2981 947d 9428 6805 8c2b 203c 6874 7470  )..}.(h..+ <http
-00000d80: 733a 2f2f 646f 692e 6f72 672f 3130 2e31  s://doi.org/10.1
-00000d90: 3032 312f 6163 732e 6a63 7463 2e37 6230  021/acs.jctc.7b0
-00000da0: 3032 3034 3e94 6807 5d94 681f 7d94 2868  0204>.h.].h.}.(h
-00000db0: 215d 948c 5e67 6962 6273 2d73 616d 706c  !]..^gibbs-sampl
-00000dc0: 6572 2d62 6173 6564 2d64 796e 616d 6963  er-based-dynamic
-00000dd0: 732d 616e 642d 7261 6f62 6c61 636b 7765  s-and-raoblackwe
-00000de0: 6c6c 2d65 7374 696d 6174 6f72 2d66 6f72  ll-estimator-for
-00000df0: 2d61 6c63 6865 6d69 6361 6c2d 6672 6565  -alchemical-free
-00000e00: 2d65 6e65 7267 792d 6361 6c63 756c 6174  -energy-calculat
-00000e10: 696f 6e94 6168 235d 9468 255d 948c 6567  ion.ah#].h%]..eg
-00000e20: 6962 6273 2073 616d 706c 6572 2d62 6173  ibbs sampler-bas
-00000e30: 6564 20ce bb2d 6479 6e61 6d69 6373 2061  ed ..-dynamics a
-00000e40: 6e64 2072 616f e280 9362 6c61 636b 7765  nd rao...blackwe
-00000e50: 6c6c 2065 7374 696d 6174 6f72 2066 6f72  ll estimator for
-00000e60: 2061 6c63 6865 6d69 6361 6c20 6672 6565   alchemical free
-00000e70: 2065 6e65 7267 7920 6361 6c63 756c 6174   energy calculat
-00000e80: 696f 6e2e 9461 6827 5d94 6829 5d94 8c06  ion..ah'].h)]...
-00000e90: 7265 6675 7269 9468 b075 682b 6864 6873  refuri.h.uh+hdhs
-00000ea0: 4b01 681b 6898 7562 6816 8c02 2020 9485  K.h.h.ubh...  ..
-00000eb0: 9481 947d 9428 681b 6898 681c 6803 681d  ...}.(h.h.h.h.h.
-00000ec0: 4e68 1e4e 7562 6879 2981 947d 9428 6805  Nh.Nubhy)..}.(h.
-00000ed0: 8c19 2a4a 2e20 4368 656d 2e20 5468 656f  ..*J. Chem. Theo
-00000ee0: 7279 2043 6f6d 7075 742e 2a94 6807 5d94  ry Comput.*.h.].
-00000ef0: 6816 8c17 4a2e 2043 6865 6d2e 2054 6865  h...J. Chem. The
-00000f00: 6f72 7920 436f 6d70 7574 2e94 8594 8194  ory Comput......
-00000f10: 7d94 2868 1b68 c268 1c68 0368 1d4e 681e  }.(h.h.h.h.h.Nh.
-00000f20: 4e75 6261 681f 7d94 2868 215d 9468 235d  Nubah.}.(h!].h#]
-00000f30: 9468 255d 9468 275d 9468 295d 9475 682b  .h%].h'].h)].uh+
-00000f40: 6878 681b 6898 7562 6568 1f7d 9428 6821  hxh.h.ubeh.}.(h!
-00000f50: 5d94 6823 5d94 6825 5d94 6827 5d94 6829  ].h#].h%].h'].h)
-00000f60: 5d94 7568 2b68 2d68 1d68 2c68 1e4b 0868  ].uh+h-h.h,h.K.h
-00000f70: 1b68 9475 6261 681f 7d94 2868 215d 9468  .h.ubah.}.(h!].h
-00000f80: 235d 9468 255d 9468 275d 9468 295d 9475  #].h%].h'].h)].u
-00000f90: 682b 6842 681b 683f 681c 6803 681d 682c  h+hBh.h?h.h.h.h,
-00000fa0: 681e 4e75 6268 4329 8194 7d94 2868 058c  h.NubhC)..}.(h..
-00000fb0: b453 6869 7274 732c 204d 6963 6861 656c  .Shirts, Michael
-00000fc0: 2052 2e2c 2061 6e64 204a 6f68 6e20 442e   R., and John D.
-00000fd0: 2043 686f 6465 7261 2e20 2832 3030 3829   Chodera. (2008)
-00000fe0: 2060 5374 6174 6973 7469 6361 6c6c 7920   `Statistically 
-00000ff0: 4f70 7469 6d61 6c20 416e 616c 7973 6973  Optimal Analysis
-00001000: 206f 6620 5361 6d70 6c65 7320 6672 6f6d   of Samples from
-00001010: 204d 756c 7469 706c 6520 4571 7569 6c69   Multiple Equili
-00001020: 6272 6975 6d20 5374 6174 6573 2e20 3c68  brium States. <h
-00001030: 7474 7073 3a2f 2f64 6f69 2e6f 7267 2f31  ttps://doi.org/1
-00001040: 302e 3130 3633 2f31 2e32 3937 3831 3737  0.1063/1.2978177
-00001050: 3e60 5f20 2a4a 2e20 4368 656d 2e20 5068  >`_ *J. Chem. Ph
-00001060: 7973 2e2a 0a94 6807 5d94 682e 2981 947d  ys.*..h.].h.)..}
-00001070: 9428 6805 8cb3 5368 6972 7473 2c20 4d69  .(h...Shirts, Mi
-00001080: 6368 6165 6c20 522e 2c20 616e 6420 4a6f  chael R., and Jo
-00001090: 686e 2044 2e20 4368 6f64 6572 612e 2028  hn D. Chodera. (
-000010a0: 3230 3038 2920 6053 7461 7469 7374 6963  2008) `Statistic
-000010b0: 616c 6c79 204f 7074 696d 616c 2041 6e61  ally Optimal Ana
-000010c0: 6c79 7369 7320 6f66 2053 616d 706c 6573  lysis of Samples
-000010d0: 2066 726f 6d20 4d75 6c74 6970 6c65 2045   from Multiple E
-000010e0: 7175 696c 6962 7269 756d 2053 7461 7465  quilibrium State
-000010f0: 732e 203c 6874 7470 733a 2f2f 646f 692e  s. <https://doi.
-00001100: 6f72 672f 3130 2e31 3036 332f 312e 3239  org/10.1063/1.29
-00001110: 3738 3137 373e 605f 202a 4a2e 2043 6865  78177>`_ *J. Che
-00001120: 6d2e 2050 6879 732e 2a94 6807 5d94 2868  m. Phys.*.h.].(h
-00001130: 168c 3053 6869 7274 732c 204d 6963 6861  ..0Shirts, Micha
-00001140: 656c 2052 2e2c 2061 6e64 204a 6f68 6e20  el R., and John 
-00001150: 442e 2043 686f 6465 7261 2e20 2832 3030  D. Chodera. (200
-00001160: 3829 2094 8594 8194 7d94 2868 1b68 e068  8) .....}.(h.h.h
-00001170: 1c68 0368 1d4e 681e 4e75 6268 5129 8194  .h.h.Nh.NubhQ)..
-00001180: 7d94 2868 058c 7260 5374 6174 6973 7469  }.(h..r`Statisti
-00001190: 6361 6c6c 7920 4f70 7469 6d61 6c20 416e  cally Optimal An
-000011a0: 616c 7973 6973 206f 6620 5361 6d70 6c65  alysis of Sample
-000011b0: 7320 6672 6f6d 204d 756c 7469 706c 6520  s from Multiple 
-000011c0: 4571 7569 6c69 6272 6975 6d20 5374 6174  Equilibrium Stat
-000011d0: 6573 2e20 3c68 7474 7073 3a2f 2f64 6f69  es. <https://doi
-000011e0: 2e6f 7267 2f31 302e 3130 3633 2f31 2e32  .org/10.1063/1.2
-000011f0: 3937 3831 3737 3e60 5f94 6807 5d94 6816  978177>`_.h.].h.
-00001200: 8c4b 5374 6174 6973 7469 6361 6c6c 7920  .KStatistically 
-00001210: 4f70 7469 6d61 6c20 416e 616c 7973 6973  Optimal Analysis
-00001220: 206f 6620 5361 6d70 6c65 7320 6672 6f6d   of Samples from
-00001230: 204d 756c 7469 706c 6520 4571 7569 6c69   Multiple Equili
-00001240: 6272 6975 6d20 5374 6174 6573 2e94 8594  brium States....
-00001250: 8194 7d94 2868 1b68 e868 1c68 0368 1d4e  ..}.(h.h.h.h.h.N
-00001260: 681e 4e75 6261 681f 7d94 2868 215d 9468  h.Nubah.}.(h!].h
-00001270: 235d 9468 255d 9468 275d 9468 295d 948c  #].h%].h'].h)]..
-00001280: 046e 616d 6594 8c4b 5374 6174 6973 7469  .name..KStatisti
-00001290: 6361 6c6c 7920 4f70 7469 6d61 6c20 416e  cally Optimal An
-000012a0: 616c 7973 6973 206f 6620 5361 6d70 6c65  alysis of Sample
-000012b0: 7320 6672 6f6d 204d 756c 7469 706c 6520  s from Multiple 
-000012c0: 4571 7569 6c69 6272 6975 6d20 5374 6174  Equilibrium Stat
-000012d0: 6573 2e94 6862 8c21 6874 7470 733a 2f2f  es..hb.!https://
-000012e0: 646f 692e 6f72 672f 3130 2e31 3036 332f  doi.org/10.1063/
-000012f0: 312e 3239 3738 3137 3794 7568 2b68 5068  1.2978177.uh+hPh
-00001300: 1b68 e075 6268 6529 8194 7d94 2868 058c  .h.ubhe)..}.(h..
-00001310: 2420 3c68 7474 7073 3a2f 2f64 6f69 2e6f  $ <https://doi.o
-00001320: 7267 2f31 302e 3130 3633 2f31 2e32 3937  rg/10.1063/1.297
-00001330: 3831 3737 3e94 6807 5d94 681f 7d94 2868  8177>.h.].h.}.(h
-00001340: 215d 948c 4a73 7461 7469 7374 6963 616c  !]..Jstatistical
-00001350: 6c79 2d6f 7074 696d 616c 2d61 6e61 6c79  ly-optimal-analy
-00001360: 7369 732d 6f66 2d73 616d 706c 6573 2d66  sis-of-samples-f
-00001370: 726f 6d2d 6d75 6c74 6970 6c65 2d65 7175  rom-multiple-equ
-00001380: 696c 6962 7269 756d 2d73 7461 7465 7394  ilibrium-states.
-00001390: 6168 235d 9468 255d 948c 4b73 7461 7469  ah#].h%]..Kstati
-000013a0: 7374 6963 616c 6c79 206f 7074 696d 616c  stically optimal
-000013b0: 2061 6e61 6c79 7369 7320 6f66 2073 616d   analysis of sam
-000013c0: 706c 6573 2066 726f 6d20 6d75 6c74 6970  ples from multip
-000013d0: 6c65 2065 7175 696c 6962 7269 756d 2073  le equilibrium s
-000013e0: 7461 7465 732e 9461 6827 5d94 6829 5d94  tates..ah'].h)].
-000013f0: 8c06 7265 6675 7269 9468 f875 682b 6864  ..refuri.h.uh+hd
-00001400: 6873 4b01 681b 68e0 7562 6816 8c01 2094  hsK.h.h.ubh... .
-00001410: 8594 8194 7d94 2868 1b68 e068 1c68 0368  ....}.(h.h.h.h.h
-00001420: 1d4e 681e 4e75 6268 7929 8194 7d94 2868  .Nh.Nubhy)..}.(h
-00001430: 058c 102a 4a2e 2043 6865 6d2e 2050 6879  ...*J. Chem. Phy
-00001440: 732e 2a94 6807 5d94 6816 8c0e 4a2e 2043  s.*.h.].h...J. C
-00001450: 6865 6d2e 2050 6879 732e 9485 9481 947d  hem. Phys......}
-00001460: 9428 681b 6a0a 0100 0068 1c68 0368 1d4e  .(h.j....h.h.h.N
-00001470: 681e 4e75 6261 681f 7d94 2868 215d 9468  h.Nubah.}.(h!].h
-00001480: 235d 9468 255d 9468 275d 9468 295d 9475  #].h%].h'].h)].u
-00001490: 682b 6878 681b 68e0 7562 6568 1f7d 9428  h+hxh.h.ubeh.}.(
-000014a0: 6821 5d94 6823 5d94 6825 5d94 6827 5d94  h!].h#].h%].h'].
-000014b0: 6829 5d94 7568 2b68 2d68 1d68 2c68 1e4b  h)].uh+h-h.h,h.K
-000014c0: 0a68 1b68 dc75 6261 681f 7d94 2868 215d  .h.h.ubah.}.(h!]
-000014d0: 9468 235d 9468 255d 9468 275d 9468 295d  .h#].h%].h'].h)]
-000014e0: 9475 682b 6842 681b 683f 681c 6803 681d  .uh+hBh.h?h.h.h.
-000014f0: 682c 681e 4e75 6268 4329 8194 7d94 2868  h,h.NubhC)..}.(h
-00001500: 058c a642 656e 6e65 7474 2c20 4368 6172  ...Bennett, Char
-00001510: 6c65 7320 482e 2028 3139 3736 2920 6045  les H. (1976) `E
-00001520: 6666 6963 6965 6e74 2045 7374 696d 6174  fficient Estimat
-00001530: 696f 6e20 6f66 2046 7265 6520 456e 6572  ion of Free Ener
-00001540: 6779 2044 6966 6665 7265 6e63 6573 2066  gy Differences f
-00001550: 726f 6d20 4d6f 6e74 6520 4361 726c 6f20  rom Monte Carlo 
-00001560: 4461 7461 2e20 3c68 7474 7073 3a2f 2f64  Data. <https://d
-00001570: 6f69 2e6f 7267 2f31 302e 3130 3136 2f30  oi.org/10.1016/0
-00001580: 3032 312d 3939 3931 2837 3629 3930 3037  021-9991(76)9007
-00001590: 382d 343e 605f 204a 2e20 436f 6d70 7574  8-4>`_ J. Comput
-000015a0: 2e20 5068 7973 2e0a 0a94 6807 5d94 682e  . Phys....h.].h.
-000015b0: 2981 947d 9428 6805 8ca4 4265 6e6e 6574  )..}.(h...Bennet
-000015c0: 742c 2043 6861 726c 6573 2048 2e20 2831  t, Charles H. (1
-000015d0: 3937 3629 2060 4566 6669 6369 656e 7420  976) `Efficient 
-000015e0: 4573 7469 6d61 7469 6f6e 206f 6620 4672  Estimation of Fr
-000015f0: 6565 2045 6e65 7267 7920 4469 6666 6572  ee Energy Differ
-00001600: 656e 6365 7320 6672 6f6d 204d 6f6e 7465  ences from Monte
-00001610: 2043 6172 6c6f 2044 6174 612e 203c 6874   Carlo Data. <ht
-00001620: 7470 733a 2f2f 646f 692e 6f72 672f 3130  tps://doi.org/10
-00001630: 2e31 3031 362f 3030 3231 2d39 3939 3128  .1016/0021-9991(
-00001640: 3736 2939 3030 3738 2d34 3e60 5f20 4a2e  76)90078-4>`_ J.
-00001650: 2043 6f6d 7075 742e 2050 6879 732e 9468   Comput. Phys..h
-00001660: 075d 9428 6816 8c1b 4265 6e6e 6574 742c  .].(h...Bennett,
-00001670: 2043 6861 726c 6573 2048 2e20 2831 3937   Charles H. (197
-00001680: 3629 2094 8594 8194 7d94 2868 1b6a 2801  6) .....}.(h.j(.
-00001690: 0000 681c 6803 681d 4e68 1e4e 7562 6851  ..h.h.h.Nh.NubhQ
-000016a0: 2981 947d 9428 6805 8c78 6045 6666 6963  )..}.(h..x`Effic
-000016b0: 6965 6e74 2045 7374 696d 6174 696f 6e20  ient Estimation 
-000016c0: 6f66 2046 7265 6520 456e 6572 6779 2044  of Free Energy D
-000016d0: 6966 6665 7265 6e63 6573 2066 726f 6d20  ifferences from 
-000016e0: 4d6f 6e74 6520 4361 726c 6f20 4461 7461  Monte Carlo Data
-000016f0: 2e20 3c68 7474 7073 3a2f 2f64 6f69 2e6f  . <https://doi.o
-00001700: 7267 2f31 302e 3130 3136 2f30 3032 312d  rg/10.1016/0021-
-00001710: 3939 3931 2837 3629 3930 3037 382d 343e  9991(76)90078-4>
-00001720: 605f 9468 075d 9468 168c 4645 6666 6963  `_.h.].h..FEffic
-00001730: 6965 6e74 2045 7374 696d 6174 696f 6e20  ient Estimation 
-00001740: 6f66 2046 7265 6520 456e 6572 6779 2044  of Free Energy D
-00001750: 6966 6665 7265 6e63 6573 2066 726f 6d20  ifferences from 
-00001760: 4d6f 6e74 6520 4361 726c 6f20 4461 7461  Monte Carlo Data
-00001770: 2e94 8594 8194 7d94 2868 1b6a 3001 0000  ......}.(h.j0...
-00001780: 681c 6803 681d 4e68 1e4e 7562 6168 1f7d  h.h.h.Nh.Nubah.}
-00001790: 9428 6821 5d94 6823 5d94 6825 5d94 6827  .(h!].h#].h%].h'
-000017a0: 5d94 6829 5d94 8c04 6e61 6d65 948c 4645  ].h)]...name..FE
-000017b0: 6666 6963 6965 6e74 2045 7374 696d 6174  fficient Estimat
-000017c0: 696f 6e20 6f66 2046 7265 6520 456e 6572  ion of Free Ener
-000017d0: 6779 2044 6966 6665 7265 6e63 6573 2066  gy Differences f
-000017e0: 726f 6d20 4d6f 6e74 6520 4361 726c 6f20  rom Monte Carlo 
-000017f0: 4461 7461 2e94 6862 8c2c 6874 7470 733a  Data..hb.,https:
-00001800: 2f2f 646f 692e 6f72 672f 3130 2e31 3031  //doi.org/10.101
-00001810: 362f 3030 3231 2d39 3939 3128 3736 2939  6/0021-9991(76)9
-00001820: 3030 3738 2d34 9475 682b 6850 681b 6a28  0078-4.uh+hPh.j(
-00001830: 0100 0075 6268 6529 8194 7d94 2868 058c  ...ubhe)..}.(h..
-00001840: 2f20 3c68 7474 7073 3a2f 2f64 6f69 2e6f  / <https://doi.o
-00001850: 7267 2f31 302e 3130 3136 2f30 3032 312d  rg/10.1016/0021-
-00001860: 3939 3931 2837 3629 3930 3037 382d 343e  9991(76)90078-4>
-00001870: 9468 075d 9468 1f7d 9428 6821 5d94 8c45  .h.].h.}.(h!]..E
-00001880: 6566 6669 6369 656e 742d 6573 7469 6d61  efficient-estima
-00001890: 7469 6f6e 2d6f 662d 6672 6565 2d65 6e65  tion-of-free-ene
-000018a0: 7267 792d 6469 6666 6572 656e 6365 732d  rgy-differences-
-000018b0: 6672 6f6d 2d6d 6f6e 7465 2d63 6172 6c6f  from-monte-carlo
-000018c0: 2d64 6174 6194 6168 235d 9468 255d 948c  -data.ah#].h%]..
-000018d0: 4665 6666 6963 6965 6e74 2065 7374 696d  Fefficient estim
-000018e0: 6174 696f 6e20 6f66 2066 7265 6520 656e  ation of free en
-000018f0: 6572 6779 2064 6966 6665 7265 6e63 6573  ergy differences
-00001900: 2066 726f 6d20 6d6f 6e74 6520 6361 726c   from monte carl
-00001910: 6f20 6461 7461 2e94 6168 275d 9468 295d  o data..ah'].h)]
-00001920: 948c 0672 6566 7572 6994 6a40 0100 0075  ...refuri.j@...u
-00001930: 682b 6864 6873 4b01 681b 6a28 0100 0075  h+hdhsK.h.j(...u
-00001940: 6268 168c 1120 4a2e 2043 6f6d 7075 742e  bh... J. Comput.
-00001950: 2050 6879 732e 9485 9481 947d 9428 681b   Phys......}.(h.
-00001960: 6a28 0100 0068 1c68 0368 1d4e 681e 4e75  j(...h.h.h.Nh.Nu
-00001970: 6265 681f 7d94 2868 215d 9468 235d 9468  beh.}.(h!].h#].h
-00001980: 255d 9468 275d 9468 295d 9475 682b 682d  %].h'].h)].uh+h-
-00001990: 681d 682c 681e 4b0c 681b 6a24 0100 0075  h.h,h.K.h.j$...u
-000019a0: 6261 681f 7d94 2868 215d 9468 235d 9468  bah.}.(h!].h#].h
-000019b0: 255d 9468 275d 9468 295d 9475 682b 6842  %].h'].h)].uh+hB
-000019c0: 681b 683f 681c 6803 681d 682c 681e 4e75  h.h?h.h.h.h,h.Nu
-000019d0: 6265 681f 7d94 2868 215d 9468 235d 9468  beh.}.(h!].h#].h
-000019e0: 255d 9468 275d 9468 295d 948c 0865 6e75  %].h'].h)]...enu
-000019f0: 6d74 7970 6594 8c06 6172 6162 6963 948c  mtype...arabic..
-00001a00: 0670 7265 6669 7894 6806 8c06 7375 6666  .prefix.h...suff
-00001a10: 6978 948c 012e 9475 682b 683d 681b 680c  ix.....uh+h=h.h.
-00001a20: 681c 6803 681d 682c 681e 4b06 7562 6568  h.h.h.h,h.K.ubeh
-00001a30: 1f7d 9428 6821 5d94 8c0a 7265 6665 7265  .}.(h!]...refere
-00001a40: 6e63 6573 9461 6823 5d94 6825 5d94 8c0a  nces.ah#].h%]...
-00001a50: 7265 6665 7265 6e63 6573 9461 6827 5d94  references.ah'].
-00001a60: 6829 5d94 7568 2b68 0a68 1b68 0368 1c68  h)].uh+h.h.h.h.h
-00001a70: 0368 1d68 2c68 1e4b 0275 6261 681f 7d94  .h.h,h.K.ubah.}.
-00001a80: 2868 215d 9468 235d 9468 255d 9468 275d  (h!].h#].h%].h']
-00001a90: 9468 295d 948c 0673 6f75 7263 6594 682c  .h)]...source.h,
-00001aa0: 7568 2b68 018c 0e63 7572 7265 6e74 5f73  uh+h...current_s
-00001ab0: 6f75 7263 6594 4e8c 0c63 7572 7265 6e74  ource.N..current
-00001ac0: 5f6c 696e 6594 4e8c 0873 6574 7469 6e67  _line.N..setting
-00001ad0: 7394 8c11 646f 6375 7469 6c73 2e66 726f  s...docutils.fro
-00001ae0: 6e74 656e 6494 8c06 5661 6c75 6573 9493  ntend...Values..
-00001af0: 9429 8194 7d94 2868 0f4e 8c09 6765 6e65  .)..}.(h.N..gene
-00001b00: 7261 746f 7294 4e8c 0964 6174 6573 7461  rator.N..datesta
-00001b10: 6d70 944e 8c0b 736f 7572 6365 5f6c 696e  mp.N..source_lin
-00001b20: 6b94 4e8c 0a73 6f75 7263 655f 7572 6c94  k.N..source_url.
-00001b30: 4e8c 0d74 6f63 5f62 6163 6b6c 696e 6b73  N..toc_backlinks
-00001b40: 948c 0565 6e74 7279 948c 1266 6f6f 746e  ...entry...footn
-00001b50: 6f74 655f 6261 636b 6c69 6e6b 7394 4b01  ote_backlinks.K.
-00001b60: 8c0d 7365 6374 6e75 6d5f 7866 6f72 6d94  ..sectnum_xform.
-00001b70: 4b01 8c0e 7374 7269 705f 636f 6d6d 656e  K...strip_commen
-00001b80: 7473 944e 8c1b 7374 7269 705f 656c 656d  ts.N..strip_elem
-00001b90: 656e 7473 5f77 6974 685f 636c 6173 7365  ents_with_classe
-00001ba0: 7394 4e8c 0d73 7472 6970 5f63 6c61 7373  s.N..strip_class
-00001bb0: 6573 944e 8c0c 7265 706f 7274 5f6c 6576  es.N..report_lev
-00001bc0: 656c 944b 028c 0a68 616c 745f 6c65 7665  el.K...halt_leve
-00001bd0: 6c94 4b05 8c11 6578 6974 5f73 7461 7475  l.K...exit_statu
-00001be0: 735f 6c65 7665 6c94 4b05 8c05 6465 6275  s_level.K...debu
-00001bf0: 6794 4e8c 0e77 6172 6e69 6e67 5f73 7472  g.N..warning_str
-00001c00: 6561 6d94 4e8c 0974 7261 6365 6261 636b  eam.N..traceback
-00001c10: 9488 8c0e 696e 7075 745f 656e 636f 6469  ....input_encodi
-00001c20: 6e67 948c 0975 7466 2d38 2d73 6967 948c  ng...utf-8-sig..
-00001c30: 1c69 6e70 7574 5f65 6e63 6f64 696e 675f  .input_encoding_
-00001c40: 6572 726f 725f 6861 6e64 6c65 7294 8c06  error_handler...
-00001c50: 7374 7269 6374 948c 0f6f 7574 7075 745f  strict...output_
-00001c60: 656e 636f 6469 6e67 948c 0575 7466 2d38  encoding...utf-8
-00001c70: 948c 1d6f 7574 7075 745f 656e 636f 6469  ...output_encodi
-00001c80: 6e67 5f65 7272 6f72 5f68 616e 646c 6572  ng_error_handler
-00001c90: 946a 9401 0000 8c0e 6572 726f 725f 656e  .j......error_en
-00001ca0: 636f 6469 6e67 948c 0575 7466 2d38 948c  coding...utf-8..
-00001cb0: 1c65 7272 6f72 5f65 6e63 6f64 696e 675f  .error_encoding_
-00001cc0: 6572 726f 725f 6861 6e64 6c65 7294 8c10  error_handler...
-00001cd0: 6261 636b 736c 6173 6872 6570 6c61 6365  backslashreplace
-00001ce0: 948c 0d6c 616e 6775 6167 655f 636f 6465  ...language_code
-00001cf0: 948c 0265 6e94 8c13 7265 636f 7264 5f64  ...en...record_d
-00001d00: 6570 656e 6465 6e63 6965 7394 4e8c 0663  ependencies.N..c
-00001d10: 6f6e 6669 6794 4e8c 0969 645f 7072 6566  onfig.N..id_pref
-00001d20: 6978 9468 068c 0e61 7574 6f5f 6964 5f70  ix.h...auto_id_p
-00001d30: 7265 6669 7894 8c02 6964 948c 0d64 756d  refix...id...dum
-00001d40: 705f 7365 7474 696e 6773 944e 8c0e 6475  p_settings.N..du
-00001d50: 6d70 5f69 6e74 6572 6e61 6c73 944e 8c0f  mp_internals.N..
-00001d60: 6475 6d70 5f74 7261 6e73 666f 726d 7394  dump_transforms.
-00001d70: 4e8c 0f64 756d 705f 7073 6575 646f 5f78  N..dump_pseudo_x
-00001d80: 6d6c 944e 8c10 6578 706f 7365 5f69 6e74  ml.N..expose_int
-00001d90: 6572 6e61 6c73 944e 8c0e 7374 7269 6374  ernals.N..strict
-00001da0: 5f76 6973 6974 6f72 944e 8c0f 5f64 6973  _visitor.N.._dis
-00001db0: 6162 6c65 5f63 6f6e 6669 6794 4e8c 075f  able_config.N.._
-00001dc0: 736f 7572 6365 9468 2c8c 0c5f 6465 7374  source.h,.._dest
-00001dd0: 696e 6174 696f 6e94 4e8c 0d5f 636f 6e66  ination.N.._conf
-00001de0: 6967 5f66 696c 6573 945d 948c 1666 696c  ig_files.]...fil
-00001df0: 655f 696e 7365 7274 696f 6e5f 656e 6162  e_insertion_enab
-00001e00: 6c65 6494 888c 0b72 6177 5f65 6e61 626c  led....raw_enabl
-00001e10: 6564 944b 018c 116c 696e 655f 6c65 6e67  ed.K...line_leng
-00001e20: 7468 5f6c 696d 6974 944d 1027 8c0e 7065  th_limit.M.'..pe
-00001e30: 705f 7265 6665 7265 6e63 6573 944e 8c0c  p_references.N..
-00001e40: 7065 705f 6261 7365 5f75 726c 948c 1868  pep_base_url...h
-00001e50: 7474 7073 3a2f 2f70 6570 732e 7079 7468  ttps://peps.pyth
-00001e60: 6f6e 2e6f 7267 2f94 8c15 7065 705f 6669  on.org/...pep_fi
-00001e70: 6c65 5f75 726c 5f74 656d 706c 6174 6594  le_url_template.
-00001e80: 8c08 7065 702d 2530 3464 948c 0e72 6663  ..pep-%04d...rfc
-00001e90: 5f72 6566 6572 656e 6365 7394 4e8c 0c72  _references.N..r
-00001ea0: 6663 5f62 6173 655f 7572 6c94 8c26 6874  fc_base_url..&ht
-00001eb0: 7470 733a 2f2f 6461 7461 7472 6163 6b65  tps://datatracke
-00001ec0: 722e 6965 7466 2e6f 7267 2f64 6f63 2f68  r.ietf.org/doc/h
-00001ed0: 746d 6c2f 948c 0974 6162 5f77 6964 7468  tml/...tab_width
-00001ee0: 944b 088c 1d74 7269 6d5f 666f 6f74 6e6f  .K...trim_footno
-00001ef0: 7465 5f72 6566 6572 656e 6365 5f73 7061  te_reference_spa
-00001f00: 6365 9489 8c10 7379 6e74 6178 5f68 6967  ce....syntax_hig
-00001f10: 686c 6967 6874 948c 046c 6f6e 6794 8c0c  hlight...long...
-00001f20: 736d 6172 745f 7175 6f74 6573 9488 8c13  smart_quotes....
-00001f30: 736d 6172 7471 756f 7465 735f 6c6f 6361  smartquotes_loca
-00001f40: 6c65 7394 5d94 8c1d 6368 6172 6163 7465  les.]...characte
-00001f50: 725f 6c65 7665 6c5f 696e 6c69 6e65 5f6d  r_level_inline_m
-00001f60: 6172 6b75 7094 898c 0e64 6f63 7469 746c  arkup....doctitl
-00001f70: 655f 7866 6f72 6d94 898c 0d64 6f63 696e  e_xform....docin
-00001f80: 666f 5f78 666f 726d 944b 018c 1273 6563  fo_xform.K...sec
-00001f90: 7473 7562 7469 746c 655f 7866 6f72 6d94  tsubtitle_xform.
-00001fa0: 898c 0d69 6d61 6765 5f6c 6f61 6469 6e67  ...image_loading
-00001fb0: 948c 046c 696e 6b94 8c10 656d 6265 645f  ...link...embed_
-00001fc0: 7374 796c 6573 6865 6574 9489 8c15 636c  stylesheet....cl
-00001fd0: 6f61 6b5f 656d 6169 6c5f 6164 6472 6573  oak_email_addres
-00001fe0: 7365 7394 888c 1173 6563 7469 6f6e 5f73  ses....section_s
-00001ff0: 656c 665f 6c69 6e6b 9489 8c03 656e 7694  elf_link....env.
-00002000: 4e75 628c 0872 6570 6f72 7465 7294 4e8c  Nub..reporter.N.
-00002010: 1069 6e64 6972 6563 745f 7461 7267 6574  .indirect_target
-00002020: 7394 5d94 8c11 7375 6273 7469 7475 7469  s.]...substituti
-00002030: 6f6e 5f64 6566 7394 7d94 8c12 7375 6273  on_defs.}...subs
-00002040: 7469 7475 7469 6f6e 5f6e 616d 6573 947d  titution_names.}
-00002050: 948c 0872 6566 6e61 6d65 7394 7d94 8c06  ...refnames.}...
-00002060: 7265 6669 6473 947d 948c 076e 616d 6569  refids.}...namei
-00002070: 6473 947d 9428 6a6e 0100 006a 6b01 0000  ds.}.(jn...jk...
-00002080: 686f 686c 68ba 68b7 6a02 0100 0068 ff6a  hohlh.h.j....h.j
-00002090: 4a01 0000 6a47 0100 0075 8c09 6e61 6d65  J...jG...u..name
-000020a0: 7479 7065 7394 7d94 286a 6e01 0000 8968  types.}.(jn....h
-000020b0: 6f88 68ba 886a 0201 0000 886a 4a01 0000  o.h..j.....jJ...
-000020c0: 8875 6821 7d94 286a 6b01 0000 680c 686c  .uh!}.(jk...h.hl
-000020d0: 6866 68b7 68b1 68ff 68f9 6a47 0100 006a  hfh.h.h.h.jG...j
-000020e0: 4101 0000 758c 0d66 6f6f 746e 6f74 655f  A...u..footnote_
-000020f0: 7265 6673 947d 948c 0d63 6974 6174 696f  refs.}...citatio
-00002100: 6e5f 7265 6673 947d 948c 0d61 7574 6f66  n_refs.}...autof
-00002110: 6f6f 746e 6f74 6573 945d 948c 1161 7574  ootnotes.]...aut
-00002120: 6f66 6f6f 746e 6f74 655f 7265 6673 945d  ofootnote_refs.]
-00002130: 948c 1073 796d 626f 6c5f 666f 6f74 6e6f  ...symbol_footno
-00002140: 7465 7394 5d94 8c14 7379 6d62 6f6c 5f66  tes.]...symbol_f
-00002150: 6f6f 746e 6f74 655f 7265 6673 945d 948c  ootnote_refs.]..
-00002160: 0966 6f6f 746e 6f74 6573 945d 948c 0963  .footnotes.]...c
-00002170: 6974 6174 696f 6e73 945d 948c 1261 7574  itations.]...aut
-00002180: 6f66 6f6f 746e 6f74 655f 7374 6172 7494  ofootnote_start.
-00002190: 4b01 8c15 7379 6d62 6f6c 5f66 6f6f 746e  K...symbol_footn
-000021a0: 6f74 655f 7374 6172 7494 4b00 8c0a 6964  ote_start.K...id
-000021b0: 5f63 6f75 6e74 6572 948c 0b63 6f6c 6c65  _counter...colle
-000021c0: 6374 696f 6e73 948c 0743 6f75 6e74 6572  ctions...Counter
-000021d0: 9493 947d 9485 9452 948c 0e70 6172 7365  ...}...R...parse
-000021e0: 5f6d 6573 7361 6765 7394 5d94 8c12 7472  _messages.]...tr
-000021f0: 616e 7366 6f72 6d5f 6d65 7373 6167 6573  ansform_messages
-00002200: 945d 948c 0b74 7261 6e73 666f 726d 6572  .]...transformer
-00002210: 944e 8c0b 696e 636c 7564 655f 6c6f 6794  .N..include_log.
-00002220: 5d94 8c0a 6465 636f 7261 7469 6f6e 944e  ]...decoration.N
-00002230: 681c 6803 7562 2e                        h.h.ub.
+000002d0: 7562 682e 2981 947d 9428 6805 8cd6 312e  ubh.)..}.(h...1.
+000002e0: 2058 696e 7169 616e 6720 4469 6e67 2c20   Xinqiang Ding, 
+000002f0: 4a6f 6e61 6820 5a2e 2056 696c 7365 636b  Jonah Z. Vilseck
+00000300: 2c20 4368 6172 6c65 7320 4c2e 2042 726f  , Charles L. Bro
+00000310: 6f6b 7320 4949 492e 2028 3230 3139 292e  oks III. (2019).
+00000320: 0a60 4661 7374 2053 6f6c 7665 7220 666f  .`Fast Solver fo
+00000330: 7220 4c61 7267 6520 5363 616c 6520 4d75  r Large Scale Mu
+00000340: 6c74 6973 7461 7465 2042 656e 6e65 7474  ltistate Bennett
+00000350: 2041 6363 6570 7461 6e63 6520 5261 7469   Acceptance Rati
+00000360: 6f20 4571 7561 7469 6f6e 732e 203c 6874  o Equations. <ht
+00000370: 7470 733a 2f2f 646f 692e 6f72 672f 3130  tps://doi.org/10
+00000380: 2e31 3032 312f 6163 732e 6a63 7463 2e38  .1021/acs.jctc.8
+00000390: 6230 3130 3130 3e60 5f20 202a 4a2e 2043  b01010>`_  *J. C
+000003a0: 6865 6d2e 2054 6865 6f72 7920 436f 6d70  hem. Theory Comp
+000003b0: 7574 2e2a 9468 075d 9428 6816 8c43 312e  ut.*.h.].(h..C1.
+000003c0: 2058 696e 7169 616e 6720 4469 6e67 2c20   Xinqiang Ding, 
+000003d0: 4a6f 6e61 6820 5a2e 2056 696c 7365 636b  Jonah Z. Vilseck
+000003e0: 2c20 4368 6172 6c65 7320 4c2e 2042 726f  , Charles L. Bro
+000003f0: 6f6b 7320 4949 492e 2028 3230 3139 292e  oks III. (2019).
+00000400: 0a94 8594 8194 7d94 2868 1b68 3d68 1c68  ......}.(h.h=h.h
+00000410: 0368 1d4e 681e 4e75 6268 098c 0972 6566  .h.Nh.Nubh...ref
+00000420: 6572 656e 6365 9493 9429 8194 7d94 2868  erence...)..}.(h
+00000430: 058c 7860 4661 7374 2053 6f6c 7665 7220  ..x`Fast Solver 
+00000440: 666f 7220 4c61 7267 6520 5363 616c 6520  for Large Scale 
+00000450: 4d75 6c74 6973 7461 7465 2042 656e 6e65  Multistate Benne
+00000460: 7474 2041 6363 6570 7461 6e63 6520 5261  tt Acceptance Ra
+00000470: 7469 6f20 4571 7561 7469 6f6e 732e 203c  tio Equations. <
+00000480: 6874 7470 733a 2f2f 646f 692e 6f72 672f  https://doi.org/
+00000490: 3130 2e31 3032 312f 6163 732e 6a63 7463  10.1021/acs.jctc
+000004a0: 2e38 6230 3130 3130 3e60 5f94 6807 5d94  .8b01010>`_.h.].
+000004b0: 6816 8c4a 4661 7374 2053 6f6c 7665 7220  h..JFast Solver 
+000004c0: 666f 7220 4c61 7267 6520 5363 616c 6520  for Large Scale 
+000004d0: 4d75 6c74 6973 7461 7465 2042 656e 6e65  Multistate Benne
+000004e0: 7474 2041 6363 6570 7461 6e63 6520 5261  tt Acceptance Ra
+000004f0: 7469 6f20 4571 7561 7469 6f6e 732e 9485  tio Equations...
+00000500: 9481 947d 9428 681b 6847 681c 6803 681d  ...}.(h.hGh.h.h.
+00000510: 4e68 1e4e 7562 6168 1f7d 9428 6821 5d94  Nh.Nubah.}.(h!].
+00000520: 6823 5d94 6825 5d94 6827 5d94 6829 5d94  h#].h%].h'].h)].
+00000530: 8c04 6e61 6d65 948c 4a46 6173 7420 536f  ..name..JFast So
+00000540: 6c76 6572 2066 6f72 204c 6172 6765 2053  lver for Large S
+00000550: 6361 6c65 204d 756c 7469 7374 6174 6520  cale Multistate 
+00000560: 4265 6e6e 6574 7420 4163 6365 7074 616e  Bennett Acceptan
+00000570: 6365 2052 6174 696f 2045 7175 6174 696f  ce Ratio Equatio
+00000580: 6e73 2e94 8c06 7265 6675 7269 948c 2868  ns....refuri..(h
+00000590: 7474 7073 3a2f 2f64 6f69 2e6f 7267 2f31  ttps://doi.org/1
+000005a0: 302e 3130 3231 2f61 6373 2e6a 6374 632e  0.1021/acs.jctc.
+000005b0: 3862 3031 3031 3094 7568 2b68 4568 1b68  8b01010.uh+hEh.h
+000005c0: 3d75 6268 098c 0674 6172 6765 7494 9394  =ubh...target...
+000005d0: 2981 947d 9428 6805 8c2b 203c 6874 7470  )..}.(h..+ <http
+000005e0: 733a 2f2f 646f 692e 6f72 672f 3130 2e31  s://doi.org/10.1
+000005f0: 3032 312f 6163 732e 6a63 7463 2e38 6230  021/acs.jctc.8b0
+00000600: 3130 3130 3e94 6807 5d94 681f 7d94 2868  1010>.h.].h.}.(h
+00000610: 215d 948c 4966 6173 742d 736f 6c76 6572  !]..Ifast-solver
+00000620: 2d66 6f72 2d6c 6172 6765 2d73 6361 6c65  -for-large-scale
+00000630: 2d6d 756c 7469 7374 6174 652d 6265 6e6e  -multistate-benn
+00000640: 6574 742d 6163 6365 7074 616e 6365 2d72  ett-acceptance-r
+00000650: 6174 696f 2d65 7175 6174 696f 6e73 9461  atio-equations.a
+00000660: 6823 5d94 6825 5d94 8c4a 6661 7374 2073  h#].h%]..Jfast s
+00000670: 6f6c 7665 7220 666f 7220 6c61 7267 6520  olver for large 
+00000680: 7363 616c 6520 6d75 6c74 6973 7461 7465  scale multistate
+00000690: 2062 656e 6e65 7474 2061 6363 6570 7461   bennett accepta
+000006a0: 6e63 6520 7261 7469 6f20 6571 7561 7469  nce ratio equati
+000006b0: 6f6e 732e 9461 6827 5d94 6829 5d94 8c06  ons..ah'].h)]...
+000006c0: 7265 6675 7269 9468 5875 682b 6859 8c0a  refuri.hXuh+hY..
+000006d0: 7265 6665 7265 6e63 6564 944b 0168 1b68  referenced.K.h.h
+000006e0: 3d75 6268 168c 0220 2094 8594 8194 7d94  =ubh...  .....}.
+000006f0: 2868 1b68 3d68 1c68 0368 1d4e 681e 4e75  (h.h=h.h.h.Nh.Nu
+00000700: 6268 098c 0865 6d70 6861 7369 7394 9394  bh...emphasis...
+00000710: 2981 947d 9428 6805 8c19 2a4a 2e20 4368  )..}.(h...*J. Ch
+00000720: 656d 2e20 5468 656f 7279 2043 6f6d 7075  em. Theory Compu
+00000730: 742e 2a94 6807 5d94 6816 8c17 4a2e 2043  t.*.h.].h...J. C
+00000740: 6865 6d2e 2054 6865 6f72 7920 436f 6d70  hem. Theory Comp
+00000750: 7574 2e94 8594 8194 7d94 2868 1b68 6f68  ut......}.(h.hoh
+00000760: 1c68 0368 1d4e 681e 4e75 6261 681f 7d94  .h.h.Nh.Nubah.}.
+00000770: 2868 215d 9468 235d 9468 255d 9468 275d  (h!].h#].h%].h']
+00000780: 9468 295d 9475 682b 686d 681b 683d 7562  .h)].uh+hmh.h=ub
+00000790: 6568 1f7d 9428 6821 5d94 6823 5d94 6825  eh.}.(h!].h#].h%
+000007a0: 5d94 6827 5d94 6829 5d94 7568 2b68 2d68  ].h'].h)].uh+h-h
+000007b0: 1d68 2c68 1e4b 0668 1b68 0c68 1c68 0375  .h,h.K.h.h.h.h.u
+000007c0: 6268 2e29 8194 7d94 2868 0558 0001 0000  bh.)..}.(h.X....
+000007d0: 322e 2058 696e 7169 616e 6720 4469 6e67  2. Xinqiang Ding
+000007e0: 2c20 4a6f 6e61 6820 5a2e 2056 696c 7365  , Jonah Z. Vilse
+000007f0: 636b 2c20 5279 616e 204c 2e20 4861 7965  ck, Ryan L. Haye
+00000800: 732c 2043 6861 726c 6573 204c 2e20 4272  s, Charles L. Br
+00000810: 6f6f 6b73 2049 4949 2e20 2832 3031 3729  ooks III. (2017)
+00000820: 2e0a 6047 6962 6273 2053 616d 706c 6572  ..`Gibbs Sampler
+00000830: 2d62 6173 6564 20ce bb2d 6479 6e61 6d69  -based ..-dynami
+00000840: 6373 2061 6e64 2052 616f e280 9342 6c61  cs and Rao...Bla
+00000850: 636b 7765 6c6c 2045 7374 696d 6174 6f72  ckwell Estimator
+00000860: 2066 6f72 2041 6c63 6865 6d69 6361 6c20   for Alchemical 
+00000870: 4672 6565 2045 6e65 7267 7920 4361 6c63  Free Energy Calc
+00000880: 756c 6174 696f 6e2e 203c 6874 7470 733a  ulation. <https:
+00000890: 2f2f 646f 692e 6f72 672f 3130 2e31 3032  //doi.org/10.102
+000008a0: 312f 6163 732e 6a63 7463 2e37 6230 3032  1/acs.jctc.7b002
+000008b0: 3034 3e60 5f20 202a 4a2e 2043 6865 6d2e  04>`_  *J. Chem.
+000008c0: 2054 6865 6f72 7920 436f 6d70 7574 2e2a   Theory Comput.*
+000008d0: 9468 075d 9428 6816 8c52 322e 2058 696e  .h.].(h..R2. Xin
+000008e0: 7169 616e 6720 4469 6e67 2c20 4a6f 6e61  qiang Ding, Jona
+000008f0: 6820 5a2e 2056 696c 7365 636b 2c20 5279  h Z. Vilseck, Ry
+00000900: 616e 204c 2e20 4861 7965 732c 2043 6861  an L. Hayes, Cha
+00000910: 726c 6573 204c 2e20 4272 6f6f 6b73 2049  rles L. Brooks I
+00000920: 4949 2e20 2832 3031 3729 2e0a 9485 9481  II. (2017)......
+00000930: 947d 9428 681b 6883 681c 6803 681d 4e68  .}.(h.h.h.h.h.Nh
+00000940: 1e4e 7562 6846 2981 947d 9428 6805 8c93  .NubhF)..}.(h...
+00000950: 6047 6962 6273 2053 616d 706c 6572 2d62  `Gibbs Sampler-b
+00000960: 6173 6564 20ce bb2d 6479 6e61 6d69 6373  ased ..-dynamics
+00000970: 2061 6e64 2052 616f e280 9342 6c61 636b   and Rao...Black
+00000980: 7765 6c6c 2045 7374 696d 6174 6f72 2066  well Estimator f
+00000990: 6f72 2041 6c63 6865 6d69 6361 6c20 4672  or Alchemical Fr
+000009a0: 6565 2045 6e65 7267 7920 4361 6c63 756c  ee Energy Calcul
+000009b0: 6174 696f 6e2e 203c 6874 7470 733a 2f2f  ation. <https://
+000009c0: 646f 692e 6f72 672f 3130 2e31 3032 312f  doi.org/10.1021/
+000009d0: 6163 732e 6a63 7463 2e37 6230 3032 3034  acs.jctc.7b00204
+000009e0: 3e60 5f94 6807 5d94 6816 8c65 4769 6262  >`_.h.].h..eGibb
+000009f0: 7320 5361 6d70 6c65 722d 6261 7365 6420  s Sampler-based 
+00000a00: cebb 2d64 796e 616d 6963 7320 616e 6420  ..-dynamics and 
+00000a10: 5261 6fe2 8093 426c 6163 6b77 656c 6c20  Rao...Blackwell 
+00000a20: 4573 7469 6d61 746f 7220 666f 7220 416c  Estimator for Al
+00000a30: 6368 656d 6963 616c 2046 7265 6520 456e  chemical Free En
+00000a40: 6572 6779 2043 616c 6375 6c61 7469 6f6e  ergy Calculation
+00000a50: 2e94 8594 8194 7d94 2868 1b68 8b68 1c68  ......}.(h.h.h.h
+00000a60: 0368 1d4e 681e 4e75 6261 681f 7d94 2868  .h.Nh.Nubah.}.(h
+00000a70: 215d 9468 235d 9468 255d 9468 275d 9468  !].h#].h%].h'].h
+00000a80: 295d 948c 046e 616d 6594 8c65 4769 6262  )]...name..eGibb
+00000a90: 7320 5361 6d70 6c65 722d 6261 7365 6420  s Sampler-based 
+00000aa0: cebb 2d64 796e 616d 6963 7320 616e 6420  ..-dynamics and 
+00000ab0: 5261 6fe2 8093 426c 6163 6b77 656c 6c20  Rao...Blackwell 
+00000ac0: 4573 7469 6d61 746f 7220 666f 7220 416c  Estimator for Al
+00000ad0: 6368 656d 6963 616c 2046 7265 6520 456e  chemical Free En
+00000ae0: 6572 6779 2043 616c 6375 6c61 7469 6f6e  ergy Calculation
+00000af0: 2e94 6857 8c28 6874 7470 733a 2f2f 646f  ..hW.(https://do
+00000b00: 692e 6f72 672f 3130 2e31 3032 312f 6163  i.org/10.1021/ac
+00000b10: 732e 6a63 7463 2e37 6230 3032 3034 9475  s.jctc.7b00204.u
+00000b20: 682b 6845 681b 6883 7562 685a 2981 947d  h+hEh.h.ubhZ)..}
+00000b30: 9428 6805 8c2b 203c 6874 7470 733a 2f2f  .(h..+ <https://
+00000b40: 646f 692e 6f72 672f 3130 2e31 3032 312f  doi.org/10.1021/
+00000b50: 6163 732e 6a63 7463 2e37 6230 3032 3034  acs.jctc.7b00204
+00000b60: 3e94 6807 5d94 681f 7d94 2868 215d 948c  >.h.].h.}.(h!]..
+00000b70: 5e67 6962 6273 2d73 616d 706c 6572 2d62  ^gibbs-sampler-b
+00000b80: 6173 6564 2d64 796e 616d 6963 732d 616e  ased-dynamics-an
+00000b90: 642d 7261 6f62 6c61 636b 7765 6c6c 2d65  d-raoblackwell-e
+00000ba0: 7374 696d 6174 6f72 2d66 6f72 2d61 6c63  stimator-for-alc
+00000bb0: 6865 6d69 6361 6c2d 6672 6565 2d65 6e65  hemical-free-ene
+00000bc0: 7267 792d 6361 6c63 756c 6174 696f 6e94  rgy-calculation.
+00000bd0: 6168 235d 9468 255d 948c 6567 6962 6273  ah#].h%]..egibbs
+00000be0: 2073 616d 706c 6572 2d62 6173 6564 20ce   sampler-based .
+00000bf0: bb2d 6479 6e61 6d69 6373 2061 6e64 2072  .-dynamics and r
+00000c00: 616f e280 9362 6c61 636b 7765 6c6c 2065  ao...blackwell e
+00000c10: 7374 696d 6174 6f72 2066 6f72 2061 6c63  stimator for alc
+00000c20: 6865 6d69 6361 6c20 6672 6565 2065 6e65  hemical free ene
+00000c30: 7267 7920 6361 6c63 756c 6174 696f 6e2e  rgy calculation.
+00000c40: 9461 6827 5d94 6829 5d94 8c06 7265 6675  .ah'].h)]...refu
+00000c50: 7269 9468 9b75 682b 6859 6868 4b01 681b  ri.h.uh+hYhhK.h.
+00000c60: 6883 7562 6816 8c02 2020 9485 9481 947d  h.ubh...  .....}
+00000c70: 9428 681b 6883 681c 6803 681d 4e68 1e4e  .(h.h.h.h.h.Nh.N
+00000c80: 7562 686e 2981 947d 9428 6805 8c19 2a4a  ubhn)..}.(h...*J
+00000c90: 2e20 4368 656d 2e20 5468 656f 7279 2043  . Chem. Theory C
+00000ca0: 6f6d 7075 742e 2a94 6807 5d94 6816 8c17  omput.*.h.].h...
+00000cb0: 4a2e 2043 6865 6d2e 2054 6865 6f72 7920  J. Chem. Theory 
+00000cc0: 436f 6d70 7574 2e94 8594 8194 7d94 2868  Comput......}.(h
+00000cd0: 1b68 ad68 1c68 0368 1d4e 681e 4e75 6261  .h.h.h.h.Nh.Nuba
+00000ce0: 681f 7d94 2868 215d 9468 235d 9468 255d  h.}.(h!].h#].h%]
+00000cf0: 9468 275d 9468 295d 9475 682b 686d 681b  .h'].h)].uh+hmh.
+00000d00: 6883 7562 6568 1f7d 9428 6821 5d94 6823  h.ubeh.}.(h!].h#
+00000d10: 5d94 6825 5d94 6827 5d94 6829 5d94 7568  ].h%].h'].h)].uh
+00000d20: 2b68 2d68 1d68 2c68 1e4b 0968 1b68 0c68  +h-h.h,h.K.h.h.h
+00000d30: 1c68 0375 6268 2e29 8194 7d94 2868 058c  .h.ubh.)..}.(h..
+00000d40: b633 2e20 5368 6972 7473 2c20 4d69 6368  .3. Shirts, Mich
+00000d50: 6165 6c20 522e 2c20 616e 6420 4a6f 686e  ael R., and John
+00000d60: 2044 2e20 4368 6f64 6572 612e 2028 3230   D. Chodera. (20
+00000d70: 3038 290a 6053 7461 7469 7374 6963 616c  08).`Statistical
+00000d80: 6c79 204f 7074 696d 616c 2041 6e61 6c79  ly Optimal Analy
+00000d90: 7369 7320 6f66 2053 616d 706c 6573 2066  sis of Samples f
+00000da0: 726f 6d20 4d75 6c74 6970 6c65 2045 7175  rom Multiple Equ
+00000db0: 696c 6962 7269 756d 2053 7461 7465 732e  ilibrium States.
+00000dc0: 203c 6874 7470 733a 2f2f 646f 692e 6f72   <https://doi.or
+00000dd0: 672f 3130 2e31 3036 332f 312e 3239 3738  g/10.1063/1.2978
+00000de0: 3137 373e 605f 202a 4a2e 2043 6865 6d2e  177>`_ *J. Chem.
+00000df0: 2050 6879 732e 2a94 6807 5d94 2868 168c   Phys.*.h.].(h..
+00000e00: 3333 2e20 5368 6972 7473 2c20 4d69 6368  33. Shirts, Mich
+00000e10: 6165 6c20 522e 2c20 616e 6420 4a6f 686e  ael R., and John
+00000e20: 2044 2e20 4368 6f64 6572 612e 2028 3230   D. Chodera. (20
+00000e30: 3038 290a 9485 9481 947d 9428 681b 68c1  08)......}.(h.h.
+00000e40: 681c 6803 681d 4e68 1e4e 7562 6846 2981  h.h.h.Nh.NubhF).
+00000e50: 947d 9428 6805 8c72 6053 7461 7469 7374  .}.(h..r`Statist
+00000e60: 6963 616c 6c79 204f 7074 696d 616c 2041  ically Optimal A
+00000e70: 6e61 6c79 7369 7320 6f66 2053 616d 706c  nalysis of Sampl
+00000e80: 6573 2066 726f 6d20 4d75 6c74 6970 6c65  es from Multiple
+00000e90: 2045 7175 696c 6962 7269 756d 2053 7461   Equilibrium Sta
+00000ea0: 7465 732e 203c 6874 7470 733a 2f2f 646f  tes. <https://do
+00000eb0: 692e 6f72 672f 3130 2e31 3036 332f 312e  i.org/10.1063/1.
+00000ec0: 3239 3738 3137 373e 605f 9468 075d 9468  2978177>`_.h.].h
+00000ed0: 168c 4b53 7461 7469 7374 6963 616c 6c79  ..KStatistically
+00000ee0: 204f 7074 696d 616c 2041 6e61 6c79 7369   Optimal Analysi
+00000ef0: 7320 6f66 2053 616d 706c 6573 2066 726f  s of Samples fro
+00000f00: 6d20 4d75 6c74 6970 6c65 2045 7175 696c  m Multiple Equil
+00000f10: 6962 7269 756d 2053 7461 7465 732e 9485  ibrium States...
+00000f20: 9481 947d 9428 681b 68c9 681c 6803 681d  ...}.(h.h.h.h.h.
+00000f30: 4e68 1e4e 7562 6168 1f7d 9428 6821 5d94  Nh.Nubah.}.(h!].
+00000f40: 6823 5d94 6825 5d94 6827 5d94 6829 5d94  h#].h%].h'].h)].
+00000f50: 8c04 6e61 6d65 948c 4b53 7461 7469 7374  ..name..KStatist
+00000f60: 6963 616c 6c79 204f 7074 696d 616c 2041  ically Optimal A
+00000f70: 6e61 6c79 7369 7320 6f66 2053 616d 706c  nalysis of Sampl
+00000f80: 6573 2066 726f 6d20 4d75 6c74 6970 6c65  es from Multiple
+00000f90: 2045 7175 696c 6962 7269 756d 2053 7461   Equilibrium Sta
+00000fa0: 7465 732e 9468 578c 2168 7474 7073 3a2f  tes..hW.!https:/
+00000fb0: 2f64 6f69 2e6f 7267 2f31 302e 3130 3633  /doi.org/10.1063
+00000fc0: 2f31 2e32 3937 3831 3737 9475 682b 6845  /1.2978177.uh+hE
+00000fd0: 681b 68c1 7562 685a 2981 947d 9428 6805  h.h.ubhZ)..}.(h.
+00000fe0: 8c24 203c 6874 7470 733a 2f2f 646f 692e  .$ <https://doi.
+00000ff0: 6f72 672f 3130 2e31 3036 332f 312e 3239  org/10.1063/1.29
+00001000: 3738 3137 373e 9468 075d 9468 1f7d 9428  78177>.h.].h.}.(
+00001010: 6821 5d94 8c4a 7374 6174 6973 7469 6361  h!]..Jstatistica
+00001020: 6c6c 792d 6f70 7469 6d61 6c2d 616e 616c  lly-optimal-anal
+00001030: 7973 6973 2d6f 662d 7361 6d70 6c65 732d  ysis-of-samples-
+00001040: 6672 6f6d 2d6d 756c 7469 706c 652d 6571  from-multiple-eq
+00001050: 7569 6c69 6272 6975 6d2d 7374 6174 6573  uilibrium-states
+00001060: 9461 6823 5d94 6825 5d94 8c4b 7374 6174  .ah#].h%]..Kstat
+00001070: 6973 7469 6361 6c6c 7920 6f70 7469 6d61  istically optima
+00001080: 6c20 616e 616c 7973 6973 206f 6620 7361  l analysis of sa
+00001090: 6d70 6c65 7320 6672 6f6d 206d 756c 7469  mples from multi
+000010a0: 706c 6520 6571 7569 6c69 6272 6975 6d20  ple equilibrium 
+000010b0: 7374 6174 6573 2e94 6168 275d 9468 295d  states..ah'].h)]
+000010c0: 948c 0672 6566 7572 6994 68d9 7568 2b68  ...refuri.h.uh+h
+000010d0: 5968 684b 0168 1b68 c175 6268 168c 0120  YhhK.h.h.ubh... 
+000010e0: 9485 9481 947d 9428 681b 68c1 681c 6803  .....}.(h.h.h.h.
+000010f0: 681d 4e68 1e4e 7562 686e 2981 947d 9428  h.Nh.Nubhn)..}.(
+00001100: 6805 8c10 2a4a 2e20 4368 656d 2e20 5068  h...*J. Chem. Ph
+00001110: 7973 2e2a 9468 075d 9468 168c 0e4a 2e20  ys.*.h.].h...J. 
+00001120: 4368 656d 2e20 5068 7973 2e94 8594 8194  Chem. Phys......
+00001130: 7d94 2868 1b68 eb68 1c68 0368 1d4e 681e  }.(h.h.h.h.h.Nh.
+00001140: 4e75 6261 681f 7d94 2868 215d 9468 235d  Nubah.}.(h!].h#]
+00001150: 9468 255d 9468 275d 9468 295d 9475 682b  .h%].h'].h)].uh+
+00001160: 686d 681b 68c1 7562 6568 1f7d 9428 6821  hmh.h.ubeh.}.(h!
+00001170: 5d94 6823 5d94 6825 5d94 6827 5d94 6829  ].h#].h%].h'].h)
+00001180: 5d94 7568 2b68 2d68 1d68 2c68 1e4b 0c68  ].uh+h-h.h,h.K.h
+00001190: 1b68 0c68 1c68 0375 6268 2e29 8194 7d94  .h.h.h.ubh.)..}.
+000011a0: 2868 058c cc34 2e20 4b6f 6e67 2041 2c20  (h...4. Kong A, 
+000011b0: 4d63 4375 6c6c 6167 6820 502c 204d 656e  McCullagh P, Men
+000011c0: 6720 584c 2c20 4e69 636f 6c61 6520 442c  g XL, Nicolae D,
+000011d0: 2054 616e 205a 2e20 2832 3030 3329 0a60   Tan Z. (2003).`
+000011e0: 4120 7468 656f 7279 206f 6620 7374 6174  A theory of stat
+000011f0: 6973 7469 6361 6c20 6d6f 6465 6c73 2066  istical models f
+00001200: 6f72 204d 6f6e 7465 2043 6172 6c6f 2069  or Monte Carlo i
+00001210: 6e74 6567 7261 7469 6f6e 2e20 3c68 7474  ntegration. <htt
+00001220: 7073 3a2f 2f64 6f69 2e6f 7267 2f31 302e  ps://doi.org/10.
+00001230: 3131 3131 2f31 3436 372d 3938 3638 2e30  1111/1467-9868.0
+00001240: 3034 3034 3e60 5f20 2a4a 2e20 522e 2053  0404>`_ *J. R. S
+00001250: 7461 742e 2053 6f63 2e20 5365 722e 2042  tat. Soc. Ser. B
+00001260: 2053 7461 742e 204d 6574 686f 646f 6c2e   Stat. Methodol.
+00001270: 2a94 6807 5d94 2868 168c 3a34 2e20 4b6f  *.h.].(h..:4. Ko
+00001280: 6e67 2041 2c20 4d63 4375 6c6c 6167 6820  ng A, McCullagh 
+00001290: 502c 204d 656e 6720 584c 2c20 4e69 636f  P, Meng XL, Nico
+000012a0: 6c61 6520 442c 2054 616e 205a 2e20 2832  lae D, Tan Z. (2
+000012b0: 3030 3329 0a94 8594 8194 7d94 2868 1b68  003)......}.(h.h
+000012c0: ff68 1c68 0368 1d4e 681e 4e75 6268 4629  .h.h.h.Nh.NubhF)
+000012d0: 8194 7d94 2868 058c 6860 4120 7468 656f  ..}.(h..h`A theo
+000012e0: 7279 206f 6620 7374 6174 6973 7469 6361  ry of statistica
+000012f0: 6c20 6d6f 6465 6c73 2066 6f72 204d 6f6e  l models for Mon
+00001300: 7465 2043 6172 6c6f 2069 6e74 6567 7261  te Carlo integra
+00001310: 7469 6f6e 2e20 3c68 7474 7073 3a2f 2f64  tion. <https://d
+00001320: 6f69 2e6f 7267 2f31 302e 3131 3131 2f31  oi.org/10.1111/1
+00001330: 3436 372d 3938 3638 2e30 3034 3034 3e60  467-9868.00404>`
+00001340: 5f94 6807 5d94 6816 8c3b 4120 7468 656f  _.h.].h..;A theo
+00001350: 7279 206f 6620 7374 6174 6973 7469 6361  ry of statistica
+00001360: 6c20 6d6f 6465 6c73 2066 6f72 204d 6f6e  l models for Mon
+00001370: 7465 2043 6172 6c6f 2069 6e74 6567 7261  te Carlo integra
+00001380: 7469 6f6e 2e94 8594 8194 7d94 2868 1b6a  tion......}.(h.j
+00001390: 0701 0000 681c 6803 681d 4e68 1e4e 7562  ....h.h.h.Nh.Nub
+000013a0: 6168 1f7d 9428 6821 5d94 6823 5d94 6825  ah.}.(h!].h#].h%
+000013b0: 5d94 6827 5d94 6829 5d94 8c04 6e61 6d65  ].h'].h)]...name
+000013c0: 948c 3b41 2074 6865 6f72 7920 6f66 2073  ..;A theory of s
+000013d0: 7461 7469 7374 6963 616c 206d 6f64 656c  tatistical model
+000013e0: 7320 666f 7220 4d6f 6e74 6520 4361 726c  s for Monte Carl
+000013f0: 6f20 696e 7465 6772 6174 696f 6e2e 9468  o integration..h
+00001400: 578c 2768 7474 7073 3a2f 2f64 6f69 2e6f  W.'https://doi.o
+00001410: 7267 2f31 302e 3131 3131 2f31 3436 372d  rg/10.1111/1467-
+00001420: 3938 3638 2e30 3034 3034 9475 682b 6845  9868.00404.uh+hE
+00001430: 681b 68ff 7562 685a 2981 947d 9428 6805  h.h.ubhZ)..}.(h.
+00001440: 8c2a 203c 6874 7470 733a 2f2f 646f 692e  .* <https://doi.
+00001450: 6f72 672f 3130 2e31 3131 312f 3134 3637  org/10.1111/1467
+00001460: 2d39 3836 382e 3030 3430 343e 9468 075d  -9868.00404>.h.]
+00001470: 9468 1f7d 9428 6821 5d94 8c3a 612d 7468  .h.}.(h!]..:a-th
+00001480: 656f 7279 2d6f 662d 7374 6174 6973 7469  eory-of-statisti
+00001490: 6361 6c2d 6d6f 6465 6c73 2d66 6f72 2d6d  cal-models-for-m
+000014a0: 6f6e 7465 2d63 6172 6c6f 2d69 6e74 6567  onte-carlo-integ
+000014b0: 7261 7469 6f6e 9461 6823 5d94 6825 5d94  ration.ah#].h%].
+000014c0: 8c3b 6120 7468 656f 7279 206f 6620 7374  .;a theory of st
+000014d0: 6174 6973 7469 6361 6c20 6d6f 6465 6c73  atistical models
+000014e0: 2066 6f72 206d 6f6e 7465 2063 6172 6c6f   for monte carlo
+000014f0: 2069 6e74 6567 7261 7469 6f6e 2e94 6168   integration..ah
+00001500: 275d 9468 295d 948c 0672 6566 7572 6994  '].h)]...refuri.
+00001510: 6a17 0100 0075 682b 6859 6868 4b01 681b  j....uh+hYhhK.h.
+00001520: 68ff 7562 6816 8c01 2094 8594 8194 7d94  h.ubh... .....}.
+00001530: 2868 1b68 ff68 1c68 0368 1d4e 681e 4e75  (h.h.h.h.h.Nh.Nu
+00001540: 6268 6e29 8194 7d94 2868 058c 292a 4a2e  bhn)..}.(h..)*J.
+00001550: 2052 2e20 5374 6174 2e20 536f 632e 2053   R. Stat. Soc. S
+00001560: 6572 2e20 4220 5374 6174 2e20 4d65 7468  er. B Stat. Meth
+00001570: 6f64 6f6c 2e2a 9468 075d 9468 168c 274a  odol.*.h.].h..'J
+00001580: 2e20 522e 2053 7461 742e 2053 6f63 2e20  . R. Stat. Soc. 
+00001590: 5365 722e 2042 2053 7461 742e 204d 6574  Ser. B Stat. Met
+000015a0: 686f 646f 6c2e 9485 9481 947d 9428 681b  hodol......}.(h.
+000015b0: 6a29 0100 0068 1c68 0368 1d4e 681e 4e75  j)...h.h.h.Nh.Nu
+000015c0: 6261 681f 7d94 2868 215d 9468 235d 9468  bah.}.(h!].h#].h
+000015d0: 255d 9468 275d 9468 295d 9475 682b 686d  %].h'].h)].uh+hm
+000015e0: 681b 68ff 7562 6568 1f7d 9428 6821 5d94  h.h.ubeh.}.(h!].
+000015f0: 6823 5d94 6825 5d94 6827 5d94 6829 5d94  h#].h%].h'].h)].
+00001600: 7568 2b68 2d68 1d68 2c68 1e4b 0f68 1b68  uh+h-h.h,h.K.h.h
+00001610: 0c68 1c68 0375 6268 2e29 8194 7d94 2868  .h.h.ubh.)..}.(h
+00001620: 058c a735 2e20 4265 6e6e 6574 742c 2043  ...5. Bennett, C
+00001630: 6861 726c 6573 2048 2e20 2831 3937 3629  harles H. (1976)
+00001640: 0a60 4566 6669 6369 656e 7420 4573 7469  .`Efficient Esti
+00001650: 6d61 7469 6f6e 206f 6620 4672 6565 2045  mation of Free E
+00001660: 6e65 7267 7920 4469 6666 6572 656e 6365  nergy Difference
+00001670: 7320 6672 6f6d 204d 6f6e 7465 2043 6172  s from Monte Car
+00001680: 6c6f 2044 6174 612e 203c 6874 7470 733a  lo Data. <https:
+00001690: 2f2f 646f 692e 6f72 672f 3130 2e31 3031  //doi.org/10.101
+000016a0: 362f 3030 3231 2d39 3939 3128 3736 2939  6/0021-9991(76)9
+000016b0: 3030 3738 2d34 3e60 5f20 4a2e 2043 6f6d  0078-4>`_ J. Com
+000016c0: 7075 742e 2050 6879 732e 9468 075d 9428  put. Phys..h.].(
+000016d0: 6816 8c1e 352e 2042 656e 6e65 7474 2c20  h...5. Bennett, 
+000016e0: 4368 6172 6c65 7320 482e 2028 3139 3736  Charles H. (1976
+000016f0: 290a 9485 9481 947d 9428 681b 6a3d 0100  )......}.(h.j=..
+00001700: 0068 1c68 0368 1d4e 681e 4e75 6268 4629  .h.h.h.Nh.NubhF)
+00001710: 8194 7d94 2868 058c 7860 4566 6669 6369  ..}.(h..x`Effici
+00001720: 656e 7420 4573 7469 6d61 7469 6f6e 206f  ent Estimation o
+00001730: 6620 4672 6565 2045 6e65 7267 7920 4469  f Free Energy Di
+00001740: 6666 6572 656e 6365 7320 6672 6f6d 204d  fferences from M
+00001750: 6f6e 7465 2043 6172 6c6f 2044 6174 612e  onte Carlo Data.
+00001760: 203c 6874 7470 733a 2f2f 646f 692e 6f72   <https://doi.or
+00001770: 672f 3130 2e31 3031 362f 3030 3231 2d39  g/10.1016/0021-9
+00001780: 3939 3128 3736 2939 3030 3738 2d34 3e60  991(76)90078-4>`
+00001790: 5f94 6807 5d94 6816 8c46 4566 6669 6369  _.h.].h..FEffici
+000017a0: 656e 7420 4573 7469 6d61 7469 6f6e 206f  ent Estimation o
+000017b0: 6620 4672 6565 2045 6e65 7267 7920 4469  f Free Energy Di
+000017c0: 6666 6572 656e 6365 7320 6672 6f6d 204d  fferences from M
+000017d0: 6f6e 7465 2043 6172 6c6f 2044 6174 612e  onte Carlo Data.
+000017e0: 9485 9481 947d 9428 681b 6a45 0100 0068  .....}.(h.jE...h
+000017f0: 1c68 0368 1d4e 681e 4e75 6261 681f 7d94  .h.h.Nh.Nubah.}.
+00001800: 2868 215d 9468 235d 9468 255d 9468 275d  (h!].h#].h%].h']
+00001810: 9468 295d 948c 046e 616d 6594 8c46 4566  .h)]...name..FEf
+00001820: 6669 6369 656e 7420 4573 7469 6d61 7469  ficient Estimati
+00001830: 6f6e 206f 6620 4672 6565 2045 6e65 7267  on of Free Energ
+00001840: 7920 4469 6666 6572 656e 6365 7320 6672  y Differences fr
+00001850: 6f6d 204d 6f6e 7465 2043 6172 6c6f 2044  om Monte Carlo D
+00001860: 6174 612e 9468 578c 2c68 7474 7073 3a2f  ata..hW.,https:/
+00001870: 2f64 6f69 2e6f 7267 2f31 302e 3130 3136  /doi.org/10.1016
+00001880: 2f30 3032 312d 3939 3931 2837 3629 3930  /0021-9991(76)90
+00001890: 3037 382d 3494 7568 2b68 4568 1b6a 3d01  078-4.uh+hEh.j=.
+000018a0: 0000 7562 685a 2981 947d 9428 6805 8c2f  ..ubhZ)..}.(h../
+000018b0: 203c 6874 7470 733a 2f2f 646f 692e 6f72   <https://doi.or
+000018c0: 672f 3130 2e31 3031 362f 3030 3231 2d39  g/10.1016/0021-9
+000018d0: 3939 3128 3736 2939 3030 3738 2d34 3e94  991(76)90078-4>.
+000018e0: 6807 5d94 681f 7d94 2868 215d 948c 4565  h.].h.}.(h!]..Ee
+000018f0: 6666 6963 6965 6e74 2d65 7374 696d 6174  fficient-estimat
+00001900: 696f 6e2d 6f66 2d66 7265 652d 656e 6572  ion-of-free-ener
+00001910: 6779 2d64 6966 6665 7265 6e63 6573 2d66  gy-differences-f
+00001920: 726f 6d2d 6d6f 6e74 652d 6361 726c 6f2d  rom-monte-carlo-
+00001930: 6461 7461 9461 6823 5d94 6825 5d94 8c46  data.ah#].h%]..F
+00001940: 6566 6669 6369 656e 7420 6573 7469 6d61  efficient estima
+00001950: 7469 6f6e 206f 6620 6672 6565 2065 6e65  tion of free ene
+00001960: 7267 7920 6469 6666 6572 656e 6365 7320  rgy differences 
+00001970: 6672 6f6d 206d 6f6e 7465 2063 6172 6c6f  from monte carlo
+00001980: 2064 6174 612e 9461 6827 5d94 6829 5d94   data..ah'].h)].
+00001990: 8c06 7265 6675 7269 946a 5501 0000 7568  ..refuri.jU...uh
+000019a0: 2b68 5968 684b 0168 1b6a 3d01 0000 7562  +hYhhK.h.j=...ub
+000019b0: 6816 8c11 204a 2e20 436f 6d70 7574 2e20  h... J. Comput. 
+000019c0: 5068 7973 2e94 8594 8194 7d94 2868 1b6a  Phys......}.(h.j
+000019d0: 3d01 0000 681c 6803 681d 4e68 1e4e 7562  =...h.h.h.Nh.Nub
+000019e0: 6568 1f7d 9428 6821 5d94 6823 5d94 6825  eh.}.(h!].h#].h%
+000019f0: 5d94 6827 5d94 6829 5d94 7568 2b68 2d68  ].h'].h)].uh+h-h
+00001a00: 1d68 2c68 1e4b 1268 1b68 0c68 1c68 0375  .h,h.K.h.h.h.h.u
+00001a10: 6265 681f 7d94 2868 215d 948c 0a72 6566  beh.}.(h!]...ref
+00001a20: 6572 656e 6365 7394 6168 235d 9468 255d  erences.ah#].h%]
+00001a30: 948c 0a72 6566 6572 656e 6365 7394 6168  ...references.ah
+00001a40: 275d 9468 295d 9475 682b 680a 681b 6803  '].h)].uh+h.h.h.
+00001a50: 681c 6803 681d 682c 681e 4b02 7562 6168  h.h.h.h,h.K.ubah
+00001a60: 1f7d 9428 6821 5d94 6823 5d94 6825 5d94  .}.(h!].h#].h%].
+00001a70: 6827 5d94 6829 5d94 8c06 736f 7572 6365  h'].h)]...source
+00001a80: 9468 2c75 682b 6801 8c0e 6375 7272 656e  .h,uh+h...curren
+00001a90: 745f 736f 7572 6365 944e 8c0c 6375 7272  t_source.N..curr
+00001aa0: 656e 745f 6c69 6e65 944e 8c08 7365 7474  ent_line.N..sett
+00001ab0: 696e 6773 948c 1164 6f63 7574 696c 732e  ings...docutils.
+00001ac0: 6672 6f6e 7465 6e64 948c 0656 616c 7565  frontend...Value
+00001ad0: 7394 9394 2981 947d 9428 680f 4e8c 0967  s...)..}.(h.N..g
+00001ae0: 656e 6572 6174 6f72 944e 8c09 6461 7465  enerator.N..date
+00001af0: 7374 616d 7094 4e8c 0b73 6f75 7263 655f  stamp.N..source_
+00001b00: 6c69 6e6b 944e 8c0a 736f 7572 6365 5f75  link.N..source_u
+00001b10: 726c 944e 8c0d 746f 635f 6261 636b 6c69  rl.N..toc_backli
+00001b20: 6e6b 7394 8c05 656e 7472 7994 8c12 666f  nks...entry...fo
+00001b30: 6f74 6e6f 7465 5f62 6163 6b6c 696e 6b73  otnote_backlinks
+00001b40: 944b 018c 0d73 6563 746e 756d 5f78 666f  .K...sectnum_xfo
+00001b50: 726d 944b 018c 0e73 7472 6970 5f63 6f6d  rm.K...strip_com
+00001b60: 6d65 6e74 7394 4e8c 1b73 7472 6970 5f65  ments.N..strip_e
+00001b70: 6c65 6d65 6e74 735f 7769 7468 5f63 6c61  lements_with_cla
+00001b80: 7373 6573 944e 8c0d 7374 7269 705f 636c  sses.N..strip_cl
+00001b90: 6173 7365 7394 4e8c 0c72 6570 6f72 745f  asses.N..report_
+00001ba0: 6c65 7665 6c94 4b02 8c0a 6861 6c74 5f6c  level.K...halt_l
+00001bb0: 6576 656c 944b 058c 1165 7869 745f 7374  evel.K...exit_st
+00001bc0: 6174 7573 5f6c 6576 656c 944b 058c 0564  atus_level.K...d
+00001bd0: 6562 7567 944e 8c0e 7761 726e 696e 675f  ebug.N..warning_
+00001be0: 7374 7265 616d 944e 8c09 7472 6163 6562  stream.N..traceb
+00001bf0: 6163 6b94 888c 0e69 6e70 7574 5f65 6e63  ack....input_enc
+00001c00: 6f64 696e 6794 8c09 7574 662d 382d 7369  oding...utf-8-si
+00001c10: 6794 8c1c 696e 7075 745f 656e 636f 6469  g...input_encodi
+00001c20: 6e67 5f65 7272 6f72 5f68 616e 646c 6572  ng_error_handler
+00001c30: 948c 0673 7472 6963 7494 8c0f 6f75 7470  ...strict...outp
+00001c40: 7574 5f65 6e63 6f64 696e 6794 8c05 7574  ut_encoding...ut
+00001c50: 662d 3894 8c1d 6f75 7470 7574 5f65 6e63  f-8...output_enc
+00001c60: 6f64 696e 675f 6572 726f 725f 6861 6e64  oding_error_hand
+00001c70: 6c65 7294 6a98 0100 008c 0e65 7272 6f72  ler.j......error
+00001c80: 5f65 6e63 6f64 696e 6794 8c05 7574 662d  _encoding...utf-
+00001c90: 3894 8c1c 6572 726f 725f 656e 636f 6469  8...error_encodi
+00001ca0: 6e67 5f65 7272 6f72 5f68 616e 646c 6572  ng_error_handler
+00001cb0: 948c 1062 6163 6b73 6c61 7368 7265 706c  ...backslashrepl
+00001cc0: 6163 6594 8c0d 6c61 6e67 7561 6765 5f63  ace...language_c
+00001cd0: 6f64 6594 8c02 656e 948c 1372 6563 6f72  ode...en...recor
+00001ce0: 645f 6465 7065 6e64 656e 6369 6573 944e  d_dependencies.N
+00001cf0: 8c06 636f 6e66 6967 944e 8c09 6964 5f70  ..config.N..id_p
+00001d00: 7265 6669 7894 6806 8c0e 6175 746f 5f69  refix.h...auto_i
+00001d10: 645f 7072 6566 6978 948c 0269 6494 8c0d  d_prefix...id...
+00001d20: 6475 6d70 5f73 6574 7469 6e67 7394 4e8c  dump_settings.N.
+00001d30: 0e64 756d 705f 696e 7465 726e 616c 7394  .dump_internals.
+00001d40: 4e8c 0f64 756d 705f 7472 616e 7366 6f72  N..dump_transfor
+00001d50: 6d73 944e 8c0f 6475 6d70 5f70 7365 7564  ms.N..dump_pseud
+00001d60: 6f5f 786d 6c94 4e8c 1065 7870 6f73 655f  o_xml.N..expose_
+00001d70: 696e 7465 726e 616c 7394 4e8c 0e73 7472  internals.N..str
+00001d80: 6963 745f 7669 7369 746f 7294 4e8c 0f5f  ict_visitor.N.._
+00001d90: 6469 7361 626c 655f 636f 6e66 6967 944e  disable_config.N
+00001da0: 8c07 5f73 6f75 7263 6594 682c 8c0c 5f64  .._source.h,.._d
+00001db0: 6573 7469 6e61 7469 6f6e 944e 8c0d 5f63  estination.N.._c
+00001dc0: 6f6e 6669 675f 6669 6c65 7394 5d94 8c16  onfig_files.]...
+00001dd0: 6669 6c65 5f69 6e73 6572 7469 6f6e 5f65  file_insertion_e
+00001de0: 6e61 626c 6564 9488 8c0b 7261 775f 656e  nabled....raw_en
+00001df0: 6162 6c65 6494 4b01 8c11 6c69 6e65 5f6c  abled.K...line_l
+00001e00: 656e 6774 685f 6c69 6d69 7494 4d10 278c  ength_limit.M.'.
+00001e10: 0e70 6570 5f72 6566 6572 656e 6365 7394  .pep_references.
+00001e20: 4e8c 0c70 6570 5f62 6173 655f 7572 6c94  N..pep_base_url.
+00001e30: 8c18 6874 7470 733a 2f2f 7065 7073 2e70  ..https://peps.p
+00001e40: 7974 686f 6e2e 6f72 672f 948c 1570 6570  ython.org/...pep
+00001e50: 5f66 696c 655f 7572 6c5f 7465 6d70 6c61  _file_url_templa
+00001e60: 7465 948c 0870 6570 2d25 3034 6494 8c0e  te...pep-%04d...
+00001e70: 7266 635f 7265 6665 7265 6e63 6573 944e  rfc_references.N
+00001e80: 8c0c 7266 635f 6261 7365 5f75 726c 948c  ..rfc_base_url..
+00001e90: 2668 7474 7073 3a2f 2f64 6174 6174 7261  &https://datatra
+00001ea0: 636b 6572 2e69 6574 662e 6f72 672f 646f  cker.ietf.org/do
+00001eb0: 632f 6874 6d6c 2f94 8c09 7461 625f 7769  c/html/...tab_wi
+00001ec0: 6474 6894 4b08 8c1d 7472 696d 5f66 6f6f  dth.K...trim_foo
+00001ed0: 746e 6f74 655f 7265 6665 7265 6e63 655f  tnote_reference_
+00001ee0: 7370 6163 6594 898c 1073 796e 7461 785f  space....syntax_
+00001ef0: 6869 6768 6c69 6768 7494 8c04 6c6f 6e67  highlight...long
+00001f00: 948c 0c73 6d61 7274 5f71 756f 7465 7394  ...smart_quotes.
+00001f10: 888c 1373 6d61 7274 7175 6f74 6573 5f6c  ...smartquotes_l
+00001f20: 6f63 616c 6573 945d 948c 1d63 6861 7261  ocales.]...chara
+00001f30: 6374 6572 5f6c 6576 656c 5f69 6e6c 696e  cter_level_inlin
+00001f40: 655f 6d61 726b 7570 9489 8c0e 646f 6374  e_markup....doct
+00001f50: 6974 6c65 5f78 666f 726d 9489 8c0d 646f  itle_xform....do
+00001f60: 6369 6e66 6f5f 7866 6f72 6d94 4b01 8c12  cinfo_xform.K...
+00001f70: 7365 6374 7375 6274 6974 6c65 5f78 666f  sectsubtitle_xfo
+00001f80: 726d 9489 8c0d 696d 6167 655f 6c6f 6164  rm....image_load
+00001f90: 696e 6794 8c04 6c69 6e6b 948c 1065 6d62  ing...link...emb
+00001fa0: 6564 5f73 7479 6c65 7368 6565 7494 898c  ed_stylesheet...
+00001fb0: 1563 6c6f 616b 5f65 6d61 696c 5f61 6464  .cloak_email_add
+00001fc0: 7265 7373 6573 9488 8c11 7365 6374 696f  resses....sectio
+00001fd0: 6e5f 7365 6c66 5f6c 696e 6b94 898c 0365  n_self_link....e
+00001fe0: 6e76 944e 7562 8c08 7265 706f 7274 6572  nv.Nub..reporter
+00001ff0: 944e 8c10 696e 6469 7265 6374 5f74 6172  .N..indirect_tar
+00002000: 6765 7473 945d 948c 1173 7562 7374 6974  gets.]...substit
+00002010: 7574 696f 6e5f 6465 6673 947d 948c 1273  ution_defs.}...s
+00002020: 7562 7374 6974 7574 696f 6e5f 6e61 6d65  ubstitution_name
+00002030: 7394 7d94 8c08 7265 666e 616d 6573 947d  s.}...refnames.}
+00002040: 948c 0672 6566 6964 7394 7d94 8c07 6e61  ...refids.}...na
+00002050: 6d65 6964 7394 7d94 286a 7201 0000 6a6f  meids.}.(jr...jo
+00002060: 0100 0068 6468 6168 a568 a268 e368 e06a  ...hdhah.h.h.h.j
+00002070: 2101 0000 6a1e 0100 006a 5f01 0000 6a5c  !...j....j_...j\
+00002080: 0100 0075 8c09 6e61 6d65 7479 7065 7394  ...u..nametypes.
+00002090: 7d94 286a 7201 0000 8968 6488 68a5 8868  }.(jr....hd.h..h
+000020a0: e388 6a21 0100 0088 6a5f 0100 0088 7568  ..j!....j_....uh
+000020b0: 217d 9428 6a6f 0100 0068 0c68 6168 5b68  !}.(jo...h.hah[h
+000020c0: a268 9c68 e068 da6a 1e01 0000 6a18 0100  .h.h.h.j....j...
+000020d0: 006a 5c01 0000 6a56 0100 0075 8c0d 666f  .j\...jV...u..fo
+000020e0: 6f74 6e6f 7465 5f72 6566 7394 7d94 8c0d  otnote_refs.}...
+000020f0: 6369 7461 7469 6f6e 5f72 6566 7394 7d94  citation_refs.}.
+00002100: 8c0d 6175 746f 666f 6f74 6e6f 7465 7394  ..autofootnotes.
+00002110: 5d94 8c11 6175 746f 666f 6f74 6e6f 7465  ]...autofootnote
+00002120: 5f72 6566 7394 5d94 8c10 7379 6d62 6f6c  _refs.]...symbol
+00002130: 5f66 6f6f 746e 6f74 6573 945d 948c 1473  _footnotes.]...s
+00002140: 796d 626f 6c5f 666f 6f74 6e6f 7465 5f72  ymbol_footnote_r
+00002150: 6566 7394 5d94 8c09 666f 6f74 6e6f 7465  efs.]...footnote
+00002160: 7394 5d94 8c09 6369 7461 7469 6f6e 7394  s.]...citations.
+00002170: 5d94 8c12 6175 746f 666f 6f74 6e6f 7465  ]...autofootnote
+00002180: 5f73 7461 7274 944b 018c 1573 796d 626f  _start.K...symbo
+00002190: 6c5f 666f 6f74 6e6f 7465 5f73 7461 7274  l_footnote_start
+000021a0: 944b 008c 0a69 645f 636f 756e 7465 7294  .K...id_counter.
+000021b0: 8c0b 636f 6c6c 6563 7469 6f6e 7394 8c07  ..collections...
+000021c0: 436f 756e 7465 7294 9394 7d94 8594 5294  Counter...}...R.
+000021d0: 8c0e 7061 7273 655f 6d65 7373 6167 6573  ..parse_messages
+000021e0: 945d 948c 1274 7261 6e73 666f 726d 5f6d  .]...transform_m
+000021f0: 6573 7361 6765 7394 5d94 8c0b 7472 616e  essages.]...tran
+00002200: 7366 6f72 6d65 7294 4e8c 0b69 6e63 6c75  sformer.N..inclu
+00002210: 6465 5f6c 6f67 945d 948c 0a64 6563 6f72  de_log.]...decor
+00002220: 6174 696f 6e94 4e68 1c68 0375 622e       ation.Nh.h.ub.
```

### Comparing `fastmbar-1.2/docs/build/.doctrees/usage.doctree` & `fastmbar-1.3/docs/build/.doctrees/usage.doctree`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_images/Fig_1.png` & `fastmbar-1.3/docs/build/_images/Fig_1.png`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_images/Fig_11.png` & `fastmbar-1.3/docs/build/_images/Fig_11.png`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_images/Fig_2.png` & `fastmbar-1.3/docs/build/_images/Fig_2.png`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_images/Fig_21.png` & `fastmbar-1.3/docs/build/_images/Fig_21.png`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_images/PMF.png` & `fastmbar-1.3/docs/build/_images/PMF.png`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_images/PMF1.png` & `fastmbar-1.3/docs/build/_images/PMF1.png`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_images/energy_matrix.png` & `fastmbar-1.3/docs/build/_images/energy_matrix.png`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_modules/index.html` & `fastmbar-1.3/docs/build/_modules/index.html`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_modules/FastMBAR/fastmbar.html` & `fastmbar-1.3/docs/build/_modules/FastMBAR/fastmbar.html`

 * *Files 0% similar despite different names*

```diff
@@ -4176,3652 +4176,3659 @@
 000104f0: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
 00010500: 3e29 3c2f 7370 616e 3e3c 7370 616e 2063  >)</span><span c
 00010510: 6c61 7373 3d22 6f22 3e2e 3c2f 7370 616e  lass="o">.</span
 00010520: 3e3c 7370 616e 2063 6c61 7373 3d22 6e22  ><span class="n"
 00010530: 3e74 3c2f 7370 616e 3e3c 7370 616e 2063  >t</span><span c
 00010540: 6c61 7373 3d22 7022 3e28 293c 2f73 7061  lass="p">()</spa
 00010550: 6e3e 0a20 2020 2020 2020 2020 2020 203c  n>.            <
-00010560: 7370 616e 2063 6c61 7373 3d22 6e22 3e50  span class="n">P
-00010570: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
-00010580: 6173 733d 226f 223e 3d3c 2f73 7061 6e3e  ass="o">=</span>
-00010590: 203c 7370 616e 2063 6c61 7373 3d22 6e22   <span class="n"
-000105a0: 3e74 6f72 6368 3c2f 7370 616e 3e3c 7370  >torch</span><sp
-000105b0: 616e 2063 6c61 7373 3d22 6f22 3e2e 3c2f  an class="o">.</
-000105c0: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
-000105d0: 3d22 6e22 3e65 7870 3c2f 7370 616e 3e3c  ="n">exp</span><
-000105e0: 7370 616e 2063 6c61 7373 3d22 7022 3e28  span class="p">(
-000105f0: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-00010600: 7373 3d22 6f22 3e2d 3c2f 7370 616e 3e3c  ss="o">-</span><
-00010610: 7370 616e 2063 6c61 7373 3d22 7022 3e28  span class="p">(
-00010620: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-00010630: 7373 3d22 6e22 3e55 3c2f 7370 616e 3e20  ss="n">U</span> 
-00010640: 3c73 7061 6e20 636c 6173 733d 226f 223e  <span class="o">
-00010650: 2d3c 2f73 7061 6e3e 203c 7370 616e 2063  -</span> <span c
-00010660: 6c61 7373 3d22 6e22 3e46 5f65 7874 3c2f  lass="n">F_ext</
-00010670: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
-00010680: 733d 226f 223e 2b3c 2f73 7061 6e3e 203c  s="o">+</span> <
-00010690: 7370 616e 2063 6c61 7373 3d22 6270 223e  span class="bp">
-000106a0: 7365 6c66 3c2f 7370 616e 3e3c 7370 616e  self</span><span
-000106b0: 2063 6c61 7373 3d22 6f22 3e2e 3c2f 7370   class="o">.</sp
-000106c0: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-000106d0: 6e22 3e5f 6c6f 675f 7072 6f62 5f6d 6978  n">_log_prob_mix
-000106e0: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-000106f0: 7373 3d22 7022 3e5b 3a2c 3c2f 7370 616e  ss="p">[:,</span
-00010700: 3e20 3c73 7061 6e20 636c 6173 733d 226b  > <span class="k
-00010710: 6322 3e4e 6f6e 653c 2f73 7061 6e3e 3c73  c">None</span><s
-00010720: 7061 6e20 636c 6173 733d 2270 223e 5d29  pan class="p">])
-00010730: 293c 2f73 7061 6e3e 0a0a 2020 2020 2020  )</span>..      
-00010740: 2020 2020 2020 3c73 7061 6e20 636c 6173        <span clas
-00010750: 733d 226e 223e 573c 2f73 7061 6e3e 203c  s="n">W</span> <
-00010760: 7370 616e 2063 6c61 7373 3d22 6f22 3e3d  span class="o">=
-00010770: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
-00010780: 6173 733d 226e 223e 746f 7263 683c 2f73  ass="n">torch</s
-00010790: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
-000107a0: 226f 223e 2e3c 2f73 7061 6e3e 3c73 7061  "o">.</span><spa
-000107b0: 6e20 636c 6173 733d 226e 223e 6469 6167  n class="n">diag
-000107c0: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-000107d0: 7373 3d22 7022 3e28 3c2f 7370 616e 3e3c  ss="p">(</span><
-000107e0: 7370 616e 2063 6c61 7373 3d22 6e22 3e74  span class="n">t
-000107f0: 6f72 6368 3c2f 7370 616e 3e3c 7370 616e  orch</span><span
-00010800: 2063 6c61 7373 3d22 6f22 3e2e 3c2f 7370   class="o">.</sp
-00010810: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-00010820: 6e22 3e63 6174 3c2f 7370 616e 3e3c 7370  n">cat</span><sp
-00010830: 616e 2063 6c61 7373 3d22 7022 3e28 5b3c  an class="p">([<
-00010840: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
-00010850: 733d 2262 7022 3e73 656c 663c 2f73 7061  s="bp">self</spa
-00010860: 6e3e 3c73 7061 6e20 636c 6173 733d 226f  n><span class="o
-00010870: 223e 2e3c 2f73 7061 6e3e 3c73 7061 6e20  ">.</span><span 
-00010880: 636c 6173 733d 226e 223e 6e75 6d5f 636f  class="n">num_co
-00010890: 6e66 3c2f 7370 616e 3e3c 7370 616e 2063  nf</span><span c
-000108a0: 6c61 7373 3d22 7022 3e2c 3c2f 7370 616e  lass="p">,</span
-000108b0: 3e20 3c73 7061 6e20 636c 6173 733d 2262  > <span class="b
-000108c0: 7022 3e73 656c 663c 2f73 7061 6e3e 3c73  p">self</span><s
-000108d0: 7061 6e20 636c 6173 733d 226f 223e 2e3c  pan class="o">.<
-000108e0: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
-000108f0: 733d 226e 223e 6e75 6d5f 636f 6e66 3c2f  s="n">num_conf</
-00010900: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
-00010910: 3d22 6f22 3e2e 3c2f 7370 616e 3e3c 7370  ="o">.</span><sp
-00010920: 616e 2063 6c61 7373 3d22 6e22 3e6e 6577  an class="n">new
-00010930: 5f7a 6572 6f73 3c2f 7370 616e 3e3c 7370  _zeros</span><sp
-00010940: 616e 2063 6c61 7373 3d22 7022 3e28 3c2f  an class="p">(</
-00010950: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
-00010960: 3d22 6e22 3e4c 3c2f 7370 616e 3e3c 7370  ="n">L</span><sp
-00010970: 616e 2063 6c61 7373 3d22 7022 3e29 5d29  an class="p">)])
-00010980: 293c 2f73 7061 6e3e 0a20 2020 2020 2020  )</span>.       
-00010990: 2020 2020 203c 7370 616e 2063 6c61 7373       <span class
-000109a0: 3d22 6e22 3e51 3c2f 7370 616e 3e3c 7370  ="n">Q</span><sp
-000109b0: 616e 2063 6c61 7373 3d22 7022 3e2c 3c2f  an class="p">,</
-000109c0: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
-000109d0: 733d 226e 223e 523c 2f73 7061 6e3e 203c  s="n">R</span> <
-000109e0: 7370 616e 2063 6c61 7373 3d22 6f22 3e3d  span class="o">=
-000109f0: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
-00010a00: 6173 733d 226e 223e 746f 7263 683c 2f73  ass="n">torch</s
-00010a10: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
-00010a20: 226f 223e 2e3c 2f73 7061 6e3e 3c73 7061  "o">.</span><spa
-00010a30: 6e20 636c 6173 733d 226e 223e 6c69 6e61  n class="n">lina
-00010a40: 6c67 3c2f 7370 616e 3e3c 7370 616e 2063  lg</span><span c
+00010560: 7370 616e 2063 6c61 7373 3d22 6270 223e  span class="bp">
+00010570: 7365 6c66 3c2f 7370 616e 3e3c 7370 616e  self</span><span
+00010580: 2063 6c61 7373 3d22 6f22 3e2e 3c2f 7370   class="o">.</sp
+00010590: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+000105a0: 6e22 3e5f 503c 2f73 7061 6e3e 203c 7370  n">_P</span> <sp
+000105b0: 616e 2063 6c61 7373 3d22 6f22 3e3d 3c2f  an class="o">=</
+000105c0: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
+000105d0: 733d 226e 223e 746f 7263 683c 2f73 7061  s="n">torch</spa
+000105e0: 6e3e 3c73 7061 6e20 636c 6173 733d 226f  n><span class="o
+000105f0: 223e 2e3c 2f73 7061 6e3e 3c73 7061 6e20  ">.</span><span 
+00010600: 636c 6173 733d 226e 223e 6578 703c 2f73  class="n">exp</s
+00010610: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
+00010620: 2270 223e 283c 2f73 7061 6e3e 3c73 7061  "p">(</span><spa
+00010630: 6e20 636c 6173 733d 226f 223e 2d3c 2f73  n class="o">-</s
+00010640: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
+00010650: 2270 223e 283c 2f73 7061 6e3e 3c73 7061  "p">(</span><spa
+00010660: 6e20 636c 6173 733d 226e 223e 553c 2f73  n class="n">U</s
+00010670: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
+00010680: 3d22 6f22 3e2d 3c2f 7370 616e 3e20 3c73  ="o">-</span> <s
+00010690: 7061 6e20 636c 6173 733d 226e 223e 465f  pan class="n">F_
+000106a0: 6578 743c 2f73 7061 6e3e 203c 7370 616e  ext</span> <span
+000106b0: 2063 6c61 7373 3d22 6f22 3e2b 3c2f 7370   class="o">+</sp
+000106c0: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
+000106d0: 2262 7022 3e73 656c 663c 2f73 7061 6e3e  "bp">self</span>
+000106e0: 3c73 7061 6e20 636c 6173 733d 226f 223e  <span class="o">
+000106f0: 2e3c 2f73 7061 6e3e 3c73 7061 6e20 636c  .</span><span cl
+00010700: 6173 733d 226e 223e 5f6c 6f67 5f70 726f  ass="n">_log_pro
+00010710: 625f 6d69 783c 2f73 7061 6e3e 3c73 7061  b_mix</span><spa
+00010720: 6e20 636c 6173 733d 2270 223e 5b3a 2c3c  n class="p">[:,<
+00010730: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
+00010740: 7373 3d22 6b63 223e 4e6f 6e65 3c2f 7370  ss="kc">None</sp
+00010750: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+00010760: 7022 3e5d 2929 3c2f 7370 616e 3e0a 0a20  p">]))</span>.. 
+00010770: 2020 2020 2020 2020 2020 203c 7370 616e             <span
+00010780: 2063 6c61 7373 3d22 6e22 3e57 3c2f 7370   class="n">W</sp
+00010790: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
+000107a0: 226f 223e 3d3c 2f73 7061 6e3e 203c 7370  "o">=</span> <sp
+000107b0: 616e 2063 6c61 7373 3d22 6e22 3e74 6f72  an class="n">tor
+000107c0: 6368 3c2f 7370 616e 3e3c 7370 616e 2063  ch</span><span c
+000107d0: 6c61 7373 3d22 6f22 3e2e 3c2f 7370 616e  lass="o">.</span
+000107e0: 3e3c 7370 616e 2063 6c61 7373 3d22 6e22  ><span class="n"
+000107f0: 3e64 6961 673c 2f73 7061 6e3e 3c73 7061  >diag</span><spa
+00010800: 6e20 636c 6173 733d 2270 223e 283c 2f73  n class="p">(</s
+00010810: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
+00010820: 226e 223e 746f 7263 683c 2f73 7061 6e3e  "n">torch</span>
+00010830: 3c73 7061 6e20 636c 6173 733d 226f 223e  <span class="o">
+00010840: 2e3c 2f73 7061 6e3e 3c73 7061 6e20 636c  .</span><span cl
+00010850: 6173 733d 226e 223e 6361 743c 2f73 7061  ass="n">cat</spa
+00010860: 6e3e 3c73 7061 6e20 636c 6173 733d 2270  n><span class="p
+00010870: 223e 285b 3c2f 7370 616e 3e3c 7370 616e  ">([</span><span
+00010880: 2063 6c61 7373 3d22 6270 223e 7365 6c66   class="bp">self
+00010890: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
+000108a0: 7373 3d22 6f22 3e2e 3c2f 7370 616e 3e3c  ss="o">.</span><
+000108b0: 7370 616e 2063 6c61 7373 3d22 6e22 3e6e  span class="n">n
+000108c0: 756d 5f63 6f6e 663c 2f73 7061 6e3e 3c73  um_conf</span><s
+000108d0: 7061 6e20 636c 6173 733d 2270 223e 2c3c  pan class="p">,<
+000108e0: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
+000108f0: 7373 3d22 6270 223e 7365 6c66 3c2f 7370  ss="bp">self</sp
+00010900: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+00010910: 6f22 3e2e 3c2f 7370 616e 3e3c 7370 616e  o">.</span><span
+00010920: 2063 6c61 7373 3d22 6e22 3e6e 756d 5f63   class="n">num_c
+00010930: 6f6e 663c 2f73 7061 6e3e 3c73 7061 6e20  onf</span><span 
+00010940: 636c 6173 733d 226f 223e 2e3c 2f73 7061  class="o">.</spa
+00010950: 6e3e 3c73 7061 6e20 636c 6173 733d 226e  n><span class="n
+00010960: 223e 6e65 775f 7a65 726f 733c 2f73 7061  ">new_zeros</spa
+00010970: 6e3e 3c73 7061 6e20 636c 6173 733d 2270  n><span class="p
+00010980: 223e 283c 2f73 7061 6e3e 3c73 7061 6e20  ">(</span><span 
+00010990: 636c 6173 733d 226e 223e 4c3c 2f73 7061  class="n">L</spa
+000109a0: 6e3e 3c73 7061 6e20 636c 6173 733d 2270  n><span class="p
+000109b0: 223e 295d 2929 3c2f 7370 616e 3e0a 2020  ">)]))</span>.  
+000109c0: 2020 2020 2020 2020 2020 3c73 7061 6e20            <span 
+000109d0: 636c 6173 733d 226e 223e 513c 2f73 7061  class="n">Q</spa
+000109e0: 6e3e 3c73 7061 6e20 636c 6173 733d 2270  n><span class="p
+000109f0: 223e 2c3c 2f73 7061 6e3e 203c 7370 616e  ">,</span> <span
+00010a00: 2063 6c61 7373 3d22 6e22 3e52 3c2f 7370   class="n">R</sp
+00010a10: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
+00010a20: 226f 223e 3d3c 2f73 7061 6e3e 203c 7370  "o">=</span> <sp
+00010a30: 616e 2063 6c61 7373 3d22 6e22 3e74 6f72  an class="n">tor
+00010a40: 6368 3c2f 7370 616e 3e3c 7370 616e 2063  ch</span><span c
 00010a50: 6c61 7373 3d22 6f22 3e2e 3c2f 7370 616e  lass="o">.</span
 00010a60: 3e3c 7370 616e 2063 6c61 7373 3d22 6e22  ><span class="n"
-00010a70: 3e71 723c 2f73 7061 6e3e 3c73 7061 6e20  >qr</span><span 
-00010a80: 636c 6173 733d 2270 223e 283c 2f73 7061  class="p">(</spa
-00010a90: 6e3e 3c73 7061 6e20 636c 6173 733d 226e  n><span class="n
-00010aa0: 223e 503c 2f73 7061 6e3e 3c73 7061 6e20  ">P</span><span 
-00010ab0: 636c 6173 733d 2270 223e 293c 2f73 7061  class="p">)</spa
-00010ac0: 6e3e 0a20 2020 2020 2020 2020 2020 203c  n>.            <
-00010ad0: 7370 616e 2063 6c61 7373 3d22 6e22 3e41  span class="n">A
-00010ae0: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
-00010af0: 6173 733d 226f 223e 3d3c 2f73 7061 6e3e  ass="o">=</span>
-00010b00: 203c 7370 616e 2063 6c61 7373 3d22 6e22   <span class="n"
-00010b10: 3e74 6f72 6368 3c2f 7370 616e 3e3c 7370  >torch</span><sp
-00010b20: 616e 2063 6c61 7373 3d22 6f22 3e2e 3c2f  an class="o">.</
-00010b30: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
-00010b40: 3d22 6e22 3e65 7965 3c2f 7370 616e 3e3c  ="n">eye</span><
-00010b50: 7370 616e 2063 6c61 7373 3d22 7022 3e28  span class="p">(
-00010b60: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-00010b70: 7373 3d22 6270 223e 7365 6c66 3c2f 7370  ss="bp">self</sp
-00010b80: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-00010b90: 6f22 3e2e 3c2f 7370 616e 3e3c 7370 616e  o">.</span><span
-00010ba0: 2063 6c61 7373 3d22 6e22 3e4d 3c2f 7370   class="n">M</sp
-00010bb0: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
-00010bc0: 226f 223e 2b3c 2f73 7061 6e3e 203c 7370  "o">+</span> <sp
-00010bd0: 616e 2063 6c61 7373 3d22 6e22 3e4c 3c2f  an class="n">L</
-00010be0: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
-00010bf0: 3d22 7022 3e2c 3c2f 7370 616e 3e20 3c73  ="p">,</span> <s
-00010c00: 7061 6e20 636c 6173 733d 226e 223e 6465  pan class="n">de
-00010c10: 7669 6365 3c2f 7370 616e 3e3c 7370 616e  vice</span><span
-00010c20: 2063 6c61 7373 3d22 6f22 3e3d 3c2f 7370   class="o">=</sp
-00010c30: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-00010c40: 6e22 3e57 3c2f 7370 616e 3e3c 7370 616e  n">W</span><span
-00010c50: 2063 6c61 7373 3d22 6f22 3e2e 3c2f 7370   class="o">.</sp
-00010c60: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-00010c70: 6e22 3e64 6576 6963 653c 2f73 7061 6e3e  n">device</span>
-00010c80: 3c73 7061 6e20 636c 6173 733d 2270 223e  <span class="p">
-00010c90: 293c 2f73 7061 6e3e 203c 7370 616e 2063  )</span> <span c
-00010ca0: 6c61 7373 3d22 6f22 3e2d 3c2f 7370 616e  lass="o">-</span
-00010cb0: 3e20 3c73 7061 6e20 636c 6173 733d 226e  > <span class="n
-00010cc0: 223e 523c 2f73 7061 6e3e 203c 7370 616e  ">R</span> <span
-00010cd0: 2063 6c61 7373 3d22 6f22 3e40 3c2f 7370   class="o">@</sp
-00010ce0: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
-00010cf0: 226e 223e 573c 2f73 7061 6e3e 203c 7370  "n">W</span> <sp
-00010d00: 616e 2063 6c61 7373 3d22 6f22 3e40 3c2f  an class="o">@</
-00010d10: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
-00010d20: 733d 226e 223e 523c 2f73 7061 6e3e 3c73  s="n">R</span><s
-00010d30: 7061 6e20 636c 6173 733d 226f 223e 2e3c  pan class="o">.<
-00010d40: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
-00010d50: 733d 226e 223e 543c 2f73 7061 6e3e 0a20  s="n">T</span>. 
-00010d60: 2020 2020 2020 2020 2020 203c 7370 616e             <span
-00010d70: 2063 6c61 7373 3d22 6e22 3e46 5f63 6f76   class="n">F_cov
-00010d80: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
-00010d90: 6173 733d 226f 223e 3d3c 2f73 7061 6e3e  ass="o">=</span>
-00010da0: 203c 7370 616e 2063 6c61 7373 3d22 6e22   <span class="n"
-00010db0: 3e52 3c2f 7370 616e 3e3c 7370 616e 2063  >R</span><span c
-00010dc0: 6c61 7373 3d22 6f22 3e2e 3c2f 7370 616e  lass="o">.</span
-00010dd0: 3e3c 7370 616e 2063 6c61 7373 3d22 6e22  ><span class="n"
-00010de0: 3e54 3c2f 7370 616e 3e20 3c73 7061 6e20  >T</span> <span 
-00010df0: 636c 6173 733d 226f 223e 403c 2f73 7061  class="o">@</spa
-00010e00: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
-00010e10: 6e22 3e74 6f72 6368 3c2f 7370 616e 3e3c  n">torch</span><
-00010e20: 7370 616e 2063 6c61 7373 3d22 6f22 3e2e  span class="o">.
-00010e30: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-00010e40: 7373 3d22 6e22 3e6c 696e 616c 673c 2f73  ss="n">linalg</s
-00010e50: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
-00010e60: 226f 223e 2e3c 2f73 7061 6e3e 3c73 7061  "o">.</span><spa
-00010e70: 6e20 636c 6173 733d 226e 223e 7069 6e76  n class="n">pinv
-00010e80: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-00010e90: 7373 3d22 7022 3e28 3c2f 7370 616e 3e3c  ss="p">(</span><
-00010ea0: 7370 616e 2063 6c61 7373 3d22 6e22 3e41  span class="n">A
-00010eb0: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-00010ec0: 7373 3d22 7022 3e2c 3c2f 7370 616e 3e20  ss="p">,</span> 
-00010ed0: 3c73 7061 6e20 636c 6173 733d 226e 223e  <span class="n">
-00010ee0: 6865 726d 6974 6961 6e3c 2f73 7061 6e3e  hermitian</span>
-00010ef0: 3c73 7061 6e20 636c 6173 733d 226f 223e  <span class="o">
-00010f00: 3d3c 2f73 7061 6e3e 3c73 7061 6e20 636c  =</span><span cl
-00010f10: 6173 733d 226b 6322 3e54 7275 653c 2f73  ass="kc">True</s
-00010f20: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
-00010f30: 2270 223e 2c3c 2f73 7061 6e3e 203c 7370  "p">,</span> <sp
-00010f40: 616e 2063 6c61 7373 3d22 6e22 3e72 746f  an class="n">rto
-00010f50: 6c3c 2f73 7061 6e3e 3c73 7061 6e20 636c  l</span><span cl
-00010f60: 6173 733d 226f 223e 3d3c 2f73 7061 6e3e  ass="o">=</span>
-00010f70: 3c73 7061 6e20 636c 6173 733d 226d 6622  <span class="mf"
-00010f80: 3e31 652d 383c 2f73 7061 6e3e 3c73 7061  >1e-8</span><spa
-00010f90: 6e20 636c 6173 733d 2270 223e 293c 2f73  n class="p">)</s
-00010fa0: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
-00010fb0: 3d22 6f22 3e40 3c2f 7370 616e 3e20 3c73  ="o">@</span> <s
-00010fc0: 7061 6e20 636c 6173 733d 226e 223e 523c  pan class="n">R<
-00010fd0: 2f73 7061 6e3e 0a0a 2020 2020 2020 2020  /span>..        
-00010fe0: 2020 2020 3c73 7061 6e20 636c 6173 733d      <span class=
-00010ff0: 226e 223e 465f 636f 763c 2f73 7061 6e3e  "n">F_cov</span>
-00011000: 203c 7370 616e 2063 6c61 7373 3d22 6f22   <span class="o"
-00011010: 3e3d 3c2f 7370 616e 3e20 3c73 7061 6e20  >=</span> <span 
-00011020: 636c 6173 733d 226e 223e 465f 636f 763c  class="n">F_cov<
-00011030: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
-00011040: 733d 2270 223e 5b3c 2f73 7061 6e3e 3c73  s="p">[</span><s
-00011050: 7061 6e20 636c 6173 733d 2262 7022 3e73  pan class="bp">s
-00011060: 656c 663c 2f73 7061 6e3e 3c73 7061 6e20  elf</span><span 
-00011070: 636c 6173 733d 226f 223e 2e3c 2f73 7061  class="o">.</spa
-00011080: 6e3e 3c73 7061 6e20 636c 6173 733d 226e  n><span class="n
-00011090: 223e 4d3c 2f73 7061 6e3e 203c 7370 616e  ">M</span> <span
-000110a0: 2063 6c61 7373 3d22 7022 3e3a 2c3c 2f73   class="p">:,</s
-000110b0: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
-000110c0: 3d22 6270 223e 7365 6c66 3c2f 7370 616e  ="bp">self</span
-000110d0: 3e3c 7370 616e 2063 6c61 7373 3d22 6f22  ><span class="o"
-000110e0: 3e2e 3c2f 7370 616e 3e3c 7370 616e 2063  >.</span><span c
-000110f0: 6c61 7373 3d22 6e22 3e4d 3c2f 7370 616e  lass="n">M</span
-00011100: 3e20 3c73 7061 6e20 636c 6173 733d 2270  > <span class="p
-00011110: 223e 3a5d 3c2f 7370 616e 3e0a 2020 2020  ">:]</span>.    
-00011120: 2020 2020 2020 2020 3c73 7061 6e20 636c          <span cl
-00011130: 6173 733d 226e 223e 465f 7374 643c 2f73  ass="n">F_std</s
-00011140: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
-00011150: 3d22 6f22 3e3d 3c2f 7370 616e 3e20 3c73  ="o">=</span> <s
-00011160: 7061 6e20 636c 6173 733d 226e 223e 465f  pan class="n">F_
-00011170: 636f 763c 2f73 7061 6e3e 3c73 7061 6e20  cov</span><span 
-00011180: 636c 6173 733d 226f 223e 2e3c 2f73 7061  class="o">.</spa
-00011190: 6e3e 3c73 7061 6e20 636c 6173 733d 226e  n><span class="n
-000111a0: 223e 6469 6167 6f6e 616c 3c2f 7370 616e  ">diagonal</span
-000111b0: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
-000111c0: 3e28 293c 2f73 7061 6e3e 3c73 7061 6e20  >()</span><span 
-000111d0: 636c 6173 733d 226f 223e 2e3c 2f73 7061  class="o">.</spa
-000111e0: 6e3e 3c73 7061 6e20 636c 6173 733d 226e  n><span class="n
-000111f0: 223e 7371 7274 3c2f 7370 616e 3e3c 7370  ">sqrt</span><sp
-00011200: 616e 2063 6c61 7373 3d22 7022 3e28 293c  an class="p">()<
-00011210: 2f73 7061 6e3e 0a0a 2020 2020 2020 2020  /span>..        
-00011220: 2020 2020 3c73 7061 6e20 636c 6173 733d      <span class=
-00011230: 226e 223e 4465 6c74 6146 3c2f 7370 616e  "n">DeltaF</span
-00011240: 3e20 3c73 7061 6e20 636c 6173 733d 226f  > <span class="o
-00011250: 223e 3d3c 2f73 7061 6e3e 203c 7370 616e  ">=</span> <span
-00011260: 2063 6c61 7373 3d22 6e22 3e46 3c2f 7370   class="n">F</sp
-00011270: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-00011280: 7022 3e5b 3c2f 7370 616e 3e3c 7370 616e  p">[</span><span
-00011290: 2063 6c61 7373 3d22 6b63 223e 4e6f 6e65   class="kc">None
-000112a0: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-000112b0: 7373 3d22 7022 3e2c 3c2f 7370 616e 3e20  ss="p">,</span> 
-000112c0: 3c73 7061 6e20 636c 6173 733d 2270 223e  <span class="p">
-000112d0: 3a5d 3c2f 7370 616e 3e20 3c73 7061 6e20  :]</span> <span 
-000112e0: 636c 6173 733d 226f 223e 2d3c 2f73 7061  class="o">-</spa
-000112f0: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
-00011300: 6e22 3e46 3c2f 7370 616e 3e3c 7370 616e  n">F</span><span
-00011310: 2063 6c61 7373 3d22 7022 3e5b 3a2c 3c2f   class="p">[:,</
-00011320: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
-00011330: 733d 226b 6322 3e4e 6f6e 653c 2f73 7061  s="kc">None</spa
-00011340: 6e3e 3c73 7061 6e20 636c 6173 733d 2270  n><span class="p
-00011350: 223e 5d3c 2f73 7061 6e3e 0a20 2020 2020  ">]</span>.     
-00011360: 2020 2020 2020 203c 7370 616e 2063 6c61         <span cla
-00011370: 7373 3d22 6e22 3e44 656c 7461 465f 636f  ss="n">DeltaF_co
-00011380: 763c 2f73 7061 6e3e 203c 7370 616e 2063  v</span> <span c
-00011390: 6c61 7373 3d22 6f22 3e3d 3c2f 7370 616e  lass="o">=</span
-000113a0: 3e20 3c73 7061 6e20 636c 6173 733d 226e  > <span class="n
-000113b0: 223e 465f 636f 763c 2f73 7061 6e3e 3c73  ">F_cov</span><s
-000113c0: 7061 6e20 636c 6173 733d 226f 223e 2e3c  pan class="o">.<
-000113d0: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
-000113e0: 733d 226e 223e 6469 6167 3c2f 7370 616e  s="n">diag</span
-000113f0: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
-00011400: 3e28 295b 3a2c 3c2f 7370 616e 3e20 3c73  >()[:,</span> <s
-00011410: 7061 6e20 636c 6173 733d 226b 6322 3e4e  pan class="kc">N
-00011420: 6f6e 653c 2f73 7061 6e3e 3c73 7061 6e20  one</span><span 
-00011430: 636c 6173 733d 2270 223e 5d3c 2f73 7061  class="p">]</spa
-00011440: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
-00011450: 6f22 3e2b 3c2f 7370 616e 3e20 3c73 7061  o">+</span> <spa
-00011460: 6e20 636c 6173 733d 226e 223e 465f 636f  n class="n">F_co
-00011470: 763c 2f73 7061 6e3e 3c73 7061 6e20 636c  v</span><span cl
-00011480: 6173 733d 226f 223e 2e3c 2f73 7061 6e3e  ass="o">.</span>
-00011490: 3c73 7061 6e20 636c 6173 733d 226e 223e  <span class="n">
-000114a0: 6469 6167 3c2f 7370 616e 3e3c 7370 616e  diag</span><span
-000114b0: 2063 6c61 7373 3d22 7022 3e28 295b 3c2f   class="p">()[</
-000114c0: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
-000114d0: 3d22 6b63 223e 4e6f 6e65 3c2f 7370 616e  ="kc">None</span
-000114e0: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
-000114f0: 3e2c 3c2f 7370 616e 3e20 3c73 7061 6e20  >,</span> <span 
-00011500: 636c 6173 733d 2270 223e 3a5d 3c2f 7370  class="p">:]</sp
-00011510: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
-00011520: 226f 223e 2d3c 2f73 7061 6e3e 203c 7370  "o">-</span> <sp
-00011530: 616e 2063 6c61 7373 3d22 6d69 223e 323c  an class="mi">2<
-00011540: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
-00011550: 7373 3d22 6f22 3e2a 3c2f 7370 616e 3e20  ss="o">*</span> 
-00011560: 3c73 7061 6e20 636c 6173 733d 226e 223e  <span class="n">
-00011570: 465f 636f 763c 2f73 7061 6e3e 0a20 2020  F_cov</span>.   
-00011580: 2020 2020 2020 2020 203c 7370 616e 2063           <span c
-00011590: 6c61 7373 3d22 6e22 3e44 656c 7461 465f  lass="n">DeltaF_
-000115a0: 7374 643c 2f73 7061 6e3e 203c 7370 616e  std</span> <span
-000115b0: 2063 6c61 7373 3d22 6f22 3e3d 3c2f 7370   class="o">=</sp
-000115c0: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
-000115d0: 226e 223e 4465 6c74 6146 5f63 6f76 3c2f  "n">DeltaF_cov</
-000115e0: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
-000115f0: 3d22 6f22 3e2e 3c2f 7370 616e 3e3c 7370  ="o">.</span><sp
-00011600: 616e 2063 6c61 7373 3d22 6e22 3e73 7172  an class="n">sqr
-00011610: 743c 2f73 7061 6e3e 3c73 7061 6e20 636c  t</span><span cl
-00011620: 6173 733d 2270 223e 2829 3c2f 7370 616e  ass="p">()</span
-00011630: 3e0a 2020 2020 2020 2020 3c73 7061 6e20  >.        <span 
-00011640: 636c 6173 733d 226b 223e 656c 7365 3c2f  class="k">else</
-00011650: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
-00011660: 3d22 7022 3e3a 3c2f 7370 616e 3e0a 2020  ="p">:</span>.  
-00011670: 2020 2020 2020 2020 2020 3c73 7061 6e20            <span 
-00011680: 636c 6173 733d 226e 223e 465f 6c69 7374  class="n">F_list
-00011690: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
-000116a0: 6173 733d 226f 223e 3d3c 2f73 7061 6e3e  ass="o">=</span>
-000116b0: 203c 7370 616e 2063 6c61 7373 3d22 7022   <span class="p"
-000116c0: 3e5b 5d3c 2f73 7061 6e3e 0a20 2020 2020  >[]</span>.     
-000116d0: 2020 2020 2020 203c 7370 616e 2063 6c61         <span cla
-000116e0: 7373 3d22 6b22 3e66 6f72 3c2f 7370 616e  ss="k">for</span
-000116f0: 3e20 3c73 7061 6e20 636c 6173 733d 226e  > <span class="n
-00011700: 223e 6b3c 2f73 7061 6e3e 203c 7370 616e  ">k</span> <span
-00011710: 2063 6c61 7373 3d22 6f77 223e 696e 3c2f   class="ow">in</
-00011720: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
-00011730: 733d 226e 6222 3e72 616e 6765 3c2f 7370  s="nb">range</sp
-00011740: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-00011750: 7022 3e28 3c2f 7370 616e 3e3c 7370 616e  p">(</span><span
-00011760: 2063 6c61 7373 3d22 6270 223e 7365 6c66   class="bp">self
-00011770: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-00011780: 7373 3d22 6f22 3e2e 3c2f 7370 616e 3e3c  ss="o">.</span><
-00011790: 7370 616e 2063 6c61 7373 3d22 6e22 3e62  span class="n">b
-000117a0: 6f6f 7473 7472 6170 5f6e 756d 5f72 6570  ootstrap_num_rep
-000117b0: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-000117c0: 7373 3d22 7022 3e29 3a3c 2f73 7061 6e3e  ss="p">):</span>
-000117d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000117e0: 203c 7370 616e 2063 6c61 7373 3d22 6e22   <span class="n"
-000117f0: 3e64 753c 2f73 7061 6e3e 203c 7370 616e  >du</span> <span
-00011800: 2063 6c61 7373 3d22 6f22 3e3d 3c2f 7370   class="o">=</sp
-00011810: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
-00011820: 226e 223e 656e 6572 6779 5f70 6572 7475  "n">energy_pertu
-00011830: 7262 6564 3c2f 7370 616e 3e3c 7370 616e  rbed</span><span
-00011840: 2063 6c61 7373 3d22 7022 3e5b 3a2c 3c2f   class="p">[:,</
-00011850: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
-00011860: 733d 2262 7022 3e73 656c 663c 2f73 7061  s="bp">self</spa
-00011870: 6e3e 3c73 7061 6e20 636c 6173 733d 226f  n><span class="o
-00011880: 223e 2e3c 2f73 7061 6e3e 3c73 7061 6e20  ">.</span><span 
-00011890: 636c 6173 733d 226e 223e 5f63 6f6e 665f  class="n">_conf_
-000118a0: 6964 783c 2f73 7061 6e3e 3c73 7061 6e20  idx</span><span 
-000118b0: 636c 6173 733d 2270 223e 5b3c 2f73 7061  class="p">[</spa
-000118c0: 6e3e 3c73 7061 6e20 636c 6173 733d 226e  n><span class="n
-000118d0: 223e 6b3c 2f73 7061 6e3e 3c73 7061 6e20  ">k</span><span 
-000118e0: 636c 6173 733d 2270 223e 5d5d 3c2f 7370  class="p">]]</sp
-000118f0: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
-00011900: 226f 223e 2b3c 2f73 7061 6e3e 203c 7370  "o">+</span> <sp
-00011910: 616e 2063 6c61 7373 3d22 6270 223e 7365  an class="bp">se
-00011920: 6c66 3c2f 7370 616e 3e3c 7370 616e 2063  lf</span><span c
-00011930: 6c61 7373 3d22 6f22 3e2e 3c2f 7370 616e  lass="o">.</span
-00011940: 3e3c 7370 616e 2063 6c61 7373 3d22 6e22  ><span class="n"
-00011950: 3e5f 6c6f 675f 7072 6f62 5f6d 6978 3c2f  >_log_prob_mix</
-00011960: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
-00011970: 3d22 7022 3e5b 3c2f 7370 616e 3e3c 7370  ="p">[</span><sp
-00011980: 616e 2063 6c61 7373 3d22 6e22 3e6b 3c2f  an class="n">k</
-00011990: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
-000119a0: 3d22 7022 3e5d 3c2f 7370 616e 3e0a 2020  ="p">]</span>.  
-000119b0: 2020 2020 2020 2020 2020 2020 2020 3c73                <s
-000119c0: 7061 6e20 636c 6173 733d 226e 223e 463c  pan class="n">F<
-000119d0: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
-000119e0: 7373 3d22 6f22 3e3d 3c2f 7370 616e 3e20  ss="o">=</span> 
-000119f0: 3c73 7061 6e20 636c 6173 733d 226f 223e  <span class="o">
-00011a00: 2d3c 2f73 7061 6e3e 3c73 7061 6e20 636c  -</span><span cl
-00011a10: 6173 733d 226e 223e 746f 7263 683c 2f73  ass="n">torch</s
-00011a20: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
-00011a30: 226f 223e 2e3c 2f73 7061 6e3e 3c73 7061  "o">.</span><spa
-00011a40: 6e20 636c 6173 733d 226e 223e 6c6f 6773  n class="n">logs
-00011a50: 756d 6578 703c 2f73 7061 6e3e 3c73 7061  umexp</span><spa
-00011a60: 6e20 636c 6173 733d 2270 223e 283c 2f73  n class="p">(</s
-00011a70: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
-00011a80: 226f 223e 2d3c 2f73 7061 6e3e 3c73 7061  "o">-</span><spa
-00011a90: 6e20 636c 6173 733d 226e 223e 6475 3c2f  n class="n">du</
-00011aa0: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
-00011ab0: 3d22 7022 3e2c 3c2f 7370 616e 3e20 3c73  ="p">,</span> <s
-00011ac0: 7061 6e20 636c 6173 733d 226e 223e 6469  pan class="n">di
-00011ad0: 6d3c 2f73 7061 6e3e 3c73 7061 6e20 636c  m</span><span cl
-00011ae0: 6173 733d 226f 223e 3d3c 2f73 7061 6e3e  ass="o">=</span>
-00011af0: 3c73 7061 6e20 636c 6173 733d 226d 6922  <span class="mi"
-00011b00: 3e31 3c2f 7370 616e 3e3c 7370 616e 2063  >1</span><span c
-00011b10: 6c61 7373 3d22 7022 3e29 3c2f 7370 616e  lass="p">)</span
-00011b20: 3e0a 2020 2020 2020 2020 2020 2020 2020  >.              
-00011b30: 2020 3c73 7061 6e20 636c 6173 733d 226e    <span class="n
-00011b40: 223e 465f 6c69 7374 3c2f 7370 616e 3e3c  ">F_list</span><
-00011b50: 7370 616e 2063 6c61 7373 3d22 6f22 3e2e  span class="o">.
-00011b60: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-00011b70: 7373 3d22 6e22 3e61 7070 656e 643c 2f73  ss="n">append</s
-00011b80: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
-00011b90: 2270 223e 283c 2f73 7061 6e3e 3c73 7061  "p">(</span><spa
-00011ba0: 6e20 636c 6173 733d 226e 223e 463c 2f73  n class="n">F</s
-00011bb0: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
-00011bc0: 2270 223e 293c 2f73 7061 6e3e 0a20 2020  "p">)</span>.   
-00011bd0: 2020 2020 2020 2020 203c 7370 616e 2063           <span c
-00011be0: 6c61 7373 3d22 6e22 3e46 5f6c 6973 743c  lass="n">F_list<
-00011bf0: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
-00011c00: 7373 3d22 6f22 3e3d 3c2f 7370 616e 3e20  ss="o">=</span> 
-00011c10: 3c73 7061 6e20 636c 6173 733d 226e 223e  <span class="n">
-00011c20: 746f 7263 683c 2f73 7061 6e3e 3c73 7061  torch</span><spa
-00011c30: 6e20 636c 6173 733d 226f 223e 2e3c 2f73  n class="o">.</s
-00011c40: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
-00011c50: 226e 223e 7374 6163 6b3c 2f73 7061 6e3e  "n">stack</span>
-00011c60: 3c73 7061 6e20 636c 6173 733d 2270 223e  <span class="p">
-00011c70: 283c 2f73 7061 6e3e 3c73 7061 6e20 636c  (</span><span cl
-00011c80: 6173 733d 226e 223e 465f 6c69 7374 3c2f  ass="n">F_list</
-00011c90: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
-00011ca0: 3d22 7022 3e2c 3c2f 7370 616e 3e20 3c73  ="p">,</span> <s
-00011cb0: 7061 6e20 636c 6173 733d 226e 223e 6469  pan class="n">di
-00011cc0: 6d3c 2f73 7061 6e3e 3c73 7061 6e20 636c  m</span><span cl
-00011cd0: 6173 733d 226f 223e 3d3c 2f73 7061 6e3e  ass="o">=</span>
-00011ce0: 3c73 7061 6e20 636c 6173 733d 226d 6922  <span class="mi"
-00011cf0: 3e31 3c2f 7370 616e 3e3c 7370 616e 2063  >1</span><span c
-00011d00: 6c61 7373 3d22 7022 3e29 3c2f 7370 616e  lass="p">)</span
-00011d10: 3e0a 2020 2020 2020 2020 2020 2020 3c73  >.            <s
-00011d20: 7061 6e20 636c 6173 733d 226e 223e 463c  pan class="n">F<
-00011d30: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
-00011d40: 7373 3d22 6f22 3e3d 3c2f 7370 616e 3e20  ss="o">=</span> 
-00011d50: 3c73 7061 6e20 636c 6173 733d 226e 223e  <span class="n">
-00011d60: 746f 7263 683c 2f73 7061 6e3e 3c73 7061  torch</span><spa
-00011d70: 6e20 636c 6173 733d 226f 223e 2e3c 2f73  n class="o">.</s
-00011d80: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
-00011d90: 226e 223e 6d65 616e 3c2f 7370 616e 3e3c  "n">mean</span><
-00011da0: 7370 616e 2063 6c61 7373 3d22 7022 3e28  span class="p">(
-00011db0: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-00011dc0: 7373 3d22 6e22 3e46 5f6c 6973 743c 2f73  ss="n">F_list</s
-00011dd0: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
-00011de0: 2270 223e 2c3c 2f73 7061 6e3e 203c 7370  "p">,</span> <sp
-00011df0: 616e 2063 6c61 7373 3d22 6e22 3e64 696d  an class="n">dim
-00011e00: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-00011e10: 7373 3d22 6f22 3e3d 3c2f 7370 616e 3e3c  ss="o">=</span><
-00011e20: 7370 616e 2063 6c61 7373 3d22 6d69 223e  span class="mi">
-00011e30: 313c 2f73 7061 6e3e 3c73 7061 6e20 636c  1</span><span cl
-00011e40: 6173 733d 2270 223e 293c 2f73 7061 6e3e  ass="p">)</span>
-00011e50: 0a20 2020 2020 2020 2020 2020 203c 7370  .            <sp
-00011e60: 616e 2063 6c61 7373 3d22 6e22 3e46 5f73  an class="n">F_s
-00011e70: 7464 3c2f 7370 616e 3e20 3c73 7061 6e20  td</span> <span 
-00011e80: 636c 6173 733d 226f 223e 3d3c 2f73 7061  class="o">=</spa
-00011e90: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
-00011ea0: 6e22 3e74 6f72 6368 3c2f 7370 616e 3e3c  n">torch</span><
-00011eb0: 7370 616e 2063 6c61 7373 3d22 6f22 3e2e  span class="o">.
-00011ec0: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-00011ed0: 7373 3d22 6e22 3e73 7464 3c2f 7370 616e  ss="n">std</span
-00011ee0: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
-00011ef0: 3e28 3c2f 7370 616e 3e3c 7370 616e 2063  >(</span><span c
-00011f00: 6c61 7373 3d22 6e22 3e46 5f6c 6973 743c  lass="n">F_list<
-00011f10: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
-00011f20: 733d 2270 223e 2c3c 2f73 7061 6e3e 203c  s="p">,</span> <
-00011f30: 7370 616e 2063 6c61 7373 3d22 6e22 3e64  span class="n">d
-00011f40: 696d 3c2f 7370 616e 3e3c 7370 616e 2063  im</span><span c
-00011f50: 6c61 7373 3d22 6f22 3e3d 3c2f 7370 616e  lass="o">=</span
-00011f60: 3e3c 7370 616e 2063 6c61 7373 3d22 6d69  ><span class="mi
-00011f70: 223e 313c 2f73 7061 6e3e 3c73 7061 6e20  ">1</span><span 
-00011f80: 636c 6173 733d 2270 223e 293c 2f73 7061  class="p">)</spa
-00011f90: 6e3e 0a20 2020 2020 2020 2020 2020 203c  n>.            <
-00011fa0: 7370 616e 2063 6c61 7373 3d22 6e22 3e46  span class="n">F
-00011fb0: 5f63 6f76 3c2f 7370 616e 3e20 3c73 7061  _cov</span> <spa
-00011fc0: 6e20 636c 6173 733d 226f 223e 3d3c 2f73  n class="o">=</s
-00011fd0: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
-00011fe0: 3d22 6e22 3e74 6f72 6368 3c2f 7370 616e  ="n">torch</span
-00011ff0: 3e3c 7370 616e 2063 6c61 7373 3d22 6f22  ><span class="o"
-00012000: 3e2e 3c2f 7370 616e 3e3c 7370 616e 2063  >.</span><span c
-00012010: 6c61 7373 3d22 6e22 3e63 6f76 3c2f 7370  lass="n">cov</sp
-00012020: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-00012030: 7022 3e28 3c2f 7370 616e 3e3c 7370 616e  p">(</span><span
-00012040: 2063 6c61 7373 3d22 6e22 3e46 5f6c 6973   class="n">F_lis
-00012050: 743c 2f73 7061 6e3e 3c73 7061 6e20 636c  t</span><span cl
-00012060: 6173 733d 2270 223e 293c 2f73 7061 6e3e  ass="p">)</span>
-00012070: 0a0a 2020 2020 2020 2020 2020 2020 3c73  ..            <s
-00012080: 7061 6e20 636c 6173 733d 226e 223e 4465  pan class="n">De
-00012090: 6c74 6146 3c2f 7370 616e 3e20 3c73 7061  ltaF</span> <spa
-000120a0: 6e20 636c 6173 733d 226f 223e 3d3c 2f73  n class="o">=</s
-000120b0: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
-000120c0: 3d22 6e22 3e46 3c2f 7370 616e 3e3c 7370  ="n">F</span><sp
-000120d0: 616e 2063 6c61 7373 3d22 7022 3e5b 3c2f  an class="p">[</
-000120e0: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
-000120f0: 3d22 6b63 223e 4e6f 6e65 3c2f 7370 616e  ="kc">None</span
-00012100: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
-00012110: 3e2c 3c2f 7370 616e 3e20 3c73 7061 6e20  >,</span> <span 
-00012120: 636c 6173 733d 2270 223e 3a5d 3c2f 7370  class="p">:]</sp
-00012130: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
-00012140: 226f 223e 2d3c 2f73 7061 6e3e 203c 7370  "o">-</span> <sp
-00012150: 616e 2063 6c61 7373 3d22 6e22 3e46 3c2f  an class="n">F</
-00012160: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
-00012170: 3d22 7022 3e5b 3a2c 3c2f 7370 616e 3e20  ="p">[:,</span> 
-00012180: 3c73 7061 6e20 636c 6173 733d 226b 6322  <span class="kc"
-00012190: 3e4e 6f6e 653c 2f73 7061 6e3e 3c73 7061  >None</span><spa
-000121a0: 6e20 636c 6173 733d 2270 223e 5d3c 2f73  n class="p">]</s
-000121b0: 7061 6e3e 0a20 2020 2020 2020 2020 2020  pan>.           
-000121c0: 203c 7370 616e 2063 6c61 7373 3d22 6e22   <span class="n"
-000121d0: 3e44 656c 7461 465f 7374 643c 2f73 7061  >DeltaF_std</spa
-000121e0: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
-000121f0: 6f22 3e3d 3c2f 7370 616e 3e20 3c73 7061  o">=</span> <spa
-00012200: 6e20 636c 6173 733d 226e 223e 746f 7263  n class="n">torc
-00012210: 683c 2f73 7061 6e3e 3c73 7061 6e20 636c  h</span><span cl
-00012220: 6173 733d 226f 223e 2e3c 2f73 7061 6e3e  ass="o">.</span>
-00012230: 3c73 7061 6e20 636c 6173 733d 226e 223e  <span class="n">
-00012240: 7374 643c 2f73 7061 6e3e 3c73 7061 6e20  std</span><span 
-00012250: 636c 6173 733d 2270 223e 283c 2f73 7061  class="p">(</spa
-00012260: 6e3e 3c73 7061 6e20 636c 6173 733d 226e  n><span class="n
-00012270: 223e 465f 6c69 7374 3c2f 7370 616e 3e3c  ">F_list</span><
-00012280: 7370 616e 2063 6c61 7373 3d22 7022 3e5b  span class="p">[
-00012290: 3a2c 3c2f 7370 616e 3e20 3c73 7061 6e20  :,</span> <span 
-000122a0: 636c 6173 733d 2270 223e 3a2c 3c2f 7370  class="p">:,</sp
-000122b0: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
-000122c0: 226b 6322 3e4e 6f6e 653c 2f73 7061 6e3e  "kc">None</span>
-000122d0: 3c73 7061 6e20 636c 6173 733d 2270 223e  <span class="p">
-000122e0: 5d3c 2f73 7061 6e3e 203c 7370 616e 2063  ]</span> <span c
-000122f0: 6c61 7373 3d22 6f22 3e2d 3c2f 7370 616e  lass="o">-</span
-00012300: 3e20 3c73 7061 6e20 636c 6173 733d 226e  > <span class="n
-00012310: 223e 465f 6c69 7374 3c2f 7370 616e 3e3c  ">F_list</span><
-00012320: 7370 616e 2063 6c61 7373 3d22 7022 3e5b  span class="p">[
-00012330: 3a2c 3c2f 7370 616e 3e20 3c73 7061 6e20  :,</span> <span 
-00012340: 636c 6173 733d 226b 6322 3e4e 6f6e 653c  class="kc">None<
-00012350: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
-00012360: 733d 2270 223e 2c3c 2f73 7061 6e3e 203c  s="p">,</span> <
-00012370: 7370 616e 2063 6c61 7373 3d22 7022 3e3a  span class="p">:
-00012380: 5d2c 3c2f 7370 616e 3e20 3c73 7061 6e20  ],</span> <span 
-00012390: 636c 6173 733d 226e 223e 6469 6d3c 2f73  class="n">dim</s
-000123a0: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
-000123b0: 226f 223e 3d3c 2f73 7061 6e3e 3c73 7061  "o">=</span><spa
-000123c0: 6e20 636c 6173 733d 226d 6922 3e31 3c2f  n class="mi">1</
-000123d0: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
-000123e0: 3d22 7022 3e29 3c2f 7370 616e 3e0a 0a20  ="p">)</span>.. 
-000123f0: 2020 2020 2020 203c 7370 616e 2063 6c61         <span cla
-00012400: 7373 3d22 6e22 3e72 6573 756c 7473 3c2f  ss="n">results</
-00012410: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
-00012420: 733d 226f 223e 3d3c 2f73 7061 6e3e 203c  s="o">=</span> <
-00012430: 7370 616e 2063 6c61 7373 3d22 7022 3e7b  span class="p">{
-00012440: 3c2f 7370 616e 3e0a 2020 2020 2020 2020  </span>.        
-00012450: 2020 2020 3c73 7061 6e20 636c 6173 733d      <span class=
-00012460: 2273 3222 3e26 7175 6f74 3b46 2671 756f  "s2">&quot;F&quo
-00012470: 743b 3c2f 7370 616e 3e3c 7370 616e 2063  t;</span><span c
-00012480: 6c61 7373 3d22 7022 3e3a 3c2f 7370 616e  lass="p">:</span
-00012490: 3e20 3c73 7061 6e20 636c 6173 733d 226e  > <span class="n
-000124a0: 223e 463c 2f73 7061 6e3e 3c73 7061 6e20  ">F</span><span 
-000124b0: 636c 6173 733d 226f 223e 2e3c 2f73 7061  class="o">.</spa
-000124c0: 6e3e 3c73 7061 6e20 636c 6173 733d 226e  n><span class="n
-000124d0: 223e 6e75 6d70 793c 2f73 7061 6e3e 3c73  ">numpy</span><s
-000124e0: 7061 6e20 636c 6173 733d 2270 223e 2829  pan class="p">()
-000124f0: 2c3c 2f73 7061 6e3e 0a20 2020 2020 2020  ,</span>.       
-00012500: 2020 2020 203c 7370 616e 2063 6c61 7373       <span class
-00012510: 3d22 7332 223e 2671 756f 743b 465f 7374  ="s2">&quot;F_st
-00012520: 6426 7175 6f74 3b3c 2f73 7061 6e3e 3c73  d&quot;</span><s
-00012530: 7061 6e20 636c 6173 733d 2270 223e 3a3c  pan class="p">:<
-00012540: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
-00012550: 7373 3d22 6e22 3e46 5f73 7464 3c2f 7370  ss="n">F_std</sp
-00012560: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-00012570: 6f22 3e2e 3c2f 7370 616e 3e3c 7370 616e  o">.</span><span
-00012580: 2063 6c61 7373 3d22 6e22 3e6e 756d 7079   class="n">numpy
-00012590: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-000125a0: 7373 3d22 7022 3e28 292c 3c2f 7370 616e  ss="p">(),</span
-000125b0: 3e0a 2020 2020 2020 2020 2020 2020 3c73  >.            <s
-000125c0: 7061 6e20 636c 6173 733d 2273 3222 3e26  pan class="s2">&
-000125d0: 7175 6f74 3b46 5f63 6f76 2671 756f 743b  quot;F_cov&quot;
-000125e0: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-000125f0: 7373 3d22 7022 3e3a 3c2f 7370 616e 3e20  ss="p">:</span> 
-00012600: 3c73 7061 6e20 636c 6173 733d 226e 223e  <span class="n">
-00012610: 465f 636f 763c 2f73 7061 6e3e 3c73 7061  F_cov</span><spa
-00012620: 6e20 636c 6173 733d 226f 223e 2e3c 2f73  n class="o">.</s
-00012630: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
-00012640: 226e 223e 6e75 6d70 793c 2f73 7061 6e3e  "n">numpy</span>
-00012650: 3c73 7061 6e20 636c 6173 733d 2270 223e  <span class="p">
-00012660: 2829 2c3c 2f73 7061 6e3e 0a20 2020 2020  (),</span>.     
-00012670: 2020 2020 2020 203c 7370 616e 2063 6c61         <span cla
-00012680: 7373 3d22 7332 223e 2671 756f 743b 4465  ss="s2">&quot;De
-00012690: 6c74 6146 2671 756f 743b 3c2f 7370 616e  ltaF&quot;</span
-000126a0: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
-000126b0: 3e3a 3c2f 7370 616e 3e20 3c73 7061 6e20  >:</span> <span 
-000126c0: 636c 6173 733d 226e 223e 4465 6c74 6146  class="n">DeltaF
-000126d0: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-000126e0: 7373 3d22 6f22 3e2e 3c2f 7370 616e 3e3c  ss="o">.</span><
-000126f0: 7370 616e 2063 6c61 7373 3d22 6e22 3e6e  span class="n">n
-00012700: 756d 7079 3c2f 7370 616e 3e3c 7370 616e  umpy</span><span
-00012710: 2063 6c61 7373 3d22 7022 3e28 292c 3c2f   class="p">(),</
-00012720: 7370 616e 3e0a 2020 2020 2020 2020 2020  span>.          
-00012730: 2020 3c73 7061 6e20 636c 6173 733d 2273    <span class="s
-00012740: 3222 3e26 7175 6f74 3b44 656c 7461 465f  2">&quot;DeltaF_
-00012750: 7374 6426 7175 6f74 3b3c 2f73 7061 6e3e  std&quot;</span>
-00012760: 3c73 7061 6e20 636c 6173 733d 2270 223e  <span class="p">
-00012770: 3a3c 2f73 7061 6e3e 203c 7370 616e 2063  :</span> <span c
-00012780: 6c61 7373 3d22 6e22 3e44 656c 7461 465f  lass="n">DeltaF_
-00012790: 7374 643c 2f73 7061 6e3e 3c73 7061 6e20  std</span><span 
-000127a0: 636c 6173 733d 226f 223e 2e3c 2f73 7061  class="o">.</spa
-000127b0: 6e3e 3c73 7061 6e20 636c 6173 733d 226e  n><span class="n
-000127c0: 223e 6e75 6d70 793c 2f73 7061 6e3e 3c73  ">numpy</span><s
-000127d0: 7061 6e20 636c 6173 733d 2270 223e 2829  pan class="p">()
-000127e0: 2c3c 2f73 7061 6e3e 0a20 2020 2020 2020  ,</span>.       
-000127f0: 203c 7370 616e 2063 6c61 7373 3d22 7022   <span class="p"
-00012800: 3e7d 3c2f 7370 616e 3e0a 0a20 2020 2020  >}</span>..     
-00012810: 2020 203c 7370 616e 2063 6c61 7373 3d22     <span class="
-00012820: 6b22 3e72 6574 7572 6e3c 2f73 7061 6e3e  k">return</span>
-00012830: 203c 7370 616e 2063 6c61 7373 3d22 6e22   <span class="n"
-00012840: 3e72 6573 756c 7473 3c2f 7370 616e 3e3c  >results</span><
-00012850: 2f64 6976 3e3c 2f64 6976 3e0a 0a3c 7370  /div></div>..<sp
-00012860: 616e 2063 6c61 7373 3d22 6b22 3e64 6566  an class="k">def
-00012870: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
-00012880: 6173 733d 226e 6622 3e5f 636f 6d70 7574  ass="nf">_comput
-00012890: 655f 6c6f 6770 5f6f 665f 463c 2f73 7061  e_logp_of_F</spa
-000128a0: 6e3e 3c73 7061 6e20 636c 6173 733d 2270  n><span class="p
-000128b0: 223e 283c 2f73 7061 6e3e 3c73 7061 6e20  ">(</span><span 
-000128c0: 636c 6173 733d 226e 223e 463c 2f73 7061  class="n">F</spa
-000128d0: 6e3e 3c73 7061 6e20 636c 6173 733d 2270  n><span class="p
-000128e0: 223e 2c3c 2f73 7061 6e3e 203c 7370 616e  ">,</span> <span
-000128f0: 2063 6c61 7373 3d22 6e22 3e65 6e65 7267   class="n">energ
-00012900: 793c 2f73 7061 6e3e 3c73 7061 6e20 636c  y</span><span cl
-00012910: 6173 733d 2270 223e 2c3c 2f73 7061 6e3e  ass="p">,</span>
-00012920: 203c 7370 616e 2063 6c61 7373 3d22 6e22   <span class="n"
-00012930: 3e6e 756d 5f63 6f6e 663c 2f73 7061 6e3e  >num_conf</span>
-00012940: 3c73 7061 6e20 636c 6173 733d 2270 223e  <span class="p">
-00012950: 293a 3c2f 7370 616e 3e0a 2020 2020 3c73  ):</span>.    <s
-00012960: 7061 6e20 636c 6173 733d 226e 223e 6c6f  pan class="n">lo
-00012970: 6770 3c2f 7370 616e 3e20 3c73 7061 6e20  gp</span> <span 
-00012980: 636c 6173 733d 226f 223e 3d3c 2f73 7061  class="o">=</spa
-00012990: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
-000129a0: 7022 3e28 3c2f 7370 616e 3e0a 2020 2020  p">(</span>.    
-000129b0: 2020 2020 3c73 7061 6e20 636c 6173 733d      <span class=
-000129c0: 226e 223e 746f 7263 683c 2f73 7061 6e3e  "n">torch</span>
-000129d0: 3c73 7061 6e20 636c 6173 733d 226f 223e  <span class="o">
-000129e0: 2e3c 2f73 7061 6e3e 3c73 7061 6e20 636c  .</span><span cl
-000129f0: 6173 733d 226e 223e 7375 6d3c 2f73 7061  ass="n">sum</spa
-00012a00: 6e3e 3c73 7061 6e20 636c 6173 733d 2270  n><span class="p
-00012a10: 223e 283c 2f73 7061 6e3e 3c73 7061 6e20  ">(</span><span 
-00012a20: 636c 6173 733d 226e 223e 6e75 6d5f 636f  class="n">num_co
-00012a30: 6e66 3c2f 7370 616e 3e20 3c73 7061 6e20  nf</span> <span 
-00012a40: 636c 6173 733d 226f 223e 2a3c 2f73 7061  class="o">*</spa
-00012a50: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
-00012a60: 6e22 3e46 3c2f 7370 616e 3e3c 7370 616e  n">F</span><span
-00012a70: 2063 6c61 7373 3d22 7022 3e29 3c2f 7370   class="p">)</sp
-00012a80: 616e 3e0a 2020 2020 2020 2020 3c73 7061  an>.        <spa
-00012a90: 6e20 636c 6173 733d 226f 223e 2d3c 2f73  n class="o">-</s
-00012aa0: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
-00012ab0: 3d22 6e22 3e74 6f72 6368 3c2f 7370 616e  ="n">torch</span
-00012ac0: 3e3c 7370 616e 2063 6c61 7373 3d22 6f22  ><span class="o"
-00012ad0: 3e2e 3c2f 7370 616e 3e3c 7370 616e 2063  >.</span><span c
-00012ae0: 6c61 7373 3d22 6e22 3e6c 6f67 7375 6d65  lass="n">logsume
-00012af0: 7870 3c2f 7370 616e 3e3c 7370 616e 2063  xp</span><span c
-00012b00: 6c61 7373 3d22 7022 3e28 3c2f 7370 616e  lass="p">(</span
-00012b10: 3e3c 7370 616e 2063 6c61 7373 3d22 6f22  ><span class="o"
-00012b20: 3e2d 3c2f 7370 616e 3e3c 7370 616e 2063  >-</span><span c
-00012b30: 6c61 7373 3d22 7022 3e28 3c2f 7370 616e  lass="p">(</span
-00012b40: 3e3c 7370 616e 2063 6c61 7373 3d22 6e22  ><span class="n"
-00012b50: 3e65 6e65 7267 793c 2f73 7061 6e3e 3c73  >energy</span><s
-00012b60: 7061 6e20 636c 6173 733d 226f 223e 2e3c  pan class="o">.<
-00012b70: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
-00012b80: 733d 226e 223e 543c 2f73 7061 6e3e 203c  s="n">T</span> <
-00012b90: 7370 616e 2063 6c61 7373 3d22 6f22 3e2d  span class="o">-
-00012ba0: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
-00012bb0: 6173 733d 226e 223e 746f 7263 683c 2f73  ass="n">torch</s
-00012bc0: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
-00012bd0: 226f 223e 2e3c 2f73 7061 6e3e 3c73 7061  "o">.</span><spa
-00012be0: 6e20 636c 6173 733d 226e 223e 6c6f 673c  n class="n">log<
-00012bf0: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
-00012c00: 733d 2270 223e 283c 2f73 7061 6e3e 3c73  s="p">(</span><s
-00012c10: 7061 6e20 636c 6173 733d 226e 223e 6e75  pan class="n">nu
-00012c20: 6d5f 636f 6e66 3c2f 7370 616e 3e3c 7370  m_conf</span><sp
-00012c30: 616e 2063 6c61 7373 3d22 7022 3e29 3c2f  an class="p">)</
-00012c40: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
-00012c50: 733d 226f 223e 2d3c 2f73 7061 6e3e 203c  s="o">-</span> <
-00012c60: 7370 616e 2063 6c61 7373 3d22 6e22 3e46  span class="n">F
-00012c70: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-00012c80: 7373 3d22 7022 3e29 2c3c 2f73 7061 6e3e  ss="p">),</span>
-00012c90: 203c 7370 616e 2063 6c61 7373 3d22 6e22   <span class="n"
-00012ca0: 3e64 696d 3c2f 7370 616e 3e3c 7370 616e  >dim</span><span
-00012cb0: 2063 6c61 7373 3d22 6f22 3e3d 3c2f 7370   class="o">=</sp
-00012cc0: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-00012cd0: 6d69 223e 313c 2f73 7061 6e3e 3c73 7061  mi">1</span><spa
-00012ce0: 6e20 636c 6173 733d 2270 223e 293c 2f73  n class="p">)</s
-00012cf0: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
-00012d00: 226f 223e 2e3c 2f73 7061 6e3e 3c73 7061  "o">.</span><spa
-00012d10: 6e20 636c 6173 733d 226e 223e 7375 6d3c  n class="n">sum<
-00012d20: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
-00012d30: 733d 2270 223e 2829 3c2f 7370 616e 3e0a  s="p">()</span>.
-00012d40: 2020 2020 3c73 7061 6e20 636c 6173 733d      <span class=
-00012d50: 2270 223e 293c 2f73 7061 6e3e 0a20 2020  "p">)</span>.   
-00012d60: 203c 7370 616e 2063 6c61 7373 3d22 6b22   <span class="k"
-00012d70: 3e72 6574 7572 6e3c 2f73 7061 6e3e 203c  >return</span> <
-00012d80: 7370 616e 2063 6c61 7373 3d22 6e22 3e6c  span class="n">l
-00012d90: 6f67 703c 2f73 7061 6e3e 0a0a 0a3c 7370  ogp</span>...<sp
-00012da0: 616e 2063 6c61 7373 3d22 6b22 3e64 6566  an class="k">def
-00012db0: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
-00012dc0: 6173 733d 226e 6622 3e5f 636f 6d70 7574  ass="nf">_comput
-00012dd0: 655f 6c6f 7373 5f61 6e64 5f67 7261 645f  e_loss_and_grad_
-00012de0: 6f66 5f64 463c 2f73 7061 6e3e 3c73 7061  of_dF</span><spa
-00012df0: 6e20 636c 6173 733d 2270 223e 283c 2f73  n class="p">(</s
-00012e00: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
-00012e10: 226e 223e 6446 3c2f 7370 616e 3e3c 7370  "n">dF</span><sp
-00012e20: 616e 2063 6c61 7373 3d22 7022 3e2c 3c2f  an class="p">,</
-00012e30: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
-00012e40: 733d 226e 223e 656e 6572 6779 3c2f 7370  s="n">energy</sp
-00012e50: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-00012e60: 7022 3e2c 3c2f 7370 616e 3e20 3c73 7061  p">,</span> <spa
-00012e70: 6e20 636c 6173 733d 226e 223e 6e75 6d5f  n class="n">num_
-00012e80: 636f 6e66 3c2f 7370 616e 3e3c 7370 616e  conf</span><span
-00012e90: 2063 6c61 7373 3d22 7022 3e29 3a3c 2f73   class="p">):</s
-00012ea0: 7061 6e3e 0a3c 7370 616e 2063 6c61 7373  pan>.<span class
-00012eb0: 3d22 7722 3e20 2020 203c 2f73 7061 6e3e  ="w">    </span>
-00012ec0: 3c73 7061 6e20 636c 6173 733d 2273 6422  <span class="sd"
-00012ed0: 3e26 7175 6f74 3b26 7175 6f74 3b26 7175  >&quot;&quot;&qu
-00012ee0: 6f74 3b43 6f6d 7075 7465 2074 6865 206c  ot;Compute the l
-00012ef0: 6f73 7320 6675 6e63 7469 6f6e 2061 6e64  oss function and
-00012f00: 2074 6865 2067 7261 6469 656e 7420 6f66   the gradient of
-00012f10: 2064 4620 6769 7665 6e20 656e 6572 6779   dF given energy
-00012f20: 2061 6e64 206e 756d 5f63 6f6e 662e 3c2f   and num_conf.</
-00012f30: 7370 616e 3e0a 3c73 7061 6e20 636c 6173  span>.<span clas
-00012f40: 733d 2273 6422 3e20 2020 2050 6172 616d  s="sd">    Param
-00012f50: 6574 6572 733c 2f73 7061 6e3e 0a3c 7370  eters</span>.<sp
-00012f60: 616e 2063 6c61 7373 3d22 7364 223e 2020  an class="sd">  
-00012f70: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 3c2f 7370    ----------</sp
-00012f80: 616e 3e0a 3c73 7061 6e20 636c 6173 733d  an>.<span class=
-00012f90: 2273 6422 3e20 2020 2064 463a 2031 2d44  "sd">    dF: 1-D
-00012fa0: 2066 6c6f 6174 2074 656e 736f 7220 7769   float tensor wi
-00012fb0: 7468 2073 697a 6520 284d 2d31 293c 2f73  th size (M-1)</s
-00012fc0: 7061 6e3e 0a3c 7370 616e 2063 6c61 7373  pan>.<span class
-00012fd0: 3d22 7364 223e 2020 2020 2020 2020 5468  ="sd">        Th
-00012fe0: 6520 6672 6565 2065 6e65 7267 7920 6469  e free energy di
-00012ff0: 6666 6572 656e 6365 2062 6574 7765 656e  fference between
-00013000: 2073 7461 7465 2030 2061 6e64 206f 7468   state 0 and oth
-00013010: 6572 2073 7461 7465 732e 2054 6865 2065  er states. The e
-00013020: 6e74 7279 3c2f 7370 616e 3e0a 3c73 7061  ntry</span>.<spa
-00013030: 6e20 636c 6173 733d 2273 6422 3e20 2020  n class="sd">   
-00013040: 2020 2020 2064 465b 695d 2069 7320 7468       dF[i] is th
-00013050: 6520 6672 6565 2065 6e65 7267 7920 6469  e free energy di
-00013060: 6666 6572 656e 6365 2062 6574 7765 656e  fference between
-00013070: 2073 7461 7465 2030 2061 6e64 2073 7461   state 0 and sta
-00013080: 7465 2069 2b31 2e3c 2f73 7061 6e3e 0a3c  te i+1.</span>.<
-00013090: 7370 616e 2063 6c61 7373 3d22 7364 223e  span class="sd">
-000130a0: 2020 2020 656e 6572 6779 3a20 322d 4420      energy: 2-D 
-000130b0: 666c 6f61 7420 7465 6e73 6f72 2077 6974  float tensor wit
-000130c0: 6820 7369 7a65 2028 4d20 7820 4e29 3c2f  h size (M x N)</
-000130d0: 7370 616e 3e0a 3c73 7061 6e20 636c 6173  span>.<span clas
-000130e0: 733d 2273 6422 3e20 2020 2020 2020 2041  s="sd">        A
-000130f0: 2032 2d44 2074 656e 736f 7220 7769 7468   2-D tensor with
-00013100: 2073 697a 6520 6f66 204d 2078 204e 2c20   size of M x N, 
-00013110: 7768 6572 6520 4d20 6973 2074 6865 206e  where M is the n
-00013120: 756d 6265 7220 6f66 2073 7461 7473 3c2f  umber of stats</
-00013130: 7370 616e 3e0a 3c73 7061 6e20 636c 6173  span>.<span clas
-00013140: 733d 2273 6422 3e20 2020 2020 2020 2061  s="sd">        a
-00013150: 6e64 204e 2069 7320 7468 6520 746f 7461  nd N is the tota
-00013160: 6c20 6e75 6d62 6572 206f 6620 636f 6e66  l number of conf
-00013170: 6f72 6d61 7469 6f6e 732e 2054 6865 2065  ormations. The e
-00013180: 6e74 7279 2065 6e65 7267 795b 692c 6a5d  ntry energy[i,j]
-00013190: 3c2f 7370 616e 3e0a 3c73 7061 6e20 636c  </span>.<span cl
-000131a0: 6173 733d 2273 6422 3e20 2020 206e 756d  ass="sd">    num
-000131b0: 5f63 6f6e 663a 2031 2d44 2069 6e74 2074  _conf: 1-D int t
-000131c0: 656e 736f 7220 7769 7468 2073 697a 6520  ensor with size 
-000131d0: 284d 293c 2f73 7061 6e3e 0a3c 7370 616e  (M)</span>.<span
-000131e0: 2063 6c61 7373 3d22 7364 223e 2020 2020   class="sd">    
-000131f0: 2020 2020 4120 312d 4420 7465 6e73 6f72      A 1-D tensor
-00013200: 2077 6974 6820 7369 7a65 206f 6620 4d2c   with size of M,
-00013210: 2077 6865 7265 206e 756d 5f63 6f6e 665b   where num_conf[
-00013220: 695d 2069 7320 7468 6520 6e75 6d20 6f66  i] is the num of
-00013230: 3c2f 7370 616e 3e0a 3c73 7061 6e20 636c  </span>.<span cl
-00013240: 6173 733d 2273 6422 3e20 2020 2020 2020  ass="sd">       
-00013250: 2063 6f6e 666f 726d 6174 696f 6e73 2073   conformations s
-00013260: 616d 706c 6564 2066 726f 6d20 7374 6174  ampled from stat
-00013270: 6520 692e 2054 6865 7265 666f 7265 2c20  e i. Therefore, 
-00013280: 746f 7263 682e 7375 6d28 6e75 6d5f 636f  torch.sum(num_co
-00013290: 6e66 293c 2f73 7061 6e3e 0a3c 7370 616e  nf)</span>.<span
-000132a0: 2063 6c61 7373 3d22 7364 223e 2020 2020   class="sd">    
-000132b0: 2020 2020 6861 7320 746f 2062 6520 6571      has to be eq
-000132c0: 7561 6c20 746f 204e 2e20 416c 6c20 656e  ual to N. All en
-000132d0: 7472 6965 7320 696e 206e 756d 5f63 6f6e  tries in num_con
-000132e0: 6620 6861 7665 2074 6f20 6265 2073 7472  f have to be str
-000132f0: 6963 746c 793c 2f73 7061 6e3e 0a3c 7370  ictly</span>.<sp
-00013300: 616e 2063 6c61 7373 3d22 7364 223e 2020  an class="sd">  
-00013310: 2020 2020 2020 6772 6561 7465 7220 7468        greater th
-00013320: 616e 2030 2e3c 2f73 7061 6e3e 0a3c 7370  an 0.</span>.<sp
-00013330: 616e 2063 6c61 7373 3d22 7364 223e 2020  an class="sd">  
-00013340: 2020 2671 756f 743b 2671 756f 743b 2671    &quot;&quot;&q
-00013350: 756f 743b 3c2f 7370 616e 3e0a 0a20 2020  uot;</span>..   
-00013360: 203c 7370 616e 2063 6c61 7373 3d22 6331   <span class="c1
-00013370: 223e 2320 636f 6d70 7574 6520 7468 6520  "># compute the 
-00013380: 6c6f 7373 2066 756e 6374 696f 6e3c 2f73  loss function</s
-00013390: 7061 6e3e 0a20 2020 203c 7370 616e 2063  pan>.    <span c
-000133a0: 6c61 7373 3d22 6e22 3e46 3c2f 7370 616e  lass="n">F</span
-000133b0: 3e20 3c73 7061 6e20 636c 6173 733d 226f  > <span class="o
-000133c0: 223e 3d3c 2f73 7061 6e3e 203c 7370 616e  ">=</span> <span
-000133d0: 2063 6c61 7373 3d22 6e22 3e74 6f72 6368   class="n">torch
-000133e0: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-000133f0: 7373 3d22 6f22 3e2e 3c2f 7370 616e 3e3c  ss="o">.</span><
-00013400: 7370 616e 2063 6c61 7373 3d22 6e22 3e63  span class="n">c
-00013410: 6174 3c2f 7370 616e 3e3c 7370 616e 2063  at</span><span c
-00013420: 6c61 7373 3d22 7022 3e28 5b3c 2f73 7061  lass="p">([</spa
-00013430: 6e3e 3c73 7061 6e20 636c 6173 733d 226e  n><span class="n
-00013440: 223e 6446 3c2f 7370 616e 3e3c 7370 616e  ">dF</span><span
-00013450: 2063 6c61 7373 3d22 6f22 3e2e 3c2f 7370   class="o">.</sp
-00013460: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-00013470: 6e22 3e6e 6577 5f7a 6572 6f73 3c2f 7370  n">new_zeros</sp
+00010a70: 3e6c 696e 616c 673c 2f73 7061 6e3e 3c73  >linalg</span><s
+00010a80: 7061 6e20 636c 6173 733d 226f 223e 2e3c  pan class="o">.<
+00010a90: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
+00010aa0: 733d 226e 223e 7172 3c2f 7370 616e 3e3c  s="n">qr</span><
+00010ab0: 7370 616e 2063 6c61 7373 3d22 7022 3e28  span class="p">(
+00010ac0: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
+00010ad0: 7373 3d22 6270 223e 7365 6c66 3c2f 7370  ss="bp">self</sp
+00010ae0: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+00010af0: 6f22 3e2e 3c2f 7370 616e 3e3c 7370 616e  o">.</span><span
+00010b00: 2063 6c61 7373 3d22 6e22 3e5f 503c 2f73   class="n">_P</s
+00010b10: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
+00010b20: 2270 223e 293c 2f73 7061 6e3e 0a20 2020  "p">)</span>.   
+00010b30: 2020 2020 2020 2020 203c 7370 616e 2063           <span c
+00010b40: 6c61 7373 3d22 6e22 3e41 3c2f 7370 616e  lass="n">A</span
+00010b50: 3e20 3c73 7061 6e20 636c 6173 733d 226f  > <span class="o
+00010b60: 223e 3d3c 2f73 7061 6e3e 203c 7370 616e  ">=</span> <span
+00010b70: 2063 6c61 7373 3d22 6e22 3e74 6f72 6368   class="n">torch
+00010b80: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
+00010b90: 7373 3d22 6f22 3e2e 3c2f 7370 616e 3e3c  ss="o">.</span><
+00010ba0: 7370 616e 2063 6c61 7373 3d22 6e22 3e65  span class="n">e
+00010bb0: 7965 3c2f 7370 616e 3e3c 7370 616e 2063  ye</span><span c
+00010bc0: 6c61 7373 3d22 7022 3e28 3c2f 7370 616e  lass="p">(</span
+00010bd0: 3e3c 7370 616e 2063 6c61 7373 3d22 6270  ><span class="bp
+00010be0: 223e 7365 6c66 3c2f 7370 616e 3e3c 7370  ">self</span><sp
+00010bf0: 616e 2063 6c61 7373 3d22 6f22 3e2e 3c2f  an class="o">.</
+00010c00: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+00010c10: 3d22 6e22 3e4d 3c2f 7370 616e 3e20 3c73  ="n">M</span> <s
+00010c20: 7061 6e20 636c 6173 733d 226f 223e 2b3c  pan class="o">+<
+00010c30: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
+00010c40: 7373 3d22 6e22 3e4c 3c2f 7370 616e 3e3c  ss="n">L</span><
+00010c50: 7370 616e 2063 6c61 7373 3d22 7022 3e2c  span class="p">,
+00010c60: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
+00010c70: 6173 733d 226e 223e 6465 7669 6365 3c2f  ass="n">device</
+00010c80: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+00010c90: 3d22 6f22 3e3d 3c2f 7370 616e 3e3c 7370  ="o">=</span><sp
+00010ca0: 616e 2063 6c61 7373 3d22 6e22 3e57 3c2f  an class="n">W</
+00010cb0: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+00010cc0: 3d22 6f22 3e2e 3c2f 7370 616e 3e3c 7370  ="o">.</span><sp
+00010cd0: 616e 2063 6c61 7373 3d22 6e22 3e64 6576  an class="n">dev
+00010ce0: 6963 653c 2f73 7061 6e3e 3c73 7061 6e20  ice</span><span 
+00010cf0: 636c 6173 733d 2270 223e 293c 2f73 7061  class="p">)</spa
+00010d00: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
+00010d10: 6f22 3e2d 3c2f 7370 616e 3e20 3c73 7061  o">-</span> <spa
+00010d20: 6e20 636c 6173 733d 226e 223e 523c 2f73  n class="n">R</s
+00010d30: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
+00010d40: 3d22 6f22 3e40 3c2f 7370 616e 3e20 3c73  ="o">@</span> <s
+00010d50: 7061 6e20 636c 6173 733d 226e 223e 573c  pan class="n">W<
+00010d60: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
+00010d70: 7373 3d22 6f22 3e40 3c2f 7370 616e 3e20  ss="o">@</span> 
+00010d80: 3c73 7061 6e20 636c 6173 733d 226e 223e  <span class="n">
+00010d90: 523c 2f73 7061 6e3e 3c73 7061 6e20 636c  R</span><span cl
+00010da0: 6173 733d 226f 223e 2e3c 2f73 7061 6e3e  ass="o">.</span>
+00010db0: 3c73 7061 6e20 636c 6173 733d 226e 223e  <span class="n">
+00010dc0: 543c 2f73 7061 6e3e 0a20 2020 2020 2020  T</span>.       
+00010dd0: 2020 2020 203c 7370 616e 2063 6c61 7373       <span class
+00010de0: 3d22 6e22 3e46 5f63 6f76 3c2f 7370 616e  ="n">F_cov</span
+00010df0: 3e20 3c73 7061 6e20 636c 6173 733d 226f  > <span class="o
+00010e00: 223e 3d3c 2f73 7061 6e3e 203c 7370 616e  ">=</span> <span
+00010e10: 2063 6c61 7373 3d22 6e22 3e52 3c2f 7370   class="n">R</sp
+00010e20: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+00010e30: 6f22 3e2e 3c2f 7370 616e 3e3c 7370 616e  o">.</span><span
+00010e40: 2063 6c61 7373 3d22 6e22 3e54 3c2f 7370   class="n">T</sp
+00010e50: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
+00010e60: 226f 223e 403c 2f73 7061 6e3e 203c 7370  "o">@</span> <sp
+00010e70: 616e 2063 6c61 7373 3d22 6e22 3e74 6f72  an class="n">tor
+00010e80: 6368 3c2f 7370 616e 3e3c 7370 616e 2063  ch</span><span c
+00010e90: 6c61 7373 3d22 6f22 3e2e 3c2f 7370 616e  lass="o">.</span
+00010ea0: 3e3c 7370 616e 2063 6c61 7373 3d22 6e22  ><span class="n"
+00010eb0: 3e6c 696e 616c 673c 2f73 7061 6e3e 3c73  >linalg</span><s
+00010ec0: 7061 6e20 636c 6173 733d 226f 223e 2e3c  pan class="o">.<
+00010ed0: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
+00010ee0: 733d 226e 223e 7069 6e76 3c2f 7370 616e  s="n">pinv</span
+00010ef0: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
+00010f00: 3e28 3c2f 7370 616e 3e3c 7370 616e 2063  >(</span><span c
+00010f10: 6c61 7373 3d22 6e22 3e41 3c2f 7370 616e  lass="n">A</span
+00010f20: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
+00010f30: 3e2c 3c2f 7370 616e 3e20 3c73 7061 6e20  >,</span> <span 
+00010f40: 636c 6173 733d 226e 223e 6865 726d 6974  class="n">hermit
+00010f50: 6961 6e3c 2f73 7061 6e3e 3c73 7061 6e20  ian</span><span 
+00010f60: 636c 6173 733d 226f 223e 3d3c 2f73 7061  class="o">=</spa
+00010f70: 6e3e 3c73 7061 6e20 636c 6173 733d 226b  n><span class="k
+00010f80: 6322 3e54 7275 653c 2f73 7061 6e3e 3c73  c">True</span><s
+00010f90: 7061 6e20 636c 6173 733d 2270 223e 2c3c  pan class="p">,<
+00010fa0: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
+00010fb0: 7373 3d22 6e22 3e72 746f 6c3c 2f73 7061  ss="n">rtol</spa
+00010fc0: 6e3e 3c73 7061 6e20 636c 6173 733d 226f  n><span class="o
+00010fd0: 223e 3d3c 2f73 7061 6e3e 3c73 7061 6e20  ">=</span><span 
+00010fe0: 636c 6173 733d 226d 6622 3e31 652d 383c  class="mf">1e-8<
+00010ff0: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
+00011000: 733d 2270 223e 293c 2f73 7061 6e3e 203c  s="p">)</span> <
+00011010: 7370 616e 2063 6c61 7373 3d22 6f22 3e40  span class="o">@
+00011020: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
+00011030: 6173 733d 226e 223e 523c 2f73 7061 6e3e  ass="n">R</span>
+00011040: 0a0a 2020 2020 2020 2020 2020 2020 3c73  ..            <s
+00011050: 7061 6e20 636c 6173 733d 226e 223e 465f  pan class="n">F_
+00011060: 636f 763c 2f73 7061 6e3e 203c 7370 616e  cov</span> <span
+00011070: 2063 6c61 7373 3d22 6f22 3e3d 3c2f 7370   class="o">=</sp
+00011080: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
+00011090: 226e 223e 465f 636f 763c 2f73 7061 6e3e  "n">F_cov</span>
+000110a0: 3c73 7061 6e20 636c 6173 733d 2270 223e  <span class="p">
+000110b0: 5b3c 2f73 7061 6e3e 3c73 7061 6e20 636c  [</span><span cl
+000110c0: 6173 733d 2262 7022 3e73 656c 663c 2f73  ass="bp">self</s
+000110d0: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
+000110e0: 226f 223e 2e3c 2f73 7061 6e3e 3c73 7061  "o">.</span><spa
+000110f0: 6e20 636c 6173 733d 226e 223e 4d3c 2f73  n class="n">M</s
+00011100: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
+00011110: 3d22 7022 3e3a 2c3c 2f73 7061 6e3e 203c  ="p">:,</span> <
+00011120: 7370 616e 2063 6c61 7373 3d22 6270 223e  span class="bp">
+00011130: 7365 6c66 3c2f 7370 616e 3e3c 7370 616e  self</span><span
+00011140: 2063 6c61 7373 3d22 6f22 3e2e 3c2f 7370   class="o">.</sp
+00011150: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+00011160: 6e22 3e4d 3c2f 7370 616e 3e20 3c73 7061  n">M</span> <spa
+00011170: 6e20 636c 6173 733d 2270 223e 3a5d 3c2f  n class="p">:]</
+00011180: 7370 616e 3e0a 2020 2020 2020 2020 2020  span>.          
+00011190: 2020 3c73 7061 6e20 636c 6173 733d 226e    <span class="n
+000111a0: 223e 465f 7374 643c 2f73 7061 6e3e 203c  ">F_std</span> <
+000111b0: 7370 616e 2063 6c61 7373 3d22 6f22 3e3d  span class="o">=
+000111c0: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
+000111d0: 6173 733d 226e 223e 465f 636f 763c 2f73  ass="n">F_cov</s
+000111e0: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
+000111f0: 226f 223e 2e3c 2f73 7061 6e3e 3c73 7061  "o">.</span><spa
+00011200: 6e20 636c 6173 733d 226e 223e 6469 6167  n class="n">diag
+00011210: 6f6e 616c 3c2f 7370 616e 3e3c 7370 616e  onal</span><span
+00011220: 2063 6c61 7373 3d22 7022 3e28 293c 2f73   class="p">()</s
+00011230: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
+00011240: 226f 223e 2e3c 2f73 7061 6e3e 3c73 7061  "o">.</span><spa
+00011250: 6e20 636c 6173 733d 226e 223e 7371 7274  n class="n">sqrt
+00011260: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
+00011270: 7373 3d22 7022 3e28 293c 2f73 7061 6e3e  ss="p">()</span>
+00011280: 0a0a 2020 2020 2020 2020 2020 2020 3c73  ..            <s
+00011290: 7061 6e20 636c 6173 733d 226e 223e 4465  pan class="n">De
+000112a0: 6c74 6146 3c2f 7370 616e 3e20 3c73 7061  ltaF</span> <spa
+000112b0: 6e20 636c 6173 733d 226f 223e 3d3c 2f73  n class="o">=</s
+000112c0: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
+000112d0: 3d22 6e22 3e46 3c2f 7370 616e 3e3c 7370  ="n">F</span><sp
+000112e0: 616e 2063 6c61 7373 3d22 7022 3e5b 3c2f  an class="p">[</
+000112f0: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+00011300: 3d22 6b63 223e 4e6f 6e65 3c2f 7370 616e  ="kc">None</span
+00011310: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
+00011320: 3e2c 3c2f 7370 616e 3e20 3c73 7061 6e20  >,</span> <span 
+00011330: 636c 6173 733d 2270 223e 3a5d 3c2f 7370  class="p">:]</sp
+00011340: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
+00011350: 226f 223e 2d3c 2f73 7061 6e3e 203c 7370  "o">-</span> <sp
+00011360: 616e 2063 6c61 7373 3d22 6e22 3e46 3c2f  an class="n">F</
+00011370: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+00011380: 3d22 7022 3e5b 3a2c 3c2f 7370 616e 3e20  ="p">[:,</span> 
+00011390: 3c73 7061 6e20 636c 6173 733d 226b 6322  <span class="kc"
+000113a0: 3e4e 6f6e 653c 2f73 7061 6e3e 3c73 7061  >None</span><spa
+000113b0: 6e20 636c 6173 733d 2270 223e 5d3c 2f73  n class="p">]</s
+000113c0: 7061 6e3e 0a20 2020 2020 2020 2020 2020  pan>.           
+000113d0: 203c 7370 616e 2063 6c61 7373 3d22 6e22   <span class="n"
+000113e0: 3e44 656c 7461 465f 636f 763c 2f73 7061  >DeltaF_cov</spa
+000113f0: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
+00011400: 6f22 3e3d 3c2f 7370 616e 3e20 3c73 7061  o">=</span> <spa
+00011410: 6e20 636c 6173 733d 226e 223e 465f 636f  n class="n">F_co
+00011420: 763c 2f73 7061 6e3e 3c73 7061 6e20 636c  v</span><span cl
+00011430: 6173 733d 226f 223e 2e3c 2f73 7061 6e3e  ass="o">.</span>
+00011440: 3c73 7061 6e20 636c 6173 733d 226e 223e  <span class="n">
+00011450: 6469 6167 3c2f 7370 616e 3e3c 7370 616e  diag</span><span
+00011460: 2063 6c61 7373 3d22 7022 3e28 295b 3a2c   class="p">()[:,
+00011470: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
+00011480: 6173 733d 226b 6322 3e4e 6f6e 653c 2f73  ass="kc">None</s
+00011490: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
+000114a0: 2270 223e 5d3c 2f73 7061 6e3e 203c 7370  "p">]</span> <sp
+000114b0: 616e 2063 6c61 7373 3d22 6f22 3e2b 3c2f  an class="o">+</
+000114c0: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
+000114d0: 733d 226e 223e 465f 636f 763c 2f73 7061  s="n">F_cov</spa
+000114e0: 6e3e 3c73 7061 6e20 636c 6173 733d 226f  n><span class="o
+000114f0: 223e 2e3c 2f73 7061 6e3e 3c73 7061 6e20  ">.</span><span 
+00011500: 636c 6173 733d 226e 223e 6469 6167 3c2f  class="n">diag</
+00011510: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+00011520: 3d22 7022 3e28 295b 3c2f 7370 616e 3e3c  ="p">()[</span><
+00011530: 7370 616e 2063 6c61 7373 3d22 6b63 223e  span class="kc">
+00011540: 4e6f 6e65 3c2f 7370 616e 3e3c 7370 616e  None</span><span
+00011550: 2063 6c61 7373 3d22 7022 3e2c 3c2f 7370   class="p">,</sp
+00011560: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
+00011570: 2270 223e 3a5d 3c2f 7370 616e 3e20 3c73  "p">:]</span> <s
+00011580: 7061 6e20 636c 6173 733d 226f 223e 2d3c  pan class="o">-<
+00011590: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
+000115a0: 7373 3d22 6d69 223e 323c 2f73 7061 6e3e  ss="mi">2</span>
+000115b0: 203c 7370 616e 2063 6c61 7373 3d22 6f22   <span class="o"
+000115c0: 3e2a 3c2f 7370 616e 3e20 3c73 7061 6e20  >*</span> <span 
+000115d0: 636c 6173 733d 226e 223e 465f 636f 763c  class="n">F_cov<
+000115e0: 2f73 7061 6e3e 0a20 2020 2020 2020 2020  /span>.         
+000115f0: 2020 203c 7370 616e 2063 6c61 7373 3d22     <span class="
+00011600: 6e22 3e44 656c 7461 465f 7374 643c 2f73  n">DeltaF_std</s
+00011610: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
+00011620: 3d22 6f22 3e3d 3c2f 7370 616e 3e20 3c73  ="o">=</span> <s
+00011630: 7061 6e20 636c 6173 733d 226e 223e 4465  pan class="n">De
+00011640: 6c74 6146 5f63 6f76 3c2f 7370 616e 3e3c  ltaF_cov</span><
+00011650: 7370 616e 2063 6c61 7373 3d22 6f22 3e2e  span class="o">.
+00011660: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
+00011670: 7373 3d22 6e22 3e73 7172 743c 2f73 7061  ss="n">sqrt</spa
+00011680: 6e3e 3c73 7061 6e20 636c 6173 733d 2270  n><span class="p
+00011690: 223e 2829 3c2f 7370 616e 3e0a 2020 2020  ">()</span>.    
+000116a0: 2020 2020 3c73 7061 6e20 636c 6173 733d      <span class=
+000116b0: 226b 223e 656c 7365 3c2f 7370 616e 3e3c  "k">else</span><
+000116c0: 7370 616e 2063 6c61 7373 3d22 7022 3e3a  span class="p">:
+000116d0: 3c2f 7370 616e 3e0a 2020 2020 2020 2020  </span>.        
+000116e0: 2020 2020 3c73 7061 6e20 636c 6173 733d      <span class=
+000116f0: 226e 223e 465f 6c69 7374 3c2f 7370 616e  "n">F_list</span
+00011700: 3e20 3c73 7061 6e20 636c 6173 733d 226f  > <span class="o
+00011710: 223e 3d3c 2f73 7061 6e3e 203c 7370 616e  ">=</span> <span
+00011720: 2063 6c61 7373 3d22 7022 3e5b 5d3c 2f73   class="p">[]</s
+00011730: 7061 6e3e 0a20 2020 2020 2020 2020 2020  pan>.           
+00011740: 203c 7370 616e 2063 6c61 7373 3d22 6b22   <span class="k"
+00011750: 3e66 6f72 3c2f 7370 616e 3e20 3c73 7061  >for</span> <spa
+00011760: 6e20 636c 6173 733d 226e 223e 6b3c 2f73  n class="n">k</s
+00011770: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
+00011780: 3d22 6f77 223e 696e 3c2f 7370 616e 3e20  ="ow">in</span> 
+00011790: 3c73 7061 6e20 636c 6173 733d 226e 6222  <span class="nb"
+000117a0: 3e72 616e 6765 3c2f 7370 616e 3e3c 7370  >range</span><sp
+000117b0: 616e 2063 6c61 7373 3d22 7022 3e28 3c2f  an class="p">(</
+000117c0: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+000117d0: 3d22 6270 223e 7365 6c66 3c2f 7370 616e  ="bp">self</span
+000117e0: 3e3c 7370 616e 2063 6c61 7373 3d22 6f22  ><span class="o"
+000117f0: 3e2e 3c2f 7370 616e 3e3c 7370 616e 2063  >.</span><span c
+00011800: 6c61 7373 3d22 6e22 3e62 6f6f 7473 7472  lass="n">bootstr
+00011810: 6170 5f6e 756d 5f72 6570 3c2f 7370 616e  ap_num_rep</span
+00011820: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
+00011830: 3e29 3a3c 2f73 7061 6e3e 0a20 2020 2020  >):</span>.     
+00011840: 2020 2020 2020 2020 2020 203c 7370 616e             <span
+00011850: 2063 6c61 7373 3d22 6e22 3e64 753c 2f73   class="n">du</s
+00011860: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
+00011870: 3d22 6f22 3e3d 3c2f 7370 616e 3e20 3c73  ="o">=</span> <s
+00011880: 7061 6e20 636c 6173 733d 226e 223e 656e  pan class="n">en
+00011890: 6572 6779 5f70 6572 7475 7262 6564 3c2f  ergy_perturbed</
+000118a0: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+000118b0: 3d22 7022 3e5b 3a2c 3c2f 7370 616e 3e20  ="p">[:,</span> 
+000118c0: 3c73 7061 6e20 636c 6173 733d 2262 7022  <span class="bp"
+000118d0: 3e73 656c 663c 2f73 7061 6e3e 3c73 7061  >self</span><spa
+000118e0: 6e20 636c 6173 733d 226f 223e 2e3c 2f73  n class="o">.</s
+000118f0: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
+00011900: 226e 223e 5f63 6f6e 665f 6964 783c 2f73  "n">_conf_idx</s
+00011910: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
+00011920: 2270 223e 5b3c 2f73 7061 6e3e 3c73 7061  "p">[</span><spa
+00011930: 6e20 636c 6173 733d 226e 223e 6b3c 2f73  n class="n">k</s
+00011940: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
+00011950: 2270 223e 5d5d 3c2f 7370 616e 3e20 3c73  "p">]]</span> <s
+00011960: 7061 6e20 636c 6173 733d 226f 223e 2b3c  pan class="o">+<
+00011970: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
+00011980: 7373 3d22 6270 223e 7365 6c66 3c2f 7370  ss="bp">self</sp
+00011990: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+000119a0: 6f22 3e2e 3c2f 7370 616e 3e3c 7370 616e  o">.</span><span
+000119b0: 2063 6c61 7373 3d22 6e22 3e5f 6c6f 675f   class="n">_log_
+000119c0: 7072 6f62 5f6d 6978 3c2f 7370 616e 3e3c  prob_mix</span><
+000119d0: 7370 616e 2063 6c61 7373 3d22 7022 3e5b  span class="p">[
+000119e0: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
+000119f0: 7373 3d22 6e22 3e6b 3c2f 7370 616e 3e3c  ss="n">k</span><
+00011a00: 7370 616e 2063 6c61 7373 3d22 7022 3e5d  span class="p">]
+00011a10: 3c2f 7370 616e 3e0a 2020 2020 2020 2020  </span>.        
+00011a20: 2020 2020 2020 2020 3c73 7061 6e20 636c          <span cl
+00011a30: 6173 733d 226e 223e 463c 2f73 7061 6e3e  ass="n">F</span>
+00011a40: 203c 7370 616e 2063 6c61 7373 3d22 6f22   <span class="o"
+00011a50: 3e3d 3c2f 7370 616e 3e20 3c73 7061 6e20  >=</span> <span 
+00011a60: 636c 6173 733d 226f 223e 2d3c 2f73 7061  class="o">-</spa
+00011a70: 6e3e 3c73 7061 6e20 636c 6173 733d 226e  n><span class="n
+00011a80: 223e 746f 7263 683c 2f73 7061 6e3e 3c73  ">torch</span><s
+00011a90: 7061 6e20 636c 6173 733d 226f 223e 2e3c  pan class="o">.<
+00011aa0: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
+00011ab0: 733d 226e 223e 6c6f 6773 756d 6578 703c  s="n">logsumexp<
+00011ac0: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
+00011ad0: 733d 2270 223e 283c 2f73 7061 6e3e 3c73  s="p">(</span><s
+00011ae0: 7061 6e20 636c 6173 733d 226f 223e 2d3c  pan class="o">-<
+00011af0: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
+00011b00: 733d 226e 223e 6475 3c2f 7370 616e 3e3c  s="n">du</span><
+00011b10: 7370 616e 2063 6c61 7373 3d22 7022 3e2c  span class="p">,
+00011b20: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
+00011b30: 6173 733d 226e 223e 6469 6d3c 2f73 7061  ass="n">dim</spa
+00011b40: 6e3e 3c73 7061 6e20 636c 6173 733d 226f  n><span class="o
+00011b50: 223e 3d3c 2f73 7061 6e3e 3c73 7061 6e20  ">=</span><span 
+00011b60: 636c 6173 733d 226d 6922 3e31 3c2f 7370  class="mi">1</sp
+00011b70: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+00011b80: 7022 3e29 3c2f 7370 616e 3e0a 2020 2020  p">)</span>.    
+00011b90: 2020 2020 2020 2020 2020 2020 3c73 7061              <spa
+00011ba0: 6e20 636c 6173 733d 226e 223e 465f 6c69  n class="n">F_li
+00011bb0: 7374 3c2f 7370 616e 3e3c 7370 616e 2063  st</span><span c
+00011bc0: 6c61 7373 3d22 6f22 3e2e 3c2f 7370 616e  lass="o">.</span
+00011bd0: 3e3c 7370 616e 2063 6c61 7373 3d22 6e22  ><span class="n"
+00011be0: 3e61 7070 656e 643c 2f73 7061 6e3e 3c73  >append</span><s
+00011bf0: 7061 6e20 636c 6173 733d 2270 223e 283c  pan class="p">(<
+00011c00: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
+00011c10: 733d 226e 223e 463c 2f73 7061 6e3e 3c73  s="n">F</span><s
+00011c20: 7061 6e20 636c 6173 733d 2270 223e 293c  pan class="p">)<
+00011c30: 2f73 7061 6e3e 0a20 2020 2020 2020 2020  /span>.         
+00011c40: 2020 203c 7370 616e 2063 6c61 7373 3d22     <span class="
+00011c50: 6e22 3e46 5f6c 6973 743c 2f73 7061 6e3e  n">F_list</span>
+00011c60: 203c 7370 616e 2063 6c61 7373 3d22 6f22   <span class="o"
+00011c70: 3e3d 3c2f 7370 616e 3e20 3c73 7061 6e20  >=</span> <span 
+00011c80: 636c 6173 733d 226e 223e 746f 7263 683c  class="n">torch<
+00011c90: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
+00011ca0: 733d 226f 223e 2e3c 2f73 7061 6e3e 3c73  s="o">.</span><s
+00011cb0: 7061 6e20 636c 6173 733d 226e 223e 7374  pan class="n">st
+00011cc0: 6163 6b3c 2f73 7061 6e3e 3c73 7061 6e20  ack</span><span 
+00011cd0: 636c 6173 733d 2270 223e 283c 2f73 7061  class="p">(</spa
+00011ce0: 6e3e 3c73 7061 6e20 636c 6173 733d 226e  n><span class="n
+00011cf0: 223e 465f 6c69 7374 3c2f 7370 616e 3e3c  ">F_list</span><
+00011d00: 7370 616e 2063 6c61 7373 3d22 7022 3e2c  span class="p">,
+00011d10: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
+00011d20: 6173 733d 226e 223e 6469 6d3c 2f73 7061  ass="n">dim</spa
+00011d30: 6e3e 3c73 7061 6e20 636c 6173 733d 226f  n><span class="o
+00011d40: 223e 3d3c 2f73 7061 6e3e 3c73 7061 6e20  ">=</span><span 
+00011d50: 636c 6173 733d 226d 6922 3e31 3c2f 7370  class="mi">1</sp
+00011d60: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+00011d70: 7022 3e29 3c2f 7370 616e 3e0a 2020 2020  p">)</span>.    
+00011d80: 2020 2020 2020 2020 3c73 7061 6e20 636c          <span cl
+00011d90: 6173 733d 226e 223e 463c 2f73 7061 6e3e  ass="n">F</span>
+00011da0: 203c 7370 616e 2063 6c61 7373 3d22 6f22   <span class="o"
+00011db0: 3e3d 3c2f 7370 616e 3e20 3c73 7061 6e20  >=</span> <span 
+00011dc0: 636c 6173 733d 226e 223e 746f 7263 683c  class="n">torch<
+00011dd0: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
+00011de0: 733d 226f 223e 2e3c 2f73 7061 6e3e 3c73  s="o">.</span><s
+00011df0: 7061 6e20 636c 6173 733d 226e 223e 6d65  pan class="n">me
+00011e00: 616e 3c2f 7370 616e 3e3c 7370 616e 2063  an</span><span c
+00011e10: 6c61 7373 3d22 7022 3e28 3c2f 7370 616e  lass="p">(</span
+00011e20: 3e3c 7370 616e 2063 6c61 7373 3d22 6e22  ><span class="n"
+00011e30: 3e46 5f6c 6973 743c 2f73 7061 6e3e 3c73  >F_list</span><s
+00011e40: 7061 6e20 636c 6173 733d 2270 223e 2c3c  pan class="p">,<
+00011e50: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
+00011e60: 7373 3d22 6e22 3e64 696d 3c2f 7370 616e  ss="n">dim</span
+00011e70: 3e3c 7370 616e 2063 6c61 7373 3d22 6f22  ><span class="o"
+00011e80: 3e3d 3c2f 7370 616e 3e3c 7370 616e 2063  >=</span><span c
+00011e90: 6c61 7373 3d22 6d69 223e 313c 2f73 7061  lass="mi">1</spa
+00011ea0: 6e3e 3c73 7061 6e20 636c 6173 733d 2270  n><span class="p
+00011eb0: 223e 293c 2f73 7061 6e3e 0a20 2020 2020  ">)</span>.     
+00011ec0: 2020 2020 2020 203c 7370 616e 2063 6c61         <span cla
+00011ed0: 7373 3d22 6e22 3e46 5f73 7464 3c2f 7370  ss="n">F_std</sp
+00011ee0: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
+00011ef0: 226f 223e 3d3c 2f73 7061 6e3e 203c 7370  "o">=</span> <sp
+00011f00: 616e 2063 6c61 7373 3d22 6e22 3e74 6f72  an class="n">tor
+00011f10: 6368 3c2f 7370 616e 3e3c 7370 616e 2063  ch</span><span c
+00011f20: 6c61 7373 3d22 6f22 3e2e 3c2f 7370 616e  lass="o">.</span
+00011f30: 3e3c 7370 616e 2063 6c61 7373 3d22 6e22  ><span class="n"
+00011f40: 3e73 7464 3c2f 7370 616e 3e3c 7370 616e  >std</span><span
+00011f50: 2063 6c61 7373 3d22 7022 3e28 3c2f 7370   class="p">(</sp
+00011f60: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+00011f70: 6e22 3e46 5f6c 6973 743c 2f73 7061 6e3e  n">F_list</span>
+00011f80: 3c73 7061 6e20 636c 6173 733d 2270 223e  <span class="p">
+00011f90: 2c3c 2f73 7061 6e3e 203c 7370 616e 2063  ,</span> <span c
+00011fa0: 6c61 7373 3d22 6e22 3e64 696d 3c2f 7370  lass="n">dim</sp
+00011fb0: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+00011fc0: 6f22 3e3d 3c2f 7370 616e 3e3c 7370 616e  o">=</span><span
+00011fd0: 2063 6c61 7373 3d22 6d69 223e 313c 2f73   class="mi">1</s
+00011fe0: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
+00011ff0: 2270 223e 293c 2f73 7061 6e3e 0a20 2020  "p">)</span>.   
+00012000: 2020 2020 2020 2020 203c 7370 616e 2063           <span c
+00012010: 6c61 7373 3d22 6e22 3e46 5f63 6f76 3c2f  lass="n">F_cov</
+00012020: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
+00012030: 733d 226f 223e 3d3c 2f73 7061 6e3e 203c  s="o">=</span> <
+00012040: 7370 616e 2063 6c61 7373 3d22 6e22 3e74  span class="n">t
+00012050: 6f72 6368 3c2f 7370 616e 3e3c 7370 616e  orch</span><span
+00012060: 2063 6c61 7373 3d22 6f22 3e2e 3c2f 7370   class="o">.</sp
+00012070: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+00012080: 6e22 3e63 6f76 3c2f 7370 616e 3e3c 7370  n">cov</span><sp
+00012090: 616e 2063 6c61 7373 3d22 7022 3e28 3c2f  an class="p">(</
+000120a0: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+000120b0: 3d22 6e22 3e46 5f6c 6973 743c 2f73 7061  ="n">F_list</spa
+000120c0: 6e3e 3c73 7061 6e20 636c 6173 733d 2270  n><span class="p
+000120d0: 223e 293c 2f73 7061 6e3e 0a0a 2020 2020  ">)</span>..    
+000120e0: 2020 2020 2020 2020 3c73 7061 6e20 636c          <span cl
+000120f0: 6173 733d 226e 223e 4465 6c74 6146 3c2f  ass="n">DeltaF</
+00012100: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
+00012110: 733d 226f 223e 3d3c 2f73 7061 6e3e 203c  s="o">=</span> <
+00012120: 7370 616e 2063 6c61 7373 3d22 6e22 3e46  span class="n">F
+00012130: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
+00012140: 7373 3d22 7022 3e5b 3c2f 7370 616e 3e3c  ss="p">[</span><
+00012150: 7370 616e 2063 6c61 7373 3d22 6b63 223e  span class="kc">
+00012160: 4e6f 6e65 3c2f 7370 616e 3e3c 7370 616e  None</span><span
+00012170: 2063 6c61 7373 3d22 7022 3e2c 3c2f 7370   class="p">,</sp
+00012180: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
+00012190: 2270 223e 3a5d 3c2f 7370 616e 3e20 3c73  "p">:]</span> <s
+000121a0: 7061 6e20 636c 6173 733d 226f 223e 2d3c  pan class="o">-<
+000121b0: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
+000121c0: 7373 3d22 6e22 3e46 3c2f 7370 616e 3e3c  ss="n">F</span><
+000121d0: 7370 616e 2063 6c61 7373 3d22 7022 3e5b  span class="p">[
+000121e0: 3a2c 3c2f 7370 616e 3e20 3c73 7061 6e20  :,</span> <span 
+000121f0: 636c 6173 733d 226b 6322 3e4e 6f6e 653c  class="kc">None<
+00012200: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
+00012210: 733d 2270 223e 5d3c 2f73 7061 6e3e 0a20  s="p">]</span>. 
+00012220: 2020 2020 2020 2020 2020 203c 7370 616e             <span
+00012230: 2063 6c61 7373 3d22 6e22 3e44 656c 7461   class="n">Delta
+00012240: 465f 7374 643c 2f73 7061 6e3e 203c 7370  F_std</span> <sp
+00012250: 616e 2063 6c61 7373 3d22 6f22 3e3d 3c2f  an class="o">=</
+00012260: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
+00012270: 733d 226e 223e 746f 7263 683c 2f73 7061  s="n">torch</spa
+00012280: 6e3e 3c73 7061 6e20 636c 6173 733d 226f  n><span class="o
+00012290: 223e 2e3c 2f73 7061 6e3e 3c73 7061 6e20  ">.</span><span 
+000122a0: 636c 6173 733d 226e 223e 7374 643c 2f73  class="n">std</s
+000122b0: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
+000122c0: 2270 223e 283c 2f73 7061 6e3e 3c73 7061  "p">(</span><spa
+000122d0: 6e20 636c 6173 733d 226e 223e 465f 6c69  n class="n">F_li
+000122e0: 7374 3c2f 7370 616e 3e3c 7370 616e 2063  st</span><span c
+000122f0: 6c61 7373 3d22 7022 3e5b 3a2c 3c2f 7370  lass="p">[:,</sp
+00012300: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
+00012310: 2270 223e 3a2c 3c2f 7370 616e 3e20 3c73  "p">:,</span> <s
+00012320: 7061 6e20 636c 6173 733d 226b 6322 3e4e  pan class="kc">N
+00012330: 6f6e 653c 2f73 7061 6e3e 3c73 7061 6e20  one</span><span 
+00012340: 636c 6173 733d 2270 223e 5d3c 2f73 7061  class="p">]</spa
+00012350: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
+00012360: 6f22 3e2d 3c2f 7370 616e 3e20 3c73 7061  o">-</span> <spa
+00012370: 6e20 636c 6173 733d 226e 223e 465f 6c69  n class="n">F_li
+00012380: 7374 3c2f 7370 616e 3e3c 7370 616e 2063  st</span><span c
+00012390: 6c61 7373 3d22 7022 3e5b 3a2c 3c2f 7370  lass="p">[:,</sp
+000123a0: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
+000123b0: 226b 6322 3e4e 6f6e 653c 2f73 7061 6e3e  "kc">None</span>
+000123c0: 3c73 7061 6e20 636c 6173 733d 2270 223e  <span class="p">
+000123d0: 2c3c 2f73 7061 6e3e 203c 7370 616e 2063  ,</span> <span c
+000123e0: 6c61 7373 3d22 7022 3e3a 5d2c 3c2f 7370  lass="p">:],</sp
+000123f0: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
+00012400: 226e 223e 6469 6d3c 2f73 7061 6e3e 3c73  "n">dim</span><s
+00012410: 7061 6e20 636c 6173 733d 226f 223e 3d3c  pan class="o">=<
+00012420: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
+00012430: 733d 226d 6922 3e31 3c2f 7370 616e 3e3c  s="mi">1</span><
+00012440: 7370 616e 2063 6c61 7373 3d22 7022 3e29  span class="p">)
+00012450: 3c2f 7370 616e 3e0a 0a20 2020 2020 2020  </span>..       
+00012460: 203c 7370 616e 2063 6c61 7373 3d22 6e22   <span class="n"
+00012470: 3e72 6573 756c 7473 3c2f 7370 616e 3e20  >results</span> 
+00012480: 3c73 7061 6e20 636c 6173 733d 226f 223e  <span class="o">
+00012490: 3d3c 2f73 7061 6e3e 203c 7370 616e 2063  =</span> <span c
+000124a0: 6c61 7373 3d22 7022 3e7b 3c2f 7370 616e  lass="p">{</span
+000124b0: 3e0a 2020 2020 2020 2020 2020 2020 3c73  >.            <s
+000124c0: 7061 6e20 636c 6173 733d 2273 3222 3e26  pan class="s2">&
+000124d0: 7175 6f74 3b46 2671 756f 743b 3c2f 7370  quot;F&quot;</sp
+000124e0: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+000124f0: 7022 3e3a 3c2f 7370 616e 3e20 3c73 7061  p">:</span> <spa
+00012500: 6e20 636c 6173 733d 226e 223e 463c 2f73  n class="n">F</s
+00012510: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
+00012520: 226f 223e 2e3c 2f73 7061 6e3e 3c73 7061  "o">.</span><spa
+00012530: 6e20 636c 6173 733d 226e 223e 6e75 6d70  n class="n">nump
+00012540: 793c 2f73 7061 6e3e 3c73 7061 6e20 636c  y</span><span cl
+00012550: 6173 733d 2270 223e 2829 2c3c 2f73 7061  ass="p">(),</spa
+00012560: 6e3e 0a20 2020 2020 2020 2020 2020 203c  n>.            <
+00012570: 7370 616e 2063 6c61 7373 3d22 7332 223e  span class="s2">
+00012580: 2671 756f 743b 465f 7374 6426 7175 6f74  &quot;F_std&quot
+00012590: 3b3c 2f73 7061 6e3e 3c73 7061 6e20 636c  ;</span><span cl
+000125a0: 6173 733d 2270 223e 3a3c 2f73 7061 6e3e  ass="p">:</span>
+000125b0: 203c 7370 616e 2063 6c61 7373 3d22 6e22   <span class="n"
+000125c0: 3e46 5f73 7464 3c2f 7370 616e 3e3c 7370  >F_std</span><sp
+000125d0: 616e 2063 6c61 7373 3d22 6f22 3e2e 3c2f  an class="o">.</
+000125e0: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+000125f0: 3d22 6e22 3e6e 756d 7079 3c2f 7370 616e  ="n">numpy</span
+00012600: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
+00012610: 3e28 292c 3c2f 7370 616e 3e0a 2020 2020  >(),</span>.    
+00012620: 2020 2020 2020 2020 3c73 7061 6e20 636c          <span cl
+00012630: 6173 733d 2273 3222 3e26 7175 6f74 3b46  ass="s2">&quot;F
+00012640: 5f63 6f76 2671 756f 743b 3c2f 7370 616e  _cov&quot;</span
+00012650: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
+00012660: 3e3a 3c2f 7370 616e 3e20 3c73 7061 6e20  >:</span> <span 
+00012670: 636c 6173 733d 226e 223e 465f 636f 763c  class="n">F_cov<
+00012680: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
+00012690: 733d 226f 223e 2e3c 2f73 7061 6e3e 3c73  s="o">.</span><s
+000126a0: 7061 6e20 636c 6173 733d 226e 223e 6e75  pan class="n">nu
+000126b0: 6d70 793c 2f73 7061 6e3e 3c73 7061 6e20  mpy</span><span 
+000126c0: 636c 6173 733d 2270 223e 2829 2c3c 2f73  class="p">(),</s
+000126d0: 7061 6e3e 0a20 2020 2020 2020 2020 2020  pan>.           
+000126e0: 203c 7370 616e 2063 6c61 7373 3d22 7332   <span class="s2
+000126f0: 223e 2671 756f 743b 4465 6c74 6146 2671  ">&quot;DeltaF&q
+00012700: 756f 743b 3c2f 7370 616e 3e3c 7370 616e  uot;</span><span
+00012710: 2063 6c61 7373 3d22 7022 3e3a 3c2f 7370   class="p">:</sp
+00012720: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
+00012730: 226e 223e 4465 6c74 6146 3c2f 7370 616e  "n">DeltaF</span
+00012740: 3e3c 7370 616e 2063 6c61 7373 3d22 6f22  ><span class="o"
+00012750: 3e2e 3c2f 7370 616e 3e3c 7370 616e 2063  >.</span><span c
+00012760: 6c61 7373 3d22 6e22 3e6e 756d 7079 3c2f  lass="n">numpy</
+00012770: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+00012780: 3d22 7022 3e28 292c 3c2f 7370 616e 3e0a  ="p">(),</span>.
+00012790: 2020 2020 2020 2020 2020 2020 3c73 7061              <spa
+000127a0: 6e20 636c 6173 733d 2273 3222 3e26 7175  n class="s2">&qu
+000127b0: 6f74 3b44 656c 7461 465f 7374 6426 7175  ot;DeltaF_std&qu
+000127c0: 6f74 3b3c 2f73 7061 6e3e 3c73 7061 6e20  ot;</span><span 
+000127d0: 636c 6173 733d 2270 223e 3a3c 2f73 7061  class="p">:</spa
+000127e0: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
+000127f0: 6e22 3e44 656c 7461 465f 7374 643c 2f73  n">DeltaF_std</s
+00012800: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
+00012810: 226f 223e 2e3c 2f73 7061 6e3e 3c73 7061  "o">.</span><spa
+00012820: 6e20 636c 6173 733d 226e 223e 6e75 6d70  n class="n">nump
+00012830: 793c 2f73 7061 6e3e 3c73 7061 6e20 636c  y</span><span cl
+00012840: 6173 733d 2270 223e 2829 2c3c 2f73 7061  ass="p">(),</spa
+00012850: 6e3e 0a20 2020 2020 2020 203c 7370 616e  n>.        <span
+00012860: 2063 6c61 7373 3d22 7022 3e7d 3c2f 7370   class="p">}</sp
+00012870: 616e 3e0a 0a20 2020 2020 2020 203c 7370  an>..        <sp
+00012880: 616e 2063 6c61 7373 3d22 6b22 3e72 6574  an class="k">ret
+00012890: 7572 6e3c 2f73 7061 6e3e 203c 7370 616e  urn</span> <span
+000128a0: 2063 6c61 7373 3d22 6e22 3e72 6573 756c   class="n">resul
+000128b0: 7473 3c2f 7370 616e 3e3c 2f64 6976 3e3c  ts</span></div><
+000128c0: 2f64 6976 3e0a 0a3c 7370 616e 2063 6c61  /div>..<span cla
+000128d0: 7373 3d22 6b22 3e64 6566 3c2f 7370 616e  ss="k">def</span
+000128e0: 3e20 3c73 7061 6e20 636c 6173 733d 226e  > <span class="n
+000128f0: 6622 3e5f 636f 6d70 7574 655f 6c6f 6770  f">_compute_logp
+00012900: 5f6f 665f 463c 2f73 7061 6e3e 3c73 7061  _of_F</span><spa
+00012910: 6e20 636c 6173 733d 2270 223e 283c 2f73  n class="p">(</s
+00012920: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
+00012930: 226e 223e 463c 2f73 7061 6e3e 3c73 7061  "n">F</span><spa
+00012940: 6e20 636c 6173 733d 2270 223e 2c3c 2f73  n class="p">,</s
+00012950: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
+00012960: 3d22 6e22 3e65 6e65 7267 793c 2f73 7061  ="n">energy</spa
+00012970: 6e3e 3c73 7061 6e20 636c 6173 733d 2270  n><span class="p
+00012980: 223e 2c3c 2f73 7061 6e3e 203c 7370 616e  ">,</span> <span
+00012990: 2063 6c61 7373 3d22 6e22 3e6e 756d 5f63   class="n">num_c
+000129a0: 6f6e 663c 2f73 7061 6e3e 3c73 7061 6e20  onf</span><span 
+000129b0: 636c 6173 733d 2270 223e 293a 3c2f 7370  class="p">):</sp
+000129c0: 616e 3e0a 2020 2020 3c73 7061 6e20 636c  an>.    <span cl
+000129d0: 6173 733d 226e 223e 6c6f 6770 3c2f 7370  ass="n">logp</sp
+000129e0: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
+000129f0: 226f 223e 3d3c 2f73 7061 6e3e 203c 7370  "o">=</span> <sp
+00012a00: 616e 2063 6c61 7373 3d22 7022 3e28 3c2f  an class="p">(</
+00012a10: 7370 616e 3e0a 2020 2020 2020 2020 3c73  span>.        <s
+00012a20: 7061 6e20 636c 6173 733d 226e 223e 746f  pan class="n">to
+00012a30: 7263 683c 2f73 7061 6e3e 3c73 7061 6e20  rch</span><span 
+00012a40: 636c 6173 733d 226f 223e 2e3c 2f73 7061  class="o">.</spa
+00012a50: 6e3e 3c73 7061 6e20 636c 6173 733d 226e  n><span class="n
+00012a60: 223e 7375 6d3c 2f73 7061 6e3e 3c73 7061  ">sum</span><spa
+00012a70: 6e20 636c 6173 733d 2270 223e 283c 2f73  n class="p">(</s
+00012a80: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
+00012a90: 226e 223e 6e75 6d5f 636f 6e66 3c2f 7370  "n">num_conf</sp
+00012aa0: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
+00012ab0: 226f 223e 2a3c 2f73 7061 6e3e 203c 7370  "o">*</span> <sp
+00012ac0: 616e 2063 6c61 7373 3d22 6e22 3e46 3c2f  an class="n">F</
+00012ad0: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+00012ae0: 3d22 7022 3e29 3c2f 7370 616e 3e0a 2020  ="p">)</span>.  
+00012af0: 2020 2020 2020 3c73 7061 6e20 636c 6173        <span clas
+00012b00: 733d 226f 223e 2d3c 2f73 7061 6e3e 203c  s="o">-</span> <
+00012b10: 7370 616e 2063 6c61 7373 3d22 6e22 3e74  span class="n">t
+00012b20: 6f72 6368 3c2f 7370 616e 3e3c 7370 616e  orch</span><span
+00012b30: 2063 6c61 7373 3d22 6f22 3e2e 3c2f 7370   class="o">.</sp
+00012b40: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+00012b50: 6e22 3e6c 6f67 7375 6d65 7870 3c2f 7370  n">logsumexp</sp
+00012b60: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+00012b70: 7022 3e28 3c2f 7370 616e 3e3c 7370 616e  p">(</span><span
+00012b80: 2063 6c61 7373 3d22 6f22 3e2d 3c2f 7370   class="o">-</sp
+00012b90: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+00012ba0: 7022 3e28 3c2f 7370 616e 3e3c 7370 616e  p">(</span><span
+00012bb0: 2063 6c61 7373 3d22 6e22 3e65 6e65 7267   class="n">energ
+00012bc0: 793c 2f73 7061 6e3e 3c73 7061 6e20 636c  y</span><span cl
+00012bd0: 6173 733d 226f 223e 2e3c 2f73 7061 6e3e  ass="o">.</span>
+00012be0: 3c73 7061 6e20 636c 6173 733d 226e 223e  <span class="n">
+00012bf0: 543c 2f73 7061 6e3e 203c 7370 616e 2063  T</span> <span c
+00012c00: 6c61 7373 3d22 6f22 3e2d 3c2f 7370 616e  lass="o">-</span
+00012c10: 3e20 3c73 7061 6e20 636c 6173 733d 226e  > <span class="n
+00012c20: 223e 746f 7263 683c 2f73 7061 6e3e 3c73  ">torch</span><s
+00012c30: 7061 6e20 636c 6173 733d 226f 223e 2e3c  pan class="o">.<
+00012c40: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
+00012c50: 733d 226e 223e 6c6f 673c 2f73 7061 6e3e  s="n">log</span>
+00012c60: 3c73 7061 6e20 636c 6173 733d 2270 223e  <span class="p">
+00012c70: 283c 2f73 7061 6e3e 3c73 7061 6e20 636c  (</span><span cl
+00012c80: 6173 733d 226e 223e 6e75 6d5f 636f 6e66  ass="n">num_conf
+00012c90: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
+00012ca0: 7373 3d22 7022 3e29 3c2f 7370 616e 3e20  ss="p">)</span> 
+00012cb0: 3c73 7061 6e20 636c 6173 733d 226f 223e  <span class="o">
+00012cc0: 2d3c 2f73 7061 6e3e 203c 7370 616e 2063  -</span> <span c
+00012cd0: 6c61 7373 3d22 6e22 3e46 3c2f 7370 616e  lass="n">F</span
+00012ce0: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
+00012cf0: 3e29 2c3c 2f73 7061 6e3e 203c 7370 616e  >),</span> <span
+00012d00: 2063 6c61 7373 3d22 6e22 3e64 696d 3c2f   class="n">dim</
+00012d10: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+00012d20: 3d22 6f22 3e3d 3c2f 7370 616e 3e3c 7370  ="o">=</span><sp
+00012d30: 616e 2063 6c61 7373 3d22 6d69 223e 313c  an class="mi">1<
+00012d40: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
+00012d50: 733d 2270 223e 293c 2f73 7061 6e3e 3c73  s="p">)</span><s
+00012d60: 7061 6e20 636c 6173 733d 226f 223e 2e3c  pan class="o">.<
+00012d70: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
+00012d80: 733d 226e 223e 7375 6d3c 2f73 7061 6e3e  s="n">sum</span>
+00012d90: 3c73 7061 6e20 636c 6173 733d 2270 223e  <span class="p">
+00012da0: 2829 3c2f 7370 616e 3e0a 2020 2020 3c73  ()</span>.    <s
+00012db0: 7061 6e20 636c 6173 733d 2270 223e 293c  pan class="p">)<
+00012dc0: 2f73 7061 6e3e 0a20 2020 203c 7370 616e  /span>.    <span
+00012dd0: 2063 6c61 7373 3d22 6b22 3e72 6574 7572   class="k">retur
+00012de0: 6e3c 2f73 7061 6e3e 203c 7370 616e 2063  n</span> <span c
+00012df0: 6c61 7373 3d22 6e22 3e6c 6f67 703c 2f73  lass="n">logp</s
+00012e00: 7061 6e3e 0a0a 0a3c 7370 616e 2063 6c61  pan>...<span cla
+00012e10: 7373 3d22 6b22 3e64 6566 3c2f 7370 616e  ss="k">def</span
+00012e20: 3e20 3c73 7061 6e20 636c 6173 733d 226e  > <span class="n
+00012e30: 6622 3e5f 636f 6d70 7574 655f 6c6f 7373  f">_compute_loss
+00012e40: 5f61 6e64 5f67 7261 645f 6f66 5f64 463c  _and_grad_of_dF<
+00012e50: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
+00012e60: 733d 2270 223e 283c 2f73 7061 6e3e 3c73  s="p">(</span><s
+00012e70: 7061 6e20 636c 6173 733d 226e 223e 6446  pan class="n">dF
+00012e80: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
+00012e90: 7373 3d22 7022 3e2c 3c2f 7370 616e 3e20  ss="p">,</span> 
+00012ea0: 3c73 7061 6e20 636c 6173 733d 226e 223e  <span class="n">
+00012eb0: 656e 6572 6779 3c2f 7370 616e 3e3c 7370  energy</span><sp
+00012ec0: 616e 2063 6c61 7373 3d22 7022 3e2c 3c2f  an class="p">,</
+00012ed0: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
+00012ee0: 733d 226e 223e 6e75 6d5f 636f 6e66 3c2f  s="n">num_conf</
+00012ef0: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+00012f00: 3d22 7022 3e29 3a3c 2f73 7061 6e3e 0a3c  ="p">):</span>.<
+00012f10: 7370 616e 2063 6c61 7373 3d22 7722 3e20  span class="w"> 
+00012f20: 2020 203c 2f73 7061 6e3e 3c73 7061 6e20     </span><span 
+00012f30: 636c 6173 733d 2273 6422 3e26 7175 6f74  class="sd">&quot
+00012f40: 3b26 7175 6f74 3b26 7175 6f74 3b43 6f6d  ;&quot;&quot;Com
+00012f50: 7075 7465 2074 6865 206c 6f73 7320 6675  pute the loss fu
+00012f60: 6e63 7469 6f6e 2061 6e64 2074 6865 2067  nction and the g
+00012f70: 7261 6469 656e 7420 6f66 2064 4620 6769  radient of dF gi
+00012f80: 7665 6e20 656e 6572 6779 2061 6e64 206e  ven energy and n
+00012f90: 756d 5f63 6f6e 662e 3c2f 7370 616e 3e0a  um_conf.</span>.
+00012fa0: 3c73 7061 6e20 636c 6173 733d 2273 6422  <span class="sd"
+00012fb0: 3e20 2020 2050 6172 616d 6574 6572 733c  >    Parameters<
+00012fc0: 2f73 7061 6e3e 0a3c 7370 616e 2063 6c61  /span>.<span cla
+00012fd0: 7373 3d22 7364 223e 2020 2020 2d2d 2d2d  ss="sd">    ----
+00012fe0: 2d2d 2d2d 2d2d 3c2f 7370 616e 3e0a 3c73  ------</span>.<s
+00012ff0: 7061 6e20 636c 6173 733d 2273 6422 3e20  pan class="sd"> 
+00013000: 2020 2064 463a 2031 2d44 2066 6c6f 6174     dF: 1-D float
+00013010: 2074 656e 736f 7220 7769 7468 2073 697a   tensor with siz
+00013020: 6520 284d 2d31 293c 2f73 7061 6e3e 0a3c  e (M-1)</span>.<
+00013030: 7370 616e 2063 6c61 7373 3d22 7364 223e  span class="sd">
+00013040: 2020 2020 2020 2020 5468 6520 6672 6565          The free
+00013050: 2065 6e65 7267 7920 6469 6666 6572 656e   energy differen
+00013060: 6365 2062 6574 7765 656e 2073 7461 7465  ce between state
+00013070: 2030 2061 6e64 206f 7468 6572 2073 7461   0 and other sta
+00013080: 7465 732e 2054 6865 2065 6e74 7279 3c2f  tes. The entry</
+00013090: 7370 616e 3e0a 3c73 7061 6e20 636c 6173  span>.<span clas
+000130a0: 733d 2273 6422 3e20 2020 2020 2020 2064  s="sd">        d
+000130b0: 465b 695d 2069 7320 7468 6520 6672 6565  F[i] is the free
+000130c0: 2065 6e65 7267 7920 6469 6666 6572 656e   energy differen
+000130d0: 6365 2062 6574 7765 656e 2073 7461 7465  ce between state
+000130e0: 2030 2061 6e64 2073 7461 7465 2069 2b31   0 and state i+1
+000130f0: 2e3c 2f73 7061 6e3e 0a3c 7370 616e 2063  .</span>.<span c
+00013100: 6c61 7373 3d22 7364 223e 2020 2020 656e  lass="sd">    en
+00013110: 6572 6779 3a20 322d 4420 666c 6f61 7420  ergy: 2-D float 
+00013120: 7465 6e73 6f72 2077 6974 6820 7369 7a65  tensor with size
+00013130: 2028 4d20 7820 4e29 3c2f 7370 616e 3e0a   (M x N)</span>.
+00013140: 3c73 7061 6e20 636c 6173 733d 2273 6422  <span class="sd"
+00013150: 3e20 2020 2020 2020 2041 2032 2d44 2074  >        A 2-D t
+00013160: 656e 736f 7220 7769 7468 2073 697a 6520  ensor with size 
+00013170: 6f66 204d 2078 204e 2c20 7768 6572 6520  of M x N, where 
+00013180: 4d20 6973 2074 6865 206e 756d 6265 7220  M is the number 
+00013190: 6f66 2073 7461 7473 3c2f 7370 616e 3e0a  of stats</span>.
+000131a0: 3c73 7061 6e20 636c 6173 733d 2273 6422  <span class="sd"
+000131b0: 3e20 2020 2020 2020 2061 6e64 204e 2069  >        and N i
+000131c0: 7320 7468 6520 746f 7461 6c20 6e75 6d62  s the total numb
+000131d0: 6572 206f 6620 636f 6e66 6f72 6d61 7469  er of conformati
+000131e0: 6f6e 732e 2054 6865 2065 6e74 7279 2065  ons. The entry e
+000131f0: 6e65 7267 795b 692c 6a5d 3c2f 7370 616e  nergy[i,j]</span
+00013200: 3e0a 3c73 7061 6e20 636c 6173 733d 2273  >.<span class="s
+00013210: 6422 3e20 2020 206e 756d 5f63 6f6e 663a  d">    num_conf:
+00013220: 2031 2d44 2069 6e74 2074 656e 736f 7220   1-D int tensor 
+00013230: 7769 7468 2073 697a 6520 284d 293c 2f73  with size (M)</s
+00013240: 7061 6e3e 0a3c 7370 616e 2063 6c61 7373  pan>.<span class
+00013250: 3d22 7364 223e 2020 2020 2020 2020 4120  ="sd">        A 
+00013260: 312d 4420 7465 6e73 6f72 2077 6974 6820  1-D tensor with 
+00013270: 7369 7a65 206f 6620 4d2c 2077 6865 7265  size of M, where
+00013280: 206e 756d 5f63 6f6e 665b 695d 2069 7320   num_conf[i] is 
+00013290: 7468 6520 6e75 6d20 6f66 3c2f 7370 616e  the num of</span
+000132a0: 3e0a 3c73 7061 6e20 636c 6173 733d 2273  >.<span class="s
+000132b0: 6422 3e20 2020 2020 2020 2063 6f6e 666f  d">        confo
+000132c0: 726d 6174 696f 6e73 2073 616d 706c 6564  rmations sampled
+000132d0: 2066 726f 6d20 7374 6174 6520 692e 2054   from state i. T
+000132e0: 6865 7265 666f 7265 2c20 746f 7263 682e  herefore, torch.
+000132f0: 7375 6d28 6e75 6d5f 636f 6e66 293c 2f73  sum(num_conf)</s
+00013300: 7061 6e3e 0a3c 7370 616e 2063 6c61 7373  pan>.<span class
+00013310: 3d22 7364 223e 2020 2020 2020 2020 6861  ="sd">        ha
+00013320: 7320 746f 2062 6520 6571 7561 6c20 746f  s to be equal to
+00013330: 204e 2e20 416c 6c20 656e 7472 6965 7320   N. All entries 
+00013340: 696e 206e 756d 5f63 6f6e 6620 6861 7665  in num_conf have
+00013350: 2074 6f20 6265 2073 7472 6963 746c 793c   to be strictly<
+00013360: 2f73 7061 6e3e 0a3c 7370 616e 2063 6c61  /span>.<span cla
+00013370: 7373 3d22 7364 223e 2020 2020 2020 2020  ss="sd">        
+00013380: 6772 6561 7465 7220 7468 616e 2030 2e3c  greater than 0.<
+00013390: 2f73 7061 6e3e 0a3c 7370 616e 2063 6c61  /span>.<span cla
+000133a0: 7373 3d22 7364 223e 2020 2020 2671 756f  ss="sd">    &quo
+000133b0: 743b 2671 756f 743b 2671 756f 743b 3c2f  t;&quot;&quot;</
+000133c0: 7370 616e 3e0a 0a20 2020 203c 7370 616e  span>..    <span
+000133d0: 2063 6c61 7373 3d22 6331 223e 2320 636f   class="c1"># co
+000133e0: 6d70 7574 6520 7468 6520 6c6f 7373 2066  mpute the loss f
+000133f0: 756e 6374 696f 6e3c 2f73 7061 6e3e 0a20  unction</span>. 
+00013400: 2020 203c 7370 616e 2063 6c61 7373 3d22     <span class="
+00013410: 6e22 3e46 3c2f 7370 616e 3e20 3c73 7061  n">F</span> <spa
+00013420: 6e20 636c 6173 733d 226f 223e 3d3c 2f73  n class="o">=</s
+00013430: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
+00013440: 3d22 6e22 3e74 6f72 6368 3c2f 7370 616e  ="n">torch</span
+00013450: 3e3c 7370 616e 2063 6c61 7373 3d22 6f22  ><span class="o"
+00013460: 3e2e 3c2f 7370 616e 3e3c 7370 616e 2063  >.</span><span c
+00013470: 6c61 7373 3d22 6e22 3e63 6174 3c2f 7370  lass="n">cat</sp
 00013480: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-00013490: 7022 3e28 3c2f 7370 616e 3e3c 7370 616e  p">(</span><span
-000134a0: 2063 6c61 7373 3d22 6d69 223e 313c 2f73   class="mi">1</s
-000134b0: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
-000134c0: 2270 223e 292c 3c2f 7370 616e 3e20 3c73  "p">),</span> <s
-000134d0: 7061 6e20 636c 6173 733d 226e 223e 6446  pan class="n">dF
-000134e0: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-000134f0: 7373 3d22 7022 3e5d 293c 2f73 7061 6e3e  ss="p">])</span>
-00013500: 0a20 2020 203c 7370 616e 2063 6c61 7373  .    <span class
-00013510: 3d22 6e22 3e6c 6f67 703c 2f73 7061 6e3e  ="n">logp</span>
-00013520: 203c 7370 616e 2063 6c61 7373 3d22 6f22   <span class="o"
-00013530: 3e3d 3c2f 7370 616e 3e20 3c73 7061 6e20  >=</span> <span 
-00013540: 636c 6173 733d 226e 223e 5f63 6f6d 7075  class="n">_compu
-00013550: 7465 5f6c 6f67 705f 6f66 5f46 3c2f 7370  te_logp_of_F</sp
-00013560: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-00013570: 7022 3e28 3c2f 7370 616e 3e3c 7370 616e  p">(</span><span
-00013580: 2063 6c61 7373 3d22 6e22 3e46 3c2f 7370   class="n">F</sp
-00013590: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-000135a0: 7022 3e2c 3c2f 7370 616e 3e20 3c73 7061  p">,</span> <spa
-000135b0: 6e20 636c 6173 733d 226e 223e 656e 6572  n class="n">ener
-000135c0: 6779 3c2f 7370 616e 3e3c 7370 616e 2063  gy</span><span c
-000135d0: 6c61 7373 3d22 7022 3e2c 3c2f 7370 616e  lass="p">,</span
-000135e0: 3e20 3c73 7061 6e20 636c 6173 733d 226e  > <span class="n
-000135f0: 223e 6e75 6d5f 636f 6e66 3c2f 7370 616e  ">num_conf</span
-00013600: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
-00013610: 3e29 3c2f 7370 616e 3e0a 2020 2020 3c73  >)</span>.    <s
-00013620: 7061 6e20 636c 6173 733d 226e 223e 6c6f  pan class="n">lo
-00013630: 7373 3c2f 7370 616e 3e20 3c73 7061 6e20  ss</span> <span 
-00013640: 636c 6173 733d 226f 223e 3d3c 2f73 7061  class="o">=</spa
-00013650: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
-00013660: 6f22 3e2d 3c2f 7370 616e 3e3c 7370 616e  o">-</span><span
-00013670: 2063 6c61 7373 3d22 6e22 3e6c 6f67 703c   class="n">logp<
-00013680: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
-00013690: 7373 3d22 6f22 3e2f 3c2f 7370 616e 3e20  ss="o">/</span> 
-000136a0: 3c73 7061 6e20 636c 6173 733d 226e 223e  <span class="n">
-000136b0: 6e75 6d5f 636f 6e66 3c2f 7370 616e 3e3c  num_conf</span><
-000136c0: 7370 616e 2063 6c61 7373 3d22 6f22 3e2e  span class="o">.
-000136d0: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-000136e0: 7373 3d22 6e22 3e73 756d 3c2f 7370 616e  ss="n">sum</span
-000136f0: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
-00013700: 3e28 293c 2f73 7061 6e3e 0a20 2020 203c  >()</span>.    <
-00013710: 7370 616e 2063 6c61 7373 3d22 6e22 3e75  span class="n">u
-00013720: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
-00013730: 6173 733d 226f 223e 3d3c 2f73 7061 6e3e  ass="o">=</span>
-00013740: 203c 7370 616e 2063 6c61 7373 3d22 6e22   <span class="n"
-00013750: 3e65 6e65 7267 793c 2f73 7061 6e3e 203c  >energy</span> <
-00013760: 7370 616e 2063 6c61 7373 3d22 6f22 3e2d  span class="o">-
-00013770: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
-00013780: 6173 733d 226e 223e 463c 2f73 7061 6e3e  ass="n">F</span>
-00013790: 3c73 7061 6e20 636c 6173 733d 2270 223e  <span class="p">
-000137a0: 5b3a 2c3c 2f73 7061 6e3e 203c 7370 616e  [:,</span> <span
-000137b0: 2063 6c61 7373 3d22 6b63 223e 4e6f 6e65   class="kc">None
-000137c0: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-000137d0: 7373 3d22 7022 3e5d 3c2f 7370 616e 3e20  ss="p">]</span> 
-000137e0: 3c73 7061 6e20 636c 6173 733d 226f 223e  <span class="o">
-000137f0: 2d3c 2f73 7061 6e3e 203c 7370 616e 2063  -</span> <span c
-00013800: 6c61 7373 3d22 6e22 3e74 6f72 6368 3c2f  lass="n">torch</
-00013810: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
-00013820: 3d22 6f22 3e2e 3c2f 7370 616e 3e3c 7370  ="o">.</span><sp
-00013830: 616e 2063 6c61 7373 3d22 6e22 3e6c 6f67  an class="n">log
-00013840: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-00013850: 7373 3d22 7022 3e28 3c2f 7370 616e 3e3c  ss="p">(</span><
-00013860: 7370 616e 2063 6c61 7373 3d22 6e22 3e6e  span class="n">n
-00013870: 756d 5f63 6f6e 663c 2f73 7061 6e3e 3c73  um_conf</span><s
-00013880: 7061 6e20 636c 6173 733d 2270 223e 295b  pan class="p">)[
-00013890: 3a2c 3c2f 7370 616e 3e20 3c73 7061 6e20  :,</span> <span 
-000138a0: 636c 6173 733d 226b 6322 3e4e 6f6e 653c  class="kc">None<
-000138b0: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
-000138c0: 733d 2270 223e 5d3c 2f73 7061 6e3e 0a0a  s="p">]</span>..
-000138d0: 2020 2020 3c73 7061 6e20 636c 6173 733d      <span class=
-000138e0: 2263 3122 3e23 2063 6f6d 7075 7465 2074  "c1"># compute t
-000138f0: 6865 2067 7261 6469 656e 7420 6f66 2074  he gradient of t
-00013900: 6865 206c 6f73 7320 6675 6e63 7469 6f6e  he loss function
-00013910: 3c2f 7370 616e 3e0a 2020 2020 3c73 7061  </span>.    <spa
-00013920: 6e20 636c 6173 733d 226e 223e 703c 2f73  n class="n">p</s
-00013930: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
-00013940: 3d22 6f22 3e3d 3c2f 7370 616e 3e20 3c73  ="o">=</span> <s
-00013950: 7061 6e20 636c 6173 733d 226e 223e 746f  pan class="n">to
-00013960: 7263 683c 2f73 7061 6e3e 3c73 7061 6e20  rch</span><span 
-00013970: 636c 6173 733d 226f 223e 2e3c 2f73 7061  class="o">.</spa
-00013980: 6e3e 3c73 7061 6e20 636c 6173 733d 226e  n><span class="n
-00013990: 223e 736f 6674 6d61 783c 2f73 7061 6e3e  ">softmax</span>
-000139a0: 3c73 7061 6e20 636c 6173 733d 2270 223e  <span class="p">
-000139b0: 283c 2f73 7061 6e3e 3c73 7061 6e20 636c  (</span><span cl
-000139c0: 6173 733d 226f 223e 2d3c 2f73 7061 6e3e  ass="o">-</span>
-000139d0: 3c73 7061 6e20 636c 6173 733d 226e 223e  <span class="n">
-000139e0: 753c 2f73 7061 6e3e 3c73 7061 6e20 636c  u</span><span cl
-000139f0: 6173 733d 2270 223e 2c3c 2f73 7061 6e3e  ass="p">,</span>
-00013a00: 203c 7370 616e 2063 6c61 7373 3d22 6e22   <span class="n"
-00013a10: 3e64 696d 3c2f 7370 616e 3e3c 7370 616e  >dim</span><span
-00013a20: 2063 6c61 7373 3d22 6f22 3e3d 3c2f 7370   class="o">=</sp
-00013a30: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-00013a40: 6d69 223e 303c 2f73 7061 6e3e 3c73 7061  mi">0</span><spa
-00013a50: 6e20 636c 6173 733d 2270 223e 293c 2f73  n class="p">)</s
-00013a60: 7061 6e3e 0a20 2020 203c 7370 616e 2063  pan>.    <span c
-00013a70: 6c61 7373 3d22 6e22 3e67 7261 643c 2f73  lass="n">grad</s
-00013a80: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
-00013a90: 3d22 6f22 3e3d 3c2f 7370 616e 3e20 3c73  ="o">=</span> <s
-00013aa0: 7061 6e20 636c 6173 733d 226e 223e 746f  pan class="n">to
-00013ab0: 7263 683c 2f73 7061 6e3e 3c73 7061 6e20  rch</span><span 
-00013ac0: 636c 6173 733d 226f 223e 2e3c 2f73 7061  class="o">.</spa
-00013ad0: 6e3e 3c73 7061 6e20 636c 6173 733d 226e  n><span class="n
-00013ae0: 223e 6d65 616e 3c2f 7370 616e 3e3c 7370  ">mean</span><sp
-00013af0: 616e 2063 6c61 7373 3d22 7022 3e28 3c2f  an class="p">(</
-00013b00: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
-00013b10: 3d22 6e22 3e70 3c2f 7370 616e 3e3c 7370  ="n">p</span><sp
-00013b20: 616e 2063 6c61 7373 3d22 7022 3e2c 3c2f  an class="p">,</
-00013b30: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
-00013b40: 733d 226e 223e 6469 6d3c 2f73 7061 6e3e  s="n">dim</span>
-00013b50: 3c73 7061 6e20 636c 6173 733d 226f 223e  <span class="o">
-00013b60: 3d3c 2f73 7061 6e3e 3c73 7061 6e20 636c  =</span><span cl
-00013b70: 6173 733d 226d 6922 3e31 3c2f 7370 616e  ass="mi">1</span
-00013b80: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
-00013b90: 3e29 3c2f 7370 616e 3e20 3c73 7061 6e20  >)</span> <span 
-00013ba0: 636c 6173 733d 226f 223e 2d3c 2f73 7061  class="o">-</spa
-00013bb0: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
-00013bc0: 6e22 3e6e 756d 5f63 6f6e 663c 2f73 7061  n">num_conf</spa
-00013bd0: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
-00013be0: 6f22 3e2f 3c2f 7370 616e 3e20 3c73 7061  o">/</span> <spa
-00013bf0: 6e20 636c 6173 733d 226e 223e 6e75 6d5f  n class="n">num_
-00013c00: 636f 6e66 3c2f 7370 616e 3e3c 7370 616e  conf</span><span
-00013c10: 2063 6c61 7373 3d22 6f22 3e2e 3c2f 7370   class="o">.</sp
-00013c20: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-00013c30: 6e22 3e73 756d 3c2f 7370 616e 3e3c 7370  n">sum</span><sp
-00013c40: 616e 2063 6c61 7373 3d22 7022 3e28 293c  an class="p">()<
-00013c50: 2f73 7061 6e3e 0a20 2020 203c 7370 616e  /span>.    <span
-00013c60: 2063 6c61 7373 3d22 6e22 3e67 7261 643c   class="n">grad<
-00013c70: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
-00013c80: 7373 3d22 6f22 3e3d 3c2f 7370 616e 3e20  ss="o">=</span> 
-00013c90: 3c73 7061 6e20 636c 6173 733d 226e 223e  <span class="n">
-00013ca0: 6772 6164 3c2f 7370 616e 3e3c 7370 616e  grad</span><span
-00013cb0: 2063 6c61 7373 3d22 7022 3e5b 3c2f 7370   class="p">[</sp
-00013cc0: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-00013cd0: 6d69 223e 313c 2f73 7061 6e3e 3c73 7061  mi">1</span><spa
-00013ce0: 6e20 636c 6173 733d 2270 223e 3a5d 3c2f  n class="p">:]</
-00013cf0: 7370 616e 3e0a 0a20 2020 203c 7370 616e  span>..    <span
-00013d00: 2063 6c61 7373 3d22 6b22 3e72 6574 7572   class="k">retur
-00013d10: 6e3c 2f73 7061 6e3e 203c 7370 616e 2063  n</span> <span c
-00013d20: 6c61 7373 3d22 6e22 3e6c 6f73 733c 2f73  lass="n">loss</s
-00013d30: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
-00013d40: 2270 223e 2c3c 2f73 7061 6e3e 203c 7370  "p">,</span> <sp
-00013d50: 616e 2063 6c61 7373 3d22 6e22 3e67 7261  an class="n">gra
-00013d60: 643c 2f73 7061 6e3e 0a0a 0a3c 7370 616e  d</span>...<span
-00013d70: 2063 6c61 7373 3d22 6b22 3e64 6566 3c2f   class="k">def</
-00013d80: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
-00013d90: 733d 226e 6622 3e5f 636f 6d70 7574 655f  s="nf">_compute_
-00013da0: 6c6f 7373 5f61 6e64 5f67 7261 645f 6f66  loss_and_grad_of
-00013db0: 5f64 465f 696e 5f62 6174 6368 3c2f 7370  _dF_in_batch</sp
-00013dc0: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-00013dd0: 7022 3e28 3c2f 7370 616e 3e3c 7370 616e  p">(</span><span
-00013de0: 2063 6c61 7373 3d22 6e22 3e64 463c 2f73   class="n">dF</s
-00013df0: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
-00013e00: 2270 223e 2c3c 2f73 7061 6e3e 203c 7370  "p">,</span> <sp
-00013e10: 616e 2063 6c61 7373 3d22 6e22 3e65 6e65  an class="n">ene
-00013e20: 7267 793c 2f73 7061 6e3e 3c73 7061 6e20  rgy</span><span 
-00013e30: 636c 6173 733d 2270 223e 2c3c 2f73 7061  class="p">,</spa
-00013e40: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
-00013e50: 6e22 3e6e 756d 5f63 6f6e 663c 2f73 7061  n">num_conf</spa
-00013e60: 6e3e 3c73 7061 6e20 636c 6173 733d 2270  n><span class="p
-00013e70: 223e 2c3c 2f73 7061 6e3e 203c 7370 616e  ">,</span> <span
-00013e80: 2063 6c61 7373 3d22 6e22 3e62 6174 6368   class="n">batch
-00013e90: 5f73 697a 653c 2f73 7061 6e3e 3c73 7061  _size</span><spa
-00013ea0: 6e20 636c 6173 733d 2270 223e 3a3c 2f73  n class="p">:</s
-00013eb0: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
-00013ec0: 3d22 6e62 223e 696e 743c 2f73 7061 6e3e  ="nb">int</span>
-00013ed0: 3c73 7061 6e20 636c 6173 733d 2270 223e  <span class="p">
-00013ee0: 293a 3c2f 7370 616e 3e0a 3c73 7061 6e20  ):</span>.<span 
-00013ef0: 636c 6173 733d 2277 223e 2020 2020 3c2f  class="w">    </
-00013f00: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
-00013f10: 3d22 7364 223e 2671 756f 743b 2671 756f  ="sd">&quot;&quo
-00013f20: 743b 2671 756f 743b 5468 6973 2069 7320  t;&quot;This is 
-00013f30: 7468 6520 6261 7463 6820 7665 7273 696f  the batch versio
-00013f40: 6e20 6f66 205f 636f 6d70 7574 655f 6c6f  n of _compute_lo
-00013f50: 7373 5f61 6e64 5f67 7261 645f 6f66 5f64  ss_and_grad_of_d
-00013f60: 462e 3c2f 7370 616e 3e0a 3c73 7061 6e20  F.</span>.<span 
-00013f70: 636c 6173 733d 2273 6422 3e20 2020 2054  class="sd">    T
-00013f80: 6865 2062 6174 6368 2076 6572 7369 6f6e  he batch version
-00013f90: 2069 7320 7573 6564 2077 6865 6e20 7468   is used when th
-00013fa0: 6520 7369 7a65 206f 6620 656e 6572 6779  e size of energy
-00013fb0: 2069 7320 746f 6f20 6c61 7267 6520 746f   is too large to
-00013fc0: 2066 6974 2069 6e74 6f20 7468 653c 2f73   fit into the</s
-00013fd0: 7061 6e3e 0a3c 7370 616e 2063 6c61 7373  pan>.<span class
-00013fe0: 3d22 7364 223e 2020 2020 6d65 6d6f 7279  ="sd">    memory
-00013ff0: 206f 6620 6120 4750 552e 2054 6865 2065   of a GPU. The e
-00014000: 6e65 7267 7920 6d61 7472 6978 2069 7320  nergy matrix is 
-00014010: 7370 6c69 7420 696e 746f 206d 756c 7469  split into multi
-00014020: 706c 6520 6261 7463 6865 7320 616e 6420  ple batches and 
-00014030: 7468 653c 2f73 7061 6e3e 0a3c 7370 616e  the</span>.<span
-00014040: 2063 6c61 7373 3d22 7364 223e 2020 2020   class="sd">    
-00014050: 6361 6c63 756c 6174 696f 6e20 6973 2064  calculation is d
-00014060: 6f6e 6520 7365 7175 656e 7469 616c 6c79  one sequentially
-00014070: 2e3c 2f73 7061 6e3e 0a0a 3c73 7061 6e20  .</span>..<span 
-00014080: 636c 6173 733d 2273 6422 3e20 2020 2054  class="sd">    T
-00014090: 6865 2070 6172 616d 6574 6572 7320 6172  he parameters ar
-000140a0: 6520 7468 6520 7361 6d65 2061 7320 5f63  e the same as _c
-000140b0: 6f6d 7075 7465 5f6c 6f73 735f 616e 645f  ompute_loss_and_
-000140c0: 6772 6164 5f6f 665f 6446 2e3c 2f73 7061  grad_of_dF.</spa
-000140d0: 6e3e 0a3c 7370 616e 2063 6c61 7373 3d22  n>.<span class="
-000140e0: 7364 223e 2020 2020 2671 756f 743b 2671  sd">    &quot;&q
-000140f0: 756f 743b 2671 756f 743b 3c2f 7370 616e  uot;&quot;</span
-00014100: 3e0a 0a20 2020 203c 7370 616e 2063 6c61  >..    <span cla
-00014110: 7373 3d22 6e22 3e6e 3c2f 7370 616e 3e20  ss="n">n</span> 
-00014120: 3c73 7061 6e20 636c 6173 733d 226f 223e  <span class="o">
-00014130: 3d3c 2f73 7061 6e3e 203c 7370 616e 2063  =</span> <span c
-00014140: 6c61 7373 3d22 6e22 3e6e 756d 5f63 6f6e  lass="n">num_con
-00014150: 663c 2f73 7061 6e3e 0a20 2020 203c 7370  f</span>.    <sp
-00014160: 616e 2063 6c61 7373 3d22 6e22 3e4e 3c2f  an class="n">N</
-00014170: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
-00014180: 733d 226f 223e 3d3c 2f73 7061 6e3e 203c  s="o">=</span> <
-00014190: 7370 616e 2063 6c61 7373 3d22 6e22 3e74  span class="n">t
-000141a0: 6f72 6368 3c2f 7370 616e 3e3c 7370 616e  orch</span><span
-000141b0: 2063 6c61 7373 3d22 6f22 3e2e 3c2f 7370   class="o">.</sp
-000141c0: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-000141d0: 6e22 3e73 756d 3c2f 7370 616e 3e3c 7370  n">sum</span><sp
-000141e0: 616e 2063 6c61 7373 3d22 7022 3e28 3c2f  an class="p">(</
-000141f0: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
-00014200: 3d22 6e22 3e6e 3c2f 7370 616e 3e3c 7370  ="n">n</span><sp
-00014210: 616e 2063 6c61 7373 3d22 7022 3e29 3c2f  an class="p">)</
-00014220: 7370 616e 3e0a 2020 2020 3c73 7061 6e20  span>.    <span 
-00014230: 636c 6173 733d 226e 223e 6e5f 6f76 6572  class="n">n_over
-00014240: 5f4e 3c2f 7370 616e 3e20 3c73 7061 6e20  _N</span> <span 
-00014250: 636c 6173 733d 226f 223e 3d3c 2f73 7061  class="o">=</spa
-00014260: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
-00014270: 6e22 3e6e 3c2f 7370 616e 3e20 3c73 7061  n">n</span> <spa
-00014280: 6e20 636c 6173 733d 226f 223e 2f3c 2f73  n class="o">/</s
-00014290: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
-000142a0: 3d22 6e22 3e4e 3c2f 7370 616e 3e0a 0a20  ="n">N</span>.. 
-000142b0: 2020 203c 7370 616e 2063 6c61 7373 3d22     <span class="
-000142c0: 6b22 3e69 663c 2f73 7061 6e3e 203c 7370  k">if</span> <sp
-000142d0: 616e 2063 6c61 7373 3d22 6e22 3e65 6e65  an class="n">ene
-000142e0: 7267 793c 2f73 7061 6e3e 3c73 7061 6e20  rgy</span><span 
-000142f0: 636c 6173 733d 226f 223e 2e3c 2f73 7061  class="o">.</spa
-00014300: 6e3e 3c73 7061 6e20 636c 6173 733d 226e  n><span class="n
-00014310: 223e 7368 6170 653c 2f73 7061 6e3e 3c73  ">shape</span><s
-00014320: 7061 6e20 636c 6173 733d 2270 223e 5b3c  pan class="p">[<
-00014330: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
-00014340: 733d 226d 6922 3e31 3c2f 7370 616e 3e3c  s="mi">1</span><
-00014350: 7370 616e 2063 6c61 7373 3d22 7022 3e5d  span class="p">]
-00014360: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
-00014370: 6173 733d 226f 223e 253c 2f73 7061 6e3e  ass="o">%</span>
-00014380: 203c 7370 616e 2063 6c61 7373 3d22 6e22   <span class="n"
-00014390: 3e62 6174 6368 5f73 697a 653c 2f73 7061  >batch_size</spa
-000143a0: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
-000143b0: 6f22 3e3d 3d3c 2f73 7061 6e3e 203c 7370  o">==</span> <sp
-000143c0: 616e 2063 6c61 7373 3d22 6d69 223e 303c  an class="mi">0<
-000143d0: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
-000143e0: 733d 2270 223e 3a3c 2f73 7061 6e3e 0a20  s="p">:</span>. 
-000143f0: 2020 2020 2020 203c 7370 616e 2063 6c61         <span cla
-00014400: 7373 3d22 6e22 3e6e 756d 5f62 6174 6368  ss="n">num_batch
-00014410: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
-00014420: 6173 733d 226f 223e 3d3c 2f73 7061 6e3e  ass="o">=</span>
-00014430: 203c 7370 616e 2063 6c61 7373 3d22 6e22   <span class="n"
-00014440: 3e65 6e65 7267 793c 2f73 7061 6e3e 3c73  >energy</span><s
-00014450: 7061 6e20 636c 6173 733d 226f 223e 2e3c  pan class="o">.<
-00014460: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
-00014470: 733d 226e 223e 7368 6170 653c 2f73 7061  s="n">shape</spa
-00014480: 6e3e 3c73 7061 6e20 636c 6173 733d 2270  n><span class="p
-00014490: 223e 5b3c 2f73 7061 6e3e 3c73 7061 6e20  ">[</span><span 
-000144a0: 636c 6173 733d 226d 6922 3e31 3c2f 7370  class="mi">1</sp
-000144b0: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-000144c0: 7022 3e5d 3c2f 7370 616e 3e20 3c73 7061  p">]</span> <spa
-000144d0: 6e20 636c 6173 733d 226f 223e 2f2f 3c2f  n class="o">//</
-000144e0: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
-000144f0: 733d 226e 223e 6261 7463 685f 7369 7a65  s="n">batch_size
-00014500: 3c2f 7370 616e 3e0a 2020 2020 3c73 7061  </span>.    <spa
-00014510: 6e20 636c 6173 733d 226b 223e 656c 7365  n class="k">else
-00014520: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-00014530: 7373 3d22 7022 3e3a 3c2f 7370 616e 3e0a  ss="p">:</span>.
-00014540: 2020 2020 2020 2020 3c73 7061 6e20 636c          <span cl
-00014550: 6173 733d 226e 223e 6e75 6d5f 6261 7463  ass="n">num_batc
-00014560: 683c 2f73 7061 6e3e 203c 7370 616e 2063  h</span> <span c
-00014570: 6c61 7373 3d22 6f22 3e3d 3c2f 7370 616e  lass="o">=</span
-00014580: 3e20 3c73 7061 6e20 636c 6173 733d 226e  > <span class="n
-00014590: 223e 656e 6572 6779 3c2f 7370 616e 3e3c  ">energy</span><
-000145a0: 7370 616e 2063 6c61 7373 3d22 6f22 3e2e  span class="o">.
-000145b0: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-000145c0: 7373 3d22 6e22 3e73 6861 7065 3c2f 7370  ss="n">shape</sp
-000145d0: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-000145e0: 7022 3e5b 3c2f 7370 616e 3e3c 7370 616e  p">[</span><span
-000145f0: 2063 6c61 7373 3d22 6d69 223e 313c 2f73   class="mi">1</s
-00014600: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
-00014610: 2270 223e 5d3c 2f73 7061 6e3e 203c 7370  "p">]</span> <sp
-00014620: 616e 2063 6c61 7373 3d22 6f22 3e2f 2f3c  an class="o">//<
-00014630: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
-00014640: 7373 3d22 6e22 3e62 6174 6368 5f73 697a  ss="n">batch_siz
-00014650: 653c 2f73 7061 6e3e 203c 7370 616e 2063  e</span> <span c
-00014660: 6c61 7373 3d22 6f22 3e2b 3c2f 7370 616e  lass="o">+</span
-00014670: 3e20 3c73 7061 6e20 636c 6173 733d 226d  > <span class="m
-00014680: 6922 3e31 3c2f 7370 616e 3e0a 0a20 2020  i">1</span>..   
-00014690: 203c 7370 616e 2063 6c61 7373 3d22 6e22   <span class="n"
-000146a0: 3e46 3c2f 7370 616e 3e20 3c73 7061 6e20  >F</span> <span 
-000146b0: 636c 6173 733d 226f 223e 3d3c 2f73 7061  class="o">=</spa
+00013490: 7022 3e28 5b3c 2f73 7061 6e3e 3c73 7061  p">([</span><spa
+000134a0: 6e20 636c 6173 733d 226e 223e 6446 3c2f  n class="n">dF</
+000134b0: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+000134c0: 3d22 6f22 3e2e 3c2f 7370 616e 3e3c 7370  ="o">.</span><sp
+000134d0: 616e 2063 6c61 7373 3d22 6e22 3e6e 6577  an class="n">new
+000134e0: 5f7a 6572 6f73 3c2f 7370 616e 3e3c 7370  _zeros</span><sp
+000134f0: 616e 2063 6c61 7373 3d22 7022 3e28 3c2f  an class="p">(</
+00013500: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+00013510: 3d22 6d69 223e 313c 2f73 7061 6e3e 3c73  ="mi">1</span><s
+00013520: 7061 6e20 636c 6173 733d 2270 223e 292c  pan class="p">),
+00013530: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
+00013540: 6173 733d 226e 223e 6446 3c2f 7370 616e  ass="n">dF</span
+00013550: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
+00013560: 3e5d 293c 2f73 7061 6e3e 0a20 2020 203c  >])</span>.    <
+00013570: 7370 616e 2063 6c61 7373 3d22 6e22 3e6c  span class="n">l
+00013580: 6f67 703c 2f73 7061 6e3e 203c 7370 616e  ogp</span> <span
+00013590: 2063 6c61 7373 3d22 6f22 3e3d 3c2f 7370   class="o">=</sp
+000135a0: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
+000135b0: 226e 223e 5f63 6f6d 7075 7465 5f6c 6f67  "n">_compute_log
+000135c0: 705f 6f66 5f46 3c2f 7370 616e 3e3c 7370  p_of_F</span><sp
+000135d0: 616e 2063 6c61 7373 3d22 7022 3e28 3c2f  an class="p">(</
+000135e0: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+000135f0: 3d22 6e22 3e46 3c2f 7370 616e 3e3c 7370  ="n">F</span><sp
+00013600: 616e 2063 6c61 7373 3d22 7022 3e2c 3c2f  an class="p">,</
+00013610: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
+00013620: 733d 226e 223e 656e 6572 6779 3c2f 7370  s="n">energy</sp
+00013630: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+00013640: 7022 3e2c 3c2f 7370 616e 3e20 3c73 7061  p">,</span> <spa
+00013650: 6e20 636c 6173 733d 226e 223e 6e75 6d5f  n class="n">num_
+00013660: 636f 6e66 3c2f 7370 616e 3e3c 7370 616e  conf</span><span
+00013670: 2063 6c61 7373 3d22 7022 3e29 3c2f 7370   class="p">)</sp
+00013680: 616e 3e0a 2020 2020 3c73 7061 6e20 636c  an>.    <span cl
+00013690: 6173 733d 226e 223e 6c6f 7373 3c2f 7370  ass="n">loss</sp
+000136a0: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
+000136b0: 226f 223e 3d3c 2f73 7061 6e3e 203c 7370  "o">=</span> <sp
+000136c0: 616e 2063 6c61 7373 3d22 6f22 3e2d 3c2f  an class="o">-</
+000136d0: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+000136e0: 3d22 6e22 3e6c 6f67 703c 2f73 7061 6e3e  ="n">logp</span>
+000136f0: 203c 7370 616e 2063 6c61 7373 3d22 6f22   <span class="o"
+00013700: 3e2f 3c2f 7370 616e 3e20 3c73 7061 6e20  >/</span> <span 
+00013710: 636c 6173 733d 226e 223e 6e75 6d5f 636f  class="n">num_co
+00013720: 6e66 3c2f 7370 616e 3e3c 7370 616e 2063  nf</span><span c
+00013730: 6c61 7373 3d22 6f22 3e2e 3c2f 7370 616e  lass="o">.</span
+00013740: 3e3c 7370 616e 2063 6c61 7373 3d22 6e22  ><span class="n"
+00013750: 3e73 756d 3c2f 7370 616e 3e3c 7370 616e  >sum</span><span
+00013760: 2063 6c61 7373 3d22 7022 3e28 293c 2f73   class="p">()</s
+00013770: 7061 6e3e 0a20 2020 203c 7370 616e 2063  pan>.    <span c
+00013780: 6c61 7373 3d22 6e22 3e75 3c2f 7370 616e  lass="n">u</span
+00013790: 3e20 3c73 7061 6e20 636c 6173 733d 226f  > <span class="o
+000137a0: 223e 3d3c 2f73 7061 6e3e 203c 7370 616e  ">=</span> <span
+000137b0: 2063 6c61 7373 3d22 6e22 3e65 6e65 7267   class="n">energ
+000137c0: 793c 2f73 7061 6e3e 203c 7370 616e 2063  y</span> <span c
+000137d0: 6c61 7373 3d22 6f22 3e2d 3c2f 7370 616e  lass="o">-</span
+000137e0: 3e20 3c73 7061 6e20 636c 6173 733d 226e  > <span class="n
+000137f0: 223e 463c 2f73 7061 6e3e 3c73 7061 6e20  ">F</span><span 
+00013800: 636c 6173 733d 2270 223e 5b3a 2c3c 2f73  class="p">[:,</s
+00013810: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
+00013820: 3d22 6b63 223e 4e6f 6e65 3c2f 7370 616e  ="kc">None</span
+00013830: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
+00013840: 3e5d 3c2f 7370 616e 3e20 3c73 7061 6e20  >]</span> <span 
+00013850: 636c 6173 733d 226f 223e 2d3c 2f73 7061  class="o">-</spa
+00013860: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
+00013870: 6e22 3e74 6f72 6368 3c2f 7370 616e 3e3c  n">torch</span><
+00013880: 7370 616e 2063 6c61 7373 3d22 6f22 3e2e  span class="o">.
+00013890: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
+000138a0: 7373 3d22 6e22 3e6c 6f67 3c2f 7370 616e  ss="n">log</span
+000138b0: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
+000138c0: 3e28 3c2f 7370 616e 3e3c 7370 616e 2063  >(</span><span c
+000138d0: 6c61 7373 3d22 6e22 3e6e 756d 5f63 6f6e  lass="n">num_con
+000138e0: 663c 2f73 7061 6e3e 3c73 7061 6e20 636c  f</span><span cl
+000138f0: 6173 733d 2270 223e 295b 3a2c 3c2f 7370  ass="p">)[:,</sp
+00013900: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
+00013910: 226b 6322 3e4e 6f6e 653c 2f73 7061 6e3e  "kc">None</span>
+00013920: 3c73 7061 6e20 636c 6173 733d 2270 223e  <span class="p">
+00013930: 5d3c 2f73 7061 6e3e 0a0a 2020 2020 3c73  ]</span>..    <s
+00013940: 7061 6e20 636c 6173 733d 2263 3122 3e23  pan class="c1">#
+00013950: 2063 6f6d 7075 7465 2074 6865 2067 7261   compute the gra
+00013960: 6469 656e 7420 6f66 2074 6865 206c 6f73  dient of the los
+00013970: 7320 6675 6e63 7469 6f6e 3c2f 7370 616e  s function</span
+00013980: 3e0a 2020 2020 3c73 7061 6e20 636c 6173  >.    <span clas
+00013990: 733d 226e 223e 703c 2f73 7061 6e3e 203c  s="n">p</span> <
+000139a0: 7370 616e 2063 6c61 7373 3d22 6f22 3e3d  span class="o">=
+000139b0: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
+000139c0: 6173 733d 226e 223e 746f 7263 683c 2f73  ass="n">torch</s
+000139d0: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
+000139e0: 226f 223e 2e3c 2f73 7061 6e3e 3c73 7061  "o">.</span><spa
+000139f0: 6e20 636c 6173 733d 226e 223e 736f 6674  n class="n">soft
+00013a00: 6d61 783c 2f73 7061 6e3e 3c73 7061 6e20  max</span><span 
+00013a10: 636c 6173 733d 2270 223e 283c 2f73 7061  class="p">(</spa
+00013a20: 6e3e 3c73 7061 6e20 636c 6173 733d 226f  n><span class="o
+00013a30: 223e 2d3c 2f73 7061 6e3e 3c73 7061 6e20  ">-</span><span 
+00013a40: 636c 6173 733d 226e 223e 753c 2f73 7061  class="n">u</spa
+00013a50: 6e3e 3c73 7061 6e20 636c 6173 733d 2270  n><span class="p
+00013a60: 223e 2c3c 2f73 7061 6e3e 203c 7370 616e  ">,</span> <span
+00013a70: 2063 6c61 7373 3d22 6e22 3e64 696d 3c2f   class="n">dim</
+00013a80: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+00013a90: 3d22 6f22 3e3d 3c2f 7370 616e 3e3c 7370  ="o">=</span><sp
+00013aa0: 616e 2063 6c61 7373 3d22 6d69 223e 303c  an class="mi">0<
+00013ab0: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
+00013ac0: 733d 2270 223e 293c 2f73 7061 6e3e 0a20  s="p">)</span>. 
+00013ad0: 2020 203c 7370 616e 2063 6c61 7373 3d22     <span class="
+00013ae0: 6e22 3e67 7261 643c 2f73 7061 6e3e 203c  n">grad</span> <
+00013af0: 7370 616e 2063 6c61 7373 3d22 6f22 3e3d  span class="o">=
+00013b00: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
+00013b10: 6173 733d 226e 223e 746f 7263 683c 2f73  ass="n">torch</s
+00013b20: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
+00013b30: 226f 223e 2e3c 2f73 7061 6e3e 3c73 7061  "o">.</span><spa
+00013b40: 6e20 636c 6173 733d 226e 223e 6d65 616e  n class="n">mean
+00013b50: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
+00013b60: 7373 3d22 7022 3e28 3c2f 7370 616e 3e3c  ss="p">(</span><
+00013b70: 7370 616e 2063 6c61 7373 3d22 6e22 3e70  span class="n">p
+00013b80: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
+00013b90: 7373 3d22 7022 3e2c 3c2f 7370 616e 3e20  ss="p">,</span> 
+00013ba0: 3c73 7061 6e20 636c 6173 733d 226e 223e  <span class="n">
+00013bb0: 6469 6d3c 2f73 7061 6e3e 3c73 7061 6e20  dim</span><span 
+00013bc0: 636c 6173 733d 226f 223e 3d3c 2f73 7061  class="o">=</spa
+00013bd0: 6e3e 3c73 7061 6e20 636c 6173 733d 226d  n><span class="m
+00013be0: 6922 3e31 3c2f 7370 616e 3e3c 7370 616e  i">1</span><span
+00013bf0: 2063 6c61 7373 3d22 7022 3e29 3c2f 7370   class="p">)</sp
+00013c00: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
+00013c10: 226f 223e 2d3c 2f73 7061 6e3e 203c 7370  "o">-</span> <sp
+00013c20: 616e 2063 6c61 7373 3d22 6e22 3e6e 756d  an class="n">num
+00013c30: 5f63 6f6e 663c 2f73 7061 6e3e 203c 7370  _conf</span> <sp
+00013c40: 616e 2063 6c61 7373 3d22 6f22 3e2f 3c2f  an class="o">/</
+00013c50: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
+00013c60: 733d 226e 223e 6e75 6d5f 636f 6e66 3c2f  s="n">num_conf</
+00013c70: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+00013c80: 3d22 6f22 3e2e 3c2f 7370 616e 3e3c 7370  ="o">.</span><sp
+00013c90: 616e 2063 6c61 7373 3d22 6e22 3e73 756d  an class="n">sum
+00013ca0: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
+00013cb0: 7373 3d22 7022 3e28 293c 2f73 7061 6e3e  ss="p">()</span>
+00013cc0: 0a20 2020 203c 7370 616e 2063 6c61 7373  .    <span class
+00013cd0: 3d22 6e22 3e67 7261 643c 2f73 7061 6e3e  ="n">grad</span>
+00013ce0: 203c 7370 616e 2063 6c61 7373 3d22 6f22   <span class="o"
+00013cf0: 3e3d 3c2f 7370 616e 3e20 3c73 7061 6e20  >=</span> <span 
+00013d00: 636c 6173 733d 226e 223e 6772 6164 3c2f  class="n">grad</
+00013d10: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+00013d20: 3d22 7022 3e5b 3c2f 7370 616e 3e3c 7370  ="p">[</span><sp
+00013d30: 616e 2063 6c61 7373 3d22 6d69 223e 313c  an class="mi">1<
+00013d40: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
+00013d50: 733d 2270 223e 3a5d 3c2f 7370 616e 3e0a  s="p">:]</span>.
+00013d60: 0a20 2020 203c 7370 616e 2063 6c61 7373  .    <span class
+00013d70: 3d22 6b22 3e72 6574 7572 6e3c 2f73 7061  ="k">return</spa
+00013d80: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
+00013d90: 6e22 3e6c 6f73 733c 2f73 7061 6e3e 3c73  n">loss</span><s
+00013da0: 7061 6e20 636c 6173 733d 2270 223e 2c3c  pan class="p">,<
+00013db0: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
+00013dc0: 7373 3d22 6e22 3e67 7261 643c 2f73 7061  ss="n">grad</spa
+00013dd0: 6e3e 0a0a 0a3c 7370 616e 2063 6c61 7373  n>...<span class
+00013de0: 3d22 6b22 3e64 6566 3c2f 7370 616e 3e20  ="k">def</span> 
+00013df0: 3c73 7061 6e20 636c 6173 733d 226e 6622  <span class="nf"
+00013e00: 3e5f 636f 6d70 7574 655f 6c6f 7373 5f61  >_compute_loss_a
+00013e10: 6e64 5f67 7261 645f 6f66 5f64 465f 696e  nd_grad_of_dF_in
+00013e20: 5f62 6174 6368 3c2f 7370 616e 3e3c 7370  _batch</span><sp
+00013e30: 616e 2063 6c61 7373 3d22 7022 3e28 3c2f  an class="p">(</
+00013e40: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+00013e50: 3d22 6e22 3e64 463c 2f73 7061 6e3e 3c73  ="n">dF</span><s
+00013e60: 7061 6e20 636c 6173 733d 2270 223e 2c3c  pan class="p">,<
+00013e70: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
+00013e80: 7373 3d22 6e22 3e65 6e65 7267 793c 2f73  ss="n">energy</s
+00013e90: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
+00013ea0: 2270 223e 2c3c 2f73 7061 6e3e 203c 7370  "p">,</span> <sp
+00013eb0: 616e 2063 6c61 7373 3d22 6e22 3e6e 756d  an class="n">num
+00013ec0: 5f63 6f6e 663c 2f73 7061 6e3e 3c73 7061  _conf</span><spa
+00013ed0: 6e20 636c 6173 733d 2270 223e 2c3c 2f73  n class="p">,</s
+00013ee0: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
+00013ef0: 3d22 6e22 3e62 6174 6368 5f73 697a 653c  ="n">batch_size<
+00013f00: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
+00013f10: 733d 2270 223e 3a3c 2f73 7061 6e3e 203c  s="p">:</span> <
+00013f20: 7370 616e 2063 6c61 7373 3d22 6e62 223e  span class="nb">
+00013f30: 696e 743c 2f73 7061 6e3e 3c73 7061 6e20  int</span><span 
+00013f40: 636c 6173 733d 2270 223e 293a 3c2f 7370  class="p">):</sp
+00013f50: 616e 3e0a 3c73 7061 6e20 636c 6173 733d  an>.<span class=
+00013f60: 2277 223e 2020 2020 3c2f 7370 616e 3e3c  "w">    </span><
+00013f70: 7370 616e 2063 6c61 7373 3d22 7364 223e  span class="sd">
+00013f80: 2671 756f 743b 2671 756f 743b 2671 756f  &quot;&quot;&quo
+00013f90: 743b 5468 6973 2069 7320 7468 6520 6261  t;This is the ba
+00013fa0: 7463 6820 7665 7273 696f 6e20 6f66 205f  tch version of _
+00013fb0: 636f 6d70 7574 655f 6c6f 7373 5f61 6e64  compute_loss_and
+00013fc0: 5f67 7261 645f 6f66 5f64 462e 3c2f 7370  _grad_of_dF.</sp
+00013fd0: 616e 3e0a 3c73 7061 6e20 636c 6173 733d  an>.<span class=
+00013fe0: 2273 6422 3e20 2020 2054 6865 2062 6174  "sd">    The bat
+00013ff0: 6368 2076 6572 7369 6f6e 2069 7320 7573  ch version is us
+00014000: 6564 2077 6865 6e20 7468 6520 7369 7a65  ed when the size
+00014010: 206f 6620 656e 6572 6779 2069 7320 746f   of energy is to
+00014020: 6f20 6c61 7267 6520 746f 2066 6974 2069  o large to fit i
+00014030: 6e74 6f20 7468 653c 2f73 7061 6e3e 0a3c  nto the</span>.<
+00014040: 7370 616e 2063 6c61 7373 3d22 7364 223e  span class="sd">
+00014050: 2020 2020 6d65 6d6f 7279 206f 6620 6120      memory of a 
+00014060: 4750 552e 2054 6865 2065 6e65 7267 7920  GPU. The energy 
+00014070: 6d61 7472 6978 2069 7320 7370 6c69 7420  matrix is split 
+00014080: 696e 746f 206d 756c 7469 706c 6520 6261  into multiple ba
+00014090: 7463 6865 7320 616e 6420 7468 653c 2f73  tches and the</s
+000140a0: 7061 6e3e 0a3c 7370 616e 2063 6c61 7373  pan>.<span class
+000140b0: 3d22 7364 223e 2020 2020 6361 6c63 756c  ="sd">    calcul
+000140c0: 6174 696f 6e20 6973 2064 6f6e 6520 7365  ation is done se
+000140d0: 7175 656e 7469 616c 6c79 2e3c 2f73 7061  quentially.</spa
+000140e0: 6e3e 0a0a 3c73 7061 6e20 636c 6173 733d  n>..<span class=
+000140f0: 2273 6422 3e20 2020 2054 6865 2070 6172  "sd">    The par
+00014100: 616d 6574 6572 7320 6172 6520 7468 6520  ameters are the 
+00014110: 7361 6d65 2061 7320 5f63 6f6d 7075 7465  same as _compute
+00014120: 5f6c 6f73 735f 616e 645f 6772 6164 5f6f  _loss_and_grad_o
+00014130: 665f 6446 2e3c 2f73 7061 6e3e 0a3c 7370  f_dF.</span>.<sp
+00014140: 616e 2063 6c61 7373 3d22 7364 223e 2020  an class="sd">  
+00014150: 2020 2671 756f 743b 2671 756f 743b 2671    &quot;&quot;&q
+00014160: 756f 743b 3c2f 7370 616e 3e0a 0a20 2020  uot;</span>..   
+00014170: 203c 7370 616e 2063 6c61 7373 3d22 6e22   <span class="n"
+00014180: 3e6e 3c2f 7370 616e 3e20 3c73 7061 6e20  >n</span> <span 
+00014190: 636c 6173 733d 226f 223e 3d3c 2f73 7061  class="o">=</spa
+000141a0: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
+000141b0: 6e22 3e6e 756d 5f63 6f6e 663c 2f73 7061  n">num_conf</spa
+000141c0: 6e3e 0a20 2020 203c 7370 616e 2063 6c61  n>.    <span cla
+000141d0: 7373 3d22 6e22 3e4e 3c2f 7370 616e 3e20  ss="n">N</span> 
+000141e0: 3c73 7061 6e20 636c 6173 733d 226f 223e  <span class="o">
+000141f0: 3d3c 2f73 7061 6e3e 203c 7370 616e 2063  =</span> <span c
+00014200: 6c61 7373 3d22 6e22 3e74 6f72 6368 3c2f  lass="n">torch</
+00014210: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+00014220: 3d22 6f22 3e2e 3c2f 7370 616e 3e3c 7370  ="o">.</span><sp
+00014230: 616e 2063 6c61 7373 3d22 6e22 3e73 756d  an class="n">sum
+00014240: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
+00014250: 7373 3d22 7022 3e28 3c2f 7370 616e 3e3c  ss="p">(</span><
+00014260: 7370 616e 2063 6c61 7373 3d22 6e22 3e6e  span class="n">n
+00014270: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
+00014280: 7373 3d22 7022 3e29 3c2f 7370 616e 3e0a  ss="p">)</span>.
+00014290: 2020 2020 3c73 7061 6e20 636c 6173 733d      <span class=
+000142a0: 226e 223e 6e5f 6f76 6572 5f4e 3c2f 7370  "n">n_over_N</sp
+000142b0: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
+000142c0: 226f 223e 3d3c 2f73 7061 6e3e 203c 7370  "o">=</span> <sp
+000142d0: 616e 2063 6c61 7373 3d22 6e22 3e6e 3c2f  an class="n">n</
+000142e0: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
+000142f0: 733d 226f 223e 2f3c 2f73 7061 6e3e 203c  s="o">/</span> <
+00014300: 7370 616e 2063 6c61 7373 3d22 6e22 3e4e  span class="n">N
+00014310: 3c2f 7370 616e 3e0a 0a20 2020 203c 7370  </span>..    <sp
+00014320: 616e 2063 6c61 7373 3d22 6b22 3e69 663c  an class="k">if<
+00014330: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
+00014340: 7373 3d22 6e22 3e65 6e65 7267 793c 2f73  ss="n">energy</s
+00014350: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
+00014360: 226f 223e 2e3c 2f73 7061 6e3e 3c73 7061  "o">.</span><spa
+00014370: 6e20 636c 6173 733d 226e 223e 7368 6170  n class="n">shap
+00014380: 653c 2f73 7061 6e3e 3c73 7061 6e20 636c  e</span><span cl
+00014390: 6173 733d 2270 223e 5b3c 2f73 7061 6e3e  ass="p">[</span>
+000143a0: 3c73 7061 6e20 636c 6173 733d 226d 6922  <span class="mi"
+000143b0: 3e31 3c2f 7370 616e 3e3c 7370 616e 2063  >1</span><span c
+000143c0: 6c61 7373 3d22 7022 3e5d 3c2f 7370 616e  lass="p">]</span
+000143d0: 3e20 3c73 7061 6e20 636c 6173 733d 226f  > <span class="o
+000143e0: 223e 253c 2f73 7061 6e3e 203c 7370 616e  ">%</span> <span
+000143f0: 2063 6c61 7373 3d22 6e22 3e62 6174 6368   class="n">batch
+00014400: 5f73 697a 653c 2f73 7061 6e3e 203c 7370  _size</span> <sp
+00014410: 616e 2063 6c61 7373 3d22 6f22 3e3d 3d3c  an class="o">==<
+00014420: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
+00014430: 7373 3d22 6d69 223e 303c 2f73 7061 6e3e  ss="mi">0</span>
+00014440: 3c73 7061 6e20 636c 6173 733d 2270 223e  <span class="p">
+00014450: 3a3c 2f73 7061 6e3e 0a20 2020 2020 2020  :</span>.       
+00014460: 203c 7370 616e 2063 6c61 7373 3d22 6e22   <span class="n"
+00014470: 3e6e 756d 5f62 6174 6368 3c2f 7370 616e  >num_batch</span
+00014480: 3e20 3c73 7061 6e20 636c 6173 733d 226f  > <span class="o
+00014490: 223e 3d3c 2f73 7061 6e3e 203c 7370 616e  ">=</span> <span
+000144a0: 2063 6c61 7373 3d22 6e22 3e65 6e65 7267   class="n">energ
+000144b0: 793c 2f73 7061 6e3e 3c73 7061 6e20 636c  y</span><span cl
+000144c0: 6173 733d 226f 223e 2e3c 2f73 7061 6e3e  ass="o">.</span>
+000144d0: 3c73 7061 6e20 636c 6173 733d 226e 223e  <span class="n">
+000144e0: 7368 6170 653c 2f73 7061 6e3e 3c73 7061  shape</span><spa
+000144f0: 6e20 636c 6173 733d 2270 223e 5b3c 2f73  n class="p">[</s
+00014500: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
+00014510: 226d 6922 3e31 3c2f 7370 616e 3e3c 7370  "mi">1</span><sp
+00014520: 616e 2063 6c61 7373 3d22 7022 3e5d 3c2f  an class="p">]</
+00014530: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
+00014540: 733d 226f 223e 2f2f 3c2f 7370 616e 3e20  s="o">//</span> 
+00014550: 3c73 7061 6e20 636c 6173 733d 226e 223e  <span class="n">
+00014560: 6261 7463 685f 7369 7a65 3c2f 7370 616e  batch_size</span
+00014570: 3e0a 2020 2020 3c73 7061 6e20 636c 6173  >.    <span clas
+00014580: 733d 226b 223e 656c 7365 3c2f 7370 616e  s="k">else</span
+00014590: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
+000145a0: 3e3a 3c2f 7370 616e 3e0a 2020 2020 2020  >:</span>.      
+000145b0: 2020 3c73 7061 6e20 636c 6173 733d 226e    <span class="n
+000145c0: 223e 6e75 6d5f 6261 7463 683c 2f73 7061  ">num_batch</spa
+000145d0: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
+000145e0: 6f22 3e3d 3c2f 7370 616e 3e20 3c73 7061  o">=</span> <spa
+000145f0: 6e20 636c 6173 733d 226e 223e 656e 6572  n class="n">ener
+00014600: 6779 3c2f 7370 616e 3e3c 7370 616e 2063  gy</span><span c
+00014610: 6c61 7373 3d22 6f22 3e2e 3c2f 7370 616e  lass="o">.</span
+00014620: 3e3c 7370 616e 2063 6c61 7373 3d22 6e22  ><span class="n"
+00014630: 3e73 6861 7065 3c2f 7370 616e 3e3c 7370  >shape</span><sp
+00014640: 616e 2063 6c61 7373 3d22 7022 3e5b 3c2f  an class="p">[</
+00014650: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+00014660: 3d22 6d69 223e 313c 2f73 7061 6e3e 3c73  ="mi">1</span><s
+00014670: 7061 6e20 636c 6173 733d 2270 223e 5d3c  pan class="p">]<
+00014680: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
+00014690: 7373 3d22 6f22 3e2f 2f3c 2f73 7061 6e3e  ss="o">//</span>
+000146a0: 203c 7370 616e 2063 6c61 7373 3d22 6e22   <span class="n"
+000146b0: 3e62 6174 6368 5f73 697a 653c 2f73 7061  >batch_size</spa
 000146c0: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
-000146d0: 6e22 3e74 6f72 6368 3c2f 7370 616e 3e3c  n">torch</span><
-000146e0: 7370 616e 2063 6c61 7373 3d22 6f22 3e2e  span class="o">.
-000146f0: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-00014700: 7373 3d22 6e22 3e63 6174 3c2f 7370 616e  ss="n">cat</span
-00014710: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
-00014720: 3e28 5b3c 2f73 7061 6e3e 3c73 7061 6e20  >([</span><span 
-00014730: 636c 6173 733d 226e 223e 6446 3c2f 7370  class="n">dF</sp
-00014740: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-00014750: 6f22 3e2e 3c2f 7370 616e 3e3c 7370 616e  o">.</span><span
-00014760: 2063 6c61 7373 3d22 6e22 3e6e 6577 5f7a   class="n">new_z
-00014770: 6572 6f73 3c2f 7370 616e 3e3c 7370 616e  eros</span><span
-00014780: 2063 6c61 7373 3d22 7022 3e28 3c2f 7370   class="p">(</sp
-00014790: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-000147a0: 6d69 223e 313c 2f73 7061 6e3e 3c73 7061  mi">1</span><spa
-000147b0: 6e20 636c 6173 733d 2270 223e 292c 3c2f  n class="p">),</
-000147c0: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
-000147d0: 733d 226e 223e 6446 3c2f 7370 616e 3e3c  s="n">dF</span><
-000147e0: 7370 616e 2063 6c61 7373 3d22 7022 3e5d  span class="p">]
-000147f0: 293c 2f73 7061 6e3e 0a20 2020 203c 7370  )</span>.    <sp
-00014800: 616e 2063 6c61 7373 3d22 6e22 3e6c 6f73  an class="n">los
-00014810: 733c 2f73 7061 6e3e 203c 7370 616e 2063  s</span> <span c
-00014820: 6c61 7373 3d22 6f22 3e3d 3c2f 7370 616e  lass="o">=</span
-00014830: 3e20 3c73 7061 6e20 636c 6173 733d 226f  > <span class="o
-00014840: 223e 2d3c 2f73 7061 6e3e 3c73 7061 6e20  ">-</span><span 
-00014850: 636c 6173 733d 226e 223e 746f 7263 683c  class="n">torch<
-00014860: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
-00014870: 733d 226f 223e 2e3c 2f73 7061 6e3e 3c73  s="o">.</span><s
-00014880: 7061 6e20 636c 6173 733d 226e 223e 7375  pan class="n">su
-00014890: 6d3c 2f73 7061 6e3e 3c73 7061 6e20 636c  m</span><span cl
-000148a0: 6173 733d 2270 223e 283c 2f73 7061 6e3e  ass="p">(</span>
-000148b0: 3c73 7061 6e20 636c 6173 733d 226e 223e  <span class="n">
-000148c0: 6e75 6d5f 636f 6e66 3c2f 7370 616e 3e20  num_conf</span> 
+000146d0: 6f22 3e2b 3c2f 7370 616e 3e20 3c73 7061  o">+</span> <spa
+000146e0: 6e20 636c 6173 733d 226d 6922 3e31 3c2f  n class="mi">1</
+000146f0: 7370 616e 3e0a 0a20 2020 203c 7370 616e  span>..    <span
+00014700: 2063 6c61 7373 3d22 6e22 3e46 3c2f 7370   class="n">F</sp
+00014710: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
+00014720: 226f 223e 3d3c 2f73 7061 6e3e 203c 7370  "o">=</span> <sp
+00014730: 616e 2063 6c61 7373 3d22 6e22 3e74 6f72  an class="n">tor
+00014740: 6368 3c2f 7370 616e 3e3c 7370 616e 2063  ch</span><span c
+00014750: 6c61 7373 3d22 6f22 3e2e 3c2f 7370 616e  lass="o">.</span
+00014760: 3e3c 7370 616e 2063 6c61 7373 3d22 6e22  ><span class="n"
+00014770: 3e63 6174 3c2f 7370 616e 3e3c 7370 616e  >cat</span><span
+00014780: 2063 6c61 7373 3d22 7022 3e28 5b3c 2f73   class="p">([</s
+00014790: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
+000147a0: 226e 223e 6446 3c2f 7370 616e 3e3c 7370  "n">dF</span><sp
+000147b0: 616e 2063 6c61 7373 3d22 6f22 3e2e 3c2f  an class="o">.</
+000147c0: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+000147d0: 3d22 6e22 3e6e 6577 5f7a 6572 6f73 3c2f  ="n">new_zeros</
+000147e0: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+000147f0: 3d22 7022 3e28 3c2f 7370 616e 3e3c 7370  ="p">(</span><sp
+00014800: 616e 2063 6c61 7373 3d22 6d69 223e 313c  an class="mi">1<
+00014810: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
+00014820: 733d 2270 223e 292c 3c2f 7370 616e 3e20  s="p">),</span> 
+00014830: 3c73 7061 6e20 636c 6173 733d 226e 223e  <span class="n">
+00014840: 6446 3c2f 7370 616e 3e3c 7370 616e 2063  dF</span><span c
+00014850: 6c61 7373 3d22 7022 3e5d 293c 2f73 7061  lass="p">])</spa
+00014860: 6e3e 0a20 2020 203c 7370 616e 2063 6c61  n>.    <span cla
+00014870: 7373 3d22 6e22 3e6c 6f73 733c 2f73 7061  ss="n">loss</spa
+00014880: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
+00014890: 6f22 3e3d 3c2f 7370 616e 3e20 3c73 7061  o">=</span> <spa
+000148a0: 6e20 636c 6173 733d 226f 223e 2d3c 2f73  n class="o">-</s
+000148b0: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
+000148c0: 226e 223e 746f 7263 683c 2f73 7061 6e3e  "n">torch</span>
 000148d0: 3c73 7061 6e20 636c 6173 733d 226f 223e  <span class="o">
-000148e0: 2a3c 2f73 7061 6e3e 203c 7370 616e 2063  *</span> <span c
-000148f0: 6c61 7373 3d22 6e22 3e46 3c2f 7370 616e  lass="n">F</span
-00014900: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
-00014910: 3e29 3c2f 7370 616e 3e0a 2020 2020 3c73  >)</span>.    <s
-00014920: 7061 6e20 636c 6173 733d 226e 223e 6772  pan class="n">gr
-00014930: 6164 3c2f 7370 616e 3e20 3c73 7061 6e20  ad</span> <span 
-00014940: 636c 6173 733d 226f 223e 3d3c 2f73 7061  class="o">=</spa
+000148e0: 2e3c 2f73 7061 6e3e 3c73 7061 6e20 636c  .</span><span cl
+000148f0: 6173 733d 226e 223e 7375 6d3c 2f73 7061  ass="n">sum</spa
+00014900: 6e3e 3c73 7061 6e20 636c 6173 733d 2270  n><span class="p
+00014910: 223e 283c 2f73 7061 6e3e 3c73 7061 6e20  ">(</span><span 
+00014920: 636c 6173 733d 226e 223e 6e75 6d5f 636f  class="n">num_co
+00014930: 6e66 3c2f 7370 616e 3e20 3c73 7061 6e20  nf</span> <span 
+00014940: 636c 6173 733d 226f 223e 2a3c 2f73 7061  class="o">*</spa
 00014950: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
-00014960: 6f22 3e2d 3c2f 7370 616e 3e3c 7370 616e  o">-</span><span
-00014970: 2063 6c61 7373 3d22 6e22 3e6e 756d 5f63   class="n">num_c
-00014980: 6f6e 663c 2f73 7061 6e3e 0a0a 2020 2020  onf</span>..    
-00014990: 3c73 7061 6e20 636c 6173 733d 226b 223e  <span class="k">
-000149a0: 666f 723c 2f73 7061 6e3e 203c 7370 616e  for</span> <span
-000149b0: 2063 6c61 7373 3d22 6e22 3e69 3c2f 7370   class="n">i</sp
-000149c0: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
-000149d0: 226f 7722 3e69 6e3c 2f73 7061 6e3e 203c  "ow">in</span> <
-000149e0: 7370 616e 2063 6c61 7373 3d22 6e62 223e  span class="nb">
-000149f0: 7261 6e67 653c 2f73 7061 6e3e 3c73 7061  range</span><spa
-00014a00: 6e20 636c 6173 733d 2270 223e 283c 2f73  n class="p">(</s
-00014a10: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
-00014a20: 226e 223e 6e75 6d5f 6261 7463 683c 2f73  "n">num_batch</s
-00014a30: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
-00014a40: 2270 223e 293a 3c2f 7370 616e 3e0a 2020  "p">):</span>.  
-00014a50: 2020 2020 2020 3c73 7061 6e20 636c 6173        <span clas
-00014a60: 733d 226e 223e 656e 6572 6779 5f62 6174  s="n">energy_bat
-00014a70: 6368 3c2f 7370 616e 3e20 3c73 7061 6e20  ch</span> <span 
-00014a80: 636c 6173 733d 226f 223e 3d3c 2f73 7061  class="o">=</spa
-00014a90: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
-00014aa0: 6e22 3e65 6e65 7267 793c 2f73 7061 6e3e  n">energy</span>
-00014ab0: 3c73 7061 6e20 636c 6173 733d 2270 223e  <span class="p">
-00014ac0: 5b3a 2c3c 2f73 7061 6e3e 203c 7370 616e  [:,</span> <span
-00014ad0: 2063 6c61 7373 3d22 6e22 3e69 3c2f 7370   class="n">i</sp
+00014960: 6e22 3e46 3c2f 7370 616e 3e3c 7370 616e  n">F</span><span
+00014970: 2063 6c61 7373 3d22 7022 3e29 3c2f 7370   class="p">)</sp
+00014980: 616e 3e0a 2020 2020 3c73 7061 6e20 636c  an>.    <span cl
+00014990: 6173 733d 226e 223e 6772 6164 3c2f 7370  ass="n">grad</sp
+000149a0: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
+000149b0: 226f 223e 3d3c 2f73 7061 6e3e 203c 7370  "o">=</span> <sp
+000149c0: 616e 2063 6c61 7373 3d22 6f22 3e2d 3c2f  an class="o">-</
+000149d0: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+000149e0: 3d22 6e22 3e6e 756d 5f63 6f6e 663c 2f73  ="n">num_conf</s
+000149f0: 7061 6e3e 0a0a 2020 2020 3c73 7061 6e20  pan>..    <span 
+00014a00: 636c 6173 733d 226b 223e 666f 723c 2f73  class="k">for</s
+00014a10: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
+00014a20: 3d22 6e22 3e69 3c2f 7370 616e 3e20 3c73  ="n">i</span> <s
+00014a30: 7061 6e20 636c 6173 733d 226f 7722 3e69  pan class="ow">i
+00014a40: 6e3c 2f73 7061 6e3e 203c 7370 616e 2063  n</span> <span c
+00014a50: 6c61 7373 3d22 6e62 223e 7261 6e67 653c  lass="nb">range<
+00014a60: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
+00014a70: 733d 2270 223e 283c 2f73 7061 6e3e 3c73  s="p">(</span><s
+00014a80: 7061 6e20 636c 6173 733d 226e 223e 6e75  pan class="n">nu
+00014a90: 6d5f 6261 7463 683c 2f73 7061 6e3e 3c73  m_batch</span><s
+00014aa0: 7061 6e20 636c 6173 733d 2270 223e 293a  pan class="p">):
+00014ab0: 3c2f 7370 616e 3e0a 2020 2020 2020 2020  </span>.        
+00014ac0: 3c73 7061 6e20 636c 6173 733d 226e 223e  <span class="n">
+00014ad0: 656e 6572 6779 5f62 6174 6368 3c2f 7370  energy_batch</sp
 00014ae0: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
-00014af0: 226f 223e 2a3c 2f73 7061 6e3e 203c 7370  "o">*</span> <sp
-00014b00: 616e 2063 6c61 7373 3d22 6e22 3e62 6174  an class="n">bat
-00014b10: 6368 5f73 697a 653c 2f73 7061 6e3e 203c  ch_size</span> <
-00014b20: 7370 616e 2063 6c61 7373 3d22 7022 3e3a  span class="p">:
-00014b30: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
-00014b40: 6173 733d 2270 223e 283c 2f73 7061 6e3e  ass="p">(</span>
-00014b50: 3c73 7061 6e20 636c 6173 733d 226e 223e  <span class="n">
-00014b60: 693c 2f73 7061 6e3e 203c 7370 616e 2063  i</span> <span c
-00014b70: 6c61 7373 3d22 6f22 3e2b 3c2f 7370 616e  lass="o">+</span
-00014b80: 3e20 3c73 7061 6e20 636c 6173 733d 226d  > <span class="m
-00014b90: 6922 3e31 3c2f 7370 616e 3e3c 7370 616e  i">1</span><span
-00014ba0: 2063 6c61 7373 3d22 7022 3e29 3c2f 7370   class="p">)</sp
-00014bb0: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
-00014bc0: 226f 223e 2a3c 2f73 7061 6e3e 203c 7370  "o">*</span> <sp
-00014bd0: 616e 2063 6c61 7373 3d22 6e22 3e62 6174  an class="n">bat
-00014be0: 6368 5f73 697a 653c 2f73 7061 6e3e 3c73  ch_size</span><s
-00014bf0: 7061 6e20 636c 6173 733d 2270 223e 5d3c  pan class="p">]<
-00014c00: 2f73 7061 6e3e 0a20 2020 2020 2020 203c  /span>.        <
-00014c10: 7370 616e 2063 6c61 7373 3d22 6e22 3e75  span class="n">u
-00014c20: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
-00014c30: 6173 733d 226f 223e 3d3c 2f73 7061 6e3e  ass="o">=</span>
-00014c40: 203c 7370 616e 2063 6c61 7373 3d22 6e22   <span class="n"
-00014c50: 3e65 6e65 7267 795f 6261 7463 683c 2f73  >energy_batch</s
-00014c60: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
-00014c70: 226f 223e 2e3c 2f73 7061 6e3e 3c73 7061  "o">.</span><spa
-00014c80: 6e20 636c 6173 733d 226e 223e 6375 6461  n class="n">cuda
-00014c90: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-00014ca0: 7373 3d22 7022 3e28 293c 2f73 7061 6e3e  ss="p">()</span>
-00014cb0: 203c 7370 616e 2063 6c61 7373 3d22 6f22   <span class="o"
-00014cc0: 3e2d 3c2f 7370 616e 3e20 3c73 7061 6e20  >-</span> <span 
-00014cd0: 636c 6173 733d 226e 223e 746f 7263 683c  class="n">torch<
+00014af0: 226f 223e 3d3c 2f73 7061 6e3e 203c 7370  "o">=</span> <sp
+00014b00: 616e 2063 6c61 7373 3d22 6e22 3e65 6e65  an class="n">ene
+00014b10: 7267 793c 2f73 7061 6e3e 3c73 7061 6e20  rgy</span><span 
+00014b20: 636c 6173 733d 2270 223e 5b3a 2c3c 2f73  class="p">[:,</s
+00014b30: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
+00014b40: 3d22 6e22 3e69 3c2f 7370 616e 3e20 3c73  ="n">i</span> <s
+00014b50: 7061 6e20 636c 6173 733d 226f 223e 2a3c  pan class="o">*<
+00014b60: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
+00014b70: 7373 3d22 6e22 3e62 6174 6368 5f73 697a  ss="n">batch_siz
+00014b80: 653c 2f73 7061 6e3e 203c 7370 616e 2063  e</span> <span c
+00014b90: 6c61 7373 3d22 7022 3e3a 3c2f 7370 616e  lass="p">:</span
+00014ba0: 3e20 3c73 7061 6e20 636c 6173 733d 2270  > <span class="p
+00014bb0: 223e 283c 2f73 7061 6e3e 3c73 7061 6e20  ">(</span><span 
+00014bc0: 636c 6173 733d 226e 223e 693c 2f73 7061  class="n">i</spa
+00014bd0: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
+00014be0: 6f22 3e2b 3c2f 7370 616e 3e20 3c73 7061  o">+</span> <spa
+00014bf0: 6e20 636c 6173 733d 226d 6922 3e31 3c2f  n class="mi">1</
+00014c00: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+00014c10: 3d22 7022 3e29 3c2f 7370 616e 3e20 3c73  ="p">)</span> <s
+00014c20: 7061 6e20 636c 6173 733d 226f 223e 2a3c  pan class="o">*<
+00014c30: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
+00014c40: 7373 3d22 6e22 3e62 6174 6368 5f73 697a  ss="n">batch_siz
+00014c50: 653c 2f73 7061 6e3e 3c73 7061 6e20 636c  e</span><span cl
+00014c60: 6173 733d 2270 223e 5d3c 2f73 7061 6e3e  ass="p">]</span>
+00014c70: 0a20 2020 2020 2020 203c 7370 616e 2063  .        <span c
+00014c80: 6c61 7373 3d22 6e22 3e75 3c2f 7370 616e  lass="n">u</span
+00014c90: 3e20 3c73 7061 6e20 636c 6173 733d 226f  > <span class="o
+00014ca0: 223e 3d3c 2f73 7061 6e3e 203c 7370 616e  ">=</span> <span
+00014cb0: 2063 6c61 7373 3d22 6e22 3e65 6e65 7267   class="n">energ
+00014cc0: 795f 6261 7463 683c 2f73 7061 6e3e 3c73  y_batch</span><s
+00014cd0: 7061 6e20 636c 6173 733d 226f 223e 2e3c  pan class="o">.<
 00014ce0: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
-00014cf0: 733d 226f 223e 2e3c 2f73 7061 6e3e 3c73  s="o">.</span><s
-00014d00: 7061 6e20 636c 6173 733d 226e 223e 6c6f  pan class="n">lo
-00014d10: 673c 2f73 7061 6e3e 3c73 7061 6e20 636c  g</span><span cl
-00014d20: 6173 733d 2270 223e 283c 2f73 7061 6e3e  ass="p">(</span>
-00014d30: 3c73 7061 6e20 636c 6173 733d 226e 223e  <span class="n">
-00014d40: 6e75 6d5f 636f 6e66 3c2f 7370 616e 3e3c  num_conf</span><
-00014d50: 7370 616e 2063 6c61 7373 3d22 7022 3e29  span class="p">)
-00014d60: 5b3a 2c3c 2f73 7061 6e3e 203c 7370 616e  [:,</span> <span
-00014d70: 2063 6c61 7373 3d22 6b63 223e 4e6f 6e65   class="kc">None
-00014d80: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-00014d90: 7373 3d22 7022 3e5d 3c2f 7370 616e 3e20  ss="p">]</span> 
-00014da0: 3c73 7061 6e20 636c 6173 733d 226f 223e  <span class="o">
-00014db0: 2d3c 2f73 7061 6e3e 203c 7370 616e 2063  -</span> <span c
-00014dc0: 6c61 7373 3d22 6e22 3e46 3c2f 7370 616e  lass="n">F</span
-00014dd0: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
-00014de0: 3e5b 3a2c 3c2f 7370 616e 3e20 3c73 7061  >[:,</span> <spa
-00014df0: 6e20 636c 6173 733d 226b 6322 3e4e 6f6e  n class="kc">Non
-00014e00: 653c 2f73 7061 6e3e 3c73 7061 6e20 636c  e</span><span cl
-00014e10: 6173 733d 2270 223e 5d3c 2f73 7061 6e3e  ass="p">]</span>
-00014e20: 0a20 2020 2020 2020 203c 7370 616e 2063  .        <span c
-00014e30: 6c61 7373 3d22 6e22 3e6c 6f73 733c 2f73  lass="n">loss</s
-00014e40: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
-00014e50: 3d22 6f22 3e2b 3d3c 2f73 7061 6e3e 203c  ="o">+=</span> <
-00014e60: 7370 616e 2063 6c61 7373 3d22 6e22 3e74  span class="n">t
-00014e70: 6f72 6368 3c2f 7370 616e 3e3c 7370 616e  orch</span><span
-00014e80: 2063 6c61 7373 3d22 6f22 3e2e 3c2f 7370   class="o">.</sp
-00014e90: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-00014ea0: 6e22 3e6c 6f67 7375 6d65 7870 3c2f 7370  n">logsumexp</sp
-00014eb0: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-00014ec0: 7022 3e28 3c2f 7370 616e 3e3c 7370 616e  p">(</span><span
-00014ed0: 2063 6c61 7373 3d22 6f22 3e2d 3c2f 7370   class="o">-</sp
-00014ee0: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-00014ef0: 6e22 3e75 3c2f 7370 616e 3e3c 7370 616e  n">u</span><span
-00014f00: 2063 6c61 7373 3d22 7022 3e2c 3c2f 7370   class="p">,</sp
-00014f10: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
-00014f20: 226e 223e 6469 6d3c 2f73 7061 6e3e 3c73  "n">dim</span><s
-00014f30: 7061 6e20 636c 6173 733d 226f 223e 3d3c  pan class="o">=<
-00014f40: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
-00014f50: 733d 226d 6922 3e30 3c2f 7370 616e 3e3c  s="mi">0</span><
-00014f60: 7370 616e 2063 6c61 7373 3d22 7022 3e29  span class="p">)
-00014f70: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-00014f80: 7373 3d22 6f22 3e2e 3c2f 7370 616e 3e3c  ss="o">.</span><
-00014f90: 7370 616e 2063 6c61 7373 3d22 6e22 3e73  span class="n">s
-00014fa0: 756d 3c2f 7370 616e 3e3c 7370 616e 2063  um</span><span c
-00014fb0: 6c61 7373 3d22 7022 3e28 293c 2f73 7061  lass="p">()</spa
-00014fc0: 6e3e 0a0a 2020 2020 2020 2020 3c73 7061  n>..        <spa
-00014fd0: 6e20 636c 6173 733d 226e 223e 703c 2f73  n class="n">p</s
-00014fe0: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
-00014ff0: 3d22 6f22 3e3d 3c2f 7370 616e 3e20 3c73  ="o">=</span> <s
-00015000: 7061 6e20 636c 6173 733d 226e 223e 746f  pan class="n">to
-00015010: 7263 683c 2f73 7061 6e3e 3c73 7061 6e20  rch</span><span 
-00015020: 636c 6173 733d 226f 223e 2e3c 2f73 7061  class="o">.</spa
-00015030: 6e3e 3c73 7061 6e20 636c 6173 733d 226e  n><span class="n
-00015040: 223e 736f 6674 6d61 783c 2f73 7061 6e3e  ">softmax</span>
-00015050: 3c73 7061 6e20 636c 6173 733d 2270 223e  <span class="p">
-00015060: 283c 2f73 7061 6e3e 3c73 7061 6e20 636c  (</span><span cl
-00015070: 6173 733d 226f 223e 2d3c 2f73 7061 6e3e  ass="o">-</span>
-00015080: 3c73 7061 6e20 636c 6173 733d 226e 223e  <span class="n">
-00015090: 753c 2f73 7061 6e3e 3c73 7061 6e20 636c  u</span><span cl
-000150a0: 6173 733d 2270 223e 2c3c 2f73 7061 6e3e  ass="p">,</span>
-000150b0: 203c 7370 616e 2063 6c61 7373 3d22 6e22   <span class="n"
-000150c0: 3e64 696d 3c2f 7370 616e 3e3c 7370 616e  >dim</span><span
-000150d0: 2063 6c61 7373 3d22 6f22 3e3d 3c2f 7370   class="o">=</sp
-000150e0: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-000150f0: 6d69 223e 303c 2f73 7061 6e3e 3c73 7061  mi">0</span><spa
-00015100: 6e20 636c 6173 733d 2270 223e 293c 2f73  n class="p">)</s
-00015110: 7061 6e3e 0a20 2020 2020 2020 203c 7370  pan>.        <sp
-00015120: 616e 2063 6c61 7373 3d22 6e22 3e67 7261  an class="n">gra
-00015130: 643c 2f73 7061 6e3e 203c 7370 616e 2063  d</span> <span c
-00015140: 6c61 7373 3d22 6f22 3e2b 3d3c 2f73 7061  lass="o">+=</spa
-00015150: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
-00015160: 6e22 3e74 6f72 6368 3c2f 7370 616e 3e3c  n">torch</span><
-00015170: 7370 616e 2063 6c61 7373 3d22 6f22 3e2e  span class="o">.
-00015180: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-00015190: 7373 3d22 6e22 3e73 756d 3c2f 7370 616e  ss="n">sum</span
-000151a0: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
-000151b0: 3e28 3c2f 7370 616e 3e3c 7370 616e 2063  >(</span><span c
-000151c0: 6c61 7373 3d22 6e22 3e70 3c2f 7370 616e  lass="n">p</span
-000151d0: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
-000151e0: 3e2c 3c2f 7370 616e 3e20 3c73 7061 6e20  >,</span> <span 
-000151f0: 636c 6173 733d 226e 223e 6469 6d3c 2f73  class="n">dim</s
-00015200: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
-00015210: 226f 223e 3d3c 2f73 7061 6e3e 3c73 7061  "o">=</span><spa
-00015220: 6e20 636c 6173 733d 226d 6922 3e31 3c2f  n class="mi">1</
-00015230: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
-00015240: 3d22 7022 3e29 3c2f 7370 616e 3e0a 0a20  ="p">)</span>.. 
-00015250: 2020 203c 7370 616e 2063 6c61 7373 3d22     <span class="
-00015260: 6e22 3e6c 6f73 733c 2f73 7061 6e3e 203c  n">loss</span> <
-00015270: 7370 616e 2063 6c61 7373 3d22 6f22 3e3d  span class="o">=
-00015280: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
-00015290: 6173 733d 226e 223e 6c6f 7373 3c2f 7370  ass="n">loss</sp
-000152a0: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
-000152b0: 226f 223e 2f3c 2f73 7061 6e3e 203c 7370  "o">/</span> <sp
-000152c0: 616e 2063 6c61 7373 3d22 6e22 3e4e 3c2f  an class="n">N</
-000152d0: 7370 616e 3e0a 2020 2020 3c73 7061 6e20  span>.    <span 
-000152e0: 636c 6173 733d 226e 223e 6772 6164 3c2f  class="n">grad</
-000152f0: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
-00015300: 733d 226f 223e 3d3c 2f73 7061 6e3e 203c  s="o">=</span> <
-00015310: 7370 616e 2063 6c61 7373 3d22 6e22 3e67  span class="n">g
-00015320: 7261 643c 2f73 7061 6e3e 203c 7370 616e  rad</span> <span
-00015330: 2063 6c61 7373 3d22 6f22 3e2f 3c2f 7370   class="o">/</sp
-00015340: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
-00015350: 226e 223e 4e3c 2f73 7061 6e3e 0a20 2020  "n">N</span>.   
-00015360: 203c 7370 616e 2063 6c61 7373 3d22 6e22   <span class="n"
-00015370: 3e67 7261 643c 2f73 7061 6e3e 203c 7370  >grad</span> <sp
-00015380: 616e 2063 6c61 7373 3d22 6f22 3e3d 3c2f  an class="o">=</
-00015390: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
-000153a0: 733d 226e 223e 6772 6164 3c2f 7370 616e  s="n">grad</span
-000153b0: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
-000153c0: 3e5b 3c2f 7370 616e 3e3c 7370 616e 2063  >[</span><span c
-000153d0: 6c61 7373 3d22 6d69 223e 313c 2f73 7061  lass="mi">1</spa
-000153e0: 6e3e 3c73 7061 6e20 636c 6173 733d 2270  n><span class="p
-000153f0: 223e 3a5d 3c2f 7370 616e 3e0a 2020 2020  ">:]</span>.    
-00015400: 3c73 7061 6e20 636c 6173 733d 226b 223e  <span class="k">
-00015410: 7265 7475 726e 3c2f 7370 616e 3e20 3c73  return</span> <s
-00015420: 7061 6e20 636c 6173 733d 226e 223e 6c6f  pan class="n">lo
-00015430: 7373 3c2f 7370 616e 3e3c 7370 616e 2063  ss</span><span c
-00015440: 6c61 7373 3d22 7022 3e2c 3c2f 7370 616e  lass="p">,</span
-00015450: 3e20 3c73 7061 6e20 636c 6173 733d 226e  > <span class="n
-00015460: 223e 6772 6164 3c2f 7370 616e 3e0a 0a0a  ">grad</span>...
-00015470: 3c73 7061 6e20 636c 6173 733d 226b 223e  <span class="k">
-00015480: 6465 663c 2f73 7061 6e3e 203c 7370 616e  def</span> <span
-00015490: 2063 6c61 7373 3d22 6e66 223e 5f63 6f6d   class="nf">_com
-000154a0: 7075 7465 5f68 6573 7369 616e 5f6c 6f67  pute_hessian_log
-000154b0: 5f6c 696b 656c 6968 6f6f 645f 6f66 5f46  _likelihood_of_F
-000154c0: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-000154d0: 7373 3d22 7022 3e28 3c2f 7370 616e 3e3c  ss="p">(</span><
-000154e0: 7370 616e 2063 6c61 7373 3d22 6e22 3e46  span class="n">F
-000154f0: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-00015500: 7373 3d22 7022 3e2c 3c2f 7370 616e 3e20  ss="p">,</span> 
-00015510: 3c73 7061 6e20 636c 6173 733d 226e 223e  <span class="n">
-00015520: 656e 6572 6779 3c2f 7370 616e 3e3c 7370  energy</span><sp
-00015530: 616e 2063 6c61 7373 3d22 7022 3e2c 3c2f  an class="p">,</
-00015540: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
-00015550: 733d 226e 223e 6e75 6d5f 636f 6e66 3c2f  s="n">num_conf</
-00015560: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
-00015570: 3d22 7022 3e29 3a3c 2f73 7061 6e3e 0a20  ="p">):</span>. 
-00015580: 2020 203c 7370 616e 2063 6c61 7373 3d22     <span class="
-00015590: 6e22 3e75 3c2f 7370 616e 3e20 3c73 7061  n">u</span> <spa
-000155a0: 6e20 636c 6173 733d 226f 223e 3d3c 2f73  n class="o">=</s
-000155b0: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
-000155c0: 3d22 6e22 3e65 6e65 7267 793c 2f73 7061  ="n">energy</spa
-000155d0: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
-000155e0: 6f22 3e2d 3c2f 7370 616e 3e20 3c73 7061  o">-</span> <spa
-000155f0: 6e20 636c 6173 733d 226e 223e 463c 2f73  n class="n">F</s
-00015600: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
-00015610: 2270 223e 5b3a 2c3c 2f73 7061 6e3e 203c  "p">[:,</span> <
-00015620: 7370 616e 2063 6c61 7373 3d22 6b63 223e  span class="kc">
-00015630: 4e6f 6e65 3c2f 7370 616e 3e3c 7370 616e  None</span><span
-00015640: 2063 6c61 7373 3d22 7022 3e5d 3c2f 7370   class="p">]</sp
-00015650: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
-00015660: 226f 223e 2d3c 2f73 7061 6e3e 203c 7370  "o">-</span> <sp
-00015670: 616e 2063 6c61 7373 3d22 6e22 3e74 6f72  an class="n">tor
-00015680: 6368 3c2f 7370 616e 3e3c 7370 616e 2063  ch</span><span c
-00015690: 6c61 7373 3d22 6f22 3e2e 3c2f 7370 616e  lass="o">.</span
-000156a0: 3e3c 7370 616e 2063 6c61 7373 3d22 6e22  ><span class="n"
-000156b0: 3e6c 6f67 3c2f 7370 616e 3e3c 7370 616e  >log</span><span
-000156c0: 2063 6c61 7373 3d22 7022 3e28 3c2f 7370   class="p">(</sp
-000156d0: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-000156e0: 6e22 3e6e 756d 5f63 6f6e 663c 2f73 7061  n">num_conf</spa
-000156f0: 6e3e 3c73 7061 6e20 636c 6173 733d 2270  n><span class="p
-00015700: 223e 295b 3a2c 3c2f 7370 616e 3e20 3c73  ">)[:,</span> <s
-00015710: 7061 6e20 636c 6173 733d 226b 6322 3e4e  pan class="kc">N
-00015720: 6f6e 653c 2f73 7061 6e3e 3c73 7061 6e20  one</span><span 
-00015730: 636c 6173 733d 2270 223e 5d3c 2f73 7061  class="p">]</spa
-00015740: 6e3e 0a20 2020 203c 7370 616e 2063 6c61  n>.    <span cla
-00015750: 7373 3d22 6e22 3e70 3c2f 7370 616e 3e20  ss="n">p</span> 
-00015760: 3c73 7061 6e20 636c 6173 733d 226f 223e  <span class="o">
-00015770: 3d3c 2f73 7061 6e3e 203c 7370 616e 2063  =</span> <span c
-00015780: 6c61 7373 3d22 6e22 3e74 6f72 6368 3c2f  lass="n">torch</
-00015790: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
-000157a0: 3d22 6f22 3e2e 3c2f 7370 616e 3e3c 7370  ="o">.</span><sp
-000157b0: 616e 2063 6c61 7373 3d22 6e22 3e73 6f66  an class="n">sof
-000157c0: 746d 6178 3c2f 7370 616e 3e3c 7370 616e  tmax</span><span
-000157d0: 2063 6c61 7373 3d22 7022 3e28 3c2f 7370   class="p">(</sp
-000157e0: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-000157f0: 6f22 3e2d 3c2f 7370 616e 3e3c 7370 616e  o">-</span><span
-00015800: 2063 6c61 7373 3d22 6e22 3e75 3c2f 7370   class="n">u</sp
-00015810: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-00015820: 7022 3e2c 3c2f 7370 616e 3e20 3c73 7061  p">,</span> <spa
-00015830: 6e20 636c 6173 733d 226e 223e 6469 6d3c  n class="n">dim<
-00015840: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
-00015850: 733d 226f 223e 3d3c 2f73 7061 6e3e 3c73  s="o">=</span><s
-00015860: 7061 6e20 636c 6173 733d 226d 6922 3e30  pan class="mi">0
-00015870: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-00015880: 7373 3d22 7022 3e29 3c2f 7370 616e 3e0a  ss="p">)</span>.
-00015890: 2020 2020 3c73 7061 6e20 636c 6173 733d      <span class=
-000158a0: 226e 223e 7070 3c2f 7370 616e 3e20 3c73  "n">pp</span> <s
-000158b0: 7061 6e20 636c 6173 733d 226f 223e 3d3c  pan class="o">=<
-000158c0: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
-000158d0: 7373 3d22 6e22 3e74 6f72 6368 3c2f 7370  ss="n">torch</sp
-000158e0: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-000158f0: 6f22 3e2e 3c2f 7370 616e 3e3c 7370 616e  o">.</span><span
-00015900: 2063 6c61 7373 3d22 6e22 3e6d 6174 6d75   class="n">matmu
-00015910: 6c3c 2f73 7061 6e3e 3c73 7061 6e20 636c  l</span><span cl
-00015920: 6173 733d 2270 223e 283c 2f73 7061 6e3e  ass="p">(</span>
-00015930: 3c73 7061 6e20 636c 6173 733d 226e 223e  <span class="n">
-00015940: 703c 2f73 7061 6e3e 3c73 7061 6e20 636c  p</span><span cl
-00015950: 6173 733d 2270 223e 2c3c 2f73 7061 6e3e  ass="p">,</span>
-00015960: 203c 7370 616e 2063 6c61 7373 3d22 6e22   <span class="n"
-00015970: 3e70 3c2f 7370 616e 3e3c 7370 616e 2063  >p</span><span c
-00015980: 6c61 7373 3d22 6f22 3e2e 3c2f 7370 616e  lass="o">.</span
-00015990: 3e3c 7370 616e 2063 6c61 7373 3d22 6e22  ><span class="n"
-000159a0: 3e54 3c2f 7370 616e 3e3c 7370 616e 2063  >T</span><span c
-000159b0: 6c61 7373 3d22 7022 3e29 3c2f 7370 616e  lass="p">)</span
-000159c0: 3e0a 2020 2020 3c73 7061 6e20 636c 6173  >.    <span clas
-000159d0: 733d 226e 223e 483c 2f73 7061 6e3e 203c  s="n">H</span> <
-000159e0: 7370 616e 2063 6c61 7373 3d22 6f22 3e3d  span class="o">=
-000159f0: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
-00015a00: 6173 733d 226e 223e 7070 3c2f 7370 616e  ass="n">pp</span
-00015a10: 3e20 3c73 7061 6e20 636c 6173 733d 226f  > <span class="o
-00015a20: 223e 2d3c 2f73 7061 6e3e 203c 7370 616e  ">-</span> <span
-00015a30: 2063 6c61 7373 3d22 6e22 3e74 6f72 6368   class="n">torch
-00015a40: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-00015a50: 7373 3d22 6f22 3e2e 3c2f 7370 616e 3e3c  ss="o">.</span><
-00015a60: 7370 616e 2063 6c61 7373 3d22 6e22 3e64  span class="n">d
-00015a70: 6961 673c 2f73 7061 6e3e 3c73 7061 6e20  iag</span><span 
-00015a80: 636c 6173 733d 2270 223e 283c 2f73 7061  class="p">(</spa
-00015a90: 6e3e 3c73 7061 6e20 636c 6173 733d 226e  n><span class="n
-00015aa0: 223e 746f 7263 683c 2f73 7061 6e3e 3c73  ">torch</span><s
-00015ab0: 7061 6e20 636c 6173 733d 226f 223e 2e3c  pan class="o">.<
-00015ac0: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
-00015ad0: 733d 226e 223e 7375 6d3c 2f73 7061 6e3e  s="n">sum</span>
-00015ae0: 3c73 7061 6e20 636c 6173 733d 2270 223e  <span class="p">
-00015af0: 283c 2f73 7061 6e3e 3c73 7061 6e20 636c  (</span><span cl
-00015b00: 6173 733d 226e 223e 703c 2f73 7061 6e3e  ass="n">p</span>
-00015b10: 3c73 7061 6e20 636c 6173 733d 2270 223e  <span class="p">
-00015b20: 2c3c 2f73 7061 6e3e 203c 7370 616e 2063  ,</span> <span c
-00015b30: 6c61 7373 3d22 6d69 223e 313c 2f73 7061  lass="mi">1</spa
-00015b40: 6e3e 3c73 7061 6e20 636c 6173 733d 2270  n><span class="p
-00015b50: 223e 2929 3c2f 7370 616e 3e0a 2020 2020  ">))</span>.    
-00015b60: 3c73 7061 6e20 636c 6173 733d 226b 223e  <span class="k">
-00015b70: 7265 7475 726e 3c2f 7370 616e 3e20 3c73  return</span> <s
-00015b80: 7061 6e20 636c 6173 733d 226e 223e 483c  pan class="n">H<
-00015b90: 2f73 7061 6e3e 0a0a 0a3c 7370 616e 2063  /span>...<span c
-00015ba0: 6c61 7373 3d22 6b22 3e64 6566 3c2f 7370  lass="k">def</sp
-00015bb0: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
-00015bc0: 226e 6622 3e5f 636f 6d70 7574 655f 6865  "nf">_compute_he
-00015bd0: 7373 6961 6e5f 6c6f 675f 6c69 6b65 6c69  ssian_log_likeli
-00015be0: 686f 6f64 5f6f 665f 465f 696e 5f62 6174  hood_of_F_in_bat
-00015bf0: 6368 3c2f 7370 616e 3e3c 7370 616e 2063  ch</span><span c
-00015c00: 6c61 7373 3d22 7022 3e28 3c2f 7370 616e  lass="p">(</span
-00015c10: 3e3c 7370 616e 2063 6c61 7373 3d22 6e22  ><span class="n"
-00015c20: 3e46 3c2f 7370 616e 3e3c 7370 616e 2063  >F</span><span c
-00015c30: 6c61 7373 3d22 7022 3e2c 3c2f 7370 616e  lass="p">,</span
-00015c40: 3e20 3c73 7061 6e20 636c 6173 733d 226e  > <span class="n
-00015c50: 223e 656e 6572 6779 3c2f 7370 616e 3e3c  ">energy</span><
-00015c60: 7370 616e 2063 6c61 7373 3d22 7022 3e2c  span class="p">,
-00015c70: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
-00015c80: 6173 733d 226e 223e 6e75 6d5f 636f 6e66  ass="n">num_conf
-00015c90: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-00015ca0: 7373 3d22 7022 3e2c 3c2f 7370 616e 3e20  ss="p">,</span> 
-00015cb0: 3c73 7061 6e20 636c 6173 733d 226e 223e  <span class="n">
-00015cc0: 6261 7463 685f 7369 7a65 3c2f 7370 616e  batch_size</span
-00015cd0: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
-00015ce0: 3e3a 3c2f 7370 616e 3e20 3c73 7061 6e20  >:</span> <span 
-00015cf0: 636c 6173 733d 226e 6222 3e69 6e74 3c2f  class="nb">int</
-00015d00: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
-00015d10: 3d22 7022 3e29 3a3c 2f73 7061 6e3e 0a20  ="p">):</span>. 
-00015d20: 2020 203c 7370 616e 2063 6c61 7373 3d22     <span class="
-00015d30: 6b22 3e69 663c 2f73 7061 6e3e 203c 7370  k">if</span> <sp
-00015d40: 616e 2063 6c61 7373 3d22 6e22 3e65 6e65  an class="n">ene
-00015d50: 7267 793c 2f73 7061 6e3e 3c73 7061 6e20  rgy</span><span 
-00015d60: 636c 6173 733d 226f 223e 2e3c 2f73 7061  class="o">.</spa
-00015d70: 6e3e 3c73 7061 6e20 636c 6173 733d 226e  n><span class="n
-00015d80: 223e 7368 6170 653c 2f73 7061 6e3e 3c73  ">shape</span><s
-00015d90: 7061 6e20 636c 6173 733d 2270 223e 5b3c  pan class="p">[<
-00015da0: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
-00015db0: 733d 226d 6922 3e31 3c2f 7370 616e 3e3c  s="mi">1</span><
-00015dc0: 7370 616e 2063 6c61 7373 3d22 7022 3e5d  span class="p">]
-00015dd0: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
-00015de0: 6173 733d 226f 223e 253c 2f73 7061 6e3e  ass="o">%</span>
-00015df0: 203c 7370 616e 2063 6c61 7373 3d22 6e22   <span class="n"
-00015e00: 3e62 6174 6368 5f73 697a 653c 2f73 7061  >batch_size</spa
-00015e10: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
-00015e20: 6f22 3e3d 3d3c 2f73 7061 6e3e 203c 7370  o">==</span> <sp
-00015e30: 616e 2063 6c61 7373 3d22 6d69 223e 303c  an class="mi">0<
-00015e40: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
-00015e50: 733d 2270 223e 3a3c 2f73 7061 6e3e 0a20  s="p">:</span>. 
-00015e60: 2020 2020 2020 203c 7370 616e 2063 6c61         <span cla
-00015e70: 7373 3d22 6e22 3e6e 756d 5f62 6174 6368  ss="n">num_batch
-00015e80: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
-00015e90: 6173 733d 226f 223e 3d3c 2f73 7061 6e3e  ass="o">=</span>
-00015ea0: 203c 7370 616e 2063 6c61 7373 3d22 6e22   <span class="n"
-00015eb0: 3e65 6e65 7267 793c 2f73 7061 6e3e 3c73  >energy</span><s
-00015ec0: 7061 6e20 636c 6173 733d 226f 223e 2e3c  pan class="o">.<
-00015ed0: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
-00015ee0: 733d 226e 223e 7368 6170 653c 2f73 7061  s="n">shape</spa
-00015ef0: 6e3e 3c73 7061 6e20 636c 6173 733d 2270  n><span class="p
-00015f00: 223e 5b3c 2f73 7061 6e3e 3c73 7061 6e20  ">[</span><span 
-00015f10: 636c 6173 733d 226d 6922 3e31 3c2f 7370  class="mi">1</sp
-00015f20: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-00015f30: 7022 3e5d 3c2f 7370 616e 3e20 3c73 7061  p">]</span> <spa
-00015f40: 6e20 636c 6173 733d 226f 223e 2f2f 3c2f  n class="o">//</
-00015f50: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
-00015f60: 733d 226e 223e 6261 7463 685f 7369 7a65  s="n">batch_size
-00015f70: 3c2f 7370 616e 3e0a 2020 2020 3c73 7061  </span>.    <spa
-00015f80: 6e20 636c 6173 733d 226b 223e 656c 7365  n class="k">else
-00015f90: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-00015fa0: 7373 3d22 7022 3e3a 3c2f 7370 616e 3e0a  ss="p">:</span>.
-00015fb0: 2020 2020 2020 2020 3c73 7061 6e20 636c          <span cl
-00015fc0: 6173 733d 226e 223e 6e75 6d5f 6261 7463  ass="n">num_batc
-00015fd0: 683c 2f73 7061 6e3e 203c 7370 616e 2063  h</span> <span c
-00015fe0: 6c61 7373 3d22 6f22 3e3d 3c2f 7370 616e  lass="o">=</span
-00015ff0: 3e20 3c73 7061 6e20 636c 6173 733d 226e  > <span class="n
-00016000: 223e 656e 6572 6779 3c2f 7370 616e 3e3c  ">energy</span><
-00016010: 7370 616e 2063 6c61 7373 3d22 6f22 3e2e  span class="o">.
-00016020: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-00016030: 7373 3d22 6e22 3e73 6861 7065 3c2f 7370  ss="n">shape</sp
-00016040: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-00016050: 7022 3e5b 3c2f 7370 616e 3e3c 7370 616e  p">[</span><span
-00016060: 2063 6c61 7373 3d22 6d69 223e 313c 2f73   class="mi">1</s
-00016070: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
-00016080: 2270 223e 5d3c 2f73 7061 6e3e 203c 7370  "p">]</span> <sp
-00016090: 616e 2063 6c61 7373 3d22 6f22 3e2f 2f3c  an class="o">//<
-000160a0: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
-000160b0: 7373 3d22 6e22 3e62 6174 6368 5f73 697a  ss="n">batch_siz
-000160c0: 653c 2f73 7061 6e3e 203c 7370 616e 2063  e</span> <span c
-000160d0: 6c61 7373 3d22 6f22 3e2b 3c2f 7370 616e  lass="o">+</span
-000160e0: 3e20 3c73 7061 6e20 636c 6173 733d 226d  > <span class="m
-000160f0: 6922 3e31 3c2f 7370 616e 3e0a 0a20 2020  i">1</span>..   
-00016100: 203c 7370 616e 2063 6c61 7373 3d22 6e22   <span class="n"
-00016110: 3e48 3c2f 7370 616e 3e20 3c73 7061 6e20  >H</span> <span 
-00016120: 636c 6173 733d 226f 223e 3d3c 2f73 7061  class="o">=</spa
+00014cf0: 733d 226e 223e 6375 6461 3c2f 7370 616e  s="n">cuda</span
+00014d00: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
+00014d10: 3e28 293c 2f73 7061 6e3e 203c 7370 616e  >()</span> <span
+00014d20: 2063 6c61 7373 3d22 6f22 3e2d 3c2f 7370   class="o">-</sp
+00014d30: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
+00014d40: 226e 223e 746f 7263 683c 2f73 7061 6e3e  "n">torch</span>
+00014d50: 3c73 7061 6e20 636c 6173 733d 226f 223e  <span class="o">
+00014d60: 2e3c 2f73 7061 6e3e 3c73 7061 6e20 636c  .</span><span cl
+00014d70: 6173 733d 226e 223e 6c6f 673c 2f73 7061  ass="n">log</spa
+00014d80: 6e3e 3c73 7061 6e20 636c 6173 733d 2270  n><span class="p
+00014d90: 223e 283c 2f73 7061 6e3e 3c73 7061 6e20  ">(</span><span 
+00014da0: 636c 6173 733d 226e 223e 6e75 6d5f 636f  class="n">num_co
+00014db0: 6e66 3c2f 7370 616e 3e3c 7370 616e 2063  nf</span><span c
+00014dc0: 6c61 7373 3d22 7022 3e29 5b3a 2c3c 2f73  lass="p">)[:,</s
+00014dd0: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
+00014de0: 3d22 6b63 223e 4e6f 6e65 3c2f 7370 616e  ="kc">None</span
+00014df0: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
+00014e00: 3e5d 3c2f 7370 616e 3e20 3c73 7061 6e20  >]</span> <span 
+00014e10: 636c 6173 733d 226f 223e 2d3c 2f73 7061  class="o">-</spa
+00014e20: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
+00014e30: 6e22 3e46 3c2f 7370 616e 3e3c 7370 616e  n">F</span><span
+00014e40: 2063 6c61 7373 3d22 7022 3e5b 3a2c 3c2f   class="p">[:,</
+00014e50: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
+00014e60: 733d 226b 6322 3e4e 6f6e 653c 2f73 7061  s="kc">None</spa
+00014e70: 6e3e 3c73 7061 6e20 636c 6173 733d 2270  n><span class="p
+00014e80: 223e 5d3c 2f73 7061 6e3e 0a20 2020 2020  ">]</span>.     
+00014e90: 2020 203c 7370 616e 2063 6c61 7373 3d22     <span class="
+00014ea0: 6e22 3e6c 6f73 733c 2f73 7061 6e3e 203c  n">loss</span> <
+00014eb0: 7370 616e 2063 6c61 7373 3d22 6f22 3e2b  span class="o">+
+00014ec0: 3d3c 2f73 7061 6e3e 203c 7370 616e 2063  =</span> <span c
+00014ed0: 6c61 7373 3d22 6e22 3e74 6f72 6368 3c2f  lass="n">torch</
+00014ee0: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+00014ef0: 3d22 6f22 3e2e 3c2f 7370 616e 3e3c 7370  ="o">.</span><sp
+00014f00: 616e 2063 6c61 7373 3d22 6e22 3e6c 6f67  an class="n">log
+00014f10: 7375 6d65 7870 3c2f 7370 616e 3e3c 7370  sumexp</span><sp
+00014f20: 616e 2063 6c61 7373 3d22 7022 3e28 3c2f  an class="p">(</
+00014f30: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+00014f40: 3d22 6f22 3e2d 3c2f 7370 616e 3e3c 7370  ="o">-</span><sp
+00014f50: 616e 2063 6c61 7373 3d22 6e22 3e75 3c2f  an class="n">u</
+00014f60: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+00014f70: 3d22 7022 3e2c 3c2f 7370 616e 3e20 3c73  ="p">,</span> <s
+00014f80: 7061 6e20 636c 6173 733d 226e 223e 6469  pan class="n">di
+00014f90: 6d3c 2f73 7061 6e3e 3c73 7061 6e20 636c  m</span><span cl
+00014fa0: 6173 733d 226f 223e 3d3c 2f73 7061 6e3e  ass="o">=</span>
+00014fb0: 3c73 7061 6e20 636c 6173 733d 226d 6922  <span class="mi"
+00014fc0: 3e30 3c2f 7370 616e 3e3c 7370 616e 2063  >0</span><span c
+00014fd0: 6c61 7373 3d22 7022 3e29 3c2f 7370 616e  lass="p">)</span
+00014fe0: 3e3c 7370 616e 2063 6c61 7373 3d22 6f22  ><span class="o"
+00014ff0: 3e2e 3c2f 7370 616e 3e3c 7370 616e 2063  >.</span><span c
+00015000: 6c61 7373 3d22 6e22 3e73 756d 3c2f 7370  lass="n">sum</sp
+00015010: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+00015020: 7022 3e28 293c 2f73 7061 6e3e 0a0a 2020  p">()</span>..  
+00015030: 2020 2020 2020 3c73 7061 6e20 636c 6173        <span clas
+00015040: 733d 226e 223e 703c 2f73 7061 6e3e 203c  s="n">p</span> <
+00015050: 7370 616e 2063 6c61 7373 3d22 6f22 3e3d  span class="o">=
+00015060: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
+00015070: 6173 733d 226e 223e 746f 7263 683c 2f73  ass="n">torch</s
+00015080: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
+00015090: 226f 223e 2e3c 2f73 7061 6e3e 3c73 7061  "o">.</span><spa
+000150a0: 6e20 636c 6173 733d 226e 223e 736f 6674  n class="n">soft
+000150b0: 6d61 783c 2f73 7061 6e3e 3c73 7061 6e20  max</span><span 
+000150c0: 636c 6173 733d 2270 223e 283c 2f73 7061  class="p">(</spa
+000150d0: 6e3e 3c73 7061 6e20 636c 6173 733d 226f  n><span class="o
+000150e0: 223e 2d3c 2f73 7061 6e3e 3c73 7061 6e20  ">-</span><span 
+000150f0: 636c 6173 733d 226e 223e 753c 2f73 7061  class="n">u</spa
+00015100: 6e3e 3c73 7061 6e20 636c 6173 733d 2270  n><span class="p
+00015110: 223e 2c3c 2f73 7061 6e3e 203c 7370 616e  ">,</span> <span
+00015120: 2063 6c61 7373 3d22 6e22 3e64 696d 3c2f   class="n">dim</
+00015130: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+00015140: 3d22 6f22 3e3d 3c2f 7370 616e 3e3c 7370  ="o">=</span><sp
+00015150: 616e 2063 6c61 7373 3d22 6d69 223e 303c  an class="mi">0<
+00015160: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
+00015170: 733d 2270 223e 293c 2f73 7061 6e3e 0a20  s="p">)</span>. 
+00015180: 2020 2020 2020 203c 7370 616e 2063 6c61         <span cla
+00015190: 7373 3d22 6e22 3e67 7261 643c 2f73 7061  ss="n">grad</spa
+000151a0: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
+000151b0: 6f22 3e2b 3d3c 2f73 7061 6e3e 203c 7370  o">+=</span> <sp
+000151c0: 616e 2063 6c61 7373 3d22 6e22 3e74 6f72  an class="n">tor
+000151d0: 6368 3c2f 7370 616e 3e3c 7370 616e 2063  ch</span><span c
+000151e0: 6c61 7373 3d22 6f22 3e2e 3c2f 7370 616e  lass="o">.</span
+000151f0: 3e3c 7370 616e 2063 6c61 7373 3d22 6e22  ><span class="n"
+00015200: 3e73 756d 3c2f 7370 616e 3e3c 7370 616e  >sum</span><span
+00015210: 2063 6c61 7373 3d22 7022 3e28 3c2f 7370   class="p">(</sp
+00015220: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+00015230: 6e22 3e70 3c2f 7370 616e 3e3c 7370 616e  n">p</span><span
+00015240: 2063 6c61 7373 3d22 7022 3e2c 3c2f 7370   class="p">,</sp
+00015250: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
+00015260: 226e 223e 6469 6d3c 2f73 7061 6e3e 3c73  "n">dim</span><s
+00015270: 7061 6e20 636c 6173 733d 226f 223e 3d3c  pan class="o">=<
+00015280: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
+00015290: 733d 226d 6922 3e31 3c2f 7370 616e 3e3c  s="mi">1</span><
+000152a0: 7370 616e 2063 6c61 7373 3d22 7022 3e29  span class="p">)
+000152b0: 3c2f 7370 616e 3e0a 0a20 2020 203c 7370  </span>..    <sp
+000152c0: 616e 2063 6c61 7373 3d22 6e22 3e6c 6f73  an class="n">los
+000152d0: 733c 2f73 7061 6e3e 203c 7370 616e 2063  s</span> <span c
+000152e0: 6c61 7373 3d22 6f22 3e3d 3c2f 7370 616e  lass="o">=</span
+000152f0: 3e20 3c73 7061 6e20 636c 6173 733d 226e  > <span class="n
+00015300: 223e 6c6f 7373 3c2f 7370 616e 3e20 3c73  ">loss</span> <s
+00015310: 7061 6e20 636c 6173 733d 226f 223e 2f3c  pan class="o">/<
+00015320: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
+00015330: 7373 3d22 6e22 3e4e 3c2f 7370 616e 3e0a  ss="n">N</span>.
+00015340: 2020 2020 3c73 7061 6e20 636c 6173 733d      <span class=
+00015350: 226e 223e 6772 6164 3c2f 7370 616e 3e20  "n">grad</span> 
+00015360: 3c73 7061 6e20 636c 6173 733d 226f 223e  <span class="o">
+00015370: 3d3c 2f73 7061 6e3e 203c 7370 616e 2063  =</span> <span c
+00015380: 6c61 7373 3d22 6e22 3e67 7261 643c 2f73  lass="n">grad</s
+00015390: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
+000153a0: 3d22 6f22 3e2f 3c2f 7370 616e 3e20 3c73  ="o">/</span> <s
+000153b0: 7061 6e20 636c 6173 733d 226e 223e 4e3c  pan class="n">N<
+000153c0: 2f73 7061 6e3e 0a20 2020 203c 7370 616e  /span>.    <span
+000153d0: 2063 6c61 7373 3d22 6e22 3e67 7261 643c   class="n">grad<
+000153e0: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
+000153f0: 7373 3d22 6f22 3e3d 3c2f 7370 616e 3e20  ss="o">=</span> 
+00015400: 3c73 7061 6e20 636c 6173 733d 226e 223e  <span class="n">
+00015410: 6772 6164 3c2f 7370 616e 3e3c 7370 616e  grad</span><span
+00015420: 2063 6c61 7373 3d22 7022 3e5b 3c2f 7370   class="p">[</sp
+00015430: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+00015440: 6d69 223e 313c 2f73 7061 6e3e 3c73 7061  mi">1</span><spa
+00015450: 6e20 636c 6173 733d 2270 223e 3a5d 3c2f  n class="p">:]</
+00015460: 7370 616e 3e0a 2020 2020 3c73 7061 6e20  span>.    <span 
+00015470: 636c 6173 733d 226b 223e 7265 7475 726e  class="k">return
+00015480: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
+00015490: 6173 733d 226e 223e 6c6f 7373 3c2f 7370  ass="n">loss</sp
+000154a0: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+000154b0: 7022 3e2c 3c2f 7370 616e 3e20 3c73 7061  p">,</span> <spa
+000154c0: 6e20 636c 6173 733d 226e 223e 6772 6164  n class="n">grad
+000154d0: 3c2f 7370 616e 3e0a 0a0a 3c73 7061 6e20  </span>...<span 
+000154e0: 636c 6173 733d 226b 223e 6465 663c 2f73  class="k">def</s
+000154f0: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
+00015500: 3d22 6e66 223e 5f63 6f6d 7075 7465 5f68  ="nf">_compute_h
+00015510: 6573 7369 616e 5f6c 6f67 5f6c 696b 656c  essian_log_likel
+00015520: 6968 6f6f 645f 6f66 5f46 3c2f 7370 616e  ihood_of_F</span
+00015530: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
+00015540: 3e28 3c2f 7370 616e 3e3c 7370 616e 2063  >(</span><span c
+00015550: 6c61 7373 3d22 6e22 3e46 3c2f 7370 616e  lass="n">F</span
+00015560: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
+00015570: 3e2c 3c2f 7370 616e 3e20 3c73 7061 6e20  >,</span> <span 
+00015580: 636c 6173 733d 226e 223e 656e 6572 6779  class="n">energy
+00015590: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
+000155a0: 7373 3d22 7022 3e2c 3c2f 7370 616e 3e20  ss="p">,</span> 
+000155b0: 3c73 7061 6e20 636c 6173 733d 226e 223e  <span class="n">
+000155c0: 6e75 6d5f 636f 6e66 3c2f 7370 616e 3e3c  num_conf</span><
+000155d0: 7370 616e 2063 6c61 7373 3d22 7022 3e29  span class="p">)
+000155e0: 3a3c 2f73 7061 6e3e 0a20 2020 203c 7370  :</span>.    <sp
+000155f0: 616e 2063 6c61 7373 3d22 6e22 3e75 3c2f  an class="n">u</
+00015600: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
+00015610: 733d 226f 223e 3d3c 2f73 7061 6e3e 203c  s="o">=</span> <
+00015620: 7370 616e 2063 6c61 7373 3d22 6e22 3e65  span class="n">e
+00015630: 6e65 7267 793c 2f73 7061 6e3e 203c 7370  nergy</span> <sp
+00015640: 616e 2063 6c61 7373 3d22 6f22 3e2d 3c2f  an class="o">-</
+00015650: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
+00015660: 733d 226e 223e 463c 2f73 7061 6e3e 3c73  s="n">F</span><s
+00015670: 7061 6e20 636c 6173 733d 2270 223e 5b3a  pan class="p">[:
+00015680: 2c3c 2f73 7061 6e3e 203c 7370 616e 2063  ,</span> <span c
+00015690: 6c61 7373 3d22 6b63 223e 4e6f 6e65 3c2f  lass="kc">None</
+000156a0: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+000156b0: 3d22 7022 3e5d 3c2f 7370 616e 3e20 3c73  ="p">]</span> <s
+000156c0: 7061 6e20 636c 6173 733d 226f 223e 2d3c  pan class="o">-<
+000156d0: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
+000156e0: 7373 3d22 6e22 3e74 6f72 6368 3c2f 7370  ss="n">torch</sp
+000156f0: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+00015700: 6f22 3e2e 3c2f 7370 616e 3e3c 7370 616e  o">.</span><span
+00015710: 2063 6c61 7373 3d22 6e22 3e6c 6f67 3c2f   class="n">log</
+00015720: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+00015730: 3d22 7022 3e28 3c2f 7370 616e 3e3c 7370  ="p">(</span><sp
+00015740: 616e 2063 6c61 7373 3d22 6e22 3e6e 756d  an class="n">num
+00015750: 5f63 6f6e 663c 2f73 7061 6e3e 3c73 7061  _conf</span><spa
+00015760: 6e20 636c 6173 733d 2270 223e 295b 3a2c  n class="p">)[:,
+00015770: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
+00015780: 6173 733d 226b 6322 3e4e 6f6e 653c 2f73  ass="kc">None</s
+00015790: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
+000157a0: 2270 223e 5d3c 2f73 7061 6e3e 0a20 2020  "p">]</span>.   
+000157b0: 203c 7370 616e 2063 6c61 7373 3d22 6e22   <span class="n"
+000157c0: 3e70 3c2f 7370 616e 3e20 3c73 7061 6e20  >p</span> <span 
+000157d0: 636c 6173 733d 226f 223e 3d3c 2f73 7061  class="o">=</spa
+000157e0: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
+000157f0: 6e22 3e74 6f72 6368 3c2f 7370 616e 3e3c  n">torch</span><
+00015800: 7370 616e 2063 6c61 7373 3d22 6f22 3e2e  span class="o">.
+00015810: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
+00015820: 7373 3d22 6e22 3e73 6f66 746d 6178 3c2f  ss="n">softmax</
+00015830: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+00015840: 3d22 7022 3e28 3c2f 7370 616e 3e3c 7370  ="p">(</span><sp
+00015850: 616e 2063 6c61 7373 3d22 6f22 3e2d 3c2f  an class="o">-</
+00015860: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+00015870: 3d22 6e22 3e75 3c2f 7370 616e 3e3c 7370  ="n">u</span><sp
+00015880: 616e 2063 6c61 7373 3d22 7022 3e2c 3c2f  an class="p">,</
+00015890: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
+000158a0: 733d 226e 223e 6469 6d3c 2f73 7061 6e3e  s="n">dim</span>
+000158b0: 3c73 7061 6e20 636c 6173 733d 226f 223e  <span class="o">
+000158c0: 3d3c 2f73 7061 6e3e 3c73 7061 6e20 636c  =</span><span cl
+000158d0: 6173 733d 226d 6922 3e30 3c2f 7370 616e  ass="mi">0</span
+000158e0: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
+000158f0: 3e29 3c2f 7370 616e 3e0a 2020 2020 3c73  >)</span>.    <s
+00015900: 7061 6e20 636c 6173 733d 226e 223e 7070  pan class="n">pp
+00015910: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
+00015920: 6173 733d 226f 223e 3d3c 2f73 7061 6e3e  ass="o">=</span>
+00015930: 203c 7370 616e 2063 6c61 7373 3d22 6e22   <span class="n"
+00015940: 3e74 6f72 6368 3c2f 7370 616e 3e3c 7370  >torch</span><sp
+00015950: 616e 2063 6c61 7373 3d22 6f22 3e2e 3c2f  an class="o">.</
+00015960: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+00015970: 3d22 6e22 3e6d 6174 6d75 6c3c 2f73 7061  ="n">matmul</spa
+00015980: 6e3e 3c73 7061 6e20 636c 6173 733d 2270  n><span class="p
+00015990: 223e 283c 2f73 7061 6e3e 3c73 7061 6e20  ">(</span><span 
+000159a0: 636c 6173 733d 226e 223e 703c 2f73 7061  class="n">p</spa
+000159b0: 6e3e 3c73 7061 6e20 636c 6173 733d 2270  n><span class="p
+000159c0: 223e 2c3c 2f73 7061 6e3e 203c 7370 616e  ">,</span> <span
+000159d0: 2063 6c61 7373 3d22 6e22 3e70 3c2f 7370   class="n">p</sp
+000159e0: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+000159f0: 6f22 3e2e 3c2f 7370 616e 3e3c 7370 616e  o">.</span><span
+00015a00: 2063 6c61 7373 3d22 6e22 3e54 3c2f 7370   class="n">T</sp
+00015a10: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+00015a20: 7022 3e29 3c2f 7370 616e 3e0a 2020 2020  p">)</span>.    
+00015a30: 3c73 7061 6e20 636c 6173 733d 226e 223e  <span class="n">
+00015a40: 483c 2f73 7061 6e3e 203c 7370 616e 2063  H</span> <span c
+00015a50: 6c61 7373 3d22 6f22 3e3d 3c2f 7370 616e  lass="o">=</span
+00015a60: 3e20 3c73 7061 6e20 636c 6173 733d 226e  > <span class="n
+00015a70: 223e 7070 3c2f 7370 616e 3e20 3c73 7061  ">pp</span> <spa
+00015a80: 6e20 636c 6173 733d 226f 223e 2d3c 2f73  n class="o">-</s
+00015a90: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
+00015aa0: 3d22 6e22 3e74 6f72 6368 3c2f 7370 616e  ="n">torch</span
+00015ab0: 3e3c 7370 616e 2063 6c61 7373 3d22 6f22  ><span class="o"
+00015ac0: 3e2e 3c2f 7370 616e 3e3c 7370 616e 2063  >.</span><span c
+00015ad0: 6c61 7373 3d22 6e22 3e64 6961 673c 2f73  lass="n">diag</s
+00015ae0: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
+00015af0: 2270 223e 283c 2f73 7061 6e3e 3c73 7061  "p">(</span><spa
+00015b00: 6e20 636c 6173 733d 226e 223e 746f 7263  n class="n">torc
+00015b10: 683c 2f73 7061 6e3e 3c73 7061 6e20 636c  h</span><span cl
+00015b20: 6173 733d 226f 223e 2e3c 2f73 7061 6e3e  ass="o">.</span>
+00015b30: 3c73 7061 6e20 636c 6173 733d 226e 223e  <span class="n">
+00015b40: 7375 6d3c 2f73 7061 6e3e 3c73 7061 6e20  sum</span><span 
+00015b50: 636c 6173 733d 2270 223e 283c 2f73 7061  class="p">(</spa
+00015b60: 6e3e 3c73 7061 6e20 636c 6173 733d 226e  n><span class="n
+00015b70: 223e 703c 2f73 7061 6e3e 3c73 7061 6e20  ">p</span><span 
+00015b80: 636c 6173 733d 2270 223e 2c3c 2f73 7061  class="p">,</spa
+00015b90: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
+00015ba0: 6d69 223e 313c 2f73 7061 6e3e 3c73 7061  mi">1</span><spa
+00015bb0: 6e20 636c 6173 733d 2270 223e 2929 3c2f  n class="p">))</
+00015bc0: 7370 616e 3e0a 2020 2020 3c73 7061 6e20  span>.    <span 
+00015bd0: 636c 6173 733d 226b 223e 7265 7475 726e  class="k">return
+00015be0: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
+00015bf0: 6173 733d 226e 223e 483c 2f73 7061 6e3e  ass="n">H</span>
+00015c00: 0a0a 0a3c 7370 616e 2063 6c61 7373 3d22  ...<span class="
+00015c10: 6b22 3e64 6566 3c2f 7370 616e 3e20 3c73  k">def</span> <s
+00015c20: 7061 6e20 636c 6173 733d 226e 6622 3e5f  pan class="nf">_
+00015c30: 636f 6d70 7574 655f 6865 7373 6961 6e5f  compute_hessian_
+00015c40: 6c6f 675f 6c69 6b65 6c69 686f 6f64 5f6f  log_likelihood_o
+00015c50: 665f 465f 696e 5f62 6174 6368 3c2f 7370  f_F_in_batch</sp
+00015c60: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+00015c70: 7022 3e28 3c2f 7370 616e 3e3c 7370 616e  p">(</span><span
+00015c80: 2063 6c61 7373 3d22 6e22 3e46 3c2f 7370   class="n">F</sp
+00015c90: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+00015ca0: 7022 3e2c 3c2f 7370 616e 3e20 3c73 7061  p">,</span> <spa
+00015cb0: 6e20 636c 6173 733d 226e 223e 656e 6572  n class="n">ener
+00015cc0: 6779 3c2f 7370 616e 3e3c 7370 616e 2063  gy</span><span c
+00015cd0: 6c61 7373 3d22 7022 3e2c 3c2f 7370 616e  lass="p">,</span
+00015ce0: 3e20 3c73 7061 6e20 636c 6173 733d 226e  > <span class="n
+00015cf0: 223e 6e75 6d5f 636f 6e66 3c2f 7370 616e  ">num_conf</span
+00015d00: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
+00015d10: 3e2c 3c2f 7370 616e 3e20 3c73 7061 6e20  >,</span> <span 
+00015d20: 636c 6173 733d 226e 223e 6261 7463 685f  class="n">batch_
+00015d30: 7369 7a65 3c2f 7370 616e 3e3c 7370 616e  size</span><span
+00015d40: 2063 6c61 7373 3d22 7022 3e3a 3c2f 7370   class="p">:</sp
+00015d50: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
+00015d60: 226e 6222 3e69 6e74 3c2f 7370 616e 3e3c  "nb">int</span><
+00015d70: 7370 616e 2063 6c61 7373 3d22 7022 3e29  span class="p">)
+00015d80: 3a3c 2f73 7061 6e3e 0a20 2020 203c 7370  :</span>.    <sp
+00015d90: 616e 2063 6c61 7373 3d22 6b22 3e69 663c  an class="k">if<
+00015da0: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
+00015db0: 7373 3d22 6e22 3e65 6e65 7267 793c 2f73  ss="n">energy</s
+00015dc0: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
+00015dd0: 226f 223e 2e3c 2f73 7061 6e3e 3c73 7061  "o">.</span><spa
+00015de0: 6e20 636c 6173 733d 226e 223e 7368 6170  n class="n">shap
+00015df0: 653c 2f73 7061 6e3e 3c73 7061 6e20 636c  e</span><span cl
+00015e00: 6173 733d 2270 223e 5b3c 2f73 7061 6e3e  ass="p">[</span>
+00015e10: 3c73 7061 6e20 636c 6173 733d 226d 6922  <span class="mi"
+00015e20: 3e31 3c2f 7370 616e 3e3c 7370 616e 2063  >1</span><span c
+00015e30: 6c61 7373 3d22 7022 3e5d 3c2f 7370 616e  lass="p">]</span
+00015e40: 3e20 3c73 7061 6e20 636c 6173 733d 226f  > <span class="o
+00015e50: 223e 253c 2f73 7061 6e3e 203c 7370 616e  ">%</span> <span
+00015e60: 2063 6c61 7373 3d22 6e22 3e62 6174 6368   class="n">batch
+00015e70: 5f73 697a 653c 2f73 7061 6e3e 203c 7370  _size</span> <sp
+00015e80: 616e 2063 6c61 7373 3d22 6f22 3e3d 3d3c  an class="o">==<
+00015e90: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
+00015ea0: 7373 3d22 6d69 223e 303c 2f73 7061 6e3e  ss="mi">0</span>
+00015eb0: 3c73 7061 6e20 636c 6173 733d 2270 223e  <span class="p">
+00015ec0: 3a3c 2f73 7061 6e3e 0a20 2020 2020 2020  :</span>.       
+00015ed0: 203c 7370 616e 2063 6c61 7373 3d22 6e22   <span class="n"
+00015ee0: 3e6e 756d 5f62 6174 6368 3c2f 7370 616e  >num_batch</span
+00015ef0: 3e20 3c73 7061 6e20 636c 6173 733d 226f  > <span class="o
+00015f00: 223e 3d3c 2f73 7061 6e3e 203c 7370 616e  ">=</span> <span
+00015f10: 2063 6c61 7373 3d22 6e22 3e65 6e65 7267   class="n">energ
+00015f20: 793c 2f73 7061 6e3e 3c73 7061 6e20 636c  y</span><span cl
+00015f30: 6173 733d 226f 223e 2e3c 2f73 7061 6e3e  ass="o">.</span>
+00015f40: 3c73 7061 6e20 636c 6173 733d 226e 223e  <span class="n">
+00015f50: 7368 6170 653c 2f73 7061 6e3e 3c73 7061  shape</span><spa
+00015f60: 6e20 636c 6173 733d 2270 223e 5b3c 2f73  n class="p">[</s
+00015f70: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
+00015f80: 226d 6922 3e31 3c2f 7370 616e 3e3c 7370  "mi">1</span><sp
+00015f90: 616e 2063 6c61 7373 3d22 7022 3e5d 3c2f  an class="p">]</
+00015fa0: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
+00015fb0: 733d 226f 223e 2f2f 3c2f 7370 616e 3e20  s="o">//</span> 
+00015fc0: 3c73 7061 6e20 636c 6173 733d 226e 223e  <span class="n">
+00015fd0: 6261 7463 685f 7369 7a65 3c2f 7370 616e  batch_size</span
+00015fe0: 3e0a 2020 2020 3c73 7061 6e20 636c 6173  >.    <span clas
+00015ff0: 733d 226b 223e 656c 7365 3c2f 7370 616e  s="k">else</span
+00016000: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
+00016010: 3e3a 3c2f 7370 616e 3e0a 2020 2020 2020  >:</span>.      
+00016020: 2020 3c73 7061 6e20 636c 6173 733d 226e    <span class="n
+00016030: 223e 6e75 6d5f 6261 7463 683c 2f73 7061  ">num_batch</spa
+00016040: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
+00016050: 6f22 3e3d 3c2f 7370 616e 3e20 3c73 7061  o">=</span> <spa
+00016060: 6e20 636c 6173 733d 226e 223e 656e 6572  n class="n">ener
+00016070: 6779 3c2f 7370 616e 3e3c 7370 616e 2063  gy</span><span c
+00016080: 6c61 7373 3d22 6f22 3e2e 3c2f 7370 616e  lass="o">.</span
+00016090: 3e3c 7370 616e 2063 6c61 7373 3d22 6e22  ><span class="n"
+000160a0: 3e73 6861 7065 3c2f 7370 616e 3e3c 7370  >shape</span><sp
+000160b0: 616e 2063 6c61 7373 3d22 7022 3e5b 3c2f  an class="p">[</
+000160c0: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+000160d0: 3d22 6d69 223e 313c 2f73 7061 6e3e 3c73  ="mi">1</span><s
+000160e0: 7061 6e20 636c 6173 733d 2270 223e 5d3c  pan class="p">]<
+000160f0: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
+00016100: 7373 3d22 6f22 3e2f 2f3c 2f73 7061 6e3e  ss="o">//</span>
+00016110: 203c 7370 616e 2063 6c61 7373 3d22 6e22   <span class="n"
+00016120: 3e62 6174 6368 5f73 697a 653c 2f73 7061  >batch_size</spa
 00016130: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
-00016140: 6e22 3e46 3c2f 7370 616e 3e3c 7370 616e  n">F</span><span
-00016150: 2063 6c61 7373 3d22 6f22 3e2e 3c2f 7370   class="o">.</sp
-00016160: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-00016170: 6e22 3e6e 6577 5f7a 6572 6f73 3c2f 7370  n">new_zeros</sp
-00016180: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-00016190: 7022 3e28 283c 2f73 7061 6e3e 3c73 7061  p">((</span><spa
-000161a0: 6e20 636c 6173 733d 226e 223e 463c 2f73  n class="n">F</s
-000161b0: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
-000161c0: 226f 223e 2e3c 2f73 7061 6e3e 3c73 7061  "o">.</span><spa
-000161d0: 6e20 636c 6173 733d 226e 223e 7368 6170  n class="n">shap
-000161e0: 653c 2f73 7061 6e3e 3c73 7061 6e20 636c  e</span><span cl
-000161f0: 6173 733d 2270 223e 5b3c 2f73 7061 6e3e  ass="p">[</span>
-00016200: 3c73 7061 6e20 636c 6173 733d 226d 6922  <span class="mi"
-00016210: 3e30 3c2f 7370 616e 3e3c 7370 616e 2063  >0</span><span c
-00016220: 6c61 7373 3d22 7022 3e5d 2c3c 2f73 7061  lass="p">],</spa
-00016230: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
-00016240: 6e22 3e46 3c2f 7370 616e 3e3c 7370 616e  n">F</span><span
-00016250: 2063 6c61 7373 3d22 6f22 3e2e 3c2f 7370   class="o">.</sp
-00016260: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-00016270: 6e22 3e73 6861 7065 3c2f 7370 616e 3e3c  n">shape</span><
-00016280: 7370 616e 2063 6c61 7373 3d22 7022 3e5b  span class="p">[
-00016290: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-000162a0: 7373 3d22 6d69 223e 303c 2f73 7061 6e3e  ss="mi">0</span>
-000162b0: 3c73 7061 6e20 636c 6173 733d 2270 223e  <span class="p">
-000162c0: 5d29 293c 2f73 7061 6e3e 3c73 7061 6e20  ]))</span><span 
-000162d0: 636c 6173 733d 226f 223e 2e3c 2f73 7061  class="o">.</spa
-000162e0: 6e3e 3c73 7061 6e20 636c 6173 733d 226e  n><span class="n
-000162f0: 223e 6375 6461 3c2f 7370 616e 3e3c 7370  ">cuda</span><sp
-00016300: 616e 2063 6c61 7373 3d22 7022 3e28 293c  an class="p">()<
-00016310: 2f73 7061 6e3e 0a20 2020 203c 7370 616e  /span>.    <span
-00016320: 2063 6c61 7373 3d22 6b22 3e66 6f72 3c2f   class="k">for</
-00016330: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
-00016340: 733d 226e 223e 693c 2f73 7061 6e3e 203c  s="n">i</span> <
-00016350: 7370 616e 2063 6c61 7373 3d22 6f77 223e  span class="ow">
-00016360: 696e 3c2f 7370 616e 3e20 3c73 7061 6e20  in</span> <span 
-00016370: 636c 6173 733d 226e 6222 3e72 616e 6765  class="nb">range
-00016380: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-00016390: 7373 3d22 7022 3e28 3c2f 7370 616e 3e3c  ss="p">(</span><
-000163a0: 7370 616e 2063 6c61 7373 3d22 6e22 3e6e  span class="n">n
-000163b0: 756d 5f62 6174 6368 3c2f 7370 616e 3e3c  um_batch</span><
-000163c0: 7370 616e 2063 6c61 7373 3d22 7022 3e29  span class="p">)
-000163d0: 3a3c 2f73 7061 6e3e 0a20 2020 2020 2020  :</span>.       
-000163e0: 203c 7370 616e 2063 6c61 7373 3d22 6e22   <span class="n"
-000163f0: 3e65 6e65 7267 795f 6261 7463 683c 2f73  >energy_batch</s
-00016400: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
-00016410: 3d22 6f22 3e3d 3c2f 7370 616e 3e20 3c73  ="o">=</span> <s
-00016420: 7061 6e20 636c 6173 733d 226e 223e 656e  pan class="n">en
-00016430: 6572 6779 3c2f 7370 616e 3e3c 7370 616e  ergy</span><span
-00016440: 2063 6c61 7373 3d22 7022 3e5b 3a2c 3c2f   class="p">[:,</
-00016450: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
-00016460: 733d 226e 223e 693c 2f73 7061 6e3e 203c  s="n">i</span> <
-00016470: 7370 616e 2063 6c61 7373 3d22 6f22 3e2a  span class="o">*
+00016140: 6f22 3e2b 3c2f 7370 616e 3e20 3c73 7061  o">+</span> <spa
+00016150: 6e20 636c 6173 733d 226d 6922 3e31 3c2f  n class="mi">1</
+00016160: 7370 616e 3e0a 0a20 2020 203c 7370 616e  span>..    <span
+00016170: 2063 6c61 7373 3d22 6e22 3e48 3c2f 7370   class="n">H</sp
+00016180: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
+00016190: 226f 223e 3d3c 2f73 7061 6e3e 203c 7370  "o">=</span> <sp
+000161a0: 616e 2063 6c61 7373 3d22 6e22 3e46 3c2f  an class="n">F</
+000161b0: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+000161c0: 3d22 6f22 3e2e 3c2f 7370 616e 3e3c 7370  ="o">.</span><sp
+000161d0: 616e 2063 6c61 7373 3d22 6e22 3e6e 6577  an class="n">new
+000161e0: 5f7a 6572 6f73 3c2f 7370 616e 3e3c 7370  _zeros</span><sp
+000161f0: 616e 2063 6c61 7373 3d22 7022 3e28 283c  an class="p">((<
+00016200: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
+00016210: 733d 226e 223e 463c 2f73 7061 6e3e 3c73  s="n">F</span><s
+00016220: 7061 6e20 636c 6173 733d 226f 223e 2e3c  pan class="o">.<
+00016230: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
+00016240: 733d 226e 223e 7368 6170 653c 2f73 7061  s="n">shape</spa
+00016250: 6e3e 3c73 7061 6e20 636c 6173 733d 2270  n><span class="p
+00016260: 223e 5b3c 2f73 7061 6e3e 3c73 7061 6e20  ">[</span><span 
+00016270: 636c 6173 733d 226d 6922 3e30 3c2f 7370  class="mi">0</sp
+00016280: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+00016290: 7022 3e5d 2c3c 2f73 7061 6e3e 203c 7370  p">],</span> <sp
+000162a0: 616e 2063 6c61 7373 3d22 6e22 3e46 3c2f  an class="n">F</
+000162b0: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+000162c0: 3d22 6f22 3e2e 3c2f 7370 616e 3e3c 7370  ="o">.</span><sp
+000162d0: 616e 2063 6c61 7373 3d22 6e22 3e73 6861  an class="n">sha
+000162e0: 7065 3c2f 7370 616e 3e3c 7370 616e 2063  pe</span><span c
+000162f0: 6c61 7373 3d22 7022 3e5b 3c2f 7370 616e  lass="p">[</span
+00016300: 3e3c 7370 616e 2063 6c61 7373 3d22 6d69  ><span class="mi
+00016310: 223e 303c 2f73 7061 6e3e 3c73 7061 6e20  ">0</span><span 
+00016320: 636c 6173 733d 2270 223e 5d29 293c 2f73  class="p">]))</s
+00016330: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
+00016340: 226f 223e 2e3c 2f73 7061 6e3e 3c73 7061  "o">.</span><spa
+00016350: 6e20 636c 6173 733d 226e 223e 6375 6461  n class="n">cuda
+00016360: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
+00016370: 7373 3d22 7022 3e28 293c 2f73 7061 6e3e  ss="p">()</span>
+00016380: 0a20 2020 203c 7370 616e 2063 6c61 7373  .    <span class
+00016390: 3d22 6b22 3e66 6f72 3c2f 7370 616e 3e20  ="k">for</span> 
+000163a0: 3c73 7061 6e20 636c 6173 733d 226e 223e  <span class="n">
+000163b0: 693c 2f73 7061 6e3e 203c 7370 616e 2063  i</span> <span c
+000163c0: 6c61 7373 3d22 6f77 223e 696e 3c2f 7370  lass="ow">in</sp
+000163d0: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
+000163e0: 226e 6222 3e72 616e 6765 3c2f 7370 616e  "nb">range</span
+000163f0: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
+00016400: 3e28 3c2f 7370 616e 3e3c 7370 616e 2063  >(</span><span c
+00016410: 6c61 7373 3d22 6e22 3e6e 756d 5f62 6174  lass="n">num_bat
+00016420: 6368 3c2f 7370 616e 3e3c 7370 616e 2063  ch</span><span c
+00016430: 6c61 7373 3d22 7022 3e29 3a3c 2f73 7061  lass="p">):</spa
+00016440: 6e3e 0a20 2020 2020 2020 203c 7370 616e  n>.        <span
+00016450: 2063 6c61 7373 3d22 6e22 3e65 6e65 7267   class="n">energ
+00016460: 795f 6261 7463 683c 2f73 7061 6e3e 203c  y_batch</span> <
+00016470: 7370 616e 2063 6c61 7373 3d22 6f22 3e3d  span class="o">=
 00016480: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
-00016490: 6173 733d 226e 223e 6261 7463 685f 7369  ass="n">batch_si
-000164a0: 7a65 3c2f 7370 616e 3e20 3c73 7061 6e20  ze</span> <span 
-000164b0: 636c 6173 733d 2270 223e 3a3c 2f73 7061  class="p">:</spa
-000164c0: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
-000164d0: 7022 3e28 3c2f 7370 616e 3e3c 7370 616e  p">(</span><span
-000164e0: 2063 6c61 7373 3d22 6e22 3e69 3c2f 7370   class="n">i</sp
-000164f0: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
-00016500: 226f 223e 2b3c 2f73 7061 6e3e 203c 7370  "o">+</span> <sp
-00016510: 616e 2063 6c61 7373 3d22 6d69 223e 313c  an class="mi">1<
-00016520: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
-00016530: 733d 2270 223e 293c 2f73 7061 6e3e 203c  s="p">)</span> <
-00016540: 7370 616e 2063 6c61 7373 3d22 6f22 3e2a  span class="o">*
-00016550: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
-00016560: 6173 733d 226e 223e 6261 7463 685f 7369  ass="n">batch_si
-00016570: 7a65 3c2f 7370 616e 3e3c 7370 616e 2063  ze</span><span c
-00016580: 6c61 7373 3d22 7022 3e5d 3c2f 7370 616e  lass="p">]</span
-00016590: 3e0a 2020 2020 2020 2020 3c73 7061 6e20  >.        <span 
-000165a0: 636c 6173 733d 226e 223e 753c 2f73 7061  class="n">u</spa
-000165b0: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
-000165c0: 6f22 3e3d 3c2f 7370 616e 3e20 3c73 7061  o">=</span> <spa
-000165d0: 6e20 636c 6173 733d 226e 223e 656e 6572  n class="n">ener
-000165e0: 6779 5f62 6174 6368 3c2f 7370 616e 3e3c  gy_batch</span><
-000165f0: 7370 616e 2063 6c61 7373 3d22 6f22 3e2e  span class="o">.
-00016600: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-00016610: 7373 3d22 6e22 3e63 7564 613c 2f73 7061  ss="n">cuda</spa
-00016620: 6e3e 3c73 7061 6e20 636c 6173 733d 2270  n><span class="p
-00016630: 223e 2829 3c2f 7370 616e 3e20 3c73 7061  ">()</span> <spa
-00016640: 6e20 636c 6173 733d 226f 223e 2d3c 2f73  n class="o">-</s
-00016650: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
-00016660: 3d22 6e22 3e46 3c2f 7370 616e 3e3c 7370  ="n">F</span><sp
-00016670: 616e 2063 6c61 7373 3d22 7022 3e5b 3a2c  an class="p">[:,
-00016680: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
-00016690: 6173 733d 226b 6322 3e4e 6f6e 653c 2f73  ass="kc">None</s
-000166a0: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
-000166b0: 2270 223e 5d3c 2f73 7061 6e3e 203c 7370  "p">]</span> <sp
-000166c0: 616e 2063 6c61 7373 3d22 6f22 3e2d 3c2f  an class="o">-</
-000166d0: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
-000166e0: 733d 226e 223e 746f 7263 683c 2f73 7061  s="n">torch</spa
-000166f0: 6e3e 3c73 7061 6e20 636c 6173 733d 226f  n><span class="o
-00016700: 223e 2e3c 2f73 7061 6e3e 3c73 7061 6e20  ">.</span><span 
-00016710: 636c 6173 733d 226e 223e 6c6f 673c 2f73  class="n">log</s
-00016720: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
-00016730: 2270 223e 283c 2f73 7061 6e3e 3c73 7061  "p">(</span><spa
-00016740: 6e20 636c 6173 733d 226e 223e 6e75 6d5f  n class="n">num_
-00016750: 636f 6e66 3c2f 7370 616e 3e3c 7370 616e  conf</span><span
-00016760: 2063 6c61 7373 3d22 7022 3e29 5b3a 2c3c   class="p">)[:,<
-00016770: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
-00016780: 7373 3d22 6b63 223e 4e6f 6e65 3c2f 7370  ss="kc">None</sp
-00016790: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-000167a0: 7022 3e5d 3c2f 7370 616e 3e0a 0a20 2020  p">]</span>..   
-000167b0: 2020 2020 203c 7370 616e 2063 6c61 7373       <span class
-000167c0: 3d22 6e22 3e70 3c2f 7370 616e 3e20 3c73  ="n">p</span> <s
-000167d0: 7061 6e20 636c 6173 733d 226f 223e 3d3c  pan class="o">=<
-000167e0: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
-000167f0: 7373 3d22 6e22 3e74 6f72 6368 3c2f 7370  ss="n">torch</sp
-00016800: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-00016810: 6f22 3e2e 3c2f 7370 616e 3e3c 7370 616e  o">.</span><span
-00016820: 2063 6c61 7373 3d22 6e22 3e73 6f66 746d   class="n">softm
-00016830: 6178 3c2f 7370 616e 3e3c 7370 616e 2063  ax</span><span c
-00016840: 6c61 7373 3d22 7022 3e28 3c2f 7370 616e  lass="p">(</span
-00016850: 3e3c 7370 616e 2063 6c61 7373 3d22 6f22  ><span class="o"
-00016860: 3e2d 3c2f 7370 616e 3e3c 7370 616e 2063  >-</span><span c
-00016870: 6c61 7373 3d22 6e22 3e75 3c2f 7370 616e  lass="n">u</span
-00016880: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
-00016890: 3e2c 3c2f 7370 616e 3e20 3c73 7061 6e20  >,</span> <span 
-000168a0: 636c 6173 733d 226e 223e 6469 6d3c 2f73  class="n">dim</s
-000168b0: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
-000168c0: 226f 223e 3d3c 2f73 7061 6e3e 3c73 7061  "o">=</span><spa
-000168d0: 6e20 636c 6173 733d 226d 6922 3e30 3c2f  n class="mi">0</
-000168e0: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
-000168f0: 3d22 7022 3e29 3c2f 7370 616e 3e0a 2020  ="p">)</span>.  
-00016900: 2020 2020 2020 3c73 7061 6e20 636c 6173        <span clas
-00016910: 733d 226e 223e 7070 3c2f 7370 616e 3e20  s="n">pp</span> 
-00016920: 3c73 7061 6e20 636c 6173 733d 226f 223e  <span class="o">
-00016930: 3d3c 2f73 7061 6e3e 203c 7370 616e 2063  =</span> <span c
-00016940: 6c61 7373 3d22 6e22 3e74 6f72 6368 3c2f  lass="n">torch</
-00016950: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
-00016960: 3d22 6f22 3e2e 3c2f 7370 616e 3e3c 7370  ="o">.</span><sp
-00016970: 616e 2063 6c61 7373 3d22 6e22 3e6d 6174  an class="n">mat
-00016980: 6d75 6c3c 2f73 7061 6e3e 3c73 7061 6e20  mul</span><span 
-00016990: 636c 6173 733d 2270 223e 283c 2f73 7061  class="p">(</spa
-000169a0: 6e3e 3c73 7061 6e20 636c 6173 733d 226e  n><span class="n
-000169b0: 223e 703c 2f73 7061 6e3e 3c73 7061 6e20  ">p</span><span 
-000169c0: 636c 6173 733d 2270 223e 2c3c 2f73 7061  class="p">,</spa
-000169d0: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
-000169e0: 6e22 3e70 3c2f 7370 616e 3e3c 7370 616e  n">p</span><span
-000169f0: 2063 6c61 7373 3d22 6f22 3e2e 3c2f 7370   class="o">.</sp
-00016a00: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-00016a10: 6e22 3e54 3c2f 7370 616e 3e3c 7370 616e  n">T</span><span
-00016a20: 2063 6c61 7373 3d22 7022 3e29 3c2f 7370   class="p">)</sp
-00016a30: 616e 3e0a 2020 2020 2020 2020 3c73 7061  an>.        <spa
-00016a40: 6e20 636c 6173 733d 226e 223e 483c 2f73  n class="n">H</s
-00016a50: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
-00016a60: 3d22 6f22 3e2b 3d3c 2f73 7061 6e3e 203c  ="o">+=</span> <
-00016a70: 7370 616e 2063 6c61 7373 3d22 6e22 3e70  span class="n">p
-00016a80: 703c 2f73 7061 6e3e 203c 7370 616e 2063  p</span> <span c
-00016a90: 6c61 7373 3d22 6f22 3e2d 3c2f 7370 616e  lass="o">-</span
-00016aa0: 3e20 3c73 7061 6e20 636c 6173 733d 226e  > <span class="n
-00016ab0: 223e 746f 7263 683c 2f73 7061 6e3e 3c73  ">torch</span><s
-00016ac0: 7061 6e20 636c 6173 733d 226f 223e 2e3c  pan class="o">.<
-00016ad0: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
-00016ae0: 733d 226e 223e 6469 6167 3c2f 7370 616e  s="n">diag</span
-00016af0: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
-00016b00: 3e28 3c2f 7370 616e 3e3c 7370 616e 2063  >(</span><span c
-00016b10: 6c61 7373 3d22 6e22 3e74 6f72 6368 3c2f  lass="n">torch</
-00016b20: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
-00016b30: 3d22 6f22 3e2e 3c2f 7370 616e 3e3c 7370  ="o">.</span><sp
-00016b40: 616e 2063 6c61 7373 3d22 6e22 3e73 756d  an class="n">sum
-00016b50: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-00016b60: 7373 3d22 7022 3e28 3c2f 7370 616e 3e3c  ss="p">(</span><
-00016b70: 7370 616e 2063 6c61 7373 3d22 6e22 3e70  span class="n">p
-00016b80: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-00016b90: 7373 3d22 7022 3e2c 3c2f 7370 616e 3e20  ss="p">,</span> 
-00016ba0: 3c73 7061 6e20 636c 6173 733d 226d 6922  <span class="mi"
-00016bb0: 3e31 3c2f 7370 616e 3e3c 7370 616e 2063  >1</span><span c
-00016bc0: 6c61 7373 3d22 7022 3e29 293c 2f73 7061  lass="p">))</spa
-00016bd0: 6e3e 0a0a 2020 2020 3c73 7061 6e20 636c  n>..    <span cl
-00016be0: 6173 733d 226b 223e 7265 7475 726e 3c2f  ass="k">return</
-00016bf0: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
-00016c00: 733d 226e 223e 483c 2f73 7061 6e3e 0a0a  s="n">H</span>..
-00016c10: 0a3c 7370 616e 2063 6c61 7373 3d22 6b22  .<span class="k"
-00016c20: 3e64 6566 3c2f 7370 616e 3e20 3c73 7061  >def</span> <spa
-00016c30: 6e20 636c 6173 733d 226e 6622 3e5f 636f  n class="nf">_co
-00016c40: 6d70 7574 655f 6865 7373 6961 6e5f 6c6f  mpute_hessian_lo
-00016c50: 7373 5f6f 665f 6446 3c2f 7370 616e 3e3c  ss_of_dF</span><
-00016c60: 7370 616e 2063 6c61 7373 3d22 7022 3e28  span class="p">(
-00016c70: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-00016c80: 7373 3d22 6e22 3e64 463c 2f73 7061 6e3e  ss="n">dF</span>
-00016c90: 3c73 7061 6e20 636c 6173 733d 2270 223e  <span class="p">
-00016ca0: 2c3c 2f73 7061 6e3e 203c 7370 616e 2063  ,</span> <span c
-00016cb0: 6c61 7373 3d22 6e22 3e65 6e65 7267 793c  lass="n">energy<
-00016cc0: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
-00016cd0: 733d 2270 223e 2c3c 2f73 7061 6e3e 203c  s="p">,</span> <
-00016ce0: 7370 616e 2063 6c61 7373 3d22 6e22 3e6e  span class="n">n
-00016cf0: 756d 5f63 6f6e 663c 2f73 7061 6e3e 3c73  um_conf</span><s
-00016d00: 7061 6e20 636c 6173 733d 2270 223e 293a  pan class="p">):
-00016d10: 3c2f 7370 616e 3e0a 2020 2020 3c73 7061  </span>.    <spa
-00016d20: 6e20 636c 6173 733d 226e 223e 4e3c 2f73  n class="n">N</s
-00016d30: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
-00016d40: 3d22 6f22 3e3d 3c2f 7370 616e 3e20 3c73  ="o">=</span> <s
-00016d50: 7061 6e20 636c 6173 733d 226e 223e 746f  pan class="n">to
-00016d60: 7263 683c 2f73 7061 6e3e 3c73 7061 6e20  rch</span><span 
-00016d70: 636c 6173 733d 226f 223e 2e3c 2f73 7061  class="o">.</spa
-00016d80: 6e3e 3c73 7061 6e20 636c 6173 733d 226e  n><span class="n
-00016d90: 223e 7375 6d3c 2f73 7061 6e3e 3c73 7061  ">sum</span><spa
-00016da0: 6e20 636c 6173 733d 2270 223e 283c 2f73  n class="p">(</s
-00016db0: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
-00016dc0: 226e 223e 6e75 6d5f 636f 6e66 3c2f 7370  "n">num_conf</sp
-00016dd0: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-00016de0: 7022 3e29 3c2f 7370 616e 3e0a 2020 2020  p">)</span>.    
-00016df0: 3c73 7061 6e20 636c 6173 733d 226e 223e  <span class="n">
-00016e00: 463c 2f73 7061 6e3e 203c 7370 616e 2063  F</span> <span c
-00016e10: 6c61 7373 3d22 6f22 3e3d 3c2f 7370 616e  lass="o">=</span
-00016e20: 3e20 3c73 7061 6e20 636c 6173 733d 226e  > <span class="n
-00016e30: 223e 746f 7263 683c 2f73 7061 6e3e 3c73  ">torch</span><s
-00016e40: 7061 6e20 636c 6173 733d 226f 223e 2e3c  pan class="o">.<
-00016e50: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
-00016e60: 733d 226e 223e 6361 743c 2f73 7061 6e3e  s="n">cat</span>
-00016e70: 3c73 7061 6e20 636c 6173 733d 2270 223e  <span class="p">
-00016e80: 285b 3c2f 7370 616e 3e3c 7370 616e 2063  ([</span><span c
-00016e90: 6c61 7373 3d22 6e22 3e64 463c 2f73 7061  lass="n">dF</spa
-00016ea0: 6e3e 3c73 7061 6e20 636c 6173 733d 226f  n><span class="o
-00016eb0: 223e 2e3c 2f73 7061 6e3e 3c73 7061 6e20  ">.</span><span 
-00016ec0: 636c 6173 733d 226e 223e 6e65 775f 7a65  class="n">new_ze
-00016ed0: 726f 733c 2f73 7061 6e3e 3c73 7061 6e20  ros</span><span 
-00016ee0: 636c 6173 733d 2270 223e 283c 2f73 7061  class="p">(</spa
-00016ef0: 6e3e 3c73 7061 6e20 636c 6173 733d 226d  n><span class="m
-00016f00: 6922 3e31 3c2f 7370 616e 3e3c 7370 616e  i">1</span><span
-00016f10: 2063 6c61 7373 3d22 7022 3e29 2c3c 2f73   class="p">),</s
-00016f20: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
-00016f30: 3d22 6e22 3e64 463c 2f73 7061 6e3e 3c73  ="n">dF</span><s
-00016f40: 7061 6e20 636c 6173 733d 2270 223e 5d29  pan class="p">])
-00016f50: 3c2f 7370 616e 3e0a 2020 2020 3c73 7061  </span>.    <spa
-00016f60: 6e20 636c 6173 733d 226e 223e 483c 2f73  n class="n">H</s
-00016f70: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
-00016f80: 3d22 6f22 3e3d 3c2f 7370 616e 3e20 3c73  ="o">=</span> <s
-00016f90: 7061 6e20 636c 6173 733d 226e 223e 5f63  pan class="n">_c
-00016fa0: 6f6d 7075 7465 5f68 6573 7369 616e 5f6c  ompute_hessian_l
-00016fb0: 6f67 5f6c 696b 656c 6968 6f6f 645f 6f66  og_likelihood_of
-00016fc0: 5f46 3c2f 7370 616e 3e3c 7370 616e 2063  _F</span><span c
-00016fd0: 6c61 7373 3d22 7022 3e28 3c2f 7370 616e  lass="p">(</span
-00016fe0: 3e3c 7370 616e 2063 6c61 7373 3d22 6e22  ><span class="n"
-00016ff0: 3e46 3c2f 7370 616e 3e3c 7370 616e 2063  >F</span><span c
-00017000: 6c61 7373 3d22 7022 3e2c 3c2f 7370 616e  lass="p">,</span
-00017010: 3e20 3c73 7061 6e20 636c 6173 733d 226e  > <span class="n
-00017020: 223e 656e 6572 6779 3c2f 7370 616e 3e3c  ">energy</span><
-00017030: 7370 616e 2063 6c61 7373 3d22 7022 3e2c  span class="p">,
-00017040: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
-00017050: 6173 733d 226e 223e 6e75 6d5f 636f 6e66  ass="n">num_conf
-00017060: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-00017070: 7373 3d22 7022 3e29 3c2f 7370 616e 3e0a  ss="p">)</span>.
-00017080: 2020 2020 3c73 7061 6e20 636c 6173 733d      <span class=
-00017090: 226e 223e 483c 2f73 7061 6e3e 203c 7370  "n">H</span> <sp
-000170a0: 616e 2063 6c61 7373 3d22 6f22 3e3d 3c2f  an class="o">=</
-000170b0: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
-000170c0: 733d 226f 223e 2d3c 2f73 7061 6e3e 3c73  s="o">-</span><s
-000170d0: 7061 6e20 636c 6173 733d 226e 223e 483c  pan class="n">H<
-000170e0: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
-000170f0: 733d 2270 223e 5b3c 2f73 7061 6e3e 3c73  s="p">[</span><s
-00017100: 7061 6e20 636c 6173 733d 226d 6922 3e31  pan class="mi">1
-00017110: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-00017120: 7373 3d22 7022 3e3a 2c3c 2f73 7061 6e3e  ss="p">:,</span>
-00017130: 203c 7370 616e 2063 6c61 7373 3d22 6d69   <span class="mi
-00017140: 223e 313c 2f73 7061 6e3e 3c73 7061 6e20  ">1</span><span 
-00017150: 636c 6173 733d 2270 223e 3a5d 3c2f 7370  class="p">:]</sp
-00017160: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
-00017170: 226f 223e 2f3c 2f73 7061 6e3e 203c 7370  "o">/</span> <sp
-00017180: 616e 2063 6c61 7373 3d22 6e22 3e4e 3c2f  an class="n">N</
-00017190: 7370 616e 3e0a 2020 2020 3c73 7061 6e20  span>.    <span 
-000171a0: 636c 6173 733d 226b 223e 7265 7475 726e  class="k">return
-000171b0: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
-000171c0: 6173 733d 226e 223e 483c 2f73 7061 6e3e  ass="n">H</span>
-000171d0: 0a0a 0a3c 7370 616e 2063 6c61 7373 3d22  ...<span class="
-000171e0: 6b22 3e64 6566 3c2f 7370 616e 3e20 3c73  k">def</span> <s
-000171f0: 7061 6e20 636c 6173 733d 226e 6622 3e5f  pan class="nf">_
-00017200: 636f 6d70 7574 655f 6865 7373 6961 6e5f  compute_hessian_
-00017210: 6c6f 7373 5f6f 665f 6446 5f69 6e5f 6261  loss_of_dF_in_ba
-00017220: 7463 683c 2f73 7061 6e3e 3c73 7061 6e20  tch</span><span 
-00017230: 636c 6173 733d 2270 223e 283c 2f73 7061  class="p">(</spa
-00017240: 6e3e 3c73 7061 6e20 636c 6173 733d 226e  n><span class="n
-00017250: 223e 6446 3c2f 7370 616e 3e3c 7370 616e  ">dF</span><span
-00017260: 2063 6c61 7373 3d22 7022 3e2c 3c2f 7370   class="p">,</sp
-00017270: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
-00017280: 226e 223e 656e 6572 6779 3c2f 7370 616e  "n">energy</span
-00017290: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
-000172a0: 3e2c 3c2f 7370 616e 3e20 3c73 7061 6e20  >,</span> <span 
-000172b0: 636c 6173 733d 226e 223e 6e75 6d5f 636f  class="n">num_co
-000172c0: 6e66 3c2f 7370 616e 3e3c 7370 616e 2063  nf</span><span c
-000172d0: 6c61 7373 3d22 7022 3e2c 3c2f 7370 616e  lass="p">,</span
-000172e0: 3e20 3c73 7061 6e20 636c 6173 733d 226e  > <span class="n
-000172f0: 223e 6261 7463 685f 7369 7a65 3c2f 7370  ">batch_size</sp
-00017300: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-00017310: 7022 3e3a 3c2f 7370 616e 3e20 3c73 7061  p">:</span> <spa
-00017320: 6e20 636c 6173 733d 226e 6222 3e69 6e74  n class="nb">int
-00017330: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-00017340: 7373 3d22 7022 3e29 3a3c 2f73 7061 6e3e  ss="p">):</span>
-00017350: 0a20 2020 203c 7370 616e 2063 6c61 7373  .    <span class
-00017360: 3d22 6e22 3e4e 3c2f 7370 616e 3e20 3c73  ="n">N</span> <s
-00017370: 7061 6e20 636c 6173 733d 226f 223e 3d3c  pan class="o">=<
-00017380: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
-00017390: 7373 3d22 6e22 3e74 6f72 6368 3c2f 7370  ss="n">torch</sp
-000173a0: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-000173b0: 6f22 3e2e 3c2f 7370 616e 3e3c 7370 616e  o">.</span><span
-000173c0: 2063 6c61 7373 3d22 6e22 3e73 756d 3c2f   class="n">sum</
-000173d0: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
-000173e0: 3d22 7022 3e28 3c2f 7370 616e 3e3c 7370  ="p">(</span><sp
-000173f0: 616e 2063 6c61 7373 3d22 6e22 3e6e 756d  an class="n">num
-00017400: 5f63 6f6e 663c 2f73 7061 6e3e 3c73 7061  _conf</span><spa
-00017410: 6e20 636c 6173 733d 2270 223e 293c 2f73  n class="p">)</s
-00017420: 7061 6e3e 0a20 2020 203c 7370 616e 2063  pan>.    <span c
-00017430: 6c61 7373 3d22 6e22 3e46 3c2f 7370 616e  lass="n">F</span
-00017440: 3e20 3c73 7061 6e20 636c 6173 733d 226f  > <span class="o
-00017450: 223e 3d3c 2f73 7061 6e3e 203c 7370 616e  ">=</span> <span
-00017460: 2063 6c61 7373 3d22 6e22 3e74 6f72 6368   class="n">torch
-00017470: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-00017480: 7373 3d22 6f22 3e2e 3c2f 7370 616e 3e3c  ss="o">.</span><
-00017490: 7370 616e 2063 6c61 7373 3d22 6e22 3e63  span class="n">c
-000174a0: 6174 3c2f 7370 616e 3e3c 7370 616e 2063  at</span><span c
-000174b0: 6c61 7373 3d22 7022 3e28 5b3c 2f73 7061  lass="p">([</spa
-000174c0: 6e3e 3c73 7061 6e20 636c 6173 733d 226e  n><span class="n
-000174d0: 223e 6446 3c2f 7370 616e 3e3c 7370 616e  ">dF</span><span
-000174e0: 2063 6c61 7373 3d22 6f22 3e2e 3c2f 7370   class="o">.</sp
-000174f0: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-00017500: 6e22 3e6e 6577 5f7a 6572 6f73 3c2f 7370  n">new_zeros</sp
+00016490: 6173 733d 226e 223e 656e 6572 6779 3c2f  ass="n">energy</
+000164a0: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+000164b0: 3d22 7022 3e5b 3a2c 3c2f 7370 616e 3e20  ="p">[:,</span> 
+000164c0: 3c73 7061 6e20 636c 6173 733d 226e 223e  <span class="n">
+000164d0: 693c 2f73 7061 6e3e 203c 7370 616e 2063  i</span> <span c
+000164e0: 6c61 7373 3d22 6f22 3e2a 3c2f 7370 616e  lass="o">*</span
+000164f0: 3e20 3c73 7061 6e20 636c 6173 733d 226e  > <span class="n
+00016500: 223e 6261 7463 685f 7369 7a65 3c2f 7370  ">batch_size</sp
+00016510: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
+00016520: 2270 223e 3a3c 2f73 7061 6e3e 203c 7370  "p">:</span> <sp
+00016530: 616e 2063 6c61 7373 3d22 7022 3e28 3c2f  an class="p">(</
+00016540: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+00016550: 3d22 6e22 3e69 3c2f 7370 616e 3e20 3c73  ="n">i</span> <s
+00016560: 7061 6e20 636c 6173 733d 226f 223e 2b3c  pan class="o">+<
+00016570: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
+00016580: 7373 3d22 6d69 223e 313c 2f73 7061 6e3e  ss="mi">1</span>
+00016590: 3c73 7061 6e20 636c 6173 733d 2270 223e  <span class="p">
+000165a0: 293c 2f73 7061 6e3e 203c 7370 616e 2063  )</span> <span c
+000165b0: 6c61 7373 3d22 6f22 3e2a 3c2f 7370 616e  lass="o">*</span
+000165c0: 3e20 3c73 7061 6e20 636c 6173 733d 226e  > <span class="n
+000165d0: 223e 6261 7463 685f 7369 7a65 3c2f 7370  ">batch_size</sp
+000165e0: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+000165f0: 7022 3e5d 3c2f 7370 616e 3e0a 2020 2020  p">]</span>.    
+00016600: 2020 2020 3c73 7061 6e20 636c 6173 733d      <span class=
+00016610: 226e 223e 753c 2f73 7061 6e3e 203c 7370  "n">u</span> <sp
+00016620: 616e 2063 6c61 7373 3d22 6f22 3e3d 3c2f  an class="o">=</
+00016630: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
+00016640: 733d 226e 223e 656e 6572 6779 5f62 6174  s="n">energy_bat
+00016650: 6368 3c2f 7370 616e 3e3c 7370 616e 2063  ch</span><span c
+00016660: 6c61 7373 3d22 6f22 3e2e 3c2f 7370 616e  lass="o">.</span
+00016670: 3e3c 7370 616e 2063 6c61 7373 3d22 6e22  ><span class="n"
+00016680: 3e63 7564 613c 2f73 7061 6e3e 3c73 7061  >cuda</span><spa
+00016690: 6e20 636c 6173 733d 2270 223e 2829 3c2f  n class="p">()</
+000166a0: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
+000166b0: 733d 226f 223e 2d3c 2f73 7061 6e3e 203c  s="o">-</span> <
+000166c0: 7370 616e 2063 6c61 7373 3d22 6e22 3e46  span class="n">F
+000166d0: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
+000166e0: 7373 3d22 7022 3e5b 3a2c 3c2f 7370 616e  ss="p">[:,</span
+000166f0: 3e20 3c73 7061 6e20 636c 6173 733d 226b  > <span class="k
+00016700: 6322 3e4e 6f6e 653c 2f73 7061 6e3e 3c73  c">None</span><s
+00016710: 7061 6e20 636c 6173 733d 2270 223e 5d3c  pan class="p">]<
+00016720: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
+00016730: 7373 3d22 6f22 3e2d 3c2f 7370 616e 3e20  ss="o">-</span> 
+00016740: 3c73 7061 6e20 636c 6173 733d 226e 223e  <span class="n">
+00016750: 746f 7263 683c 2f73 7061 6e3e 3c73 7061  torch</span><spa
+00016760: 6e20 636c 6173 733d 226f 223e 2e3c 2f73  n class="o">.</s
+00016770: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
+00016780: 226e 223e 6c6f 673c 2f73 7061 6e3e 3c73  "n">log</span><s
+00016790: 7061 6e20 636c 6173 733d 2270 223e 283c  pan class="p">(<
+000167a0: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
+000167b0: 733d 226e 223e 6e75 6d5f 636f 6e66 3c2f  s="n">num_conf</
+000167c0: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+000167d0: 3d22 7022 3e29 5b3a 2c3c 2f73 7061 6e3e  ="p">)[:,</span>
+000167e0: 203c 7370 616e 2063 6c61 7373 3d22 6b63   <span class="kc
+000167f0: 223e 4e6f 6e65 3c2f 7370 616e 3e3c 7370  ">None</span><sp
+00016800: 616e 2063 6c61 7373 3d22 7022 3e5d 3c2f  an class="p">]</
+00016810: 7370 616e 3e0a 0a20 2020 2020 2020 203c  span>..        <
+00016820: 7370 616e 2063 6c61 7373 3d22 6e22 3e70  span class="n">p
+00016830: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
+00016840: 6173 733d 226f 223e 3d3c 2f73 7061 6e3e  ass="o">=</span>
+00016850: 203c 7370 616e 2063 6c61 7373 3d22 6e22   <span class="n"
+00016860: 3e74 6f72 6368 3c2f 7370 616e 3e3c 7370  >torch</span><sp
+00016870: 616e 2063 6c61 7373 3d22 6f22 3e2e 3c2f  an class="o">.</
+00016880: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+00016890: 3d22 6e22 3e73 6f66 746d 6178 3c2f 7370  ="n">softmax</sp
+000168a0: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+000168b0: 7022 3e28 3c2f 7370 616e 3e3c 7370 616e  p">(</span><span
+000168c0: 2063 6c61 7373 3d22 6f22 3e2d 3c2f 7370   class="o">-</sp
+000168d0: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+000168e0: 6e22 3e75 3c2f 7370 616e 3e3c 7370 616e  n">u</span><span
+000168f0: 2063 6c61 7373 3d22 7022 3e2c 3c2f 7370   class="p">,</sp
+00016900: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
+00016910: 226e 223e 6469 6d3c 2f73 7061 6e3e 3c73  "n">dim</span><s
+00016920: 7061 6e20 636c 6173 733d 226f 223e 3d3c  pan class="o">=<
+00016930: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
+00016940: 733d 226d 6922 3e30 3c2f 7370 616e 3e3c  s="mi">0</span><
+00016950: 7370 616e 2063 6c61 7373 3d22 7022 3e29  span class="p">)
+00016960: 3c2f 7370 616e 3e0a 2020 2020 2020 2020  </span>.        
+00016970: 3c73 7061 6e20 636c 6173 733d 226e 223e  <span class="n">
+00016980: 7070 3c2f 7370 616e 3e20 3c73 7061 6e20  pp</span> <span 
+00016990: 636c 6173 733d 226f 223e 3d3c 2f73 7061  class="o">=</spa
+000169a0: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
+000169b0: 6e22 3e74 6f72 6368 3c2f 7370 616e 3e3c  n">torch</span><
+000169c0: 7370 616e 2063 6c61 7373 3d22 6f22 3e2e  span class="o">.
+000169d0: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
+000169e0: 7373 3d22 6e22 3e6d 6174 6d75 6c3c 2f73  ss="n">matmul</s
+000169f0: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
+00016a00: 2270 223e 283c 2f73 7061 6e3e 3c73 7061  "p">(</span><spa
+00016a10: 6e20 636c 6173 733d 226e 223e 703c 2f73  n class="n">p</s
+00016a20: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
+00016a30: 2270 223e 2c3c 2f73 7061 6e3e 203c 7370  "p">,</span> <sp
+00016a40: 616e 2063 6c61 7373 3d22 6e22 3e70 3c2f  an class="n">p</
+00016a50: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+00016a60: 3d22 6f22 3e2e 3c2f 7370 616e 3e3c 7370  ="o">.</span><sp
+00016a70: 616e 2063 6c61 7373 3d22 6e22 3e54 3c2f  an class="n">T</
+00016a80: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+00016a90: 3d22 7022 3e29 3c2f 7370 616e 3e0a 2020  ="p">)</span>.  
+00016aa0: 2020 2020 2020 3c73 7061 6e20 636c 6173        <span clas
+00016ab0: 733d 226e 223e 483c 2f73 7061 6e3e 203c  s="n">H</span> <
+00016ac0: 7370 616e 2063 6c61 7373 3d22 6f22 3e2b  span class="o">+
+00016ad0: 3d3c 2f73 7061 6e3e 203c 7370 616e 2063  =</span> <span c
+00016ae0: 6c61 7373 3d22 6e22 3e70 703c 2f73 7061  lass="n">pp</spa
+00016af0: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
+00016b00: 6f22 3e2d 3c2f 7370 616e 3e20 3c73 7061  o">-</span> <spa
+00016b10: 6e20 636c 6173 733d 226e 223e 746f 7263  n class="n">torc
+00016b20: 683c 2f73 7061 6e3e 3c73 7061 6e20 636c  h</span><span cl
+00016b30: 6173 733d 226f 223e 2e3c 2f73 7061 6e3e  ass="o">.</span>
+00016b40: 3c73 7061 6e20 636c 6173 733d 226e 223e  <span class="n">
+00016b50: 6469 6167 3c2f 7370 616e 3e3c 7370 616e  diag</span><span
+00016b60: 2063 6c61 7373 3d22 7022 3e28 3c2f 7370   class="p">(</sp
+00016b70: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+00016b80: 6e22 3e74 6f72 6368 3c2f 7370 616e 3e3c  n">torch</span><
+00016b90: 7370 616e 2063 6c61 7373 3d22 6f22 3e2e  span class="o">.
+00016ba0: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
+00016bb0: 7373 3d22 6e22 3e73 756d 3c2f 7370 616e  ss="n">sum</span
+00016bc0: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
+00016bd0: 3e28 3c2f 7370 616e 3e3c 7370 616e 2063  >(</span><span c
+00016be0: 6c61 7373 3d22 6e22 3e70 3c2f 7370 616e  lass="n">p</span
+00016bf0: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
+00016c00: 3e2c 3c2f 7370 616e 3e20 3c73 7061 6e20  >,</span> <span 
+00016c10: 636c 6173 733d 226d 6922 3e31 3c2f 7370  class="mi">1</sp
+00016c20: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+00016c30: 7022 3e29 293c 2f73 7061 6e3e 0a0a 2020  p">))</span>..  
+00016c40: 2020 3c73 7061 6e20 636c 6173 733d 226b    <span class="k
+00016c50: 223e 7265 7475 726e 3c2f 7370 616e 3e20  ">return</span> 
+00016c60: 3c73 7061 6e20 636c 6173 733d 226e 223e  <span class="n">
+00016c70: 483c 2f73 7061 6e3e 0a0a 0a3c 7370 616e  H</span>...<span
+00016c80: 2063 6c61 7373 3d22 6b22 3e64 6566 3c2f   class="k">def</
+00016c90: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
+00016ca0: 733d 226e 6622 3e5f 636f 6d70 7574 655f  s="nf">_compute_
+00016cb0: 6865 7373 6961 6e5f 6c6f 7373 5f6f 665f  hessian_loss_of_
+00016cc0: 6446 3c2f 7370 616e 3e3c 7370 616e 2063  dF</span><span c
+00016cd0: 6c61 7373 3d22 7022 3e28 3c2f 7370 616e  lass="p">(</span
+00016ce0: 3e3c 7370 616e 2063 6c61 7373 3d22 6e22  ><span class="n"
+00016cf0: 3e64 463c 2f73 7061 6e3e 3c73 7061 6e20  >dF</span><span 
+00016d00: 636c 6173 733d 2270 223e 2c3c 2f73 7061  class="p">,</spa
+00016d10: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
+00016d20: 6e22 3e65 6e65 7267 793c 2f73 7061 6e3e  n">energy</span>
+00016d30: 3c73 7061 6e20 636c 6173 733d 2270 223e  <span class="p">
+00016d40: 2c3c 2f73 7061 6e3e 203c 7370 616e 2063  ,</span> <span c
+00016d50: 6c61 7373 3d22 6e22 3e6e 756d 5f63 6f6e  lass="n">num_con
+00016d60: 663c 2f73 7061 6e3e 3c73 7061 6e20 636c  f</span><span cl
+00016d70: 6173 733d 2270 223e 293a 3c2f 7370 616e  ass="p">):</span
+00016d80: 3e0a 2020 2020 3c73 7061 6e20 636c 6173  >.    <span clas
+00016d90: 733d 226e 223e 4e3c 2f73 7061 6e3e 203c  s="n">N</span> <
+00016da0: 7370 616e 2063 6c61 7373 3d22 6f22 3e3d  span class="o">=
+00016db0: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
+00016dc0: 6173 733d 226e 223e 746f 7263 683c 2f73  ass="n">torch</s
+00016dd0: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
+00016de0: 226f 223e 2e3c 2f73 7061 6e3e 3c73 7061  "o">.</span><spa
+00016df0: 6e20 636c 6173 733d 226e 223e 7375 6d3c  n class="n">sum<
+00016e00: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
+00016e10: 733d 2270 223e 283c 2f73 7061 6e3e 3c73  s="p">(</span><s
+00016e20: 7061 6e20 636c 6173 733d 226e 223e 6e75  pan class="n">nu
+00016e30: 6d5f 636f 6e66 3c2f 7370 616e 3e3c 7370  m_conf</span><sp
+00016e40: 616e 2063 6c61 7373 3d22 7022 3e29 3c2f  an class="p">)</
+00016e50: 7370 616e 3e0a 2020 2020 3c73 7061 6e20  span>.    <span 
+00016e60: 636c 6173 733d 226e 223e 463c 2f73 7061  class="n">F</spa
+00016e70: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
+00016e80: 6f22 3e3d 3c2f 7370 616e 3e20 3c73 7061  o">=</span> <spa
+00016e90: 6e20 636c 6173 733d 226e 223e 746f 7263  n class="n">torc
+00016ea0: 683c 2f73 7061 6e3e 3c73 7061 6e20 636c  h</span><span cl
+00016eb0: 6173 733d 226f 223e 2e3c 2f73 7061 6e3e  ass="o">.</span>
+00016ec0: 3c73 7061 6e20 636c 6173 733d 226e 223e  <span class="n">
+00016ed0: 6361 743c 2f73 7061 6e3e 3c73 7061 6e20  cat</span><span 
+00016ee0: 636c 6173 733d 2270 223e 285b 3c2f 7370  class="p">([</sp
+00016ef0: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+00016f00: 6e22 3e64 463c 2f73 7061 6e3e 3c73 7061  n">dF</span><spa
+00016f10: 6e20 636c 6173 733d 226f 223e 2e3c 2f73  n class="o">.</s
+00016f20: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
+00016f30: 226e 223e 6e65 775f 7a65 726f 733c 2f73  "n">new_zeros</s
+00016f40: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
+00016f50: 2270 223e 283c 2f73 7061 6e3e 3c73 7061  "p">(</span><spa
+00016f60: 6e20 636c 6173 733d 226d 6922 3e31 3c2f  n class="mi">1</
+00016f70: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+00016f80: 3d22 7022 3e29 2c3c 2f73 7061 6e3e 203c  ="p">),</span> <
+00016f90: 7370 616e 2063 6c61 7373 3d22 6e22 3e64  span class="n">d
+00016fa0: 463c 2f73 7061 6e3e 3c73 7061 6e20 636c  F</span><span cl
+00016fb0: 6173 733d 2270 223e 5d29 3c2f 7370 616e  ass="p">])</span
+00016fc0: 3e0a 2020 2020 3c73 7061 6e20 636c 6173  >.    <span clas
+00016fd0: 733d 226e 223e 483c 2f73 7061 6e3e 203c  s="n">H</span> <
+00016fe0: 7370 616e 2063 6c61 7373 3d22 6f22 3e3d  span class="o">=
+00016ff0: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
+00017000: 6173 733d 226e 223e 5f63 6f6d 7075 7465  ass="n">_compute
+00017010: 5f68 6573 7369 616e 5f6c 6f67 5f6c 696b  _hessian_log_lik
+00017020: 656c 6968 6f6f 645f 6f66 5f46 3c2f 7370  elihood_of_F</sp
+00017030: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+00017040: 7022 3e28 3c2f 7370 616e 3e3c 7370 616e  p">(</span><span
+00017050: 2063 6c61 7373 3d22 6e22 3e46 3c2f 7370   class="n">F</sp
+00017060: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+00017070: 7022 3e2c 3c2f 7370 616e 3e20 3c73 7061  p">,</span> <spa
+00017080: 6e20 636c 6173 733d 226e 223e 656e 6572  n class="n">ener
+00017090: 6779 3c2f 7370 616e 3e3c 7370 616e 2063  gy</span><span c
+000170a0: 6c61 7373 3d22 7022 3e2c 3c2f 7370 616e  lass="p">,</span
+000170b0: 3e20 3c73 7061 6e20 636c 6173 733d 226e  > <span class="n
+000170c0: 223e 6e75 6d5f 636f 6e66 3c2f 7370 616e  ">num_conf</span
+000170d0: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
+000170e0: 3e29 3c2f 7370 616e 3e0a 2020 2020 3c73  >)</span>.    <s
+000170f0: 7061 6e20 636c 6173 733d 226e 223e 483c  pan class="n">H<
+00017100: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
+00017110: 7373 3d22 6f22 3e3d 3c2f 7370 616e 3e20  ss="o">=</span> 
+00017120: 3c73 7061 6e20 636c 6173 733d 226f 223e  <span class="o">
+00017130: 2d3c 2f73 7061 6e3e 3c73 7061 6e20 636c  -</span><span cl
+00017140: 6173 733d 226e 223e 483c 2f73 7061 6e3e  ass="n">H</span>
+00017150: 3c73 7061 6e20 636c 6173 733d 2270 223e  <span class="p">
+00017160: 5b3c 2f73 7061 6e3e 3c73 7061 6e20 636c  [</span><span cl
+00017170: 6173 733d 226d 6922 3e31 3c2f 7370 616e  ass="mi">1</span
+00017180: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
+00017190: 3e3a 2c3c 2f73 7061 6e3e 203c 7370 616e  >:,</span> <span
+000171a0: 2063 6c61 7373 3d22 6d69 223e 313c 2f73   class="mi">1</s
+000171b0: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
+000171c0: 2270 223e 3a5d 3c2f 7370 616e 3e20 3c73  "p">:]</span> <s
+000171d0: 7061 6e20 636c 6173 733d 226f 223e 2f3c  pan class="o">/<
+000171e0: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
+000171f0: 7373 3d22 6e22 3e4e 3c2f 7370 616e 3e0a  ss="n">N</span>.
+00017200: 2020 2020 3c73 7061 6e20 636c 6173 733d      <span class=
+00017210: 226b 223e 7265 7475 726e 3c2f 7370 616e  "k">return</span
+00017220: 3e20 3c73 7061 6e20 636c 6173 733d 226e  > <span class="n
+00017230: 223e 483c 2f73 7061 6e3e 0a0a 0a3c 7370  ">H</span>...<sp
+00017240: 616e 2063 6c61 7373 3d22 6b22 3e64 6566  an class="k">def
+00017250: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
+00017260: 6173 733d 226e 6622 3e5f 636f 6d70 7574  ass="nf">_comput
+00017270: 655f 6865 7373 6961 6e5f 6c6f 7373 5f6f  e_hessian_loss_o
+00017280: 665f 6446 5f69 6e5f 6261 7463 683c 2f73  f_dF_in_batch</s
+00017290: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
+000172a0: 2270 223e 283c 2f73 7061 6e3e 3c73 7061  "p">(</span><spa
+000172b0: 6e20 636c 6173 733d 226e 223e 6446 3c2f  n class="n">dF</
+000172c0: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+000172d0: 3d22 7022 3e2c 3c2f 7370 616e 3e20 3c73  ="p">,</span> <s
+000172e0: 7061 6e20 636c 6173 733d 226e 223e 656e  pan class="n">en
+000172f0: 6572 6779 3c2f 7370 616e 3e3c 7370 616e  ergy</span><span
+00017300: 2063 6c61 7373 3d22 7022 3e2c 3c2f 7370   class="p">,</sp
+00017310: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
+00017320: 226e 223e 6e75 6d5f 636f 6e66 3c2f 7370  "n">num_conf</sp
+00017330: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+00017340: 7022 3e2c 3c2f 7370 616e 3e20 3c73 7061  p">,</span> <spa
+00017350: 6e20 636c 6173 733d 226e 223e 6261 7463  n class="n">batc
+00017360: 685f 7369 7a65 3c2f 7370 616e 3e3c 7370  h_size</span><sp
+00017370: 616e 2063 6c61 7373 3d22 7022 3e3a 3c2f  an class="p">:</
+00017380: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
+00017390: 733d 226e 6222 3e69 6e74 3c2f 7370 616e  s="nb">int</span
+000173a0: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
+000173b0: 3e29 3a3c 2f73 7061 6e3e 0a20 2020 203c  >):</span>.    <
+000173c0: 7370 616e 2063 6c61 7373 3d22 6e22 3e4e  span class="n">N
+000173d0: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
+000173e0: 6173 733d 226f 223e 3d3c 2f73 7061 6e3e  ass="o">=</span>
+000173f0: 203c 7370 616e 2063 6c61 7373 3d22 6e22   <span class="n"
+00017400: 3e74 6f72 6368 3c2f 7370 616e 3e3c 7370  >torch</span><sp
+00017410: 616e 2063 6c61 7373 3d22 6f22 3e2e 3c2f  an class="o">.</
+00017420: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+00017430: 3d22 6e22 3e73 756d 3c2f 7370 616e 3e3c  ="n">sum</span><
+00017440: 7370 616e 2063 6c61 7373 3d22 7022 3e28  span class="p">(
+00017450: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
+00017460: 7373 3d22 6e22 3e6e 756d 5f63 6f6e 663c  ss="n">num_conf<
+00017470: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
+00017480: 733d 2270 223e 293c 2f73 7061 6e3e 0a20  s="p">)</span>. 
+00017490: 2020 203c 7370 616e 2063 6c61 7373 3d22     <span class="
+000174a0: 6e22 3e46 3c2f 7370 616e 3e20 3c73 7061  n">F</span> <spa
+000174b0: 6e20 636c 6173 733d 226f 223e 3d3c 2f73  n class="o">=</s
+000174c0: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
+000174d0: 3d22 6e22 3e74 6f72 6368 3c2f 7370 616e  ="n">torch</span
+000174e0: 3e3c 7370 616e 2063 6c61 7373 3d22 6f22  ><span class="o"
+000174f0: 3e2e 3c2f 7370 616e 3e3c 7370 616e 2063  >.</span><span c
+00017500: 6c61 7373 3d22 6e22 3e63 6174 3c2f 7370  lass="n">cat</sp
 00017510: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-00017520: 7022 3e28 3c2f 7370 616e 3e3c 7370 616e  p">(</span><span
-00017530: 2063 6c61 7373 3d22 6d69 223e 313c 2f73   class="mi">1</s
-00017540: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
-00017550: 2270 223e 292c 3c2f 7370 616e 3e20 3c73  "p">),</span> <s
-00017560: 7061 6e20 636c 6173 733d 226e 223e 6446  pan class="n">dF
-00017570: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-00017580: 7373 3d22 7022 3e5d 293c 2f73 7061 6e3e  ss="p">])</span>
-00017590: 0a20 2020 203c 7370 616e 2063 6c61 7373  .    <span class
-000175a0: 3d22 6e22 3e48 3c2f 7370 616e 3e20 3c73  ="n">H</span> <s
-000175b0: 7061 6e20 636c 6173 733d 226f 223e 3d3c  pan class="o">=<
-000175c0: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
-000175d0: 7373 3d22 6e22 3e5f 636f 6d70 7574 655f  ss="n">_compute_
-000175e0: 6865 7373 6961 6e5f 6c6f 675f 6c69 6b65  hessian_log_like
-000175f0: 6c69 686f 6f64 5f6f 665f 465f 696e 5f62  lihood_of_F_in_b
-00017600: 6174 6368 3c2f 7370 616e 3e3c 7370 616e  atch</span><span
-00017610: 2063 6c61 7373 3d22 7022 3e28 3c2f 7370   class="p">(</sp
-00017620: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-00017630: 6e22 3e46 3c2f 7370 616e 3e3c 7370 616e  n">F</span><span
-00017640: 2063 6c61 7373 3d22 7022 3e2c 3c2f 7370   class="p">,</sp
-00017650: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
-00017660: 226e 223e 656e 6572 6779 3c2f 7370 616e  "n">energy</span
-00017670: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
-00017680: 3e2c 3c2f 7370 616e 3e20 3c73 7061 6e20  >,</span> <span 
-00017690: 636c 6173 733d 226e 223e 6e75 6d5f 636f  class="n">num_co
-000176a0: 6e66 3c2f 7370 616e 3e3c 7370 616e 2063  nf</span><span c
-000176b0: 6c61 7373 3d22 7022 3e2c 3c2f 7370 616e  lass="p">,</span
-000176c0: 3e20 3c73 7061 6e20 636c 6173 733d 226e  > <span class="n
-000176d0: 223e 6261 7463 685f 7369 7a65 3c2f 7370  ">batch_size</sp
-000176e0: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-000176f0: 7022 3e29 3c2f 7370 616e 3e0a 2020 2020  p">)</span>.    
-00017700: 3c73 7061 6e20 636c 6173 733d 226e 223e  <span class="n">
-00017710: 483c 2f73 7061 6e3e 203c 7370 616e 2063  H</span> <span c
-00017720: 6c61 7373 3d22 6f22 3e3d 3c2f 7370 616e  lass="o">=</span
-00017730: 3e20 3c73 7061 6e20 636c 6173 733d 226f  > <span class="o
-00017740: 223e 2d3c 2f73 7061 6e3e 3c73 7061 6e20  ">-</span><span 
-00017750: 636c 6173 733d 226e 223e 483c 2f73 7061  class="n">H</spa
-00017760: 6e3e 3c73 7061 6e20 636c 6173 733d 2270  n><span class="p
-00017770: 223e 5b3c 2f73 7061 6e3e 3c73 7061 6e20  ">[</span><span 
-00017780: 636c 6173 733d 226d 6922 3e31 3c2f 7370  class="mi">1</sp
-00017790: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-000177a0: 7022 3e3a 2c3c 2f73 7061 6e3e 203c 7370  p">:,</span> <sp
-000177b0: 616e 2063 6c61 7373 3d22 6d69 223e 313c  an class="mi">1<
-000177c0: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
-000177d0: 733d 2270 223e 3a5d 3c2f 7370 616e 3e20  s="p">:]</span> 
-000177e0: 3c73 7061 6e20 636c 6173 733d 226f 223e  <span class="o">
-000177f0: 2f3c 2f73 7061 6e3e 203c 7370 616e 2063  /</span> <span c
-00017800: 6c61 7373 3d22 6e22 3e4e 3c2f 7370 616e  lass="n">N</span
-00017810: 3e0a 2020 2020 3c73 7061 6e20 636c 6173  >.    <span clas
-00017820: 733d 226b 223e 7265 7475 726e 3c2f 7370  s="k">return</sp
-00017830: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
-00017840: 226e 223e 483c 2f73 7061 6e3e 0a0a 0a3c  "n">H</span>...<
-00017850: 7370 616e 2063 6c61 7373 3d22 6b22 3e64  span class="k">d
-00017860: 6566 3c2f 7370 616e 3e20 3c73 7061 6e20  ef</span> <span 
-00017870: 636c 6173 733d 226e 6622 3e5f 736f 6c76  class="nf">_solv
-00017880: 655f 6d62 6172 3c2f 7370 616e 3e3c 7370  e_mbar</span><sp
-00017890: 616e 2063 6c61 7373 3d22 7022 3e28 3c2f  an class="p">(</
-000178a0: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
-000178b0: 3d22 6e22 3e64 465f 696e 6974 3c2f 7370  ="n">dF_init</sp
-000178c0: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-000178d0: 7022 3e2c 3c2f 7370 616e 3e20 3c73 7061  p">,</span> <spa
-000178e0: 6e20 636c 6173 733d 226e 223e 656e 6572  n class="n">ener
-000178f0: 6779 3c2f 7370 616e 3e3c 7370 616e 2063  gy</span><span c
-00017900: 6c61 7373 3d22 7022 3e2c 3c2f 7370 616e  lass="p">,</span
-00017910: 3e20 3c73 7061 6e20 636c 6173 733d 226e  > <span class="n
-00017920: 223e 6e75 6d5f 636f 6e66 3c2f 7370 616e  ">num_conf</span
-00017930: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
-00017940: 3e2c 3c2f 7370 616e 3e20 3c73 7061 6e20  >,</span> <span 
-00017950: 636c 6173 733d 226e 223e 6d65 7468 6f64  class="n">method
-00017960: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-00017970: 7373 3d22 7022 3e2c 3c2f 7370 616e 3e20  ss="p">,</span> 
-00017980: 3c73 7061 6e20 636c 6173 733d 226e 223e  <span class="n">
-00017990: 6261 7463 685f 7369 7a65 3c2f 7370 616e  batch_size</span
-000179a0: 3e3c 7370 616e 2063 6c61 7373 3d22 6f22  ><span class="o"
-000179b0: 3e3d 3c2f 7370 616e 3e3c 7370 616e 2063  >=</span><span c
-000179c0: 6c61 7373 3d22 6b63 223e 4e6f 6e65 3c2f  lass="kc">None</
-000179d0: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
-000179e0: 3d22 7022 3e2c 3c2f 7370 616e 3e20 3c73  ="p">,</span> <s
-000179f0: 7061 6e20 636c 6173 733d 226e 223e 7665  pan class="n">ve
-00017a00: 7262 6f73 653c 2f73 7061 6e3e 3c73 7061  rbose</span><spa
-00017a10: 6e20 636c 6173 733d 226f 223e 3d3c 2f73  n class="o">=</s
-00017a20: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
-00017a30: 226b 6322 3e46 616c 7365 3c2f 7370 616e  "kc">False</span
-00017a40: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
-00017a50: 3e29 3a3c 2f73 7061 6e3e 0a20 2020 203c  >):</span>.    <
-00017a60: 7370 616e 2063 6c61 7373 3d22 6b22 3e69  span class="k">i
-00017a70: 663c 2f73 7061 6e3e 203c 7370 616e 2063  f</span> <span c
-00017a80: 6c61 7373 3d22 6e22 3e62 6174 6368 5f73  lass="n">batch_s
-00017a90: 697a 653c 2f73 7061 6e3e 203c 7370 616e  ize</span> <span
-00017aa0: 2063 6c61 7373 3d22 6f77 223e 6973 3c2f   class="ow">is</
-00017ab0: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
-00017ac0: 733d 226f 7722 3e6e 6f74 3c2f 7370 616e  s="ow">not</span
-00017ad0: 3e20 3c73 7061 6e20 636c 6173 733d 226b  > <span class="k
-00017ae0: 6322 3e4e 6f6e 653c 2f73 7061 6e3e 3c73  c">None</span><s
-00017af0: 7061 6e20 636c 6173 733d 2270 223e 3a3c  pan class="p">:<
-00017b00: 2f73 7061 6e3e 0a20 2020 2020 2020 203c  /span>.        <
-00017b10: 7370 616e 2063 6c61 7373 3d22 6b22 3e69  span class="k">i
-00017b20: 663c 2f73 7061 6e3e 203c 7370 616e 2063  f</span> <span c
-00017b30: 6c61 7373 3d22 6e22 3e6d 6574 686f 643c  lass="n">method<
-00017b40: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
-00017b50: 7373 3d22 6f22 3e3d 3d3c 2f73 7061 6e3e  ss="o">==</span>
-00017b60: 203c 7370 616e 2063 6c61 7373 3d22 7332   <span class="s2
-00017b70: 223e 2671 756f 743b 4e65 7774 6f6e 2671  ">&quot;Newton&q
-00017b80: 756f 743b 3c2f 7370 616e 3e3c 7370 616e  uot;</span><span
-00017b90: 2063 6c61 7373 3d22 7022 3e3a 3c2f 7370   class="p">:</sp
-00017ba0: 616e 3e0a 2020 2020 2020 2020 2020 2020  an>.            
-00017bb0: 3c73 7061 6e20 636c 6173 733d 226e 223e  <span class="n">
-00017bc0: 7265 7375 6c74 733c 2f73 7061 6e3e 203c  results</span> <
-00017bd0: 7370 616e 2063 6c61 7373 3d22 6f22 3e3d  span class="o">=
-00017be0: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
-00017bf0: 6173 733d 226e 223e 666d 696e 5f6e 6577  ass="n">fmin_new
-00017c00: 746f 6e3c 2f73 7061 6e3e 3c73 7061 6e20  ton</span><span 
-00017c10: 636c 6173 733d 2270 223e 283c 2f73 7061  class="p">(</spa
-00017c20: 6e3e 0a20 2020 2020 2020 2020 2020 2020  n>.             
-00017c30: 2020 203c 7370 616e 2063 6c61 7373 3d22     <span class="
-00017c40: 6e22 3e66 3c2f 7370 616e 3e3c 7370 616e  n">f</span><span
-00017c50: 2063 6c61 7373 3d22 6f22 3e3d 3c2f 7370   class="o">=</sp
-00017c60: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-00017c70: 6e22 3e5f 636f 6d70 7574 655f 6c6f 7373  n">_compute_loss
-00017c80: 5f61 6e64 5f67 7261 645f 6f66 5f64 465f  _and_grad_of_dF_
-00017c90: 696e 5f62 6174 6368 3c2f 7370 616e 3e3c  in_batch</span><
-00017ca0: 7370 616e 2063 6c61 7373 3d22 7022 3e2c  span class="p">,
-00017cb0: 3c2f 7370 616e 3e0a 2020 2020 2020 2020  </span>.        
-00017cc0: 2020 2020 2020 2020 3c73 7061 6e20 636c          <span cl
-00017cd0: 6173 733d 226e 223e 6865 7373 3c2f 7370  ass="n">hess</sp
-00017ce0: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-00017cf0: 6f22 3e3d 3c2f 7370 616e 3e3c 7370 616e  o">=</span><span
-00017d00: 2063 6c61 7373 3d22 6e22 3e5f 636f 6d70   class="n">_comp
-00017d10: 7574 655f 6865 7373 6961 6e5f 6c6f 7373  ute_hessian_loss
-00017d20: 5f6f 665f 6446 5f69 6e5f 6261 7463 683c  _of_dF_in_batch<
-00017d30: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
-00017d40: 733d 2270 223e 2c3c 2f73 7061 6e3e 0a20  s="p">,</span>. 
-00017d50: 2020 2020 2020 2020 2020 2020 2020 203c                 <
-00017d60: 7370 616e 2063 6c61 7373 3d22 6e22 3e78  span class="n">x
-00017d70: 5f69 6e69 743c 2f73 7061 6e3e 3c73 7061  _init</span><spa
-00017d80: 6e20 636c 6173 733d 226f 223e 3d3c 2f73  n class="o">=</s
-00017d90: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
-00017da0: 226e 223e 6446 5f69 6e69 743c 2f73 7061  "n">dF_init</spa
-00017db0: 6e3e 3c73 7061 6e20 636c 6173 733d 2270  n><span class="p
-00017dc0: 223e 2c3c 2f73 7061 6e3e 0a20 2020 2020  ">,</span>.     
-00017dd0: 2020 2020 2020 2020 2020 203c 7370 616e             <span
-00017de0: 2063 6c61 7373 3d22 6e22 3e61 7267 733c   class="n">args<
-00017df0: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
-00017e00: 733d 226f 223e 3d3c 2f73 7061 6e3e 3c73  s="o">=</span><s
-00017e10: 7061 6e20 636c 6173 733d 2270 223e 283c  pan class="p">(<
-00017e20: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
-00017e30: 733d 226e 223e 656e 6572 6779 3c2f 7370  s="n">energy</sp
-00017e40: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-00017e50: 7022 3e2c 3c2f 7370 616e 3e20 3c73 7061  p">,</span> <spa
-00017e60: 6e20 636c 6173 733d 226e 223e 6e75 6d5f  n class="n">num_
-00017e70: 636f 6e66 3c2f 7370 616e 3e3c 7370 616e  conf</span><span
-00017e80: 2063 6c61 7373 3d22 7022 3e2c 3c2f 7370   class="p">,</sp
-00017e90: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
-00017ea0: 226e 223e 6261 7463 685f 7369 7a65 3c2f  "n">batch_size</
-00017eb0: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
-00017ec0: 3d22 7022 3e29 2c3c 2f73 7061 6e3e 0a20  ="p">),</span>. 
-00017ed0: 2020 2020 2020 2020 2020 2020 2020 203c                 <
-00017ee0: 7370 616e 2063 6c61 7373 3d22 6e22 3e76  span class="n">v
-00017ef0: 6572 626f 7365 3c2f 7370 616e 3e3c 7370  erbose</span><sp
-00017f00: 616e 2063 6c61 7373 3d22 6f22 3e3d 3c2f  an class="o">=</
-00017f10: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
-00017f20: 3d22 6e22 3e76 6572 626f 7365 3c2f 7370  ="n">verbose</sp
-00017f30: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-00017f40: 7022 3e2c 3c2f 7370 616e 3e0a 2020 2020  p">,</span>.    
-00017f50: 2020 2020 2020 2020 3c73 7061 6e20 636c          <span cl
-00017f60: 6173 733d 2270 223e 293c 2f73 7061 6e3e  ass="p">)</span>
-00017f70: 0a20 2020 2020 2020 2020 2020 203c 7370  .            <sp
-00017f80: 616e 2063 6c61 7373 3d22 6b22 3e72 6574  an class="k">ret
-00017f90: 7572 6e3c 2f73 7061 6e3e 203c 7370 616e  urn</span> <span
-00017fa0: 2063 6c61 7373 3d22 6e22 3e72 6573 756c   class="n">resul
-00017fb0: 7473 3c2f 7370 616e 3e3c 7370 616e 2063  ts</span><span c
-00017fc0: 6c61 7373 3d22 7022 3e5b 3c2f 7370 616e  lass="p">[</span
-00017fd0: 3e3c 7370 616e 2063 6c61 7373 3d22 7332  ><span class="s2
-00017fe0: 223e 2671 756f 743b 7826 7175 6f74 3b3c  ">&quot;x&quot;<
-00017ff0: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
-00018000: 733d 2270 223e 5d3c 2f73 7061 6e3e 0a0a  s="p">]</span>..
-00018010: 2020 2020 2020 2020 3c73 7061 6e20 636c          <span cl
-00018020: 6173 733d 226b 223e 656c 6966 3c2f 7370  ass="k">elif</sp
-00018030: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
-00018040: 226e 223e 6d65 7468 6f64 3c2f 7370 616e  "n">method</span
-00018050: 3e20 3c73 7061 6e20 636c 6173 733d 226f  > <span class="o
-00018060: 223e 3d3d 3c2f 7370 616e 3e20 3c73 7061  ">==</span> <spa
-00018070: 6e20 636c 6173 733d 2273 3222 3e26 7175  n class="s2">&qu
-00018080: 6f74 3b4c 2d42 4647 532d 4226 7175 6f74  ot;L-BFGS-B&quot
-00018090: 3b3c 2f73 7061 6e3e 3c73 7061 6e20 636c  ;</span><span cl
-000180a0: 6173 733d 2270 223e 3a3c 2f73 7061 6e3e  ass="p">:</span>
-000180b0: 0a20 2020 2020 2020 2020 2020 203c 7370  .            <sp
-000180c0: 616e 2063 6c61 7373 3d22 6e22 3e6f 7074  an class="n">opt
-000180d0: 696f 6e73 3c2f 7370 616e 3e20 3c73 7061  ions</span> <spa
-000180e0: 6e20 636c 6173 733d 226f 223e 3d3c 2f73  n class="o">=</s
-000180f0: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
-00018100: 3d22 7022 3e7b 3c2f 7370 616e 3e3c 7370  ="p">{</span><sp
-00018110: 616e 2063 6c61 7373 3d22 7332 223e 2671  an class="s2">&q
-00018120: 756f 743b 6469 7370 2671 756f 743b 3c2f  uot;disp&quot;</
-00018130: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
-00018140: 3d22 7022 3e3a 3c2f 7370 616e 3e20 3c73  ="p">:</span> <s
-00018150: 7061 6e20 636c 6173 733d 226e 223e 7665  pan class="n">ve
-00018160: 7262 6f73 653c 2f73 7061 6e3e 3c73 7061  rbose</span><spa
-00018170: 6e20 636c 6173 733d 2270 223e 2c3c 2f73  n class="p">,</s
-00018180: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
-00018190: 3d22 7332 223e 2671 756f 743b 6774 6f6c  ="s2">&quot;gtol
-000181a0: 2671 756f 743b 3c2f 7370 616e 3e3c 7370  &quot;</span><sp
-000181b0: 616e 2063 6c61 7373 3d22 7022 3e3a 3c2f  an class="p">:</
-000181c0: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
-000181d0: 733d 226d 6622 3e31 652d 383c 2f73 7061  s="mf">1e-8</spa
-000181e0: 6e3e 3c73 7061 6e20 636c 6173 733d 2270  n><span class="p
-000181f0: 223e 7d3c 2f73 7061 6e3e 0a20 2020 2020  ">}</span>.     
-00018200: 2020 2020 2020 203c 7370 616e 2063 6c61         <span cla
-00018210: 7373 3d22 6e22 3e72 6573 756c 7473 3c2f  ss="n">results</
-00018220: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
-00018230: 733d 226f 223e 3d3c 2f73 7061 6e3e 203c  s="o">=</span> <
-00018240: 7370 616e 2063 6c61 7373 3d22 6e22 3e6f  span class="n">o
-00018250: 7074 696d 697a 653c 2f73 7061 6e3e 3c73  ptimize</span><s
-00018260: 7061 6e20 636c 6173 733d 226f 223e 2e3c  pan class="o">.<
-00018270: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
-00018280: 733d 226e 223e 6d69 6e69 6d69 7a65 3c2f  s="n">minimize</
-00018290: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
-000182a0: 3d22 7022 3e28 3c2f 7370 616e 3e0a 2020  ="p">(</span>.  
-000182b0: 2020 2020 2020 2020 2020 2020 2020 3c73                <s
-000182c0: 7061 6e20 636c 6173 733d 226b 223e 6c61  pan class="k">la
-000182d0: 6d62 6461 3c2f 7370 616e 3e20 3c73 7061  mbda</span> <spa
-000182e0: 6e20 636c 6173 733d 226e 223e 783c 2f73  n class="n">x</s
-000182f0: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
-00018300: 2270 223e 3a3c 2f73 7061 6e3e 203c 7370  "p">:</span> <sp
-00018310: 616e 2063 6c61 7373 3d22 7022 3e5b 3c2f  an class="p">[</
-00018320: 7370 616e 3e0a 2020 2020 2020 2020 2020  span>.          
-00018330: 2020 2020 2020 2020 2020 3c73 7061 6e20            <span 
-00018340: 636c 6173 733d 226e 223e 723c 2f73 7061  class="n">r</spa
-00018350: 6e3e 3c73 7061 6e20 636c 6173 733d 226f  n><span class="o
-00018360: 223e 2e3c 2f73 7061 6e3e 3c73 7061 6e20  ">.</span><span 
-00018370: 636c 6173 733d 226e 223e 6370 753c 2f73  class="n">cpu</s
-00018380: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
-00018390: 2270 223e 2829 3c2f 7370 616e 3e3c 7370  "p">()</span><sp
-000183a0: 616e 2063 6c61 7373 3d22 6f22 3e2e 3c2f  an class="o">.</
-000183b0: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
-000183c0: 3d22 6e22 3e6e 756d 7079 3c2f 7370 616e  ="n">numpy</span
-000183d0: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
-000183e0: 3e28 293c 2f73 7061 6e3e 0a20 2020 2020  >()</span>.     
-000183f0: 2020 2020 2020 2020 2020 2020 2020 203c                 <
-00018400: 7370 616e 2063 6c61 7373 3d22 6b22 3e66  span class="k">f
-00018410: 6f72 3c2f 7370 616e 3e20 3c73 7061 6e20  or</span> <span 
-00018420: 636c 6173 733d 226e 223e 723c 2f73 7061  class="n">r</spa
-00018430: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
-00018440: 6f77 223e 696e 3c2f 7370 616e 3e20 3c73  ow">in</span> <s
-00018450: 7061 6e20 636c 6173 733d 226e 223e 5f63  pan class="n">_c
-00018460: 6f6d 7075 7465 5f6c 6f73 735f 616e 645f  ompute_loss_and_
-00018470: 6772 6164 5f6f 665f 6446 5f69 6e5f 6261  grad_of_dF_in_ba
-00018480: 7463 683c 2f73 7061 6e3e 3c73 7061 6e20  tch</span><span 
-00018490: 636c 6173 733d 2270 223e 283c 2f73 7061  class="p">(</spa
-000184a0: 6e3e 0a20 2020 2020 2020 2020 2020 2020  n>.             
-000184b0: 2020 2020 2020 2020 2020 203c 7370 616e             <span
-000184c0: 2063 6c61 7373 3d22 6e22 3e65 6e65 7267   class="n">energ
-000184d0: 793c 2f73 7061 6e3e 3c73 7061 6e20 636c  y</span><span cl
-000184e0: 6173 733d 226f 223e 2e3c 2f73 7061 6e3e  ass="o">.</span>
-000184f0: 3c73 7061 6e20 636c 6173 733d 226e 223e  <span class="n">
-00018500: 6e65 775f 7465 6e73 6f72 3c2f 7370 616e  new_tensor</span
-00018510: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
-00018520: 3e28 3c2f 7370 616e 3e3c 7370 616e 2063  >(</span><span c
-00018530: 6c61 7373 3d22 6e22 3e78 3c2f 7370 616e  lass="n">x</span
-00018540: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
-00018550: 3e29 2c3c 2f73 7061 6e3e 203c 7370 616e  >),</span> <span
-00018560: 2063 6c61 7373 3d22 6e22 3e65 6e65 7267   class="n">energ
-00018570: 793c 2f73 7061 6e3e 3c73 7061 6e20 636c  y</span><span cl
-00018580: 6173 733d 2270 223e 2c3c 2f73 7061 6e3e  ass="p">,</span>
-00018590: 203c 7370 616e 2063 6c61 7373 3d22 6e22   <span class="n"
-000185a0: 3e6e 756d 5f63 6f6e 663c 2f73 7061 6e3e  >num_conf</span>
-000185b0: 3c73 7061 6e20 636c 6173 733d 2270 223e  <span class="p">
-000185c0: 2c3c 2f73 7061 6e3e 203c 7370 616e 2063  ,</span> <span c
-000185d0: 6c61 7373 3d22 6e22 3e62 6174 6368 5f73  lass="n">batch_s
-000185e0: 697a 653c 2f73 7061 6e3e 0a20 2020 2020  ize</span>.     
-000185f0: 2020 2020 2020 2020 2020 2020 2020 203c                 <
-00018600: 7370 616e 2063 6c61 7373 3d22 7022 3e29  span class="p">)
-00018610: 3c2f 7370 616e 3e0a 2020 2020 2020 2020  </span>.        
-00018620: 2020 2020 2020 2020 3c73 7061 6e20 636c          <span cl
-00018630: 6173 733d 2270 223e 5d2c 3c2f 7370 616e  ass="p">],</span
-00018640: 3e0a 2020 2020 2020 2020 2020 2020 2020  >.              
-00018650: 2020 3c73 7061 6e20 636c 6173 733d 226e    <span class="n
-00018660: 223e 6446 5f69 6e69 743c 2f73 7061 6e3e  ">dF_init</span>
-00018670: 3c73 7061 6e20 636c 6173 733d 226f 223e  <span class="o">
-00018680: 2e3c 2f73 7061 6e3e 3c73 7061 6e20 636c  .</span><span cl
-00018690: 6173 733d 226e 223e 6370 753c 2f73 7061  ass="n">cpu</spa
-000186a0: 6e3e 3c73 7061 6e20 636c 6173 733d 2270  n><span class="p
-000186b0: 223e 2829 3c2f 7370 616e 3e3c 7370 616e  ">()</span><span
-000186c0: 2063 6c61 7373 3d22 6f22 3e2e 3c2f 7370   class="o">.</sp
-000186d0: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-000186e0: 6e22 3e6e 756d 7079 3c2f 7370 616e 3e3c  n">numpy</span><
-000186f0: 7370 616e 2063 6c61 7373 3d22 7022 3e28  span class="p">(
-00018700: 292c 3c2f 7370 616e 3e0a 2020 2020 2020  ),</span>.      
-00018710: 2020 2020 2020 2020 2020 3c73 7061 6e20            <span 
-00018720: 636c 6173 733d 226e 223e 6a61 633c 2f73  class="n">jac</s
-00018730: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
-00018740: 226f 223e 3d3c 2f73 7061 6e3e 3c73 7061  "o">=</span><spa
-00018750: 6e20 636c 6173 733d 226b 6322 3e54 7275  n class="kc">Tru
-00018760: 653c 2f73 7061 6e3e 3c73 7061 6e20 636c  e</span><span cl
-00018770: 6173 733d 2270 223e 2c3c 2f73 7061 6e3e  ass="p">,</span>
-00018780: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00018790: 203c 7370 616e 2063 6c61 7373 3d22 6e22   <span class="n"
-000187a0: 3e6d 6574 686f 643c 2f73 7061 6e3e 3c73  >method</span><s
-000187b0: 7061 6e20 636c 6173 733d 226f 223e 3d3c  pan class="o">=<
-000187c0: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
-000187d0: 733d 2273 3222 3e26 7175 6f74 3b4c 2d42  s="s2">&quot;L-B
-000187e0: 4647 532d 4226 7175 6f74 3b3c 2f73 7061  FGS-B&quot;</spa
-000187f0: 6e3e 3c73 7061 6e20 636c 6173 733d 2270  n><span class="p
-00018800: 223e 2c3c 2f73 7061 6e3e 0a20 2020 2020  ">,</span>.     
-00018810: 2020 2020 2020 2020 2020 203c 7370 616e             <span
-00018820: 2063 6c61 7373 3d22 6e22 3e74 6f6c 3c2f   class="n">tol</
-00018830: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
-00018840: 3d22 6f22 3e3d 3c2f 7370 616e 3e3c 7370  ="o">=</span><sp
-00018850: 616e 2063 6c61 7373 3d22 6d66 223e 3165  an class="mf">1e
-00018860: 2d31 323c 2f73 7061 6e3e 3c73 7061 6e20  -12</span><span 
-00018870: 636c 6173 733d 2270 223e 2c3c 2f73 7061  class="p">,</spa
-00018880: 6e3e 0a20 2020 2020 2020 2020 2020 2020  n>.             
-00018890: 2020 203c 7370 616e 2063 6c61 7373 3d22     <span class="
-000188a0: 6e22 3e6f 7074 696f 6e73 3c2f 7370 616e  n">options</span
-000188b0: 3e3c 7370 616e 2063 6c61 7373 3d22 6f22  ><span class="o"
-000188c0: 3e3d 3c2f 7370 616e 3e3c 7370 616e 2063  >=</span><span c
-000188d0: 6c61 7373 3d22 6e22 3e6f 7074 696f 6e73  lass="n">options
-000188e0: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-000188f0: 7373 3d22 7022 3e2c 3c2f 7370 616e 3e0a  ss="p">,</span>.
-00018900: 2020 2020 2020 2020 2020 2020 3c73 7061              <spa
-00018910: 6e20 636c 6173 733d 2270 223e 293c 2f73  n class="p">)</s
-00018920: 7061 6e3e 0a20 2020 2020 2020 2020 2020  pan>.           
-00018930: 203c 7370 616e 2063 6c61 7373 3d22 6b22   <span class="k"
-00018940: 3e72 6574 7572 6e3c 2f73 7061 6e3e 203c  >return</span> <
-00018950: 7370 616e 2063 6c61 7373 3d22 6e22 3e74  span class="n">t
-00018960: 6f72 6368 3c2f 7370 616e 3e3c 7370 616e  orch</span><span
-00018970: 2063 6c61 7373 3d22 6f22 3e2e 3c2f 7370   class="o">.</sp
-00018980: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-00018990: 6e22 3e66 726f 6d5f 6e75 6d70 793c 2f73  n">from_numpy</s
-000189a0: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
-000189b0: 2270 223e 283c 2f73 7061 6e3e 3c73 7061  "p">(</span><spa
-000189c0: 6e20 636c 6173 733d 226e 223e 7265 7375  n class="n">resu
-000189d0: 6c74 733c 2f73 7061 6e3e 3c73 7061 6e20  lts</span><span 
-000189e0: 636c 6173 733d 2270 223e 5b3c 2f73 7061  class="p">[</spa
-000189f0: 6e3e 3c73 7061 6e20 636c 6173 733d 2273  n><span class="s
-00018a00: 3222 3e26 7175 6f74 3b78 2671 756f 743b  2">&quot;x&quot;
-00018a10: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-00018a20: 7373 3d22 7022 3e5d 293c 2f73 7061 6e3e  ss="p">])</span>
-00018a30: 0a20 2020 203c 7370 616e 2063 6c61 7373  .    <span class
-00018a40: 3d22 6b22 3e65 6c73 653c 2f73 7061 6e3e  ="k">else</span>
-00018a50: 3c73 7061 6e20 636c 6173 733d 2270 223e  <span class="p">
-00018a60: 3a3c 2f73 7061 6e3e 0a20 2020 2020 2020  :</span>.       
-00018a70: 203c 7370 616e 2063 6c61 7373 3d22 6b22   <span class="k"
-00018a80: 3e69 663c 2f73 7061 6e3e 203c 7370 616e  >if</span> <span
-00018a90: 2063 6c61 7373 3d22 6e22 3e6d 6574 686f   class="n">metho
-00018aa0: 643c 2f73 7061 6e3e 203c 7370 616e 2063  d</span> <span c
-00018ab0: 6c61 7373 3d22 6f22 3e3d 3d3c 2f73 7061  lass="o">==</spa
-00018ac0: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
-00018ad0: 7332 223e 2671 756f 743b 4e65 7774 6f6e  s2">&quot;Newton
-00018ae0: 2671 756f 743b 3c2f 7370 616e 3e3c 7370  &quot;</span><sp
-00018af0: 616e 2063 6c61 7373 3d22 7022 3e3a 3c2f  an class="p">:</
-00018b00: 7370 616e 3e0a 2020 2020 2020 2020 2020  span>.          
-00018b10: 2020 3c73 7061 6e20 636c 6173 733d 226e    <span class="n
-00018b20: 223e 7265 7375 6c74 733c 2f73 7061 6e3e  ">results</span>
-00018b30: 203c 7370 616e 2063 6c61 7373 3d22 6f22   <span class="o"
-00018b40: 3e3d 3c2f 7370 616e 3e20 3c73 7061 6e20  >=</span> <span 
-00018b50: 636c 6173 733d 226e 223e 666d 696e 5f6e  class="n">fmin_n
-00018b60: 6577 746f 6e3c 2f73 7061 6e3e 3c73 7061  ewton</span><spa
-00018b70: 6e20 636c 6173 733d 2270 223e 283c 2f73  n class="p">(</s
-00018b80: 7061 6e3e 0a20 2020 2020 2020 2020 2020  pan>.           
-00018b90: 2020 2020 203c 7370 616e 2063 6c61 7373       <span class
-00018ba0: 3d22 6e22 3e66 3c2f 7370 616e 3e3c 7370  ="n">f</span><sp
-00018bb0: 616e 2063 6c61 7373 3d22 6f22 3e3d 3c2f  an class="o">=</
-00018bc0: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
-00018bd0: 3d22 6e22 3e5f 636f 6d70 7574 655f 6c6f  ="n">_compute_lo
-00018be0: 7373 5f61 6e64 5f67 7261 645f 6f66 5f64  ss_and_grad_of_d
-00018bf0: 463c 2f73 7061 6e3e 3c73 7061 6e20 636c  F</span><span cl
-00018c00: 6173 733d 2270 223e 2c3c 2f73 7061 6e3e  ass="p">,</span>
-00018c10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00018c20: 203c 7370 616e 2063 6c61 7373 3d22 6e22   <span class="n"
-00018c30: 3e68 6573 733c 2f73 7061 6e3e 3c73 7061  >hess</span><spa
-00018c40: 6e20 636c 6173 733d 226f 223e 3d3c 2f73  n class="o">=</s
-00018c50: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
-00018c60: 226e 223e 5f63 6f6d 7075 7465 5f68 6573  "n">_compute_hes
-00018c70: 7369 616e 5f6c 6f73 735f 6f66 5f64 463c  sian_loss_of_dF<
-00018c80: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
-00018c90: 733d 2270 223e 2c3c 2f73 7061 6e3e 0a20  s="p">,</span>. 
-00018ca0: 2020 2020 2020 2020 2020 2020 2020 203c                 <
-00018cb0: 7370 616e 2063 6c61 7373 3d22 6e22 3e78  span class="n">x
-00018cc0: 5f69 6e69 743c 2f73 7061 6e3e 3c73 7061  _init</span><spa
-00018cd0: 6e20 636c 6173 733d 226f 223e 3d3c 2f73  n class="o">=</s
-00018ce0: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
-00018cf0: 226e 223e 6446 5f69 6e69 743c 2f73 7061  "n">dF_init</spa
-00018d00: 6e3e 3c73 7061 6e20 636c 6173 733d 2270  n><span class="p
-00018d10: 223e 2c3c 2f73 7061 6e3e 0a20 2020 2020  ">,</span>.     
-00018d20: 2020 2020 2020 2020 2020 203c 7370 616e             <span
-00018d30: 2063 6c61 7373 3d22 6e22 3e61 7267 733c   class="n">args<
-00018d40: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
-00018d50: 733d 226f 223e 3d3c 2f73 7061 6e3e 3c73  s="o">=</span><s
-00018d60: 7061 6e20 636c 6173 733d 2270 223e 283c  pan class="p">(<
-00018d70: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
-00018d80: 733d 226e 223e 656e 6572 6779 3c2f 7370  s="n">energy</sp
-00018d90: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-00018da0: 7022 3e2c 3c2f 7370 616e 3e20 3c73 7061  p">,</span> <spa
-00018db0: 6e20 636c 6173 733d 226e 223e 6e75 6d5f  n class="n">num_
-00018dc0: 636f 6e66 3c2f 7370 616e 3e3c 7370 616e  conf</span><span
-00018dd0: 2063 6c61 7373 3d22 7022 3e29 2c3c 2f73   class="p">),</s
-00018de0: 7061 6e3e 0a20 2020 2020 2020 2020 2020  pan>.           
-00018df0: 2020 2020 203c 7370 616e 2063 6c61 7373       <span class
-00018e00: 3d22 6e22 3e76 6572 626f 7365 3c2f 7370  ="n">verbose</sp
-00018e10: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-00018e20: 6f22 3e3d 3c2f 7370 616e 3e3c 7370 616e  o">=</span><span
-00018e30: 2063 6c61 7373 3d22 6e22 3e76 6572 626f   class="n">verbo
-00018e40: 7365 3c2f 7370 616e 3e3c 7370 616e 2063  se</span><span c
-00018e50: 6c61 7373 3d22 7022 3e2c 3c2f 7370 616e  lass="p">,</span
-00018e60: 3e0a 2020 2020 2020 2020 2020 2020 3c73  >.            <s
-00018e70: 7061 6e20 636c 6173 733d 2270 223e 293c  pan class="p">)<
-00018e80: 2f73 7061 6e3e 0a20 2020 2020 2020 2020  /span>.         
-00018e90: 2020 203c 7370 616e 2063 6c61 7373 3d22     <span class="
-00018ea0: 6b22 3e72 6574 7572 6e3c 2f73 7061 6e3e  k">return</span>
-00018eb0: 203c 7370 616e 2063 6c61 7373 3d22 6e22   <span class="n"
-00018ec0: 3e72 6573 756c 7473 3c2f 7370 616e 3e3c  >results</span><
-00018ed0: 7370 616e 2063 6c61 7373 3d22 7022 3e5b  span class="p">[
-00018ee0: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-00018ef0: 7373 3d22 7332 223e 2671 756f 743b 7826  ss="s2">&quot;x&
-00018f00: 7175 6f74 3b3c 2f73 7061 6e3e 3c73 7061  quot;</span><spa
-00018f10: 6e20 636c 6173 733d 2270 223e 5d3c 2f73  n class="p">]</s
-00018f20: 7061 6e3e 0a20 2020 2020 2020 203c 7370  pan>.        <sp
-00018f30: 616e 2063 6c61 7373 3d22 6b22 3e65 6c69  an class="k">eli
-00018f40: 663c 2f73 7061 6e3e 203c 7370 616e 2063  f</span> <span c
-00018f50: 6c61 7373 3d22 6e22 3e6d 6574 686f 643c  lass="n">method<
-00018f60: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
-00018f70: 7373 3d22 6f22 3e3d 3d3c 2f73 7061 6e3e  ss="o">==</span>
-00018f80: 203c 7370 616e 2063 6c61 7373 3d22 7332   <span class="s2
-00018f90: 223e 2671 756f 743b 4c2d 4246 4753 2d42  ">&quot;L-BFGS-B
-00018fa0: 2671 756f 743b 3c2f 7370 616e 3e3c 7370  &quot;</span><sp
-00018fb0: 616e 2063 6c61 7373 3d22 7022 3e3a 3c2f  an class="p">:</
-00018fc0: 7370 616e 3e0a 2020 2020 2020 2020 2020  span>.          
-00018fd0: 2020 3c73 7061 6e20 636c 6173 733d 226e    <span class="n
-00018fe0: 223e 6f70 7469 6f6e 733c 2f73 7061 6e3e  ">options</span>
-00018ff0: 203c 7370 616e 2063 6c61 7373 3d22 6f22   <span class="o"
-00019000: 3e3d 3c2f 7370 616e 3e20 3c73 7061 6e20  >=</span> <span 
-00019010: 636c 6173 733d 2270 223e 7b3c 2f73 7061  class="p">{</spa
-00019020: 6e3e 3c73 7061 6e20 636c 6173 733d 2273  n><span class="s
-00019030: 3222 3e26 7175 6f74 3b64 6973 7026 7175  2">&quot;disp&qu
-00019040: 6f74 3b3c 2f73 7061 6e3e 3c73 7061 6e20  ot;</span><span 
-00019050: 636c 6173 733d 2270 223e 3a3c 2f73 7061  class="p">:</spa
-00019060: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
-00019070: 6e22 3e76 6572 626f 7365 3c2f 7370 616e  n">verbose</span
-00019080: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
-00019090: 3e2c 3c2f 7370 616e 3e20 3c73 7061 6e20  >,</span> <span 
-000190a0: 636c 6173 733d 2273 3222 3e26 7175 6f74  class="s2">&quot
-000190b0: 3b67 746f 6c26 7175 6f74 3b3c 2f73 7061  ;gtol&quot;</spa
-000190c0: 6e3e 3c73 7061 6e20 636c 6173 733d 2270  n><span class="p
-000190d0: 223e 3a3c 2f73 7061 6e3e 203c 7370 616e  ">:</span> <span
-000190e0: 2063 6c61 7373 3d22 6d66 223e 3165 2d38   class="mf">1e-8
-000190f0: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-00019100: 7373 3d22 7022 3e7d 3c2f 7370 616e 3e0a  ss="p">}</span>.
-00019110: 2020 2020 2020 2020 2020 2020 3c73 7061              <spa
-00019120: 6e20 636c 6173 733d 226e 223e 7265 7375  n class="n">resu
-00019130: 6c74 733c 2f73 7061 6e3e 203c 7370 616e  lts</span> <span
-00019140: 2063 6c61 7373 3d22 6f22 3e3d 3c2f 7370   class="o">=</sp
-00019150: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
-00019160: 226e 223e 6f70 7469 6d69 7a65 3c2f 7370  "n">optimize</sp
-00019170: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-00019180: 6f22 3e2e 3c2f 7370 616e 3e3c 7370 616e  o">.</span><span
-00019190: 2063 6c61 7373 3d22 6e22 3e6d 696e 696d   class="n">minim
-000191a0: 697a 653c 2f73 7061 6e3e 3c73 7061 6e20  ize</span><span 
-000191b0: 636c 6173 733d 2270 223e 283c 2f73 7061  class="p">(</spa
-000191c0: 6e3e 0a20 2020 2020 2020 2020 2020 2020  n>.             
-000191d0: 2020 203c 7370 616e 2063 6c61 7373 3d22     <span class="
-000191e0: 6b22 3e6c 616d 6264 613c 2f73 7061 6e3e  k">lambda</span>
-000191f0: 203c 7370 616e 2063 6c61 7373 3d22 6e22   <span class="n"
-00019200: 3e78 3c2f 7370 616e 3e3c 7370 616e 2063  >x</span><span c
-00019210: 6c61 7373 3d22 7022 3e3a 3c2f 7370 616e  lass="p">:</span
-00019220: 3e20 3c73 7061 6e20 636c 6173 733d 2270  > <span class="p
-00019230: 223e 5b3c 2f73 7061 6e3e 0a20 2020 2020  ">[</span>.     
-00019240: 2020 2020 2020 2020 2020 2020 2020 203c                 <
-00019250: 7370 616e 2063 6c61 7373 3d22 6e22 3e72  span class="n">r
-00019260: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-00019270: 7373 3d22 6f22 3e2e 3c2f 7370 616e 3e3c  ss="o">.</span><
-00019280: 7370 616e 2063 6c61 7373 3d22 6e22 3e63  span class="n">c
-00019290: 7075 3c2f 7370 616e 3e3c 7370 616e 2063  pu</span><span c
-000192a0: 6c61 7373 3d22 7022 3e28 293c 2f73 7061  lass="p">()</spa
-000192b0: 6e3e 3c73 7061 6e20 636c 6173 733d 226f  n><span class="o
-000192c0: 223e 2e3c 2f73 7061 6e3e 3c73 7061 6e20  ">.</span><span 
-000192d0: 636c 6173 733d 226e 223e 6e75 6d70 793c  class="n">numpy<
-000192e0: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
-000192f0: 733d 2270 223e 2829 3c2f 7370 616e 3e0a  s="p">()</span>.
-00019300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019310: 2020 2020 3c73 7061 6e20 636c 6173 733d      <span class=
-00019320: 226b 223e 666f 723c 2f73 7061 6e3e 203c  "k">for</span> <
-00019330: 7370 616e 2063 6c61 7373 3d22 6e22 3e72  span class="n">r
-00019340: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
-00019350: 6173 733d 226f 7722 3e69 6e3c 2f73 7061  ass="ow">in</spa
-00019360: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
-00019370: 6e22 3e5f 636f 6d70 7574 655f 6c6f 7373  n">_compute_loss
-00019380: 5f61 6e64 5f67 7261 645f 6f66 5f64 463c  _and_grad_of_dF<
-00019390: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
-000193a0: 733d 2270 223e 283c 2f73 7061 6e3e 0a20  s="p">(</span>. 
-000193b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000193c0: 2020 2020 2020 203c 7370 616e 2063 6c61         <span cla
-000193d0: 7373 3d22 6e22 3e65 6e65 7267 793c 2f73  ss="n">energy</s
-000193e0: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
-000193f0: 226f 223e 2e3c 2f73 7061 6e3e 3c73 7061  "o">.</span><spa
-00019400: 6e20 636c 6173 733d 226e 223e 6e65 775f  n class="n">new_
-00019410: 7465 6e73 6f72 3c2f 7370 616e 3e3c 7370  tensor</span><sp
-00019420: 616e 2063 6c61 7373 3d22 7022 3e28 3c2f  an class="p">(</
-00019430: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
-00019440: 3d22 6e22 3e78 3c2f 7370 616e 3e3c 7370  ="n">x</span><sp
-00019450: 616e 2063 6c61 7373 3d22 7022 3e29 2c3c  an class="p">),<
-00019460: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
-00019470: 7373 3d22 6e22 3e65 6e65 7267 793c 2f73  ss="n">energy</s
-00019480: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
-00019490: 2270 223e 2c3c 2f73 7061 6e3e 203c 7370  "p">,</span> <sp
-000194a0: 616e 2063 6c61 7373 3d22 6e22 3e6e 756d  an class="n">num
-000194b0: 5f63 6f6e 663c 2f73 7061 6e3e 0a20 2020  _conf</span>.   
-000194c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000194d0: 203c 7370 616e 2063 6c61 7373 3d22 7022   <span class="p"
-000194e0: 3e29 3c2f 7370 616e 3e0a 2020 2020 2020  >)</span>.      
-000194f0: 2020 2020 2020 2020 2020 3c73 7061 6e20            <span 
-00019500: 636c 6173 733d 2270 223e 5d2c 3c2f 7370  class="p">],</sp
-00019510: 616e 3e0a 2020 2020 2020 2020 2020 2020  an>.            
-00019520: 2020 2020 3c73 7061 6e20 636c 6173 733d      <span class=
-00019530: 226e 223e 6446 5f69 6e69 743c 2f73 7061  "n">dF_init</spa
-00019540: 6e3e 3c73 7061 6e20 636c 6173 733d 226f  n><span class="o
-00019550: 223e 2e3c 2f73 7061 6e3e 3c73 7061 6e20  ">.</span><span 
-00019560: 636c 6173 733d 226e 223e 6370 753c 2f73  class="n">cpu</s
-00019570: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
-00019580: 2270 223e 2829 3c2f 7370 616e 3e3c 7370  "p">()</span><sp
-00019590: 616e 2063 6c61 7373 3d22 6f22 3e2e 3c2f  an class="o">.</
-000195a0: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
-000195b0: 3d22 6e22 3e6e 756d 7079 3c2f 7370 616e  ="n">numpy</span
-000195c0: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
-000195d0: 3e28 292c 3c2f 7370 616e 3e0a 2020 2020  >(),</span>.    
-000195e0: 2020 2020 2020 2020 2020 2020 3c73 7061              <spa
-000195f0: 6e20 636c 6173 733d 226e 223e 6a61 633c  n class="n">jac<
-00019600: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
-00019610: 733d 226f 223e 3d3c 2f73 7061 6e3e 3c73  s="o">=</span><s
-00019620: 7061 6e20 636c 6173 733d 226b 6322 3e54  pan class="kc">T
-00019630: 7275 653c 2f73 7061 6e3e 3c73 7061 6e20  rue</span><span 
-00019640: 636c 6173 733d 2270 223e 2c3c 2f73 7061  class="p">,</spa
-00019650: 6e3e 0a20 2020 2020 2020 2020 2020 2020  n>.             
-00019660: 2020 203c 7370 616e 2063 6c61 7373 3d22     <span class="
-00019670: 6e22 3e6d 6574 686f 643c 2f73 7061 6e3e  n">method</span>
-00019680: 3c73 7061 6e20 636c 6173 733d 226f 223e  <span class="o">
-00019690: 3d3c 2f73 7061 6e3e 3c73 7061 6e20 636c  =</span><span cl
-000196a0: 6173 733d 2273 3222 3e26 7175 6f74 3b4c  ass="s2">&quot;L
-000196b0: 2d42 4647 532d 4226 7175 6f74 3b3c 2f73  -BFGS-B&quot;</s
-000196c0: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
-000196d0: 2270 223e 2c3c 2f73 7061 6e3e 0a20 2020  "p">,</span>.   
-000196e0: 2020 2020 2020 2020 2020 2020 203c 7370               <sp
-000196f0: 616e 2063 6c61 7373 3d22 6e22 3e74 6f6c  an class="n">tol
-00019700: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-00019710: 7373 3d22 6f22 3e3d 3c2f 7370 616e 3e3c  ss="o">=</span><
-00019720: 7370 616e 2063 6c61 7373 3d22 6d66 223e  span class="mf">
-00019730: 3165 2d31 323c 2f73 7061 6e3e 3c73 7061  1e-12</span><spa
-00019740: 6e20 636c 6173 733d 2270 223e 2c3c 2f73  n class="p">,</s
-00019750: 7061 6e3e 0a20 2020 2020 2020 2020 2020  pan>.           
-00019760: 2020 2020 203c 7370 616e 2063 6c61 7373       <span class
-00019770: 3d22 6e22 3e6f 7074 696f 6e73 3c2f 7370  ="n">options</sp
-00019780: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-00019790: 6f22 3e3d 3c2f 7370 616e 3e3c 7370 616e  o">=</span><span
-000197a0: 2063 6c61 7373 3d22 6e22 3e6f 7074 696f   class="n">optio
-000197b0: 6e73 3c2f 7370 616e 3e3c 7370 616e 2063  ns</span><span c
-000197c0: 6c61 7373 3d22 7022 3e2c 3c2f 7370 616e  lass="p">,</span
-000197d0: 3e0a 2020 2020 2020 2020 2020 2020 3c73  >.            <s
-000197e0: 7061 6e20 636c 6173 733d 2270 223e 293c  pan class="p">)<
-000197f0: 2f73 7061 6e3e 0a20 2020 2020 2020 2020  /span>.         
-00019800: 2020 203c 7370 616e 2063 6c61 7373 3d22     <span class="
-00019810: 6b22 3e72 6574 7572 6e3c 2f73 7061 6e3e  k">return</span>
-00019820: 203c 7370 616e 2063 6c61 7373 3d22 6e22   <span class="n"
-00019830: 3e74 6f72 6368 3c2f 7370 616e 3e3c 7370  >torch</span><sp
-00019840: 616e 2063 6c61 7373 3d22 6f22 3e2e 3c2f  an class="o">.</
-00019850: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
-00019860: 3d22 6e22 3e66 726f 6d5f 6e75 6d70 793c  ="n">from_numpy<
-00019870: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
-00019880: 733d 2270 223e 283c 2f73 7061 6e3e 3c73  s="p">(</span><s
-00019890: 7061 6e20 636c 6173 733d 226e 223e 7265  pan class="n">re
-000198a0: 7375 6c74 733c 2f73 7061 6e3e 3c73 7061  sults</span><spa
-000198b0: 6e20 636c 6173 733d 2270 223e 5b3c 2f73  n class="p">[</s
-000198c0: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
-000198d0: 2273 3222 3e26 7175 6f74 3b78 2671 756f  "s2">&quot;x&quo
-000198e0: 743b 3c2f 7370 616e 3e3c 7370 616e 2063  t;</span><span c
-000198f0: 6c61 7373 3d22 7022 3e5d 293c 2f73 7061  lass="p">])</spa
-00019900: 6e3e 0a0a 0a3c 7370 616e 2063 6c61 7373  n>...<span class
-00019910: 3d22 6b22 3e64 6566 3c2f 7370 616e 3e20  ="k">def</span> 
-00019920: 3c73 7061 6e20 636c 6173 733d 226e 6622  <span class="nf"
-00019930: 3e5f 626f 6f74 7374 7261 705f 636f 6e66  >_bootstrap_conf
-00019940: 5f69 6478 3c2f 7370 616e 3e3c 7370 616e  _idx</span><span
-00019950: 2063 6c61 7373 3d22 7022 3e28 3c2f 7370   class="p">(</sp
-00019960: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-00019970: 6e22 3e6e 756d 5f63 6f6e 663c 2f73 7061  n">num_conf</spa
-00019980: 6e3e 3c73 7061 6e20 636c 6173 733d 2270  n><span class="p
-00019990: 223e 2c3c 2f73 7061 6e3e 203c 7370 616e  ">,</span> <span
-000199a0: 2063 6c61 7373 3d22 6e22 3e62 6f6f 7473   class="n">boots
-000199b0: 7472 6170 5f62 6c6f 636b 5f73 697a 653c  trap_block_size<
-000199c0: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
-000199d0: 733d 2270 223e 293a 3c2f 7370 616e 3e0a  s="p">):</span>.
-000199e0: 2020 2020 3c73 7061 6e20 636c 6173 733d      <span class=
-000199f0: 226e 223e 6e75 6d5f 636f 6e66 5f63 756d  "n">num_conf_cum
-00019a00: 7375 6d3c 2f73 7061 6e3e 203c 7370 616e  sum</span> <span
-00019a10: 2063 6c61 7373 3d22 6f22 3e3d 3c2f 7370   class="o">=</sp
-00019a20: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
-00019a30: 226e 223e 746f 7263 683c 2f73 7061 6e3e  "n">torch</span>
-00019a40: 3c73 7061 6e20 636c 6173 733d 226f 223e  <span class="o">
-00019a50: 2e3c 2f73 7061 6e3e 3c73 7061 6e20 636c  .</span><span cl
-00019a60: 6173 733d 226e 223e 6375 6d73 756d 3c2f  ass="n">cumsum</
-00019a70: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
-00019a80: 3d22 7022 3e28 3c2f 7370 616e 3e3c 7370  ="p">(</span><sp
-00019a90: 616e 2063 6c61 7373 3d22 6e22 3e6e 756d  an class="n">num
-00019aa0: 5f63 6f6e 663c 2f73 7061 6e3e 3c73 7061  _conf</span><spa
-00019ab0: 6e20 636c 6173 733d 2270 223e 2c3c 2f73  n class="p">,</s
-00019ac0: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
-00019ad0: 3d22 6e22 3e64 696d 3c2f 7370 616e 3e3c  ="n">dim</span><
-00019ae0: 7370 616e 2063 6c61 7373 3d22 6f22 3e3d  span class="o">=
+00017520: 7022 3e28 5b3c 2f73 7061 6e3e 3c73 7061  p">([</span><spa
+00017530: 6e20 636c 6173 733d 226e 223e 6446 3c2f  n class="n">dF</
+00017540: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+00017550: 3d22 6f22 3e2e 3c2f 7370 616e 3e3c 7370  ="o">.</span><sp
+00017560: 616e 2063 6c61 7373 3d22 6e22 3e6e 6577  an class="n">new
+00017570: 5f7a 6572 6f73 3c2f 7370 616e 3e3c 7370  _zeros</span><sp
+00017580: 616e 2063 6c61 7373 3d22 7022 3e28 3c2f  an class="p">(</
+00017590: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+000175a0: 3d22 6d69 223e 313c 2f73 7061 6e3e 3c73  ="mi">1</span><s
+000175b0: 7061 6e20 636c 6173 733d 2270 223e 292c  pan class="p">),
+000175c0: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
+000175d0: 6173 733d 226e 223e 6446 3c2f 7370 616e  ass="n">dF</span
+000175e0: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
+000175f0: 3e5d 293c 2f73 7061 6e3e 0a20 2020 203c  >])</span>.    <
+00017600: 7370 616e 2063 6c61 7373 3d22 6e22 3e48  span class="n">H
+00017610: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
+00017620: 6173 733d 226f 223e 3d3c 2f73 7061 6e3e  ass="o">=</span>
+00017630: 203c 7370 616e 2063 6c61 7373 3d22 6e22   <span class="n"
+00017640: 3e5f 636f 6d70 7574 655f 6865 7373 6961  >_compute_hessia
+00017650: 6e5f 6c6f 675f 6c69 6b65 6c69 686f 6f64  n_log_likelihood
+00017660: 5f6f 665f 465f 696e 5f62 6174 6368 3c2f  _of_F_in_batch</
+00017670: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+00017680: 3d22 7022 3e28 3c2f 7370 616e 3e3c 7370  ="p">(</span><sp
+00017690: 616e 2063 6c61 7373 3d22 6e22 3e46 3c2f  an class="n">F</
+000176a0: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+000176b0: 3d22 7022 3e2c 3c2f 7370 616e 3e20 3c73  ="p">,</span> <s
+000176c0: 7061 6e20 636c 6173 733d 226e 223e 656e  pan class="n">en
+000176d0: 6572 6779 3c2f 7370 616e 3e3c 7370 616e  ergy</span><span
+000176e0: 2063 6c61 7373 3d22 7022 3e2c 3c2f 7370   class="p">,</sp
+000176f0: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
+00017700: 226e 223e 6e75 6d5f 636f 6e66 3c2f 7370  "n">num_conf</sp
+00017710: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+00017720: 7022 3e2c 3c2f 7370 616e 3e20 3c73 7061  p">,</span> <spa
+00017730: 6e20 636c 6173 733d 226e 223e 6261 7463  n class="n">batc
+00017740: 685f 7369 7a65 3c2f 7370 616e 3e3c 7370  h_size</span><sp
+00017750: 616e 2063 6c61 7373 3d22 7022 3e29 3c2f  an class="p">)</
+00017760: 7370 616e 3e0a 2020 2020 3c73 7061 6e20  span>.    <span 
+00017770: 636c 6173 733d 226e 223e 483c 2f73 7061  class="n">H</spa
+00017780: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
+00017790: 6f22 3e3d 3c2f 7370 616e 3e20 3c73 7061  o">=</span> <spa
+000177a0: 6e20 636c 6173 733d 226f 223e 2d3c 2f73  n class="o">-</s
+000177b0: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
+000177c0: 226e 223e 483c 2f73 7061 6e3e 3c73 7061  "n">H</span><spa
+000177d0: 6e20 636c 6173 733d 2270 223e 5b3c 2f73  n class="p">[</s
+000177e0: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
+000177f0: 226d 6922 3e31 3c2f 7370 616e 3e3c 7370  "mi">1</span><sp
+00017800: 616e 2063 6c61 7373 3d22 7022 3e3a 2c3c  an class="p">:,<
+00017810: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
+00017820: 7373 3d22 6d69 223e 313c 2f73 7061 6e3e  ss="mi">1</span>
+00017830: 3c73 7061 6e20 636c 6173 733d 2270 223e  <span class="p">
+00017840: 3a5d 3c2f 7370 616e 3e20 3c73 7061 6e20  :]</span> <span 
+00017850: 636c 6173 733d 226f 223e 2f3c 2f73 7061  class="o">/</spa
+00017860: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
+00017870: 6e22 3e4e 3c2f 7370 616e 3e0a 2020 2020  n">N</span>.    
+00017880: 3c73 7061 6e20 636c 6173 733d 226b 223e  <span class="k">
+00017890: 7265 7475 726e 3c2f 7370 616e 3e20 3c73  return</span> <s
+000178a0: 7061 6e20 636c 6173 733d 226e 223e 483c  pan class="n">H<
+000178b0: 2f73 7061 6e3e 0a0a 0a3c 7370 616e 2063  /span>...<span c
+000178c0: 6c61 7373 3d22 6b22 3e64 6566 3c2f 7370  lass="k">def</sp
+000178d0: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
+000178e0: 226e 6622 3e5f 736f 6c76 655f 6d62 6172  "nf">_solve_mbar
+000178f0: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
+00017900: 7373 3d22 7022 3e28 3c2f 7370 616e 3e3c  ss="p">(</span><
+00017910: 7370 616e 2063 6c61 7373 3d22 6e22 3e64  span class="n">d
+00017920: 465f 696e 6974 3c2f 7370 616e 3e3c 7370  F_init</span><sp
+00017930: 616e 2063 6c61 7373 3d22 7022 3e2c 3c2f  an class="p">,</
+00017940: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
+00017950: 733d 226e 223e 656e 6572 6779 3c2f 7370  s="n">energy</sp
+00017960: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+00017970: 7022 3e2c 3c2f 7370 616e 3e20 3c73 7061  p">,</span> <spa
+00017980: 6e20 636c 6173 733d 226e 223e 6e75 6d5f  n class="n">num_
+00017990: 636f 6e66 3c2f 7370 616e 3e3c 7370 616e  conf</span><span
+000179a0: 2063 6c61 7373 3d22 7022 3e2c 3c2f 7370   class="p">,</sp
+000179b0: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
+000179c0: 226e 223e 6d65 7468 6f64 3c2f 7370 616e  "n">method</span
+000179d0: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
+000179e0: 3e2c 3c2f 7370 616e 3e20 3c73 7061 6e20  >,</span> <span 
+000179f0: 636c 6173 733d 226e 223e 6261 7463 685f  class="n">batch_
+00017a00: 7369 7a65 3c2f 7370 616e 3e3c 7370 616e  size</span><span
+00017a10: 2063 6c61 7373 3d22 6f22 3e3d 3c2f 7370   class="o">=</sp
+00017a20: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+00017a30: 6b63 223e 4e6f 6e65 3c2f 7370 616e 3e3c  kc">None</span><
+00017a40: 7370 616e 2063 6c61 7373 3d22 7022 3e2c  span class="p">,
+00017a50: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
+00017a60: 6173 733d 226e 223e 7665 7262 6f73 653c  ass="n">verbose<
+00017a70: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
+00017a80: 733d 226f 223e 3d3c 2f73 7061 6e3e 3c73  s="o">=</span><s
+00017a90: 7061 6e20 636c 6173 733d 226b 6322 3e46  pan class="kc">F
+00017aa0: 616c 7365 3c2f 7370 616e 3e3c 7370 616e  alse</span><span
+00017ab0: 2063 6c61 7373 3d22 7022 3e29 3a3c 2f73   class="p">):</s
+00017ac0: 7061 6e3e 0a20 2020 203c 7370 616e 2063  pan>.    <span c
+00017ad0: 6c61 7373 3d22 6b22 3e69 663c 2f73 7061  lass="k">if</spa
+00017ae0: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
+00017af0: 6e22 3e62 6174 6368 5f73 697a 653c 2f73  n">batch_size</s
+00017b00: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
+00017b10: 3d22 6f77 223e 6973 3c2f 7370 616e 3e20  ="ow">is</span> 
+00017b20: 3c73 7061 6e20 636c 6173 733d 226f 7722  <span class="ow"
+00017b30: 3e6e 6f74 3c2f 7370 616e 3e20 3c73 7061  >not</span> <spa
+00017b40: 6e20 636c 6173 733d 226b 6322 3e4e 6f6e  n class="kc">Non
+00017b50: 653c 2f73 7061 6e3e 3c73 7061 6e20 636c  e</span><span cl
+00017b60: 6173 733d 2270 223e 3a3c 2f73 7061 6e3e  ass="p">:</span>
+00017b70: 0a20 2020 2020 2020 203c 7370 616e 2063  .        <span c
+00017b80: 6c61 7373 3d22 6b22 3e69 663c 2f73 7061  lass="k">if</spa
+00017b90: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
+00017ba0: 6e22 3e6d 6574 686f 643c 2f73 7061 6e3e  n">method</span>
+00017bb0: 203c 7370 616e 2063 6c61 7373 3d22 6f22   <span class="o"
+00017bc0: 3e3d 3d3c 2f73 7061 6e3e 203c 7370 616e  >==</span> <span
+00017bd0: 2063 6c61 7373 3d22 7332 223e 2671 756f   class="s2">&quo
+00017be0: 743b 4e65 7774 6f6e 2671 756f 743b 3c2f  t;Newton&quot;</
+00017bf0: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+00017c00: 3d22 7022 3e3a 3c2f 7370 616e 3e0a 2020  ="p">:</span>.  
+00017c10: 2020 2020 2020 2020 2020 3c73 7061 6e20            <span 
+00017c20: 636c 6173 733d 226e 223e 7265 7375 6c74  class="n">result
+00017c30: 733c 2f73 7061 6e3e 203c 7370 616e 2063  s</span> <span c
+00017c40: 6c61 7373 3d22 6f22 3e3d 3c2f 7370 616e  lass="o">=</span
+00017c50: 3e20 3c73 7061 6e20 636c 6173 733d 226e  > <span class="n
+00017c60: 223e 666d 696e 5f6e 6577 746f 6e3c 2f73  ">fmin_newton</s
+00017c70: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
+00017c80: 2270 223e 283c 2f73 7061 6e3e 0a20 2020  "p">(</span>.   
+00017c90: 2020 2020 2020 2020 2020 2020 203c 7370               <sp
+00017ca0: 616e 2063 6c61 7373 3d22 6e22 3e66 3c2f  an class="n">f</
+00017cb0: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+00017cc0: 3d22 6f22 3e3d 3c2f 7370 616e 3e3c 7370  ="o">=</span><sp
+00017cd0: 616e 2063 6c61 7373 3d22 6e22 3e5f 636f  an class="n">_co
+00017ce0: 6d70 7574 655f 6c6f 7373 5f61 6e64 5f67  mpute_loss_and_g
+00017cf0: 7261 645f 6f66 5f64 465f 696e 5f62 6174  rad_of_dF_in_bat
+00017d00: 6368 3c2f 7370 616e 3e3c 7370 616e 2063  ch</span><span c
+00017d10: 6c61 7373 3d22 7022 3e2c 3c2f 7370 616e  lass="p">,</span
+00017d20: 3e0a 2020 2020 2020 2020 2020 2020 2020  >.              
+00017d30: 2020 3c73 7061 6e20 636c 6173 733d 226e    <span class="n
+00017d40: 223e 6865 7373 3c2f 7370 616e 3e3c 7370  ">hess</span><sp
+00017d50: 616e 2063 6c61 7373 3d22 6f22 3e3d 3c2f  an class="o">=</
+00017d60: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+00017d70: 3d22 6e22 3e5f 636f 6d70 7574 655f 6865  ="n">_compute_he
+00017d80: 7373 6961 6e5f 6c6f 7373 5f6f 665f 6446  ssian_loss_of_dF
+00017d90: 5f69 6e5f 6261 7463 683c 2f73 7061 6e3e  _in_batch</span>
+00017da0: 3c73 7061 6e20 636c 6173 733d 2270 223e  <span class="p">
+00017db0: 2c3c 2f73 7061 6e3e 0a20 2020 2020 2020  ,</span>.       
+00017dc0: 2020 2020 2020 2020 203c 7370 616e 2063           <span c
+00017dd0: 6c61 7373 3d22 6e22 3e78 5f69 6e69 743c  lass="n">x_init<
+00017de0: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
+00017df0: 733d 226f 223e 3d3c 2f73 7061 6e3e 3c73  s="o">=</span><s
+00017e00: 7061 6e20 636c 6173 733d 226e 223e 6446  pan class="n">dF
+00017e10: 5f69 6e69 743c 2f73 7061 6e3e 3c73 7061  _init</span><spa
+00017e20: 6e20 636c 6173 733d 2270 223e 2c3c 2f73  n class="p">,</s
+00017e30: 7061 6e3e 0a20 2020 2020 2020 2020 2020  pan>.           
+00017e40: 2020 2020 203c 7370 616e 2063 6c61 7373       <span class
+00017e50: 3d22 6e22 3e61 7267 733c 2f73 7061 6e3e  ="n">args</span>
+00017e60: 3c73 7061 6e20 636c 6173 733d 226f 223e  <span class="o">
+00017e70: 3d3c 2f73 7061 6e3e 3c73 7061 6e20 636c  =</span><span cl
+00017e80: 6173 733d 2270 223e 283c 2f73 7061 6e3e  ass="p">(</span>
+00017e90: 3c73 7061 6e20 636c 6173 733d 226e 223e  <span class="n">
+00017ea0: 656e 6572 6779 3c2f 7370 616e 3e3c 7370  energy</span><sp
+00017eb0: 616e 2063 6c61 7373 3d22 7022 3e2c 3c2f  an class="p">,</
+00017ec0: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
+00017ed0: 733d 226e 223e 6e75 6d5f 636f 6e66 3c2f  s="n">num_conf</
+00017ee0: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+00017ef0: 3d22 7022 3e2c 3c2f 7370 616e 3e20 3c73  ="p">,</span> <s
+00017f00: 7061 6e20 636c 6173 733d 226e 223e 6261  pan class="n">ba
+00017f10: 7463 685f 7369 7a65 3c2f 7370 616e 3e3c  tch_size</span><
+00017f20: 7370 616e 2063 6c61 7373 3d22 7022 3e29  span class="p">)
+00017f30: 2c3c 2f73 7061 6e3e 0a20 2020 2020 2020  ,</span>.       
+00017f40: 2020 2020 2020 2020 203c 7370 616e 2063           <span c
+00017f50: 6c61 7373 3d22 6e22 3e76 6572 626f 7365  lass="n">verbose
+00017f60: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
+00017f70: 7373 3d22 6f22 3e3d 3c2f 7370 616e 3e3c  ss="o">=</span><
+00017f80: 7370 616e 2063 6c61 7373 3d22 6e22 3e76  span class="n">v
+00017f90: 6572 626f 7365 3c2f 7370 616e 3e3c 7370  erbose</span><sp
+00017fa0: 616e 2063 6c61 7373 3d22 7022 3e2c 3c2f  an class="p">,</
+00017fb0: 7370 616e 3e0a 2020 2020 2020 2020 2020  span>.          
+00017fc0: 2020 3c73 7061 6e20 636c 6173 733d 2270    <span class="p
+00017fd0: 223e 293c 2f73 7061 6e3e 0a20 2020 2020  ">)</span>.     
+00017fe0: 2020 2020 2020 203c 7370 616e 2063 6c61         <span cla
+00017ff0: 7373 3d22 6b22 3e72 6574 7572 6e3c 2f73  ss="k">return</s
+00018000: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
+00018010: 3d22 6e22 3e72 6573 756c 7473 3c2f 7370  ="n">results</sp
+00018020: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+00018030: 7022 3e5b 3c2f 7370 616e 3e3c 7370 616e  p">[</span><span
+00018040: 2063 6c61 7373 3d22 7332 223e 2671 756f   class="s2">&quo
+00018050: 743b 7826 7175 6f74 3b3c 2f73 7061 6e3e  t;x&quot;</span>
+00018060: 3c73 7061 6e20 636c 6173 733d 2270 223e  <span class="p">
+00018070: 5d3c 2f73 7061 6e3e 0a0a 2020 2020 2020  ]</span>..      
+00018080: 2020 3c73 7061 6e20 636c 6173 733d 226b    <span class="k
+00018090: 223e 656c 6966 3c2f 7370 616e 3e20 3c73  ">elif</span> <s
+000180a0: 7061 6e20 636c 6173 733d 226e 223e 6d65  pan class="n">me
+000180b0: 7468 6f64 3c2f 7370 616e 3e20 3c73 7061  thod</span> <spa
+000180c0: 6e20 636c 6173 733d 226f 223e 3d3d 3c2f  n class="o">==</
+000180d0: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
+000180e0: 733d 2273 3222 3e26 7175 6f74 3b4c 2d42  s="s2">&quot;L-B
+000180f0: 4647 532d 4226 7175 6f74 3b3c 2f73 7061  FGS-B&quot;</spa
+00018100: 6e3e 3c73 7061 6e20 636c 6173 733d 2270  n><span class="p
+00018110: 223e 3a3c 2f73 7061 6e3e 0a20 2020 2020  ">:</span>.     
+00018120: 2020 2020 2020 203c 7370 616e 2063 6c61         <span cla
+00018130: 7373 3d22 6e22 3e6f 7074 696f 6e73 3c2f  ss="n">options</
+00018140: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
+00018150: 733d 226f 223e 3d3c 2f73 7061 6e3e 203c  s="o">=</span> <
+00018160: 7370 616e 2063 6c61 7373 3d22 7022 3e7b  span class="p">{
+00018170: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
+00018180: 7373 3d22 7332 223e 2671 756f 743b 6469  ss="s2">&quot;di
+00018190: 7370 2671 756f 743b 3c2f 7370 616e 3e3c  sp&quot;</span><
+000181a0: 7370 616e 2063 6c61 7373 3d22 7022 3e3a  span class="p">:
+000181b0: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
+000181c0: 6173 733d 226e 223e 7665 7262 6f73 653c  ass="n">verbose<
+000181d0: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
+000181e0: 733d 2270 223e 2c3c 2f73 7061 6e3e 203c  s="p">,</span> <
+000181f0: 7370 616e 2063 6c61 7373 3d22 7332 223e  span class="s2">
+00018200: 2671 756f 743b 6774 6f6c 2671 756f 743b  &quot;gtol&quot;
+00018210: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
+00018220: 7373 3d22 7022 3e3a 3c2f 7370 616e 3e20  ss="p">:</span> 
+00018230: 3c73 7061 6e20 636c 6173 733d 226d 6622  <span class="mf"
+00018240: 3e31 652d 383c 2f73 7061 6e3e 3c73 7061  >1e-8</span><spa
+00018250: 6e20 636c 6173 733d 2270 223e 7d3c 2f73  n class="p">}</s
+00018260: 7061 6e3e 0a20 2020 2020 2020 2020 2020  pan>.           
+00018270: 203c 7370 616e 2063 6c61 7373 3d22 6e22   <span class="n"
+00018280: 3e72 6573 756c 7473 3c2f 7370 616e 3e20  >results</span> 
+00018290: 3c73 7061 6e20 636c 6173 733d 226f 223e  <span class="o">
+000182a0: 3d3c 2f73 7061 6e3e 203c 7370 616e 2063  =</span> <span c
+000182b0: 6c61 7373 3d22 6e22 3e6f 7074 696d 697a  lass="n">optimiz
+000182c0: 653c 2f73 7061 6e3e 3c73 7061 6e20 636c  e</span><span cl
+000182d0: 6173 733d 226f 223e 2e3c 2f73 7061 6e3e  ass="o">.</span>
+000182e0: 3c73 7061 6e20 636c 6173 733d 226e 223e  <span class="n">
+000182f0: 6d69 6e69 6d69 7a65 3c2f 7370 616e 3e3c  minimize</span><
+00018300: 7370 616e 2063 6c61 7373 3d22 7022 3e28  span class="p">(
+00018310: 3c2f 7370 616e 3e0a 2020 2020 2020 2020  </span>.        
+00018320: 2020 2020 2020 2020 3c73 7061 6e20 636c          <span cl
+00018330: 6173 733d 226b 223e 6c61 6d62 6461 3c2f  ass="k">lambda</
+00018340: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
+00018350: 733d 226e 223e 783c 2f73 7061 6e3e 3c73  s="n">x</span><s
+00018360: 7061 6e20 636c 6173 733d 2270 223e 3a3c  pan class="p">:<
+00018370: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
+00018380: 7373 3d22 7022 3e5b 3c2f 7370 616e 3e0a  ss="p">[</span>.
+00018390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000183a0: 2020 2020 3c73 7061 6e20 636c 6173 733d      <span class=
+000183b0: 226e 223e 723c 2f73 7061 6e3e 3c73 7061  "n">r</span><spa
+000183c0: 6e20 636c 6173 733d 226f 223e 2e3c 2f73  n class="o">.</s
+000183d0: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
+000183e0: 226e 223e 6370 753c 2f73 7061 6e3e 3c73  "n">cpu</span><s
+000183f0: 7061 6e20 636c 6173 733d 2270 223e 2829  pan class="p">()
+00018400: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
+00018410: 7373 3d22 6f22 3e2e 3c2f 7370 616e 3e3c  ss="o">.</span><
+00018420: 7370 616e 2063 6c61 7373 3d22 6e22 3e6e  span class="n">n
+00018430: 756d 7079 3c2f 7370 616e 3e3c 7370 616e  umpy</span><span
+00018440: 2063 6c61 7373 3d22 7022 3e28 293c 2f73   class="p">()</s
+00018450: 7061 6e3e 0a20 2020 2020 2020 2020 2020  pan>.           
+00018460: 2020 2020 2020 2020 203c 7370 616e 2063           <span c
+00018470: 6c61 7373 3d22 6b22 3e66 6f72 3c2f 7370  lass="k">for</sp
+00018480: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
+00018490: 226e 223e 723c 2f73 7061 6e3e 203c 7370  "n">r</span> <sp
+000184a0: 616e 2063 6c61 7373 3d22 6f77 223e 696e  an class="ow">in
+000184b0: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
+000184c0: 6173 733d 226e 223e 5f63 6f6d 7075 7465  ass="n">_compute
+000184d0: 5f6c 6f73 735f 616e 645f 6772 6164 5f6f  _loss_and_grad_o
+000184e0: 665f 6446 5f69 6e5f 6261 7463 683c 2f73  f_dF_in_batch</s
+000184f0: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
+00018500: 2270 223e 283c 2f73 7061 6e3e 0a20 2020  "p">(</span>.   
+00018510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018520: 2020 2020 203c 7370 616e 2063 6c61 7373       <span class
+00018530: 3d22 6e22 3e65 6e65 7267 793c 2f73 7061  ="n">energy</spa
+00018540: 6e3e 3c73 7061 6e20 636c 6173 733d 226f  n><span class="o
+00018550: 223e 2e3c 2f73 7061 6e3e 3c73 7061 6e20  ">.</span><span 
+00018560: 636c 6173 733d 226e 223e 6e65 775f 7465  class="n">new_te
+00018570: 6e73 6f72 3c2f 7370 616e 3e3c 7370 616e  nsor</span><span
+00018580: 2063 6c61 7373 3d22 7022 3e28 3c2f 7370   class="p">(</sp
+00018590: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+000185a0: 6e22 3e78 3c2f 7370 616e 3e3c 7370 616e  n">x</span><span
+000185b0: 2063 6c61 7373 3d22 7022 3e29 2c3c 2f73   class="p">),</s
+000185c0: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
+000185d0: 3d22 6e22 3e65 6e65 7267 793c 2f73 7061  ="n">energy</spa
+000185e0: 6e3e 3c73 7061 6e20 636c 6173 733d 2270  n><span class="p
+000185f0: 223e 2c3c 2f73 7061 6e3e 203c 7370 616e  ">,</span> <span
+00018600: 2063 6c61 7373 3d22 6e22 3e6e 756d 5f63   class="n">num_c
+00018610: 6f6e 663c 2f73 7061 6e3e 3c73 7061 6e20  onf</span><span 
+00018620: 636c 6173 733d 2270 223e 2c3c 2f73 7061  class="p">,</spa
+00018630: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
+00018640: 6e22 3e62 6174 6368 5f73 697a 653c 2f73  n">batch_size</s
+00018650: 7061 6e3e 0a20 2020 2020 2020 2020 2020  pan>.           
+00018660: 2020 2020 2020 2020 203c 7370 616e 2063           <span c
+00018670: 6c61 7373 3d22 7022 3e29 3c2f 7370 616e  lass="p">)</span
+00018680: 3e0a 2020 2020 2020 2020 2020 2020 2020  >.              
+00018690: 2020 3c73 7061 6e20 636c 6173 733d 2270    <span class="p
+000186a0: 223e 5d2c 3c2f 7370 616e 3e0a 2020 2020  ">],</span>.    
+000186b0: 2020 2020 2020 2020 2020 2020 3c73 7061              <spa
+000186c0: 6e20 636c 6173 733d 226e 223e 6446 5f69  n class="n">dF_i
+000186d0: 6e69 743c 2f73 7061 6e3e 3c73 7061 6e20  nit</span><span 
+000186e0: 636c 6173 733d 226f 223e 2e3c 2f73 7061  class="o">.</spa
+000186f0: 6e3e 3c73 7061 6e20 636c 6173 733d 226e  n><span class="n
+00018700: 223e 6370 753c 2f73 7061 6e3e 3c73 7061  ">cpu</span><spa
+00018710: 6e20 636c 6173 733d 2270 223e 2829 3c2f  n class="p">()</
+00018720: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+00018730: 3d22 6f22 3e2e 3c2f 7370 616e 3e3c 7370  ="o">.</span><sp
+00018740: 616e 2063 6c61 7373 3d22 6e22 3e6e 756d  an class="n">num
+00018750: 7079 3c2f 7370 616e 3e3c 7370 616e 2063  py</span><span c
+00018760: 6c61 7373 3d22 7022 3e28 292c 3c2f 7370  lass="p">(),</sp
+00018770: 616e 3e0a 2020 2020 2020 2020 2020 2020  an>.            
+00018780: 2020 2020 3c73 7061 6e20 636c 6173 733d      <span class=
+00018790: 226e 223e 6a61 633c 2f73 7061 6e3e 3c73  "n">jac</span><s
+000187a0: 7061 6e20 636c 6173 733d 226f 223e 3d3c  pan class="o">=<
+000187b0: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
+000187c0: 733d 226b 6322 3e54 7275 653c 2f73 7061  s="kc">True</spa
+000187d0: 6e3e 3c73 7061 6e20 636c 6173 733d 2270  n><span class="p
+000187e0: 223e 2c3c 2f73 7061 6e3e 0a20 2020 2020  ">,</span>.     
+000187f0: 2020 2020 2020 2020 2020 203c 7370 616e             <span
+00018800: 2063 6c61 7373 3d22 6e22 3e6d 6574 686f   class="n">metho
+00018810: 643c 2f73 7061 6e3e 3c73 7061 6e20 636c  d</span><span cl
+00018820: 6173 733d 226f 223e 3d3c 2f73 7061 6e3e  ass="o">=</span>
+00018830: 3c73 7061 6e20 636c 6173 733d 2273 3222  <span class="s2"
+00018840: 3e26 7175 6f74 3b4c 2d42 4647 532d 4226  >&quot;L-BFGS-B&
+00018850: 7175 6f74 3b3c 2f73 7061 6e3e 3c73 7061  quot;</span><spa
+00018860: 6e20 636c 6173 733d 2270 223e 2c3c 2f73  n class="p">,</s
+00018870: 7061 6e3e 0a20 2020 2020 2020 2020 2020  pan>.           
+00018880: 2020 2020 203c 7370 616e 2063 6c61 7373       <span class
+00018890: 3d22 6e22 3e74 6f6c 3c2f 7370 616e 3e3c  ="n">tol</span><
+000188a0: 7370 616e 2063 6c61 7373 3d22 6f22 3e3d  span class="o">=
+000188b0: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
+000188c0: 7373 3d22 6d66 223e 3165 2d31 323c 2f73  ss="mf">1e-12</s
+000188d0: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
+000188e0: 2270 223e 2c3c 2f73 7061 6e3e 0a20 2020  "p">,</span>.   
+000188f0: 2020 2020 2020 2020 2020 2020 203c 7370               <sp
+00018900: 616e 2063 6c61 7373 3d22 6e22 3e6f 7074  an class="n">opt
+00018910: 696f 6e73 3c2f 7370 616e 3e3c 7370 616e  ions</span><span
+00018920: 2063 6c61 7373 3d22 6f22 3e3d 3c2f 7370   class="o">=</sp
+00018930: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+00018940: 6e22 3e6f 7074 696f 6e73 3c2f 7370 616e  n">options</span
+00018950: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
+00018960: 3e2c 3c2f 7370 616e 3e0a 2020 2020 2020  >,</span>.      
+00018970: 2020 2020 2020 3c73 7061 6e20 636c 6173        <span clas
+00018980: 733d 2270 223e 293c 2f73 7061 6e3e 0a20  s="p">)</span>. 
+00018990: 2020 2020 2020 2020 2020 203c 7370 616e             <span
+000189a0: 2063 6c61 7373 3d22 6b22 3e72 6574 7572   class="k">retur
+000189b0: 6e3c 2f73 7061 6e3e 203c 7370 616e 2063  n</span> <span c
+000189c0: 6c61 7373 3d22 6e22 3e74 6f72 6368 3c2f  lass="n">torch</
+000189d0: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+000189e0: 3d22 6f22 3e2e 3c2f 7370 616e 3e3c 7370  ="o">.</span><sp
+000189f0: 616e 2063 6c61 7373 3d22 6e22 3e66 726f  an class="n">fro
+00018a00: 6d5f 6e75 6d70 793c 2f73 7061 6e3e 3c73  m_numpy</span><s
+00018a10: 7061 6e20 636c 6173 733d 2270 223e 283c  pan class="p">(<
+00018a20: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
+00018a30: 733d 226e 223e 7265 7375 6c74 733c 2f73  s="n">results</s
+00018a40: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
+00018a50: 2270 223e 5b3c 2f73 7061 6e3e 3c73 7061  "p">[</span><spa
+00018a60: 6e20 636c 6173 733d 2273 3222 3e26 7175  n class="s2">&qu
+00018a70: 6f74 3b78 2671 756f 743b 3c2f 7370 616e  ot;x&quot;</span
+00018a80: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
+00018a90: 3e5d 293c 2f73 7061 6e3e 0a20 2020 203c  >])</span>.    <
+00018aa0: 7370 616e 2063 6c61 7373 3d22 6b22 3e65  span class="k">e
+00018ab0: 6c73 653c 2f73 7061 6e3e 3c73 7061 6e20  lse</span><span 
+00018ac0: 636c 6173 733d 2270 223e 3a3c 2f73 7061  class="p">:</spa
+00018ad0: 6e3e 0a20 2020 2020 2020 203c 7370 616e  n>.        <span
+00018ae0: 2063 6c61 7373 3d22 6b22 3e69 663c 2f73   class="k">if</s
+00018af0: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
+00018b00: 3d22 6e22 3e6d 6574 686f 643c 2f73 7061  ="n">method</spa
+00018b10: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
+00018b20: 6f22 3e3d 3d3c 2f73 7061 6e3e 203c 7370  o">==</span> <sp
+00018b30: 616e 2063 6c61 7373 3d22 7332 223e 2671  an class="s2">&q
+00018b40: 756f 743b 4e65 7774 6f6e 2671 756f 743b  uot;Newton&quot;
+00018b50: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
+00018b60: 7373 3d22 7022 3e3a 3c2f 7370 616e 3e0a  ss="p">:</span>.
+00018b70: 2020 2020 2020 2020 2020 2020 3c73 7061              <spa
+00018b80: 6e20 636c 6173 733d 226e 223e 7265 7375  n class="n">resu
+00018b90: 6c74 733c 2f73 7061 6e3e 203c 7370 616e  lts</span> <span
+00018ba0: 2063 6c61 7373 3d22 6f22 3e3d 3c2f 7370   class="o">=</sp
+00018bb0: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
+00018bc0: 226e 223e 666d 696e 5f6e 6577 746f 6e3c  "n">fmin_newton<
+00018bd0: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
+00018be0: 733d 2270 223e 283c 2f73 7061 6e3e 0a20  s="p">(</span>. 
+00018bf0: 2020 2020 2020 2020 2020 2020 2020 203c                 <
+00018c00: 7370 616e 2063 6c61 7373 3d22 6e22 3e66  span class="n">f
+00018c10: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
+00018c20: 7373 3d22 6f22 3e3d 3c2f 7370 616e 3e3c  ss="o">=</span><
+00018c30: 7370 616e 2063 6c61 7373 3d22 6e22 3e5f  span class="n">_
+00018c40: 636f 6d70 7574 655f 6c6f 7373 5f61 6e64  compute_loss_and
+00018c50: 5f67 7261 645f 6f66 5f64 463c 2f73 7061  _grad_of_dF</spa
+00018c60: 6e3e 3c73 7061 6e20 636c 6173 733d 2270  n><span class="p
+00018c70: 223e 2c3c 2f73 7061 6e3e 0a20 2020 2020  ">,</span>.     
+00018c80: 2020 2020 2020 2020 2020 203c 7370 616e             <span
+00018c90: 2063 6c61 7373 3d22 6e22 3e68 6573 733c   class="n">hess<
+00018ca0: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
+00018cb0: 733d 226f 223e 3d3c 2f73 7061 6e3e 3c73  s="o">=</span><s
+00018cc0: 7061 6e20 636c 6173 733d 226e 223e 5f63  pan class="n">_c
+00018cd0: 6f6d 7075 7465 5f68 6573 7369 616e 5f6c  ompute_hessian_l
+00018ce0: 6f73 735f 6f66 5f64 463c 2f73 7061 6e3e  oss_of_dF</span>
+00018cf0: 3c73 7061 6e20 636c 6173 733d 2270 223e  <span class="p">
+00018d00: 2c3c 2f73 7061 6e3e 0a20 2020 2020 2020  ,</span>.       
+00018d10: 2020 2020 2020 2020 203c 7370 616e 2063           <span c
+00018d20: 6c61 7373 3d22 6e22 3e78 5f69 6e69 743c  lass="n">x_init<
+00018d30: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
+00018d40: 733d 226f 223e 3d3c 2f73 7061 6e3e 3c73  s="o">=</span><s
+00018d50: 7061 6e20 636c 6173 733d 226e 223e 6446  pan class="n">dF
+00018d60: 5f69 6e69 743c 2f73 7061 6e3e 3c73 7061  _init</span><spa
+00018d70: 6e20 636c 6173 733d 2270 223e 2c3c 2f73  n class="p">,</s
+00018d80: 7061 6e3e 0a20 2020 2020 2020 2020 2020  pan>.           
+00018d90: 2020 2020 203c 7370 616e 2063 6c61 7373       <span class
+00018da0: 3d22 6e22 3e61 7267 733c 2f73 7061 6e3e  ="n">args</span>
+00018db0: 3c73 7061 6e20 636c 6173 733d 226f 223e  <span class="o">
+00018dc0: 3d3c 2f73 7061 6e3e 3c73 7061 6e20 636c  =</span><span cl
+00018dd0: 6173 733d 2270 223e 283c 2f73 7061 6e3e  ass="p">(</span>
+00018de0: 3c73 7061 6e20 636c 6173 733d 226e 223e  <span class="n">
+00018df0: 656e 6572 6779 3c2f 7370 616e 3e3c 7370  energy</span><sp
+00018e00: 616e 2063 6c61 7373 3d22 7022 3e2c 3c2f  an class="p">,</
+00018e10: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
+00018e20: 733d 226e 223e 6e75 6d5f 636f 6e66 3c2f  s="n">num_conf</
+00018e30: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+00018e40: 3d22 7022 3e29 2c3c 2f73 7061 6e3e 0a20  ="p">),</span>. 
+00018e50: 2020 2020 2020 2020 2020 2020 2020 203c                 <
+00018e60: 7370 616e 2063 6c61 7373 3d22 6e22 3e76  span class="n">v
+00018e70: 6572 626f 7365 3c2f 7370 616e 3e3c 7370  erbose</span><sp
+00018e80: 616e 2063 6c61 7373 3d22 6f22 3e3d 3c2f  an class="o">=</
+00018e90: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+00018ea0: 3d22 6e22 3e76 6572 626f 7365 3c2f 7370  ="n">verbose</sp
+00018eb0: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+00018ec0: 7022 3e2c 3c2f 7370 616e 3e0a 2020 2020  p">,</span>.    
+00018ed0: 2020 2020 2020 2020 3c73 7061 6e20 636c          <span cl
+00018ee0: 6173 733d 2270 223e 293c 2f73 7061 6e3e  ass="p">)</span>
+00018ef0: 0a20 2020 2020 2020 2020 2020 203c 7370  .            <sp
+00018f00: 616e 2063 6c61 7373 3d22 6b22 3e72 6574  an class="k">ret
+00018f10: 7572 6e3c 2f73 7061 6e3e 203c 7370 616e  urn</span> <span
+00018f20: 2063 6c61 7373 3d22 6e22 3e72 6573 756c   class="n">resul
+00018f30: 7473 3c2f 7370 616e 3e3c 7370 616e 2063  ts</span><span c
+00018f40: 6c61 7373 3d22 7022 3e5b 3c2f 7370 616e  lass="p">[</span
+00018f50: 3e3c 7370 616e 2063 6c61 7373 3d22 7332  ><span class="s2
+00018f60: 223e 2671 756f 743b 7826 7175 6f74 3b3c  ">&quot;x&quot;<
+00018f70: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
+00018f80: 733d 2270 223e 5d3c 2f73 7061 6e3e 0a20  s="p">]</span>. 
+00018f90: 2020 2020 2020 203c 7370 616e 2063 6c61         <span cla
+00018fa0: 7373 3d22 6b22 3e65 6c69 663c 2f73 7061  ss="k">elif</spa
+00018fb0: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
+00018fc0: 6e22 3e6d 6574 686f 643c 2f73 7061 6e3e  n">method</span>
+00018fd0: 203c 7370 616e 2063 6c61 7373 3d22 6f22   <span class="o"
+00018fe0: 3e3d 3d3c 2f73 7061 6e3e 203c 7370 616e  >==</span> <span
+00018ff0: 2063 6c61 7373 3d22 7332 223e 2671 756f   class="s2">&quo
+00019000: 743b 4c2d 4246 4753 2d42 2671 756f 743b  t;L-BFGS-B&quot;
+00019010: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
+00019020: 7373 3d22 7022 3e3a 3c2f 7370 616e 3e0a  ss="p">:</span>.
+00019030: 2020 2020 2020 2020 2020 2020 3c73 7061              <spa
+00019040: 6e20 636c 6173 733d 226e 223e 6f70 7469  n class="n">opti
+00019050: 6f6e 733c 2f73 7061 6e3e 203c 7370 616e  ons</span> <span
+00019060: 2063 6c61 7373 3d22 6f22 3e3d 3c2f 7370   class="o">=</sp
+00019070: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
+00019080: 2270 223e 7b3c 2f73 7061 6e3e 3c73 7061  "p">{</span><spa
+00019090: 6e20 636c 6173 733d 2273 3222 3e26 7175  n class="s2">&qu
+000190a0: 6f74 3b64 6973 7026 7175 6f74 3b3c 2f73  ot;disp&quot;</s
+000190b0: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
+000190c0: 2270 223e 3a3c 2f73 7061 6e3e 203c 7370  "p">:</span> <sp
+000190d0: 616e 2063 6c61 7373 3d22 6e22 3e76 6572  an class="n">ver
+000190e0: 626f 7365 3c2f 7370 616e 3e3c 7370 616e  bose</span><span
+000190f0: 2063 6c61 7373 3d22 7022 3e2c 3c2f 7370   class="p">,</sp
+00019100: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
+00019110: 2273 3222 3e26 7175 6f74 3b67 746f 6c26  "s2">&quot;gtol&
+00019120: 7175 6f74 3b3c 2f73 7061 6e3e 3c73 7061  quot;</span><spa
+00019130: 6e20 636c 6173 733d 2270 223e 3a3c 2f73  n class="p">:</s
+00019140: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
+00019150: 3d22 6d66 223e 3165 2d38 3c2f 7370 616e  ="mf">1e-8</span
+00019160: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
+00019170: 3e7d 3c2f 7370 616e 3e0a 2020 2020 2020  >}</span>.      
+00019180: 2020 2020 2020 3c73 7061 6e20 636c 6173        <span clas
+00019190: 733d 226e 223e 7265 7375 6c74 733c 2f73  s="n">results</s
+000191a0: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
+000191b0: 3d22 6f22 3e3d 3c2f 7370 616e 3e20 3c73  ="o">=</span> <s
+000191c0: 7061 6e20 636c 6173 733d 226e 223e 6f70  pan class="n">op
+000191d0: 7469 6d69 7a65 3c2f 7370 616e 3e3c 7370  timize</span><sp
+000191e0: 616e 2063 6c61 7373 3d22 6f22 3e2e 3c2f  an class="o">.</
+000191f0: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+00019200: 3d22 6e22 3e6d 696e 696d 697a 653c 2f73  ="n">minimize</s
+00019210: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
+00019220: 2270 223e 283c 2f73 7061 6e3e 0a20 2020  "p">(</span>.   
+00019230: 2020 2020 2020 2020 2020 2020 203c 7370               <sp
+00019240: 616e 2063 6c61 7373 3d22 6b22 3e6c 616d  an class="k">lam
+00019250: 6264 613c 2f73 7061 6e3e 203c 7370 616e  bda</span> <span
+00019260: 2063 6c61 7373 3d22 6e22 3e78 3c2f 7370   class="n">x</sp
+00019270: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+00019280: 7022 3e3a 3c2f 7370 616e 3e20 3c73 7061  p">:</span> <spa
+00019290: 6e20 636c 6173 733d 2270 223e 5b3c 2f73  n class="p">[</s
+000192a0: 7061 6e3e 0a20 2020 2020 2020 2020 2020  pan>.           
+000192b0: 2020 2020 2020 2020 203c 7370 616e 2063           <span c
+000192c0: 6c61 7373 3d22 6e22 3e72 3c2f 7370 616e  lass="n">r</span
+000192d0: 3e3c 7370 616e 2063 6c61 7373 3d22 6f22  ><span class="o"
+000192e0: 3e2e 3c2f 7370 616e 3e3c 7370 616e 2063  >.</span><span c
+000192f0: 6c61 7373 3d22 6e22 3e63 7075 3c2f 7370  lass="n">cpu</sp
+00019300: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+00019310: 7022 3e28 293c 2f73 7061 6e3e 3c73 7061  p">()</span><spa
+00019320: 6e20 636c 6173 733d 226f 223e 2e3c 2f73  n class="o">.</s
+00019330: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
+00019340: 226e 223e 6e75 6d70 793c 2f73 7061 6e3e  "n">numpy</span>
+00019350: 3c73 7061 6e20 636c 6173 733d 2270 223e  <span class="p">
+00019360: 2829 3c2f 7370 616e 3e0a 2020 2020 2020  ()</span>.      
+00019370: 2020 2020 2020 2020 2020 2020 2020 3c73                <s
+00019380: 7061 6e20 636c 6173 733d 226b 223e 666f  pan class="k">fo
+00019390: 723c 2f73 7061 6e3e 203c 7370 616e 2063  r</span> <span c
+000193a0: 6c61 7373 3d22 6e22 3e72 3c2f 7370 616e  lass="n">r</span
+000193b0: 3e20 3c73 7061 6e20 636c 6173 733d 226f  > <span class="o
+000193c0: 7722 3e69 6e3c 2f73 7061 6e3e 203c 7370  w">in</span> <sp
+000193d0: 616e 2063 6c61 7373 3d22 6e22 3e5f 636f  an class="n">_co
+000193e0: 6d70 7574 655f 6c6f 7373 5f61 6e64 5f67  mpute_loss_and_g
+000193f0: 7261 645f 6f66 5f64 463c 2f73 7061 6e3e  rad_of_dF</span>
+00019400: 3c73 7061 6e20 636c 6173 733d 2270 223e  <span class="p">
+00019410: 283c 2f73 7061 6e3e 0a20 2020 2020 2020  (</span>.       
+00019420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019430: 203c 7370 616e 2063 6c61 7373 3d22 6e22   <span class="n"
+00019440: 3e65 6e65 7267 793c 2f73 7061 6e3e 3c73  >energy</span><s
+00019450: 7061 6e20 636c 6173 733d 226f 223e 2e3c  pan class="o">.<
+00019460: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
+00019470: 733d 226e 223e 6e65 775f 7465 6e73 6f72  s="n">new_tensor
+00019480: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
+00019490: 7373 3d22 7022 3e28 3c2f 7370 616e 3e3c  ss="p">(</span><
+000194a0: 7370 616e 2063 6c61 7373 3d22 6e22 3e78  span class="n">x
+000194b0: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
+000194c0: 7373 3d22 7022 3e29 2c3c 2f73 7061 6e3e  ss="p">),</span>
+000194d0: 203c 7370 616e 2063 6c61 7373 3d22 6e22   <span class="n"
+000194e0: 3e65 6e65 7267 793c 2f73 7061 6e3e 3c73  >energy</span><s
+000194f0: 7061 6e20 636c 6173 733d 2270 223e 2c3c  pan class="p">,<
+00019500: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
+00019510: 7373 3d22 6e22 3e6e 756d 5f63 6f6e 663c  ss="n">num_conf<
+00019520: 2f73 7061 6e3e 0a20 2020 2020 2020 2020  /span>.         
+00019530: 2020 2020 2020 2020 2020 203c 7370 616e             <span
+00019540: 2063 6c61 7373 3d22 7022 3e29 3c2f 7370   class="p">)</sp
+00019550: 616e 3e0a 2020 2020 2020 2020 2020 2020  an>.            
+00019560: 2020 2020 3c73 7061 6e20 636c 6173 733d      <span class=
+00019570: 2270 223e 5d2c 3c2f 7370 616e 3e0a 2020  "p">],</span>.  
+00019580: 2020 2020 2020 2020 2020 2020 2020 3c73                <s
+00019590: 7061 6e20 636c 6173 733d 226e 223e 6446  pan class="n">dF
+000195a0: 5f69 6e69 743c 2f73 7061 6e3e 3c73 7061  _init</span><spa
+000195b0: 6e20 636c 6173 733d 226f 223e 2e3c 2f73  n class="o">.</s
+000195c0: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
+000195d0: 226e 223e 6370 753c 2f73 7061 6e3e 3c73  "n">cpu</span><s
+000195e0: 7061 6e20 636c 6173 733d 2270 223e 2829  pan class="p">()
+000195f0: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
+00019600: 7373 3d22 6f22 3e2e 3c2f 7370 616e 3e3c  ss="o">.</span><
+00019610: 7370 616e 2063 6c61 7373 3d22 6e22 3e6e  span class="n">n
+00019620: 756d 7079 3c2f 7370 616e 3e3c 7370 616e  umpy</span><span
+00019630: 2063 6c61 7373 3d22 7022 3e28 292c 3c2f   class="p">(),</
+00019640: 7370 616e 3e0a 2020 2020 2020 2020 2020  span>.          
+00019650: 2020 2020 2020 3c73 7061 6e20 636c 6173        <span clas
+00019660: 733d 226e 223e 6a61 633c 2f73 7061 6e3e  s="n">jac</span>
+00019670: 3c73 7061 6e20 636c 6173 733d 226f 223e  <span class="o">
+00019680: 3d3c 2f73 7061 6e3e 3c73 7061 6e20 636c  =</span><span cl
+00019690: 6173 733d 226b 6322 3e54 7275 653c 2f73  ass="kc">True</s
+000196a0: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
+000196b0: 2270 223e 2c3c 2f73 7061 6e3e 0a20 2020  "p">,</span>.   
+000196c0: 2020 2020 2020 2020 2020 2020 203c 7370               <sp
+000196d0: 616e 2063 6c61 7373 3d22 6e22 3e6d 6574  an class="n">met
+000196e0: 686f 643c 2f73 7061 6e3e 3c73 7061 6e20  hod</span><span 
+000196f0: 636c 6173 733d 226f 223e 3d3c 2f73 7061  class="o">=</spa
+00019700: 6e3e 3c73 7061 6e20 636c 6173 733d 2273  n><span class="s
+00019710: 3222 3e26 7175 6f74 3b4c 2d42 4647 532d  2">&quot;L-BFGS-
+00019720: 4226 7175 6f74 3b3c 2f73 7061 6e3e 3c73  B&quot;</span><s
+00019730: 7061 6e20 636c 6173 733d 2270 223e 2c3c  pan class="p">,<
+00019740: 2f73 7061 6e3e 0a20 2020 2020 2020 2020  /span>.         
+00019750: 2020 2020 2020 203c 7370 616e 2063 6c61         <span cla
+00019760: 7373 3d22 6e22 3e74 6f6c 3c2f 7370 616e  ss="n">tol</span
+00019770: 3e3c 7370 616e 2063 6c61 7373 3d22 6f22  ><span class="o"
+00019780: 3e3d 3c2f 7370 616e 3e3c 7370 616e 2063  >=</span><span c
+00019790: 6c61 7373 3d22 6d66 223e 3165 2d31 323c  lass="mf">1e-12<
+000197a0: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
+000197b0: 733d 2270 223e 2c3c 2f73 7061 6e3e 0a20  s="p">,</span>. 
+000197c0: 2020 2020 2020 2020 2020 2020 2020 203c                 <
+000197d0: 7370 616e 2063 6c61 7373 3d22 6e22 3e6f  span class="n">o
+000197e0: 7074 696f 6e73 3c2f 7370 616e 3e3c 7370  ptions</span><sp
+000197f0: 616e 2063 6c61 7373 3d22 6f22 3e3d 3c2f  an class="o">=</
+00019800: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+00019810: 3d22 6e22 3e6f 7074 696f 6e73 3c2f 7370  ="n">options</sp
+00019820: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+00019830: 7022 3e2c 3c2f 7370 616e 3e0a 2020 2020  p">,</span>.    
+00019840: 2020 2020 2020 2020 3c73 7061 6e20 636c          <span cl
+00019850: 6173 733d 2270 223e 293c 2f73 7061 6e3e  ass="p">)</span>
+00019860: 0a20 2020 2020 2020 2020 2020 203c 7370  .            <sp
+00019870: 616e 2063 6c61 7373 3d22 6b22 3e72 6574  an class="k">ret
+00019880: 7572 6e3c 2f73 7061 6e3e 203c 7370 616e  urn</span> <span
+00019890: 2063 6c61 7373 3d22 6e22 3e74 6f72 6368   class="n">torch
+000198a0: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
+000198b0: 7373 3d22 6f22 3e2e 3c2f 7370 616e 3e3c  ss="o">.</span><
+000198c0: 7370 616e 2063 6c61 7373 3d22 6e22 3e66  span class="n">f
+000198d0: 726f 6d5f 6e75 6d70 793c 2f73 7061 6e3e  rom_numpy</span>
+000198e0: 3c73 7061 6e20 636c 6173 733d 2270 223e  <span class="p">
+000198f0: 283c 2f73 7061 6e3e 3c73 7061 6e20 636c  (</span><span cl
+00019900: 6173 733d 226e 223e 7265 7375 6c74 733c  ass="n">results<
+00019910: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
+00019920: 733d 2270 223e 5b3c 2f73 7061 6e3e 3c73  s="p">[</span><s
+00019930: 7061 6e20 636c 6173 733d 2273 3222 3e26  pan class="s2">&
+00019940: 7175 6f74 3b78 2671 756f 743b 3c2f 7370  quot;x&quot;</sp
+00019950: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+00019960: 7022 3e5d 293c 2f73 7061 6e3e 0a0a 0a3c  p">])</span>...<
+00019970: 7370 616e 2063 6c61 7373 3d22 6b22 3e64  span class="k">d
+00019980: 6566 3c2f 7370 616e 3e20 3c73 7061 6e20  ef</span> <span 
+00019990: 636c 6173 733d 226e 6622 3e5f 626f 6f74  class="nf">_boot
+000199a0: 7374 7261 705f 636f 6e66 5f69 6478 3c2f  strap_conf_idx</
+000199b0: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+000199c0: 3d22 7022 3e28 3c2f 7370 616e 3e3c 7370  ="p">(</span><sp
+000199d0: 616e 2063 6c61 7373 3d22 6e22 3e6e 756d  an class="n">num
+000199e0: 5f63 6f6e 663c 2f73 7061 6e3e 3c73 7061  _conf</span><spa
+000199f0: 6e20 636c 6173 733d 2270 223e 2c3c 2f73  n class="p">,</s
+00019a00: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
+00019a10: 3d22 6e22 3e62 6f6f 7473 7472 6170 5f62  ="n">bootstrap_b
+00019a20: 6c6f 636b 5f73 697a 653c 2f73 7061 6e3e  lock_size</span>
+00019a30: 3c73 7061 6e20 636c 6173 733d 2270 223e  <span class="p">
+00019a40: 293a 3c2f 7370 616e 3e0a 2020 2020 3c73  ):</span>.    <s
+00019a50: 7061 6e20 636c 6173 733d 226e 223e 6e75  pan class="n">nu
+00019a60: 6d5f 636f 6e66 5f63 756d 7375 6d3c 2f73  m_conf_cumsum</s
+00019a70: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
+00019a80: 3d22 6f22 3e3d 3c2f 7370 616e 3e20 3c73  ="o">=</span> <s
+00019a90: 7061 6e20 636c 6173 733d 226e 223e 746f  pan class="n">to
+00019aa0: 7263 683c 2f73 7061 6e3e 3c73 7061 6e20  rch</span><span 
+00019ab0: 636c 6173 733d 226f 223e 2e3c 2f73 7061  class="o">.</spa
+00019ac0: 6e3e 3c73 7061 6e20 636c 6173 733d 226e  n><span class="n
+00019ad0: 223e 6375 6d73 756d 3c2f 7370 616e 3e3c  ">cumsum</span><
+00019ae0: 7370 616e 2063 6c61 7373 3d22 7022 3e28  span class="p">(
 00019af0: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-00019b00: 7373 3d22 6d69 223e 303c 2f73 7061 6e3e  ss="mi">0</span>
-00019b10: 3c73 7061 6e20 636c 6173 733d 2270 223e  <span class="p">
-00019b20: 293c 2f73 7061 6e3e 3c73 7061 6e20 636c  )</span><span cl
-00019b30: 6173 733d 226f 223e 2e3c 2f73 7061 6e3e  ass="o">.</span>
-00019b40: 3c73 7061 6e20 636c 6173 733d 226e 223e  <span class="n">
-00019b50: 746f 6c69 7374 3c2f 7370 616e 3e3c 7370  tolist</span><sp
-00019b60: 616e 2063 6c61 7373 3d22 7022 3e28 293c  an class="p">()<
-00019b70: 2f73 7061 6e3e 0a20 2020 203c 7370 616e  /span>.    <span
-00019b80: 2063 6c61 7373 3d22 6e22 3e6e 756d 5f63   class="n">num_c
-00019b90: 6f6e 665f 6375 6d73 756d 3c2f 7370 616e  onf_cumsum</span
-00019ba0: 3e3c 7370 616e 2063 6c61 7373 3d22 6f22  ><span class="o"
-00019bb0: 3e2e 3c2f 7370 616e 3e3c 7370 616e 2063  >.</span><span c
-00019bc0: 6c61 7373 3d22 6e22 3e70 6f70 3c2f 7370  lass="n">pop</sp
-00019bd0: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-00019be0: 7022 3e28 3c2f 7370 616e 3e3c 7370 616e  p">(</span><span
-00019bf0: 2063 6c61 7373 3d22 6f22 3e2d 3c2f 7370   class="o">-</sp
-00019c00: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-00019c10: 6d69 223e 313c 2f73 7061 6e3e 3c73 7061  mi">1</span><spa
-00019c20: 6e20 636c 6173 733d 2270 223e 293c 2f73  n class="p">)</s
-00019c30: 7061 6e3e 0a20 2020 203c 7370 616e 2063  pan>.    <span c
-00019c40: 6c61 7373 3d22 6e22 3e6e 756d 5f63 6f6e  lass="n">num_con
-00019c50: 665f 6375 6d73 756d 3c2f 7370 616e 3e20  f_cumsum</span> 
-00019c60: 3c73 7061 6e20 636c 6173 733d 226f 223e  <span class="o">
-00019c70: 3d3c 2f73 7061 6e3e 203c 7370 616e 2063  =</span> <span c
-00019c80: 6c61 7373 3d22 7022 3e5b 3c2f 7370 616e  lass="p">[</span
-00019c90: 3e3c 7370 616e 2063 6c61 7373 3d22 6d69  ><span class="mi
-00019ca0: 223e 303c 2f73 7061 6e3e 3c73 7061 6e20  ">0</span><span 
-00019cb0: 636c 6173 733d 2270 223e 5d3c 2f73 7061  class="p">]</spa
-00019cc0: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
-00019cd0: 6f22 3e2b 3c2f 7370 616e 3e20 3c73 7061  o">+</span> <spa
-00019ce0: 6e20 636c 6173 733d 226e 223e 6e75 6d5f  n class="n">num_
-00019cf0: 636f 6e66 5f63 756d 7375 6d3c 2f73 7061  conf_cumsum</spa
-00019d00: 6e3e 0a20 2020 203c 7370 616e 2063 6c61  n>.    <span cla
-00019d10: 7373 3d22 6e22 3e63 6f6e 665f 6964 783c  ss="n">conf_idx<
-00019d20: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
-00019d30: 7373 3d22 6f22 3e3d 3c2f 7370 616e 3e20  ss="o">=</span> 
-00019d40: 3c73 7061 6e20 636c 6173 733d 2270 223e  <span class="p">
-00019d50: 5b5d 3c2f 7370 616e 3e0a 2020 2020 3c73  []</span>.    <s
-00019d60: 7061 6e20 636c 6173 733d 226b 223e 666f  pan class="k">fo
-00019d70: 723c 2f73 7061 6e3e 203c 7370 616e 2063  r</span> <span c
-00019d80: 6c61 7373 3d22 6e22 3e69 3c2f 7370 616e  lass="n">i</span
-00019d90: 3e20 3c73 7061 6e20 636c 6173 733d 226f  > <span class="o
-00019da0: 7722 3e69 6e3c 2f73 7061 6e3e 203c 7370  w">in</span> <sp
-00019db0: 616e 2063 6c61 7373 3d22 6e62 223e 7261  an class="nb">ra
-00019dc0: 6e67 653c 2f73 7061 6e3e 3c73 7061 6e20  nge</span><span 
-00019dd0: 636c 6173 733d 2270 223e 283c 2f73 7061  class="p">(</spa
-00019de0: 6e3e 3c73 7061 6e20 636c 6173 733d 226e  n><span class="n
-00019df0: 6222 3e6c 656e 3c2f 7370 616e 3e3c 7370  b">len</span><sp
-00019e00: 616e 2063 6c61 7373 3d22 7022 3e28 3c2f  an class="p">(</
-00019e10: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
-00019e20: 3d22 6e22 3e6e 756d 5f63 6f6e 663c 2f73  ="n">num_conf</s
+00019b00: 7373 3d22 6e22 3e6e 756d 5f63 6f6e 663c  ss="n">num_conf<
+00019b10: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
+00019b20: 733d 2270 223e 2c3c 2f73 7061 6e3e 203c  s="p">,</span> <
+00019b30: 7370 616e 2063 6c61 7373 3d22 6e22 3e64  span class="n">d
+00019b40: 696d 3c2f 7370 616e 3e3c 7370 616e 2063  im</span><span c
+00019b50: 6c61 7373 3d22 6f22 3e3d 3c2f 7370 616e  lass="o">=</span
+00019b60: 3e3c 7370 616e 2063 6c61 7373 3d22 6d69  ><span class="mi
+00019b70: 223e 303c 2f73 7061 6e3e 3c73 7061 6e20  ">0</span><span 
+00019b80: 636c 6173 733d 2270 223e 293c 2f73 7061  class="p">)</spa
+00019b90: 6e3e 3c73 7061 6e20 636c 6173 733d 226f  n><span class="o
+00019ba0: 223e 2e3c 2f73 7061 6e3e 3c73 7061 6e20  ">.</span><span 
+00019bb0: 636c 6173 733d 226e 223e 746f 6c69 7374  class="n">tolist
+00019bc0: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
+00019bd0: 7373 3d22 7022 3e28 293c 2f73 7061 6e3e  ss="p">()</span>
+00019be0: 0a20 2020 203c 7370 616e 2063 6c61 7373  .    <span class
+00019bf0: 3d22 6e22 3e6e 756d 5f63 6f6e 665f 6375  ="n">num_conf_cu
+00019c00: 6d73 756d 3c2f 7370 616e 3e3c 7370 616e  msum</span><span
+00019c10: 2063 6c61 7373 3d22 6f22 3e2e 3c2f 7370   class="o">.</sp
+00019c20: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+00019c30: 6e22 3e70 6f70 3c2f 7370 616e 3e3c 7370  n">pop</span><sp
+00019c40: 616e 2063 6c61 7373 3d22 7022 3e28 3c2f  an class="p">(</
+00019c50: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+00019c60: 3d22 6f22 3e2d 3c2f 7370 616e 3e3c 7370  ="o">-</span><sp
+00019c70: 616e 2063 6c61 7373 3d22 6d69 223e 313c  an class="mi">1<
+00019c80: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
+00019c90: 733d 2270 223e 293c 2f73 7061 6e3e 0a20  s="p">)</span>. 
+00019ca0: 2020 203c 7370 616e 2063 6c61 7373 3d22     <span class="
+00019cb0: 6e22 3e6e 756d 5f63 6f6e 665f 6375 6d73  n">num_conf_cums
+00019cc0: 756d 3c2f 7370 616e 3e20 3c73 7061 6e20  um</span> <span 
+00019cd0: 636c 6173 733d 226f 223e 3d3c 2f73 7061  class="o">=</spa
+00019ce0: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
+00019cf0: 7022 3e5b 3c2f 7370 616e 3e3c 7370 616e  p">[</span><span
+00019d00: 2063 6c61 7373 3d22 6d69 223e 303c 2f73   class="mi">0</s
+00019d10: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
+00019d20: 2270 223e 5d3c 2f73 7061 6e3e 203c 7370  "p">]</span> <sp
+00019d30: 616e 2063 6c61 7373 3d22 6f22 3e2b 3c2f  an class="o">+</
+00019d40: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
+00019d50: 733d 226e 223e 6e75 6d5f 636f 6e66 5f63  s="n">num_conf_c
+00019d60: 756d 7375 6d3c 2f73 7061 6e3e 0a20 2020  umsum</span>.   
+00019d70: 203c 7370 616e 2063 6c61 7373 3d22 6e22   <span class="n"
+00019d80: 3e63 6f6e 665f 6964 783c 2f73 7061 6e3e  >conf_idx</span>
+00019d90: 203c 7370 616e 2063 6c61 7373 3d22 6f22   <span class="o"
+00019da0: 3e3d 3c2f 7370 616e 3e20 3c73 7061 6e20  >=</span> <span 
+00019db0: 636c 6173 733d 2270 223e 5b5d 3c2f 7370  class="p">[]</sp
+00019dc0: 616e 3e0a 2020 2020 3c73 7061 6e20 636c  an>.    <span cl
+00019dd0: 6173 733d 226b 223e 666f 723c 2f73 7061  ass="k">for</spa
+00019de0: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
+00019df0: 6e22 3e69 3c2f 7370 616e 3e20 3c73 7061  n">i</span> <spa
+00019e00: 6e20 636c 6173 733d 226f 7722 3e69 6e3c  n class="ow">in<
+00019e10: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
+00019e20: 7373 3d22 6e62 223e 7261 6e67 653c 2f73  ss="nb">range</s
 00019e30: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
-00019e40: 2270 223e 2929 3a3c 2f73 7061 6e3e 0a20  "p">)):</span>. 
-00019e50: 2020 2020 2020 203c 7370 616e 2063 6c61         <span cla
-00019e60: 7373 3d22 6e22 3e6c 656e 5f73 6571 3c2f  ss="n">len_seq</
-00019e70: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
-00019e80: 733d 226f 223e 3d3c 2f73 7061 6e3e 203c  s="o">=</span> <
-00019e90: 7370 616e 2063 6c61 7373 3d22 6e62 223e  span class="nb">
-00019ea0: 696e 743c 2f73 7061 6e3e 3c73 7061 6e20  int</span><span 
-00019eb0: 636c 6173 733d 2270 223e 283c 2f73 7061  class="p">(</spa
-00019ec0: 6e3e 3c73 7061 6e20 636c 6173 733d 226e  n><span class="n
-00019ed0: 223e 6e75 6d5f 636f 6e66 3c2f 7370 616e  ">num_conf</span
-00019ee0: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
-00019ef0: 3e5b 3c2f 7370 616e 3e3c 7370 616e 2063  >[</span><span c
-00019f00: 6c61 7373 3d22 6e22 3e69 3c2f 7370 616e  lass="n">i</span
-00019f10: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
-00019f20: 3e5d 293c 2f73 7061 6e3e 2020 3c73 7061  >])</span>  <spa
-00019f30: 6e20 636c 6173 733d 2263 3122 3e23 2320  n class="c1">## 
-00019f40: 7573 696e 6720 6369 7263 756c 6172 2062  using circular b
-00019f50: 6c6f 636b 2062 6f6f 7473 7472 6170 3c2f  lock bootstrap</
-00019f60: 7370 616e 3e0a 2020 2020 2020 2020 3c73  span>.        <s
-00019f70: 7061 6e20 636c 6173 733d 226e 223e 6e75  pan class="n">nu
-00019f80: 6d5f 7361 6d70 6c65 5f62 6c6f 636b 3c2f  m_sample_block</
-00019f90: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
-00019fa0: 733d 226f 223e 3d3c 2f73 7061 6e3e 203c  s="o">=</span> <
-00019fb0: 7370 616e 2063 6c61 7373 3d22 6e62 223e  span class="nb">
-00019fc0: 696e 743c 2f73 7061 6e3e 3c73 7061 6e20  int</span><span 
-00019fd0: 636c 6173 733d 2270 223e 283c 2f73 7061  class="p">(</spa
-00019fe0: 6e3e 3c73 7061 6e20 636c 6173 733d 226e  n><span class="n
-00019ff0: 223e 6e70 3c2f 7370 616e 3e3c 7370 616e  ">np</span><span
-0001a000: 2063 6c61 7373 3d22 6f22 3e2e 3c2f 7370   class="o">.</sp
-0001a010: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-0001a020: 6e22 3e63 6569 6c3c 2f73 7061 6e3e 3c73  n">ceil</span><s
-0001a030: 7061 6e20 636c 6173 733d 2270 223e 283c  pan class="p">(<
-0001a040: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
-0001a050: 733d 226e 223e 6c65 6e5f 7365 713c 2f73  s="n">len_seq</s
-0001a060: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
-0001a070: 3d22 6f22 3e2f 3c2f 7370 616e 3e20 3c73  ="o">/</span> <s
-0001a080: 7061 6e20 636c 6173 733d 226e 223e 626f  pan class="n">bo
-0001a090: 6f74 7374 7261 705f 626c 6f63 6b5f 7369  otstrap_block_si
-0001a0a0: 7a65 3c2f 7370 616e 3e3c 7370 616e 2063  ze</span><span c
-0001a0b0: 6c61 7373 3d22 7022 3e29 293c 2f73 7061  lass="p">))</spa
-0001a0c0: 6e3e 0a20 2020 2020 2020 203c 7370 616e  n>.        <span
-0001a0d0: 2063 6c61 7373 3d22 6e22 3e69 6478 733c   class="n">idxs<
-0001a0e0: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
-0001a0f0: 7373 3d22 6f22 3e3d 3c2f 7370 616e 3e20  ss="o">=</span> 
-0001a100: 3c73 7061 6e20 636c 6173 733d 226e 223e  <span class="n">
-0001a110: 746f 7263 683c 2f73 7061 6e3e 3c73 7061  torch</span><spa
-0001a120: 6e20 636c 6173 733d 226f 223e 2e3c 2f73  n class="o">.</s
-0001a130: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
-0001a140: 226e 223e 7261 6e64 696e 743c 2f73 7061  "n">randint</spa
-0001a150: 6e3e 3c73 7061 6e20 636c 6173 733d 2270  n><span class="p
-0001a160: 223e 283c 2f73 7061 6e3e 3c73 7061 6e20  ">(</span><span 
-0001a170: 636c 6173 733d 226d 6922 3e30 3c2f 7370  class="mi">0</sp
-0001a180: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-0001a190: 7022 3e2c 3c2f 7370 616e 3e20 3c73 7061  p">,</span> <spa
-0001a1a0: 6e20 636c 6173 733d 226e 223e 6c65 6e5f  n class="n">len_
-0001a1b0: 7365 713c 2f73 7061 6e3e 3c73 7061 6e20  seq</span><span 
-0001a1c0: 636c 6173 733d 2270 223e 2c3c 2f73 7061  class="p">,</spa
-0001a1d0: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
-0001a1e0: 7022 3e28 3c2f 7370 616e 3e3c 7370 616e  p">(</span><span
-0001a1f0: 2063 6c61 7373 3d22 6e22 3e6e 756d 5f73   class="n">num_s
-0001a200: 616d 706c 655f 626c 6f63 6b3c 2f73 7061  ample_block</spa
-0001a210: 6e3e 3c73 7061 6e20 636c 6173 733d 2270  n><span class="p
-0001a220: 223e 2c29 293c 2f73 7061 6e3e 0a20 2020  ">,))</span>.   
-0001a230: 2020 2020 203c 7370 616e 2063 6c61 7373       <span class
-0001a240: 3d22 6e22 3e73 616d 706c 655f 6964 783c  ="n">sample_idx<
-0001a250: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
-0001a260: 7373 3d22 6f22 3e3d 3c2f 7370 616e 3e20  ss="o">=</span> 
-0001a270: 3c73 7061 6e20 636c 6173 733d 226e 223e  <span class="n">
-0001a280: 746f 7263 683c 2f73 7061 6e3e 3c73 7061  torch</span><spa
-0001a290: 6e20 636c 6173 733d 226f 223e 2e3c 2f73  n class="o">.</s
-0001a2a0: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
-0001a2b0: 226e 223e 6361 743c 2f73 7061 6e3e 3c73  "n">cat</span><s
-0001a2c0: 7061 6e20 636c 6173 733d 2270 223e 283c  pan class="p">(<
-0001a2d0: 2f73 7061 6e3e 0a20 2020 2020 2020 2020  /span>.         
-0001a2e0: 2020 203c 7370 616e 2063 6c61 7373 3d22     <span class="
-0001a2f0: 7022 3e5b 3c2f 7370 616e 3e3c 7370 616e  p">[</span><span
-0001a300: 2063 6c61 7373 3d22 6e22 3e74 6f72 6368   class="n">torch
-0001a310: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-0001a320: 7373 3d22 6f22 3e2e 3c2f 7370 616e 3e3c  ss="o">.</span><
-0001a330: 7370 616e 2063 6c61 7373 3d22 6e22 3e61  span class="n">a
-0001a340: 7261 6e67 653c 2f73 7061 6e3e 3c73 7061  range</span><spa
-0001a350: 6e20 636c 6173 733d 2270 223e 283c 2f73  n class="p">(</s
-0001a360: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
-0001a370: 226e 223e 6964 783c 2f73 7061 6e3e 3c73  "n">idx</span><s
-0001a380: 7061 6e20 636c 6173 733d 2270 223e 2c3c  pan class="p">,<
-0001a390: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
-0001a3a0: 7373 3d22 6e22 3e69 6478 3c2f 7370 616e  ss="n">idx</span
-0001a3b0: 3e20 3c73 7061 6e20 636c 6173 733d 226f  > <span class="o
-0001a3c0: 223e 2b3c 2f73 7061 6e3e 203c 7370 616e  ">+</span> <span
-0001a3d0: 2063 6c61 7373 3d22 6e22 3e62 6f6f 7473   class="n">boots
-0001a3e0: 7472 6170 5f62 6c6f 636b 5f73 697a 653c  trap_block_size<
-0001a3f0: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
-0001a400: 733d 2270 223e 293c 2f73 7061 6e3e 203c  s="p">)</span> <
-0001a410: 7370 616e 2063 6c61 7373 3d22 6b22 3e66  span class="k">f
-0001a420: 6f72 3c2f 7370 616e 3e20 3c73 7061 6e20  or</span> <span 
-0001a430: 636c 6173 733d 226e 223e 6964 783c 2f73  class="n">idx</s
-0001a440: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
-0001a450: 3d22 6f77 223e 696e 3c2f 7370 616e 3e20  ="ow">in</span> 
-0001a460: 3c73 7061 6e20 636c 6173 733d 226e 223e  <span class="n">
-0001a470: 6964 7873 3c2f 7370 616e 3e3c 7370 616e  idxs</span><span
-0001a480: 2063 6c61 7373 3d22 7022 3e5d 3c2f 7370   class="p">]</sp
-0001a490: 616e 3e0a 2020 2020 2020 2020 3c73 7061  an>.        <spa
-0001a4a0: 6e20 636c 6173 733d 2270 223e 293c 2f73  n class="p">)</s
-0001a4b0: 7061 6e3e 0a20 2020 2020 2020 203c 7370  pan>.        <sp
-0001a4c0: 616e 2063 6c61 7373 3d22 6e22 3e73 616d  an class="n">sam
-0001a4d0: 706c 655f 6964 783c 2f73 7061 6e3e 203c  ple_idx</span> <
-0001a4e0: 7370 616e 2063 6c61 7373 3d22 6f22 3e3d  span class="o">=
-0001a4f0: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
-0001a500: 6173 733d 226e 223e 746f 7263 683c 2f73  ass="n">torch</s
-0001a510: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
-0001a520: 226f 223e 2e3c 2f73 7061 6e3e 3c73 7061  "o">.</span><spa
-0001a530: 6e20 636c 6173 733d 226e 223e 7265 6d61  n class="n">rema
-0001a540: 696e 6465 723c 2f73 7061 6e3e 3c73 7061  inder</span><spa
-0001a550: 6e20 636c 6173 733d 2270 223e 283c 2f73  n class="p">(</s
-0001a560: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
-0001a570: 226e 223e 7361 6d70 6c65 5f69 6478 3c2f  "n">sample_idx</
-0001a580: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
-0001a590: 3d22 7022 3e2c 3c2f 7370 616e 3e20 3c73  ="p">,</span> <s
-0001a5a0: 7061 6e20 636c 6173 733d 226e 223e 6c65  pan class="n">le
-0001a5b0: 6e5f 7365 713c 2f73 7061 6e3e 3c73 7061  n_seq</span><spa
-0001a5c0: 6e20 636c 6173 733d 2270 223e 293c 2f73  n class="p">)</s
-0001a5d0: 7061 6e3e 0a20 2020 2020 2020 203c 7370  pan>.        <sp
-0001a5e0: 616e 2063 6c61 7373 3d22 6e22 3e73 616d  an class="n">sam
-0001a5f0: 706c 655f 6964 783c 2f73 7061 6e3e 203c  ple_idx</span> <
-0001a600: 7370 616e 2063 6c61 7373 3d22 6f22 3e3d  span class="o">=
-0001a610: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
-0001a620: 6173 733d 226e 223e 7361 6d70 6c65 5f69  ass="n">sample_i
-0001a630: 6478 3c2f 7370 616e 3e3c 7370 616e 2063  dx</span><span c
-0001a640: 6c61 7373 3d22 7022 3e5b 3c2f 7370 616e  lass="p">[</span
-0001a650: 3e3c 7370 616e 2063 6c61 7373 3d22 6d69  ><span class="mi
-0001a660: 223e 303c 2f73 7061 6e3e 3c73 7061 6e20  ">0</span><span 
-0001a670: 636c 6173 733d 2270 223e 3a3c 2f73 7061  class="p">:</spa
-0001a680: 6e3e 3c73 7061 6e20 636c 6173 733d 226e  n><span class="n
-0001a690: 223e 6c65 6e5f 7365 713c 2f73 7061 6e3e  ">len_seq</span>
-0001a6a0: 3c73 7061 6e20 636c 6173 733d 2270 223e  <span class="p">
-0001a6b0: 5d3c 2f73 7061 6e3e 0a20 2020 2020 2020  ]</span>.       
-0001a6c0: 203c 7370 616e 2063 6c61 7373 3d22 6e22   <span class="n"
-0001a6d0: 3e73 616d 706c 655f 6964 783c 2f73 7061  >sample_idx</spa
-0001a6e0: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
-0001a6f0: 6f22 3e3d 3c2f 7370 616e 3e20 3c73 7061  o">=</span> <spa
-0001a700: 6e20 636c 6173 733d 226e 223e 7361 6d70  n class="n">samp
-0001a710: 6c65 5f69 6478 3c2f 7370 616e 3e20 3c73  le_idx</span> <s
-0001a720: 7061 6e20 636c 6173 733d 226f 223e 2b3c  pan class="o">+<
-0001a730: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
-0001a740: 7373 3d22 6e22 3e6e 756d 5f63 6f6e 665f  ss="n">num_conf_
-0001a750: 6375 6d73 756d 3c2f 7370 616e 3e3c 7370  cumsum</span><sp
-0001a760: 616e 2063 6c61 7373 3d22 7022 3e5b 3c2f  an class="p">[</
-0001a770: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
-0001a780: 3d22 6e22 3e69 3c2f 7370 616e 3e3c 7370  ="n">i</span><sp
-0001a790: 616e 2063 6c61 7373 3d22 7022 3e5d 3c2f  an class="p">]</
-0001a7a0: 7370 616e 3e0a 2020 2020 2020 2020 3c73  span>.        <s
-0001a7b0: 7061 6e20 636c 6173 733d 226e 223e 636f  pan class="n">co
-0001a7c0: 6e66 5f69 6478 3c2f 7370 616e 3e3c 7370  nf_idx</span><sp
-0001a7d0: 616e 2063 6c61 7373 3d22 6f22 3e2e 3c2f  an class="o">.</
-0001a7e0: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
-0001a7f0: 3d22 6e22 3e61 7070 656e 643c 2f73 7061  ="n">append</spa
-0001a800: 6e3e 3c73 7061 6e20 636c 6173 733d 2270  n><span class="p
-0001a810: 223e 283c 2f73 7061 6e3e 3c73 7061 6e20  ">(</span><span 
-0001a820: 636c 6173 733d 226e 223e 7361 6d70 6c65  class="n">sample
-0001a830: 5f69 6478 3c2f 7370 616e 3e3c 7370 616e  _idx</span><span
-0001a840: 2063 6c61 7373 3d22 7022 3e29 3c2f 7370   class="p">)</sp
-0001a850: 616e 3e0a 2020 2020 3c73 7061 6e20 636c  an>.    <span cl
-0001a860: 6173 733d 226e 223e 636f 6e66 5f69 6478  ass="n">conf_idx
-0001a870: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
-0001a880: 6173 733d 226f 223e 3d3c 2f73 7061 6e3e  ass="o">=</span>
-0001a890: 203c 7370 616e 2063 6c61 7373 3d22 6e22   <span class="n"
-0001a8a0: 3e74 6f72 6368 3c2f 7370 616e 3e3c 7370  >torch</span><sp
-0001a8b0: 616e 2063 6c61 7373 3d22 6f22 3e2e 3c2f  an class="o">.</
-0001a8c0: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
-0001a8d0: 3d22 6e22 3e63 6174 3c2f 7370 616e 3e3c  ="n">cat</span><
-0001a8e0: 7370 616e 2063 6c61 7373 3d22 7022 3e28  span class="p">(
-0001a8f0: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-0001a900: 7373 3d22 6e22 3e63 6f6e 665f 6964 783c  ss="n">conf_idx<
-0001a910: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
-0001a920: 733d 2270 223e 293c 2f73 7061 6e3e 0a20  s="p">)</span>. 
-0001a930: 2020 203c 7370 616e 2063 6c61 7373 3d22     <span class="
-0001a940: 6b22 3e72 6574 7572 6e3c 2f73 7061 6e3e  k">return</span>
-0001a950: 203c 7370 616e 2063 6c61 7373 3d22 6e22   <span class="n"
-0001a960: 3e63 6f6e 665f 6964 783c 2f73 7061 6e3e  >conf_idx</span>
-0001a970: 0a0a 0a3c 7370 616e 2063 6c61 7373 3d22  ...<span class="
-0001a980: 6b22 3e64 6566 3c2f 7370 616e 3e20 3c73  k">def</span> <s
-0001a990: 7061 6e20 636c 6173 733d 226e 6622 3e66  pan class="nf">f
-0001a9a0: 6d69 6e5f 6e65 7774 6f6e 3c2f 7370 616e  min_newton</span
-0001a9b0: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
-0001a9c0: 3e28 3c2f 7370 616e 3e3c 7370 616e 2063  >(</span><span c
-0001a9d0: 6c61 7373 3d22 6e22 3e66 3c2f 7370 616e  lass="n">f</span
-0001a9e0: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
-0001a9f0: 3e2c 3c2f 7370 616e 3e20 3c73 7061 6e20  >,</span> <span 
-0001aa00: 636c 6173 733d 226e 223e 6865 7373 3c2f  class="n">hess</
-0001aa10: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
-0001aa20: 3d22 7022 3e2c 3c2f 7370 616e 3e20 3c73  ="p">,</span> <s
-0001aa30: 7061 6e20 636c 6173 733d 226e 223e 785f  pan class="n">x_
-0001aa40: 696e 6974 3c2f 7370 616e 3e3c 7370 616e  init</span><span
+00019e40: 2270 223e 283c 2f73 7061 6e3e 3c73 7061  "p">(</span><spa
+00019e50: 6e20 636c 6173 733d 226e 6222 3e6c 656e  n class="nb">len
+00019e60: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
+00019e70: 7373 3d22 7022 3e28 3c2f 7370 616e 3e3c  ss="p">(</span><
+00019e80: 7370 616e 2063 6c61 7373 3d22 6e22 3e6e  span class="n">n
+00019e90: 756d 5f63 6f6e 663c 2f73 7061 6e3e 3c73  um_conf</span><s
+00019ea0: 7061 6e20 636c 6173 733d 2270 223e 2929  pan class="p">))
+00019eb0: 3a3c 2f73 7061 6e3e 0a20 2020 2020 2020  :</span>.       
+00019ec0: 203c 7370 616e 2063 6c61 7373 3d22 6e22   <span class="n"
+00019ed0: 3e6c 656e 5f73 6571 3c2f 7370 616e 3e20  >len_seq</span> 
+00019ee0: 3c73 7061 6e20 636c 6173 733d 226f 223e  <span class="o">
+00019ef0: 3d3c 2f73 7061 6e3e 203c 7370 616e 2063  =</span> <span c
+00019f00: 6c61 7373 3d22 6e62 223e 696e 743c 2f73  lass="nb">int</s
+00019f10: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
+00019f20: 2270 223e 283c 2f73 7061 6e3e 3c73 7061  "p">(</span><spa
+00019f30: 6e20 636c 6173 733d 226e 223e 6e75 6d5f  n class="n">num_
+00019f40: 636f 6e66 3c2f 7370 616e 3e3c 7370 616e  conf</span><span
+00019f50: 2063 6c61 7373 3d22 7022 3e5b 3c2f 7370   class="p">[</sp
+00019f60: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+00019f70: 6e22 3e69 3c2f 7370 616e 3e3c 7370 616e  n">i</span><span
+00019f80: 2063 6c61 7373 3d22 7022 3e5d 293c 2f73   class="p">])</s
+00019f90: 7061 6e3e 2020 3c73 7061 6e20 636c 6173  pan>  <span clas
+00019fa0: 733d 2263 3122 3e23 2320 7573 696e 6720  s="c1">## using 
+00019fb0: 6369 7263 756c 6172 2062 6c6f 636b 2062  circular block b
+00019fc0: 6f6f 7473 7472 6170 3c2f 7370 616e 3e0a  ootstrap</span>.
+00019fd0: 2020 2020 2020 2020 3c73 7061 6e20 636c          <span cl
+00019fe0: 6173 733d 226e 223e 6e75 6d5f 7361 6d70  ass="n">num_samp
+00019ff0: 6c65 5f62 6c6f 636b 3c2f 7370 616e 3e20  le_block</span> 
+0001a000: 3c73 7061 6e20 636c 6173 733d 226f 223e  <span class="o">
+0001a010: 3d3c 2f73 7061 6e3e 203c 7370 616e 2063  =</span> <span c
+0001a020: 6c61 7373 3d22 6e62 223e 696e 743c 2f73  lass="nb">int</s
+0001a030: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
+0001a040: 2270 223e 283c 2f73 7061 6e3e 3c73 7061  "p">(</span><spa
+0001a050: 6e20 636c 6173 733d 226e 223e 6e70 3c2f  n class="n">np</
+0001a060: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+0001a070: 3d22 6f22 3e2e 3c2f 7370 616e 3e3c 7370  ="o">.</span><sp
+0001a080: 616e 2063 6c61 7373 3d22 6e22 3e63 6569  an class="n">cei
+0001a090: 6c3c 2f73 7061 6e3e 3c73 7061 6e20 636c  l</span><span cl
+0001a0a0: 6173 733d 2270 223e 283c 2f73 7061 6e3e  ass="p">(</span>
+0001a0b0: 3c73 7061 6e20 636c 6173 733d 226e 223e  <span class="n">
+0001a0c0: 6c65 6e5f 7365 713c 2f73 7061 6e3e 203c  len_seq</span> <
+0001a0d0: 7370 616e 2063 6c61 7373 3d22 6f22 3e2f  span class="o">/
+0001a0e0: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
+0001a0f0: 6173 733d 226e 223e 626f 6f74 7374 7261  ass="n">bootstra
+0001a100: 705f 626c 6f63 6b5f 7369 7a65 3c2f 7370  p_block_size</sp
+0001a110: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+0001a120: 7022 3e29 293c 2f73 7061 6e3e 0a20 2020  p">))</span>.   
+0001a130: 2020 2020 203c 7370 616e 2063 6c61 7373       <span class
+0001a140: 3d22 6e22 3e69 6478 733c 2f73 7061 6e3e  ="n">idxs</span>
+0001a150: 203c 7370 616e 2063 6c61 7373 3d22 6f22   <span class="o"
+0001a160: 3e3d 3c2f 7370 616e 3e20 3c73 7061 6e20  >=</span> <span 
+0001a170: 636c 6173 733d 226e 223e 746f 7263 683c  class="n">torch<
+0001a180: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
+0001a190: 733d 226f 223e 2e3c 2f73 7061 6e3e 3c73  s="o">.</span><s
+0001a1a0: 7061 6e20 636c 6173 733d 226e 223e 7261  pan class="n">ra
+0001a1b0: 6e64 696e 743c 2f73 7061 6e3e 3c73 7061  ndint</span><spa
+0001a1c0: 6e20 636c 6173 733d 2270 223e 283c 2f73  n class="p">(</s
+0001a1d0: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
+0001a1e0: 226d 6922 3e30 3c2f 7370 616e 3e3c 7370  "mi">0</span><sp
+0001a1f0: 616e 2063 6c61 7373 3d22 7022 3e2c 3c2f  an class="p">,</
+0001a200: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
+0001a210: 733d 226e 223e 6c65 6e5f 7365 713c 2f73  s="n">len_seq</s
+0001a220: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
+0001a230: 2270 223e 2c3c 2f73 7061 6e3e 203c 7370  "p">,</span> <sp
+0001a240: 616e 2063 6c61 7373 3d22 7022 3e28 3c2f  an class="p">(</
+0001a250: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+0001a260: 3d22 6e22 3e6e 756d 5f73 616d 706c 655f  ="n">num_sample_
+0001a270: 626c 6f63 6b3c 2f73 7061 6e3e 3c73 7061  block</span><spa
+0001a280: 6e20 636c 6173 733d 2270 223e 2c29 293c  n class="p">,))<
+0001a290: 2f73 7061 6e3e 0a20 2020 2020 2020 203c  /span>.        <
+0001a2a0: 7370 616e 2063 6c61 7373 3d22 6e22 3e73  span class="n">s
+0001a2b0: 616d 706c 655f 6964 783c 2f73 7061 6e3e  ample_idx</span>
+0001a2c0: 203c 7370 616e 2063 6c61 7373 3d22 6f22   <span class="o"
+0001a2d0: 3e3d 3c2f 7370 616e 3e20 3c73 7061 6e20  >=</span> <span 
+0001a2e0: 636c 6173 733d 226e 223e 746f 7263 683c  class="n">torch<
+0001a2f0: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
+0001a300: 733d 226f 223e 2e3c 2f73 7061 6e3e 3c73  s="o">.</span><s
+0001a310: 7061 6e20 636c 6173 733d 226e 223e 6361  pan class="n">ca
+0001a320: 743c 2f73 7061 6e3e 3c73 7061 6e20 636c  t</span><span cl
+0001a330: 6173 733d 2270 223e 283c 2f73 7061 6e3e  ass="p">(</span>
+0001a340: 0a20 2020 2020 2020 2020 2020 203c 7370  .            <sp
+0001a350: 616e 2063 6c61 7373 3d22 7022 3e5b 3c2f  an class="p">[</
+0001a360: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+0001a370: 3d22 6e22 3e74 6f72 6368 3c2f 7370 616e  ="n">torch</span
+0001a380: 3e3c 7370 616e 2063 6c61 7373 3d22 6f22  ><span class="o"
+0001a390: 3e2e 3c2f 7370 616e 3e3c 7370 616e 2063  >.</span><span c
+0001a3a0: 6c61 7373 3d22 6e22 3e61 7261 6e67 653c  lass="n">arange<
+0001a3b0: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
+0001a3c0: 733d 2270 223e 283c 2f73 7061 6e3e 3c73  s="p">(</span><s
+0001a3d0: 7061 6e20 636c 6173 733d 226e 223e 6964  pan class="n">id
+0001a3e0: 783c 2f73 7061 6e3e 3c73 7061 6e20 636c  x</span><span cl
+0001a3f0: 6173 733d 2270 223e 2c3c 2f73 7061 6e3e  ass="p">,</span>
+0001a400: 203c 7370 616e 2063 6c61 7373 3d22 6e22   <span class="n"
+0001a410: 3e69 6478 3c2f 7370 616e 3e20 3c73 7061  >idx</span> <spa
+0001a420: 6e20 636c 6173 733d 226f 223e 2b3c 2f73  n class="o">+</s
+0001a430: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
+0001a440: 3d22 6e22 3e62 6f6f 7473 7472 6170 5f62  ="n">bootstrap_b
+0001a450: 6c6f 636b 5f73 697a 653c 2f73 7061 6e3e  lock_size</span>
+0001a460: 3c73 7061 6e20 636c 6173 733d 2270 223e  <span class="p">
+0001a470: 293c 2f73 7061 6e3e 203c 7370 616e 2063  )</span> <span c
+0001a480: 6c61 7373 3d22 6b22 3e66 6f72 3c2f 7370  lass="k">for</sp
+0001a490: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
+0001a4a0: 226e 223e 6964 783c 2f73 7061 6e3e 203c  "n">idx</span> <
+0001a4b0: 7370 616e 2063 6c61 7373 3d22 6f77 223e  span class="ow">
+0001a4c0: 696e 3c2f 7370 616e 3e20 3c73 7061 6e20  in</span> <span 
+0001a4d0: 636c 6173 733d 226e 223e 6964 7873 3c2f  class="n">idxs</
+0001a4e0: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+0001a4f0: 3d22 7022 3e5d 3c2f 7370 616e 3e0a 2020  ="p">]</span>.  
+0001a500: 2020 2020 2020 3c73 7061 6e20 636c 6173        <span clas
+0001a510: 733d 2270 223e 293c 2f73 7061 6e3e 0a20  s="p">)</span>. 
+0001a520: 2020 2020 2020 203c 7370 616e 2063 6c61         <span cla
+0001a530: 7373 3d22 6e22 3e73 616d 706c 655f 6964  ss="n">sample_id
+0001a540: 783c 2f73 7061 6e3e 203c 7370 616e 2063  x</span> <span c
+0001a550: 6c61 7373 3d22 6f22 3e3d 3c2f 7370 616e  lass="o">=</span
+0001a560: 3e20 3c73 7061 6e20 636c 6173 733d 226e  > <span class="n
+0001a570: 223e 746f 7263 683c 2f73 7061 6e3e 3c73  ">torch</span><s
+0001a580: 7061 6e20 636c 6173 733d 226f 223e 2e3c  pan class="o">.<
+0001a590: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
+0001a5a0: 733d 226e 223e 7265 6d61 696e 6465 723c  s="n">remainder<
+0001a5b0: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
+0001a5c0: 733d 2270 223e 283c 2f73 7061 6e3e 3c73  s="p">(</span><s
+0001a5d0: 7061 6e20 636c 6173 733d 226e 223e 7361  pan class="n">sa
+0001a5e0: 6d70 6c65 5f69 6478 3c2f 7370 616e 3e3c  mple_idx</span><
+0001a5f0: 7370 616e 2063 6c61 7373 3d22 7022 3e2c  span class="p">,
+0001a600: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
+0001a610: 6173 733d 226e 223e 6c65 6e5f 7365 713c  ass="n">len_seq<
+0001a620: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
+0001a630: 733d 2270 223e 293c 2f73 7061 6e3e 0a20  s="p">)</span>. 
+0001a640: 2020 2020 2020 203c 7370 616e 2063 6c61         <span cla
+0001a650: 7373 3d22 6e22 3e73 616d 706c 655f 6964  ss="n">sample_id
+0001a660: 783c 2f73 7061 6e3e 203c 7370 616e 2063  x</span> <span c
+0001a670: 6c61 7373 3d22 6f22 3e3d 3c2f 7370 616e  lass="o">=</span
+0001a680: 3e20 3c73 7061 6e20 636c 6173 733d 226e  > <span class="n
+0001a690: 223e 7361 6d70 6c65 5f69 6478 3c2f 7370  ">sample_idx</sp
+0001a6a0: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+0001a6b0: 7022 3e5b 3c2f 7370 616e 3e3c 7370 616e  p">[</span><span
+0001a6c0: 2063 6c61 7373 3d22 6d69 223e 303c 2f73   class="mi">0</s
+0001a6d0: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
+0001a6e0: 2270 223e 3a3c 2f73 7061 6e3e 3c73 7061  "p">:</span><spa
+0001a6f0: 6e20 636c 6173 733d 226e 223e 6c65 6e5f  n class="n">len_
+0001a700: 7365 713c 2f73 7061 6e3e 3c73 7061 6e20  seq</span><span 
+0001a710: 636c 6173 733d 2270 223e 5d3c 2f73 7061  class="p">]</spa
+0001a720: 6e3e 0a20 2020 2020 2020 203c 7370 616e  n>.        <span
+0001a730: 2063 6c61 7373 3d22 6e22 3e73 616d 706c   class="n">sampl
+0001a740: 655f 6964 783c 2f73 7061 6e3e 203c 7370  e_idx</span> <sp
+0001a750: 616e 2063 6c61 7373 3d22 6f22 3e3d 3c2f  an class="o">=</
+0001a760: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
+0001a770: 733d 226e 223e 7361 6d70 6c65 5f69 6478  s="n">sample_idx
+0001a780: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
+0001a790: 6173 733d 226f 223e 2b3c 2f73 7061 6e3e  ass="o">+</span>
+0001a7a0: 203c 7370 616e 2063 6c61 7373 3d22 6e22   <span class="n"
+0001a7b0: 3e6e 756d 5f63 6f6e 665f 6375 6d73 756d  >num_conf_cumsum
+0001a7c0: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
+0001a7d0: 7373 3d22 7022 3e5b 3c2f 7370 616e 3e3c  ss="p">[</span><
+0001a7e0: 7370 616e 2063 6c61 7373 3d22 6e22 3e69  span class="n">i
+0001a7f0: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
+0001a800: 7373 3d22 7022 3e5d 3c2f 7370 616e 3e0a  ss="p">]</span>.
+0001a810: 2020 2020 2020 2020 3c73 7061 6e20 636c          <span cl
+0001a820: 6173 733d 226e 223e 636f 6e66 5f69 6478  ass="n">conf_idx
+0001a830: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
+0001a840: 7373 3d22 6f22 3e2e 3c2f 7370 616e 3e3c  ss="o">.</span><
+0001a850: 7370 616e 2063 6c61 7373 3d22 6e22 3e61  span class="n">a
+0001a860: 7070 656e 643c 2f73 7061 6e3e 3c73 7061  ppend</span><spa
+0001a870: 6e20 636c 6173 733d 2270 223e 283c 2f73  n class="p">(</s
+0001a880: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
+0001a890: 226e 223e 7361 6d70 6c65 5f69 6478 3c2f  "n">sample_idx</
+0001a8a0: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+0001a8b0: 3d22 7022 3e29 3c2f 7370 616e 3e0a 2020  ="p">)</span>.  
+0001a8c0: 2020 3c73 7061 6e20 636c 6173 733d 226e    <span class="n
+0001a8d0: 223e 636f 6e66 5f69 6478 3c2f 7370 616e  ">conf_idx</span
+0001a8e0: 3e20 3c73 7061 6e20 636c 6173 733d 226f  > <span class="o
+0001a8f0: 223e 3d3c 2f73 7061 6e3e 203c 7370 616e  ">=</span> <span
+0001a900: 2063 6c61 7373 3d22 6e22 3e74 6f72 6368   class="n">torch
+0001a910: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
+0001a920: 7373 3d22 6f22 3e2e 3c2f 7370 616e 3e3c  ss="o">.</span><
+0001a930: 7370 616e 2063 6c61 7373 3d22 6e22 3e63  span class="n">c
+0001a940: 6174 3c2f 7370 616e 3e3c 7370 616e 2063  at</span><span c
+0001a950: 6c61 7373 3d22 7022 3e28 3c2f 7370 616e  lass="p">(</span
+0001a960: 3e3c 7370 616e 2063 6c61 7373 3d22 6e22  ><span class="n"
+0001a970: 3e63 6f6e 665f 6964 783c 2f73 7061 6e3e  >conf_idx</span>
+0001a980: 3c73 7061 6e20 636c 6173 733d 2270 223e  <span class="p">
+0001a990: 293c 2f73 7061 6e3e 0a20 2020 203c 7370  )</span>.    <sp
+0001a9a0: 616e 2063 6c61 7373 3d22 6b22 3e72 6574  an class="k">ret
+0001a9b0: 7572 6e3c 2f73 7061 6e3e 203c 7370 616e  urn</span> <span
+0001a9c0: 2063 6c61 7373 3d22 6e22 3e63 6f6e 665f   class="n">conf_
+0001a9d0: 6964 783c 2f73 7061 6e3e 0a0a 0a3c 7370  idx</span>...<sp
+0001a9e0: 616e 2063 6c61 7373 3d22 6b22 3e64 6566  an class="k">def
+0001a9f0: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
+0001aa00: 6173 733d 226e 6622 3e66 6d69 6e5f 6e65  ass="nf">fmin_ne
+0001aa10: 7774 6f6e 3c2f 7370 616e 3e3c 7370 616e  wton</span><span
+0001aa20: 2063 6c61 7373 3d22 7022 3e28 3c2f 7370   class="p">(</sp
+0001aa30: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+0001aa40: 6e22 3e66 3c2f 7370 616e 3e3c 7370 616e  n">f</span><span
 0001aa50: 2063 6c61 7373 3d22 7022 3e2c 3c2f 7370   class="p">,</sp
 0001aa60: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
-0001aa70: 226e 223e 6172 6773 3c2f 7370 616e 3e3c  "n">args</span><
-0001aa80: 7370 616e 2063 6c61 7373 3d22 6f22 3e3d  span class="o">=
-0001aa90: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-0001aaa0: 7373 3d22 7022 3e28 292c 3c2f 7370 616e  ss="p">(),</span
-0001aab0: 3e20 3c73 7061 6e20 636c 6173 733d 226e  > <span class="n
-0001aac0: 223e 7665 7262 6f73 653c 2f73 7061 6e3e  ">verbose</span>
-0001aad0: 3c73 7061 6e20 636c 6173 733d 226f 223e  <span class="o">
-0001aae0: 3d3c 2f73 7061 6e3e 3c73 7061 6e20 636c  =</span><span cl
-0001aaf0: 6173 733d 226b 6322 3e54 7275 653c 2f73  ass="kc">True</s
-0001ab00: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
-0001ab10: 2270 223e 2c3c 2f73 7061 6e3e 203c 7370  "p">,</span> <sp
-0001ab20: 616e 2063 6c61 7373 3d22 6e22 3e65 7073  an class="n">eps
-0001ab30: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-0001ab40: 7373 3d22 6f22 3e3d 3c2f 7370 616e 3e3c  ss="o">=</span><
-0001ab50: 7370 616e 2063 6c61 7373 3d22 6d66 223e  span class="mf">
-0001ab60: 3165 2d31 323c 2f73 7061 6e3e 3c73 7061  1e-12</span><spa
-0001ab70: 6e20 636c 6173 733d 2270 223e 2c3c 2f73  n class="p">,</s
-0001ab80: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
-0001ab90: 3d22 6e22 3e6d 6178 5f69 7465 723c 2f73  ="n">max_iter</s
-0001aba0: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
-0001abb0: 226f 223e 3d3c 2f73 7061 6e3e 3c73 7061  "o">=</span><spa
-0001abc0: 6e20 636c 6173 733d 226d 6922 3e33 3030  n class="mi">300
-0001abd0: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-0001abe0: 7373 3d22 7022 3e29 3a3c 2f73 7061 6e3e  ss="p">):</span>
-0001abf0: 0a3c 7370 616e 2063 6c61 7373 3d22 7722  .<span class="w"
-0001ac00: 3e20 2020 203c 2f73 7061 6e3e 3c73 7061  >    </span><spa
-0001ac10: 6e20 636c 6173 733d 2273 6422 3e26 7175  n class="sd">&qu
-0001ac20: 6f74 3b26 7175 6f74 3b26 7175 6f74 3b4d  ot;&quot;&quot;M
-0001ac30: 696e 696d 697a 6520 6120 6675 6e63 7469  inimize a functi
-0001ac40: 6f6e 2077 6974 6820 7468 6520 4e65 7774  on with the Newt
-0001ac50: 6f6e 2623 3339 3b73 206d 6574 686f 642e  on&#39;s method.
-0001ac60: 3c2f 7370 616e 3e0a 0a3c 7370 616e 2063  </span>..<span c
-0001ac70: 6c61 7373 3d22 7364 223e 2020 2020 466f  lass="sd">    Fo
-0001ac80: 7220 6465 7461 696c 7320 6f66 2074 6865  r details of the
-0001ac90: 204e 6577 746f 6e26 2333 393b 7320 6d65   Newton&#39;s me
-0001aca0: 7468 6f64 2c20 7365 6520 4368 6170 7465  thod, see Chapte
-0001acb0: 7220 392e 3520 6f66 2050 726f 662e 2042  r 9.5 of Prof. B
-0001acc0: 6f79 6426 2333 393b 7320 626f 6f6b 3c2f  oyd&#39;s book</
-0001acd0: 7370 616e 3e0a 3c73 7061 6e20 636c 6173  span>.<span clas
-0001ace0: 733d 2273 6422 3e20 2020 2060 436f 6e76  s="sd">    `Conv
-0001acf0: 6578 204f 7074 696d 697a 6174 696f 6e20  ex Optimization 
-0001ad00: 266c 743b 6874 7470 733a 2f2f 7765 622e  &lt;https://web.
-0001ad10: 7374 616e 666f 7264 2e65 6475 2f7e 626f  stanford.edu/~bo
-0001ad20: 7964 2f63 7678 626f 6f6b 2f26 6774 3b60  yd/cvxbook/&gt;`
-0001ad30: 5f2e 3c2f 7370 616e 3e0a 0a3c 7370 616e  _.</span>..<span
-0001ad40: 2063 6c61 7373 3d22 7364 223e 2020 2020   class="sd">    
-0001ad50: 4172 6773 3a3c 2f73 7061 6e3e 0a3c 7370  Args:</span>.<sp
-0001ad60: 616e 2063 6c61 7373 3d22 7364 223e 2020  an class="sd">  
-0001ad70: 2020 2020 2020 6620 2863 616c 6c61 626c        f (callabl
-0001ad80: 6529 3a20 7468 6520 6f62 6a65 6374 6976  e): the objectiv
-0001ad90: 6520 6675 6e63 7469 6f6e 2074 6f20 6265  e function to be
-0001ada0: 206d 696e 696d 697a 6564 2e3c 2f73 7061   minimized.</spa
-0001adb0: 6e3e 0a3c 7370 616e 2063 6c61 7373 3d22  n>.<span class="
-0001adc0: 7364 223e 2020 2020 2020 2020 2020 2020  sd">            
-0001add0: 6628 783a 5465 6e73 6f72 2c20 2a61 7267  f(x:Tensor, *arg
-0001ade0: 7329 202d 2667 743b 2020 2879 3a54 656e  s) -&gt;  (y:Ten
-0001adf0: 736f 722c 2067 7261 643a 5465 6e73 6f72  sor, grad:Tensor
-0001ae00: 292c 2077 6865 7265 3c2f 7370 616e 3e0a  ), where</span>.
-0001ae10: 3c73 7061 6e20 636c 6173 733d 2273 6422  <span class="sd"
-0001ae20: 3e20 2020 2020 2020 2020 2020 2079 2069  >            y i
-0001ae30: 7320 7468 6520 6675 6e63 7469 6f6e 2076  s the function v
-0001ae40: 616c 7565 2061 6e64 2067 7261 6420 6973  alue and grad is
-0001ae50: 2074 6865 2067 7261 6469 656e 742e 3c2f   the gradient.</
-0001ae60: 7370 616e 3e0a 3c73 7061 6e20 636c 6173  span>.<span clas
-0001ae70: 733d 2273 6422 3e20 2020 2020 2020 2068  s="sd">        h
-0001ae80: 6573 7320 2863 616c 6c61 626c 6529 3a20  ess (callable): 
-0001ae90: 7468 6520 6675 6e63 7469 6f6e 2074 6f20  the function to 
-0001aea0: 636f 6d70 7574 6520 7468 6520 4865 7373  compute the Hess
-0001aeb0: 6961 6e20 6d61 7472 6978 2e3c 2f73 7061  ian matrix.</spa
-0001aec0: 6e3e 0a3c 7370 616e 2063 6c61 7373 3d22  n>.<span class="
-0001aed0: 7364 223e 2020 2020 2020 2020 2020 2020  sd">            
-0001aee0: 6865 7373 2878 3a54 656e 736f 722c 202a  hess(x:Tensor, *
-0001aef0: 6172 6773 2920 2d26 6774 3b20 6120 7477  args) -&gt; a tw
-0001af00: 6f20 6469 6d65 6e73 696f 6e61 6c20 7465  o dimensional te
-0001af10: 6e73 6f72 2e3c 2f73 7061 6e3e 0a3c 7370  nsor.</span>.<sp
-0001af20: 616e 2063 6c61 7373 3d22 7364 223e 2020  an class="sd">  
-0001af30: 2020 2020 2020 785f 696e 6974 2028 5465        x_init (Te
-0001af40: 6e73 6f72 293a 2074 6865 2069 6e69 7469  nsor): the initi
-0001af50: 616c 2076 616c 7565 2e3c 2f73 7061 6e3e  al value.</span>
-0001af60: 0a3c 7370 616e 2063 6c61 7373 3d22 7364  .<span class="sd
-0001af70: 223e 2020 2020 2020 2020 6172 6773 2028  ">        args (
-0001af80: 7475 706c 6529 3a20 6578 7472 6120 7061  tuple): extra pa
-0001af90: 7261 6d65 7465 7273 2066 6f72 2066 2061  rameters for f a
-0001afa0: 6e64 2068 6573 732e 3c2f 7370 616e 3e0a  nd hess.</span>.
-0001afb0: 3c73 7061 6e20 636c 6173 733d 2273 6422  <span class="sd"
-0001afc0: 3e20 2020 2020 2020 2076 6572 626f 7365  >        verbose
-0001afd0: 2028 626f 6f6c 293a 2077 6865 7468 6572   (bool): whether
-0001afe0: 2074 6f20 7072 696e 7420 6d69 6e69 6d69   to print minimi
-0001aff0: 7a69 6e67 206c 6f67 2069 6e66 6f72 6d61  zing log informa
-0001b000: 7469 6f6e 2e3c 2f73 7061 6e3e 0a3c 7370  tion.</span>.<sp
-0001b010: 616e 2063 6c61 7373 3d22 7364 223e 2020  an class="sd">  
-0001b020: 2020 2020 2020 6570 7320 2866 6c6f 6174        eps (float
-0001b030: 293a 2074 6f6c 6572 616e 6365 2066 6f72  ): tolerance for
-0001b040: 2073 746f 7070 696e 673c 2f73 7061 6e3e   stopping</span>
-0001b050: 0a3c 7370 616e 2063 6c61 7373 3d22 7364  .<span class="sd
-0001b060: 223e 2020 2020 2020 2020 6d61 785f 6974  ">        max_it
-0001b070: 6572 2028 696e 7429 3a20 6d61 7869 6d75  er (int): maximu
-0001b080: 6d20 6e75 6d62 6572 206f 6620 6974 6572  m number of iter
-0001b090: 6174 696f 6e73 2e3c 2f73 7061 6e3e 0a3c  ations.</span>.<
-0001b0a0: 7370 616e 2063 6c61 7373 3d22 7364 223e  span class="sd">
-0001b0b0: 2020 2020 2671 756f 743b 2671 756f 743b      &quot;&quot;
-0001b0c0: 2671 756f 743b 3c2f 7370 616e 3e0a 0a20  &quot;</span>.. 
-0001b0d0: 2020 203c 7370 616e 2063 6c61 7373 3d22     <span class="
-0001b0e0: 6331 223e 2323 2063 6f6e 7374 616e 7473  c1">## constants
-0001b0f0: 2075 7365 6420 696e 2062 6163 6b74 7261   used in backtra
-0001b100: 636b 696e 6720 6c69 6e65 2073 6561 7263  cking line searc
-0001b110: 683c 2f73 7061 6e3e 0a20 2020 203c 7370  h</span>.    <sp
-0001b120: 616e 2063 6c61 7373 3d22 6e22 3e61 6c70  an class="n">alp
-0001b130: 6861 3c2f 7370 616e 3e3c 7370 616e 2063  ha</span><span c
-0001b140: 6c61 7373 3d22 7022 3e2c 3c2f 7370 616e  lass="p">,</span
-0001b150: 3e20 3c73 7061 6e20 636c 6173 733d 226e  > <span class="n
-0001b160: 223e 6265 7461 3c2f 7370 616e 3e20 3c73  ">beta</span> <s
-0001b170: 7061 6e20 636c 6173 733d 226f 223e 3d3c  pan class="o">=<
-0001b180: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
-0001b190: 7373 3d22 6d66 223e 302e 3031 3c2f 7370  ss="mf">0.01</sp
+0001aa70: 226e 223e 6865 7373 3c2f 7370 616e 3e3c  "n">hess</span><
+0001aa80: 7370 616e 2063 6c61 7373 3d22 7022 3e2c  span class="p">,
+0001aa90: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
+0001aaa0: 6173 733d 226e 223e 785f 696e 6974 3c2f  ass="n">x_init</
+0001aab0: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+0001aac0: 3d22 7022 3e2c 3c2f 7370 616e 3e20 3c73  ="p">,</span> <s
+0001aad0: 7061 6e20 636c 6173 733d 226e 223e 6172  pan class="n">ar
+0001aae0: 6773 3c2f 7370 616e 3e3c 7370 616e 2063  gs</span><span c
+0001aaf0: 6c61 7373 3d22 6f22 3e3d 3c2f 7370 616e  lass="o">=</span
+0001ab00: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
+0001ab10: 3e28 292c 3c2f 7370 616e 3e20 3c73 7061  >(),</span> <spa
+0001ab20: 6e20 636c 6173 733d 226e 223e 7665 7262  n class="n">verb
+0001ab30: 6f73 653c 2f73 7061 6e3e 3c73 7061 6e20  ose</span><span 
+0001ab40: 636c 6173 733d 226f 223e 3d3c 2f73 7061  class="o">=</spa
+0001ab50: 6e3e 3c73 7061 6e20 636c 6173 733d 226b  n><span class="k
+0001ab60: 6322 3e54 7275 653c 2f73 7061 6e3e 3c73  c">True</span><s
+0001ab70: 7061 6e20 636c 6173 733d 2270 223e 2c3c  pan class="p">,<
+0001ab80: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
+0001ab90: 7373 3d22 6e22 3e65 7073 3c2f 7370 616e  ss="n">eps</span
+0001aba0: 3e3c 7370 616e 2063 6c61 7373 3d22 6f22  ><span class="o"
+0001abb0: 3e3d 3c2f 7370 616e 3e3c 7370 616e 2063  >=</span><span c
+0001abc0: 6c61 7373 3d22 6d66 223e 3165 2d31 323c  lass="mf">1e-12<
+0001abd0: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
+0001abe0: 733d 2270 223e 2c3c 2f73 7061 6e3e 203c  s="p">,</span> <
+0001abf0: 7370 616e 2063 6c61 7373 3d22 6e22 3e6d  span class="n">m
+0001ac00: 6178 5f69 7465 723c 2f73 7061 6e3e 3c73  ax_iter</span><s
+0001ac10: 7061 6e20 636c 6173 733d 226f 223e 3d3c  pan class="o">=<
+0001ac20: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
+0001ac30: 733d 226d 6922 3e33 3030 3c2f 7370 616e  s="mi">300</span
+0001ac40: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
+0001ac50: 3e29 3a3c 2f73 7061 6e3e 0a3c 7370 616e  >):</span>.<span
+0001ac60: 2063 6c61 7373 3d22 7722 3e20 2020 203c   class="w">    <
+0001ac70: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
+0001ac80: 733d 2273 6422 3e26 7175 6f74 3b26 7175  s="sd">&quot;&qu
+0001ac90: 6f74 3b26 7175 6f74 3b4d 696e 696d 697a  ot;&quot;Minimiz
+0001aca0: 6520 6120 6675 6e63 7469 6f6e 2077 6974  e a function wit
+0001acb0: 6820 7468 6520 4e65 7774 6f6e 2623 3339  h the Newton&#39
+0001acc0: 3b73 206d 6574 686f 642e 3c2f 7370 616e  ;s method.</span
+0001acd0: 3e0a 0a3c 7370 616e 2063 6c61 7373 3d22  >..<span class="
+0001ace0: 7364 223e 2020 2020 466f 7220 6465 7461  sd">    For deta
+0001acf0: 696c 7320 6f66 2074 6865 204e 6577 746f  ils of the Newto
+0001ad00: 6e26 2333 393b 7320 6d65 7468 6f64 2c20  n&#39;s method, 
+0001ad10: 7365 6520 4368 6170 7465 7220 392e 3520  see Chapter 9.5 
+0001ad20: 6f66 2050 726f 662e 2042 6f79 6426 2333  of Prof. Boyd&#3
+0001ad30: 393b 7320 626f 6f6b 3c2f 7370 616e 3e0a  9;s book</span>.
+0001ad40: 3c73 7061 6e20 636c 6173 733d 2273 6422  <span class="sd"
+0001ad50: 3e20 2020 2060 436f 6e76 6578 204f 7074  >    `Convex Opt
+0001ad60: 696d 697a 6174 696f 6e20 266c 743b 6874  imization &lt;ht
+0001ad70: 7470 733a 2f2f 7765 622e 7374 616e 666f  tps://web.stanfo
+0001ad80: 7264 2e65 6475 2f7e 626f 7964 2f63 7678  rd.edu/~boyd/cvx
+0001ad90: 626f 6f6b 2f26 6774 3b60 5f2e 3c2f 7370  book/&gt;`_.</sp
+0001ada0: 616e 3e0a 0a3c 7370 616e 2063 6c61 7373  an>..<span class
+0001adb0: 3d22 7364 223e 2020 2020 4172 6773 3a3c  ="sd">    Args:<
+0001adc0: 2f73 7061 6e3e 0a3c 7370 616e 2063 6c61  /span>.<span cla
+0001add0: 7373 3d22 7364 223e 2020 2020 2020 2020  ss="sd">        
+0001ade0: 6620 2863 616c 6c61 626c 6529 3a20 7468  f (callable): th
+0001adf0: 6520 6f62 6a65 6374 6976 6520 6675 6e63  e objective func
+0001ae00: 7469 6f6e 2074 6f20 6265 206d 696e 696d  tion to be minim
+0001ae10: 697a 6564 2e3c 2f73 7061 6e3e 0a3c 7370  ized.</span>.<sp
+0001ae20: 616e 2063 6c61 7373 3d22 7364 223e 2020  an class="sd">  
+0001ae30: 2020 2020 2020 2020 2020 6628 783a 5465            f(x:Te
+0001ae40: 6e73 6f72 2c20 2a61 7267 7329 202d 2667  nsor, *args) -&g
+0001ae50: 743b 2020 2879 3a54 656e 736f 722c 2067  t;  (y:Tensor, g
+0001ae60: 7261 643a 5465 6e73 6f72 292c 2077 6865  rad:Tensor), whe
+0001ae70: 7265 3c2f 7370 616e 3e0a 3c73 7061 6e20  re</span>.<span 
+0001ae80: 636c 6173 733d 2273 6422 3e20 2020 2020  class="sd">     
+0001ae90: 2020 2020 2020 2079 2069 7320 7468 6520         y is the 
+0001aea0: 6675 6e63 7469 6f6e 2076 616c 7565 2061  function value a
+0001aeb0: 6e64 2067 7261 6420 6973 2074 6865 2067  nd grad is the g
+0001aec0: 7261 6469 656e 742e 3c2f 7370 616e 3e0a  radient.</span>.
+0001aed0: 3c73 7061 6e20 636c 6173 733d 2273 6422  <span class="sd"
+0001aee0: 3e20 2020 2020 2020 2068 6573 7320 2863  >        hess (c
+0001aef0: 616c 6c61 626c 6529 3a20 7468 6520 6675  allable): the fu
+0001af00: 6e63 7469 6f6e 2074 6f20 636f 6d70 7574  nction to comput
+0001af10: 6520 7468 6520 4865 7373 6961 6e20 6d61  e the Hessian ma
+0001af20: 7472 6978 2e3c 2f73 7061 6e3e 0a3c 7370  trix.</span>.<sp
+0001af30: 616e 2063 6c61 7373 3d22 7364 223e 2020  an class="sd">  
+0001af40: 2020 2020 2020 2020 2020 6865 7373 2878            hess(x
+0001af50: 3a54 656e 736f 722c 202a 6172 6773 2920  :Tensor, *args) 
+0001af60: 2d26 6774 3b20 6120 7477 6f20 6469 6d65  -&gt; a two dime
+0001af70: 6e73 696f 6e61 6c20 7465 6e73 6f72 2e3c  nsional tensor.<
+0001af80: 2f73 7061 6e3e 0a3c 7370 616e 2063 6c61  /span>.<span cla
+0001af90: 7373 3d22 7364 223e 2020 2020 2020 2020  ss="sd">        
+0001afa0: 785f 696e 6974 2028 5465 6e73 6f72 293a  x_init (Tensor):
+0001afb0: 2074 6865 2069 6e69 7469 616c 2076 616c   the initial val
+0001afc0: 7565 2e3c 2f73 7061 6e3e 0a3c 7370 616e  ue.</span>.<span
+0001afd0: 2063 6c61 7373 3d22 7364 223e 2020 2020   class="sd">    
+0001afe0: 2020 2020 6172 6773 2028 7475 706c 6529      args (tuple)
+0001aff0: 3a20 6578 7472 6120 7061 7261 6d65 7465  : extra paramete
+0001b000: 7273 2066 6f72 2066 2061 6e64 2068 6573  rs for f and hes
+0001b010: 732e 3c2f 7370 616e 3e0a 3c73 7061 6e20  s.</span>.<span 
+0001b020: 636c 6173 733d 2273 6422 3e20 2020 2020  class="sd">     
+0001b030: 2020 2076 6572 626f 7365 2028 626f 6f6c     verbose (bool
+0001b040: 293a 2077 6865 7468 6572 2074 6f20 7072  ): whether to pr
+0001b050: 696e 7420 6d69 6e69 6d69 7a69 6e67 206c  int minimizing l
+0001b060: 6f67 2069 6e66 6f72 6d61 7469 6f6e 2e3c  og information.<
+0001b070: 2f73 7061 6e3e 0a3c 7370 616e 2063 6c61  /span>.<span cla
+0001b080: 7373 3d22 7364 223e 2020 2020 2020 2020  ss="sd">        
+0001b090: 6570 7320 2866 6c6f 6174 293a 2074 6f6c  eps (float): tol
+0001b0a0: 6572 616e 6365 2066 6f72 2073 746f 7070  erance for stopp
+0001b0b0: 696e 673c 2f73 7061 6e3e 0a3c 7370 616e  ing</span>.<span
+0001b0c0: 2063 6c61 7373 3d22 7364 223e 2020 2020   class="sd">    
+0001b0d0: 2020 2020 6d61 785f 6974 6572 2028 696e      max_iter (in
+0001b0e0: 7429 3a20 6d61 7869 6d75 6d20 6e75 6d62  t): maximum numb
+0001b0f0: 6572 206f 6620 6974 6572 6174 696f 6e73  er of iterations
+0001b100: 2e3c 2f73 7061 6e3e 0a3c 7370 616e 2063  .</span>.<span c
+0001b110: 6c61 7373 3d22 7364 223e 2020 2020 2671  lass="sd">    &q
+0001b120: 756f 743b 2671 756f 743b 2671 756f 743b  uot;&quot;&quot;
+0001b130: 3c2f 7370 616e 3e0a 0a20 2020 203c 7370  </span>..    <sp
+0001b140: 616e 2063 6c61 7373 3d22 6331 223e 2323  an class="c1">##
+0001b150: 2063 6f6e 7374 616e 7473 2075 7365 6420   constants used 
+0001b160: 696e 2062 6163 6b74 7261 636b 696e 6720  in backtracking 
+0001b170: 6c69 6e65 2073 6561 7263 683c 2f73 7061  line search</spa
+0001b180: 6e3e 0a20 2020 203c 7370 616e 2063 6c61  n>.    <span cla
+0001b190: 7373 3d22 6e22 3e61 6c70 6861 3c2f 7370  ss="n">alpha</sp
 0001b1a0: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
 0001b1b0: 7022 3e2c 3c2f 7370 616e 3e20 3c73 7061  p">,</span> <spa
-0001b1c0: 6e20 636c 6173 733d 226d 6622 3e30 2e32  n class="mf">0.2
-0001b1d0: 3c2f 7370 616e 3e0a 0a20 2020 203c 7370  </span>..    <sp
-0001b1e0: 616e 2063 6c61 7373 3d22 6331 223e 2323  an class="c1">##
-0001b1f0: 204e 6577 746f 6e26 2333 393b 7320 6d65   Newton&#39;s me
-0001b200: 7468 6f64 2066 6f72 206d 696e 696d 697a  thod for minimiz
-0001b210: 696e 6720 7468 6520 6675 6e63 7469 6f6e  ing the function
-0001b220: 3c2f 7370 616e 3e0a 2020 2020 3c73 7061  </span>.    <spa
-0001b230: 6e20 636c 6173 733d 226e 223e 696e 6478  n class="n">indx
-0001b240: 5f69 7465 723c 2f73 7061 6e3e 203c 7370  _iter</span> <sp
-0001b250: 616e 2063 6c61 7373 3d22 6f22 3e3d 3c2f  an class="o">=</
-0001b260: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
-0001b270: 733d 226d 6922 3e30 3c2f 7370 616e 3e0a  s="mi">0</span>.
-0001b280: 0a20 2020 203c 7370 616e 2063 6c61 7373  .    <span class
-0001b290: 3d22 6e22 3e4e 5f66 756e 633c 2f73 7061  ="n">N_func</spa
-0001b2a0: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
-0001b2b0: 6f22 3e3d 3c2f 7370 616e 3e20 3c73 7061  o">=</span> <spa
-0001b2c0: 6e20 636c 6173 733d 226d 6922 3e30 3c2f  n class="mi">0</
-0001b2d0: 7370 616e 3e0a 0a20 2020 203c 7370 616e  span>..    <span
-0001b2e0: 2063 6c61 7373 3d22 6b22 3e69 663c 2f73   class="k">if</s
-0001b2f0: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
-0001b300: 3d22 6e22 3e76 6572 626f 7365 3c2f 7370  ="n">verbose</sp
-0001b310: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-0001b320: 7022 3e3a 3c2f 7370 616e 3e0a 2020 2020  p">:</span>.    
-0001b330: 2020 2020 3c73 7061 6e20 636c 6173 733d      <span class=
-0001b340: 226e 6222 3e70 7269 6e74 3c2f 7370 616e  "nb">print</span
-0001b350: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
-0001b360: 3e28 3c2f 7370 616e 3e3c 7370 616e 2063  >(</span><span c
-0001b370: 6c61 7373 3d22 7332 223e 2671 756f 743b  lass="s2">&quot;
-0001b380: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0001b390: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0001b3a0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0001b3b0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0001b3c0: 3d3d 2671 756f 743b 3c2f 7370 616e 3e3c  ==&quot;</span><
-0001b3d0: 7370 616e 2063 6c61 7373 3d22 7022 3e29  span class="p">)
-0001b3e0: 3c2f 7370 616e 3e0a 0a20 2020 2020 2020  </span>..       
-0001b3f0: 203c 7370 616e 2063 6c61 7373 3d22 6e62   <span class="nb
-0001b400: 223e 7072 696e 743c 2f73 7061 6e3e 3c73  ">print</span><s
-0001b410: 7061 6e20 636c 6173 733d 2270 223e 283c  pan class="p">(<
-0001b420: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
-0001b430: 733d 2273 3222 3e26 7175 6f74 3b20 2020  s="s2">&quot;   
-0001b440: 2020 2020 2020 2020 2020 2020 2052 554e               RUN
-0001b450: 4e49 4e47 2054 4845 204e 4557 544f 4e26  NING THE NEWTON&
-0001b460: 2333 393b 5320 4d45 5448 4f44 2020 2020  #39;S METHOD    
-0001b470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b480: 203c 2f73 7061 6e3e 3c73 7061 6e20 636c   </span><span cl
-0001b490: 6173 733d 2273 6522 3e5c 6e3c 2f73 7061  ass="se">\n</spa
-0001b4a0: 6e3e 3c73 7061 6e20 636c 6173 733d 2273  n><span class="s
-0001b4b0: 3222 3e26 7175 6f74 3b3c 2f73 7061 6e3e  2">&quot;</span>
-0001b4c0: 3c73 7061 6e20 636c 6173 733d 2270 223e  <span class="p">
-0001b4d0: 293c 2f73 7061 6e3e 0a20 2020 2020 2020  )</span>.       
-0001b4e0: 203c 7370 616e 2063 6c61 7373 3d22 6e62   <span class="nb
-0001b4f0: 223e 7072 696e 743c 2f73 7061 6e3e 3c73  ">print</span><s
-0001b500: 7061 6e20 636c 6173 733d 2270 223e 283c  pan class="p">(<
-0001b510: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
-0001b520: 733d 2273 3222 3e26 7175 6f74 3b20 2020  s="s2">&quot;   
-0001b530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b540: 2020 2020 2020 2020 2a20 2a20 2a20 2020          * * *   
-0001b550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b560: 2020 2020 2020 2020 2020 2020 203c 2f73               </s
-0001b570: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
-0001b580: 2273 6522 3e5c 6e3c 2f73 7061 6e3e 3c73  "se">\n</span><s
-0001b590: 7061 6e20 636c 6173 733d 2273 3222 3e26  pan class="s2">&
-0001b5a0: 7175 6f74 3b3c 2f73 7061 6e3e 3c73 7061  quot;</span><spa
-0001b5b0: 6e20 636c 6173 733d 2270 223e 293c 2f73  n class="p">)</s
-0001b5c0: 7061 6e3e 0a20 2020 2020 2020 203c 7370  pan>.        <sp
-0001b5d0: 616e 2063 6c61 7373 3d22 6e62 223e 7072  an class="nb">pr
-0001b5e0: 696e 743c 2f73 7061 6e3e 3c73 7061 6e20  int</span><span 
-0001b5f0: 636c 6173 733d 2270 223e 283c 2f73 7061  class="p">(</spa
-0001b600: 6e3e 3c73 7061 6e20 636c 6173 733d 2273  n><span class="s
-0001b610: 6122 3e66 3c2f 7370 616e 3e3c 7370 616e  a">f</span><span
-0001b620: 2063 6c61 7373 3d22 7332 223e 2671 756f   class="s2">&quo
-0001b630: 743b 2020 2020 2020 2020 2020 2020 2020  t;              
-0001b640: 2020 2020 2020 546f 6c65 7261 6e63 6520        Tolerance 
-0001b650: 4550 5320 3d20 3c2f 7370 616e 3e3c 7370  EPS = </span><sp
-0001b660: 616e 2063 6c61 7373 3d22 7369 223e 7b3c  an class="si">{<
-0001b670: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
-0001b680: 733d 226e 223e 6570 733c 2f73 7061 6e3e  s="n">eps</span>
-0001b690: 3c73 7061 6e20 636c 6173 733d 2273 6922  <span class="si"
-0001b6a0: 3e3a 3c2f 7370 616e 3e3c 7370 616e 2063  >:</span><span c
-0001b6b0: 6c61 7373 3d22 7332 223e 2e35 453c 2f73  lass="s2">.5E</s
-0001b6c0: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
-0001b6d0: 2273 6922 3e7d 3c2f 7370 616e 3e3c 7370  "si">}</span><sp
-0001b6e0: 616e 2063 6c61 7373 3d22 7332 223e 2020  an class="s2">  
-0001b6f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b700: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-0001b710: 7373 3d22 7365 223e 5c6e 3c2f 7370 616e  ss="se">\n</span
-0001b720: 3e3c 7370 616e 2063 6c61 7373 3d22 7332  ><span class="s2
-0001b730: 223e 2671 756f 743b 3c2f 7370 616e 3e3c  ">&quot;</span><
-0001b740: 7370 616e 2063 6c61 7373 3d22 7022 3e29  span class="p">)
-0001b750: 3c2f 7370 616e 3e0a 0a20 2020 203c 7370  </span>..    <sp
-0001b760: 616e 2063 6c61 7373 3d22 6331 223e 2323  an class="c1">##
-0001b770: 2063 6865 636b 2069 6620 785f 696e 6974   check if x_init
-0001b780: 2069 7320 6120 7079 746f 7263 6820 7465   is a pytorch te
-0001b790: 6e73 6f72 3c2f 7370 616e 3e0a 2020 2020  nsor</span>.    
-0001b7a0: 3c73 7061 6e20 636c 6173 733d 226b 223e  <span class="k">
-0001b7b0: 6966 3c2f 7370 616e 3e20 3c73 7061 6e20  if</span> <span 
-0001b7c0: 636c 6173 733d 226e 6222 3e69 7369 6e73  class="nb">isins
-0001b7d0: 7461 6e63 653c 2f73 7061 6e3e 3c73 7061  tance</span><spa
-0001b7e0: 6e20 636c 6173 733d 2270 223e 283c 2f73  n class="p">(</s
-0001b7f0: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
-0001b800: 226e 223e 785f 696e 6974 3c2f 7370 616e  "n">x_init</span
-0001b810: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
-0001b820: 3e2c 3c2f 7370 616e 3e20 3c73 7061 6e20  >,</span> <span 
-0001b830: 636c 6173 733d 226e 223e 746f 7263 683c  class="n">torch<
+0001b1c0: 6e20 636c 6173 733d 226e 223e 6265 7461  n class="n">beta
+0001b1d0: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
+0001b1e0: 6173 733d 226f 223e 3d3c 2f73 7061 6e3e  ass="o">=</span>
+0001b1f0: 203c 7370 616e 2063 6c61 7373 3d22 6d66   <span class="mf
+0001b200: 223e 302e 3031 3c2f 7370 616e 3e3c 7370  ">0.01</span><sp
+0001b210: 616e 2063 6c61 7373 3d22 7022 3e2c 3c2f  an class="p">,</
+0001b220: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
+0001b230: 733d 226d 6622 3e30 2e32 3c2f 7370 616e  s="mf">0.2</span
+0001b240: 3e0a 0a20 2020 203c 7370 616e 2063 6c61  >..    <span cla
+0001b250: 7373 3d22 6331 223e 2323 204e 6577 746f  ss="c1">## Newto
+0001b260: 6e26 2333 393b 7320 6d65 7468 6f64 2066  n&#39;s method f
+0001b270: 6f72 206d 696e 696d 697a 696e 6720 7468  or minimizing th
+0001b280: 6520 6675 6e63 7469 6f6e 3c2f 7370 616e  e function</span
+0001b290: 3e0a 2020 2020 3c73 7061 6e20 636c 6173  >.    <span clas
+0001b2a0: 733d 226e 223e 696e 6478 5f69 7465 723c  s="n">indx_iter<
+0001b2b0: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
+0001b2c0: 7373 3d22 6f22 3e3d 3c2f 7370 616e 3e20  ss="o">=</span> 
+0001b2d0: 3c73 7061 6e20 636c 6173 733d 226d 6922  <span class="mi"
+0001b2e0: 3e30 3c2f 7370 616e 3e0a 0a20 2020 203c  >0</span>..    <
+0001b2f0: 7370 616e 2063 6c61 7373 3d22 6e22 3e4e  span class="n">N
+0001b300: 5f66 756e 633c 2f73 7061 6e3e 203c 7370  _func</span> <sp
+0001b310: 616e 2063 6c61 7373 3d22 6f22 3e3d 3c2f  an class="o">=</
+0001b320: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
+0001b330: 733d 226d 6922 3e30 3c2f 7370 616e 3e0a  s="mi">0</span>.
+0001b340: 0a20 2020 203c 7370 616e 2063 6c61 7373  .    <span class
+0001b350: 3d22 6b22 3e69 663c 2f73 7061 6e3e 203c  ="k">if</span> <
+0001b360: 7370 616e 2063 6c61 7373 3d22 6e22 3e76  span class="n">v
+0001b370: 6572 626f 7365 3c2f 7370 616e 3e3c 7370  erbose</span><sp
+0001b380: 616e 2063 6c61 7373 3d22 7022 3e3a 3c2f  an class="p">:</
+0001b390: 7370 616e 3e0a 2020 2020 2020 2020 3c73  span>.        <s
+0001b3a0: 7061 6e20 636c 6173 733d 226e 6222 3e70  pan class="nb">p
+0001b3b0: 7269 6e74 3c2f 7370 616e 3e3c 7370 616e  rint</span><span
+0001b3c0: 2063 6c61 7373 3d22 7022 3e28 3c2f 7370   class="p">(</sp
+0001b3d0: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+0001b3e0: 7332 223e 2671 756f 743b 3d3d 3d3d 3d3d  s2">&quot;======
+0001b3f0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0001b400: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0001b410: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0001b420: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 2671 756f  ============&quo
+0001b430: 743b 3c2f 7370 616e 3e3c 7370 616e 2063  t;</span><span c
+0001b440: 6c61 7373 3d22 7022 3e29 3c2f 7370 616e  lass="p">)</span
+0001b450: 3e0a 0a20 2020 2020 2020 203c 7370 616e  >..        <span
+0001b460: 2063 6c61 7373 3d22 6e62 223e 7072 696e   class="nb">prin
+0001b470: 743c 2f73 7061 6e3e 3c73 7061 6e20 636c  t</span><span cl
+0001b480: 6173 733d 2270 223e 283c 2f73 7061 6e3e  ass="p">(</span>
+0001b490: 3c73 7061 6e20 636c 6173 733d 2273 3222  <span class="s2"
+0001b4a0: 3e26 7175 6f74 3b20 2020 2020 2020 2020  >&quot;         
+0001b4b0: 2020 2020 2020 2052 554e 4e49 4e47 2054         RUNNING T
+0001b4c0: 4845 204e 4557 544f 4e26 2333 393b 5320  HE NEWTON&#39;S 
+0001b4d0: 4d45 5448 4f44 2020 2020 2020 2020 2020  METHOD          
+0001b4e0: 2020 2020 2020 2020 2020 203c 2f73 7061             </spa
+0001b4f0: 6e3e 3c73 7061 6e20 636c 6173 733d 2273  n><span class="s
+0001b500: 6522 3e5c 6e3c 2f73 7061 6e3e 3c73 7061  e">\n</span><spa
+0001b510: 6e20 636c 6173 733d 2273 3222 3e26 7175  n class="s2">&qu
+0001b520: 6f74 3b3c 2f73 7061 6e3e 3c73 7061 6e20  ot;</span><span 
+0001b530: 636c 6173 733d 2270 223e 293c 2f73 7061  class="p">)</spa
+0001b540: 6e3e 0a20 2020 2020 2020 203c 7370 616e  n>.        <span
+0001b550: 2063 6c61 7373 3d22 6e62 223e 7072 696e   class="nb">prin
+0001b560: 743c 2f73 7061 6e3e 3c73 7061 6e20 636c  t</span><span cl
+0001b570: 6173 733d 2270 223e 283c 2f73 7061 6e3e  ass="p">(</span>
+0001b580: 3c73 7061 6e20 636c 6173 733d 2273 3222  <span class="s2"
+0001b590: 3e26 7175 6f74 3b20 2020 2020 2020 2020  >&quot;         
+0001b5a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b5b0: 2020 2a20 2a20 2a20 2020 2020 2020 2020    * * *         
+0001b5c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b5d0: 2020 2020 2020 203c 2f73 7061 6e3e 3c73         </span><s
+0001b5e0: 7061 6e20 636c 6173 733d 2273 6522 3e5c  pan class="se">\
+0001b5f0: 6e3c 2f73 7061 6e3e 3c73 7061 6e20 636c  n</span><span cl
+0001b600: 6173 733d 2273 3222 3e26 7175 6f74 3b3c  ass="s2">&quot;<
+0001b610: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
+0001b620: 733d 2270 223e 293c 2f73 7061 6e3e 0a20  s="p">)</span>. 
+0001b630: 2020 2020 2020 203c 7370 616e 2063 6c61         <span cla
+0001b640: 7373 3d22 6e62 223e 7072 696e 743c 2f73  ss="nb">print</s
+0001b650: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
+0001b660: 2270 223e 283c 2f73 7061 6e3e 3c73 7061  "p">(</span><spa
+0001b670: 6e20 636c 6173 733d 2273 6122 3e66 3c2f  n class="sa">f</
+0001b680: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+0001b690: 3d22 7332 223e 2671 756f 743b 2020 2020  ="s2">&quot;    
+0001b6a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b6b0: 546f 6c65 7261 6e63 6520 4550 5320 3d20  Tolerance EPS = 
+0001b6c0: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
+0001b6d0: 7373 3d22 7369 223e 7b3c 2f73 7061 6e3e  ss="si">{</span>
+0001b6e0: 3c73 7061 6e20 636c 6173 733d 226e 223e  <span class="n">
+0001b6f0: 6570 733c 2f73 7061 6e3e 3c73 7061 6e20  eps</span><span 
+0001b700: 636c 6173 733d 2273 6922 3e3a 3c2f 7370  class="si">:</sp
+0001b710: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+0001b720: 7332 223e 2e35 453c 2f73 7061 6e3e 3c73  s2">.5E</span><s
+0001b730: 7061 6e20 636c 6173 733d 2273 6922 3e7d  pan class="si">}
+0001b740: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
+0001b750: 7373 3d22 7332 223e 2020 2020 2020 2020  ss="s2">        
+0001b760: 2020 2020 2020 2020 2020 3c2f 7370 616e            </span
+0001b770: 3e3c 7370 616e 2063 6c61 7373 3d22 7365  ><span class="se
+0001b780: 223e 5c6e 3c2f 7370 616e 3e3c 7370 616e  ">\n</span><span
+0001b790: 2063 6c61 7373 3d22 7332 223e 2671 756f   class="s2">&quo
+0001b7a0: 743b 3c2f 7370 616e 3e3c 7370 616e 2063  t;</span><span c
+0001b7b0: 6c61 7373 3d22 7022 3e29 3c2f 7370 616e  lass="p">)</span
+0001b7c0: 3e0a 0a20 2020 203c 7370 616e 2063 6c61  >..    <span cla
+0001b7d0: 7373 3d22 6331 223e 2323 2063 6865 636b  ss="c1">## check
+0001b7e0: 2069 6620 785f 696e 6974 2069 7320 6120   if x_init is a 
+0001b7f0: 7079 746f 7263 6820 7465 6e73 6f72 3c2f  pytorch tensor</
+0001b800: 7370 616e 3e0a 2020 2020 3c73 7061 6e20  span>.    <span 
+0001b810: 636c 6173 733d 226b 223e 6966 3c2f 7370  class="k">if</sp
+0001b820: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
+0001b830: 226e 6222 3e69 7369 6e73 7461 6e63 653c  "nb">isinstance<
 0001b840: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
-0001b850: 733d 226f 223e 2e3c 2f73 7061 6e3e 3c73  s="o">.</span><s
-0001b860: 7061 6e20 636c 6173 733d 226e 223e 5465  pan class="n">Te
-0001b870: 6e73 6f72 3c2f 7370 616e 3e3c 7370 616e  nsor</span><span
-0001b880: 2063 6c61 7373 3d22 7022 3e29 3a3c 2f73   class="p">):</s
-0001b890: 7061 6e3e 0a20 2020 2020 2020 203c 7370  pan>.        <sp
-0001b8a0: 616e 2063 6c61 7373 3d22 6e22 3e78 3c2f  an class="n">x</
-0001b8b0: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
-0001b8c0: 733d 226f 223e 3d3c 2f73 7061 6e3e 203c  s="o">=</span> <
-0001b8d0: 7370 616e 2063 6c61 7373 3d22 6e22 3e78  span class="n">x
-0001b8e0: 5f69 6e69 743c 2f73 7061 6e3e 3c73 7061  _init</span><spa
-0001b8f0: 6e20 636c 6173 733d 226f 223e 2e3c 2f73  n class="o">.</s
-0001b900: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
-0001b910: 226e 223e 636c 6f6e 653c 2f73 7061 6e3e  "n">clone</span>
-0001b920: 3c73 7061 6e20 636c 6173 733d 2270 223e  <span class="p">
-0001b930: 2829 3c2f 7370 616e 3e3c 7370 616e 2063  ()</span><span c
-0001b940: 6c61 7373 3d22 6f22 3e2e 3c2f 7370 616e  lass="o">.</span
-0001b950: 3e3c 7370 616e 2063 6c61 7373 3d22 6e22  ><span class="n"
-0001b960: 3e64 6574 6163 683c 2f73 7061 6e3e 3c73  >detach</span><s
-0001b970: 7061 6e20 636c 6173 733d 2270 223e 2829  pan class="p">()
-0001b980: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-0001b990: 7373 3d22 6f22 3e2e 3c2f 7370 616e 3e3c  ss="o">.</span><
-0001b9a0: 7370 616e 2063 6c61 7373 3d22 6e22 3e72  span class="n">r
-0001b9b0: 6571 7569 7265 735f 6772 6164 5f3c 2f73  equires_grad_</s
-0001b9c0: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
-0001b9d0: 2270 223e 283c 2f73 7061 6e3e 3c73 7061  "p">(</span><spa
-0001b9e0: 6e20 636c 6173 733d 226b 6322 3e46 616c  n class="kc">Fal
-0001b9f0: 7365 3c2f 7370 616e 3e3c 7370 616e 2063  se</span><span c
-0001ba00: 6c61 7373 3d22 7022 3e29 3c2f 7370 616e  lass="p">)</span
-0001ba10: 3e0a 2020 2020 3c73 7061 6e20 636c 6173  >.    <span clas
-0001ba20: 733d 226b 223e 656c 7365 3c2f 7370 616e  s="k">else</span
-0001ba30: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
-0001ba40: 3e3a 3c2f 7370 616e 3e0a 2020 2020 2020  >:</span>.      
-0001ba50: 2020 3c73 7061 6e20 636c 6173 733d 226e    <span class="n
-0001ba60: 223e 783c 2f73 7061 6e3e 203c 7370 616e  ">x</span> <span
-0001ba70: 2063 6c61 7373 3d22 6f22 3e3d 3c2f 7370   class="o">=</sp
-0001ba80: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
-0001ba90: 226e 223e 785f 696e 6974 3c2f 7370 616e  "n">x_init</span
-0001baa0: 3e0a 0a20 2020 203c 7370 616e 2063 6c61  >..    <span cla
-0001bab0: 7373 3d22 6b22 3e77 6869 6c65 3c2f 7370  ss="k">while</sp
-0001bac0: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
-0001bad0: 226e 223e 696e 6478 5f69 7465 723c 2f73  "n">indx_iter</s
-0001bae0: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
-0001baf0: 3d22 6f22 3e26 6c74 3b3c 2f73 7061 6e3e  ="o">&lt;</span>
-0001bb00: 203c 7370 616e 2063 6c61 7373 3d22 6e22   <span class="n"
-0001bb10: 3e6d 6178 5f69 7465 723c 2f73 7061 6e3e  >max_iter</span>
-0001bb20: 3c73 7061 6e20 636c 6173 733d 2270 223e  <span class="p">
-0001bb30: 3a3c 2f73 7061 6e3e 0a20 2020 2020 2020  :</span>.       
-0001bb40: 203c 7370 616e 2063 6c61 7373 3d22 6e22   <span class="n"
-0001bb50: 3e6c 6f73 733c 2f73 7061 6e3e 3c73 7061  >loss</span><spa
-0001bb60: 6e20 636c 6173 733d 2270 223e 2c3c 2f73  n class="p">,</s
-0001bb70: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
-0001bb80: 3d22 6e22 3e67 7261 643c 2f73 7061 6e3e  ="n">grad</span>
-0001bb90: 203c 7370 616e 2063 6c61 7373 3d22 6f22   <span class="o"
-0001bba0: 3e3d 3c2f 7370 616e 3e20 3c73 7061 6e20  >=</span> <span 
-0001bbb0: 636c 6173 733d 226e 223e 663c 2f73 7061  class="n">f</spa
-0001bbc0: 6e3e 3c73 7061 6e20 636c 6173 733d 2270  n><span class="p
-0001bbd0: 223e 283c 2f73 7061 6e3e 3c73 7061 6e20  ">(</span><span 
-0001bbe0: 636c 6173 733d 226e 223e 783c 2f73 7061  class="n">x</spa
-0001bbf0: 6e3e 3c73 7061 6e20 636c 6173 733d 2270  n><span class="p
-0001bc00: 223e 2c3c 2f73 7061 6e3e 203c 7370 616e  ">,</span> <span
-0001bc10: 2063 6c61 7373 3d22 6f22 3e2a 3c2f 7370   class="o">*</sp
-0001bc20: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-0001bc30: 6e22 3e61 7267 733c 2f73 7061 6e3e 3c73  n">args</span><s
-0001bc40: 7061 6e20 636c 6173 733d 2270 223e 293c  pan class="p">)<
-0001bc50: 2f73 7061 6e3e 0a20 2020 2020 2020 203c  /span>.        <
-0001bc60: 7370 616e 2063 6c61 7373 3d22 6e22 3e4e  span class="n">N
-0001bc70: 5f66 756e 633c 2f73 7061 6e3e 203c 7370  _func</span> <sp
-0001bc80: 616e 2063 6c61 7373 3d22 6f22 3e2b 3d3c  an class="o">+=<
-0001bc90: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
-0001bca0: 7373 3d22 6d69 223e 313c 2f73 7061 6e3e  ss="mi">1</span>
-0001bcb0: 0a0a 2020 2020 2020 2020 3c73 7061 6e20  ..        <span 
-0001bcc0: 636c 6173 733d 226b 223e 6966 3c2f 7370  class="k">if</sp
-0001bcd0: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
-0001bce0: 226e 6222 3e69 7369 6e73 7461 6e63 653c  "nb">isinstance<
-0001bcf0: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
-0001bd00: 733d 2270 223e 283c 2f73 7061 6e3e 3c73  s="p">(</span><s
-0001bd10: 7061 6e20 636c 6173 733d 226e 223e 785f  pan class="n">x_
-0001bd20: 696e 6974 3c2f 7370 616e 3e3c 7370 616e  init</span><span
-0001bd30: 2063 6c61 7373 3d22 7022 3e2c 3c2f 7370   class="p">,</sp
-0001bd40: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
-0001bd50: 226e 223e 746f 7263 683c 2f73 7061 6e3e  "n">torch</span>
-0001bd60: 3c73 7061 6e20 636c 6173 733d 226f 223e  <span class="o">
-0001bd70: 2e3c 2f73 7061 6e3e 3c73 7061 6e20 636c  .</span><span cl
-0001bd80: 6173 733d 226e 223e 5465 6e73 6f72 3c2f  ass="n">Tensor</
+0001b850: 733d 2270 223e 283c 2f73 7061 6e3e 3c73  s="p">(</span><s
+0001b860: 7061 6e20 636c 6173 733d 226e 223e 785f  pan class="n">x_
+0001b870: 696e 6974 3c2f 7370 616e 3e3c 7370 616e  init</span><span
+0001b880: 2063 6c61 7373 3d22 7022 3e2c 3c2f 7370   class="p">,</sp
+0001b890: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
+0001b8a0: 226e 223e 746f 7263 683c 2f73 7061 6e3e  "n">torch</span>
+0001b8b0: 3c73 7061 6e20 636c 6173 733d 226f 223e  <span class="o">
+0001b8c0: 2e3c 2f73 7061 6e3e 3c73 7061 6e20 636c  .</span><span cl
+0001b8d0: 6173 733d 226e 223e 5465 6e73 6f72 3c2f  ass="n">Tensor</
+0001b8e0: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+0001b8f0: 3d22 7022 3e29 3a3c 2f73 7061 6e3e 0a20  ="p">):</span>. 
+0001b900: 2020 2020 2020 203c 7370 616e 2063 6c61         <span cla
+0001b910: 7373 3d22 6e22 3e78 3c2f 7370 616e 3e20  ss="n">x</span> 
+0001b920: 3c73 7061 6e20 636c 6173 733d 226f 223e  <span class="o">
+0001b930: 3d3c 2f73 7061 6e3e 203c 7370 616e 2063  =</span> <span c
+0001b940: 6c61 7373 3d22 6e22 3e78 5f69 6e69 743c  lass="n">x_init<
+0001b950: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
+0001b960: 733d 226f 223e 2e3c 2f73 7061 6e3e 3c73  s="o">.</span><s
+0001b970: 7061 6e20 636c 6173 733d 226e 223e 636c  pan class="n">cl
+0001b980: 6f6e 653c 2f73 7061 6e3e 3c73 7061 6e20  one</span><span 
+0001b990: 636c 6173 733d 2270 223e 2829 3c2f 7370  class="p">()</sp
+0001b9a0: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+0001b9b0: 6f22 3e2e 3c2f 7370 616e 3e3c 7370 616e  o">.</span><span
+0001b9c0: 2063 6c61 7373 3d22 6e22 3e64 6574 6163   class="n">detac
+0001b9d0: 683c 2f73 7061 6e3e 3c73 7061 6e20 636c  h</span><span cl
+0001b9e0: 6173 733d 2270 223e 2829 3c2f 7370 616e  ass="p">()</span
+0001b9f0: 3e3c 7370 616e 2063 6c61 7373 3d22 6f22  ><span class="o"
+0001ba00: 3e2e 3c2f 7370 616e 3e3c 7370 616e 2063  >.</span><span c
+0001ba10: 6c61 7373 3d22 6e22 3e72 6571 7569 7265  lass="n">require
+0001ba20: 735f 6772 6164 5f3c 2f73 7061 6e3e 3c73  s_grad_</span><s
+0001ba30: 7061 6e20 636c 6173 733d 2270 223e 283c  pan class="p">(<
+0001ba40: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
+0001ba50: 733d 226b 6322 3e46 616c 7365 3c2f 7370  s="kc">False</sp
+0001ba60: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+0001ba70: 7022 3e29 3c2f 7370 616e 3e0a 2020 2020  p">)</span>.    
+0001ba80: 3c73 7061 6e20 636c 6173 733d 226b 223e  <span class="k">
+0001ba90: 656c 7365 3c2f 7370 616e 3e3c 7370 616e  else</span><span
+0001baa0: 2063 6c61 7373 3d22 7022 3e3a 3c2f 7370   class="p">:</sp
+0001bab0: 616e 3e0a 2020 2020 2020 2020 3c73 7061  an>.        <spa
+0001bac0: 6e20 636c 6173 733d 226e 223e 783c 2f73  n class="n">x</s
+0001bad0: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
+0001bae0: 3d22 6f22 3e3d 3c2f 7370 616e 3e20 3c73  ="o">=</span> <s
+0001baf0: 7061 6e20 636c 6173 733d 226e 223e 785f  pan class="n">x_
+0001bb00: 696e 6974 3c2f 7370 616e 3e0a 0a20 2020  init</span>..   
+0001bb10: 203c 7370 616e 2063 6c61 7373 3d22 6b22   <span class="k"
+0001bb20: 3e77 6869 6c65 3c2f 7370 616e 3e20 3c73  >while</span> <s
+0001bb30: 7061 6e20 636c 6173 733d 226e 223e 696e  pan class="n">in
+0001bb40: 6478 5f69 7465 723c 2f73 7061 6e3e 203c  dx_iter</span> <
+0001bb50: 7370 616e 2063 6c61 7373 3d22 6f22 3e26  span class="o">&
+0001bb60: 6c74 3b3c 2f73 7061 6e3e 203c 7370 616e  lt;</span> <span
+0001bb70: 2063 6c61 7373 3d22 6e22 3e6d 6178 5f69   class="n">max_i
+0001bb80: 7465 723c 2f73 7061 6e3e 3c73 7061 6e20  ter</span><span 
+0001bb90: 636c 6173 733d 2270 223e 3a3c 2f73 7061  class="p">:</spa
+0001bba0: 6e3e 0a20 2020 2020 2020 203c 7370 616e  n>.        <span
+0001bbb0: 2063 6c61 7373 3d22 6e22 3e6c 6f73 733c   class="n">loss<
+0001bbc0: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
+0001bbd0: 733d 2270 223e 2c3c 2f73 7061 6e3e 203c  s="p">,</span> <
+0001bbe0: 7370 616e 2063 6c61 7373 3d22 6e22 3e67  span class="n">g
+0001bbf0: 7261 643c 2f73 7061 6e3e 203c 7370 616e  rad</span> <span
+0001bc00: 2063 6c61 7373 3d22 6f22 3e3d 3c2f 7370   class="o">=</sp
+0001bc10: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
+0001bc20: 226e 223e 663c 2f73 7061 6e3e 3c73 7061  "n">f</span><spa
+0001bc30: 6e20 636c 6173 733d 2270 223e 283c 2f73  n class="p">(</s
+0001bc40: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
+0001bc50: 226e 223e 783c 2f73 7061 6e3e 3c73 7061  "n">x</span><spa
+0001bc60: 6e20 636c 6173 733d 2270 223e 2c3c 2f73  n class="p">,</s
+0001bc70: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
+0001bc80: 3d22 6f22 3e2a 3c2f 7370 616e 3e3c 7370  ="o">*</span><sp
+0001bc90: 616e 2063 6c61 7373 3d22 6e22 3e61 7267  an class="n">arg
+0001bca0: 733c 2f73 7061 6e3e 3c73 7061 6e20 636c  s</span><span cl
+0001bcb0: 6173 733d 2270 223e 293c 2f73 7061 6e3e  ass="p">)</span>
+0001bcc0: 0a20 2020 2020 2020 203c 7370 616e 2063  .        <span c
+0001bcd0: 6c61 7373 3d22 6e22 3e4e 5f66 756e 633c  lass="n">N_func<
+0001bce0: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
+0001bcf0: 7373 3d22 6f22 3e2b 3d3c 2f73 7061 6e3e  ss="o">+=</span>
+0001bd00: 203c 7370 616e 2063 6c61 7373 3d22 6d69   <span class="mi
+0001bd10: 223e 313c 2f73 7061 6e3e 0a0a 2020 2020  ">1</span>..    
+0001bd20: 2020 2020 3c73 7061 6e20 636c 6173 733d      <span class=
+0001bd30: 226b 223e 6966 3c2f 7370 616e 3e20 3c73  "k">if</span> <s
+0001bd40: 7061 6e20 636c 6173 733d 226e 6222 3e69  pan class="nb">i
+0001bd50: 7369 6e73 7461 6e63 653c 2f73 7061 6e3e  sinstance</span>
+0001bd60: 3c73 7061 6e20 636c 6173 733d 2270 223e  <span class="p">
+0001bd70: 283c 2f73 7061 6e3e 3c73 7061 6e20 636c  (</span><span cl
+0001bd80: 6173 733d 226e 223e 785f 696e 6974 3c2f  ass="n">x_init</
 0001bd90: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
-0001bda0: 3d22 7022 3e29 3a3c 2f73 7061 6e3e 0a20  ="p">):</span>. 
-0001bdb0: 2020 2020 2020 2020 2020 203c 7370 616e             <span
-0001bdc0: 2063 6c61 7373 3d22 6b22 3e77 6974 683c   class="k">with<
-0001bdd0: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
-0001bde0: 7373 3d22 6e22 3e74 6f72 6368 3c2f 7370  ss="n">torch</sp
-0001bdf0: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-0001be00: 6f22 3e2e 3c2f 7370 616e 3e3c 7370 616e  o">.</span><span
-0001be10: 2063 6c61 7373 3d22 6e22 3e6e 6f5f 6772   class="n">no_gr
-0001be20: 6164 3c2f 7370 616e 3e3c 7370 616e 2063  ad</span><span c
-0001be30: 6c61 7373 3d22 7022 3e28 293a 3c2f 7370  lass="p">():</sp
-0001be40: 616e 3e0a 2020 2020 2020 2020 2020 2020  an>.            
-0001be50: 2020 2020 3c73 7061 6e20 636c 6173 733d      <span class=
-0001be60: 226e 223e 483c 2f73 7061 6e3e 203c 7370  "n">H</span> <sp
-0001be70: 616e 2063 6c61 7373 3d22 6f22 3e3d 3c2f  an class="o">=</
-0001be80: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
-0001be90: 733d 226e 223e 6865 7373 3c2f 7370 616e  s="n">hess</span
-0001bea0: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
-0001beb0: 3e28 3c2f 7370 616e 3e3c 7370 616e 2063  >(</span><span c
-0001bec0: 6c61 7373 3d22 6e22 3e78 3c2f 7370 616e  lass="n">x</span
-0001bed0: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
-0001bee0: 3e2c 3c2f 7370 616e 3e20 3c73 7061 6e20  >,</span> <span 
-0001bef0: 636c 6173 733d 226f 223e 2a3c 2f73 7061  class="o">*</spa
-0001bf00: 6e3e 3c73 7061 6e20 636c 6173 733d 226e  n><span class="n
-0001bf10: 223e 6172 6773 3c2f 7370 616e 3e3c 7370  ">args</span><sp
-0001bf20: 616e 2063 6c61 7373 3d22 7022 3e29 3c2f  an class="p">)</
-0001bf30: 7370 616e 3e0a 2020 2020 2020 2020 3c73  span>.        <s
-0001bf40: 7061 6e20 636c 6173 733d 226b 223e 656c  pan class="k">el
-0001bf50: 7365 3c2f 7370 616e 3e3c 7370 616e 2063  se</span><span c
-0001bf60: 6c61 7373 3d22 7022 3e3a 3c2f 7370 616e  lass="p">:</span
-0001bf70: 3e0a 2020 2020 2020 2020 2020 2020 3c73  >.            <s
-0001bf80: 7061 6e20 636c 6173 733d 226e 223e 483c  pan class="n">H<
-0001bf90: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
-0001bfa0: 7373 3d22 6f22 3e3d 3c2f 7370 616e 3e20  ss="o">=</span> 
-0001bfb0: 3c73 7061 6e20 636c 6173 733d 226e 223e  <span class="n">
-0001bfc0: 6865 7373 3c2f 7370 616e 3e3c 7370 616e  hess</span><span
-0001bfd0: 2063 6c61 7373 3d22 7022 3e28 3c2f 7370   class="p">(</sp
-0001bfe0: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-0001bff0: 6e22 3e78 3c2f 7370 616e 3e3c 7370 616e  n">x</span><span
-0001c000: 2063 6c61 7373 3d22 7022 3e2c 3c2f 7370   class="p">,</sp
-0001c010: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
-0001c020: 226f 223e 2a3c 2f73 7061 6e3e 3c73 7061  "o">*</span><spa
-0001c030: 6e20 636c 6173 733d 226e 223e 6172 6773  n class="n">args
-0001c040: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-0001c050: 7373 3d22 7022 3e29 3c2f 7370 616e 3e0a  ss="p">)</span>.
-0001c060: 0a20 2020 2020 2020 203c 7370 616e 2063  .        <span c
-0001c070: 6c61 7373 3d22 6b22 3e69 663c 2f73 7061  lass="k">if</spa
-0001c080: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
-0001c090: 6e62 223e 6973 696e 7374 616e 6365 3c2f  nb">isinstance</
-0001c0a0: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
-0001c0b0: 3d22 7022 3e28 3c2f 7370 616e 3e3c 7370  ="p">(</span><sp
-0001c0c0: 616e 2063 6c61 7373 3d22 6e22 3e67 7261  an class="n">gra
-0001c0d0: 643c 2f73 7061 6e3e 3c73 7061 6e20 636c  d</span><span cl
-0001c0e0: 6173 733d 2270 223e 2c3c 2f73 7061 6e3e  ass="p">,</span>
-0001c0f0: 203c 7370 616e 2063 6c61 7373 3d22 6e22   <span class="n"
-0001c100: 3e74 6f72 6368 3c2f 7370 616e 3e3c 7370  >torch</span><sp
-0001c110: 616e 2063 6c61 7373 3d22 6f22 3e2e 3c2f  an class="o">.</
-0001c120: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
-0001c130: 3d22 6e22 3e54 656e 736f 723c 2f73 7061  ="n">Tensor</spa
+0001bda0: 3d22 7022 3e2c 3c2f 7370 616e 3e20 3c73  ="p">,</span> <s
+0001bdb0: 7061 6e20 636c 6173 733d 226e 223e 746f  pan class="n">to
+0001bdc0: 7263 683c 2f73 7061 6e3e 3c73 7061 6e20  rch</span><span 
+0001bdd0: 636c 6173 733d 226f 223e 2e3c 2f73 7061  class="o">.</spa
+0001bde0: 6e3e 3c73 7061 6e20 636c 6173 733d 226e  n><span class="n
+0001bdf0: 223e 5465 6e73 6f72 3c2f 7370 616e 3e3c  ">Tensor</span><
+0001be00: 7370 616e 2063 6c61 7373 3d22 7022 3e29  span class="p">)
+0001be10: 3a3c 2f73 7061 6e3e 0a20 2020 2020 2020  :</span>.       
+0001be20: 2020 2020 203c 7370 616e 2063 6c61 7373       <span class
+0001be30: 3d22 6b22 3e77 6974 683c 2f73 7061 6e3e  ="k">with</span>
+0001be40: 203c 7370 616e 2063 6c61 7373 3d22 6e22   <span class="n"
+0001be50: 3e74 6f72 6368 3c2f 7370 616e 3e3c 7370  >torch</span><sp
+0001be60: 616e 2063 6c61 7373 3d22 6f22 3e2e 3c2f  an class="o">.</
+0001be70: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+0001be80: 3d22 6e22 3e6e 6f5f 6772 6164 3c2f 7370  ="n">no_grad</sp
+0001be90: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+0001bea0: 7022 3e28 293a 3c2f 7370 616e 3e0a 2020  p">():</span>.  
+0001beb0: 2020 2020 2020 2020 2020 2020 2020 3c73                <s
+0001bec0: 7061 6e20 636c 6173 733d 226e 223e 483c  pan class="n">H<
+0001bed0: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
+0001bee0: 7373 3d22 6f22 3e3d 3c2f 7370 616e 3e20  ss="o">=</span> 
+0001bef0: 3c73 7061 6e20 636c 6173 733d 226e 223e  <span class="n">
+0001bf00: 6865 7373 3c2f 7370 616e 3e3c 7370 616e  hess</span><span
+0001bf10: 2063 6c61 7373 3d22 7022 3e28 3c2f 7370   class="p">(</sp
+0001bf20: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+0001bf30: 6e22 3e78 3c2f 7370 616e 3e3c 7370 616e  n">x</span><span
+0001bf40: 2063 6c61 7373 3d22 7022 3e2c 3c2f 7370   class="p">,</sp
+0001bf50: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
+0001bf60: 226f 223e 2a3c 2f73 7061 6e3e 3c73 7061  "o">*</span><spa
+0001bf70: 6e20 636c 6173 733d 226e 223e 6172 6773  n class="n">args
+0001bf80: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
+0001bf90: 7373 3d22 7022 3e29 3c2f 7370 616e 3e0a  ss="p">)</span>.
+0001bfa0: 2020 2020 2020 2020 3c73 7061 6e20 636c          <span cl
+0001bfb0: 6173 733d 226b 223e 656c 7365 3c2f 7370  ass="k">else</sp
+0001bfc0: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+0001bfd0: 7022 3e3a 3c2f 7370 616e 3e0a 2020 2020  p">:</span>.    
+0001bfe0: 2020 2020 2020 2020 3c73 7061 6e20 636c          <span cl
+0001bff0: 6173 733d 226e 223e 483c 2f73 7061 6e3e  ass="n">H</span>
+0001c000: 203c 7370 616e 2063 6c61 7373 3d22 6f22   <span class="o"
+0001c010: 3e3d 3c2f 7370 616e 3e20 3c73 7061 6e20  >=</span> <span 
+0001c020: 636c 6173 733d 226e 223e 6865 7373 3c2f  class="n">hess</
+0001c030: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+0001c040: 3d22 7022 3e28 3c2f 7370 616e 3e3c 7370  ="p">(</span><sp
+0001c050: 616e 2063 6c61 7373 3d22 6e22 3e78 3c2f  an class="n">x</
+0001c060: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+0001c070: 3d22 7022 3e2c 3c2f 7370 616e 3e20 3c73  ="p">,</span> <s
+0001c080: 7061 6e20 636c 6173 733d 226f 223e 2a3c  pan class="o">*<
+0001c090: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
+0001c0a0: 733d 226e 223e 6172 6773 3c2f 7370 616e  s="n">args</span
+0001c0b0: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
+0001c0c0: 3e29 3c2f 7370 616e 3e0a 0a20 2020 2020  >)</span>..     
+0001c0d0: 2020 203c 7370 616e 2063 6c61 7373 3d22     <span class="
+0001c0e0: 6b22 3e69 663c 2f73 7061 6e3e 203c 7370  k">if</span> <sp
+0001c0f0: 616e 2063 6c61 7373 3d22 6e62 223e 6973  an class="nb">is
+0001c100: 696e 7374 616e 6365 3c2f 7370 616e 3e3c  instance</span><
+0001c110: 7370 616e 2063 6c61 7373 3d22 7022 3e28  span class="p">(
+0001c120: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
+0001c130: 7373 3d22 6e22 3e67 7261 643c 2f73 7061  ss="n">grad</spa
 0001c140: 6e3e 3c73 7061 6e20 636c 6173 733d 2270  n><span class="p
-0001c150: 223e 293a 3c2f 7370 616e 3e0a 2020 2020  ">):</span>.    
-0001c160: 2020 2020 2020 2020 3c73 7061 6e20 636c          <span cl
-0001c170: 6173 733d 226e 223e 6e65 7774 6f6e 5f64  ass="n">newton_d
-0001c180: 6972 6563 7469 6f6e 3c2f 7370 616e 3e20  irection</span> 
-0001c190: 3c73 7061 6e20 636c 6173 733d 226f 223e  <span class="o">
-0001c1a0: 3d3c 2f73 7061 6e3e 203c 7370 616e 2063  =</span> <span c
-0001c1b0: 6c61 7373 3d22 6e22 3e74 6f72 6368 3c2f  lass="n">torch</
-0001c1c0: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
-0001c1d0: 3d22 6f22 3e2e 3c2f 7370 616e 3e3c 7370  ="o">.</span><sp
-0001c1e0: 616e 2063 6c61 7373 3d22 6e22 3e6c 696e  an class="n">lin
-0001c1f0: 616c 673c 2f73 7061 6e3e 3c73 7061 6e20  alg</span><span 
-0001c200: 636c 6173 733d 226f 223e 2e3c 2f73 7061  class="o">.</spa
-0001c210: 6e3e 3c73 7061 6e20 636c 6173 733d 226e  n><span class="n
-0001c220: 223e 736f 6c76 653c 2f73 7061 6e3e 3c73  ">solve</span><s
-0001c230: 7061 6e20 636c 6173 733d 2270 223e 283c  pan class="p">(<
-0001c240: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
-0001c250: 733d 226e 223e 483c 2f73 7061 6e3e 3c73  s="n">H</span><s
-0001c260: 7061 6e20 636c 6173 733d 2270 223e 2c3c  pan class="p">,<
-0001c270: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
-0001c280: 7373 3d22 6f22 3e2d 3c2f 7370 616e 3e3c  ss="o">-</span><
-0001c290: 7370 616e 2063 6c61 7373 3d22 6e22 3e67  span class="n">g
-0001c2a0: 7261 643c 2f73 7061 6e3e 3c73 7061 6e20  rad</span><span 
-0001c2b0: 636c 6173 733d 2270 223e 293c 2f73 7061  class="p">)</spa
-0001c2c0: 6e3e 0a20 2020 2020 2020 2020 2020 203c  n>.            <
-0001c2d0: 7370 616e 2063 6c61 7373 3d22 6e22 3e6e  span class="n">n
-0001c2e0: 6577 746f 6e5f 6465 6372 656d 656e 745f  ewton_decrement_
-0001c2f0: 7371 7561 7265 3c2f 7370 616e 3e20 3c73  square</span> <s
-0001c300: 7061 6e20 636c 6173 733d 226f 223e 3d3c  pan class="o">=<
-0001c310: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
-0001c320: 7373 3d22 6e22 3e74 6f72 6368 3c2f 7370  ss="n">torch</sp
-0001c330: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-0001c340: 6f22 3e2e 3c2f 7370 616e 3e3c 7370 616e  o">.</span><span
-0001c350: 2063 6c61 7373 3d22 6e22 3e73 756d 3c2f   class="n">sum</
-0001c360: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
-0001c370: 3d22 7022 3e28 3c2f 7370 616e 3e3c 7370  ="p">(</span><sp
-0001c380: 616e 2063 6c61 7373 3d22 6f22 3e2d 3c2f  an class="o">-</
-0001c390: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
-0001c3a0: 3d22 6e22 3e67 7261 643c 2f73 7061 6e3e  ="n">grad</span>
-0001c3b0: 203c 7370 616e 2063 6c61 7373 3d22 6f22   <span class="o"
-0001c3c0: 3e2a 3c2f 7370 616e 3e20 3c73 7061 6e20  >*</span> <span 
-0001c3d0: 636c 6173 733d 226e 223e 6e65 7774 6f6e  class="n">newton
-0001c3e0: 5f64 6972 6563 7469 6f6e 3c2f 7370 616e  _direction</span
-0001c3f0: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
-0001c400: 3e29 3c2f 7370 616e 3e0a 2020 2020 2020  >)</span>.      
-0001c410: 2020 3c73 7061 6e20 636c 6173 733d 226b    <span class="k
-0001c420: 223e 656c 7365 3c2f 7370 616e 3e3c 7370  ">else</span><sp
-0001c430: 616e 2063 6c61 7373 3d22 7022 3e3a 3c2f  an class="p">:</
-0001c440: 7370 616e 3e0a 2020 2020 2020 2020 2020  span>.          
-0001c450: 2020 3c73 7061 6e20 636c 6173 733d 226e    <span class="n
-0001c460: 223e 6e65 7774 6f6e 5f64 6972 6563 7469  ">newton_directi
-0001c470: 6f6e 3c2f 7370 616e 3e20 3c73 7061 6e20  on</span> <span 
-0001c480: 636c 6173 733d 226f 223e 3d3c 2f73 7061  class="o">=</spa
-0001c490: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
-0001c4a0: 6e22 3e6e 703c 2f73 7061 6e3e 3c73 7061  n">np</span><spa
-0001c4b0: 6e20 636c 6173 733d 226f 223e 2e3c 2f73  n class="o">.</s
-0001c4c0: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
-0001c4d0: 226e 223e 6c69 6e61 6c67 3c2f 7370 616e  "n">linalg</span
-0001c4e0: 3e3c 7370 616e 2063 6c61 7373 3d22 6f22  ><span class="o"
-0001c4f0: 3e2e 3c2f 7370 616e 3e3c 7370 616e 2063  >.</span><span c
-0001c500: 6c61 7373 3d22 6e22 3e73 6f6c 7665 3c2f  lass="n">solve</
-0001c510: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
-0001c520: 3d22 7022 3e28 3c2f 7370 616e 3e3c 7370  ="p">(</span><sp
-0001c530: 616e 2063 6c61 7373 3d22 6e22 3e48 3c2f  an class="n">H</
-0001c540: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
-0001c550: 3d22 7022 3e2c 3c2f 7370 616e 3e20 3c73  ="p">,</span> <s
-0001c560: 7061 6e20 636c 6173 733d 226f 223e 2d3c  pan class="o">-<
-0001c570: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
-0001c580: 733d 226e 223e 6772 6164 3c2f 7370 616e  s="n">grad</span
-0001c590: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
-0001c5a0: 3e29 3c2f 7370 616e 3e0a 2020 2020 2020  >)</span>.      
-0001c5b0: 2020 2020 2020 3c73 7061 6e20 636c 6173        <span clas
-0001c5c0: 733d 226e 223e 6e65 7774 6f6e 5f64 6563  s="n">newton_dec
-0001c5d0: 7265 6d65 6e74 5f73 7175 6172 653c 2f73  rement_square</s
-0001c5e0: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
-0001c5f0: 3d22 6f22 3e3d 3c2f 7370 616e 3e20 3c73  ="o">=</span> <s
-0001c600: 7061 6e20 636c 6173 733d 226e 223e 6e70  pan class="n">np
-0001c610: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-0001c620: 7373 3d22 6f22 3e2e 3c2f 7370 616e 3e3c  ss="o">.</span><
-0001c630: 7370 616e 2063 6c61 7373 3d22 6e22 3e73  span class="n">s
-0001c640: 756d 3c2f 7370 616e 3e3c 7370 616e 2063  um</span><span c
-0001c650: 6c61 7373 3d22 7022 3e28 3c2f 7370 616e  lass="p">(</span
-0001c660: 3e3c 7370 616e 2063 6c61 7373 3d22 6f22  ><span class="o"
-0001c670: 3e2d 3c2f 7370 616e 3e3c 7370 616e 2063  >-</span><span c
-0001c680: 6c61 7373 3d22 6e22 3e67 7261 643c 2f73  lass="n">grad</s
-0001c690: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
-0001c6a0: 3d22 6f22 3e2a 3c2f 7370 616e 3e20 3c73  ="o">*</span> <s
-0001c6b0: 7061 6e20 636c 6173 733d 226e 223e 6e65  pan class="n">ne
-0001c6c0: 7774 6f6e 5f64 6972 6563 7469 6f6e 3c2f  wton_direction</
-0001c6d0: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
-0001c6e0: 3d22 7022 3e29 3c2f 7370 616e 3e0a 0a20  ="p">)</span>.. 
-0001c6f0: 2020 2020 2020 203c 7370 616e 2063 6c61         <span cla
-0001c700: 7373 3d22 6b22 3e69 663c 2f73 7061 6e3e  ss="k">if</span>
-0001c710: 203c 7370 616e 2063 6c61 7373 3d22 6e22   <span class="n"
-0001c720: 3e76 6572 626f 7365 3c2f 7370 616e 3e3c  >verbose</span><
-0001c730: 7370 616e 2063 6c61 7373 3d22 7022 3e3a  span class="p">:
-0001c740: 3c2f 7370 616e 3e0a 2020 2020 2020 2020  </span>.        
-0001c750: 2020 2020 3c73 7061 6e20 636c 6173 733d      <span class=
-0001c760: 226e 6222 3e70 7269 6e74 3c2f 7370 616e  "nb">print</span
-0001c770: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
-0001c780: 3e28 3c2f 7370 616e 3e0a 2020 2020 2020  >(</span>.      
-0001c790: 2020 2020 2020 2020 2020 3c73 7061 6e20            <span 
-0001c7a0: 636c 6173 733d 2273 6122 3e66 3c2f 7370  class="sa">f</sp
-0001c7b0: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-0001c7c0: 7332 223e 2671 756f 743b 4174 2069 7465  s2">&quot;At ite
-0001c7d0: 7261 7465 203c 2f73 7061 6e3e 3c73 7061  rate </span><spa
-0001c7e0: 6e20 636c 6173 733d 2273 6922 3e7b 3c2f  n class="si">{</
-0001c7f0: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
-0001c800: 3d22 6e22 3e69 6e64 785f 6974 6572 3c2f  ="n">indx_iter</
-0001c810: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
-0001c820: 3d22 7369 223e 3a3c 2f73 7061 6e3e 3c73  ="si">:</span><s
-0001c830: 7061 6e20 636c 6173 733d 2273 3222 3e34  pan class="s2">4
-0001c840: 643c 2f73 7061 6e3e 3c73 7061 6e20 636c  d</span><span cl
-0001c850: 6173 733d 2273 6922 3e7d 3c2f 7370 616e  ass="si">}</span
-0001c860: 3e3c 7370 616e 2063 6c61 7373 3d22 7332  ><span class="s2
-0001c870: 223e 3b20 663d 203c 2f73 7061 6e3e 3c73  ">; f= </span><s
-0001c880: 7061 6e20 636c 6173 733d 2273 6922 3e7b  pan class="si">{
-0001c890: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-0001c8a0: 7373 3d22 6e22 3e6c 6f73 733c 2f73 7061  ss="n">loss</spa
-0001c8b0: 6e3e 3c73 7061 6e20 636c 6173 733d 226f  n><span class="o
-0001c8c0: 223e 2e3c 2f73 7061 6e3e 3c73 7061 6e20  ">.</span><span 
-0001c8d0: 636c 6173 733d 226e 223e 6974 656d 3c2f  class="n">item</
-0001c8e0: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
-0001c8f0: 3d22 7022 3e28 293c 2f73 7061 6e3e 3c73  ="p">()</span><s
-0001c900: 7061 6e20 636c 6173 733d 2273 6922 3e3a  pan class="si">:
-0001c910: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-0001c920: 7373 3d22 7332 223e 2e35 453c 2f73 7061  ss="s2">.5E</spa
-0001c930: 6e3e 3c73 7061 6e20 636c 6173 733d 2273  n><span class="s
-0001c940: 6922 3e7d 3c2f 7370 616e 3e3c 7370 616e  i">}</span><span
-0001c950: 2063 6c61 7373 3d22 7332 223e 3b26 7175   class="s2">;&qu
-0001c960: 6f74 3b3c 2f73 7061 6e3e 3c73 7061 6e20  ot;</span><span 
-0001c970: 636c 6173 733d 2270 223e 2c3c 2f73 7061  class="p">,</spa
-0001c980: 6e3e 0a20 2020 2020 2020 2020 2020 2020  n>.             
-0001c990: 2020 203c 7370 616e 2063 6c61 7373 3d22     <span class="
-0001c9a0: 7361 223e 663c 2f73 7061 6e3e 3c73 7061  sa">f</span><spa
-0001c9b0: 6e20 636c 6173 733d 2273 3222 3e26 7175  n class="s2">&qu
-0001c9c0: 6f74 3b7c 312f 322a 4e65 7774 6f6e 5f64  ot;|1/2*Newton_d
-0001c9d0: 6563 7265 6d65 6e74 5e32 7c3a 203c 2f73  ecrement^2|: </s
-0001c9e0: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
-0001c9f0: 2273 6922 3e7b 3c2f 7370 616e 3e3c 7370  "si">{</span><sp
-0001ca00: 616e 2063 6c61 7373 3d22 6e22 3e6e 6577  an class="n">new
-0001ca10: 746f 6e5f 6465 6372 656d 656e 745f 7371  ton_decrement_sq
-0001ca20: 7561 7265 3c2f 7370 616e 3e3c 7370 616e  uare</span><span
-0001ca30: 2063 6c61 7373 3d22 6f22 3e2e 3c2f 7370   class="o">.</sp
-0001ca40: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-0001ca50: 6e22 3e69 7465 6d3c 2f73 7061 6e3e 3c73  n">item</span><s
-0001ca60: 7061 6e20 636c 6173 733d 2270 223e 2829  pan class="p">()
-0001ca70: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-0001ca80: 7373 3d22 6f22 3e2f 3c2f 7370 616e 3e3c  ss="o">/</span><
-0001ca90: 7370 616e 2063 6c61 7373 3d22 6d69 223e  span class="mi">
-0001caa0: 323c 2f73 7061 6e3e 3c73 7061 6e20 636c  2</span><span cl
-0001cab0: 6173 733d 2273 6922 3e3a 3c2f 7370 616e  ass="si">:</span
-0001cac0: 3e3c 7370 616e 2063 6c61 7373 3d22 7332  ><span class="s2
-0001cad0: 223e 2e35 453c 2f73 7061 6e3e 3c73 7061  ">.5E</span><spa
-0001cae0: 6e20 636c 6173 733d 2273 6922 3e7d 3c2f  n class="si">}</
-0001caf0: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
-0001cb00: 3d22 7365 223e 5c6e 3c2f 7370 616e 3e3c  ="se">\n</span><
-0001cb10: 7370 616e 2063 6c61 7373 3d22 7332 223e  span class="s2">
-0001cb20: 2671 756f 743b 3c2f 7370 616e 3e3c 7370  &quot;</span><sp
-0001cb30: 616e 2063 6c61 7373 3d22 7022 3e2c 3c2f  an class="p">,</
-0001cb40: 7370 616e 3e0a 2020 2020 2020 2020 2020  span>.          
-0001cb50: 2020 3c73 7061 6e20 636c 6173 733d 2270    <span class="p
-0001cb60: 223e 293c 2f73 7061 6e3e 0a0a 2020 2020  ">)</span>..    
-0001cb70: 2020 2020 3c73 7061 6e20 636c 6173 733d      <span class=
-0001cb80: 226b 223e 6966 3c2f 7370 616e 3e20 3c73  "k">if</span> <s
-0001cb90: 7061 6e20 636c 6173 733d 226e 223e 6e65  pan class="n">ne
-0001cba0: 7774 6f6e 5f64 6563 7265 6d65 6e74 5f73  wton_decrement_s
-0001cbb0: 7175 6172 653c 2f73 7061 6e3e 203c 7370  quare</span> <sp
-0001cbc0: 616e 2063 6c61 7373 3d22 6f22 3e2f 3c2f  an class="o">/</
-0001cbd0: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
-0001cbe0: 733d 226d 6622 3e32 2e30 3c2f 7370 616e  s="mf">2.0</span
-0001cbf0: 3e20 3c73 7061 6e20 636c 6173 733d 226f  > <span class="o
-0001cc00: 223e 266c 743b 3d3c 2f73 7061 6e3e 203c  ">&lt;=</span> <
-0001cc10: 7370 616e 2063 6c61 7373 3d22 6e22 3e65  span class="n">e
-0001cc20: 7073 3c2f 7370 616e 3e3c 7370 616e 2063  ps</span><span c
-0001cc30: 6c61 7373 3d22 7022 3e3a 3c2f 7370 616e  lass="p">:</span
-0001cc40: 3e0a 2020 2020 2020 2020 2020 2020 3c73  >.            <s
-0001cc50: 7061 6e20 636c 6173 733d 226b 223e 6272  pan class="k">br
-0001cc60: 6561 6b3c 2f73 7061 6e3e 0a0a 2020 2020  eak</span>..    
-0001cc70: 2020 2020 3c73 7061 6e20 636c 6173 733d      <span class=
-0001cc80: 2263 3122 3e23 2320 6261 636b 7472 6163  "c1">## backtrac
-0001cc90: 6b69 6e67 206c 696e 6520 7365 6172 6368  king line search
-0001cca0: 3c2f 7370 616e 3e0a 2020 2020 2020 2020  </span>.        
-0001ccb0: 3c73 7061 6e20 636c 6173 733d 226e 223e  <span class="n">
-0001ccc0: 6d61 785f 6c73 5f69 7465 723c 2f73 7061  max_ls_iter</spa
-0001ccd0: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
-0001cce0: 6f22 3e3d 3c2f 7370 616e 3e20 3c73 7061  o">=</span> <spa
-0001ccf0: 6e20 636c 6173 733d 226d 6922 3e31 3030  n class="mi">100
-0001cd00: 3c2f 7370 616e 3e0a 2020 2020 2020 2020  </span>.        
-0001cd10: 3c73 7061 6e20 636c 6173 733d 226e 223e  <span class="n">
-0001cd20: 7374 6570 5f73 697a 653c 2f73 7061 6e3e  step_size</span>
-0001cd30: 203c 7370 616e 2063 6c61 7373 3d22 6f22   <span class="o"
-0001cd40: 3e3d 3c2f 7370 616e 3e20 3c73 7061 6e20  >=</span> <span 
-0001cd50: 636c 6173 733d 226d 6622 3e31 2e30 3c2f  class="mf">1.0</
-0001cd60: 7370 616e 3e0a 0a20 2020 2020 2020 203c  span>..        <
-0001cd70: 7370 616e 2063 6c61 7373 3d22 6e22 3e69  span class="n">i
-0001cd80: 6e64 785f 6c73 5f69 7465 723c 2f73 7061  ndx_ls_iter</spa
-0001cd90: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
-0001cda0: 6f22 3e3d 3c2f 7370 616e 3e20 3c73 7061  o">=</span> <spa
-0001cdb0: 6e20 636c 6173 733d 226d 6922 3e30 3c2f  n class="mi">0</
-0001cdc0: 7370 616e 3e0a 2020 2020 2020 2020 3c73  span>.        <s
-0001cdd0: 7061 6e20 636c 6173 733d 226b 223e 7768  pan class="k">wh
-0001cde0: 696c 653c 2f73 7061 6e3e 203c 7370 616e  ile</span> <span
-0001cdf0: 2063 6c61 7373 3d22 6e22 3e69 6e64 785f   class="n">indx_
-0001ce00: 6c73 5f69 7465 723c 2f73 7061 6e3e 203c  ls_iter</span> <
-0001ce10: 7370 616e 2063 6c61 7373 3d22 6f22 3e26  span class="o">&
-0001ce20: 6c74 3b3c 2f73 7061 6e3e 203c 7370 616e  lt;</span> <span
-0001ce30: 2063 6c61 7373 3d22 6e22 3e6d 6178 5f6c   class="n">max_l
-0001ce40: 735f 6974 6572 3c2f 7370 616e 3e3c 7370  s_iter</span><sp
-0001ce50: 616e 2063 6c61 7373 3d22 7022 3e3a 3c2f  an class="p">:</
-0001ce60: 7370 616e 3e0a 2020 2020 2020 2020 2020  span>.          
-0001ce70: 2020 3c73 7061 6e20 636c 6173 733d 226e    <span class="n
-0001ce80: 223e 7461 7267 6574 5f6c 6f73 733c 2f73  ">target_loss</s
-0001ce90: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
-0001cea0: 2270 223e 2c3c 2f73 7061 6e3e 203c 7370  "p">,</span> <sp
-0001ceb0: 616e 2063 6c61 7373 3d22 6e22 3e5f 3c2f  an class="n">_</
-0001cec0: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
-0001ced0: 733d 226f 223e 3d3c 2f73 7061 6e3e 203c  s="o">=</span> <
-0001cee0: 7370 616e 2063 6c61 7373 3d22 6e22 3e66  span class="n">f
-0001cef0: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-0001cf00: 7373 3d22 7022 3e28 3c2f 7370 616e 3e3c  ss="p">(</span><
-0001cf10: 7370 616e 2063 6c61 7373 3d22 6e22 3e78  span class="n">x
-0001cf20: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
-0001cf30: 6173 733d 226f 223e 2b3c 2f73 7061 6e3e  ass="o">+</span>
-0001cf40: 203c 7370 616e 2063 6c61 7373 3d22 6e22   <span class="n"
-0001cf50: 3e73 7465 705f 7369 7a65 3c2f 7370 616e  >step_size</span
-0001cf60: 3e20 3c73 7061 6e20 636c 6173 733d 226f  > <span class="o
-0001cf70: 223e 2a3c 2f73 7061 6e3e 203c 7370 616e  ">*</span> <span
-0001cf80: 2063 6c61 7373 3d22 6e22 3e6e 6577 746f   class="n">newto
-0001cf90: 6e5f 6469 7265 6374 696f 6e3c 2f73 7061  n_direction</spa
-0001cfa0: 6e3e 3c73 7061 6e20 636c 6173 733d 2270  n><span class="p
-0001cfb0: 223e 2c3c 2f73 7061 6e3e 203c 7370 616e  ">,</span> <span
-0001cfc0: 2063 6c61 7373 3d22 6f22 3e2a 3c2f 7370   class="o">*</sp
-0001cfd0: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-0001cfe0: 6e22 3e61 7267 733c 2f73 7061 6e3e 3c73  n">args</span><s
-0001cff0: 7061 6e20 636c 6173 733d 2270 223e 293c  pan class="p">)<
-0001d000: 2f73 7061 6e3e 0a0a 2020 2020 2020 2020  /span>..        
-0001d010: 2020 2020 3c73 7061 6e20 636c 6173 733d      <span class=
-0001d020: 226e 223e 4e5f 6675 6e63 3c2f 7370 616e  "n">N_func</span
-0001d030: 3e20 3c73 7061 6e20 636c 6173 733d 226f  > <span class="o
-0001d040: 223e 2b3d 3c2f 7370 616e 3e20 3c73 7061  ">+=</span> <spa
-0001d050: 6e20 636c 6173 733d 226d 6922 3e31 3c2f  n class="mi">1</
-0001d060: 7370 616e 3e0a 2020 2020 2020 2020 2020  span>.          
-0001d070: 2020 3c73 7061 6e20 636c 6173 733d 226e    <span class="n
-0001d080: 223e 6170 7072 6f78 696d 6174 655f 6c6f  ">approximate_lo
-0001d090: 7373 3c2f 7370 616e 3e20 3c73 7061 6e20  ss</span> <span 
-0001d0a0: 636c 6173 733d 226f 223e 3d3c 2f73 7061  class="o">=</spa
-0001d0b0: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
-0001d0c0: 6e22 3e6c 6f73 733c 2f73 7061 6e3e 203c  n">loss</span> <
-0001d0d0: 7370 616e 2063 6c61 7373 3d22 6f22 3e2b  span class="o">+
-0001d0e0: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
-0001d0f0: 6173 733d 226e 223e 7374 6570 5f73 697a  ass="n">step_siz
-0001d100: 653c 2f73 7061 6e3e 203c 7370 616e 2063  e</span> <span c
-0001d110: 6c61 7373 3d22 6f22 3e2a 3c2f 7370 616e  lass="o">*</span
-0001d120: 3e20 3c73 7061 6e20 636c 6173 733d 226e  > <span class="n
-0001d130: 223e 616c 7068 613c 2f73 7061 6e3e 203c  ">alpha</span> <
-0001d140: 7370 616e 2063 6c61 7373 3d22 6f22 3e2a  span class="o">*
-0001d150: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
-0001d160: 6173 733d 2270 223e 283c 2f73 7061 6e3e  ass="p">(</span>
-0001d170: 3c73 7061 6e20 636c 6173 733d 226f 223e  <span class="o">
-0001d180: 2d3c 2f73 7061 6e3e 3c73 7061 6e20 636c  -</span><span cl
-0001d190: 6173 733d 226e 223e 6e65 7774 6f6e 5f64  ass="n">newton_d
-0001d1a0: 6563 7265 6d65 6e74 5f73 7175 6172 653c  ecrement_square<
-0001d1b0: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
-0001d1c0: 733d 2270 223e 293c 2f73 7061 6e3e 0a20  s="p">)</span>. 
-0001d1d0: 2020 2020 2020 2020 2020 203c 7370 616e             <span
-0001d1e0: 2063 6c61 7373 3d22 6b22 3e69 663c 2f73   class="k">if</s
-0001d1f0: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
-0001d200: 3d22 6e22 3e74 6172 6765 745f 6c6f 7373  ="n">target_loss
-0001d210: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
-0001d220: 6173 733d 226f 223e 266c 743b 3c2f 7370  ass="o">&lt;</sp
-0001d230: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
-0001d240: 226e 223e 6170 7072 6f78 696d 6174 655f  "n">approximate_
-0001d250: 6c6f 7373 3c2f 7370 616e 3e3c 7370 616e  loss</span><span
-0001d260: 2063 6c61 7373 3d22 7022 3e3a 3c2f 7370   class="p">:</sp
-0001d270: 616e 3e0a 2020 2020 2020 2020 2020 2020  an>.            
-0001d280: 2020 2020 3c73 7061 6e20 636c 6173 733d      <span class=
-0001d290: 226b 223e 6272 6561 6b3c 2f73 7061 6e3e  "k">break</span>
-0001d2a0: 0a20 2020 2020 2020 2020 2020 203c 7370  .            <sp
-0001d2b0: 616e 2063 6c61 7373 3d22 6b22 3e65 6c73  an class="k">els
-0001d2c0: 653c 2f73 7061 6e3e 3c73 7061 6e20 636c  e</span><span cl
-0001d2d0: 6173 733d 2270 223e 3a3c 2f73 7061 6e3e  ass="p">:</span>
-0001d2e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001d2f0: 203c 7370 616e 2063 6c61 7373 3d22 6e22   <span class="n"
-0001d300: 3e73 7465 705f 7369 7a65 3c2f 7370 616e  >step_size</span
-0001d310: 3e20 3c73 7061 6e20 636c 6173 733d 226f  > <span class="o
-0001d320: 223e 3d3c 2f73 7061 6e3e 203c 7370 616e  ">=</span> <span
-0001d330: 2063 6c61 7373 3d22 6e22 3e73 7465 705f   class="n">step_
-0001d340: 7369 7a65 3c2f 7370 616e 3e20 3c73 7061  size</span> <spa
-0001d350: 6e20 636c 6173 733d 226f 223e 2a3c 2f73  n class="o">*</s
-0001d360: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
-0001d370: 3d22 6e22 3e62 6574 613c 2f73 7061 6e3e  ="n">beta</span>
-0001d380: 0a20 2020 2020 2020 2020 2020 203c 7370  .            <sp
-0001d390: 616e 2063 6c61 7373 3d22 6e22 3e69 6e64  an class="n">ind
-0001d3a0: 785f 6c73 5f69 7465 723c 2f73 7061 6e3e  x_ls_iter</span>
-0001d3b0: 203c 7370 616e 2063 6c61 7373 3d22 6f22   <span class="o"
-0001d3c0: 3e2b 3d3c 2f73 7061 6e3e 203c 7370 616e  >+=</span> <span
-0001d3d0: 2063 6c61 7373 3d22 6d69 223e 313c 2f73   class="mi">1</s
-0001d3e0: 7061 6e3e 0a0a 2020 2020 2020 2020 3c73  pan>..        <s
-0001d3f0: 7061 6e20 636c 6173 733d 226e 223e 783c  pan class="n">x<
-0001d400: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
-0001d410: 7373 3d22 6f22 3e3d 3c2f 7370 616e 3e20  ss="o">=</span> 
-0001d420: 3c73 7061 6e20 636c 6173 733d 226e 223e  <span class="n">
-0001d430: 783c 2f73 7061 6e3e 203c 7370 616e 2063  x</span> <span c
-0001d440: 6c61 7373 3d22 6f22 3e2b 3c2f 7370 616e  lass="o">+</span
-0001d450: 3e20 3c73 7061 6e20 636c 6173 733d 226e  > <span class="n
-0001d460: 223e 7374 6570 5f73 697a 653c 2f73 7061  ">step_size</spa
-0001d470: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
-0001d480: 6f22 3e2a 3c2f 7370 616e 3e20 3c73 7061  o">*</span> <spa
-0001d490: 6e20 636c 6173 733d 226e 223e 6e65 7774  n class="n">newt
-0001d4a0: 6f6e 5f64 6972 6563 7469 6f6e 3c2f 7370  on_direction</sp
-0001d4b0: 616e 3e0a 2020 2020 2020 2020 3c73 7061  an>.        <spa
-0001d4c0: 6e20 636c 6173 733d 226e 223e 696e 6478  n class="n">indx
-0001d4d0: 5f69 7465 723c 2f73 7061 6e3e 203c 7370  _iter</span> <sp
-0001d4e0: 616e 2063 6c61 7373 3d22 6f22 3e2b 3d3c  an class="o">+=<
-0001d4f0: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
-0001d500: 7373 3d22 6d69 223e 313c 2f73 7061 6e3e  ss="mi">1</span>
-0001d510: 0a0a 2020 2020 3c73 7061 6e20 636c 6173  ..    <span clas
-0001d520: 733d 226b 223e 6966 3c2f 7370 616e 3e20  s="k">if</span> 
-0001d530: 3c73 7061 6e20 636c 6173 733d 226e 223e  <span class="n">
-0001d540: 7665 7262 6f73 653c 2f73 7061 6e3e 3c73  verbose</span><s
-0001d550: 7061 6e20 636c 6173 733d 2270 223e 3a3c  pan class="p">:<
-0001d560: 2f73 7061 6e3e 0a20 2020 2020 2020 203c  /span>.        <
-0001d570: 7370 616e 2063 6c61 7373 3d22 6e62 223e  span class="nb">
-0001d580: 7072 696e 743c 2f73 7061 6e3e 3c73 7061  print</span><spa
-0001d590: 6e20 636c 6173 733d 2270 223e 283c 2f73  n class="p">(</s
-0001d5a0: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
-0001d5b0: 2273 3222 3e26 7175 6f74 3b4e 5f69 7465  "s2">&quot;N_ite
-0001d5c0: 7220 2020 3d20 746f 7461 6c20 6e75 6d62  r   = total numb
-0001d5d0: 6572 206f 6620 6974 6572 6174 696f 6e73  er of iterations
-0001d5e0: 2671 756f 743b 3c2f 7370 616e 3e3c 7370  &quot;</span><sp
-0001d5f0: 616e 2063 6c61 7373 3d22 7022 3e29 3c2f  an class="p">)</
-0001d600: 7370 616e 3e0a 2020 2020 2020 2020 3c73  span>.        <s
-0001d610: 7061 6e20 636c 6173 733d 226e 6222 3e70  pan class="nb">p
-0001d620: 7269 6e74 3c2f 7370 616e 3e3c 7370 616e  rint</span><span
-0001d630: 2063 6c61 7373 3d22 7022 3e28 3c2f 7370   class="p">(</sp
-0001d640: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-0001d650: 7332 223e 2671 756f 743b 4e5f 6675 6e63  s2">&quot;N_func
-0001d660: 2020 203d 2074 6f74 616c 206e 756d 6265     = total numbe
-0001d670: 7220 6f66 2066 756e 6374 696f 6e20 616e  r of function an
-0001d680: 6420 6772 6164 6965 6e74 2065 7661 6c75  d gradient evalu
-0001d690: 6174 696f 6e73 2671 756f 743b 3c2f 7370  ations&quot;</sp
-0001d6a0: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-0001d6b0: 7022 3e29 3c2f 7370 616e 3e0a 2020 2020  p">)</span>.    
-0001d6c0: 2020 2020 3c73 7061 6e20 636c 6173 733d      <span class=
-0001d6d0: 226e 6222 3e70 7269 6e74 3c2f 7370 616e  "nb">print</span
-0001d6e0: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
-0001d6f0: 3e28 3c2f 7370 616e 3e3c 7370 616e 2063  >(</span><span c
-0001d700: 6c61 7373 3d22 7332 223e 2671 756f 743b  lass="s2">&quot;
-0001d710: 4620 2020 2020 2020 203d 2066 696e 616c  F        = final
-0001d720: 2066 756e 6374 696f 6e20 7661 6c75 6520   function value 
-0001d730: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-0001d740: 7373 3d22 7365 223e 5c6e 3c2f 7370 616e  ss="se">\n</span
-0001d750: 3e3c 7370 616e 2063 6c61 7373 3d22 7332  ><span class="s2
-0001d760: 223e 2671 756f 743b 3c2f 7370 616e 3e3c  ">&quot;</span><
-0001d770: 7370 616e 2063 6c61 7373 3d22 7022 3e29  span class="p">)
-0001d780: 3c2f 7370 616e 3e0a 2020 2020 2020 2020  </span>.        
-0001d790: 3c73 7061 6e20 636c 6173 733d 226e 6222  <span class="nb"
-0001d7a0: 3e70 7269 6e74 3c2f 7370 616e 3e3c 7370  >print</span><sp
-0001d7b0: 616e 2063 6c61 7373 3d22 7022 3e28 3c2f  an class="p">(</
-0001d7c0: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
-0001d7d0: 3d22 7332 223e 2671 756f 743b 2020 2020  ="s2">&quot;    
-0001d7e0: 2020 2020 2020 2020 202a 202a 202a 2020           * * *  
-0001d7f0: 2020 203c 2f73 7061 6e3e 3c73 7061 6e20     </span><span 
-0001d800: 636c 6173 733d 2273 6522 3e5c 6e3c 2f73  class="se">\n</s
-0001d810: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
-0001d820: 2273 3222 3e26 7175 6f74 3b3c 2f73 7061  "s2">&quot;</spa
-0001d830: 6e3e 3c73 7061 6e20 636c 6173 733d 2270  n><span class="p
-0001d840: 223e 293c 2f73 7061 6e3e 0a20 2020 2020  ">)</span>.     
-0001d850: 2020 203c 7370 616e 2063 6c61 7373 3d22     <span class="
-0001d860: 6e62 223e 7072 696e 743c 2f73 7061 6e3e  nb">print</span>
-0001d870: 3c73 7061 6e20 636c 6173 733d 2270 223e  <span class="p">
-0001d880: 283c 2f73 7061 6e3e 3c73 7061 6e20 636c  (</span><span cl
-0001d890: 6173 733d 2273 3222 3e26 7175 6f74 3b4e  ass="s2">&quot;N
-0001d8a0: 5f69 7465 7220 2020 204e 5f66 756e 6320  _iter    N_func 
-0001d8b0: 2020 2020 2020 2046 2671 756f 743b 3c2f         F&quot;</
-0001d8c0: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
-0001d8d0: 3d22 7022 3e29 3c2f 7370 616e 3e0a 2020  ="p">)</span>.  
-0001d8e0: 2020 2020 2020 3c73 7061 6e20 636c 6173        <span clas
-0001d8f0: 733d 226e 6222 3e70 7269 6e74 3c2f 7370  s="nb">print</sp
-0001d900: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-0001d910: 7022 3e28 3c2f 7370 616e 3e3c 7370 616e  p">(</span><span
-0001d920: 2063 6c61 7373 3d22 7361 223e 663c 2f73   class="sa">f</s
-0001d930: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
-0001d940: 2273 3222 3e26 7175 6f74 3b3c 2f73 7061  "s2">&quot;</spa
-0001d950: 6e3e 3c73 7061 6e20 636c 6173 733d 2273  n><span class="s
-0001d960: 6922 3e7b 3c2f 7370 616e 3e3c 7370 616e  i">{</span><span
-0001d970: 2063 6c61 7373 3d22 6e22 3e69 6e64 785f   class="n">indx_
-0001d980: 6974 6572 3c2f 7370 616e 3e3c 7370 616e  iter</span><span
-0001d990: 2063 6c61 7373 3d22 6f22 3e2b 3c2f 7370   class="o">+</sp
-0001d9a0: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-0001d9b0: 6d69 223e 313c 2f73 7061 6e3e 3c73 7061  mi">1</span><spa
-0001d9c0: 6e20 636c 6173 733d 2273 6922 3e3a 3c2f  n class="si">:</
+0001c150: 223e 2c3c 2f73 7061 6e3e 203c 7370 616e  ">,</span> <span
+0001c160: 2063 6c61 7373 3d22 6e22 3e74 6f72 6368   class="n">torch
+0001c170: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
+0001c180: 7373 3d22 6f22 3e2e 3c2f 7370 616e 3e3c  ss="o">.</span><
+0001c190: 7370 616e 2063 6c61 7373 3d22 6e22 3e54  span class="n">T
+0001c1a0: 656e 736f 723c 2f73 7061 6e3e 3c73 7061  ensor</span><spa
+0001c1b0: 6e20 636c 6173 733d 2270 223e 293a 3c2f  n class="p">):</
+0001c1c0: 7370 616e 3e0a 2020 2020 2020 2020 2020  span>.          
+0001c1d0: 2020 3c73 7061 6e20 636c 6173 733d 226e    <span class="n
+0001c1e0: 223e 6e65 7774 6f6e 5f64 6972 6563 7469  ">newton_directi
+0001c1f0: 6f6e 3c2f 7370 616e 3e20 3c73 7061 6e20  on</span> <span 
+0001c200: 636c 6173 733d 226f 223e 3d3c 2f73 7061  class="o">=</spa
+0001c210: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
+0001c220: 6e22 3e74 6f72 6368 3c2f 7370 616e 3e3c  n">torch</span><
+0001c230: 7370 616e 2063 6c61 7373 3d22 6f22 3e2e  span class="o">.
+0001c240: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
+0001c250: 7373 3d22 6e22 3e6c 696e 616c 673c 2f73  ss="n">linalg</s
+0001c260: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
+0001c270: 226f 223e 2e3c 2f73 7061 6e3e 3c73 7061  "o">.</span><spa
+0001c280: 6e20 636c 6173 733d 226e 223e 736f 6c76  n class="n">solv
+0001c290: 653c 2f73 7061 6e3e 3c73 7061 6e20 636c  e</span><span cl
+0001c2a0: 6173 733d 2270 223e 283c 2f73 7061 6e3e  ass="p">(</span>
+0001c2b0: 3c73 7061 6e20 636c 6173 733d 226e 223e  <span class="n">
+0001c2c0: 483c 2f73 7061 6e3e 3c73 7061 6e20 636c  H</span><span cl
+0001c2d0: 6173 733d 2270 223e 2c3c 2f73 7061 6e3e  ass="p">,</span>
+0001c2e0: 203c 7370 616e 2063 6c61 7373 3d22 6f22   <span class="o"
+0001c2f0: 3e2d 3c2f 7370 616e 3e3c 7370 616e 2063  >-</span><span c
+0001c300: 6c61 7373 3d22 6e22 3e67 7261 643c 2f73  lass="n">grad</s
+0001c310: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
+0001c320: 2270 223e 293c 2f73 7061 6e3e 0a20 2020  "p">)</span>.   
+0001c330: 2020 2020 2020 2020 203c 7370 616e 2063           <span c
+0001c340: 6c61 7373 3d22 6e22 3e6e 6577 746f 6e5f  lass="n">newton_
+0001c350: 6465 6372 656d 656e 745f 7371 7561 7265  decrement_square
+0001c360: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
+0001c370: 6173 733d 226f 223e 3d3c 2f73 7061 6e3e  ass="o">=</span>
+0001c380: 203c 7370 616e 2063 6c61 7373 3d22 6e22   <span class="n"
+0001c390: 3e74 6f72 6368 3c2f 7370 616e 3e3c 7370  >torch</span><sp
+0001c3a0: 616e 2063 6c61 7373 3d22 6f22 3e2e 3c2f  an class="o">.</
+0001c3b0: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+0001c3c0: 3d22 6e22 3e73 756d 3c2f 7370 616e 3e3c  ="n">sum</span><
+0001c3d0: 7370 616e 2063 6c61 7373 3d22 7022 3e28  span class="p">(
+0001c3e0: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
+0001c3f0: 7373 3d22 6f22 3e2d 3c2f 7370 616e 3e3c  ss="o">-</span><
+0001c400: 7370 616e 2063 6c61 7373 3d22 6e22 3e67  span class="n">g
+0001c410: 7261 643c 2f73 7061 6e3e 203c 7370 616e  rad</span> <span
+0001c420: 2063 6c61 7373 3d22 6f22 3e2a 3c2f 7370   class="o">*</sp
+0001c430: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
+0001c440: 226e 223e 6e65 7774 6f6e 5f64 6972 6563  "n">newton_direc
+0001c450: 7469 6f6e 3c2f 7370 616e 3e3c 7370 616e  tion</span><span
+0001c460: 2063 6c61 7373 3d22 7022 3e29 3c2f 7370   class="p">)</sp
+0001c470: 616e 3e0a 2020 2020 2020 2020 3c73 7061  an>.        <spa
+0001c480: 6e20 636c 6173 733d 226b 223e 656c 7365  n class="k">else
+0001c490: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
+0001c4a0: 7373 3d22 7022 3e3a 3c2f 7370 616e 3e0a  ss="p">:</span>.
+0001c4b0: 2020 2020 2020 2020 2020 2020 3c73 7061              <spa
+0001c4c0: 6e20 636c 6173 733d 226e 223e 6e65 7774  n class="n">newt
+0001c4d0: 6f6e 5f64 6972 6563 7469 6f6e 3c2f 7370  on_direction</sp
+0001c4e0: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
+0001c4f0: 226f 223e 3d3c 2f73 7061 6e3e 203c 7370  "o">=</span> <sp
+0001c500: 616e 2063 6c61 7373 3d22 6e22 3e6e 703c  an class="n">np<
+0001c510: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
+0001c520: 733d 226f 223e 2e3c 2f73 7061 6e3e 3c73  s="o">.</span><s
+0001c530: 7061 6e20 636c 6173 733d 226e 223e 6c69  pan class="n">li
+0001c540: 6e61 6c67 3c2f 7370 616e 3e3c 7370 616e  nalg</span><span
+0001c550: 2063 6c61 7373 3d22 6f22 3e2e 3c2f 7370   class="o">.</sp
+0001c560: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+0001c570: 6e22 3e73 6f6c 7665 3c2f 7370 616e 3e3c  n">solve</span><
+0001c580: 7370 616e 2063 6c61 7373 3d22 7022 3e28  span class="p">(
+0001c590: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
+0001c5a0: 7373 3d22 6e22 3e48 3c2f 7370 616e 3e3c  ss="n">H</span><
+0001c5b0: 7370 616e 2063 6c61 7373 3d22 7022 3e2c  span class="p">,
+0001c5c0: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
+0001c5d0: 6173 733d 226f 223e 2d3c 2f73 7061 6e3e  ass="o">-</span>
+0001c5e0: 3c73 7061 6e20 636c 6173 733d 226e 223e  <span class="n">
+0001c5f0: 6772 6164 3c2f 7370 616e 3e3c 7370 616e  grad</span><span
+0001c600: 2063 6c61 7373 3d22 7022 3e29 3c2f 7370   class="p">)</sp
+0001c610: 616e 3e0a 2020 2020 2020 2020 2020 2020  an>.            
+0001c620: 3c73 7061 6e20 636c 6173 733d 226e 223e  <span class="n">
+0001c630: 6e65 7774 6f6e 5f64 6563 7265 6d65 6e74  newton_decrement
+0001c640: 5f73 7175 6172 653c 2f73 7061 6e3e 203c  _square</span> <
+0001c650: 7370 616e 2063 6c61 7373 3d22 6f22 3e3d  span class="o">=
+0001c660: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
+0001c670: 6173 733d 226e 223e 6e70 3c2f 7370 616e  ass="n">np</span
+0001c680: 3e3c 7370 616e 2063 6c61 7373 3d22 6f22  ><span class="o"
+0001c690: 3e2e 3c2f 7370 616e 3e3c 7370 616e 2063  >.</span><span c
+0001c6a0: 6c61 7373 3d22 6e22 3e73 756d 3c2f 7370  lass="n">sum</sp
+0001c6b0: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+0001c6c0: 7022 3e28 3c2f 7370 616e 3e3c 7370 616e  p">(</span><span
+0001c6d0: 2063 6c61 7373 3d22 6f22 3e2d 3c2f 7370   class="o">-</sp
+0001c6e0: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+0001c6f0: 6e22 3e67 7261 643c 2f73 7061 6e3e 203c  n">grad</span> <
+0001c700: 7370 616e 2063 6c61 7373 3d22 6f22 3e2a  span class="o">*
+0001c710: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
+0001c720: 6173 733d 226e 223e 6e65 7774 6f6e 5f64  ass="n">newton_d
+0001c730: 6972 6563 7469 6f6e 3c2f 7370 616e 3e3c  irection</span><
+0001c740: 7370 616e 2063 6c61 7373 3d22 7022 3e29  span class="p">)
+0001c750: 3c2f 7370 616e 3e0a 0a20 2020 2020 2020  </span>..       
+0001c760: 203c 7370 616e 2063 6c61 7373 3d22 6b22   <span class="k"
+0001c770: 3e69 663c 2f73 7061 6e3e 203c 7370 616e  >if</span> <span
+0001c780: 2063 6c61 7373 3d22 6e22 3e76 6572 626f   class="n">verbo
+0001c790: 7365 3c2f 7370 616e 3e3c 7370 616e 2063  se</span><span c
+0001c7a0: 6c61 7373 3d22 7022 3e3a 3c2f 7370 616e  lass="p">:</span
+0001c7b0: 3e0a 2020 2020 2020 2020 2020 2020 3c73  >.            <s
+0001c7c0: 7061 6e20 636c 6173 733d 226e 6222 3e70  pan class="nb">p
+0001c7d0: 7269 6e74 3c2f 7370 616e 3e3c 7370 616e  rint</span><span
+0001c7e0: 2063 6c61 7373 3d22 7022 3e28 3c2f 7370   class="p">(</sp
+0001c7f0: 616e 3e0a 2020 2020 2020 2020 2020 2020  an>.            
+0001c800: 2020 2020 3c73 7061 6e20 636c 6173 733d      <span class=
+0001c810: 2273 6122 3e66 3c2f 7370 616e 3e3c 7370  "sa">f</span><sp
+0001c820: 616e 2063 6c61 7373 3d22 7332 223e 2671  an class="s2">&q
+0001c830: 756f 743b 4174 2069 7465 7261 7465 203c  uot;At iterate <
+0001c840: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
+0001c850: 733d 2273 6922 3e7b 3c2f 7370 616e 3e3c  s="si">{</span><
+0001c860: 7370 616e 2063 6c61 7373 3d22 6e22 3e69  span class="n">i
+0001c870: 6e64 785f 6974 6572 3c2f 7370 616e 3e3c  ndx_iter</span><
+0001c880: 7370 616e 2063 6c61 7373 3d22 7369 223e  span class="si">
+0001c890: 3a3c 2f73 7061 6e3e 3c73 7061 6e20 636c  :</span><span cl
+0001c8a0: 6173 733d 2273 3222 3e34 643c 2f73 7061  ass="s2">4d</spa
+0001c8b0: 6e3e 3c73 7061 6e20 636c 6173 733d 2273  n><span class="s
+0001c8c0: 6922 3e7d 3c2f 7370 616e 3e3c 7370 616e  i">}</span><span
+0001c8d0: 2063 6c61 7373 3d22 7332 223e 3b20 663d   class="s2">; f=
+0001c8e0: 203c 2f73 7061 6e3e 3c73 7061 6e20 636c   </span><span cl
+0001c8f0: 6173 733d 2273 6922 3e7b 3c2f 7370 616e  ass="si">{</span
+0001c900: 3e3c 7370 616e 2063 6c61 7373 3d22 6e22  ><span class="n"
+0001c910: 3e6c 6f73 733c 2f73 7061 6e3e 3c73 7061  >loss</span><spa
+0001c920: 6e20 636c 6173 733d 226f 223e 2e3c 2f73  n class="o">.</s
+0001c930: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
+0001c940: 226e 223e 6974 656d 3c2f 7370 616e 3e3c  "n">item</span><
+0001c950: 7370 616e 2063 6c61 7373 3d22 7022 3e28  span class="p">(
+0001c960: 293c 2f73 7061 6e3e 3c73 7061 6e20 636c  )</span><span cl
+0001c970: 6173 733d 2273 6922 3e3a 3c2f 7370 616e  ass="si">:</span
+0001c980: 3e3c 7370 616e 2063 6c61 7373 3d22 7332  ><span class="s2
+0001c990: 223e 2e35 453c 2f73 7061 6e3e 3c73 7061  ">.5E</span><spa
+0001c9a0: 6e20 636c 6173 733d 2273 6922 3e7d 3c2f  n class="si">}</
+0001c9b0: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+0001c9c0: 3d22 7332 223e 3b26 7175 6f74 3b3c 2f73  ="s2">;&quot;</s
+0001c9d0: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
+0001c9e0: 2270 223e 2c3c 2f73 7061 6e3e 0a20 2020  "p">,</span>.   
+0001c9f0: 2020 2020 2020 2020 2020 2020 203c 7370               <sp
+0001ca00: 616e 2063 6c61 7373 3d22 7361 223e 663c  an class="sa">f<
+0001ca10: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
+0001ca20: 733d 2273 3222 3e26 7175 6f74 3b7c 312f  s="s2">&quot;|1/
+0001ca30: 322a 4e65 7774 6f6e 5f64 6563 7265 6d65  2*Newton_decreme
+0001ca40: 6e74 5e32 7c3a 203c 2f73 7061 6e3e 3c73  nt^2|: </span><s
+0001ca50: 7061 6e20 636c 6173 733d 2273 6922 3e7b  pan class="si">{
+0001ca60: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
+0001ca70: 7373 3d22 6e22 3e6e 6577 746f 6e5f 6465  ss="n">newton_de
+0001ca80: 6372 656d 656e 745f 7371 7561 7265 3c2f  crement_square</
+0001ca90: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+0001caa0: 3d22 6f22 3e2e 3c2f 7370 616e 3e3c 7370  ="o">.</span><sp
+0001cab0: 616e 2063 6c61 7373 3d22 6e22 3e69 7465  an class="n">ite
+0001cac0: 6d3c 2f73 7061 6e3e 3c73 7061 6e20 636c  m</span><span cl
+0001cad0: 6173 733d 2270 223e 2829 3c2f 7370 616e  ass="p">()</span
+0001cae0: 3e3c 7370 616e 2063 6c61 7373 3d22 6f22  ><span class="o"
+0001caf0: 3e2f 3c2f 7370 616e 3e3c 7370 616e 2063  >/</span><span c
+0001cb00: 6c61 7373 3d22 6d69 223e 323c 2f73 7061  lass="mi">2</spa
+0001cb10: 6e3e 3c73 7061 6e20 636c 6173 733d 2273  n><span class="s
+0001cb20: 6922 3e3a 3c2f 7370 616e 3e3c 7370 616e  i">:</span><span
+0001cb30: 2063 6c61 7373 3d22 7332 223e 2e35 453c   class="s2">.5E<
+0001cb40: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
+0001cb50: 733d 2273 6922 3e7d 3c2f 7370 616e 3e3c  s="si">}</span><
+0001cb60: 7370 616e 2063 6c61 7373 3d22 7365 223e  span class="se">
+0001cb70: 5c6e 3c2f 7370 616e 3e3c 7370 616e 2063  \n</span><span c
+0001cb80: 6c61 7373 3d22 7332 223e 2671 756f 743b  lass="s2">&quot;
+0001cb90: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
+0001cba0: 7373 3d22 7022 3e2c 3c2f 7370 616e 3e0a  ss="p">,</span>.
+0001cbb0: 2020 2020 2020 2020 2020 2020 3c73 7061              <spa
+0001cbc0: 6e20 636c 6173 733d 2270 223e 293c 2f73  n class="p">)</s
+0001cbd0: 7061 6e3e 0a0a 2020 2020 2020 2020 3c73  pan>..        <s
+0001cbe0: 7061 6e20 636c 6173 733d 226b 223e 6966  pan class="k">if
+0001cbf0: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
+0001cc00: 6173 733d 226e 223e 6e65 7774 6f6e 5f64  ass="n">newton_d
+0001cc10: 6563 7265 6d65 6e74 5f73 7175 6172 653c  ecrement_square<
+0001cc20: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
+0001cc30: 7373 3d22 6f22 3e2f 3c2f 7370 616e 3e20  ss="o">/</span> 
+0001cc40: 3c73 7061 6e20 636c 6173 733d 226d 6622  <span class="mf"
+0001cc50: 3e32 2e30 3c2f 7370 616e 3e20 3c73 7061  >2.0</span> <spa
+0001cc60: 6e20 636c 6173 733d 226f 223e 266c 743b  n class="o">&lt;
+0001cc70: 3d3c 2f73 7061 6e3e 203c 7370 616e 2063  =</span> <span c
+0001cc80: 6c61 7373 3d22 6e22 3e65 7073 3c2f 7370  lass="n">eps</sp
+0001cc90: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+0001cca0: 7022 3e3a 3c2f 7370 616e 3e0a 2020 2020  p">:</span>.    
+0001ccb0: 2020 2020 2020 2020 3c73 7061 6e20 636c          <span cl
+0001ccc0: 6173 733d 226b 223e 6272 6561 6b3c 2f73  ass="k">break</s
+0001ccd0: 7061 6e3e 0a0a 2020 2020 2020 2020 3c73  pan>..        <s
+0001cce0: 7061 6e20 636c 6173 733d 2263 3122 3e23  pan class="c1">#
+0001ccf0: 2320 6261 636b 7472 6163 6b69 6e67 206c  # backtracking l
+0001cd00: 696e 6520 7365 6172 6368 3c2f 7370 616e  ine search</span
+0001cd10: 3e0a 2020 2020 2020 2020 3c73 7061 6e20  >.        <span 
+0001cd20: 636c 6173 733d 226e 223e 6d61 785f 6c73  class="n">max_ls
+0001cd30: 5f69 7465 723c 2f73 7061 6e3e 203c 7370  _iter</span> <sp
+0001cd40: 616e 2063 6c61 7373 3d22 6f22 3e3d 3c2f  an class="o">=</
+0001cd50: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
+0001cd60: 733d 226d 6922 3e31 3030 3c2f 7370 616e  s="mi">100</span
+0001cd70: 3e0a 2020 2020 2020 2020 3c73 7061 6e20  >.        <span 
+0001cd80: 636c 6173 733d 226e 223e 7374 6570 5f73  class="n">step_s
+0001cd90: 697a 653c 2f73 7061 6e3e 203c 7370 616e  ize</span> <span
+0001cda0: 2063 6c61 7373 3d22 6f22 3e3d 3c2f 7370   class="o">=</sp
+0001cdb0: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
+0001cdc0: 226d 6622 3e31 2e30 3c2f 7370 616e 3e0a  "mf">1.0</span>.
+0001cdd0: 0a20 2020 2020 2020 203c 7370 616e 2063  .        <span c
+0001cde0: 6c61 7373 3d22 6e22 3e69 6e64 785f 6c73  lass="n">indx_ls
+0001cdf0: 5f69 7465 723c 2f73 7061 6e3e 203c 7370  _iter</span> <sp
+0001ce00: 616e 2063 6c61 7373 3d22 6f22 3e3d 3c2f  an class="o">=</
+0001ce10: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
+0001ce20: 733d 226d 6922 3e30 3c2f 7370 616e 3e0a  s="mi">0</span>.
+0001ce30: 2020 2020 2020 2020 3c73 7061 6e20 636c          <span cl
+0001ce40: 6173 733d 226b 223e 7768 696c 653c 2f73  ass="k">while</s
+0001ce50: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
+0001ce60: 3d22 6e22 3e69 6e64 785f 6c73 5f69 7465  ="n">indx_ls_ite
+0001ce70: 723c 2f73 7061 6e3e 203c 7370 616e 2063  r</span> <span c
+0001ce80: 6c61 7373 3d22 6f22 3e26 6c74 3b3c 2f73  lass="o">&lt;</s
+0001ce90: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
+0001cea0: 3d22 6e22 3e6d 6178 5f6c 735f 6974 6572  ="n">max_ls_iter
+0001ceb0: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
+0001cec0: 7373 3d22 7022 3e3a 3c2f 7370 616e 3e0a  ss="p">:</span>.
+0001ced0: 2020 2020 2020 2020 2020 2020 3c73 7061              <spa
+0001cee0: 6e20 636c 6173 733d 226e 223e 7461 7267  n class="n">targ
+0001cef0: 6574 5f6c 6f73 733c 2f73 7061 6e3e 3c73  et_loss</span><s
+0001cf00: 7061 6e20 636c 6173 733d 2270 223e 2c3c  pan class="p">,<
+0001cf10: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
+0001cf20: 7373 3d22 6e22 3e5f 3c2f 7370 616e 3e20  ss="n">_</span> 
+0001cf30: 3c73 7061 6e20 636c 6173 733d 226f 223e  <span class="o">
+0001cf40: 3d3c 2f73 7061 6e3e 203c 7370 616e 2063  =</span> <span c
+0001cf50: 6c61 7373 3d22 6e22 3e66 3c2f 7370 616e  lass="n">f</span
+0001cf60: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
+0001cf70: 3e28 3c2f 7370 616e 3e3c 7370 616e 2063  >(</span><span c
+0001cf80: 6c61 7373 3d22 6e22 3e78 3c2f 7370 616e  lass="n">x</span
+0001cf90: 3e20 3c73 7061 6e20 636c 6173 733d 226f  > <span class="o
+0001cfa0: 223e 2b3c 2f73 7061 6e3e 203c 7370 616e  ">+</span> <span
+0001cfb0: 2063 6c61 7373 3d22 6e22 3e73 7465 705f   class="n">step_
+0001cfc0: 7369 7a65 3c2f 7370 616e 3e20 3c73 7061  size</span> <spa
+0001cfd0: 6e20 636c 6173 733d 226f 223e 2a3c 2f73  n class="o">*</s
+0001cfe0: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
+0001cff0: 3d22 6e22 3e6e 6577 746f 6e5f 6469 7265  ="n">newton_dire
+0001d000: 6374 696f 6e3c 2f73 7061 6e3e 3c73 7061  ction</span><spa
+0001d010: 6e20 636c 6173 733d 2270 223e 2c3c 2f73  n class="p">,</s
+0001d020: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
+0001d030: 3d22 6f22 3e2a 3c2f 7370 616e 3e3c 7370  ="o">*</span><sp
+0001d040: 616e 2063 6c61 7373 3d22 6e22 3e61 7267  an class="n">arg
+0001d050: 733c 2f73 7061 6e3e 3c73 7061 6e20 636c  s</span><span cl
+0001d060: 6173 733d 2270 223e 293c 2f73 7061 6e3e  ass="p">)</span>
+0001d070: 0a0a 2020 2020 2020 2020 2020 2020 3c73  ..            <s
+0001d080: 7061 6e20 636c 6173 733d 226e 223e 4e5f  pan class="n">N_
+0001d090: 6675 6e63 3c2f 7370 616e 3e20 3c73 7061  func</span> <spa
+0001d0a0: 6e20 636c 6173 733d 226f 223e 2b3d 3c2f  n class="o">+=</
+0001d0b0: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
+0001d0c0: 733d 226d 6922 3e31 3c2f 7370 616e 3e0a  s="mi">1</span>.
+0001d0d0: 2020 2020 2020 2020 2020 2020 3c73 7061              <spa
+0001d0e0: 6e20 636c 6173 733d 226e 223e 6170 7072  n class="n">appr
+0001d0f0: 6f78 696d 6174 655f 6c6f 7373 3c2f 7370  oximate_loss</sp
+0001d100: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
+0001d110: 226f 223e 3d3c 2f73 7061 6e3e 203c 7370  "o">=</span> <sp
+0001d120: 616e 2063 6c61 7373 3d22 6e22 3e6c 6f73  an class="n">los
+0001d130: 733c 2f73 7061 6e3e 203c 7370 616e 2063  s</span> <span c
+0001d140: 6c61 7373 3d22 6f22 3e2b 3c2f 7370 616e  lass="o">+</span
+0001d150: 3e20 3c73 7061 6e20 636c 6173 733d 226e  > <span class="n
+0001d160: 223e 7374 6570 5f73 697a 653c 2f73 7061  ">step_size</spa
+0001d170: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
+0001d180: 6f22 3e2a 3c2f 7370 616e 3e20 3c73 7061  o">*</span> <spa
+0001d190: 6e20 636c 6173 733d 226e 223e 616c 7068  n class="n">alph
+0001d1a0: 613c 2f73 7061 6e3e 203c 7370 616e 2063  a</span> <span c
+0001d1b0: 6c61 7373 3d22 6f22 3e2a 3c2f 7370 616e  lass="o">*</span
+0001d1c0: 3e20 3c73 7061 6e20 636c 6173 733d 2270  > <span class="p
+0001d1d0: 223e 283c 2f73 7061 6e3e 3c73 7061 6e20  ">(</span><span 
+0001d1e0: 636c 6173 733d 226f 223e 2d3c 2f73 7061  class="o">-</spa
+0001d1f0: 6e3e 3c73 7061 6e20 636c 6173 733d 226e  n><span class="n
+0001d200: 223e 6e65 7774 6f6e 5f64 6563 7265 6d65  ">newton_decreme
+0001d210: 6e74 5f73 7175 6172 653c 2f73 7061 6e3e  nt_square</span>
+0001d220: 3c73 7061 6e20 636c 6173 733d 2270 223e  <span class="p">
+0001d230: 293c 2f73 7061 6e3e 0a20 2020 2020 2020  )</span>.       
+0001d240: 2020 2020 203c 7370 616e 2063 6c61 7373       <span class
+0001d250: 3d22 6b22 3e69 663c 2f73 7061 6e3e 203c  ="k">if</span> <
+0001d260: 7370 616e 2063 6c61 7373 3d22 6e22 3e74  span class="n">t
+0001d270: 6172 6765 745f 6c6f 7373 3c2f 7370 616e  arget_loss</span
+0001d280: 3e20 3c73 7061 6e20 636c 6173 733d 226f  > <span class="o
+0001d290: 223e 266c 743b 3c2f 7370 616e 3e20 3c73  ">&lt;</span> <s
+0001d2a0: 7061 6e20 636c 6173 733d 226e 223e 6170  pan class="n">ap
+0001d2b0: 7072 6f78 696d 6174 655f 6c6f 7373 3c2f  proximate_loss</
+0001d2c0: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+0001d2d0: 3d22 7022 3e3a 3c2f 7370 616e 3e0a 2020  ="p">:</span>.  
+0001d2e0: 2020 2020 2020 2020 2020 2020 2020 3c73                <s
+0001d2f0: 7061 6e20 636c 6173 733d 226b 223e 6272  pan class="k">br
+0001d300: 6561 6b3c 2f73 7061 6e3e 0a20 2020 2020  eak</span>.     
+0001d310: 2020 2020 2020 203c 7370 616e 2063 6c61         <span cla
+0001d320: 7373 3d22 6b22 3e65 6c73 653c 2f73 7061  ss="k">else</spa
+0001d330: 6e3e 3c73 7061 6e20 636c 6173 733d 2270  n><span class="p
+0001d340: 223e 3a3c 2f73 7061 6e3e 0a20 2020 2020  ">:</span>.     
+0001d350: 2020 2020 2020 2020 2020 203c 7370 616e             <span
+0001d360: 2063 6c61 7373 3d22 6e22 3e73 7465 705f   class="n">step_
+0001d370: 7369 7a65 3c2f 7370 616e 3e20 3c73 7061  size</span> <spa
+0001d380: 6e20 636c 6173 733d 226f 223e 3d3c 2f73  n class="o">=</s
+0001d390: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
+0001d3a0: 3d22 6e22 3e73 7465 705f 7369 7a65 3c2f  ="n">step_size</
+0001d3b0: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
+0001d3c0: 733d 226f 223e 2a3c 2f73 7061 6e3e 203c  s="o">*</span> <
+0001d3d0: 7370 616e 2063 6c61 7373 3d22 6e22 3e62  span class="n">b
+0001d3e0: 6574 613c 2f73 7061 6e3e 0a20 2020 2020  eta</span>.     
+0001d3f0: 2020 2020 2020 203c 7370 616e 2063 6c61         <span cla
+0001d400: 7373 3d22 6e22 3e69 6e64 785f 6c73 5f69  ss="n">indx_ls_i
+0001d410: 7465 723c 2f73 7061 6e3e 203c 7370 616e  ter</span> <span
+0001d420: 2063 6c61 7373 3d22 6f22 3e2b 3d3c 2f73   class="o">+=</s
+0001d430: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
+0001d440: 3d22 6d69 223e 313c 2f73 7061 6e3e 0a0a  ="mi">1</span>..
+0001d450: 2020 2020 2020 2020 3c73 7061 6e20 636c          <span cl
+0001d460: 6173 733d 226e 223e 783c 2f73 7061 6e3e  ass="n">x</span>
+0001d470: 203c 7370 616e 2063 6c61 7373 3d22 6f22   <span class="o"
+0001d480: 3e3d 3c2f 7370 616e 3e20 3c73 7061 6e20  >=</span> <span 
+0001d490: 636c 6173 733d 226e 223e 783c 2f73 7061  class="n">x</spa
+0001d4a0: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
+0001d4b0: 6f22 3e2b 3c2f 7370 616e 3e20 3c73 7061  o">+</span> <spa
+0001d4c0: 6e20 636c 6173 733d 226e 223e 7374 6570  n class="n">step
+0001d4d0: 5f73 697a 653c 2f73 7061 6e3e 203c 7370  _size</span> <sp
+0001d4e0: 616e 2063 6c61 7373 3d22 6f22 3e2a 3c2f  an class="o">*</
+0001d4f0: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
+0001d500: 733d 226e 223e 6e65 7774 6f6e 5f64 6972  s="n">newton_dir
+0001d510: 6563 7469 6f6e 3c2f 7370 616e 3e0a 2020  ection</span>.  
+0001d520: 2020 2020 2020 3c73 7061 6e20 636c 6173        <span clas
+0001d530: 733d 226e 223e 696e 6478 5f69 7465 723c  s="n">indx_iter<
+0001d540: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
+0001d550: 7373 3d22 6f22 3e2b 3d3c 2f73 7061 6e3e  ss="o">+=</span>
+0001d560: 203c 7370 616e 2063 6c61 7373 3d22 6d69   <span class="mi
+0001d570: 223e 313c 2f73 7061 6e3e 0a0a 2020 2020  ">1</span>..    
+0001d580: 3c73 7061 6e20 636c 6173 733d 226b 223e  <span class="k">
+0001d590: 6966 3c2f 7370 616e 3e20 3c73 7061 6e20  if</span> <span 
+0001d5a0: 636c 6173 733d 226e 223e 7665 7262 6f73  class="n">verbos
+0001d5b0: 653c 2f73 7061 6e3e 3c73 7061 6e20 636c  e</span><span cl
+0001d5c0: 6173 733d 2270 223e 3a3c 2f73 7061 6e3e  ass="p">:</span>
+0001d5d0: 0a20 2020 2020 2020 203c 7370 616e 2063  .        <span c
+0001d5e0: 6c61 7373 3d22 6e62 223e 7072 696e 743c  lass="nb">print<
+0001d5f0: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
+0001d600: 733d 2270 223e 283c 2f73 7061 6e3e 3c73  s="p">(</span><s
+0001d610: 7061 6e20 636c 6173 733d 2273 3222 3e26  pan class="s2">&
+0001d620: 7175 6f74 3b4e 5f69 7465 7220 2020 3d20  quot;N_iter   = 
+0001d630: 746f 7461 6c20 6e75 6d62 6572 206f 6620  total number of 
+0001d640: 6974 6572 6174 696f 6e73 2671 756f 743b  iterations&quot;
+0001d650: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
+0001d660: 7373 3d22 7022 3e29 3c2f 7370 616e 3e0a  ss="p">)</span>.
+0001d670: 2020 2020 2020 2020 3c73 7061 6e20 636c          <span cl
+0001d680: 6173 733d 226e 6222 3e70 7269 6e74 3c2f  ass="nb">print</
+0001d690: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+0001d6a0: 3d22 7022 3e28 3c2f 7370 616e 3e3c 7370  ="p">(</span><sp
+0001d6b0: 616e 2063 6c61 7373 3d22 7332 223e 2671  an class="s2">&q
+0001d6c0: 756f 743b 4e5f 6675 6e63 2020 203d 2074  uot;N_func   = t
+0001d6d0: 6f74 616c 206e 756d 6265 7220 6f66 2066  otal number of f
+0001d6e0: 756e 6374 696f 6e20 616e 6420 6772 6164  unction and grad
+0001d6f0: 6965 6e74 2065 7661 6c75 6174 696f 6e73  ient evaluations
+0001d700: 2671 756f 743b 3c2f 7370 616e 3e3c 7370  &quot;</span><sp
+0001d710: 616e 2063 6c61 7373 3d22 7022 3e29 3c2f  an class="p">)</
+0001d720: 7370 616e 3e0a 2020 2020 2020 2020 3c73  span>.        <s
+0001d730: 7061 6e20 636c 6173 733d 226e 6222 3e70  pan class="nb">p
+0001d740: 7269 6e74 3c2f 7370 616e 3e3c 7370 616e  rint</span><span
+0001d750: 2063 6c61 7373 3d22 7022 3e28 3c2f 7370   class="p">(</sp
+0001d760: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+0001d770: 7332 223e 2671 756f 743b 4620 2020 2020  s2">&quot;F     
+0001d780: 2020 203d 2066 696e 616c 2066 756e 6374     = final funct
+0001d790: 696f 6e20 7661 6c75 6520 3c2f 7370 616e  ion value </span
+0001d7a0: 3e3c 7370 616e 2063 6c61 7373 3d22 7365  ><span class="se
+0001d7b0: 223e 5c6e 3c2f 7370 616e 3e3c 7370 616e  ">\n</span><span
+0001d7c0: 2063 6c61 7373 3d22 7332 223e 2671 756f   class="s2">&quo
+0001d7d0: 743b 3c2f 7370 616e 3e3c 7370 616e 2063  t;</span><span c
+0001d7e0: 6c61 7373 3d22 7022 3e29 3c2f 7370 616e  lass="p">)</span
+0001d7f0: 3e0a 2020 2020 2020 2020 3c73 7061 6e20  >.        <span 
+0001d800: 636c 6173 733d 226e 6222 3e70 7269 6e74  class="nb">print
+0001d810: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
+0001d820: 7373 3d22 7022 3e28 3c2f 7370 616e 3e3c  ss="p">(</span><
+0001d830: 7370 616e 2063 6c61 7373 3d22 7332 223e  span class="s2">
+0001d840: 2671 756f 743b 2020 2020 2020 2020 2020  &quot;          
+0001d850: 2020 202a 202a 202a 2020 2020 203c 2f73     * * *     </s
+0001d860: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
+0001d870: 2273 6522 3e5c 6e3c 2f73 7061 6e3e 3c73  "se">\n</span><s
+0001d880: 7061 6e20 636c 6173 733d 2273 3222 3e26  pan class="s2">&
+0001d890: 7175 6f74 3b3c 2f73 7061 6e3e 3c73 7061  quot;</span><spa
+0001d8a0: 6e20 636c 6173 733d 2270 223e 293c 2f73  n class="p">)</s
+0001d8b0: 7061 6e3e 0a20 2020 2020 2020 203c 7370  pan>.        <sp
+0001d8c0: 616e 2063 6c61 7373 3d22 6e62 223e 7072  an class="nb">pr
+0001d8d0: 696e 743c 2f73 7061 6e3e 3c73 7061 6e20  int</span><span 
+0001d8e0: 636c 6173 733d 2270 223e 283c 2f73 7061  class="p">(</spa
+0001d8f0: 6e3e 3c73 7061 6e20 636c 6173 733d 2273  n><span class="s
+0001d900: 3222 3e26 7175 6f74 3b4e 5f69 7465 7220  2">&quot;N_iter 
+0001d910: 2020 204e 5f66 756e 6320 2020 2020 2020     N_func       
+0001d920: 2046 2671 756f 743b 3c2f 7370 616e 3e3c   F&quot;</span><
+0001d930: 7370 616e 2063 6c61 7373 3d22 7022 3e29  span class="p">)
+0001d940: 3c2f 7370 616e 3e0a 2020 2020 2020 2020  </span>.        
+0001d950: 3c73 7061 6e20 636c 6173 733d 226e 6222  <span class="nb"
+0001d960: 3e70 7269 6e74 3c2f 7370 616e 3e3c 7370  >print</span><sp
+0001d970: 616e 2063 6c61 7373 3d22 7022 3e28 3c2f  an class="p">(</
+0001d980: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+0001d990: 3d22 7361 223e 663c 2f73 7061 6e3e 3c73  ="sa">f</span><s
+0001d9a0: 7061 6e20 636c 6173 733d 2273 3222 3e26  pan class="s2">&
+0001d9b0: 7175 6f74 3b3c 2f73 7061 6e3e 3c73 7061  quot;</span><spa
+0001d9c0: 6e20 636c 6173 733d 2273 6922 3e7b 3c2f  n class="si">{</
 0001d9d0: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
-0001d9e0: 3d22 7332 223e 3664 3c2f 7370 616e 3e3c  ="s2">6d</span><
-0001d9f0: 7370 616e 2063 6c61 7373 3d22 7369 223e  span class="si">
-0001da00: 7d3c 2f73 7061 6e3e 3c73 7061 6e20 636c  }</span><span cl
-0001da10: 6173 733d 2273 3222 3e20 2020 203c 2f73  ass="s2">    </s
-0001da20: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
-0001da30: 2273 6922 3e7b 3c2f 7370 616e 3e3c 7370  "si">{</span><sp
-0001da40: 616e 2063 6c61 7373 3d22 6e22 3e4e 5f66  an class="n">N_f
-0001da50: 756e 633c 2f73 7061 6e3e 3c73 7061 6e20  unc</span><span 
-0001da60: 636c 6173 733d 2273 6922 3e3a 3c2f 7370  class="si">:</sp
-0001da70: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-0001da80: 7332 223e 3664 3c2f 7370 616e 3e3c 7370  s2">6d</span><sp
-0001da90: 616e 2063 6c61 7373 3d22 7369 223e 7d3c  an class="si">}<
-0001daa0: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
-0001dab0: 733d 2273 3222 3e20 2020 203c 2f73 7061  s="s2">    </spa
-0001dac0: 6e3e 3c73 7061 6e20 636c 6173 733d 2273  n><span class="s
-0001dad0: 6922 3e7b 3c2f 7370 616e 3e3c 7370 616e  i">{</span><span
-0001dae0: 2063 6c61 7373 3d22 6e22 3e6c 6f73 733c   class="n">loss<
-0001daf0: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
-0001db00: 733d 226f 223e 2e3c 2f73 7061 6e3e 3c73  s="o">.</span><s
-0001db10: 7061 6e20 636c 6173 733d 226e 223e 6974  pan class="n">it
-0001db20: 656d 3c2f 7370 616e 3e3c 7370 616e 2063  em</span><span c
-0001db30: 6c61 7373 3d22 7022 3e28 293c 2f73 7061  lass="p">()</spa
-0001db40: 6e3e 3c73 7061 6e20 636c 6173 733d 2273  n><span class="s
-0001db50: 6922 3e3a 3c2f 7370 616e 3e3c 7370 616e  i">:</span><span
-0001db60: 2063 6c61 7373 3d22 7332 223e 2e36 453c   class="s2">.6E<
-0001db70: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
-0001db80: 733d 2273 6922 3e7d 3c2f 7370 616e 3e3c  s="si">}</span><
-0001db90: 7370 616e 2063 6c61 7373 3d22 7332 223e  span class="s2">
-0001dba0: 2671 756f 743b 3c2f 7370 616e 3e3c 7370  &quot;</span><sp
-0001dbb0: 616e 2063 6c61 7373 3d22 7022 3e29 3c2f  an class="p">)</
-0001dbc0: 7370 616e 3e0a 2020 2020 2020 2020 3c73  span>.        <s
-0001dbd0: 7061 6e20 636c 6173 733d 226e 6222 3e70  pan class="nb">p
-0001dbe0: 7269 6e74 3c2f 7370 616e 3e3c 7370 616e  rint</span><span
-0001dbf0: 2063 6c61 7373 3d22 7022 3e28 3c2f 7370   class="p">(</sp
-0001dc00: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
-0001dc10: 7361 223e 663c 2f73 7061 6e3e 3c73 7061  sa">f</span><spa
-0001dc20: 6e20 636c 6173 733d 2273 3222 3e26 7175  n class="s2">&qu
-0001dc30: 6f74 3b20 2046 203d 203c 2f73 7061 6e3e  ot;  F = </span>
-0001dc40: 3c73 7061 6e20 636c 6173 733d 2273 6922  <span class="si"
-0001dc50: 3e7b 3c2f 7370 616e 3e3c 7370 616e 2063  >{</span><span c
-0001dc60: 6c61 7373 3d22 6e22 3e6c 6f73 733c 2f73  lass="n">loss</s
-0001dc70: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
-0001dc80: 226f 223e 2e3c 2f73 7061 6e3e 3c73 7061  "o">.</span><spa
-0001dc90: 6e20 636c 6173 733d 226e 223e 6974 656d  n class="n">item
-0001dca0: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-0001dcb0: 7373 3d22 7022 3e28 293c 2f73 7061 6e3e  ss="p">()</span>
-0001dcc0: 3c73 7061 6e20 636c 6173 733d 2273 6922  <span class="si"
-0001dcd0: 3e3a 3c2f 7370 616e 3e3c 7370 616e 2063  >:</span><span c
-0001dce0: 6c61 7373 3d22 7332 223e 2e31 3266 3c2f  lass="s2">.12f</
-0001dcf0: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
-0001dd00: 3d22 7369 223e 7d3c 2f73 7061 6e3e 3c73  ="si">}</span><s
-0001dd10: 7061 6e20 636c 6173 733d 2273 3222 3e20  pan class="s2"> 
-0001dd20: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-0001dd30: 7373 3d22 7365 223e 5c6e 3c2f 7370 616e  ss="se">\n</span
-0001dd40: 3e3c 7370 616e 2063 6c61 7373 3d22 7332  ><span class="s2
-0001dd50: 223e 2671 756f 743b 3c2f 7370 616e 3e3c  ">&quot;</span><
-0001dd60: 7370 616e 2063 6c61 7373 3d22 7022 3e29  span class="p">)
-0001dd70: 3c2f 7370 616e 3e0a 0a20 2020 2020 2020  </span>..       
-0001dd80: 203c 7370 616e 2063 6c61 7373 3d22 6b22   <span class="k"
-0001dd90: 3e69 663c 2f73 7061 6e3e 203c 7370 616e  >if</span> <span
-0001dda0: 2063 6c61 7373 3d22 6e22 3e6e 6577 746f   class="n">newto
-0001ddb0: 6e5f 6465 6372 656d 656e 745f 7371 7561  n_decrement_squa
-0001ddc0: 7265 3c2f 7370 616e 3e20 3c73 7061 6e20  re</span> <span 
-0001ddd0: 636c 6173 733d 226f 223e 2f3c 2f73 7061  class="o">/</spa
-0001dde0: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
-0001ddf0: 6d66 223e 322e 303c 2f73 7061 6e3e 203c  mf">2.0</span> <
-0001de00: 7370 616e 2063 6c61 7373 3d22 6f22 3e26  span class="o">&
-0001de10: 6c74 3b3d 3c2f 7370 616e 3e20 3c73 7061  lt;=</span> <spa
-0001de20: 6e20 636c 6173 733d 226e 223e 6570 733c  n class="n">eps<
-0001de30: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
-0001de40: 7373 3d22 6f77 223e 616e 643c 2f73 7061  ss="ow">and</spa
-0001de50: 6e3e 203c 7370 616e 2063 6c61 7373 3d22  n> <span class="
-0001de60: 6e22 3e69 6e64 785f 6974 6572 3c2f 7370  n">indx_iter</sp
-0001de70: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
-0001de80: 226f 223e 266c 743b 3c2f 7370 616e 3e20  "o">&lt;</span> 
-0001de90: 3c73 7061 6e20 636c 6173 733d 226e 223e  <span class="n">
-0001dea0: 6d61 785f 6974 6572 3c2f 7370 616e 3e3c  max_iter</span><
-0001deb0: 7370 616e 2063 6c61 7373 3d22 7022 3e3a  span class="p">:
-0001dec0: 3c2f 7370 616e 3e0a 2020 2020 2020 2020  </span>.        
-0001ded0: 2020 2020 3c73 7061 6e20 636c 6173 733d      <span class=
-0001dee0: 226e 6222 3e70 7269 6e74 3c2f 7370 616e  "nb">print</span
-0001def0: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
-0001df00: 3e28 3c2f 7370 616e 3e3c 7370 616e 2063  >(</span><span c
-0001df10: 6c61 7373 3d22 7332 223e 2671 756f 743b  lass="s2">&quot;
-0001df20: 434f 4e56 4552 4745 4e43 453a 2031 2f32  CONVERGENCE: 1/2
-0001df30: 2a4e 6577 746f 6e5f 6465 6372 656d 656e  *Newton_decremen
-0001df40: 745e 3220 266c 743b 2045 5053 2671 756f  t^2 &lt; EPS&quo
-0001df50: 743b 3c2f 7370 616e 3e3c 7370 616e 2063  t;</span><span c
-0001df60: 6c61 7373 3d22 7022 3e29 3c2f 7370 616e  lass="p">)</span
-0001df70: 3e0a 2020 2020 2020 2020 3c73 7061 6e20  >.        <span 
-0001df80: 636c 6173 733d 226b 223e 656c 7365 3c2f  class="k">else</
-0001df90: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
-0001dfa0: 3d22 7022 3e3a 3c2f 7370 616e 3e0a 2020  ="p">:</span>.  
-0001dfb0: 2020 2020 2020 2020 2020 3c73 7061 6e20            <span 
-0001dfc0: 636c 6173 733d 226e 6222 3e70 7269 6e74  class="nb">print
-0001dfd0: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-0001dfe0: 7373 3d22 7022 3e28 3c2f 7370 616e 3e3c  ss="p">(</span><
-0001dff0: 7370 616e 2063 6c61 7373 3d22 7332 223e  span class="s2">
-0001e000: 2671 756f 743b 434f 4e56 4552 4745 4e43  &quot;CONVERGENC
-0001e010: 453a 204e 554d 5f4f 465f 4954 4552 4154  E: NUM_OF_ITERAT
-0001e020: 494f 4e20 5245 4143 4820 4d41 585f 4954  ION REACH MAX_IT
-0001e030: 4552 4154 494f 4e26 7175 6f74 3b3c 2f73  ERATION&quot;</s
-0001e040: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
-0001e050: 2270 223e 293c 2f73 7061 6e3e 0a0a 2020  "p">)</span>..  
-0001e060: 2020 3c73 7061 6e20 636c 6173 733d 226b    <span class="k
-0001e070: 223e 7265 7475 726e 3c2f 7370 616e 3e20  ">return</span> 
-0001e080: 3c73 7061 6e20 636c 6173 733d 2270 223e  <span class="p">
-0001e090: 7b3c 2f73 7061 6e3e 0a20 2020 2020 2020  {</span>.       
-0001e0a0: 203c 7370 616e 2063 6c61 7373 3d22 7332   <span class="s2
-0001e0b0: 223e 2671 756f 743b 7826 7175 6f74 3b3c  ">&quot;x&quot;<
-0001e0c0: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
-0001e0d0: 733d 2270 223e 3a3c 2f73 7061 6e3e 203c  s="p">:</span> <
-0001e0e0: 7370 616e 2063 6c61 7373 3d22 6e22 3e78  span class="n">x
-0001e0f0: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
-0001e100: 7373 3d22 7022 3e2c 3c2f 7370 616e 3e0a  ss="p">,</span>.
-0001e110: 2020 2020 2020 2020 3c73 7061 6e20 636c          <span cl
-0001e120: 6173 733d 2273 3222 3e26 7175 6f74 3b4e  ass="s2">&quot;N
-0001e130: 5f69 7465 7226 7175 6f74 3b3c 2f73 7061  _iter&quot;</spa
-0001e140: 6e3e 3c73 7061 6e20 636c 6173 733d 2270  n><span class="p
-0001e150: 223e 3a3c 2f73 7061 6e3e 203c 7370 616e  ">:</span> <span
-0001e160: 2063 6c61 7373 3d22 6e22 3e69 6e64 785f   class="n">indx_
-0001e170: 6974 6572 3c2f 7370 616e 3e20 3c73 7061  iter</span> <spa
-0001e180: 6e20 636c 6173 733d 226f 223e 2b3c 2f73  n class="o">+</s
-0001e190: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
-0001e1a0: 3d22 6d69 223e 313c 2f73 7061 6e3e 3c73  ="mi">1</span><s
-0001e1b0: 7061 6e20 636c 6173 733d 2270 223e 2c3c  pan class="p">,<
-0001e1c0: 2f73 7061 6e3e 0a20 2020 2020 2020 203c  /span>.        <
-0001e1d0: 7370 616e 2063 6c61 7373 3d22 7332 223e  span class="s2">
-0001e1e0: 2671 756f 743b 4e5f 6675 6e63 2671 756f  &quot;N_func&quo
-0001e1f0: 743b 3c2f 7370 616e 3e3c 7370 616e 2063  t;</span><span c
-0001e200: 6c61 7373 3d22 7022 3e3a 3c2f 7370 616e  lass="p">:</span
-0001e210: 3e20 3c73 7061 6e20 636c 6173 733d 226e  > <span class="n
-0001e220: 223e 4e5f 6675 6e63 3c2f 7370 616e 3e3c  ">N_func</span><
-0001e230: 7370 616e 2063 6c61 7373 3d22 7022 3e2c  span class="p">,
-0001e240: 3c2f 7370 616e 3e0a 2020 2020 2020 2020  </span>.        
-0001e250: 3c73 7061 6e20 636c 6173 733d 2273 3222  <span class="s2"
-0001e260: 3e26 7175 6f74 3b46 2671 756f 743b 3c2f  >&quot;F&quot;</
-0001e270: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
-0001e280: 3d22 7022 3e3a 3c2f 7370 616e 3e20 3c73  ="p">:</span> <s
-0001e290: 7061 6e20 636c 6173 733d 226e 223e 6c6f  pan class="n">lo
-0001e2a0: 7373 3c2f 7370 616e 3e3c 7370 616e 2063  ss</span><span c
-0001e2b0: 6c61 7373 3d22 6f22 3e2e 3c2f 7370 616e  lass="o">.</span
-0001e2c0: 3e3c 7370 616e 2063 6c61 7373 3d22 6e22  ><span class="n"
-0001e2d0: 3e69 7465 6d3c 2f73 7061 6e3e 3c73 7061  >item</span><spa
-0001e2e0: 6e20 636c 6173 733d 2270 223e 2829 2c3c  n class="p">(),<
-0001e2f0: 2f73 7061 6e3e 0a20 2020 2020 2020 203c  /span>.        <
-0001e300: 7370 616e 2063 6c61 7373 3d22 7332 223e  span class="s2">
-0001e310: 2671 756f 743b 6861 6c66 5f6e 6577 746f  &quot;half_newto
-0001e320: 6e5f 6465 6372 656d 656e 745f 7371 7561  n_decrement_squa
-0001e330: 7265 2671 756f 743b 3c2f 7370 616e 3e3c  re&quot;</span><
-0001e340: 7370 616e 2063 6c61 7373 3d22 7022 3e3a  span class="p">:
-0001e350: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
-0001e360: 6173 733d 226e 223e 6e65 7774 6f6e 5f64  ass="n">newton_d
-0001e370: 6563 7265 6d65 6e74 5f73 7175 6172 653c  ecrement_square<
-0001e380: 2f73 7061 6e3e 203c 7370 616e 2063 6c61  /span> <span cla
-0001e390: 7373 3d22 6f22 3e2f 3c2f 7370 616e 3e20  ss="o">/</span> 
-0001e3a0: 3c73 7061 6e20 636c 6173 733d 226d 6622  <span class="mf"
-0001e3b0: 3e32 2e30 3c2f 7370 616e 3e3c 7370 616e  >2.0</span><span
-0001e3c0: 2063 6c61 7373 3d22 7022 3e2c 3c2f 7370   class="p">,</sp
-0001e3d0: 616e 3e0a 2020 2020 3c73 7061 6e20 636c  an>.    <span cl
-0001e3e0: 6173 733d 2270 223e 7d3c 2f73 7061 6e3e  ass="p">}</span>
-0001e3f0: 0a3c 2f70 7265 3e3c 2f64 6976 3e0a 0a20  .</pre></div>.. 
-0001e400: 2020 2020 2020 2020 2020 2020 2020 203c                 <
-0001e410: 2f61 7274 6963 6c65 3e0a 2020 2020 2020  /article>.      
-0001e420: 2020 2020 2020 2020 0a0a 2020 2020 2020          ..      
-0001e430: 2020 2020 2020 2020 0a20 2020 2020 2020          .       
-0001e440: 2020 2020 2020 200a 2020 2020 2020 2020         .        
-0001e450: 2020 2020 2020 2020 3c66 6f6f 7465 7220          <footer 
-0001e460: 636c 6173 733d 2262 642d 666f 6f74 6572  class="bd-footer
-0001e470: 2d61 7274 6963 6c65 223e 0a20 2020 2020  -article">.     
-0001e480: 2020 2020 2020 2020 2020 2020 200a 3c64               .<d
-0001e490: 6976 2063 6c61 7373 3d22 666f 6f74 6572  iv class="footer
-0001e4a0: 2d61 7274 6963 6c65 2d69 7465 6d73 2066  -article-items f
-0001e4b0: 6f6f 7465 722d 6172 7469 636c 655f 5f69  ooter-article__i
-0001e4c0: 6e6e 6572 223e 0a20 200a 2020 2020 3c64  nner">.  .    <d
-0001e4d0: 6976 2063 6c61 7373 3d22 666f 6f74 6572  iv class="footer
-0001e4e0: 2d61 7274 6963 6c65 2d69 7465 6d22 3e3c  -article-item"><
-0001e4f0: 212d 2d20 5072 6576 696f 7573 202f 206e  !-- Previous / n
-0001e500: 6578 7420 6275 7474 6f6e 7320 2d2d 3e0a  ext buttons -->.
-0001e510: 3c64 6976 2063 6c61 7373 3d22 7072 6576  <div class="prev
-0001e520: 2d6e 6578 742d 6172 6561 223e 0a3c 2f64  -next-area">.</d
-0001e530: 6976 3e3c 2f64 6976 3e0a 2020 0a3c 2f64  iv></div>.  .</d
-0001e540: 6976 3e0a 0a20 2020 2020 2020 2020 2020  iv>..           
-0001e550: 2020 2020 203c 2f66 6f6f 7465 723e 0a20       </footer>. 
-0001e560: 2020 2020 2020 2020 2020 2020 200a 2020               .  
-0001e570: 2020 2020 2020 2020 2020 3c2f 6469 763e            </div>
-0001e580: 0a20 2020 2020 2020 2020 2020 200a 2020  .            .  
-0001e590: 2020 2020 2020 2020 2020 0a20 2020 2020            .     
-0001e5a0: 2020 2020 2020 2020 200a 2020 2020 2020           .      
-0001e5b0: 2020 2020 2020 0a20 2020 2020 2020 2020        .         
-0001e5c0: 203c 2f64 6976 3e0a 2020 2020 2020 2020   </div>.        
-0001e5d0: 2020 3c66 6f6f 7465 7220 636c 6173 733d    <footer class=
-0001e5e0: 2262 642d 666f 6f74 6572 2d63 6f6e 7465  "bd-footer-conte
-0001e5f0: 6e74 223e 0a20 2020 2020 2020 2020 2020  nt">.           
-0001e600: 200a 3c64 6976 2063 6c61 7373 3d22 6264   .<div class="bd
-0001e610: 2d66 6f6f 7465 722d 636f 6e74 656e 745f  -footer-content_
-0001e620: 5f69 6e6e 6572 2063 6f6e 7461 696e 6572  _inner container
-0001e630: 223e 0a20 200a 2020 3c64 6976 2063 6c61  ">.  .  <div cla
-0001e640: 7373 3d22 666f 6f74 6572 2d69 7465 6d22  ss="footer-item"
-0001e650: 3e0a 2020 2020 0a3c 7020 636c 6173 733d  >.    .<p class=
-0001e660: 2263 6f6d 706f 6e65 6e74 2d61 7574 686f  "component-autho
-0001e670: 7222 3e0a 4279 2058 696e 7169 616e 6720  r">.By Xinqiang 
-0001e680: 4469 6e67 0a3c 2f70 3e0a 0a20 203c 2f64  Ding.</p>..  </d
-0001e690: 6976 3e0a 2020 0a20 203c 6469 7620 636c  iv>.  .  <div cl
-0001e6a0: 6173 733d 2266 6f6f 7465 722d 6974 656d  ass="footer-item
-0001e6b0: 223e 0a20 2020 200a 2020 3c70 2063 6c61  ">.    .  <p cla
-0001e6c0: 7373 3d22 636f 7079 7269 6768 7422 3e0a  ss="copyright">.
-0001e6d0: 2020 2020 0a20 2020 2020 20c2 a920 436f      .      .. Co
-0001e6e0: 7079 7269 6768 7420 3230 3139 2058 696e  pyright 2019 Xin
-0001e6f0: 7169 616e 6720 4469 6e67 2c20 4a6f 6e61  qiang Ding, Jona
-0001e700: 6820 5a2e 2056 696c 7365 636b 2c20 616e  h Z. Vilseck, an
-0001e710: 6420 4368 6172 6c65 7320 4c2e 2042 726f  d Charles L. Bro
-0001e720: 6f6b 7320 4949 492e 2e0a 2020 2020 2020  oks III...      
-0001e730: 3c62 722f 3e0a 2020 2020 0a20 203c 2f70  <br/>.    .  </p
-0001e740: 3e0a 0a20 203c 2f64 6976 3e0a 2020 0a20  >..  </div>.  . 
-0001e750: 203c 6469 7620 636c 6173 733d 2266 6f6f   <div class="foo
-0001e760: 7465 722d 6974 656d 223e 0a20 2020 200a  ter-item">.    .
-0001e770: 2020 3c2f 6469 763e 0a20 200a 2020 3c64    </div>.  .  <d
-0001e780: 6976 2063 6c61 7373 3d22 666f 6f74 6572  iv class="footer
-0001e790: 2d69 7465 6d22 3e0a 2020 2020 0a20 203c  -item">.    .  <
-0001e7a0: 2f64 6976 3e0a 2020 0a3c 2f64 6976 3e0a  /div>.  .</div>.
-0001e7b0: 2020 2020 2020 2020 2020 3c2f 666f 6f74            </foot
-0001e7c0: 6572 3e0a 2020 2020 2020 2020 0a0a 2020  er>.        ..  
-0001e7d0: 2020 2020 3c2f 6d61 696e 3e0a 2020 2020      </main>.    
-0001e7e0: 3c2f 6469 763e 0a20 203c 2f64 6976 3e0a  </div>.  </div>.
-0001e7f0: 2020 0a20 203c 212d 2d20 5363 7269 7074    .  <!-- Script
-0001e800: 7320 6c6f 6164 6564 2061 6674 6572 203c  s loaded after <
-0001e810: 626f 6479 3e20 736f 2074 6865 2044 4f4d  body> so the DOM
-0001e820: 2069 7320 6e6f 7420 626c 6f63 6b65 6420   is not blocked 
-0001e830: 2d2d 3e0a 2020 3c73 6372 6970 7420 7372  -->.  <script sr
-0001e840: 633d 222e 2e2f 2e2e 2f5f 7374 6174 6963  c="../../_static
-0001e850: 2f73 6372 6970 7473 2f62 6f6f 7473 7472  /scripts/bootstr
-0001e860: 6170 2e6a 733f 6469 6765 7374 3d65 3335  ap.js?digest=e35
-0001e870: 3364 3431 3039 3730 3833 3639 3734 6135  3d410970836974a5
-0001e880: 3222 3e3c 2f73 6372 6970 743e 0a3c 7363  2"></script>.<sc
-0001e890: 7269 7074 2073 7263 3d22 2e2e 2f2e 2e2f  ript src="../../
-0001e8a0: 5f73 7461 7469 632f 7363 7269 7074 732f  _static/scripts/
-0001e8b0: 7079 6461 7461 2d73 7068 696e 782d 7468  pydata-sphinx-th
-0001e8c0: 656d 652e 6a73 3f64 6967 6573 743d 6533  eme.js?digest=e3
-0001e8d0: 3533 6434 3130 3937 3038 3336 3937 3461  53d410970836974a
-0001e8e0: 3532 223e 3c2f 7363 7269 7074 3e0a 0a20  52"></script>.. 
-0001e8f0: 203c 666f 6f74 6572 2063 6c61 7373 3d22   <footer class="
-0001e900: 6264 2d66 6f6f 7465 7222 3e0a 2020 3c2f  bd-footer">.  </
-0001e910: 666f 6f74 6572 3e0a 2020 3c2f 626f 6479  footer>.  </body
-0001e920: 3e0a 3c2f 6874 6d6c 3e                   >.</html>
+0001d9e0: 3d22 6e22 3e69 6e64 785f 6974 6572 3c2f  ="n">indx_iter</
+0001d9f0: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+0001da00: 3d22 6f22 3e2b 3c2f 7370 616e 3e3c 7370  ="o">+</span><sp
+0001da10: 616e 2063 6c61 7373 3d22 6d69 223e 313c  an class="mi">1<
+0001da20: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
+0001da30: 733d 2273 6922 3e3a 3c2f 7370 616e 3e3c  s="si">:</span><
+0001da40: 7370 616e 2063 6c61 7373 3d22 7332 223e  span class="s2">
+0001da50: 3664 3c2f 7370 616e 3e3c 7370 616e 2063  6d</span><span c
+0001da60: 6c61 7373 3d22 7369 223e 7d3c 2f73 7061  lass="si">}</spa
+0001da70: 6e3e 3c73 7061 6e20 636c 6173 733d 2273  n><span class="s
+0001da80: 3222 3e20 2020 203c 2f73 7061 6e3e 3c73  2">    </span><s
+0001da90: 7061 6e20 636c 6173 733d 2273 6922 3e7b  pan class="si">{
+0001daa0: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
+0001dab0: 7373 3d22 6e22 3e4e 5f66 756e 633c 2f73  ss="n">N_func</s
+0001dac0: 7061 6e3e 3c73 7061 6e20 636c 6173 733d  pan><span class=
+0001dad0: 2273 6922 3e3a 3c2f 7370 616e 3e3c 7370  "si">:</span><sp
+0001dae0: 616e 2063 6c61 7373 3d22 7332 223e 3664  an class="s2">6d
+0001daf0: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
+0001db00: 7373 3d22 7369 223e 7d3c 2f73 7061 6e3e  ss="si">}</span>
+0001db10: 3c73 7061 6e20 636c 6173 733d 2273 3222  <span class="s2"
+0001db20: 3e20 2020 203c 2f73 7061 6e3e 3c73 7061  >    </span><spa
+0001db30: 6e20 636c 6173 733d 2273 6922 3e7b 3c2f  n class="si">{</
+0001db40: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+0001db50: 3d22 6e22 3e6c 6f73 733c 2f73 7061 6e3e  ="n">loss</span>
+0001db60: 3c73 7061 6e20 636c 6173 733d 226f 223e  <span class="o">
+0001db70: 2e3c 2f73 7061 6e3e 3c73 7061 6e20 636c  .</span><span cl
+0001db80: 6173 733d 226e 223e 6974 656d 3c2f 7370  ass="n">item</sp
+0001db90: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+0001dba0: 7022 3e28 293c 2f73 7061 6e3e 3c73 7061  p">()</span><spa
+0001dbb0: 6e20 636c 6173 733d 2273 6922 3e3a 3c2f  n class="si">:</
+0001dbc0: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+0001dbd0: 3d22 7332 223e 2e36 453c 2f73 7061 6e3e  ="s2">.6E</span>
+0001dbe0: 3c73 7061 6e20 636c 6173 733d 2273 6922  <span class="si"
+0001dbf0: 3e7d 3c2f 7370 616e 3e3c 7370 616e 2063  >}</span><span c
+0001dc00: 6c61 7373 3d22 7332 223e 2671 756f 743b  lass="s2">&quot;
+0001dc10: 3c2f 7370 616e 3e3c 7370 616e 2063 6c61  </span><span cla
+0001dc20: 7373 3d22 7022 3e29 3c2f 7370 616e 3e0a  ss="p">)</span>.
+0001dc30: 2020 2020 2020 2020 3c73 7061 6e20 636c          <span cl
+0001dc40: 6173 733d 226e 6222 3e70 7269 6e74 3c2f  ass="nb">print</
+0001dc50: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+0001dc60: 3d22 7022 3e28 3c2f 7370 616e 3e3c 7370  ="p">(</span><sp
+0001dc70: 616e 2063 6c61 7373 3d22 7361 223e 663c  an class="sa">f<
+0001dc80: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
+0001dc90: 733d 2273 3222 3e26 7175 6f74 3b20 2046  s="s2">&quot;  F
+0001dca0: 203d 203c 2f73 7061 6e3e 3c73 7061 6e20   = </span><span 
+0001dcb0: 636c 6173 733d 2273 6922 3e7b 3c2f 7370  class="si">{</sp
+0001dcc0: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+0001dcd0: 6e22 3e6c 6f73 733c 2f73 7061 6e3e 3c73  n">loss</span><s
+0001dce0: 7061 6e20 636c 6173 733d 226f 223e 2e3c  pan class="o">.<
+0001dcf0: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
+0001dd00: 733d 226e 223e 6974 656d 3c2f 7370 616e  s="n">item</span
+0001dd10: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
+0001dd20: 3e28 293c 2f73 7061 6e3e 3c73 7061 6e20  >()</span><span 
+0001dd30: 636c 6173 733d 2273 6922 3e3a 3c2f 7370  class="si">:</sp
+0001dd40: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+0001dd50: 7332 223e 2e31 3266 3c2f 7370 616e 3e3c  s2">.12f</span><
+0001dd60: 7370 616e 2063 6c61 7373 3d22 7369 223e  span class="si">
+0001dd70: 7d3c 2f73 7061 6e3e 3c73 7061 6e20 636c  }</span><span cl
+0001dd80: 6173 733d 2273 3222 3e20 3c2f 7370 616e  ass="s2"> </span
+0001dd90: 3e3c 7370 616e 2063 6c61 7373 3d22 7365  ><span class="se
+0001dda0: 223e 5c6e 3c2f 7370 616e 3e3c 7370 616e  ">\n</span><span
+0001ddb0: 2063 6c61 7373 3d22 7332 223e 2671 756f   class="s2">&quo
+0001ddc0: 743b 3c2f 7370 616e 3e3c 7370 616e 2063  t;</span><span c
+0001ddd0: 6c61 7373 3d22 7022 3e29 3c2f 7370 616e  lass="p">)</span
+0001dde0: 3e0a 0a20 2020 2020 2020 203c 7370 616e  >..        <span
+0001ddf0: 2063 6c61 7373 3d22 6b22 3e69 663c 2f73   class="k">if</s
+0001de00: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
+0001de10: 3d22 6e22 3e6e 6577 746f 6e5f 6465 6372  ="n">newton_decr
+0001de20: 656d 656e 745f 7371 7561 7265 3c2f 7370  ement_square</sp
+0001de30: 616e 3e20 3c73 7061 6e20 636c 6173 733d  an> <span class=
+0001de40: 226f 223e 2f3c 2f73 7061 6e3e 203c 7370  "o">/</span> <sp
+0001de50: 616e 2063 6c61 7373 3d22 6d66 223e 322e  an class="mf">2.
+0001de60: 303c 2f73 7061 6e3e 203c 7370 616e 2063  0</span> <span c
+0001de70: 6c61 7373 3d22 6f22 3e26 6c74 3b3d 3c2f  lass="o">&lt;=</
+0001de80: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
+0001de90: 733d 226e 223e 6570 733c 2f73 7061 6e3e  s="n">eps</span>
+0001dea0: 203c 7370 616e 2063 6c61 7373 3d22 6f77   <span class="ow
+0001deb0: 223e 616e 643c 2f73 7061 6e3e 203c 7370  ">and</span> <sp
+0001dec0: 616e 2063 6c61 7373 3d22 6e22 3e69 6e64  an class="n">ind
+0001ded0: 785f 6974 6572 3c2f 7370 616e 3e20 3c73  x_iter</span> <s
+0001dee0: 7061 6e20 636c 6173 733d 226f 223e 266c  pan class="o">&l
+0001def0: 743b 3c2f 7370 616e 3e20 3c73 7061 6e20  t;</span> <span 
+0001df00: 636c 6173 733d 226e 223e 6d61 785f 6974  class="n">max_it
+0001df10: 6572 3c2f 7370 616e 3e3c 7370 616e 2063  er</span><span c
+0001df20: 6c61 7373 3d22 7022 3e3a 3c2f 7370 616e  lass="p">:</span
+0001df30: 3e0a 2020 2020 2020 2020 2020 2020 3c73  >.            <s
+0001df40: 7061 6e20 636c 6173 733d 226e 6222 3e70  pan class="nb">p
+0001df50: 7269 6e74 3c2f 7370 616e 3e3c 7370 616e  rint</span><span
+0001df60: 2063 6c61 7373 3d22 7022 3e28 3c2f 7370   class="p">(</sp
+0001df70: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+0001df80: 7332 223e 2671 756f 743b 434f 4e56 4552  s2">&quot;CONVER
+0001df90: 4745 4e43 453a 2031 2f32 2a4e 6577 746f  GENCE: 1/2*Newto
+0001dfa0: 6e5f 6465 6372 656d 656e 745e 3220 266c  n_decrement^2 &l
+0001dfb0: 743b 2045 5053 2671 756f 743b 3c2f 7370  t; EPS&quot;</sp
+0001dfc0: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+0001dfd0: 7022 3e29 3c2f 7370 616e 3e0a 2020 2020  p">)</span>.    
+0001dfe0: 2020 2020 3c73 7061 6e20 636c 6173 733d      <span class=
+0001dff0: 226b 223e 656c 7365 3c2f 7370 616e 3e3c  "k">else</span><
+0001e000: 7370 616e 2063 6c61 7373 3d22 7022 3e3a  span class="p">:
+0001e010: 3c2f 7370 616e 3e0a 2020 2020 2020 2020  </span>.        
+0001e020: 2020 2020 3c73 7061 6e20 636c 6173 733d      <span class=
+0001e030: 226e 6222 3e70 7269 6e74 3c2f 7370 616e  "nb">print</span
+0001e040: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
+0001e050: 3e28 3c2f 7370 616e 3e3c 7370 616e 2063  >(</span><span c
+0001e060: 6c61 7373 3d22 7332 223e 2671 756f 743b  lass="s2">&quot;
+0001e070: 434f 4e56 4552 4745 4e43 453a 204e 554d  CONVERGENCE: NUM
+0001e080: 5f4f 465f 4954 4552 4154 494f 4e20 5245  _OF_ITERATION RE
+0001e090: 4143 4820 4d41 585f 4954 4552 4154 494f  ACH MAX_ITERATIO
+0001e0a0: 4e26 7175 6f74 3b3c 2f73 7061 6e3e 3c73  N&quot;</span><s
+0001e0b0: 7061 6e20 636c 6173 733d 2270 223e 293c  pan class="p">)<
+0001e0c0: 2f73 7061 6e3e 0a0a 2020 2020 3c73 7061  /span>..    <spa
+0001e0d0: 6e20 636c 6173 733d 226b 223e 7265 7475  n class="k">retu
+0001e0e0: 726e 3c2f 7370 616e 3e20 3c73 7061 6e20  rn</span> <span 
+0001e0f0: 636c 6173 733d 2270 223e 7b3c 2f73 7061  class="p">{</spa
+0001e100: 6e3e 0a20 2020 2020 2020 203c 7370 616e  n>.        <span
+0001e110: 2063 6c61 7373 3d22 7332 223e 2671 756f   class="s2">&quo
+0001e120: 743b 7826 7175 6f74 3b3c 2f73 7061 6e3e  t;x&quot;</span>
+0001e130: 3c73 7061 6e20 636c 6173 733d 2270 223e  <span class="p">
+0001e140: 3a3c 2f73 7061 6e3e 203c 7370 616e 2063  :</span> <span c
+0001e150: 6c61 7373 3d22 6e22 3e78 3c2f 7370 616e  lass="n">x</span
+0001e160: 3e3c 7370 616e 2063 6c61 7373 3d22 7022  ><span class="p"
+0001e170: 3e2c 3c2f 7370 616e 3e0a 2020 2020 2020  >,</span>.      
+0001e180: 2020 3c73 7061 6e20 636c 6173 733d 2273    <span class="s
+0001e190: 3222 3e26 7175 6f74 3b4e 5f69 7465 7226  2">&quot;N_iter&
+0001e1a0: 7175 6f74 3b3c 2f73 7061 6e3e 3c73 7061  quot;</span><spa
+0001e1b0: 6e20 636c 6173 733d 2270 223e 3a3c 2f73  n class="p">:</s
+0001e1c0: 7061 6e3e 203c 7370 616e 2063 6c61 7373  pan> <span class
+0001e1d0: 3d22 6e22 3e69 6e64 785f 6974 6572 3c2f  ="n">indx_iter</
+0001e1e0: 7370 616e 3e20 3c73 7061 6e20 636c 6173  span> <span clas
+0001e1f0: 733d 226f 223e 2b3c 2f73 7061 6e3e 203c  s="o">+</span> <
+0001e200: 7370 616e 2063 6c61 7373 3d22 6d69 223e  span class="mi">
+0001e210: 313c 2f73 7061 6e3e 3c73 7061 6e20 636c  1</span><span cl
+0001e220: 6173 733d 2270 223e 2c3c 2f73 7061 6e3e  ass="p">,</span>
+0001e230: 0a20 2020 2020 2020 203c 7370 616e 2063  .        <span c
+0001e240: 6c61 7373 3d22 7332 223e 2671 756f 743b  lass="s2">&quot;
+0001e250: 4e5f 6675 6e63 2671 756f 743b 3c2f 7370  N_func&quot;</sp
+0001e260: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+0001e270: 7022 3e3a 3c2f 7370 616e 3e20 3c73 7061  p">:</span> <spa
+0001e280: 6e20 636c 6173 733d 226e 223e 4e5f 6675  n class="n">N_fu
+0001e290: 6e63 3c2f 7370 616e 3e3c 7370 616e 2063  nc</span><span c
+0001e2a0: 6c61 7373 3d22 7022 3e2c 3c2f 7370 616e  lass="p">,</span
+0001e2b0: 3e0a 2020 2020 2020 2020 3c73 7061 6e20  >.        <span 
+0001e2c0: 636c 6173 733d 2273 3222 3e26 7175 6f74  class="s2">&quot
+0001e2d0: 3b46 2671 756f 743b 3c2f 7370 616e 3e3c  ;F&quot;</span><
+0001e2e0: 7370 616e 2063 6c61 7373 3d22 7022 3e3a  span class="p">:
+0001e2f0: 3c2f 7370 616e 3e20 3c73 7061 6e20 636c  </span> <span cl
+0001e300: 6173 733d 226e 223e 6c6f 7373 3c2f 7370  ass="n">loss</sp
+0001e310: 616e 3e3c 7370 616e 2063 6c61 7373 3d22  an><span class="
+0001e320: 6f22 3e2e 3c2f 7370 616e 3e3c 7370 616e  o">.</span><span
+0001e330: 2063 6c61 7373 3d22 6e22 3e69 7465 6d3c   class="n">item<
+0001e340: 2f73 7061 6e3e 3c73 7061 6e20 636c 6173  /span><span clas
+0001e350: 733d 2270 223e 2829 2c3c 2f73 7061 6e3e  s="p">(),</span>
+0001e360: 0a20 2020 2020 2020 203c 7370 616e 2063  .        <span c
+0001e370: 6c61 7373 3d22 7332 223e 2671 756f 743b  lass="s2">&quot;
+0001e380: 6861 6c66 5f6e 6577 746f 6e5f 6465 6372  half_newton_decr
+0001e390: 656d 656e 745f 7371 7561 7265 2671 756f  ement_square&quo
+0001e3a0: 743b 3c2f 7370 616e 3e3c 7370 616e 2063  t;</span><span c
+0001e3b0: 6c61 7373 3d22 7022 3e3a 3c2f 7370 616e  lass="p">:</span
+0001e3c0: 3e20 3c73 7061 6e20 636c 6173 733d 226e  > <span class="n
+0001e3d0: 223e 6e65 7774 6f6e 5f64 6563 7265 6d65  ">newton_decreme
+0001e3e0: 6e74 5f73 7175 6172 653c 2f73 7061 6e3e  nt_square</span>
+0001e3f0: 203c 7370 616e 2063 6c61 7373 3d22 6f22   <span class="o"
+0001e400: 3e2f 3c2f 7370 616e 3e20 3c73 7061 6e20  >/</span> <span 
+0001e410: 636c 6173 733d 226d 6622 3e32 2e30 3c2f  class="mf">2.0</
+0001e420: 7370 616e 3e3c 7370 616e 2063 6c61 7373  span><span class
+0001e430: 3d22 7022 3e2c 3c2f 7370 616e 3e0a 2020  ="p">,</span>.  
+0001e440: 2020 3c73 7061 6e20 636c 6173 733d 2270    <span class="p
+0001e450: 223e 7d3c 2f73 7061 6e3e 0a3c 2f70 7265  ">}</span>.</pre
+0001e460: 3e3c 2f64 6976 3e0a 0a20 2020 2020 2020  ></div>..       
+0001e470: 2020 2020 2020 2020 203c 2f61 7274 6963           </artic
+0001e480: 6c65 3e0a 2020 2020 2020 2020 2020 2020  le>.            
+0001e490: 2020 0a0a 2020 2020 2020 2020 2020 2020    ..            
+0001e4a0: 2020 0a20 2020 2020 2020 2020 2020 2020    .             
+0001e4b0: 200a 2020 2020 2020 2020 2020 2020 2020   .              
+0001e4c0: 2020 3c66 6f6f 7465 7220 636c 6173 733d    <footer class=
+0001e4d0: 2262 642d 666f 6f74 6572 2d61 7274 6963  "bd-footer-artic
+0001e4e0: 6c65 223e 0a20 2020 2020 2020 2020 2020  le">.           
+0001e4f0: 2020 2020 2020 200a 3c64 6976 2063 6c61         .<div cla
+0001e500: 7373 3d22 666f 6f74 6572 2d61 7274 6963  ss="footer-artic
+0001e510: 6c65 2d69 7465 6d73 2066 6f6f 7465 722d  le-items footer-
+0001e520: 6172 7469 636c 655f 5f69 6e6e 6572 223e  article__inner">
+0001e530: 0a20 200a 2020 2020 3c64 6976 2063 6c61  .  .    <div cla
+0001e540: 7373 3d22 666f 6f74 6572 2d61 7274 6963  ss="footer-artic
+0001e550: 6c65 2d69 7465 6d22 3e3c 212d 2d20 5072  le-item"><!-- Pr
+0001e560: 6576 696f 7573 202f 206e 6578 7420 6275  evious / next bu
+0001e570: 7474 6f6e 7320 2d2d 3e0a 3c64 6976 2063  ttons -->.<div c
+0001e580: 6c61 7373 3d22 7072 6576 2d6e 6578 742d  lass="prev-next-
+0001e590: 6172 6561 223e 0a3c 2f64 6976 3e3c 2f64  area">.</div></d
+0001e5a0: 6976 3e0a 2020 0a3c 2f64 6976 3e0a 0a20  iv>.  .</div>.. 
+0001e5b0: 2020 2020 2020 2020 2020 2020 2020 203c                 <
+0001e5c0: 2f66 6f6f 7465 723e 0a20 2020 2020 2020  /footer>.       
+0001e5d0: 2020 2020 2020 200a 2020 2020 2020 2020         .        
+0001e5e0: 2020 2020 3c2f 6469 763e 0a20 2020 2020      </div>.     
+0001e5f0: 2020 2020 2020 200a 2020 2020 2020 2020         .        
+0001e600: 2020 2020 0a20 2020 2020 2020 2020 2020      .           
+0001e610: 2020 200a 2020 2020 2020 2020 2020 2020     .            
+0001e620: 0a20 2020 2020 2020 2020 203c 2f64 6976  .          </div
+0001e630: 3e0a 2020 2020 2020 2020 2020 3c66 6f6f  >.          <foo
+0001e640: 7465 7220 636c 6173 733d 2262 642d 666f  ter class="bd-fo
+0001e650: 6f74 6572 2d63 6f6e 7465 6e74 223e 0a20  oter-content">. 
+0001e660: 2020 2020 2020 2020 2020 200a 3c64 6976             .<div
+0001e670: 2063 6c61 7373 3d22 6264 2d66 6f6f 7465   class="bd-foote
+0001e680: 722d 636f 6e74 656e 745f 5f69 6e6e 6572  r-content__inner
+0001e690: 2063 6f6e 7461 696e 6572 223e 0a20 200a   container">.  .
+0001e6a0: 2020 3c64 6976 2063 6c61 7373 3d22 666f    <div class="fo
+0001e6b0: 6f74 6572 2d69 7465 6d22 3e0a 2020 2020  oter-item">.    
+0001e6c0: 0a3c 7020 636c 6173 733d 2263 6f6d 706f  .<p class="compo
+0001e6d0: 6e65 6e74 2d61 7574 686f 7222 3e0a 4279  nent-author">.By
+0001e6e0: 2058 696e 7169 616e 6720 4469 6e67 0a3c   Xinqiang Ding.<
+0001e6f0: 2f70 3e0a 0a20 203c 2f64 6976 3e0a 2020  /p>..  </div>.  
+0001e700: 0a20 203c 6469 7620 636c 6173 733d 2266  .  <div class="f
+0001e710: 6f6f 7465 722d 6974 656d 223e 0a20 2020  ooter-item">.   
+0001e720: 200a 2020 3c70 2063 6c61 7373 3d22 636f   .  <p class="co
+0001e730: 7079 7269 6768 7422 3e0a 2020 2020 0a20  pyright">.    . 
+0001e740: 2020 2020 20c2 a920 436f 7079 7269 6768       .. Copyrigh
+0001e750: 7420 3230 3139 2058 696e 7169 616e 6720  t 2019 Xinqiang 
+0001e760: 4469 6e67 2c20 4a6f 6e61 6820 5a2e 2056  Ding, Jonah Z. V
+0001e770: 696c 7365 636b 2c20 616e 6420 4368 6172  ilseck, and Char
+0001e780: 6c65 7320 4c2e 2042 726f 6f6b 7320 4949  les L. Brooks II
+0001e790: 492e 2e0a 2020 2020 2020 3c62 722f 3e0a  I...      <br/>.
+0001e7a0: 2020 2020 0a20 203c 2f70 3e0a 0a20 203c      .  </p>..  <
+0001e7b0: 2f64 6976 3e0a 2020 0a20 203c 6469 7620  /div>.  .  <div 
+0001e7c0: 636c 6173 733d 2266 6f6f 7465 722d 6974  class="footer-it
+0001e7d0: 656d 223e 0a20 2020 200a 2020 3c2f 6469  em">.    .  </di
+0001e7e0: 763e 0a20 200a 2020 3c64 6976 2063 6c61  v>.  .  <div cla
+0001e7f0: 7373 3d22 666f 6f74 6572 2d69 7465 6d22  ss="footer-item"
+0001e800: 3e0a 2020 2020 0a20 203c 2f64 6976 3e0a  >.    .  </div>.
+0001e810: 2020 0a3c 2f64 6976 3e0a 2020 2020 2020    .</div>.      
+0001e820: 2020 2020 3c2f 666f 6f74 6572 3e0a 2020      </footer>.  
+0001e830: 2020 2020 2020 0a0a 2020 2020 2020 3c2f        ..      </
+0001e840: 6d61 696e 3e0a 2020 2020 3c2f 6469 763e  main>.    </div>
+0001e850: 0a20 203c 2f64 6976 3e0a 2020 0a20 203c  .  </div>.  .  <
+0001e860: 212d 2d20 5363 7269 7074 7320 6c6f 6164  !-- Scripts load
+0001e870: 6564 2061 6674 6572 203c 626f 6479 3e20  ed after <body> 
+0001e880: 736f 2074 6865 2044 4f4d 2069 7320 6e6f  so the DOM is no
+0001e890: 7420 626c 6f63 6b65 6420 2d2d 3e0a 2020  t blocked -->.  
+0001e8a0: 3c73 6372 6970 7420 7372 633d 222e 2e2f  <script src="../
+0001e8b0: 2e2e 2f5f 7374 6174 6963 2f73 6372 6970  ../_static/scrip
+0001e8c0: 7473 2f62 6f6f 7473 7472 6170 2e6a 733f  ts/bootstrap.js?
+0001e8d0: 6469 6765 7374 3d65 3335 3364 3431 3039  digest=e353d4109
+0001e8e0: 3730 3833 3639 3734 6135 3222 3e3c 2f73  70836974a52"></s
+0001e8f0: 6372 6970 743e 0a3c 7363 7269 7074 2073  cript>.<script s
+0001e900: 7263 3d22 2e2e 2f2e 2e2f 5f73 7461 7469  rc="../../_stati
+0001e910: 632f 7363 7269 7074 732f 7079 6461 7461  c/scripts/pydata
+0001e920: 2d73 7068 696e 782d 7468 656d 652e 6a73  -sphinx-theme.js
+0001e930: 3f64 6967 6573 743d 6533 3533 6434 3130  ?digest=e353d410
+0001e940: 3937 3038 3336 3937 3461 3532 223e 3c2f  970836974a52"></
+0001e950: 7363 7269 7074 3e0a 0a20 203c 666f 6f74  script>..  <foot
+0001e960: 6572 2063 6c61 7373 3d22 6264 2d66 6f6f  er class="bd-foo
+0001e970: 7465 7222 3e0a 2020 3c2f 666f 6f74 6572  ter">.  </footer
+0001e980: 3e0a 2020 3c2f 626f 6479 3e0a 3c2f 6874  >.  </body>.</ht
+0001e990: 6d6c 3e                                  ml>
```

#### html2text {}

```diff
@@ -466,19 +466,19 @@
 
         if not self.bootstrap:
             du = energy_perturbed + self._log_prob_mix
             F = -torch.logsumexp(-du, dim=1)
 
             F_ext = torch.cat([self._F, F])
             U = torch.cat([self.energy, energy_perturbed], dim=0).t()
-            P = torch.exp(-(U - F_ext + self._log_prob_mix[:, None]))
+            self._P = torch.exp(-(U - F_ext + self._log_prob_mix[:, None]))
 
             W = torch.diag(torch.cat([self.num_conf, self.num_conf.new_zeros
 (L)]))
-            Q, R = torch.linalg.qr(P)
+            Q, R = torch.linalg.qr(self._P)
             A = torch.eye(self.M + L, device=W.device) - R @ W @ R.T
             F_cov = R.T @ torch.linalg.pinv(A, hermitian=True, rtol=1e-8) @ R
 
             F_cov = F_cov[self.M :, self.M :]
             F_std = F_cov.diagonal().sqrt()
 
             DeltaF = F[None, :] - F[:, None]
```

### Comparing `fastmbar-1.2/docs/build/_sources/butane_PMF.rst` & `fastmbar-1.3/docs/build/_sources/butane_PMF.rst`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_sources/dialanine_PMF.rst` & `fastmbar-1.3/docs/build/_sources/dialanine_PMF.rst`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_sources/examples.rst` & `fastmbar-1.3/docs/build/_sources/examples.rst`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_sources/index.rst` & `fastmbar-1.3/docs/build/_sources/index.rst`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_sources/installation.rst` & `fastmbar-1.3/docs/build/_sources/installation.rst`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_sources/references.rst` & `fastmbar-1.3/docs/build/_sources/references.rst`

 * *Files 7% similar despite different names*

```diff
@@ -1,14 +1,21 @@
 References
 ============
 
 Please consider citing the following references if FastMBAR is used in your projects.
 
-1. Xinqiang Ding, Jonah Z. Vilseck, Charles L. Brooks III. (2019). `Fast Solver for Large Scale Multistate Bennett Acceptance Ratio Equations. <https://doi.org/10.1021/acs.jctc.8b01010>`_  *J. Chem. Theory Comput.*
+1. Xinqiang Ding, Jonah Z. Vilseck, Charles L. Brooks III. (2019).
+`Fast Solver for Large Scale Multistate Bennett Acceptance Ratio Equations. <https://doi.org/10.1021/acs.jctc.8b01010>`_  *J. Chem. Theory Comput.*
 
-2. Xinqiang Ding, Jonah Z. Vilseck, Ryan L. Hayes, Charles L. Brooks III. (2017). `Gibbs Sampler-based λ-dynamics and Rao–Blackwell Estimator for Alchemical Free Energy Calculation. <https://doi.org/10.1021/acs.jctc.7b00204>`_  *J. Chem. Theory Comput.*
+2. Xinqiang Ding, Jonah Z. Vilseck, Ryan L. Hayes, Charles L. Brooks III. (2017).
+`Gibbs Sampler-based λ-dynamics and Rao–Blackwell Estimator for Alchemical Free Energy Calculation. <https://doi.org/10.1021/acs.jctc.7b00204>`_  *J. Chem. Theory Comput.*
    
-3. Shirts, Michael R., and John D. Chodera. (2008) `Statistically Optimal Analysis of Samples from Multiple Equilibrium States. <https://doi.org/10.1063/1.2978177>`_ *J. Chem. Phys.*
+3. Shirts, Michael R., and John D. Chodera. (2008)
+`Statistically Optimal Analysis of Samples from Multiple Equilibrium States. <https://doi.org/10.1063/1.2978177>`_ *J. Chem. Phys.*
 
-4. Bennett, Charles H. (1976) `Efficient Estimation of Free Energy Differences from Monte Carlo Data. <https://doi.org/10.1016/0021-9991(76)90078-4>`_ J. Comput. Phys.
+4. Kong A, McCullagh P, Meng XL, Nicolae D, Tan Z. (2003)
+`A theory of statistical models for Monte Carlo integration. <https://doi.org/10.1111/1467-9868.00404>`_ *J. R. Stat. Soc. Ser. B Stat. Methodol.*
+
+5. Bennett, Charles H. (1976)
+`Efficient Estimation of Free Energy Differences from Monte Carlo Data. <https://doi.org/10.1016/0021-9991(76)90078-4>`_ J. Comput. Phys.
```

### Comparing `fastmbar-1.2/docs/build/_sources/usage.rst` & `fastmbar-1.3/docs/build/_sources/usage.rst`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/_sphinx_javascript_frameworks_compat.js` & `fastmbar-1.3/docs/build/_static/_sphinx_javascript_frameworks_compat.js`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/basic.css` & `fastmbar-1.3/docs/build/_static/basic.css`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/clipboard.min.js` & `fastmbar-1.3/docs/build/_static/clipboard.min.js`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/copybutton.css` & `fastmbar-1.3/docs/build/_static/copybutton.css`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/copybutton.js` & `fastmbar-1.3/docs/build/_static/copybutton.js`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/copybutton_funcs.js` & `fastmbar-1.3/docs/build/_static/copybutton_funcs.js`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/doctools.js` & `fastmbar-1.3/docs/build/_static/doctools.js`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/jquery-3.6.0.js` & `fastmbar-1.3/docs/build/_static/jquery-3.6.0.js`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/jquery.js` & `fastmbar-1.3/docs/build/_static/jquery.js`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/language_data.js` & `fastmbar-1.3/docs/build/_static/language_data.js`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/logo.ai` & `fastmbar-1.3/docs/build/_static/logo.ai`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/logo.eps` & `fastmbar-1.3/docs/build/_static/logo.eps`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/logo.png` & `fastmbar-1.3/docs/build/_static/logo.png`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/pygments.css` & `fastmbar-1.3/docs/build/_static/pygments.css`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/searchtools.js` & `fastmbar-1.3/docs/build/_static/searchtools.js`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/underscore-1.13.1.js` & `fastmbar-1.3/docs/build/_static/underscore-1.13.1.js`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/underscore.js` & `fastmbar-1.3/docs/build/_static/underscore.js`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/webpack-macros.html` & `fastmbar-1.3/docs/build/_static/webpack-macros.html`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/images/logo_binder.svg` & `fastmbar-1.3/docs/build/_static/images/logo_binder.svg`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/images/logo_colab.png` & `fastmbar-1.3/docs/build/_static/images/logo_colab.png`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/images/logo_deepnote.svg` & `fastmbar-1.3/docs/build/_static/images/logo_deepnote.svg`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/images/logo_jupyterhub.svg` & `fastmbar-1.3/docs/build/_static/images/logo_jupyterhub.svg`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/ar/LC_MESSAGES/booktheme.mo` & `fastmbar-1.3/docs/build/_static/locales/ar/LC_MESSAGES/booktheme.mo`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/ar/LC_MESSAGES/booktheme.po` & `fastmbar-1.3/docs/build/_static/locales/ar/LC_MESSAGES/booktheme.po`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/bg/LC_MESSAGES/booktheme.mo` & `fastmbar-1.3/docs/build/_static/locales/bg/LC_MESSAGES/booktheme.mo`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/bg/LC_MESSAGES/booktheme.po` & `fastmbar-1.3/docs/build/_static/locales/bg/LC_MESSAGES/booktheme.po`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/bn/LC_MESSAGES/booktheme.mo` & `fastmbar-1.3/docs/build/_static/locales/bn/LC_MESSAGES/booktheme.mo`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/bn/LC_MESSAGES/booktheme.po` & `fastmbar-1.3/docs/build/_static/locales/bn/LC_MESSAGES/booktheme.po`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/ca/LC_MESSAGES/booktheme.mo` & `fastmbar-1.3/docs/build/_static/locales/ca/LC_MESSAGES/booktheme.mo`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/ca/LC_MESSAGES/booktheme.po` & `fastmbar-1.3/docs/build/_static/locales/ca/LC_MESSAGES/booktheme.po`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/cs/LC_MESSAGES/booktheme.mo` & `fastmbar-1.3/docs/build/_static/locales/cs/LC_MESSAGES/booktheme.mo`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/cs/LC_MESSAGES/booktheme.po` & `fastmbar-1.3/docs/build/_static/locales/cs/LC_MESSAGES/booktheme.po`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/da/LC_MESSAGES/booktheme.mo` & `fastmbar-1.3/docs/build/_static/locales/da/LC_MESSAGES/booktheme.mo`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/da/LC_MESSAGES/booktheme.po` & `fastmbar-1.3/docs/build/_static/locales/da/LC_MESSAGES/booktheme.po`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/de/LC_MESSAGES/booktheme.mo` & `fastmbar-1.3/docs/build/_static/locales/de/LC_MESSAGES/booktheme.mo`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/de/LC_MESSAGES/booktheme.po` & `fastmbar-1.3/docs/build/_static/locales/de/LC_MESSAGES/booktheme.po`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/el/LC_MESSAGES/booktheme.mo` & `fastmbar-1.3/docs/build/_static/locales/el/LC_MESSAGES/booktheme.mo`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/el/LC_MESSAGES/booktheme.po` & `fastmbar-1.3/docs/build/_static/locales/el/LC_MESSAGES/booktheme.po`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/eo/LC_MESSAGES/booktheme.mo` & `fastmbar-1.3/docs/build/_static/locales/eo/LC_MESSAGES/booktheme.mo`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/eo/LC_MESSAGES/booktheme.po` & `fastmbar-1.3/docs/build/_static/locales/eo/LC_MESSAGES/booktheme.po`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/es/LC_MESSAGES/booktheme.mo` & `fastmbar-1.3/docs/build/_static/locales/es/LC_MESSAGES/booktheme.mo`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/es/LC_MESSAGES/booktheme.po` & `fastmbar-1.3/docs/build/_static/locales/es/LC_MESSAGES/booktheme.po`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/et/LC_MESSAGES/booktheme.mo` & `fastmbar-1.3/docs/build/_static/locales/et/LC_MESSAGES/booktheme.mo`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/et/LC_MESSAGES/booktheme.po` & `fastmbar-1.3/docs/build/_static/locales/et/LC_MESSAGES/booktheme.po`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/fi/LC_MESSAGES/booktheme.mo` & `fastmbar-1.3/docs/build/_static/locales/fi/LC_MESSAGES/booktheme.mo`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/fi/LC_MESSAGES/booktheme.po` & `fastmbar-1.3/docs/build/_static/locales/fi/LC_MESSAGES/booktheme.po`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/fr/LC_MESSAGES/booktheme.mo` & `fastmbar-1.3/docs/build/_static/locales/fr/LC_MESSAGES/booktheme.mo`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/fr/LC_MESSAGES/booktheme.po` & `fastmbar-1.3/docs/build/_static/locales/fr/LC_MESSAGES/booktheme.po`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/hr/LC_MESSAGES/booktheme.mo` & `fastmbar-1.3/docs/build/_static/locales/hr/LC_MESSAGES/booktheme.mo`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/hr/LC_MESSAGES/booktheme.po` & `fastmbar-1.3/docs/build/_static/locales/hr/LC_MESSAGES/booktheme.po`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/id/LC_MESSAGES/booktheme.mo` & `fastmbar-1.3/docs/build/_static/locales/id/LC_MESSAGES/booktheme.mo`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/id/LC_MESSAGES/booktheme.po` & `fastmbar-1.3/docs/build/_static/locales/id/LC_MESSAGES/booktheme.po`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/it/LC_MESSAGES/booktheme.mo` & `fastmbar-1.3/docs/build/_static/locales/it/LC_MESSAGES/booktheme.mo`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/it/LC_MESSAGES/booktheme.po` & `fastmbar-1.3/docs/build/_static/locales/it/LC_MESSAGES/booktheme.po`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/iw/LC_MESSAGES/booktheme.mo` & `fastmbar-1.3/docs/build/_static/locales/iw/LC_MESSAGES/booktheme.mo`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/iw/LC_MESSAGES/booktheme.po` & `fastmbar-1.3/docs/build/_static/locales/iw/LC_MESSAGES/booktheme.po`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/ja/LC_MESSAGES/booktheme.mo` & `fastmbar-1.3/docs/build/_static/locales/ja/LC_MESSAGES/booktheme.mo`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/ja/LC_MESSAGES/booktheme.po` & `fastmbar-1.3/docs/build/_static/locales/ja/LC_MESSAGES/booktheme.po`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/ko/LC_MESSAGES/booktheme.mo` & `fastmbar-1.3/docs/build/_static/locales/ko/LC_MESSAGES/booktheme.mo`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/ko/LC_MESSAGES/booktheme.po` & `fastmbar-1.3/docs/build/_static/locales/ko/LC_MESSAGES/booktheme.po`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/lt/LC_MESSAGES/booktheme.mo` & `fastmbar-1.3/docs/build/_static/locales/lt/LC_MESSAGES/booktheme.mo`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/lt/LC_MESSAGES/booktheme.po` & `fastmbar-1.3/docs/build/_static/locales/lt/LC_MESSAGES/booktheme.po`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/lv/LC_MESSAGES/booktheme.mo` & `fastmbar-1.3/docs/build/_static/locales/lv/LC_MESSAGES/booktheme.mo`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/lv/LC_MESSAGES/booktheme.po` & `fastmbar-1.3/docs/build/_static/locales/lv/LC_MESSAGES/booktheme.po`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/ml/LC_MESSAGES/booktheme.mo` & `fastmbar-1.3/docs/build/_static/locales/ml/LC_MESSAGES/booktheme.mo`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/ml/LC_MESSAGES/booktheme.po` & `fastmbar-1.3/docs/build/_static/locales/ml/LC_MESSAGES/booktheme.po`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/mr/LC_MESSAGES/booktheme.mo` & `fastmbar-1.3/docs/build/_static/locales/mr/LC_MESSAGES/booktheme.mo`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/mr/LC_MESSAGES/booktheme.po` & `fastmbar-1.3/docs/build/_static/locales/mr/LC_MESSAGES/booktheme.po`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/ms/LC_MESSAGES/booktheme.mo` & `fastmbar-1.3/docs/build/_static/locales/ms/LC_MESSAGES/booktheme.mo`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/ms/LC_MESSAGES/booktheme.po` & `fastmbar-1.3/docs/build/_static/locales/ms/LC_MESSAGES/booktheme.po`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/nl/LC_MESSAGES/booktheme.mo` & `fastmbar-1.3/docs/build/_static/locales/nl/LC_MESSAGES/booktheme.mo`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/nl/LC_MESSAGES/booktheme.po` & `fastmbar-1.3/docs/build/_static/locales/nl/LC_MESSAGES/booktheme.po`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/no/LC_MESSAGES/booktheme.mo` & `fastmbar-1.3/docs/build/_static/locales/no/LC_MESSAGES/booktheme.mo`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/no/LC_MESSAGES/booktheme.po` & `fastmbar-1.3/docs/build/_static/locales/no/LC_MESSAGES/booktheme.po`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/pl/LC_MESSAGES/booktheme.mo` & `fastmbar-1.3/docs/build/_static/locales/pl/LC_MESSAGES/booktheme.mo`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/pl/LC_MESSAGES/booktheme.po` & `fastmbar-1.3/docs/build/_static/locales/pl/LC_MESSAGES/booktheme.po`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/pt/LC_MESSAGES/booktheme.mo` & `fastmbar-1.3/docs/build/_static/locales/pt/LC_MESSAGES/booktheme.mo`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/pt/LC_MESSAGES/booktheme.po` & `fastmbar-1.3/docs/build/_static/locales/pt/LC_MESSAGES/booktheme.po`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/ro/LC_MESSAGES/booktheme.mo` & `fastmbar-1.3/docs/build/_static/locales/ro/LC_MESSAGES/booktheme.mo`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/ro/LC_MESSAGES/booktheme.po` & `fastmbar-1.3/docs/build/_static/locales/ro/LC_MESSAGES/booktheme.po`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/ru/LC_MESSAGES/booktheme.mo` & `fastmbar-1.3/docs/build/_static/locales/ru/LC_MESSAGES/booktheme.mo`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/ru/LC_MESSAGES/booktheme.po` & `fastmbar-1.3/docs/build/_static/locales/ru/LC_MESSAGES/booktheme.po`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/sk/LC_MESSAGES/booktheme.mo` & `fastmbar-1.3/docs/build/_static/locales/sk/LC_MESSAGES/booktheme.mo`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/sk/LC_MESSAGES/booktheme.po` & `fastmbar-1.3/docs/build/_static/locales/sk/LC_MESSAGES/booktheme.po`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/sl/LC_MESSAGES/booktheme.mo` & `fastmbar-1.3/docs/build/_static/locales/sl/LC_MESSAGES/booktheme.mo`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/sl/LC_MESSAGES/booktheme.po` & `fastmbar-1.3/docs/build/_static/locales/sl/LC_MESSAGES/booktheme.po`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/sr/LC_MESSAGES/booktheme.mo` & `fastmbar-1.3/docs/build/_static/locales/sr/LC_MESSAGES/booktheme.mo`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/sr/LC_MESSAGES/booktheme.po` & `fastmbar-1.3/docs/build/_static/locales/sr/LC_MESSAGES/booktheme.po`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/sv/LC_MESSAGES/booktheme.mo` & `fastmbar-1.3/docs/build/_static/locales/sv/LC_MESSAGES/booktheme.mo`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/sv/LC_MESSAGES/booktheme.po` & `fastmbar-1.3/docs/build/_static/locales/sv/LC_MESSAGES/booktheme.po`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/ta/LC_MESSAGES/booktheme.mo` & `fastmbar-1.3/docs/build/_static/locales/ta/LC_MESSAGES/booktheme.mo`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/ta/LC_MESSAGES/booktheme.po` & `fastmbar-1.3/docs/build/_static/locales/ta/LC_MESSAGES/booktheme.po`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/te/LC_MESSAGES/booktheme.mo` & `fastmbar-1.3/docs/build/_static/locales/te/LC_MESSAGES/booktheme.mo`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/te/LC_MESSAGES/booktheme.po` & `fastmbar-1.3/docs/build/_static/locales/te/LC_MESSAGES/booktheme.po`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/tg/LC_MESSAGES/booktheme.mo` & `fastmbar-1.3/docs/build/_static/locales/tg/LC_MESSAGES/booktheme.mo`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/tg/LC_MESSAGES/booktheme.po` & `fastmbar-1.3/docs/build/_static/locales/tg/LC_MESSAGES/booktheme.po`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/th/LC_MESSAGES/booktheme.mo` & `fastmbar-1.3/docs/build/_static/locales/th/LC_MESSAGES/booktheme.mo`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/th/LC_MESSAGES/booktheme.po` & `fastmbar-1.3/docs/build/_static/locales/th/LC_MESSAGES/booktheme.po`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/tl/LC_MESSAGES/booktheme.mo` & `fastmbar-1.3/docs/build/_static/locales/tl/LC_MESSAGES/booktheme.mo`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/tl/LC_MESSAGES/booktheme.po` & `fastmbar-1.3/docs/build/_static/locales/tl/LC_MESSAGES/booktheme.po`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/tr/LC_MESSAGES/booktheme.mo` & `fastmbar-1.3/docs/build/_static/locales/tr/LC_MESSAGES/booktheme.mo`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/tr/LC_MESSAGES/booktheme.po` & `fastmbar-1.3/docs/build/_static/locales/tr/LC_MESSAGES/booktheme.po`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/uk/LC_MESSAGES/booktheme.mo` & `fastmbar-1.3/docs/build/_static/locales/uk/LC_MESSAGES/booktheme.mo`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/uk/LC_MESSAGES/booktheme.po` & `fastmbar-1.3/docs/build/_static/locales/uk/LC_MESSAGES/booktheme.po`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/ur/LC_MESSAGES/booktheme.mo` & `fastmbar-1.3/docs/build/_static/locales/ur/LC_MESSAGES/booktheme.mo`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/ur/LC_MESSAGES/booktheme.po` & `fastmbar-1.3/docs/build/_static/locales/ur/LC_MESSAGES/booktheme.po`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/vi/LC_MESSAGES/booktheme.mo` & `fastmbar-1.3/docs/build/_static/locales/vi/LC_MESSAGES/booktheme.mo`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/vi/LC_MESSAGES/booktheme.po` & `fastmbar-1.3/docs/build/_static/locales/vi/LC_MESSAGES/booktheme.po`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/zh_CN/LC_MESSAGES/booktheme.mo` & `fastmbar-1.3/docs/build/_static/locales/zh_CN/LC_MESSAGES/booktheme.mo`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/zh_CN/LC_MESSAGES/booktheme.po` & `fastmbar-1.3/docs/build/_static/locales/zh_CN/LC_MESSAGES/booktheme.po`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/zh_TW/LC_MESSAGES/booktheme.mo` & `fastmbar-1.3/docs/build/_static/locales/zh_TW/LC_MESSAGES/booktheme.mo`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/locales/zh_TW/LC_MESSAGES/booktheme.po` & `fastmbar-1.3/docs/build/_static/locales/zh_TW/LC_MESSAGES/booktheme.po`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/scripts/bootstrap.js` & `fastmbar-1.3/docs/build/_static/scripts/bootstrap.js`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/scripts/bootstrap.js.map` & `fastmbar-1.3/docs/build/_static/scripts/bootstrap.js.map`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/scripts/pydata-sphinx-theme.js` & `fastmbar-1.3/docs/build/_static/scripts/pydata-sphinx-theme.js`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/scripts/pydata-sphinx-theme.js.map` & `fastmbar-1.3/docs/build/_static/scripts/pydata-sphinx-theme.js.map`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/scripts/sphinx-book-theme.js` & `fastmbar-1.3/docs/build/_static/scripts/sphinx-book-theme.js`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/scripts/sphinx-book-theme.js.map` & `fastmbar-1.3/docs/build/_static/scripts/sphinx-book-theme.js.map`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/styles/bootstrap.css` & `fastmbar-1.3/docs/build/_static/styles/bootstrap.css`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/styles/pydata-sphinx-theme.css` & `fastmbar-1.3/docs/build/_static/styles/pydata-sphinx-theme.css`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/styles/sphinx-book-theme.css` & `fastmbar-1.3/docs/build/_static/styles/sphinx-book-theme.css`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/vendor/fontawesome/6.1.2/LICENSE.txt` & `fastmbar-1.3/docs/build/_static/vendor/fontawesome/6.1.2/LICENSE.txt`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/vendor/fontawesome/6.1.2/css/all.min.css` & `fastmbar-1.3/docs/build/_static/vendor/fontawesome/6.1.2/css/all.min.css`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.ttf` & `fastmbar-1.3/docs/build/_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.ttf`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2` & `fastmbar-1.3/docs/build/_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.ttf` & `fastmbar-1.3/docs/build/_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.ttf`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2` & `fastmbar-1.3/docs/build/_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.ttf` & `fastmbar-1.3/docs/build/_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.ttf`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2` & `fastmbar-1.3/docs/build/_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/vendor/fontawesome/6.1.2/webfonts/fa-v4compatibility.ttf` & `fastmbar-1.3/docs/build/_static/vendor/fontawesome/6.1.2/webfonts/fa-v4compatibility.ttf`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/build/_static/vendor/fontawesome/6.1.2/webfonts/fa-v4compatibility.woff2` & `fastmbar-1.3/docs/build/_static/vendor/fontawesome/6.1.2/webfonts/fa-v4compatibility.woff2`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/source/butane_PMF.rst` & `fastmbar-1.3/docs/source/butane_PMF.rst`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/source/conf.py` & `fastmbar-1.3/docs/source/conf.py`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/source/dialanine_PMF.rst` & `fastmbar-1.3/docs/source/dialanine_PMF.rst`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/source/examples.rst` & `fastmbar-1.3/docs/source/examples.rst`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/source/index.rst` & `fastmbar-1.3/docs/source/index.rst`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/source/installation.rst` & `fastmbar-1.3/docs/source/installation.rst`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/source/references.rst` & `fastmbar-1.3/docs/source/references.rst`

 * *Files 9% similar despite different names*

```diff
@@ -1,14 +1,21 @@
 References
 ============
 
 Please consider citing the following references if FastMBAR is used in your projects.
 
-1. Xinqiang Ding, Jonah Z. Vilseck, Charles L. Brooks III. (2019). `Fast Solver for Large Scale Multistate Bennett Acceptance Ratio Equations. <https://doi.org/10.1021/acs.jctc.8b01010>`_  *J. Chem. Theory Comput.*
+1. Xinqiang Ding, Jonah Z. Vilseck, Charles L. Brooks III. (2019).
+`Fast Solver for Large Scale Multistate Bennett Acceptance Ratio Equations. <https://doi.org/10.1021/acs.jctc.8b01010>`_  *J. Chem. Theory Comput.*
 
-2. Xinqiang Ding, Jonah Z. Vilseck, Ryan L. Hayes, Charles L. Brooks III. (2017). `Gibbs Sampler-based λ-dynamics and Rao–Blackwell Estimator for Alchemical Free Energy Calculation. <https://doi.org/10.1021/acs.jctc.7b00204>`_  *J. Chem. Theory Comput.*
+2. Xinqiang Ding, Jonah Z. Vilseck, Ryan L. Hayes, Charles L. Brooks III. (2017).
+`Gibbs Sampler-based λ-dynamics and Rao–Blackwell Estimator for Alchemical Free Energy Calculation. <https://doi.org/10.1021/acs.jctc.7b00204>`_  *J. Chem. Theory Comput.*
    
-3. Shirts, Michael R., and John D. Chodera. (2008) `Statistically Optimal Analysis of Samples from Multiple Equilibrium States. <https://doi.org/10.1063/1.2978177>`_ *J. Chem. Phys.*
+3. Michael R. Shirts, and John D. Chodera. (2008)
+`Statistically Optimal Analysis of Samples from Multiple Equilibrium States. <https://doi.org/10.1063/1.2978177>`_ *J. Chem. Phys.*
 
-4. Bennett, Charles H. (1976) `Efficient Estimation of Free Energy Differences from Monte Carlo Data. <https://doi.org/10.1016/0021-9991(76)90078-4>`_ J. Comput. Phys.
+4. Kong A, McCullagh P, Meng XL, Nicolae D, Tan Z. (2003)
+`A theory of statistical models for Monte Carlo integration. <https://doi.org/10.1111/1467-9868.00404>`_ *J. R. Stat. Soc. Ser. B Stat. Methodol.*
+
+5. Bennett, Charles H. (1976)
+`Efficient Estimation of Free Energy Differences from Monte Carlo Data. <https://doi.org/10.1016/0021-9991(76)90078-4>`_ J. Comput. Phys.
```

### Comparing `fastmbar-1.2/docs/source/usage.rst` & `fastmbar-1.3/docs/source/usage.rst`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/source/_static/logo.ai` & `fastmbar-1.3/docs/source/_static/logo.ai`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/source/_static/logo.eps` & `fastmbar-1.3/docs/source/_static/logo.eps`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/docs/source/_static/logo.png` & `fastmbar-1.3/docs/source/_static/logo.png`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/LICENSE` & `fastmbar-1.3/LICENSE`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/README.rst` & `fastmbar-1.3/README.rst`

 * *Files identical despite different names*

### Comparing `fastmbar-1.2/pyproject.toml` & `fastmbar-1.3/pyproject.toml`

 * *Files 1% similar despite different names*

```diff
@@ -1,14 +1,14 @@
 [build-system]
 requires = ["hatchling"]
 build-backend = "hatchling.build"
 
 [project]
 name = "FastMBAR"
-version = "1.2"
+version = "1.3"
 authors = [
   { name="Xinqiang Ding", email="Xinqiang.Ding@tufts.edu" }
 ]
 description = "A fast solver for large scale MBAR/UWHAM equations"
 readme = "README.rst"
 license = { file="LICENSE" }
 requires-python = ">=3.11"
```

### Comparing `fastmbar-1.2/PKG-INFO` & `fastmbar-1.3/PKG-INFO`

 * *Files 5% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: FastMBAR
-Version: 1.2
+Version: 1.3
 Summary: A fast solver for large scale MBAR/UWHAM equations
 Project-URL: Homepage, https://fastmbar.readthedocs.io
 Project-URL: Bug Tracker, https://github.com/BrooksResearchGroup-UM/FastMBAR/issues
 Author-email: Xinqiang Ding <Xinqiang.Ding@tufts.edu>
 License: MIT License
         
         Copyright (c) 2018 Xinqiang Ding, Charles L. Brooks III
```

